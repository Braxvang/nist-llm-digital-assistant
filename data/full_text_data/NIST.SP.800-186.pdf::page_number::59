NIST SP 800-186                                                    Discrete Logarithm-based Cryptography:
February 2023                                                            Elliptic Curve Domain Parameters

Appendix E. Auxiliary Functions

E.1.     Computing Square Roots in Binary Fields
                                                                     𝑚𝑚−1
If x is an element of GF(2m), then its square root is the element 𝑥𝑥 2      .

E.2.     Solving the Equation x2 + x = w in Binary Fields
Input: Field element w in GF(2m), where m is an odd integer
Output: Solution α in GF(2m) of the equation α2 + α = w or INVALID
Process:
                                   0    1          2        3       𝑚𝑚−1
    1.   Compute Tr(𝑤𝑤) = 𝑤𝑤 2 + 𝑤𝑤 2 + 𝑤𝑤 2 + 𝑤𝑤 2 + … + 𝑤𝑤 2      (the trace of w).
    2.   If Tr(w) = 1, output INVALID.
                                   0      2      4          𝑚𝑚−1
    3.   Compute α: = Hf(𝑥𝑥) = 𝑤𝑤 2 + 𝑤𝑤 2 + 𝑤𝑤 2 + … + 𝑤𝑤 2     (the half-trace of w).
    4.   Output α.

E.3.     Computing Square Roots in Non-Binary Fields GF(q)
The Tonelli-Shanks algorithm can be used to compute a square root given an equation of the
form x2 ≡ n mod p, where n is an integer – which is a quadratic residue mod p – and p is an odd
prime.
Find q and s (with q odd), such that p –1 = q2s by factoring out the powers of 2.
    Note that if s = 1, as for primes p ≡ 3 mod 4, this reduces to finding x = n(p+1)/4 mod p.
Check to see if nq = 1. If so, then the root x = n(q+1)/2 mod p.
                                                                                                 𝑎𝑎
Otherwise, select a z, which is a quadratic non-residue modulo p. The Legendre symbol � �,
                                                                                                 𝑝𝑝
where p is an odd prime and a is an integer, can be used to test candidate values for z to see if a
value of –1 is returned.
Search for a solution as follows:
    1.   Set x = n(q+1)/2 mod p.
    2.   Set t = nq mod p.
    3.   Set m = s.
    4.   Set c = zq mod p.
    5. While t ≠ 1, repeat the following steps:
                                                                                𝑖𝑖
             a) Using repeated squaring, find the smallest i, such that 𝑡𝑡 2 = 1, where 0 < i < m.
                For example:
                     Let e = 2.
                     Loop for i = 1 until i = m.
                     If te mod p = 1, then exit the loop.



                                                       48
