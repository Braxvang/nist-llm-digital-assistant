ESTABLISHING WIRELESS ROBUST SECURITY NETWORKS: A GUIDE TO IEEE 802.11I



                                                           MAC Header



                Frame        Duration    Address        Address           Address      Sequence
                                                                                        Control       Address             Frame Body                    FCS
                Control        / ID         1              2                 3
                                                                                                         4
                 2 Bytes       2 Bytes   6 Bytes         6 Bytes           6 Bytes        2 Bytes       6 Bytes           0 - 2312 Bytes               4 Bytes




                            Type           Subtype            To          From       More       Retry        Power        More       Pro-
                                                                                                                                     Pro-     Order
      Protocol
                                                              DS           DS        Frag                    Mgmt         Data      tected
      Version
                                                                                                                                    Frame
       2 bits              2 bits          4 bits                 1 bit    1 bit     1 bit          1 bit         1 bit     1 bit     1 bit    1 bit

        00                   10             0000                   0        0         0             0             0          0         0         0


                                                    Figure 5-3. IEEE 802.11 Frame Format

The following items briefly describe the frame body, FCS, and MAC header fields.

      Frame Body. This field, also called the Data field, holds a payload from a higher layer. The
       Frame Body field is variable in length, with a maximum size of 2312 octets. 47
      FCS. This field is used for error detection to detect random bit errors in the received frame. It
       contains the result of applying a 32-bit cyclic redundancy check (CRC-32) on the data. Because
       of this, the FCS is often called the CRC. The FCS calculation is performed on all data in the
       MAC header and frame body.
      Frame Control Field. As shown in Figure 5-3, this field defines a number of parameters for
       IEEE 802.11 operation. For example, it contains two bits used to identify the version of the IEEE
       802.11 MAC. Another value within the field is the Protected Frame bit; if it is set to 1, the frame
       body is cryptographically protected using the negotiated ciphersuite (e.g., CCMP, TKIP, WEP). 48
       The Frame Control Field also indicates the frame type (e.g., management, control, data) and
       subtype (e.g., Association Request, Probe Response). 49
      Duration/ID. This field is used by a STA to retrieve frames buffered at an AP. The field
       identifies the remaining duration in the frame exchange between a STA and AP.
      Sequence Control. This field is used to allow a STA to identify received frames that are
       duplicates, and to assist it in reassembling fragmented frames.
      Address Fields. The MAC header for a data frame contains four distinct address fields, although
       in some cases not all fields contain relevant addresses. The address fields identify the original
       source address (SA) and final destination address (DA) in a frame exchange, as well as the
       receiver address (RA). Depending on the function of the frame, the address fields also identify
       either the transmitter address (TA) or the BSS identifier (BSSID), which is typically the address
       of the AP. The sequence of the addresses in the MAC header depends on two things: whether the
       transmitting station is in an IBSS or an infrastructure BSS, and whether the communicating

47
     An octet is 8 bits.
48
     Prior to the IEEE 802.11i amendment, the Protected Frame field was called the WEP field. The name was changed to
     account for the new data confidentiality and integrity protocols defined in IEEE 802.11i.
49
     For additional details on the IEEE 802.11 frame structure, consult the IEEE 802.11 standard or textbooks on the subject.


                                                                           5-4
