                                                                                              NIST SP 800-204A                                 BUILDING SECURE MICROSERVICES-BASED APPLICATIONS
                                                                                                                                                               USING SERVICE-MESH ARCHITECTURE


                                                                                              against it.

                                                                                              Recommendation for Secure Naming Service (SM-DR17): If the certificate used for mTLS
                                                                                              carries server identity, then the Service Mesh should provide a secure naming service that maps
                                                                                              the server identity to the microservice name that is provided by the secure discovery service or
                                                                                              DNS. This requirement is needed to ensure that the server is the authorized location for the
                                                                                              microservices and to protect against network hijacking.

                                                                                              If the certificate used for mTLS carries the service identity, no additional secure naming service
                                                                                              is required. This also ensures that when the microservice is ported to a different network domain
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-204A




                                                                                              (different cluster or different cloud location), the identity and associated access control policies
                                                                                              need not be defined again for the new location.

                                                                                              Setting up certificates for microservices based on service identity enables two communicating
                                                                                              services to establish a secure communication channel but does not specify whether they are
                                                                                              allowed to communicate at all in the place. To specify this, a feature to define policies for
                                                                                              allowed inbound and outbound traffic for each microservice node is required.

                                                                                              Recommendation for Granular Identity (SM-DR18): Each microservice should have its own
                                                                                              identity, and all instances of this service should present the same identity at runtime. This
                                                                                              allows for access policy at the level of microservice in a given namespace. This is required
                                                                                              since common microservice runtimes default to issuing identities per namespace rather than
                                                                                              per service so that all services in the same namespace present the same runtime identity unless
                                                                                              otherwise specified. In addition, labels can be used to augment the service name (identity) to
                                                                                              enable granular logging configuration and to support granular authorization policies.

                                                                                              Recommendation for Authentication Policy Scope (SM-DR19): The feature to specify the policy
                                                                                              scope for authentication should have the following minimal options: (a) all microservices in all
                                                                                              namespaces, (b) all microservices in a particular namespace, and (c) a specific microservice in a
                                                                                              given namespace (using the runtime identity referred to in SM-DR17).

                                                                                              The above described approach enables authentication using static parameters (i.e., service
                                                                                              identity and pre-defined policies). An additional requirement is the ability to incorporate some
                                                                                              contextual information (such as the user invoking the microservice) in some scenarios. A
                                                                                              mechanism for this is to use tokens encoded in platform-neutral format (e.g., JavaScript Object
                                                                                              Notation (JSON) Web Tokens or JWT). The requirements for the token are:

                                                                                              Recommendation for Authentication Token (SM-DR20): Tokens should be digitally signed and
                                                                                              encrypted so that claims included in them have the assurance of authenticity since these claims
                                                                                              can be used to augment or be part of an authenticated identity to build access control decisions.
                                                                                              Further, these tokens must only be passed by loopback device (to ensure that there is no network
                                                                                              path involved) or through an encrypted channel.

                                                                                              4.5   Configuration for Monitoring Capabilities

                                                                                              All proxies (ingress, egress, and service) should have the capability to collect all monitoring
                                                                                                                                               14
