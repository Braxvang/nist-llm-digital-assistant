NIST SP 800-90A Rev. 1                                             Recommendation for Random Number
                                                                    Generation Using Deterministic RBGs


The testing of the error handling capability is not required during the conduct of health tests.
However, errors encountered during health testing shall be handled as discussed in Section
11.4.2.
All data output from the DRBG mechanism boundary (or sub-boundary) shall be inhibited while
these tests are performed. The results from known-answer-tests (see Section 11.3.1) shall not be
output as random bits during normal operation.

11.3.1     Known Answer Testing

Known-answer testing shall be conducted as specified below. A known-answer test involves
operating the DRBG mechanism with data for which the correct output is already known, and
determining if the calculated output equals the expected output (the known answer). The test
fails if the calculated output does not equal the known answer. In this case, the DRBG
mechanism shall enter an error state and output an error indicator (see Section 11.4).
Generalized known-answer testing is specified in Sections 11.3.2 through 11.3.5. With the
possible exception of the health test function itself, testing shall be performed on all
implemented DRBG mechanism functions within a DRBG boundary (if all functions are in the
same device) or sub-boundary (if functions are distributed) (see Section 8.5). Documentation
shall be provided that addresses the continued integrity of the health tests (see Section 11.1).
Known-answer tests shall be conducted on each DRBG function within a boundary or sub-
boundary prior to the first use of that DRBG (e.g., during the power-on self-testing sequence).

11.3.2     Testing the Instantiate Function

Known-answer tests on the instantiate function shall use a security strength that will be available
during normal operations. If prediction resistance has been implemented, the
prediction_resistance_flag shall also be used. A representative fixed value and length of the
entropy_input, nonce and personalization_string (if supported) shall be used; the value of the
entropy_input used during testing shall not be intentionally reused during normal operations
(either by the instantiate or the reseed functions).
If the values used during the test produce the expected results, then the instantiate function may
be used during normal operation.
An implementation should provide a capability to test the instantiate function on demand.
11.3.3     Testing the Generate Function

During generate-function testing, a representative fixed value and length for the
requested_number_of_bits and additional_input (if supported) shall be used. If prediction
resistance is supported, then the use of the prediction_resistance_request parameter shall be
tested.
If the values used during the test produce the expected results, then the generate function may be
used during normal operation.
Bits generated during health testing shall not be output as pseudorandom bits.
An implementation should provide a capability to test the generate function on demand.


                                                 64
