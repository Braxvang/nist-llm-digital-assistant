NIST SP 800-85A-4                                             PIV CARD APPLICATION & MIDDLEWARE
                                                                       INTERFACE TEST GUIDELINES

VE04.09A-R4: The vendor shall state in its documentation that the card supports the assertions
made in AS04.09A-R4.

Required Test Procedures

TE04.09A-R4.01: The tester shall validate that that the vendor documentation contains the
information required in VE04.09A-R4.

A.4.4.2     pivGenerateKeyPair

AS04.10: The purpose of pivGenerateKeyPair is to generate an asymmetric key pair in the
currently selected card application.

Required Test Procedures

TE04.10.01: The tester shall validate that the PIV Middleware implements the pivGenerateKeyPair
as per SP 800-73-4 Part 3.

AS04.10A-R4: If the length of public key related data retrieved from the PIV Card is longer
than the buffer allocated by the client application, then the PIV Middleware shall return
PIV_INSUFFICIENT_BUFFER, but shall still set KeyLength to the length of the public key
related data retrieved from the PIV Card.

Required Test Procedures

TE04.10A-R4.01: The tester shall ensure that the PIV Middleware returns
PIV_INSUFFICIENT_BUFFER if the length of public key related data retrieved from the PIV Card
is longer than the buffer allocated by the client application.

AS04.11-R4: The PIV Middleware shall not submit data provided to the pivGenerateKeyPair
function over the contactless interface. If the PIV Middleware is not communicating with the
PIV Card via the cardâ€™s contact interface then the pivGenerateKeyPair function shall return
PIV_FUNCTION_NOT_SUPPORTED.

Required Vendor Information

VE04.11-R4.01: The vendor shall state in its documentation that the card supports the assertions
made in AS04.11-R4.01.

Required Test Procedures

TE04.11-R4.01: The tester shall validate that that the vendor documentation contains the
information required in VE04.11-R4.01.

A.4.4.3     pivMiddlewareVersion




                                         A-16
