3 Internet Protocol Security (IPsec)
3.1       Description
IPsec is a suite of protocols for securing Internet communications at the network layer
and operates within the Internet Protocol (IP). It is frequently used to establish Virtual
Private Networks (VPNs)18, requiring both parties to share keying material, and enabling
telecommuters or travelers to gain secure access to their business networks. IPsec
provides the cryptographic security functions for both versions 4 and 6 of the Internet
Protocol.

IPsec operates by inserting one of two special IPsec headers after the IP header in each
message. The Authentication Header (AH) provides integrity protection. The
Encapsulating Security Protocol (ESP) Header provides confidentiality and/or integrity
protection. Hereafter, the terms AH and ESP will be used as shorthand for messages
using AH and ESP headers, respectively. Both ESP and AH provide data origin
authentication, and optionally provide replay protection. AH protects the IP header and
the data following the IP header. ESP, when applied directly to a packet (i.e., in transport
mode), protects the data, but not the IP header. However, ESP in tunnel mode (with a
new IP header inserted) does protect the original IP header. Furthermore, using ESP with
automated keying protects the source and destination addresses in the IP header in either
transport or tunnel mode. Since AH processing introduces unnecessary complexity, and
since ESP can provide equivalent functionality, the use of AH is not recommended.

There have been three versions of IPsec.19 All new systems should implement IPsec-v320,
as it has many enhancements not found in the previous versions. However, IPsec-v2 is
still implemented in numerous current systems, despite the fact that it is obsolete.21

Two classes of key management methods are specified for IPsec: manual keying and
automated keying. Manual keying involves an agreement (in an unspecified manner) by
the parties in a communication on the IPsec protections to be applied and the symmetric
keys to be used. This has a major downside in that it severely limits the scalability of the
security solution and requires re-keying to be done in an unspecified manner. A Security
Association (SA, i.e., a relationship between two or more entities that describes how each
entity will use the security services to communicate securely) and its secret keys cannot
be easily renewed in the cases where the SA expires, has been used for the maximum
allowable volume of traffic, or if its keys are compromised.

To use automated keying, an automated negotiation between peers prior to exchanging
IPsec-protected traffic determines the IPsec protections to be applied and the symmetric
keys to be used. The same method can be used to maintain, delete, or renegotiate the SA

18
     See SP 800-77, Guide to IPsec VPNs [SP 800-77].
19
  There are no generally accepted names for IPsec-v3 and IPsec-v2; these terms are used in this document to make the
requirements more understandable
20
     IPsec-v3 is specified in [RFC 4301], [RFC 4302], [RFC 4303] and [RFC 4835].
21
     IPsec-v2 is specified in [RFC 2401], [RFC 2402] and [RFC 2406].

                                                        23
