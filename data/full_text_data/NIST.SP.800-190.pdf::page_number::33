                                                                                             NIST SP 800-190                                                             APPLICATION CONTAINER SECURITY GUIDE


                                                                                                   •    Capability to centrally control exactly what images and registries are trusted in their
                                                                                                        environment;
                                                                                                   •    Discrete identification of each image by cryptographic signature, using a NIST-validated
                                                                                                        implementation 6;
                                                                                                   •    Enforcement to ensure that all hosts in the environment only run images from these
                                                                                                        approved lists;
                                                                                                   •    Validation of image signatures before image execution to ensure images are from trusted
                                                                                                        sources and have not been tampered with; and
                                                                                                   •    Ongoing monitoring and maintenance of these repositories to ensure images within them
                                                                                                        are maintained and updated as vulnerabilities and configuration requirements change.

                                                                                             4.2       Registry Countermeasures
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-190




                                                                                             4.2.1      Insecure connections to registries

                                                                                             Organizations should configure their development tools, orchestrators, and container runtimes to
                                                                                             only connect to registries over encrypted channels. The specific steps vary between tools, but the
                                                                                             key goal is to ensure that all data pushed to and pulled from a registry occurs between trusted
                                                                                             endpoints and is encrypted in transit.

                                                                                             4.2.2      Stale images in registries

                                                                                             The risk of using stale images can be mitigated through two primary methods. First,
                                                                                             organizations can prune registries of unsafe, vulnerable images that should no longer be used.
                                                                                             This process can be automated based on time triggers and labels associated with images.
                                                                                             Second, operational practices should emphasize accessing images using immutable names that
                                                                                             specify discrete versions of images to be used. For example, rather than configuring a
                                                                                             deployment job to use the image called my-app, configure it to deploy specific versions of the
                                                                                             image, such as my-app:2.3 and my-app:2.4 to ensure that specific, known good instances of
                                                                                             images are deployed as part of each job.

                                                                                             Another option is using a “latest” tag for images and referencing this tag in deployment
                                                                                             automation. However, because this tag is only a label attached to the image and not a guarantee
                                                                                             of freshness, organizations should be cautious to not overly trust it. Regardless of whether an
                                                                                             organization chooses to use discrete names or to use a “latest” tag, it is critical that processes be
                                                                                             put in place to ensure that either the automation is using the most recent unique name or the
                                                                                             images tagged “latest” actually do represent the most up-to-date versions.

                                                                                             4.2.3      Insufficient authentication and authorization restrictions

                                                                                             All access to registries that contain proprietary or sensitive images should require authentication.
                                                                                             Any write access to a registry should require authentication to ensure that only images from
                                                                                             trusted entities can be added to it. For example, only allow developers to push images to the
                                                                                             specific repositories they are responsible for, rather than being able to update any repository.


                                                                                             6     For more information on NIST-validated cryptographic implementations, see the Cryptographic Module Validation Program
                                                                                                   (CMVP) page at https://csrc.nist.gov/projects/cryptographic-module-validation-program.

                                                                                                                                                         21
