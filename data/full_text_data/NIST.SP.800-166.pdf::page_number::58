NIST SP 800-166                                                     DERIVED PIV APPLICATION AND
                                                                    DATA MODEL TEST GUIDELINES

                      authenticating to the test toolkit application using the Derived PIV
                      Token Management Key (if supported).

 DTR(s)               • DTR-06.02.02.09
                      • DTR-06.03.01.01
                      • DTR-06.03.04.01
                      • DTR-06.03.04.05
 Vendor               The vendor to provide in its documentation whether the Derived PIV
 Documentation        Token Management Key is supported, and if yes, the value of the key.
 Precondition(s)      •   A token with the Derived PIV Application is inserted into an
                          appropriate token reader.
                      •   Suitable drivers have been loaded between the test system and an
                          instance of the reader.
 Test Scenario        1. Send the SELECT command with
                            • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                      2. Send the GENERAL AUTHENTICATE command
                             • CLA is set to '00'
                             • P1, algorithm reference, is set to '00', '03',
                                '08', '0A', or '0C'
                             • P2, key reference, is set to '9B'
                             • Data field in the command is to include '80'
                                requesting a witness from the Derived PIV
                                Application
                      3. Send the GENERAL AUTHENTICATE command
                             • CLA is set to '00'
                             • P1, algorithm reference is set to the same
                                value as specified in Step 2.
                             • P2, key reference is set to '9B'
                                Data field in the command is to include '80'
                                followed by decryption of the witness sent by
                                the Derived PIV Application and '81' followed
                                by a challenge and then '82 00'
 Expected Result(s)   1. From Step 1, the command returns the application property template
                         with the status word '90 00'.
                      2. From Step 2, the command returns with the witness followed by
                         status word '90 00'.
                      3. From Step 3, the Derived PIV Application verifies the decrypted
                         witness and then responds with encryption of the challenge sent by
                         Test Toolkit Application followed by status word '90 00'. Decrypt
                         the encrypted challenge and compare it to the one sent to the token.
 Postcondition(s)     N/A

8.3.3.4 External Authenticate with Derived PIV Token Management Key

 Test Assertion       TA-08.03.03.04




                                             51
