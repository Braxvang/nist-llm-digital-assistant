ESTABLISHING WIRELESS ROBUST SECURITY NETWORKS: A GUIDE TO IEEE 802.11I



      Changed frequently to reduce the possibility of discovery through sophisticated cryptanalysis
      Protected while in storage, so that previous communications cannot be deciphered
      Protected during transmission
      Erased completely when no longer needed.
These requirements are related to the security service known as key management, which is defined as “the
process of handling and controlling cryptographic keys and related material (such as initialization values)
during their life cycle in a cryptographic system, including ordering, generating, distributing, storing,
loading, escrowing, archiving, auditing, and destroying the material.” 28 The IEEE 802.11 specification
provides guidelines for some general key requirements, but it leaves other areas open to interpretation and
dependent on implementation. Section 7 provides additional guidance on these requirements.

For pre-RSN IEEE 802.11 networks that used manual WEP keys, key management was non-existent. For
instance, there was typically only one key (or a small number of keys) for all devices in the network, and
there was no standard mechanism for distributing the keys. Networks using dynamic WEP did have basic
key distribution protocols that were able to derive per-user session keys, but still retained all the
weaknesses inherent in WEP. However, with RSNAs there are several inter-related keys that underlie the
security functions of encryption, authentication, and integrity. IEEE 802.11i defines two key hierarchies
for RSNAs that specify the inter-relations of the keys. The two key hierarchies are the Pairwise Key
Hierarchy, which is designed for unicast traffic 29 protection, and the Group Key Hierarchy, which is
intended for multicast/broadcast traffic 30 protection. Sections 4.2.1 and 4.2.2 describe these key
hierarchies and explain the source of each key and the relationships among keys.

4.2.1    Pairwise Key Hierarchy

Figure 4-4 depicts the Pairwise Key Hierarchy. The two keys depicted at the top of the key hierarchy are
known as root keys, which are used as the basis for generating additional keys required for various
confidentiality and integrity protections. The root keys represent the two ways in which keys may be
installed in IEEE 802.11 RSNA devices, as follows:

      Pre-Shared Key (PSK). A PSK is a static key delivered to the AS and the STA through an out-
       of-band mechanism, as shown in Figure 4-5. The PSK must be put into place before establishing
       an association. The PSK may be generated and installed in any number of ways, including
       proprietary automated public-key cryptographic approaches, and manual means such as a USB
       device or a passphrase (which can be converted to a cryptographic key using one of a number of
       algorithms). If any of the PSKs are compromised, they must be re-distributed in the same way.
       The security of the WLAN is compromised if any of the PSKs does not possess sufficient
       cryptographic strength; the passphrase from which the PSK is generated must be a long and
       complex, possibly randomly generated. The IEEE 802.11 standard does not specify how PSKs are
       to be generated or distributed, so these decisions are left to implementers. 31 As a result,
       organizations should review any PSK approach carefully for possible vulnerabilities and evaluate
       its performance implications. Distributing PSKs in a large network might be infeasible. Due to
       client software limitations, a common practice is to assign a single PSK per SSID to enable

28
     This definition is from RFC 2828, Internet Security Glossary, which is available at http://www.ietf.org/rfc/rfc2828.txt.
29
     Unicast data transfer is a one-to-one type of transmission, used for communications between an AP and a particular STA.
30
     A multicast data transfer is a one-to-many type of transmission; data is destined for a subset of all the STAs in a WLAN. A
     broadcast data transfer is a one-to-all type of transmission where data is sent to all STAs on a WLAN.
31
     Annex H.4 does, however, recommend a passphrase to key conversion scheme that WPA2 certification enforces. This
     scheme uses PKCS 5 and HMAC-SHA1.


                                                              4-4
