      NIST SP 800-73pt2-5 ipd (Initial Public Draft)                        Interfaces for Personal Identity Verification: Part 2
      September 2023                                                           PIV Card Application Card Command Interface

700
701                          Table 7. Data objects in the dynamic authentication template (Tag '7C')

                    Name                  Tag       M/O                             Description
              Witness                     '80'       C       Demonstration of knowledge of a fact without revealing
                                                             the fact. An empty witness is a request for a witness.
              Challenge                   '81'        C      One or more random numbers or byte sequences to be
                                                             used in the authentication protocol
              Response                    '82'        C      A sequence of bytes encoding a response step in an
                                                             authentication protocol
              Exponentiation              '85'        C      A parameter used in ECDH key agreement protocol

702   The data objects that appear in the dynamic authentication template (tag '7C') in the data field of
703   the GENERAL AUTHENTICATE card command depend on the authentication protocol being
704   executed. The Witness (tag '80') contains encrypted data (unrevealed fact), which is decrypted by
705   the card. The Challenge (tag '81') contains clear data (byte sequence), which is encrypted by the
706   card. The Response (tag '82') contains either the decrypted data from tag '80' or the encrypted
707   data from tag '81'. Note that the empty tags (i.e., tags with no data) return the same tag with
708   content (they CAN be seen as “requests for requests”):
709       •    '80 00' Returns '80 TL <encrypted random>' (as per definition)
710       •    '81 00' Returns '81 TL <random>' (as per external authenticate example)
711   Response Syntax
                                            Absent, authentication-related data, signed data, shared secret, or
                   Data Field
                                            transported key
                   SW1-SW2                  Status word
712
                    SW1           SW2                                     Meaning
                                            Successful execution where SW2 encodes the number of response
                     '61'          'xx'
                                            data bytes still available
                      '69'         '82'     Security status not satisfied
                     '6A'          '80'     Incorrect parameter in command data field
                     '6A'          '86'     Incorrect parameter in P1 or P2
                      '90'         '00'     Successful execution


713            PIV Card Application Card Commands for Credential Initialization and
714            Administration

715   3.3.1. PUT DATA Card Command
716   The PUT DATA card command completely replaces the data content of a single data object in
717   the PIV Card Application with new content.
718   Command Syntax
                   CLA                      '00' or '10' indicating command chaining
                   INS                      'DB'
                   P1                       '3F'
                   P2                       'FF'



                                                                   18
