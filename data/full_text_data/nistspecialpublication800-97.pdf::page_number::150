ESTABLISHING WIRELESS ROBUST SECURITY NETWORKS: A GUIDE TO IEEE 802.11I



By grouping the frame exchanges within the frame exchange protocol by function, IEEE 802.11 RSN
operation may be thought of as occurring in five distinct phases:

     RSN Operation Phase 1: Discovery. The STA identifies an AP for a WLAN with which it
      wishes to communicate. The STA locates an AP either by receiving one of the APâ€™s periodic
      transmissions of Beacon frames, or by sending a Probe Request to solicit a Probe Response from
      an AP. After the STA has identified an AP, the STA and the AP exchange frames to negotiate
      various parameters for their communications. By the end of the phase, the STA and AP have
      agreed on an authentication method.
     RSN Operation Phase 2: Authentication. During this phase, the STA and AS prove their
      identities to each other. The authentication frames pass through the AP, which also blocks non-
      authentication traffic from the STA using IEEE 802.1X port-based access control. The actual
      authentication mechanism is implemented by the STA and AS using EAP. EAP provides a
      framework that allows the use of multiple methods for achieving authentication, including static
      passwords, dynamic passwords, and public key cryptography certificates. After authentication
      has been completed, the AAA key is installed in the STA and AS. It serves as a root key to
      enable the generation of other keys used to secure communications between the STA and AP.
     RSN Operation Phase 3: Key Generation and Distribution (KGD). During the KGD phase,
      the AP and the STA perform several operations that cause cryptographic keys to be generated and
      placed on the AP and the STA. The KGD phase employs two handshakes: a 4-Way Handshake
      and a Group Key Handshake. During the 4-Way Handshake, the STA and AP establish a security
      policy that specifies several key security capabilities, such as data confidentiality and integrity
      protocols for protecting data traffic, and a key distribution approach. Both handshakes employ
      message encryption and integrity checking, using one of two confidentiality and integrity
      algorithms. For both types of handshakes, NIST requires the use of AES Key Wrap with HMAC-
      SHA-1-128 instead of RC4 encryption with HMAC-MD5 because AES and SHA-1 are FIPS-
      approved algorithms, and RC4 and MD5 are not. Selecting CCMP as the cipher suite will ensure
      the use of the appropriate key wrap algorithms.
     RSN Operation Phase 4: Protected Data Transfer. The STA and AP share data securely,
      using the security policy and cryptographic keys established during the first three phases.
      Because secure data transfer occurs between the STA and the AP only, organizations need to
      consider carefully the security of the data during the rest of its transit (e.g., on the DS).
     RSN Operation Phase 5: Connection Termination. During this phase, the STA and AP tear
      down their secure connection and delete their association, thereby terminating their wireless
      connection.
The outcome of the discovery phase is very important to the security posture of a WLAN. In an RSN, an
AP should not associate with pre-RSN STAs. If any STAs in a WLAN are using pre-RSN capabilities
(e.g., WEP or IEEE 802.11 entity authentication), then those STAs have associations that are not RSNAs.
Accordingly, the WLAN is not an RSN, even though many of its STAs might not be using pre-RSN
capabilities. Organizations that want to establish IEEE 802.11 RSNs should configure their APs so that
they permit the establishment of RSNAs only, not associations based on pre-RSN capabilities.
Alternatively, non-RSN STAs should be limited to a separate VLAN where additional controls (e.g.
firewalls and FIPS 140-2 validated VPNs) can be applied.




                                                   10-4
