          A STATISTICAL TEST SUITE FOR RANDOM AND PSEUDORANDOM NUMBER GENERATORS FOR CRYPTOGRAPHIC APPLICATIONS



          For a fixed block length m, one should expect that in long random (irregular) strings, ApEn(m) ≈ log2 .
          The limiting distribution of n [log2 − ApEn(m)] coincides with that of a Χ 2 -random variable with 2m
          degrees of freedom. This fact provides the basis for a statistical test, as was shown by Rukhin [3].
                                                                                                                 €
          Thus, with Χ 2 (obs) = n [log2 − ApEn(m)] , the reported P-value is
                                 €                                                           €

                                                          igamc (2 m−1,Χ 2 (obs) /2) .
          €
          Actually, this limiting distribution of approximate entropy is more exact for its modified definition as

                                             €           ~ (m )
                                                         Φ        = ∑ν i1 …im log ν i1 …im ,
                                                                      i1 …im


          where ν i1 …im denotes the relative frequency of the template (i1, …,im) in the augmented (or circular)
          version of the original string, i.e., in the string (ε1,…,εn ,ε1,…,εm−1 ) . Let ω i1 …im = nν i1 …im be the
                                             €
          frequency of the pattern i1, …,im. Under our definition, ω i1 …im =                    ∑ω      k   i1 …im k , so that for any

        € m, ∑            = n.
                 i1 …im
                                                     €                                      €
          Define the modified approximate entropy as €
                                                                  ~              ~ (m )   ~ (m +1)
€                                                         Apen(m) = Φ − Φ                            .

                                                     ~
          By Jensen's inequality, log s ≥ Apen (m) for any m, whereas it is possible that log s < Apen(m) .
          Therefore, the largest possible €value of the modified entropy is merely log s, which is attained when n =
          sm, and the distribution of all m-patterns is uniform. When calculating the approximate entropy for several
          values of m, it is very convenient to have the sum of all frequencies of m-templates be equal to n.
                          €                                                                              €
          When n is large, ApEn(m) and its modified version cannot differ much. Indeed, one has with
          ω ′i1 …im = (n − m + 1)ν ′i1 …im
                                                             ∑ω ′     i1 …im    = n − m + 1,
                                                             i1 …im


€         and ω i1 …im − ω ′i1 …im ≤ m −1. It follows that
                                                                                        m −1
                                                 €       ν i1 …im − ν ′i1 …im ≤                ,
                                                                                      n − m +1
    €                                                             ~ (m )
          which suggests that for a fixed m,Φ(m ) and Φ must be close for large n. Therefore, Pincus' approximate
          entropy and its modified version
                                       € are also close, and their asymptotic distributions must coincide.
                                                              References for Test
                                     €           €
          [1]       S. Pincus and B. H. Singer, “Randomness and degrees of irregularity,” Proc. Natl. Acad. Sci.
                    USA. Vol. 93, March 1996, pp. 2083-2088.



                                                                               3-20
