                                                                                             NIST SP 800-185                                                   SHA-3 DERIVED FUNCTIONS: CSHAKE,
                                                                                                                                                              KMAC, TUPLEHASH, AND PARALLELHASH

                                                                                             5         TupleHash

                                                                                             5.1       Overview

                                                                                             TupleHash is a SHA-3-derived hash function with variable-length output that is designed to
                                                                                             simply hash a tuple of input strings, any or all of which may be empty strings, in an
                                                                                             unambiguous way. Such a tuple may consist of any number of strings, including zero, and is
                                                                                             represented as a sequence of strings or variables in parentheses like (“a”, “b”, “c”,...,“z”) in this
                                                                                             document.

                                                                                             TupleHash is designed to provide a generic, misuse-resistant way to combine a sequence of
                                                                                             strings for hashing such that, for example, a TupleHash computed on the tuple ("abc" ,"d") will
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-185




                                                                                             produce a different hash value than a TupleHash computed on the tuple ("ab","cd"), even though
                                                                                             all the remaining input parameters are kept the same, and the two resulting concatenated strings,
                                                                                             without string encoding, are identical.

                                                                                             TupleHash supports two security strengths: 128 bits and 256 bits. Changing any input to the
                                                                                             function, including the requested output length, will almost certainly change the final output.

                                                                                             5.2       Parameters

                                                                                             TupleHash takes the following parameters:

                                                                                                   •    X is a tuple of zero or more bit strings, any or all of which may be an empty string.
                                                                                                   •    L is an integer representing the requested output length in bits.
                                                                                                   •    S is an optional customization bit string of any length, including zero. If no customization
                                                                                                        is desired, S is set to the empty string.

                                                                                             5.3       Definition

                                                                                             TupleHash encodes the sequence of input strings in an unambiguous way, then encodes the
                                                                                             requested output length at the end of the string, and passes the result into cSHAKE, along with
                                                                                             the function name (N) of “TupleHash” = 00101010 10101110 00001110 00110110
                                                                                             10100110 00010010 10000110 11001110 00010110, and the optional
                                                                                             customization string S.

                                                                                             If X is a tuple of n bit strings, let X[i] be the ith bit string, numbering from 0. The TupleHash
                                                                                             functions are defined in pseudocode as follows:

                                                                                             TupleHash128(X, L, S):
                                                                                             Validity Conditions: 0 ≤ L < 22040 and len(S) < 22040

                                                                                             1. z = "".
                                                                                             2. n = the number of input strings in the tuple X.
                                                                                             3. for i = 1 to n:
                                                                                                    z = z || encode_string(X[i]).
                                                                                             4. newX = z || right_encode(L).

                                                                                                                                                12
