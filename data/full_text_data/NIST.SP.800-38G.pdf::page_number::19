NIST SP 800-38G                                        METHODS FOR FORMAT-PRESERVING ENCRYPTION


5     Mode Specifications

The specifications of the encryption and decryption algorithms for FF1 and FF3 are presented in
Sections 6.1 and 6.2, organized into prerequisites, inputs, outputs, steps, and descriptions of the
steps. In addition to the key and designated cipher function, the prerequisites for each mode are
the choices of 1) the base, radix, and 2) the range of lengths, [minlen.. maxlen], for the numeral
string inputs that the implementation supports. FF1 also has a prerequisite for the choice of the
maximum tweak length, maxTlen, that the implementation supports. For each mode, the
requirements on the values for the prerequisites are specified prior to the encryption and
decryption algorithms.

The parameter choices may affect interoperability. The behavior of an implementation when
presented with incorrect inputs is outside the scope of this Recommendation.

For each specification, the 128-bit input and output blocks of the designated block cipher,
CIPHK, are represented as strings of 16 bytes.

5.1       FF1

The specifications for the FF1.Encrypt and FF1.Decrypt functions are given in Algorithms 7 and
8 below. The tweak, T, is optional, in that it may be the empty string, with byte length t = 0.

The parameters radix, minlen, and maxlen in FF1.Encrypt and FF1.Decrypt shall meet the
following requirements:

      •    radix ∈ [2 .. 216],
      •    radix minlen ≥ 100, and
      •    2 ≤ minlen ≤ maxlen < 232.


Algorithm 7: FF1.Encrypt(K, T, X)

Prerequisites:
Designated cipher function, CIPH, of an approved 128-bit block cipher;
Key, K, for the block cipher;
Base, radix;
Range of supported message lengths, [minlen .. maxlen];
Maximum byte length for tweaks, maxTlen.

Inputs:
Numeral string, X, in base radix of length n, such that n ∈ [minlen .. maxlen];
Tweak T, a byte string of byte length t, such that t ∈ [0 .. maxTlen].

Output:
Numeral string, Y, such that LEN(Y) = n.




                                                 14
