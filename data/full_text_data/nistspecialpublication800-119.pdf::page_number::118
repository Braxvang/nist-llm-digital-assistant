                                                                GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


lists. Therefore, lighter-weight approaches based on some simplifications (i.e., security shortcuts) in the
trust model have been proposed.

IPsec is not the antidote for all security concerns with IPv6. It provides specific functionality such as
cryptographic transforms to mitigate threats and vulnerabilities from the network layer up through the
application layer. It does not replace other security functionality dealing with malware, spam, access
controls, intrusion detection, and so forth.

IPsec may introduce a new security consideration insofar as it may thwart deep-packet inspection
mechanisms between the two IPsec endpoints. Security tools such as intrusion detection systems and
virus scanners cannot inspect encrypted packets. One viable approach in such cases is to distribute the
intrusion detection services and virus scanners between network-based and host-based components.

Denial of service attacks and covert channels exist with IPsec, but it is not clear that these are any worse
than those using IP without IPsec. Also, IPsec can protect against certain TCP-level denial of service
attacks like SYN floods, whereas session layer security protocols such as SSH and SSL/TLS cannot.

The biggest security problem with IPsec seems to be faulty choices of security services or parameters.
For example, vendor documentation may recommend using IPsec encryption without authentication in a
way that is not consistent with up-to-date security guidelines.

  5.3.6   Unknown Aspects

Although cryptographic security reduces the risks of networking, it cannot totally eliminate them. For
example, a VPN implementation may have flaws in algorithms or software, it may be set up with insecure
configuration settings and values, or it may be subject to denial of service attacks.

One significant concern with IPsec in IPv6 has been incomplete vendor implementations of the protocol,
which may result in end-to-end incompatibility. This situation is gradually improving.

A debate exists over whether to use AH or ESP with NULL encryption for IPsec packets requiring
integrity protection but not confidentiality. The standards themselves do not answer the question: IPv6
standards tend to recommend or require AH, whereas IPsec standards have downgraded AH from MUST
implement to MAY implement. OSPFv3 originally specified AH, but this has been changed to ESP-
NULL. Some implementations only provide ESP. AH has not been widely deployed. (The common
IPv4 applications of IPsec—VPNs and secure remote access—usually provide confidentiality, so this
question does not arise.) AH may also require more processing steps to compute or verify the integrity
check value. On the other hand, one of the main arguments in favor of AH is that it makes it easier for
devices such as packet filtering routers, firewalls, and intrusion detection systems to recognize plaintext
and examine packets (because ESP-NULL transmits plaintext but gives no visible indication that the
payload is unencrypted). As far as the cryptographic protection provided by AH versus ESP, it is difficult
to discern any tangible difference when IPsec is used as intended. In some cases, AH may protect certain
vulnerable parts of the header or extension headers, but these cases are rare, and in these few cases, ESP-
NULL can achieve the same effect by being run in tunnel mode.

As IPv6 applications attempt to use IPsec for end-to-end security, more work will be needed on security
APIs.

IPsec also relies on some security infrastructure outside of the IPsec protocols for authentication. This
can be based on shared secret keys, locally generated certificates, or an external public key infrastructure.




                                                    5-16
