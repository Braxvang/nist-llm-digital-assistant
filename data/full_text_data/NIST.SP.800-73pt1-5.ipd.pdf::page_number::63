       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1262   Appendix C. PIV Algorithm Identifier Discovery
1263   Relying parties interact with many PIV Cards with the same native key type implemented by
1264   different key sizes and algorithms. 34 For example, a relying party performing the authentication
1265   mechanism described in Appendix B.1.2 CAN expect to perform a challenge and response
1266   cryptographic authentication with a 3072-bit or a 2048-bit RSA key or an ECDSA (Curve P-256
1267   or Curve P-384) key.
1268   This appendix describes recommended procedures for key size and algorithm discovery (PIV
1269   algorithm ID discovery) to facilitate cryptographic authentication initiated by the relying party to
1270   make appropriate decisions for granting access to logical networks and systems as well as
1271   physical access control systems. The discovery procedure is defined in terms of asymmetric and
1272   symmetric cryptographic authentication.

1273   C.1. PIV Algorithm Identifier Discovery for Asymmetric Cryptographic
1274      Authentication
1275   As illustrated in the authentication mechanisms in Appendix B, an asymmetric cryptographic
1276   authentication involves issuing a challenge (request to sign a nonce) to the PIV Card. The relying
1277   party issuing the command provides the nonce to be signed, the key reference, and the PIV
1278   algorithm identifier as parameters of the command. The nonce is random data generated by the
1279   relying party, and the key reference is known. In contrast, the PIV algorithm identifier is
1280   unknown to the relying party and needs to be identified in order to issue the challenge command.
1281   The PIV algorithm identifier CAN be derived from the previous steps of the authentication
1282   mechanism. Prior to issuing the challenge command, the relying party retrieved and parsed the
1283   X.509 certificate from the card to validate the certificate and extract the public key for the
1284   pending verification of the signed nonce once returned from the card. The PIV algorithm
1285   identifier CAN be identified during the parsing of the X.509 certificate in two steps: 35
1286              Step 1: Algorithm Type Discovery
1287              The X.509 certificate stores the public key in the subjectPublicKeyInfo field. The
1288              subjectPublicKeyInfo data structure has an algorithm field, which includes an OID that
1289              identifies the public key’s algorithm (RSA or ECC), as listed in Table 4 of SP 800-78.
1290              Step 2: Key Size Discovery
1291              If the algorithm type determined in Step 1 is ECC, then the key size is determined by the
1292              elliptic curve on which the key has been generated, which is P-256 or P-384 for all
1293              elliptic curve PIV Authentication keys and Card Authentication keys.
1294              If the algorithm type determined in Step 1 is RSA, then the key size is determined by the
1295              public key’s modulus. The public key appears in the subjectPublicKey field of
1296              subjectPublicKeyInfo and is encoded as a sequence that includes both the key’s modulus
1297              and public exponent.


       34
         Table 1 of SP 800-78 lists the various algorithms and key sizes that may be used for each PIV Key Type.
       35
         The PIV algorithm identifiers specify both the key size and the algorithm for the key references. Thus, both values have to be discovered in
       order to derive the PIV algorithm identifier.


                                                                           51
