NIST SP 800-38G                                         METHODS FOR FORMAT-PRESERVING ENCRYPTION


prerequisites are omitted from the above notation, such as the underlying block cipher, the
designation of CIPHK, and the base for the numeral strings.

4.5   Feistel Structure

FFX schemes, including FF1 and FF3, are based on the Feistel structure. The Feistel structure
consists of several iterations, called rounds, of a reversible transformation. The transformation
consists of three steps: 1) the data is split into two parts; 2) a keyed function, called the round
function, is applied to one part of the data in order to modify the other part of the data; and 3) the
roles of the two parts are swapped for the next round. The structure is illustrated in Figure 1
below, for both encryption and decryption. Four rounds are shown in Figure 1, but ten rounds are
actually specified for FF1, and eight rounds for FF3.

         u!characters!      v!characters!                  u!characters! v!characters!
                A0!             B0!                               A4!!             B4!


                               n,!T,!0!                           n,!T,!3!                   _!
           +!         FK!                                                        FK!


            B1!←!C0!          A1!←!B0!                       B3!←!A4!              A3!!


                n,!T,!1!                                     _!                   n,!T,!2!
                              FK!         +!                             FK!


            A2!←!B1!          B2!←!C1!                            A2!!           B2!←!A3!


                               n,!T,!2!                           n,!T,!1!                   _!
           +!         FK!                                                        FK!


            B3!←!C2!         A3!←!B2!                        B1!←!A2!              A1!


                n,!T,!3!                                     _!                   n,!T,!0!
                              FK!         +!                             FK!


           A4!←!B3!          B4!←!C3!                             A0!            B0!←!A1!


                      Encryption!                                        Decryption!

                                      Figure 1: Feistel Structure



                                                  10
