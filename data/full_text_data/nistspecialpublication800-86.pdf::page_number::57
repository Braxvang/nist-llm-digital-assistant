                                                      GUIDE TO INTEGRATING FORENSIC TECHNIQUES INTO INCIDENT RESPONSE



         open files. In addition, for some consumer devices, such as PDAs and cell phones, removing
         battery power can cause a loss of data.74
Some tools are able to perform collection actions on running systems without any problems, while other
tools are best run on systems that have been shut down. In the latter case, analysts should be aware of the
characteristics of each OS and choose a shutdown method based on the typical behavior of the OS and the
types of data that need to be preserved. 75 For example, DOS and Windows 95/98 systems generally do
not corrupt data when power is removed suddenly, so removing power should preserve data. Other OSs
might corrupt data, such as open files or files that were being accessed at the time, if there is a loss of
power. In these cases, a graceful shutdown is generally best unless swap files or temporary data files are
of particular interest or the system might contain rootkits, Trojan horses, or other malicious programs that
might be triggered by a graceful shutdown. After performing a shutdown (if needed), the analyst should
acquire filesystem data from the system’s storage media using the methods discussed in Section 4.

After the computer has been powered off, all components, storage devices, media, and peripheral devices
connected to the computer should be inventoried and labeled if they are needed as evidence. Whenever
possible, the inventory should include the model number, serial number, and description of the item. In
addition, information about how each item is connected to the outside or inside of the computer (e.g.,
cable connections, jumper settings) should be documented and photographed. This will help the analyst
to recreate the user’s computer setup. Assuming that the evidence can be legally seized, each item should
be handled using antistatic bracelets, guarded against electrostatic discharges that can damage the item,
sealed properly (i.e., a box that is taped shut), and packed securely for transport. Handlers should wear
antistatic bracelets when handling sensitive media and protect media with antistatic bags and other special
packing materials.

Once the filesystem data has been collected, tools can be used to acquire specific types of data from the
filesystem. Acquiring regular files, such as data, application, and configuration files, is relatively
straightforward and is described in more detail in Section 4. The following list describes several other
types of non-volatile OS data and explains how tools can be useful in acquiring each type from the
filesystem:76

     ! Users and Groups. Operating systems maintain a list of users and groups that have access to the
       system. On UNIX systems, users and groups are listed in /etc/passwd and /etc/groups,
       respectively. In addition, the groups and users commands can be used to identify users who
       have logged onto the system and the groups to which they belong. On Windows systems, the net
       user and net group commands can be used to enumerate the users and groups on a system.
     ! Passwords. Most OSs maintain password hashes for users’ passwords on disk. On Windows
       systems, third-party utilities can be used to dump password hashes from the Security Account
       Manager (SAM) database. On UNIX systems, password hashes are usually in the /etc/passwd or
       /etc/shadow file. As described in Section 4.3.2, password cracking programs can be used to
       extract passwords from their hashes.




74
     Power for such devices often must be maintained on an ongoing basis. If a device does not have regular power, typically its
     memory will be sustained by battery power only for the short term (weeks at most, minutes at worst), even if the device is
     powered off. For long-term storage of consumer devices that contain important data, power should be maintained to
     preserve the devices’ memory.
75
     In most cases, analysts can determine which type of OS is in use by looking at the screen. For example, Windows systems
     use taskbars and other graphic elements that do not appear on other OSs.
76
     Some of the tools described in this section can also be used to collect data from a live system.


                                                              5-9
