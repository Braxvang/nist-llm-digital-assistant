                                                                                              NIST SP 800-77 REV. 1                                                          GUIDE TO IPSEC VPNS


                                                                                              CHACHA20POLY1305 [74] as its encryption and integrity algorithm. None of these algorithms
                                                                                              are NIST-approved. However, NIST plans to allow Edwards-curve Digital Signature Algorithms
                                                                                              (EdDSAs) [75] in a revision of FIPS 186.

                                                                                              There are many similarities with IPsec and IKE. WireGuard uses IKEv2-style DDoS COOKIES
                                                                                              and DPD/Keepalives. The data packet looks very similar to ESP in tunnel mode. Transport mode
                                                                                              is not supported. Its replay attack protection is the same as IPsec, using a replay window of 2000
                                                                                              (continuous packet sequence numbers). It supports PPK and has the same seamless reconnection
                                                                                              properties as IKEv2 MOBIKE, where a device can switch network interfaces without losing the
                                                                                              VPN connection. WireGuard takes advantage of multiple CPUs when present, unlike typical SSL
                                                                                              VPNs that are bound to one CPU.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              The protocol does not allow for DHCP-style IP address allocation, and IP addresses are hard-
                                                                                              coded in its configuration file on the client and server. DNS configuration has to be conveyed via
                                                                                              a provisioning protocol. WireGuard lacks authentication support using certificates or PSKs. It
                                                                                              does not support a transport mode configuration, making it less suitable for mesh encryption. It
                                                                                              does not support AES-GCM.

                                                                                              WireGuard is mostly intended as a remote access VPN even though it leaves most of the
                                                                                              configuration of such functionality to an additional, unspecified provisioning protocol. While it
                                                                                              can be used in a gateway-to-gateway or host-to-host architecture, it misses the optimizations and
                                                                                              flexibility of IPsec in these architectures.

                                                                                              8.4   Secure Shell (SSH)

                                                                                              SSH is a commonly used application layer protocol suite. While it is often used as a secure
                                                                                              remote login application and a secure file transfer application, it can also be used to tunnel
                                                                                              specific ports via an SSH connection to allow either a local connection to access a remote
                                                                                              resource or a remote connection to access a local resource. SSH is often used on intermediary
                                                                                              hosts (also called bastion hosts) to jump to other hosts, but that jump does not need to be to the
                                                                                              remote login (SSH) host itself. For instance, port 25 on localhost (127.0.0.1) could be made
                                                                                              available to locally running mail clients. The SSH protocol allows for the secure transport of this
                                                                                              traffic using the SSH VPN to the bastion host, where the SSH client will forward the decrypted
                                                                                              traffic to a remote mail serverâ€™s port 25. Because a single SSH tunnel can provide protection for
                                                                                              several applications at once, it is technically a transport layer VPN protocol, not an application
                                                                                              layer protocol.

                                                                                              While SSH could be used to start a PPP daemon to create a more traditional VPN with an
                                                                                              interface, recent versions of OpenSSH have added native functionality for binding the SSH
                                                                                              protocol to tunnel interfaces on the hosts. An SSH tunnel creates a tun interface on the local and
                                                                                              remote hosts, and these tun interfaces can be configured with other IP addresses, thereby
                                                                                              providing a true remote access VPN.

                                                                                              As with SSL VPNs, SSH VPNs perform badly if there is packet loss due to multiple TCP layers
                                                                                              independently retransmitting packets.




                                                                                                                                              90
