                                                                                               NIST SP 800-56B REV. 2                           RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                     USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                               establishment key pair that is used in the key-establishment process. Unilateral key confirmation
                                                                                               may be added in either direction to a KAS2 scheme (see Sections 8.3.3.2 and 8.3.3.3); it may also
                                                                                               be added to a KAS1 or KTS-OAEP scheme, but only with party V (the party contributing the key
                                                                                               pair) acting as the key-confirmation provider, and party U acting as the key-confirmation recipient
                                                                                               (see Sections 8.2.3.1 and 9.2.4.2).

                                                                                               5.6.2 Bilateral Key Confirmation for KAS2 Schemes
                                                                                               Bilateral key confirmation, as specified in this Recommendation, can be incorporated into a KAS2
                                                                                               key-agreement scheme since each party is required to own a key-establishment key pair that is
                                                                                               used in the key-agreement process. Bilateral key confirmation is accomplished by performing
                                                                                               unilateral key confirmation in both directions (with party U providing MacTagU to KC recipient
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                               V, and party V providing MacTagV to KC recipient U) during the same scheme.
                                                                                               To include bilateral key confirmation, two instances of unilateral key confirmation (as specified
                                                                                               in Section 5.6.1, subject to the modifications listed below) shall be incorporated into the KAS2
                                                                                               scheme, once with party U as the key-confirmation provider (i.e., P = U and R = V) and once with
                                                                                               party V as the key-confirmation provider (i.e., P = V and R = U). Additional details will be
                                                                                               provided in Section 8.3.3.4.
                                                                                               In addition to setting P = U and R = V in one instance of the unilateral key-confirmation procedure
                                                                                               described in Section 5.6.1 and setting P = V and R = U in a second instance, the following
                                                                                               changes/clarifications apply when using the procedure for bilateral key confirmation:
                                                                                                  1. When computing MacTagU, the value of message_stringU that forms the initial segment of
                                                                                                     MacDataU is the six-byte character string “KC_2_U”.
                                                                                                  2. When computing MacTagV, the value of message_stringV that forms the initial segment of
                                                                                                     MacDataV is the six-byte character string “KC_2_V”.
                                                                                                  3. If used at all, the value of the (optional) byte string TextU used to form the final segment of
                                                                                                     MacDataU can be different than the value of the (optional) byte string TextV used to form
                                                                                                     the final segment of MacDataV, provided that both parties are aware of the value(s) used.
                                                                                                  4. The identifiers used to label the parties U and V when forming MacDataU shall be the same
                                                                                                     as the identifiers used to label the parties U and V when forming MacDataV, although IDU
                                                                                                     and IDV will play different roles in the two strings. If IDP = IDU and IDR = IDV are used in
                                                                                                     MacDataU, then IDP = IDV and IDR = IDU are used in MacDataV.

                                                                                               5.6.3 Selecting the MAC and Other Key-Confirmation Parameters
                                                                                               Key confirmation as specified in this Recommendation requires that a MacKey of an appropriate
                                                                                               length be generated or obtained as part of the derived keying material (see Section 5.6.1). The
                                                                                               MacKey is then used with a MAC algorithm to generate a MAC; the length of the MAC output by
                                                                                               the MAC algorithm is MacOutputBits bits. The MAC is subsequently used to form a MAC tag
                                                                                               (see Section 5.6.1 for the generation of the MAC and Section 5.2.1 for the formation of the MAC
                                                                                               tag from the MAC).
                                                                                               Table 1 provides a list of approved MAC algorithms for key confirmation and the security
                                                                                               strengths that each can support, along with the corresponding value of MacOutputBits and
                                                                                               permissible MacKey lengths for each MAC algorithm.
                                                                                                                                               33
