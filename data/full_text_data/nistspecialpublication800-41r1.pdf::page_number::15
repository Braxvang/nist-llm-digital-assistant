                                                                          GUIDELINES ON FIREWALLS AND FIREWALL POLICY


session has ended, the entry is removed from the state table after a preconfigured timeout value is
reached. Application-level firewalls that are able to recognize DNS over UDP will terminate a session
after a DNS response is received, and may act similarly with the Network Time Protocol (NTP).

2.1.3   Application Firewalls

A newer trend in stateful inspection is the addition of a stateful protocol analysis capability, referred to by
some vendors as deep packet inspection. Stateful protocol analysis improves upon standard stateful
inspection by adding basic intrusion detection technology—an inspection engine that analyzes protocols
at the application layer to compare vendor-developed profiles of benign protocol activity against observed
events to identify deviations. This allows a firewall to allow or deny access based on how an application
is running over the network. For instance, an application firewall can determine if an email message
contains a type of attachment that the organization does not permit (such as an executable file), or if
instant messaging (IM) is being used over port 80 (typically used for HTTP). Another feature is that it can
block connections over which specific actions are being performed (e.g., users could be prevented from
using the FTP “put” command, which allows users to write files to the FTP server). This feature can also
be used to allow or deny web pages that contain particular types of active content, such as Java or
ActiveX, or that have SSL certificates signed by a particular certificate authority (CA), such as a
compromised or revoked CA.

Application firewalls can enable the identification of unexpected sequences of commands, such as issuing
the same command repeatedly or issuing a command that was not preceded by another command on
which it is dependent. These suspicious commands often originate from buffer overflow attacks, DoS
attacks, malware, and other forms of attack carried out within application protocols such as HTTP.
Another common feature is input validation for individual commands, such as minimum and maximum
lengths for arguments. For example, a username argument with a length of 1000 characters is
suspicious—even more so if it contains binary data. Application firewalls are available for many common
protocols including HTTP, database (such as SQL), email (SMTP, Post Office Protocol [POP], and
Internet Message Access Protocol [IMAP]) 3 , voice over IP (VoIP), and Extensible Markup Language
(XML). 4

Another feature found in some application firewalls involves enforcing application state machines, which
are essentially checks on the traffic’s compliance to the standard for the protocol in question. This
compliance checking, sometimes call “RFC compliance” because most protocols are defined in RFCs
issued by the Internet Engineering Task Force (IETF), can be a mixed blessing. Many products
implement protocols in ways that almost, but not completely, match the specification, so it is usually
necessary to let such implementations communicate across the firewall. Compliance checking is only
useful when it detects and blocks communication that can be harmful to protected systems.

Firewalls with both stateful inspection and stateful protocol analysis capabilities are not full-fledged
intrusion detection and prevention systems (IDPS), which usually offer much more extensive attack
detection and prevention capabilities. For example, IDPSs also use signature-based and/or anomaly-based
analysis to detect additional problems within network traffic. 5



3
    For additional information about email security, see NIST Special Publication (SP) 800-45 Version 2, Guidelines on
    Electronic Mail Security (http://csrc.nist.gov/publications/PubsSPs.html).
4
    For additional information about XML and XML firewalls, see NIST SP 800-95, Guide to Secure Web Services
    (http://csrc.nist.gov/publications/PubsSPs.html).
5
    For additional information about IDPS, see NIST SP 800-94, Guide to Intrusion Detection and Prevention Systems (IDPS)
    (http://csrc.nist.gov/publications/PubsSPs.html).


                                                           2-5
