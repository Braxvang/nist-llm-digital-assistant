                                                                                               NIST SP 800-56A Rev. 3                                 Recommendation for Pair-Wise Key Establishment
                                                                                                                                                              Using Discrete Logarithm Cryptography

                                                                                                      computation of Z; then output an error indicator, and exit this process without
                                                                                                      performing the remaining actions.
                                                                                                  4. Use the agreed-upon key-derivation method to derive secret keying material with the
                                                                                                     specified length from the shared secret value Z and other input (see Section 5.8). If
                                                                                                     the key-derivation method outputs an error indicator, destroy all copies of Z and the
                                                                                                     ephemeral private key de,U; then output an error indicator, and exit this process
                                                                                                     without performing the remaining actions.
                                                                                                  5. Destroy de,U and all copies of the shared secret Z.
                                                                                                  6. Output the derived keying material.
                                                                                               Output: The derived keying material or an error indicator.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                               Note: Key confirmation can be incorporated into this scheme. See Section 6.1.1.5 for details.
                                                                                               The Full MQV is summarized in Table 12.
                                                                                                                 Table 12: Full MQV key-agreement scheme summary

                                                                                                                                     Party U                                 Party V

                                                                                                Domain                  D = (q, FR, a, b{, SEED}, G, n, h) D = (q, FR, a, b{, SEED}, G, n, h)
                                                                                                parameters

                                                                                                Static data             1. Static private key ds,U             1. Static private key ds,V
                                                                                                                        2. Static public key Qs,U              2. Static public key Qs,V

                                                                                                Ephemeral data          1. Ephemeral private key de,U          1. Ephemeral private key de,V
                                                                                                                        2. Ephemeral public key Qe,U           2. Ephemeral public key Qe,V

                                                                                                                        Compute Z by calling ECC MQV Compute Z by calling ECC MQV
                                                                                                Computation
                                                                                                                        using ds,U, Qs,V, de,U, Qe,U, and Qe,V using ds,V, Qs,U, de,V, Qe,V, and Qe,U

                                                                                                                        1. Compute                             1. Compute
                                                                                                Derive secret              DerivedKeyingMaterial                  DerivedKeyingMaterial
                                                                                                keying material
                                                                                                                        2. Destroy Z                           2. Destroy Z

                                                                                               6.1.1.5 Incorporating Key Confirmation into a C(2e, 2s) Scheme
                                                                                               The subsections that follow illustrate how to incorporate key confirmation (as described in
                                                                                               Section 5.9) into the C(2e, 2s) key-agreement schemes described above.
                                                                                               The flow depictions separate the key-establishment flow from the key-confirmation flow.
                                                                                               The depictions and accompanying discussions presume that the assumptions of the scheme
                                                                                               have been satisfied, that the key-agreement transaction has proceeded successfully through
                                                                                               key derivation, and that the received MacTags are successfully verified as specified in
                                                                                               Section 5.2.2.

                                                                                                                                                 74
