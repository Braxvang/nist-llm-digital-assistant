                                                                                               NIST SP 800-177 REV. 1                                                         TRUSTWORTHY EMAIL




                                                                                                                              Figure 5-2: Sending an Encrypted Email

                                                                                               To send an S/MIME encrypted message (Fig 2-4) to a user, the sender must ﬁrst obtain the
                                                                                               recipient's X.509 certiﬁcate and may (optionally) validate the certiﬁcate to a trusted root, if
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-177r1




                                                                                               possible. �e sender then uses the certiﬁcate’s public key to generate a data encryption key and
                                                                                               use that generated key to encrypt the composed message. In this case the sender must possess the
                                                                                               recipient's certiﬁcate before sending the message.

                                                                                               An enterprise looking to use S/MIME to provide email conﬁdentiality will need to obtain or
                                                                                               produce credentials for each end user in the organization. An organization can generate its own
                                                                                               root certiﬁcate and give its members a certiﬁcate generated from that root, or purchase
                                                                                               certiﬁcates for each member from a well-known Certiﬁcate Authority (CA).

                                                                                               Using S/MIME for end-user encryption is further complicated by the need to distribute each end-
                                                                                               users’ certiﬁcate to potential senders. Traditionally this is done by having correspondents
                                                                                               exchange email messages that are digitally signed that includes the sender’s encryption
                                                                                               certiﬁcate, but not encrypted. Alternatively, organizations can conﬁgure LDAP servers to make
                                                                                               S/MIME public keys available as part of a directory lookup; mail clients such as Outlook and
                                                                                               Apple Mail can be conﬁgured to query LDAP servers for public keys necessary for message
                                                                                               encryption.

                                                                                               5.3.1.1 S/MIME Recommendations

                                                                                               Oﬃcial use requires certiﬁcate chain authentication against a known Certiﬁcate Authority.

                                                                                               Current MUAs use S/MIME private keys to decrypt the data encryption key that was used to
                                                                                               encrypt the email message each time that it is displayed, but leave the message encrypted in the
                                                                                               email store. �is mode of operation is not recommended, as it forces the recipient of the
                                                                                               encrypted email to maintain their private key indeﬁnitely. Instead, the email should be decrypted
                                                                                               prior to being stored in the mail store. �e mail store, in turn, should be secured using an
                                                                                               appropriate cryptographic technique (for example, disk encryption), extending protection to both
                                                                                               encrypted and unencrypted email. If it is necessary to store mail encrypted on the mail server (for
                                                                                               example, if the mail server is outside the control of the end-user’s organization), then the
                                                                                               messages should be re-encrypted with a changeable session key on a message-by-message basis.



                                                                                                                                               72
