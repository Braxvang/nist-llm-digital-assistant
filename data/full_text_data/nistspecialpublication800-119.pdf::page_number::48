                                                                GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


  3.5.3   Neighbor Discovery

ND, described in RFC 4861, is the process by which an IPv6 node may learn important information such
as link layer addresses of interfaces on the same local segment. ND effectively replaces the ARP found
in IPv4. Additionally, it combines this with ICMP Router Discovery and Redirect capabilities. This
subsection describes ND in brief, and improvements over the IPv4 set of protocols are noted.

IPv4 is limited in determining whether a neighbor is reachable. The Neighbor Discovery Protocol (NDP)
for IPv6 specification is used by all nodes, hosts and routers. IPv6 nodes use ND for the following
purposes:4

        For autoconfiguration of IPv6 addresses

        To determine network prefixes and other configuration information

        For Duplicate Address Detection (DAD)

        To determine layer two addresses of nodes on the same link (address resolution)

        To find neighboring routers that can forward their packets

        To keep track of which neighbors are reachable and which are not (Neighbor Unreachability
         Detection, or NUD)

        To detect changed link-layer addresses.

As described in RFC 4861, nodes use ND to determine the link-layer addresses for neighbors known to
reside on attached links and to purge cached values that become invalid. Hosts also use ND to find
neighboring routers that are willing to forward packets on their behalf. Finally, nodes use the protocol to
keep track of which neighbors are reachable and which are not, and to detect changed link-layer
addresses. When a router or the path to a router fails, a host actively searches for functioning alternates.

ND plays an important role in addressing because it provides address resolution and address
autoconfiguration. These are accomplished through the different processes in the ND protocol, which
consists of five different ICMP packet types: a pair of Router Solicitation and Router Advertisement
messages, a pair of Neighbor Solicitation and Neighbor Advertisement messages, and a Redirect message
(listed above under ICMPv6 informational messages). RFC 4861 defines the purpose of these messages,
which are all sent via multicast ICMPv6:

        Router Solicitation (RS). When an interface becomes enabled, hosts may send RSs that
         request routers to generate RAs immediately rather than at their next scheduled time.

        Router Advertisement (RA). Routers advertise their presence together with various link and
         Internet parameters either periodically or in response to a RS message. RAs contain prefixes
         used for on-link determination and address configuration, a suggested hop limit value, the
         Maximum Transmission Unit (MTU) for the link, etc.

        Neighbor Solicitation (NS). Nodes send NSs to determine the link-layer address of a
           neighbor or to verify that a neighbor is still reachable via a cached link-layer address.
           NSs are also used for Duplicate Address Detection (DAD).



                                                    3-26
