       NIST SP 800-90C 3pd (Third Public Draft)                                  Recommendation for RBG Constructions
       September 2022

 990   One of the following calls shall be used for external conditioning when the conditioning function
 991   is based on a hash function:
 992          1. Using an approved hash function directly:
 993                                  conditioned_output = Hash(entropy_bitstring),
 994              where the hash function operates on the entropy_bitstring provided as input.
 995          2. Using HMAC with an approved hash function:
 996                              conditioned_output = HMAC(Key, entropy_bitstring),
 997              where HMAC operates on the entropy_bitstring using a Key determined as specified in
 998              Section 3.3.1.1.
 999          3. Using Hash_df as specified in SP 800-90A:
1000                         conditioned_output = Hash_df(entropy_bitstring, output_len),
1001              where the derivation function operates on the entropy_bitstring provided as input to
1002              produce a bitstring of output_len bits.
1003   In all three cases, the length of the conditioned output is equal to the length of the output block of
1004   the selected hash function (i.e., output_len).

1005   3.3.1.3.           Block Cipher-based Conditioning Functions
1006   Conditioning functions may be based on approved block ciphers. 10 TDEA shall not be used as
1007   the block cipher (see Section 2.6).
1008   For block cipher-based conditioning functions, one of the following calls shall be used for external
1009   conditioning:
1010          1. Using CMAC (as specified in [SP800-38B]) with an approved block cipher:
1011                              conditioned_output = CMAC(Key, entropy_bitstring),
1012              where CMAC operates on the entropy_bitstring using a Key determined as specified in
1013              Section 3.3.1.1.
1014          2. Using CBC-MAC (specified in Appendix F of [SP800-90B]) with an approved block
1015             cipher:
1016                           conditioned_output = CBC-MAC(Key, entropy_bitstring),
1017              where CBC-MAC operates on the entropy_bitstring using a Key determined as specified
1018              in Section 3.3.1.1.




       10
            At the time of publication, only AES-128, AES-192, and AES-256 were approved as block ciphers for the
            conditioning functions (see SP 800-90B). In all three cases, the block length is 128 bits.

                                                               23
