NIST SP 800-85A-4                                          PIV CARD APPLICATION & MIDDLEWARE
                                                                    INTERFACE TEST GUIDELINES

                        Note: Use of the pairing code with pivLogIntoCardApplication does
                        not enable read access to PIN-protected data objects. Also, biometric
                        data objects will not be accessible when using OCC data as an
                        authenticator.


B.4.2           Test Assertions for Error Conditions

B.4.2.1          Attempt Logon with an Invalid cardHandle
 Purpose               Ensure the PIV Middleware detects and processes an invalid card
                       handle.
 Target                 pivLogIntoCardApplication
 Reference(s)           1.   SP 800-73-4 Part 3, Section 3.2.3
                        2.   AS04.05
 Precondition(s)        1.   The card has established a connection to the client.
                        2.   The cardHandle was properly initialized by pivConnect.
                        3.   The client application has successfully executed the
                             pivSelectCardApplication command.
 Test Steps             1. Set cardHandle := <<an invalid cardHandle>>
                        2. Set authenticators := <<valid authenticators byte
                           sequence>>
                        3. Call pivLogIntoCardApplication with
                           • (IN) cardHandle
                           • (IN) authenticators
                           • (IN) AuthLength
 Expected Result(s)     Call returns with status_word of PIV_INVALID_CARD_HANDLE.
 Postcondition(s)       The client application is not logged into the PIV Card Application
                        and was not able to update the application security status with the
                        PIV Card Application.


B.4.2.2          Attempt Logon with a Malformed Authenticator
 Purpose               Ensure the PIV Middleware detects and processes a malformed
                       authenticator byte sequence.
 Target                 pivLogIntoCardApplication
 Reference(s)           1.   SP 800-73-4 Part 3, Section 3.2.3
                        2.   AS04.05
 Precondition(s)        1.   The card has established a connection to the client.
                        2.   The cardHandle was properly initialized by pivConnect.
                        3.   The client application has successfully executed the
                             pivSelectCardApplication command.
 Test Steps             1. Set cardHandle := <<a valid cardHandle>>
                        2. Set authenticators := <<a malformed authenticators byte
                           sequence>>
                        3. Call pivLogIntoCardApplication with



                                         B-10
