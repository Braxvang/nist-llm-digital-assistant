                                                                                             NIST SP 800-189                                                             RESILIENT INTERDOMAIN TRAFFIC EXCHANGE:
                                                                                                                                                                                 BGP SECURITY & DDOS MITIGATION

                                                                                                      4.5.1) except that the last two bullets are modified as follows: 12

                                                                                                           •    Prefixes learned from AS’s lateral peers (see Security Recommendations in
                                                                                                                Section 4.9)
                                                                                                           •    Prefixes learned from AS’s other transit providers (see Security
                                                                                                                Recommendations in Section 4.9)

                                                                                             4.5.3    Prefix Filtering with Customer

                                                                                             Inbound prefix filtering: There are two scenarios that require consideration. Scenario 1 is
                                                                                             when there is full visibility of the customer and its cone of customers (if any) as well as
                                                                                             knowledge of prefixes that originated from such a customer and its cone. The knowledge of
                                                                                             prefixes can be based on direct customer knowledge, IRR data, and/or RPKI data (if that data is
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-189




                                                                                             known to be in a complete and well-maintained state for the customer in consideration and its
                                                                                             customer cone). The prefixes thus known for the customer and its customer cone are listed in the
                                                                                             configuration of the eBGP router in question.

                                                                                                      Security Recommendation 30: Inbound prefix filtering facing customer in
                                                                                                      Scenario 1 – Only the prefixes that are known to be originated from the customer and its
                                                                                                      customer cone should be accepted, and all other route announcements should be rejected.

                                                                                             Scenario 2 is when there is not a reliable knowledge of all prefixes originated from the customer
                                                                                             and its cone of customers.

                                                                                                      Security Recommendation 31: Inbound prefix filtering facing customer in
                                                                                                      Scenario 2 – The same set of inbound prefix filters should be applied as those for a
                                                                                                      lateral peer (see Section 4.5.1).

                                                                                                      Security Recommendation 32: Outbound prefix filtering facing customer – The
                                                                                                      filters applied in this case would vary depending on whether the customer wants to
                                                                                                      receive only the default route or the full routing table. If it is the former, then only the
                                                                                                      default route should be announced and nothing else. In the latter case, the following
                                                                                                      outbound prefix filters should be applied: 13

                                                                                                           •    Special-purpose prefixes
                                                                                                           •    Prefixes that exceed a specificity limit

                                                                                             4.5.4    Prefix Filtering Performed in a Leaf Customer Network

                                                                                             A leaf customer network is one which is single-homed to a transit provider and has no lateral
                                                                                             peers or customer ASes downstream.

                                                                                                      Security Recommendation 33: Inbound prefix filtering for leaf customer facing
                                                                                                      transit provider – A leaf customer may request only the default route from its transit


                                                                                             12
                                                                                                In conjunction with Security Recommendation 29, some policy rules may also be applied if a transit provider is not contracted
                                                                                                   (or chosen) to provide transit for some subset of outbound prefixes.
                                                                                             13
                                                                                                The default route filter may be added if the customer requires the full routing table but not the default route.

                                                                                                                                                            21
