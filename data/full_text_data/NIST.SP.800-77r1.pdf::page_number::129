                                                                                              NIST SP 800-77 REV. 1                                                               GUIDE TO IPSEC VPNS


                                                                                              but outside the private cloud itself would be encrypted. Only the virtual machines of the agency
                                                                                              would be able to see the unencrypted traffic.

                                                                                              Using a network layer VPN would allow the agency to extend the solution by adding IPsec VPN
                                                                                              tunnels to other cloud providers or new physical locations. It could extend the solution to
                                                                                              building more VPN tunnels to other physical locations or other cloud providers. A VPN tunnel
                                                                                              could even be used to move a single server to another cloud provider without reconfiguring any
                                                                                              other virtual servers in the private cloud.

                                                                                              9.3.2   Designing the Solution
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              Since the agency is using Linux-based virtual machines at the cloud provider, it will also use a
                                                                                              Linux-based virtual machine as its VPN server in the private cloud. It decides to use the
                                                                                              Libreswan IPsec software that comes with the Linux distribution that it is using for its cloud
                                                                                              instances. The agency already has an enterprise Linux-based server as its internet access and
                                                                                              firewall server, so it decides to extend that server to build an IPsec VPN to the private cloud
                                                                                              network. This enterprise Linux server also uses Libreswan. See Figure 19 for illustration of the
                                                                                              network layout.




                                                                                                                                     Virtual
                                                                                                                                     VPN
                                                                                                                                     Server
                                                                                                                      Figure 19: Remote Access to a Cloud-Based Virtual Network

                                                                                              After designing the architecture, the company considers other elements of the design and makes
                                                                                              several decisions, including the following:

                                                                                                 â€¢    Authentication. Libreswan supports and defaults to using IKEv2. Since both VPN
                                                                                                      endpoints are controlled by the agency, it decides to use public keys for authentication
                                                                                                      without using certificates. Using public keys without a CA is also much simpler. The
                                                                                                      agency has full flexibility with controlling the updates of the key pairs according to its
                                                                                                      own policy without the involvement of a CA.



                                                                                                                                                112
