                             NIST SP 800-135, Revision 1



secret is then input into the HMAC-MD5/HMAC-SHA1 PRF with other non-secret
values to derive keying material for the negotiated cryptographic functions; in this
case, the PRF acts as the key expansion step in the E-E KDF.
The HMAC-MD5/HMAC-SHA1 PRF contains two functions: P_MD5 and P_SHA1,
which use MD5-HMAC and SHA-1-HMAC as the core functions, respectively. The
specifications of P_MD5 and P_SHA-1 are in Section 5 of RFC 2246 (the function
called P_hash in the RFC). The P_HASH function (P_MD5 or P_SHA-1) uses the
double-pipeline iteration mode and HMAC-PRF specified in SP 800-108.
The outputs from both P_MD5 and P_SHA-1 are XORed together to produce the PRF
output. This PRF is used as both a randomness extraction step to generate the master
secret and as a key expansion step to derive keying material for the protocol from the
master secret.
The TLS 1.0 and 1.1 KDF is approved when the following conditions are satisfied:
    (1) The TLS 1.0 and 1.1 KDF is performed in the context of the TLS protocol.
    (2) SHA-1 and HMAC are as specified in FIPSs 180-3 and 198-1, respectively.
Note that MD5 and HMAC-MD5 shall not be used as a general hash function or
HMAC function, respectively.

4.2.2   Key Derivation in TLS version 1.2
In TLS version 1.2 (TLS 1.2), the pre-master secret is input into an HMAC-SHA-256
PRF 5 with some non-secret values to produce a master secret; the PRF acts as the
randomness extraction step in an E-E KDF. The master secret is then input into the
HMAC-SHA-256 PRF with some other non-secret values to derive keying material
for the negotiated cryptographic functions; in this case, the PRF acts as the key
expansion step in the E-E KDF.
The HMAC-SHA-256 PRF is P_SHA256. This PRF is used instead of the PRF in
TLS 1.0 and 1.1 which is (P_MD5 ïƒ… P_SHA-1).
In TLS 1.2, in addition to P_SHA256, any P_HASH with a stronger hash function,
such as SHA-384 or SHA-512 (in FIPS 180-3), can be used as the PRF.
The TLS 1.2 KDF is an approved KDF when the following conditions are satisfied:
    (1) The TLS 1.2 KDF is performed in the context of the TLS protocol.
    (2) HMAC is as specified in FIPS 198-1.
    (3) P_HASH uses either SHA-256, SHA-384 or SHA-512.




5
 The HMAC-SHA-256 PRF uses HMAC-SHA-256 as the core function in its construction, as
specified in RFC 5246, Section 5.


                                            11
