                                                                                             NIST SP 800-90B                                                      RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                          USED FOR RANDOM BIT GENERATION

                                                                                                1. Find the largest t such that the number of occurrences of the most common t-tuple in S is
                                                                                                   at least 35.
                                                                                                2. Let Q[i] store the number of occurrences of the most common i-tuple in S for i = 1, ..., t.
                                                                                                   For example, in S=(2, 2, 0, 1, 0, 2, 0, 1, 2, 1, 2, 0, 1, 2, 1, 0, 0, 1, 0, 0, 0), Q[1] =
                                                                                                   max(#0’s,#1’s,#2’s) = #0’s = 9, and Q[2] = 4 is obtained by the number of the tuple 01 in
                                                                                                   S.
                                                                                                3. For i = 1 to t, let P[i] = Q[i] / (L-i+1), and compute an estimate on the maximum individual
                                                                                                   sample value probability as 𝑃𝑃𝑚𝑚𝑚𝑚𝑚𝑚 [𝑖𝑖] = 𝑃𝑃[𝑖𝑖]1/𝑖𝑖 . Let 𝑝𝑝̂ max= max (𝑃𝑃𝑚𝑚𝑚𝑚𝑚𝑚 [1], … , 𝑃𝑃𝑚𝑚𝑚𝑚𝑚𝑚 [𝑡𝑡]).

                                                                                                4. Calculate an upper bound on the probability of the most common value 𝑝𝑝𝑢𝑢 as
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                                                                                            𝑝𝑝̂𝑚𝑚𝑚𝑚𝑚𝑚 (1 − 𝑝𝑝̂𝑚𝑚𝑚𝑚𝑚𝑚 )
                                                                                                                           𝑝𝑝𝑢𝑢 = min �1, 𝑝𝑝̂𝑚𝑚𝑚𝑚𝑚𝑚 + 2.576�                           �,
                                                                                                                                                                      𝐿𝐿 − 1

                                                                                                5. The entropy estimate is calculated as –log2 (𝑝𝑝𝑢𝑢 ).
                                                                                             Example: For the purpose of this example, suppose that the cutoff is 3 instead of 35 in step one.
                                                                                             Suppose that S = (2, 2, 0, 1, 0, 2, 0, 1, 2, 1, 2, 0, 1, 2, 1, 0, 0, 1, 0, 0, 0), and L = 21. The number
                                                                                             of occurrences of the most common 4-tuple is 2, which falls below the threshold, and therefore t
                                                                                             = 3. In step 2, Q[1] = 9, Q[2] = 4, and Q[3] = 3. P[1] = 0.4286, P[2] = 0.2, P[3] = 0.1579. Pmax[1]
                                                                                             = 0.4286, Pmax[2] = 0.4472, Pmax[3] = 0.5405, and 𝑝𝑝̂ max=0.5405. The upper bound of a 99 %
                                                                                             confidence interval is 0.8276. The min-entropy estimate is −log2 (0.8276) = 0.273.

                                                                                             6.3.6   Longest Repeated Substring (LRS) Estimate

                                                                                             This method estimates the collision entropy (sampling without replacement) of the source, based
                                                                                             on the number of repeated substrings (tuples) within the input dataset. Although this method
                                                                                             estimates collision entropy (an upper bound on min-entropy), this estimate handles tuple sizes that
                                                                                             are too large for the t-tuple estimate, and is therefore a complementary estimate.

                                                                                             Given the input S = (s1, …, sL), where si ϵ A = {x1, …, xk},

                                                                                                1. Find the smallest u such that the number of occurrences of the most common u-tuple in S
                                                                                                   is less than 35.
                                                                                                2. Find the largest v such that the number of occurrences of the most common v-tuple in S is
                                                                                                   at least 2, and the most common (v+1)-tuple in S occurs once. In other words, v is the
                                                                                                   largest length that a tuple repeat occurs. If v < u, this estimate cannot be computed.
                                                                                                3. For W = u to v, compute the estimated W-tuple collision probability
                                                                                                                                                         ∑𝑖𝑖�𝐶𝐶2𝑖𝑖 �
                                                                                                                                             𝑃𝑃𝑊𝑊 =                    ,
                                                                                                                                                      �𝐿𝐿−𝑊𝑊+1
                                                                                                                                                          2
                                                                                                                                                              �
                                                                                                     where Ci is the number of occurrences of the ith unique W-tuple. Compute the estimated
                                                                                                     average collision probability per string symbol as 𝑃𝑃𝑚𝑚𝑚𝑚𝑚𝑚,𝑊𝑊 = 𝑃𝑃𝑊𝑊 1/𝑊𝑊 . Let 𝑝𝑝̂ =
                                                                                                     max(𝑃𝑃𝑚𝑚𝑚𝑚𝑚𝑚,𝑢𝑢 , … , 𝑃𝑃𝑚𝑚𝑚𝑚𝑚𝑚,𝑣𝑣 ).

                                                                                                                                                    48
