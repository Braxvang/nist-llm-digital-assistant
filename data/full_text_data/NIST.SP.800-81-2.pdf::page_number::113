                                                         SECURE DOMAIN NAME SYSTEM (DNS) DEPLOYMENT GUIDE



servers to increase the availability of the DNS service for end users. This can be done manually, or using
a protocol like DHCP.

There is a known class of malware that attempts to change the settings on a system’s stub resolver to
direct queries to another (usually malicious) recursive server. The server may then direct end users to a
malicious site where another attack takes place, or the server may simply direct users to a webpage that
serves ads or similar non-intended content. To combat this, administrators should make sure end user
systems have the latest anti-virus/malware software and should consider blocking all outbound DNS
traffic with the exception of known recursive servers.


Checklist item 38: Administrators should configure two or more recursive resolvers for each stub client
on the network.

Checklist item 39: Enterprise firewalls should consider restricting outbound DNS traffic to only the
enterprise’s designated recursive resolvers.



12.2 Guidelines for Establishing Servers

Enterprise network administrators should set up their recursive server infrastructure with availability and
speed of service in mind. However, security is a concern as well as enterprises realize the vulnerability of
the DNS to spoofing and importance of monitoring DNS traffic.

12.2.1 Aggregate Caches

Larger enterprises that want to minimize their external network presence may want to consider deploying
aggregate caches. An aggregate cache is a recursive resolve that exists on an enterprises’ DMZ and only
accepts forwarded queries from other recursive resolvers (sometimes called forwarders in this scenario).
This reduces the number of servers that need monitoring on the DMZ, but still allows for local recursive
servers for separate network segments in an enterprise.

The figure below shows how multiple forwarders send queries to the aggregate cache, which then
performs any recursion necessary to find the final answers. The individual forwarders may have their
own cache, as well as act as secondaries for internal zones. This is to provide faster service for local stub
resolvers.




                                                   12-15
