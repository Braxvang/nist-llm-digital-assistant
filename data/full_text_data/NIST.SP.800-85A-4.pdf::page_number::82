NIST SP 800-85A-4                                          PIV CARD APPLICATION & MIDDLEWARE
                                                                    INTERFACE TEST GUIDELINES

                       3. Create data reference
                       4. Call pivGetData with
                          • (IN) cardHandle
                          • (IN) OID
                          • (IN) oidLength
                          • (OUT) data
                          • (INOUT) DataLength
 Expected Result(s)    Call returns with status_word of PIV_INVALID_OID and does not set
                       data reference.
 Postcondition(s)      The client application remains in the state it had before the call.


B.6.2.3       The Client Application Handles Missing Data Object
 Purpose             Ensure the PIV Middleware recognizes and handles a missing OID.
 Target              pivGetData
 Reference(s)        1. SP 800-73-4 Part 3, Section 3.2.4
                     2. AS04.06
 Precondition(s)     1. The PIV Card does not have a container for one (or more)
                         optional data object.
                     2. The client application owns a connection to the PIV Card
                         Application accessible through cardHandle.
                     3. The client is logged into the PIV Card Application.
 Test Steps          1. Set cardHandle := <<valid cardHandle>>
                       2. Set OID := <<valid OID>> (Found in Table 3 of SP 800-73-4
                          Part 1 that is not present on the PIV Card (i.e., no
                          container is allocated)
                       3. Create data reference
                       4. Call pivGetData with
                          • (IN) cardHandle
                          • (IN) OID
                          • (IN) oidLength
                          • (OUT) data
                          • (INOUT) DataLength
 Expected Result(s)    Call returns with status_word of PIV_DATA_OBJECT_NOT_FOUND and
                       does not initialize data reference.
 Postcondition(s)      The client application remains in the state it had before the call.


B.6.2.4         The Client Application Handles Zero-Length Data Object
 Purpose               Ensure the PIV Middleware recognizes and handles a data object
                       that has a container, but is not used.
 Target                pivGetData
 Reference(s)          1. SP 800-73-4 Part 3, Section 3.2.4
                       2. AS04.06
 Precondition(s)       1. The PIV Card has containers for one or more optional data
                          objects, but the data objects have not been used.


                                       B-16
