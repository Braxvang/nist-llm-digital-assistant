                                      GUIDE TO MALWARE INCIDENT PREVENTION AND HANDLING FOR DESKTOPS AND LAPTOPS


3.4.2   Intrusion Prevention Systems

Network-based intrusion prevention systems (IPS) perform packet sniffing and analyze network traffic to
identify and stop suspicious activity. 9 Network-based IPS products are typically deployed inline, which
means that the software acts like a network firewall. It receives packets, analyzes them, and allows
acceptable packets to pass through. The network-based IPS architecture allows some attacks to be
detected on networks before they reach their intended targets. Most network-based IPS products use a
combination of attack signatures and analysis of network and application protocols, which means that
they compare network activity for frequently attacked applications (e.g., email servers, web servers) to
expected behavior to identify potentially malicious activity.

Network-based IPS products are used to detect many types of malicious activity besides malware, and
typically can detect only a few instances of malware by default, such as recent major worms. However,
some IPS products are highly customizable, allowing administrators to create and deploy attack signatures
for many major new malware threats in a matter of minutes. Although there are risks in doing this, such
as a poorly written signature triggering false positives that block benign activity inadvertently, a custom
signature can block a new malware threat hours before antivirus signatures become available. Network-
based IPS products can be effective at stopping specific known threats, such as network service worms,
and email–borne malware with easily recognizable characteristics (e.g., subject, attachment filename).

Another form of IPS, known as a network behavior analysis (NBA) system, attempts to stop attacks by
identifying unusual network traffic flows. Although these products are primarily intended to stop
distributed denial of service (DDoS) attacks against an organization, they can also be used to identify
worm activity and other forms of malware, as well as use of attacker tools such as backdoors and email
generators. An NBA system typically works by monitoring normal network traffic patterns, including
which hosts communicate with each other using which protocols, and the typical and peak volumes of
activity, to establish baselines. The software then monitors network activity to identify significant
deviations from the baselines. If malware causes a particularly high volume of network traffic or uses
network or application protocols that are not typically seen, an NBA system should be able to detect and,
if deployed inline, block the activity. Another way of limiting some malware incidents is by configuring
network devices to limit the maximum amount of bandwidth that can be used by particular hosts or
services. Also, some types of network monitoring software can detect and report significant deviations
from expected network activity, although this software typically cannot specifically label the activity as
malware-related or block it.

Host-based IPS products are similar in principle and purpose to other IPSs, except that a host-based IPS
product monitors the characteristics of a single host and the events occurring within that host. Examples
of activity that might be monitored by host-based IPSs include network traffic, host logs, running
processes, file access and modification, and host and application configuration changes. Host-based IPS
products often use a combination of attack signatures and knowledge of expected or typical behavior to
identify known and unknown attacks on hosts. For example, host-based IPS products that monitor
attempted changes to files can be effective at detecting viruses attempting to infect files and Trojan horses
attempting to replace files, as well as the use of attacker tools, such as rootkits, that often are delivered by
malware. If a host-based IPS product monitors the host’s network traffic, it offers detection capabilities
similar to a network-based IPS’s.




9
    Intrusion prevention systems are similar to intrusion detection systems (IDS), except that IPSs can attempt to stop malicious
    activity, whereas IDSs cannot. This section discusses the use of IPSs, not IDSs, for preventing or containing malware
    incidents. Section 4 describes how both IPS and IDS technologies can be used for malware incident detection.


                                                              12
