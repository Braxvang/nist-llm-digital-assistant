5.4       Hash-based Key Derivation Functions
Hash functions can be used as building blocks in key derivation functions (KDFs) (e.g.,
as specified in SP 800-56A, SP 800-56B, SP 800-56C and SP 800-108).
The KDFs specified in future versions of SPs 800-56A and B are expected to use the hash
functions either directly or indirectly in an HMAC construction. The method specified in
SP 800-56C is an additional approved method for key derivation purposes in SPs 800-
56A and B. The key derivation functions in SP 800-56A, B and C are used to generate
(i.e., derive) secret keying material from a shared secret computed during a key
agreement transaction between communicating parties.
The hash-based KDFs specified in SP 800-108 use an HMAC construction and can be
used either: (1) to derive keying material from an existing key, or (2) as a key-expansion
step in the key derivation method specified in SP 800-56C.
In addition to the KDFs in SPs 800-56A, B and C, and in SP 800-108, there are several
other allowed application-specific KDFs described in SP 800-135 [SP 800-135]. These
application-specific KDFs are approved for use in their own protocols with specific
conditions; see SP 800-135 for detailed information.

5.4.1 Using a Hash Function Directly for Key Derivation
This section discusses and provides security requirements for the KDFs in SP 800-56A
and B that use the hash function directly as their building block (i.e., in the concatenation
and ASN.1 KDFs). The KDFs derive the keying material from a shared secret computed
during the key agreement transaction and other input attributes.
The security strength that can be provided by a derived key depends on the security
strength of the asymmetric keys used to generate the shared secret, the preimage strength
of the hash function used in the KDF and the length of the derived key. Therefore, if a
derived key is intended to provide s bits of security strength, then each of the following
shall be equal to or greater than s:
      •   The security strength supported by the asymmetric keys,
      •   The preimage strength of the hash function, and
      •   The length of the derived key in bits.

5.4.2 Using HMAC for Key Derivation During a Key Agreement Transaction
This section discusses and provides security requirements for the key derivation methods
in SP 800-56A, B and C that use the hash function in an HMAC construction.
The KDFs specified in SPs 800-56A and B derive keys in a single step, and are being
revised to allow the use of HMAC with an approved hash function for key derivation. SP
800-56C specifies a two-step key derivation procedure in which HMAC can be used
during the key derivation process.
5.4.2.1    Using HMAC in the Single-Step Key Derivation Process



                                               16
