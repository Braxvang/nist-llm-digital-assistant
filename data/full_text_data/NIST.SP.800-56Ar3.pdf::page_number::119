                                                                                               NIST SP 800-56A Rev. 3                             Recommendation for Pair-Wise Key Establishment
                                                                                                                                                          Using Discrete Logarithm Cryptography

                                                                                               party U) as input to the key-derivation method employed by the scheme. NonceV is also used
                                                                                               as the EphemDataV during MacTag computations. The successful completion of the key-
                                                                                               confirmation process provides party V with assurance that party U has derived the same
                                                                                               secret Z value. If NonceV is a random nonce, then party V also obtains assurance that party
                                                                                               U has actively participated in the process; see Section 5.4 for a discussion of the length and
                                                                                               security strength required for the nonce.


                                                                                                                        U                                       V
                                                                                                                                 U’s Static Public Key
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                                                                                                      Obtain static
                                                                                                                                 V’s Static Public Key                public keys


                                                                                                                                       NonceU                         U sends a nonce

                                                                                                                                        NonceV
                                                                                                                                                                      V sends a nonce

                                                                                                                                       MacTagU
                                                                                                                                                                      U’s key confirmation




                                                                                               Figure 15: C(0e, 2s) scheme with unilateral key confirmation from party U to party V

                                                                                               To provide (and receive) key confirmation (as described in Section 5.9.1), party U (and party
                                                                                               V) set
                                                                                                                   EphemDataU = NonceU, and EphemDataV = NonceV.
                                                                                               Party U provides MacTagU to party V (as specified in Section 5.9.1, with P = U and R = V),
                                                                                               where MacTagU is computed (as specified in Section 5.2.1) using
                                                                                                            MacDataU = “KC_1_U” || IDU || IDV || NonceU || NonceV {|| TextU}.
                                                                                               Party V (the key-confirmation recipient) uses the same format for MacDataU to compute its
                                                                                               own version of MacTagU and then verifies that the newly computed MacTag matches the
                                                                                               value provided by party U.
                                                                                               Party U shall destroy its copy of MacKey immediately after computing MacTagU. Party V
                                                                                               shall immediately destroy its copy of MacKey after determining whether or not the received
                                                                                               and newly computed MacTagU values match. If they do not match, then party V shall also
                                                                                               destroy the KeyData portion of the DerivedKeyingMaterial (see Section 5.9.1) and notify
                                                                                               party U that MacTagU could not be verified. In this case, party U shall also destroy the
                                                                                               KeyData portion of the DerivedKeyingMaterial.

                                                                                                                                            108
