Special Publication 800-85B                                PIV Data Model Testing Specification


Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<Card Holder Facial Image
                         (2.16.840.1.101.3.7.2.96.48)>>
                      3. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      4. Extract the SignerInfo->digestAlgorithm field from the
                         CBEFF_SIGNATURE_BLOCK
                      5. Extract the certificates field contents from the
                         CBEFF_SIGNATURE_BLOCK (if present)
                      6. Set OID := <<CHUID (2.16.840.1.101.3.7.2.48.0)>>
                      7. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      8. Extract the expiration date value from the CHUID (i.e.
                          Tag 0x35)
                      9. If a certificate extracted from the certificates field
                          of the CBEFF_SIGNATURE_BLOCK does not exist, then
                          extract the certificates field contents from the
                          asymmetric signature of the CHUID
                      10. From the certificate obtained (either from the
                          CBEFF_SIGNATURE_BLOCK or the CHUID signature field),
                          extract the subjectPublicKeyInfo->subjectPublicKey
                      11. Compute the size of the signer’s public key
                      12. Match the digest algorithm obtained from step 4 with
                          Table 3-3 of SP80078 based on the card expiration date,
                          and the public key algorithm and size used to sign the
                          facial image biometric
                      13. Extract the digestAlgorithms field contents from the
                          CBEFF_SIGNATURE_BLOCK
Expected              The digestAlgorithm field value of the SignerInfo is in accordance with
Result(s)             Table 3-3 of SP80078 and it matches the value present in the
                      digestAlgorithms field of the SignedData.


10.3.1.9 Verify message digest signed attribute in SignerInfo

Purpose               Confirms that the signedAttrs of the SignerInfo includes a message digest
                      attribute containing the hash computed over the concatenated
                      CBEFF_HEADER and the STD_BIOMETRIC_RECORD
Reference(s)          1.      FIPS201, Section 4.2.2
                      2.      AS06.03.12




                                                                                             Page 100
