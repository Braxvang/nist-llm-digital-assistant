using the same IV to be easily recovered from the jth ciphertext block of that message.

Confidentiality may similarly be compromised if any of the input blocks to the forward cipher
function for the encryption of a message is designated as the IV for the encryption of another
message under the given key.

The OFB mode is illustrated in Figure 4.

6.5   The Counter Mode

The Counter (CTR) mode is a confidentiality mode that features the application of the forward
cipher to a set of input blocks, called counters, to produce a sequence of output blocks that are
exclusive-ORed with the plaintext to produce the ciphertext, and vice versa. The sequence of
counters must have the property that each block in the sequence is different from every other
block. This condition is not restricted to a single message: across all of the messages that are
encrypted under the given key, all of the counters must be distinct. In this recommendation, the
counters for a given message are denoted T1, T2, … , Tn. Methods for generating counters are
discussed in Appendix B. Given a sequence of counters, T1 , T2 , … , Tn, the CTR mode is
defined as follows:

       CTR Encryption:                Oj = CIPHK(Tj)                for j = 1, 2 … n;
                                      Cj = Pj ⊕ Oj                  for j = 1, 2 … n-1;
                                       *      *
                                      C n = P n ⊕ MSBu(On).

       CTR Decryption:                Oj = CIPHK(Tj)                for j = 1, 2 … n;
                                      Pj = Cj ⊕ Oj                  for j = 1, 2 … n-1;
                                       *      *
                                      P n = C n ⊕ MSBu(On).

In CTR encryption, the forward cipher function is invoked on each counter block, and the
resulting output blocks are exclusive-ORed with the corresponding plaintext blocks to produce
the ciphertext blocks. For the last block, which may be a partial block of u bits, the most
significant u bits of the last output block are used for the exclusive-OR operation; the remaining
b-u bits of the last output block are discarded.

In CTR decryption, the forward cipher function is invoked on each counter block, and the
resulting output blocks are exclusive-ORed with the corresponding ciphertext blocks to recover
the plaintext blocks. For the last block, which may be a partial block of u bits, the most
significant u bits of the last output block are used for the exclusive-OR operation; the remaining
b-u bits of the last output block are discarded.

In both CTR encryption and CTR decryption, the forward cipher functions can be performed in
parallel; similarly, the plaintext block that corresponds to any particular ciphertext block can be
recovered independently from the other plaintext blocks if the corresponding counter block can
be determined. Moreover, the forward cipher functions can be applied to the counters prior to the
availability of the plaintext or ciphertext data.




                                                15
