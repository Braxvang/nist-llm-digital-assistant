                                                                                               NIST SP 800-177 REV. 1                                                         TRUSTWORTHY EMAIL




                                                                                               •   KeyPurposeId: Should include the value id-kp-emailProtection (1.3.6.1.5.5.7.3.4)
                                                                                               •   subjectAltName: Since this certiﬁcate is used by devices (as opposed to a human subject),
                                                                                                   this ﬁeld should contain the DNS name or IP Address.

                                                                                               5.2.3   STARTTLS

                                                                                               Unlike the World Wide Web, where the URL indicates that the secure variant (i.e., HTTPS) is in
                                                                                               use, an email sender has only the email address, “user@domain”, to signal the destination and
                                                                                               no way to direct that the channel must be secured. �is is an issue not just on a sender-to-receiver
                                                                                               basis, but also on a transitive basis, as SMTP is not an end-to-end protocol but instead a protocol
                                                                                               that sends mail messages as a series of hops (i.e., MUA, MSA, multiple MTAs, etc.). Not only is
                                                                                               there no way to signal that message submission must be secure, there is also no way to signal
                                                                                               that any hop in the transmission should be secure. STARTTLS was developed to address some of
                                                                                               the shortcomings of this system.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-177r1




                                                                                               RFC 3207 [RFC3207] describes an extension to SMTP that allows an SMTP client and server to
                                                                                               use TLS to provide private, authenticated communication across the Internet. �is gives SMTP
                                                                                               agents the ability to protect some or all of their communications from eavesdroppers and
                                                                                               attackers. If the client initiates the connection over a TLS-enabled port (e.g., port 465 was
                                                                                               previously used for SMTP over SSL), the server advertises that the STARTTLS option is
                                                                                               available to connecting clients. �e client can then issue the STARTTLS command in the SMTP
                                                                                               command stream, and the two parties proceed to establish a secure TLS connection. An
                                                                                               advantage of using STARTTLS is that the server can oﬀer SMTP service on a single port, rather
                                                                                               than requiring separate port numbers for secure and cleartext operations. Similar mechanisms are
                                                                                               available for running TLS over IMAP and POP protocols.

                                                                                               When STARTTLS is initiated as a request by the server side, it may be susceptible to a
                                                                                               downgrade attack, where a man-in-the-middle (MITM) is in place. In this case the MITM
                                                                                               receives the STARTTLS request from the server reply to a connection request and scrubs it out.
                                                                                               �e initiating client sees no TLS upgrade request and proceeds with an unsecured connection (as
                                                                                               originally anticipated). Likewise, most MTAs default to sending messages over unencrypted
                                                                                               TCP if certiﬁcate validation fails during the TLS handshake.

                                                                                               Domains can signal their desire to receive email over TLS by publishing a public key in their
                                                                                               DNS records using DANE (Section 5.2.4). Domains can also conﬁgure their email servers to
                                                                                               reject mail that is delivered without being preceded by a TLS upgrade. Unfortunately, doing so at
                                                                                               the present time may result in email not being delivered from clients that are not capable of TLS.
                                                                                               Furthermore, mail that is sent over TLS will still be susceptible to MITM attacks unless the
                                                                                               client veriﬁes the that the server’s certiﬁcate matches the certiﬁcate that is advertised using
                                                                                               DANE.




                                                                                                                                               63
