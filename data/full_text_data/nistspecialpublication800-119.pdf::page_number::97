                                                                GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


Reply message with the new lifetimes, and the client may continue to use the address without
interruption.

    4.7.2   Differences from IPv4 Standards

DHCPv4 and DHCPv6 perform similar functions, but distinct differences exist. Many of these are due to
either the underlying differences between IPv4 and IPv6 or the chance to make improvements in DHCPv6
based on what has been learned running DHCPv4.

One primary difference is that DHCPv4 and DHCPv6, unlike DNS, are two separate protocols and
services. To date, no single standard for DHCP on dual stack IPv4-IPv6 systems exists. RFC 4477,
Dynamic Host Configuration Protocol (DHCP) IPv4 and IPv6 Dual Stack Issues, covers potential
problems for clients receiving both DHCPv4 and DHCPv6 information and considers potential solutions,
both with a single server and separate servers. In either case, many questions arise about how best to
merge the information about IPv4 and IPv6 configurations.

A second major difference is due to the presence of SLAAC in IPv6. Dynamic IPv6 addresses can be
configured without DHCPv6, and whether DHCPv6 is used is determined by RAs, not by hosts.

DHCPv6 generates far less traffic than DHCPv4. The differences include use of broadcast with IPv4
versus multicast with IPv6. DHCPv6 also contains many optimizations, for example, the ability to assign
multiple network addresses to a single interface.

    4.7.3   Security Ramifications

To enhance accountability, many organizations may prefer to use DHCPv6 and disable autoconfiguration
to force authentication prior to gaining an IPv6 address. This also aids with forensics if there are
verifiable logs that show which user had been leased which IPv6 address at a given time. Those logs will
provide corroborating evidence in a forensic case. Another security enhancement related to DHCPv6 use
is that DHCPv6 is more resilient to pool consumption attack. Because the DHCPv6 pool is typically
comprised of an entire /64 subnet there are many addresses in the pool. Therefore, it is unlikely that an
attacker will be able to claim all the IPv6 addresses in the pool to cause the next legitimate user’s request
to get rejected because all the addresses have been leased out.

On the other hand, a network that relies upon DHCPv6 for address assignment is subject to DOS if
DHCPv6 services are interrupted. Also, if the information obtained from DHCP is unreliable or
inaccurate, the network may degrade or fail. Even the inability to reach a DNS server makes the Internet
essentially unusable. Finally, an attack against DHCPv6 may cause packets to be misrouted, which then
allows the attacker to compromise the confidentiality or integrity of their contents.

Another DHCPv4 attack is related to the SOLICIT messages. An attacker may launch a DoS attack with
many SOLICIT messages. However, these SOLICIT messages can be rate-limited to a low bandwidth
amount. Similarly, if an attacker were to send numerous RENEW messages, most DHCPv6 servers will
simply answer these requests out of cache to minimize impact on the DHCPv6 server. Additional
examples of attacks include:

    Rogue responses from unauthorized servers distributing false information, addresses, or otherwise

    Maliciously high volumes of client requests causing denial of service

    The potential exhaustion of internal server memory by huge numbers of requests (although address
     exhaustion is not a possibility on, for example, a /64)


                                                    4-34
