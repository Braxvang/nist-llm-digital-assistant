                                                                                              NIST SP 800-77 REV. 1                                                          GUIDE TO IPSEC VPNS


                                                                                              unique but may be predictable. The recommended implementation is to use a simple counter.
                                                                                              However, the ESP protocol itself already has a counter, which is used to defend against replay
                                                                                              attacks. A proposal is being developed by the IETF to define AES-GCM and AES-CCM variants
                                                                                              that omit sending the AEAD IV and use the ESP replay counter instead. These variants are only
                                                                                              defined for ESP algorithms, not the IKE algorithms. This work is discussed in [89].

                                                                                              10.4 The Intermediate Exchange

                                                                                              Classic DH key exchanges could become vulnerable to quantum computing attacks. There is a
                                                                                              need to replace the DH key exchange with a quantum-safe key exchange. Current proposals for
                                                                                              such algorithms all require the use of large public keys that need to be exchanged in IKE during
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              the IKE_SA_INIT phase. During this phase of the exchange, IKEv2 fragmentation cannot yet be
                                                                                              used because a confidential channel that can identify fragments as legitimate has not yet been
                                                                                              established. A new intermediate exchange is placed between the IKE_SA_INIT and IKE_AUTH
                                                                                              exchanges, which can support fragmentation. This work is discussed in [90].

                                                                                              10.5 IPv4 and IPv6 Support in Remote Access VPNs

                                                                                              The telecom networks (LTE/5G) can provide notifications about whether a network connection
                                                                                              should be attempted with IPv4, IPv6, or both. However, IKEv2 does not offer a similar
                                                                                              notification structure or rich enough error notification for clients to determine if they should
                                                                                              attempt IPv4 or IPv6 only or address both families (IPv4 and IPv6) for use with IPsec. A new
                                                                                              draft has been proposed to clarify this for better integration of 3GPP standards with IKEv2. This
                                                                                              work is discussed in [91].

                                                                                              10.6 Post Quantum Key Exchange

                                                                                              Once there are quantum-safe key exchange algorithms that can replace the classic (EC)DH key
                                                                                              exchanges, the IKEv2 protocol will need to be extended to support this. One suggestion is to
                                                                                              keep the existing (EC)DH exchange and add on one or more quantum-safe key exchanges to the
                                                                                              protocol in such a way that the resulting hybrid key exchange is at least as strong as the strongest
                                                                                              component. This guarantees that even if a quantum-safe algorithm candidate is used and later
                                                                                              becomes unsafe, the security of the connection is still at least as strong as the known classical
                                                                                              (EC)DH key exchange. This design also ensures that a NIST-approved IPsec implementation
                                                                                              that adds a quantum-safe algorithm for protection still complies with all current NIST
                                                                                              requirements. This work is discussed in [92].




                                                                                                                                              121
