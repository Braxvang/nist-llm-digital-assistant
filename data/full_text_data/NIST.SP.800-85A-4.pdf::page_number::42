NIST SP 800-85A-4                                                         PIV CARD APPLICATION & MIDDLEWARE
                                                                                   INTERFACE TEST GUIDELINES

A.4.2.5         pivEstablishSecureMessaging

AS04.07A-R4: The purpose of pivEstablishSecureMessaging is to establish secure messaging
with the PIV Card Application. 6

Required Test Procedures

TE04.07A-R4.01: The tester shall validate that the PIV Middleware implements the
pivEstablishSecureMessaging as per SP 800-73-4 Part 3.

AS04.07B-R4: After successful execution of the key establishment protocol, the PIV
Middleware shall perform all subsequent GET DATA, VERIFY, and GENERAL
AUTHENTICATE commands over secure messaging, with the exception of any subsequent
uses of the GENERAL AUTHENTICATE command to perform the key establishment
protocol.

Required Test Procedures

TE04.07B-R4.01: The tester shall validate that upon successful execution of the key establishment
protocol the GET DATA, VERIFY, and GENERAL AUTHENTICATE commands are only sent to
the card using secure messaging when the pivGetData, pivLogIntoCardApplication, and pivCrypt
middleware functions are called.

AS04.07C-R4: The session keys established after successful execution of the key establishment
protocol in Section 4.1 of SP 800-73-4 Part 2 shall be zeroized in the following circumstances:
(i) the card is reset; (ii) an error occurs in secure messaging; or (iii) new session keys are
requested by the client application by sending a GENERAL AUTHENTICATE command to
the card to perform the key establishment protocol using the PIV Secure Messaging key.

Required Vendor Information
VE04.07C-R4.01: The vendor shall state in its documentation that the card supports the assertions
made in AS04.07C-R4.

Required Test Procedures

TE04.07C-R4.01: The tester shall validate that the vendor documentation contains the information
required in VE04.07C-R4.01.

A.4.3           Entry Points for Cryptographic Operations

A.4.3.1         pivCrypt




6
    The PIV Middleware maintains the session keys and performs the cryptographic operations for secure messaging.


                                                   A-14
