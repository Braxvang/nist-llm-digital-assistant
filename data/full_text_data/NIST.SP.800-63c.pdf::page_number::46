                                                                                             NIST SP 800-63C                                                            DIGITAL IDENTITY GUIDELINES:
                                                                                                                                                                          FEDERATION & ASSERTIONS

                                                                                             Kerberos supports authentication of a subscriber over an untrusted, shared local network using
                                                                                             one or more IdPs. The subscriber implicitly authenticates to the IdP by demonstrating the ability
                                                                                             to decrypt a random session key encrypted for the subscriber by the IdP. (Some Kerberos
                                                                                             variants also require the subscriber to explicitly authenticate to the IdP, but this is not universal.)
                                                                                             In addition to the encrypted session key, the IdP also generates another encrypted object called a
                                                                                             Kerberos ticket. The ticket contains the same session key, the identity of the subscriber to whom
                                                                                             the session key was issued, and an expiration time after which the session key is no longer valid.
                                                                                             The ticket is confidentiality and integrity protected by a pre-established key that is shared
                                                                                             between the IdP and the RP during an explicit setup phase.

                                                                                             To authenticate using the session key, the subscriber sends the ticket to the RP along with
                                                                                             encrypted data that proves that the subscriber possesses the session key embedded within the
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-63c




                                                                                             Kerberos ticket. Session keys are either used to generate new tickets or to encrypt and
                                                                                             authenticate communications between the subscriber and the RP.

                                                                                             To begin the process, the subscriber sends an authentication request to the Authentication Server
                                                                                             (AS). The AS encrypts a session key for the subscriber using the subscriberâ€™s long-term
                                                                                             credential. The long-term credential may either be a secret key shared between the AS and the
                                                                                             subscriber, or in the PKINIT variant of Kerberos, a public key certificate. Most variants of
                                                                                             Kerberos based on a shared secret key between the subscriber and IdP derive this key from a
                                                                                             user-generated password. As such, they are vulnerable to offline dictionary attacks by passive
                                                                                             eavesdroppers, unless Flexible Authentication Secure Tunneling (FAST) [RFC 6113] or some
                                                                                             other tunneling and armoring mechanism is used.

                                                                                             In addition to delivering the session key to the subscriber, the AS also issues a ticket using a key
                                                                                             it shares with the Ticket Granting Server (TGS). This ticket is referred to as a Ticket Granting
                                                                                             Ticket (TGT), since the verifier uses the session key in the TGT to issue tickets rather than to
                                                                                             explicitly authenticate the verifier. The TGS uses the session key in the TGT to encrypt a new
                                                                                             session key for the subscriber and uses a key it shares with the RP to generate a ticket
                                                                                             corresponding to the new session key. The subscriber decrypts the session key and uses the ticket
                                                                                             and the new session key together to authenticate to the RP.

                                                                                             When Kerberos authentication is based on passwords, the protocol is known to be vulnerable to
                                                                                             offline dictionary attacks by eavesdroppers who capture the initial user-to-KDC exchange.
                                                                                             Longer password length and complexity provide some mitigation to this vulnerability, although
                                                                                             sufficiently long passwords tend to be cumbersome for users. However, when Kerberos
                                                                                             password-based authentication is used in a FAST (or similar) tunnel, a successful Man-in-the-
                                                                                             Middle attack is additionally required in order to perform the dictionary attack.

                                                                                             11.3 OpenID Connect

                                                                                             OpenID Connect [OIDC] is an internet-scale federated identity and authentication protocol built
                                                                                             on top of the OAuth 2.0 authorization framework and the JSON Object Signing and Encryption
                                                                                             (JOSE) cryptographic system.




                                                                                                                                               37
