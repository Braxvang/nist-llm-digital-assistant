                                                                                               NIST SP 800-177 REV. 1                                                         TRUSTWORTHY EMAIL




                                                                                                                  Client connects to port 25
                                                                                                                  Server: 220 mx.example.com
                                                                                                                  Client: HELO mta.example.net
                                                                                                                  S: 250 Hello mta.example.net, I am glad to meet you
                                                                                                                  C: MAIL FROM:<alice@example.org>
                                                                                                                  S: 250 Ok
                                                                                                                  C: RCPT TO:<bob@example.com>
                                                                                                                  S: 354 End data with <CR><LF>.<CR><LF>
                                                                                                                  Client sends message headers and body
                                                                                                                  C: .
                                                                                                                  S: 250 Ok: queued as 12345
                                                                                                                  C: QUIT
                                                                                                                  S: 221 Bye
                                                                                                                  Server closes the connection
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-177r1




                                                                                                                                   Figure 2-2: Basic SMTP Connection Set-up

                                                                                               In the above, the client initiates the connection using TCP over port 25 2. After the initial
                                                                                               connection, the client and server perform a series of SMTP transactions to send the message.
                                                                                               �ese transactions take the form of ﬁrst stating the return address of the message (known as the
                                                                                               return path) using the MAIL command, then the recipient(s) using the RCPT command and
                                                                                               ending with the DATA command which contains the header and body of the email message.
                                                                                               After each command the server responds with either a positive or negative (i.e., error) code.

                                                                                               SMTP servers can advertise the availability of options during the initial connection. �ese
                                                                                               extensions are currently deﬁned in [RFC5321]. �ese options usually deal with the transfer of the
                                                                                               actual message and will not be covered in this guide except for the STARTTLS option. �is
                                                                                               option advertised by the server is used to indicate to the client that Transport Layer Security
                                                                                               (TLS) is available. SMTP over TLS allows the email message to be sent over an encrypted
                                                                                               channel to protect against monitoring a message in transit. Recommendations for conﬁguring
                                                                                               SMTP over TLS are given in Section 5.2.

                                                                                               2.3.2      Mail Access Protocols (POP3, IMAP, MAPI/RPC)

                                                                                               MUAs typically do not use SMTP when retrieving mail from an end-user's mailbox, only for
                                                                                               submission. MUAs use another client-server protocol to retrieve the mail from a server for
                                                                                               display on an end-user's host system. �ese protocols are commonly called Mail Access
                                                                                               Protocols and are either Post Oﬃce Protocol (POP) or Internet Message Access Protocol
                                                                                               (IMAP). Most modern MUAs support both protocols but an enterprise service may restrict the
                                                                                               use of one in favor of a single protocol for ease of administration or other reasons.
                                                                                               Recommendations for the secure conﬁguration of these protocols are given in Section 7.




                                                                                               2   Although MUAs often use TCP port 587 when submitting email to be sent.

                                                                                                                                                       8
