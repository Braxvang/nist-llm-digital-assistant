                                                                                               NIST SP 800-56B REV. 2                                RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                          USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                                           c. If (eBits < 17) or (eBits > 256), output an indication that the exponent is out of
                                                                                                              range, and exit without further processing.
                                                                                                   C. Step 2 is replaced by:
                                                                                                           2. Check the public exponent.
                                                                                                               If the public exponent epub is not odd, or if len(epub) ≠ eBits, output an indication of
                                                                                                               an invalid key pair, and exit without further processing.
                                                                                                   D. Step 3 is replaced by the following:
                                                                                                           3. Check the modulus:
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                                                    a. If npub ≠ p × q, output an indication of an invalid key pair, and exit without
                                                                                                                       further processing.
                                                                                                                    b. If len(npub) ≠ nBits, output an indication of an invalid key pair, and exit
                                                                                                                       without further processing.
                                                                                                                    c. If nBits is not a positive even integer, output an indication of an invalid key
                                                                                                                       pair, and exit without further processing.
                                                                                                   E. Step 4 (prime-factor recovery) is omitted (i.e., not used).
                                                                                               A routine that implements this validation function shall destroy any local copies of p, q, and d, as
                                                                                               well as any other locally stored values used or produced during the execution of the routine. The
                                                                                               destruction of these locally stored values shall occur prior to or during any exit from the routine
                                                                                               (whether exiting early because of an error or exiting normally).

                                                                                               6.4.1.3.3   rsakpv2-crt
                                                                                               rsakpv2-crt is the key-pair validation method corresponding to the rsakpg2-crt key-pair generation
                                                                                               method (see Section 6.3.1.3).
                                                                                               Function call: rsakpv2-crt (s, nBits, eBits, (npub, epub), (npriv, epriv, d, p, q, dP, dQ, qInv))
                                                                                               The inputs, outputs and errors are the same as in rsakpv1-basic (see Section 6.4.1.2.1) except that
                                                                                               the private key is in the Chinese Remainder Theorem format: (npriv, epriv, d, p, q, dP, dQ, qInv).
                                                                                               The steps are the same as in rsakpv1-basic (see Section 6.4.1.2.1) except that:
                                                                                                   A. The efixed input parameter is replaced by eBits, which is the intended bit length of the public
                                                                                                      exponent, an integer such that 17 ≤ eBits ≤ 256.
                                                                                                   B. Step 1c is replaced by:
                                                                                                           c. If (eBits < 17) or (eBits > 256), output an indication that the exponent is out of
                                                                                                              range, and exit without further processing.
                                                                                                   C. Step 2 is replaced by the following:
                                                                                                           2. Compare the public exponents:
                                                                                                               If (epub ≠ epriv) or (epub is not odd) or (len(epub) ≠ eBits), output an indication of an
                                                                                                               invalid key pair, and exit without further processing.

                                                                                                                                                    52
