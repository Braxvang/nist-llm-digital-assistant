NIST SP 800-85A-4                                                               PIV CARD APPLICATION & MIDDLEWARE
                                                                                         INTERFACE TEST GUIDELINES

                                              secret Z 13 with '90 00' at the end. Compare the shared
                                              secret computed by the card with the shared secret
                                              computed off card.
                                    •   Repeated step 13: The security state is reset.
                              15.
                                    • Repeated step 3: The command returns the signed challenge
                                      with '90 00' at the end. Verify the signed challenge.
                                  • Repeated step 7a: The command returns the signed data with
                                      '90 00' at the end. Verify the signature using the public key
                                      from the digital signature certificate and the hash sent to the
                                      card.
                                  • Repeated step 7b: The command returns '69 82' (security
                                      status not satisfied).
                                  • Repeated step 8: For algorithm reference '07' as P1 value, the
                                      command returns the transported key with '90 00' at the end.
                                      Compare the plaintext key to the one received in the response
                                      from the card. For algorithm reference '11' or '14' as P1 value,
                                      the command returns the shared secret Z 14 with '90 00' at the
                                      end. Compare the shared secret computed by the card with
                                      the shared secret computed off card.
                                  • Repeated step 9: The command returns the signed challenge
                                      with '90 00' at the end. Verify the signed challenge.
                                  • Repeated step 10: The GET DATA commands return the
                                      requested data along with '90 00'. Each GENERAL
                                      AUTHENTICATE command returns either 1) the transported
                                      key with '90 00' at the end or 2) the shared secret Z with '90 00'
                                      at the end.
                                          o For key transport (as indicated by algorithm reference
                                              '06' or '07' as P1 value), the command returns the
                                              transported key with '90 00' at the end. Compare the
                                              plaintext key to the one received in the response from
                                              the card.
                                          o For ECDH, (as indicated by algorithm reference '11' or
                                              '14' as P1 value), the command returns the shared
                                              secret Z 15 with '90 00' at the end. Compare the shared
                                              secret computed by the card with the shared secret
                                              computed off card.
                                  • Repeated step 13: The security state is reset.
                              16. For the referenced steps 3, 7b, and 8, the command returns '69 82'
                                  (security status not satisfied). For the referenced step 9, command

13
   Z is the X coordinate of point P as defined in SP 800-56A, Section 5.7.1.2
14
   Z is the X coordinate of point P as defined in SP 800-56A, Section 5.7.1.2
15
   Z is the X coordinate of point P as defined in SP 800-56A, Section 5.7.1.2


                                                    C-36
