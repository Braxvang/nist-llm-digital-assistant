                                                                                              NIST SP 800-77 REV. 1                                                         GUIDE TO IPSEC VPNS


                                                                                                 •   In IKEv1 it is not always possible to detect different groups of clients early enough to
                                                                                                     select the right authentication mechanism or the right PSK. This complicates multi-tenant
                                                                                                     VPNs. In IKEv2, the initiator can optionally send the expected ID of the peer in the IDr
                                                                                                     payload. This allows the responder (i.e., the server) to always select the proper tenant
                                                                                                     group.
                                                                                                 •   IKEv1 with PSK has the side effect of offering quantum computing resistance. In IKEv2
                                                                                                     this is no longer the case, but a separate RFC [43] specifies how to use PPKs to gain the
                                                                                                     same protection in IKEv2.

                                                                                              3.10 Manual Keying
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              While it is possible to hard-code the IPsec information using out-of-band communication (called
                                                                                              manual keying), this shall not be used. The IKE protocol handles a number of other security
                                                                                              properties, none of which are enforced when using manual keying. Encryption keys would never
                                                                                              be refreshed when a fixed key is manually input and used, so any compromise would allow an
                                                                                              attacker to decrypt all previously monitored traffic under the fixed key. Some values, such as
                                                                                              nonces, counters, and initialization vectors (IVs), shall never be used more than once. Otherwise,
                                                                                              the encryption may become vulnerable (weaken).

                                                                                              The only time that manual keying might be acceptable is if another trusted entity, such as a
                                                                                              security controller in the SDWAN paradigm, assumes these responsibilities. Another example is
                                                                                              the 3GPP protocol, which negotiates the IPsec parameters between a cell tower and handset
                                                                                              using a non-IKE protocol.

                                                                                              Administrators sometimes mistakenly believe that manual keying is easier to set up than
                                                                                              automated keying via IKE. However, manual keying is much harder to set up than IKE.

                                                                                              Manual keying is typically only used for software testing and IPsec benchmark tests.

                                                                                              This recommendation discourages the use of manual keying.

                                                                                              3.11 IKE Summary

                                                                                                 •   IPsec uses IKE to create security associations, which are sets of values that define the
                                                                                                     security of IPsec-protected connections. The first IPsec SA is created in conjunction with
                                                                                                     the IKE SA during the initial exchanges.
                                                                                                 •   The IKE SA is used to securely communicate IPsec configuration, status, and
                                                                                                     management information, such as setting up additional IPsec SAs, rekey events,
                                                                                                     deletions, and other notifications.
                                                                                                 •   IKEv2 is faster, more versatile, and uses more modern cryptography compared to IKEv1.
                                                                                                     IKEv1 should not be used for new deployments, and existing deployments using IKEv1
                                                                                                     should be converted to IKEv2 when possible.




                                                                                                                                              35
