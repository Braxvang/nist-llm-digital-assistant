NIST SP 800-166                                                    DERIVED PIV APPLICATION AND
                                                                   DATA MODEL TEST GUIDELINES

                               •   A Discovery Object followed by status word '90 00';
                               •   A zero-length data object followed by status word '90 00' –
                                   which indicates that a container for the Discovery Object
                                   exists, but it has not been personalized; or
                              • Status word '6A 82' (data object not found) – which
                                   indicates the container for the Discovery Object does not
                                   exist)
                           3. From Step 3, all mandatory tags for the Discovery Object are
                              present and are in the order indicated in Table 18 of [SP800-
                              73], Part 1. The first byte of the PIN Usage Policy is set to
                              0x40 and the second byte is set to 0x00. In addition, the PIV
                              Card Application AID in tag 0x4F is set to 'A0 00 00 03 08 00
                              00 20 00 01 00'
                           4. From Step 4, the command returns status word '90 00' along
                              with the Security Object.

9.1.5 Key History Object

9.1.5.1 BER-TLV of Key History Object and Presence of Security Object

 Test Assertion            TA-09.01.05.01
 Purpose                   Verifies that the Key History Object (if present) conforms to the
                           Derived PIV data model requirements.
 DTR(s)                    • DTR-07.01.01.01
                           • DTR-07.01.06.01
                           • DTR-07.01.08.02
 Issuer Documentation      None.

 Precondition(s)           •   A token with the Derived PIV Application is inserted into an
                               appropriate token reader.
                           •   Suitable drivers have been loaded between the test system and
                               an instance of the reader.
 Test Scenario             1. Send the SELECT command with
                                 • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                           2. Send the GET DATA command with
                                 • Data field of the command containing the tag
                                    ('5FC10C') of the Key History Object.
                           3. If the Key History Object was retrieved in Step 2,
                              read and parse the byte array in accordance with
                              BER-TLV format.
                           4. If the Key History Object was retrieved in Step 2,
                              verify that the Security Object is present within
                              the Derived PIV Application by sending a GET DATA
                              command to read this data object.
 Expected Result(s)        1. From Step 1, the command returns the application property
                              template with the status word '90 00'.
                           2. From Step 2, the command returns one of the following:


                                            92
