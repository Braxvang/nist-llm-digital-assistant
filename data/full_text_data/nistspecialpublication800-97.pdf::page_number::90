ESTABLISHING WIRELESS ROBUST SECURITY NETWORKS: A GUIDE TO IEEE 802.11I



6.3.1   Secure STA Configuration

EAP authentication methods such as EAP-TLS, EAP-TTLS, EAP-FAST, and PEAP use certificates to
authenticate the AS to the STA. One potential pitfall to this approach is that it enables an adversary to
impersonate the WLAN infrastructure if that adversary can present a valid certificate, and if WLAN
clients are not configured properly. It is common for a WLAN client to be configured by default to
accept certificates signed by any certification authority (CA) for which it has a corresponding CA
certificate. In most cases, a variety of third-party CA certificates are already installed on the client. This
allows an attacker to impersonate the WLAN infrastructure successfully with an SSID and a valid
certificate signed by any of the third-party CAs that the client recognizes. Once the attacker has tricked
the client into associating with the bogus AP, it might be able to capture the authentication credentials
needed to access the real infrastructure. In this scenario, the security of the RSN is circumvented simply
as a result of having multiple CA certificates on the STA, which is a common configuration on many
computers.

To prevent this situation, STAs should be configured to authenticate to specific servers only, not just any
server with a valid certificate. Ideally, servers should be identified by their fully qualified domain name
(e.g., as1.xyzAgency.gov) so that the name listed in the AS’s certificate can be compared with the name
specified in the STA’s configuration. STAs should also be configured to accept certificates only from the
CA that signed the server certificates. With these two controls in place, the attacker would either have to
breach the CA or get it to provide it a certificate with the same name as the authentication server. Both of
these attacks are considerably more difficult to execute successfully than the relatively trivial one
described earlier. As an additional security measure, an organization might consider using its own CA
rather than that of a third-party vendor, if it does not trust the third party to implement the proper controls.
This approach requires installing the organization’s CA certificate on each STA.

Figure 6-3 shows an example of certificate restrictions on a computer running Microsoft Windows XP
Professional. The computer is configured to use EAP-TLS when connecting to a certain SSID, and to
accept server certificates signed by either the Symantec Root CA or the Thawte Personal Basic CA.

Nothing in the IEEE 802.11i specification or related standards requires a configuration like this one, but it
is essential when a client authenticates the WLAN infrastructure using certificates. Organizations
deploying RSNs should consider carefully the configuration of their STAs before activating a new
wireless RSN.

6.3.2   Unprotected Links

The infrastructure supporting an RSN authentication transaction consists of three components: a STA, an
AP, and an AS. IEEE 802.11i provides a rigorous approach to securing the communications link between
the STA and the AP. IEEE 802.1X port-based access control ensures that entities on the STA-side of the
AP cannot reach the AS-side of the AP prior to successful authentication. However, both standards
explicitly state that protection of the communications link between the AP and the AS is out of their
scope. Therefore, organizations deploying RSNs must focus on this gap to ensure the end-to-end security
of the WLAN solution. Figure 6-4 illustrates the problem.




                                                     6-14
