                                                                                               NIST SP 800-56B REV. 2                             RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                       USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                               supporting a security strength s that is at least as large as the targeted security strength of the key-
                                                                                               establishment scheme (as indicated in Table 1 above).
                                                                                               Note that when the HMAC or KMAC algorithm is used for key confirmation as specified in this
                                                                                               Recommendation, MacKey lengths can be no greater than 512 bits (an upper bound that is at least
                                                                                               twice the maximum supported security strength). Although the HMAC and KMAC specifications
                                                                                               permit the use of longer keys, the 512-bit maximum is sufficient for this key-confirmation
                                                                                               application. In the case of HMAC, the 512-bit upper bound has the advantage of being less than
                                                                                               or equal to the input block length of whatever hash function is used in the algorithmâ€™s
                                                                                               implementation. If MacKey were allowed to be longer than the input block length, it would be
                                                                                               hashed down to a string of length MacOutputBits during the HMAC computation (see step 2 in
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                               Table 1 of FIPS 198); allowing MacKey to be longer than the input block length would not be an
                                                                                               efficient use of keying material.
                                                                                               The length of the MAC tag for key confirmation also needs to be selected. Note that in many cases,
                                                                                               the length of the MAC tag (MacTagBits) has been selected by the protocol in which the key-
                                                                                               establishment is conducted. MacTagBits shall be at least 64 bits, and its maximum length shall be
                                                                                               no more than MacOutputBits for the MAC algorithm selected for key confirmation. The 64-bit
                                                                                               minimum for the MAC tag length assumes that the protocol imposes a limit on the number of
                                                                                               retries for key confirmation.




                                                                                                                                                 35
