                                                                                               NIST SP 800-56A Rev. 3                            Recommendation for Pair-Wise Key Establishment
                                                                                                                                                         Using Discrete Logarithm Cryptography

                                                                                                      key yV. If the call to the FFC DH primitive outputs an error indicator, destroy the
                                                                                                      ephemeral private key rU, and destroy the results of all intermediate calculations used
                                                                                                      in the attempted computation of Zs; then output an error indicator, and exit this
                                                                                                      process without performing the remaining actions.
                                                                                                  3. Use the FFC DH primitive to derive a shared secret Ze from the set of domain
                                                                                                     parameters D, party U’s ephemeral private key rU, and party V’s static public key yV.
                                                                                                     If this call to the FFC DH primitive outputs an error indicator, destroy Zs and the
                                                                                                     ephemeral private key rU, and destroy the results of all intermediate calculations used
                                                                                                     in the attempted computation of Ze; then output an error indicator, and exit this
                                                                                                     process without performing the remaining actions.
                                                                                                  4. Compute the shared secret Z = Ze || Zs. Destroy Ze and Zs.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                                  5. Use the agreed-upon key-derivation method to derive secret keying material with the
                                                                                                     specified length from the shared secret value Z and other input (see Section 5.8). If
                                                                                                     the key-derivation method outputs an error indicator, destroy all copies of Z and the
                                                                                                     ephemeral private key rU; then output an error indicator, and exit this process without
                                                                                                     performing the remaining actions.
                                                                                                  6. Destroy rU and all copies of the shared secret Z.
                                                                                                  7. Output the derived keying material.
                                                                                               Output: The derived keying material or an error indicator.

                                                                                               Party V shall execute the following actions to a) establish a shared secret value Z with party
                                                                                               U, and b) derive secret keying material from Z.
                                                                                               Actions: Party V derives secret keying material as follows:
                                                                                                  1. Receive an ephemeral public key tU (purportedly) from party U. If tU is not received,
                                                                                                     then output an error indicator, and exit this process without performing the remaining
                                                                                                     actions.
                                                                                                  2. Verify that tU is a valid ephemeral public key for the parameters D as specified in
                                                                                                     Section 5.6.2.3. If assurance of public key validity cannot be obtained, then output an
                                                                                                     error indicator, and exit this process without performing the remaining actions.
                                                                                                  3. Use the FFC DH primitive in Section 5.7.1.1 to derive a shared secret value Zs from
                                                                                                     the set of domain parameters D, party V’s static private key xV, and party U’s static
                                                                                                     public key yU. If the call to the FFC DH primitive outputs an error indicator, destroy
                                                                                                     the results of all intermediate calculations used in the attempted computation of Zs;
                                                                                                     then output an error indicator, and exit this process without performing the remaining
                                                                                                     actions.
                                                                                                  4. Use the FFC DH primitive to derive a shared secret Ze from the set of domain
                                                                                                     parameters D, party V’s static private key xV, and party U’s ephemeral public key tU.
                                                                                                     If this call to the FFC DH primitive outputs an error indicator, destroy Zs, and destroy
                                                                                                     the results of all intermediate calculations used in the attempted computation of Ze;
                                                                                                     then output an error indicator, and exit this process without performing the remaining
                                                                                                     actions.

                                                                                                                                            84
