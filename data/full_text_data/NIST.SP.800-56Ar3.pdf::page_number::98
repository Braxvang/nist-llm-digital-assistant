                                                                                               NIST SP 800-56A Rev. 3                                  Recommendation for Pair-Wise Key Establishment
                                                                                                                                                               Using Discrete Logarithm Cryptography

                                                                                                  3. Use the ECC CDH primitive in Section 5.7.1.2 to derive a shared secret Zs from the
                                                                                                     set of domain parameters D, party V’s static private key ds,V, and party U’s static
                                                                                                     public key Qs,U. If the call to the ECC CDH primitive outputs an error indicator,
                                                                                                     destroy the results of all intermediate calculations used in the attempted computation
                                                                                                     of Zs; then output an error indicator, and exit this process without performing the
                                                                                                     remaining actions.
                                                                                                  4. Use the ECC CDH primitive to derive a shared secret Ze from the set of domain
                                                                                                     parameters D, party V’s static private key ds,V, and party U’s ephemeral public key
                                                                                                     Qe,U. If this call to the ECC CDH primitive outputs an error indicator, destroy Zs, and
                                                                                                     destroy the results of all intermediate calculations used in the attempted computation
                                                                                                     of Ze; then output an error indicator, and exit this process without performing the
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                                     remaining actions.
                                                                                                  5. Compute the shared secret Z = Ze || Zs. Destroy Ze and Zs.
                                                                                                  6. Use the agreed-upon key-derivation method to derive secret keying material with the
                                                                                                     specified length from the shared secret value Z and other input (see Section 5.8). If
                                                                                                     the key-derivation method outputs an error indicator, destroy all copies of Z; then
                                                                                                     output an error indicator, and exit this process without performing the remaining
                                                                                                     action.
                                                                                                  7. Destroy all copies of the shared secret Z and output the derived keying material.
                                                                                               Output: The derived keying material or an error indicator.
                                                                                               Note: Key confirmation can be incorporated into this scheme. See Section 6.2.1.5 for
                                                                                               details.
                                                                                               The One-Pass Unified Model is summarized in Table 16.
                                                                                                         Table 16: One-pass unified model key-agreement scheme summary

                                                                                                                                     Party U                                 Party V

                                                                                                Domain                  (q, FR, a, b{, SEED}, G, n, h)        (q, FR, a, b{, SEED}, G, n, h)
                                                                                                parameters

                                                                                                                        Static private key ds,U               Static private key ds,V
                                                                                                Static data
                                                                                                                        Static public key Qs,U                Static public key Qs,V

                                                                                                Ephemeral data          Ephemeral private key de,U            N/A
                                                                                                                        Ephemeral public key Qe,U

                                                                                                                        1. Compute Zs by calling ECC 1. Compute Zs by calling ECC DH
                                                                                                                           CDH using ds,U and Qs,V      using ds,V and Qs,U
                                                                                                Computation
                                                                                                                        2. Compute Ze by calling ECC 2. Compute Ze by calling ECC DH
                                                                                                                           CDH using de,U and Qs,V      using ds,V and Qe,U


                                                                                                                                                  87
