                                                                                             NIST SP 800-189                                                              RESILIENT INTERDOMAIN TRAFFIC EXCHANGE:
                                                                                                                                                                                  BGP SECURITY & DDOS MITIGATION

                                                                                             5.2.2     Enterprise Border Routers

                                                                                             The SAV security recommendations for enterprise border routers vary based on the
                                                                                             egress/ingress nature of the data packets. Included here are recommendations concerning the
                                                                                             routing control plane (BGP updates) as well.

                                                                                                     Security Recommendation 41: An enterprise border router that is multi-homed should
                                                                                                     always announce all of its address space to each of its upstream transit providers. This can
                                                                                                     be done in one of two ways: 1) announce an aggregate less-specific prefix to all transit
                                                                                                     providers and more-specific prefixes (covered by the less-specific prefix) to different
                                                                                                     transit providers as needed for traffic engineering, or 2) announce the same prefixes to each
                                                                                                     transit provider (albeit with suitable prepending for traffic engineering). 20

                                                                                                     Security Recommendation 42: This is the exception case when the enterprise border
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-189




                                                                                                     router does not adhere to Security Recommendation 41 and instead selectively announces
                                                                                                     some prefixes to one upstream transit ISP and other prefixes to another upstream transit
                                                                                                     ISP. In this case, the enterprise should route data (by appropriate internal routing) such that
                                                                                                     the source addresses in the data packets towards each upstream transit ISP belong in the
                                                                                                     prefix or prefixes announced to that ISP.

                                                                                                     Security Recommendation 43: On the ingress side (i.e., for data packets received from
                                                                                                     the transit ISP), enterprise border routers should deploy loose uRPF (Section 5.1.4) and/or
                                                                                                     ACLs (Section 5.1.1) to drop packets when the source address is spoofed (i.e., belongs to
                                                                                                     obviously disallowed prefix blocks—prefixes marked “False” in column “Global” [IANA-
                                                                                                     v4-sp] [IANA-v6-sp] and the enterprise’s own prefixes).

                                                                                                     Security Recommendation 44: An enterprise (i.e., a leaf AS with or without multi-
                                                                                                     homing) should allow on the egress side (i.e., for data packets sent to the transit ISP) only
                                                                                                     those packets with source addresses that belong in their own prefixes.

                                                                                             5.2.3     Internet Service Providers

                                                                                             The SAV security recommendations for ISPs vary based on the ingress/egress of packets as well
                                                                                             as the relationship with the peer (e.g., customer, lateral peer, transit provider).

                                                                                                     Security Recommendation 45: On customer-facing interfaces, smaller ISPs 21 should
                                                                                                     perform SAV on ingress packets by deploying the feasible-path uRPF (see Section 5.1.3).
                                                                                                     They should avoid using strict or loose uRPF as they are not effective. It is recognized that



                                                                                             20
                                                                                                By following Security Recommendation 41, the enterprise border router ensures that the transit ISP’s border routers discard
                                                                                                  (due to uRPF) only those data packets from the enterprise that do not have source addresses belonging in any of the
                                                                                                  enterprise’s announced prefixes. Thus, it also ensures that data packets from the enterprise that have source addresses
                                                                                                  belonging in any of the enterprise’s announced prefixes are never denied.
                                                                                             21
                                                                                                Smaller ISPs are typically located closer to the edges of internet where SAV is more effective. They tend to have accurate view
                                                                                                  of their customer cone. They would have negligible probability of false positives with invalid detection in SAV with FP-
                                                                                                  uRPF.




                                                                                                                                                            33
