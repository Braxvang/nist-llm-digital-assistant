NIST SP 800-58                                             Voice Over IP Security
    _________________________________________________________________________


 8     Encryption & IPsec

        Thus far we have focused primarily on security of the network, protecting
        endpoints, gateways, and other components, from malicious attacks. Firewalls,
        gateways, and other such devices can help keep intruders from compromising a
        network, but firewalls are no defense against an internal hacker. Another layer of
        defense is necessary at the protocol level to protect the data itself. In VOIP, as in
        data networks, this can be accomplished by encrypting the packets at the IP level
        using IPsec. This way if anyone on the network, authorized or not, intercepts
        VOIP traffic not intended for them (for instance via a packet sniffer), these
        packets will be unintelligible. The IPsec suite of security protocols and
        encryption algorithms is the standard method for securing packets against
        unauthorized viewers over data networks and will be supported by the protocol
        stack in IPv6. Hence, it is both logical and practical to extend IPsec to VOIP,
        encrypting the signal and voice packets on one end and decrypting them only
        when needed by their intended recipient. But the nature of the signaling protocols
        and the VOIP network itself prevent such a simple scheme from being used, as it
        becomes necessary for routers, proxies, etc. to read the VOIP packets. Also,
        several factors, including the expansion of packet size, ciphering latency, and a
        lack of QoS urgency in the cryptographic engine itself can cause an excessive
        amount of latency in the VOIP packet delivery. This leads to degraded voice
        quality, so once again there is a tradeoff between security and voice quality, and a
        need for speed. Fortunately, the difficulties are not insurmountable. NIST-
        sponsored testing [29] has shown that IPsec can be incorporated into a SIP
        network with roughly a three-second additional delay in call setup times, an
        acceptable delay for many applications. This section explains the issues involved
        in successfully incorporating IPsec encryption into VOIP services.

 8.1    IPsec

        IPsec is the preferred form of VPN tunneling across the Internet. There are two
        basic protocols defined in IPsec: Encapsulating Security Payload (ESP) and
        Authentication Header (AH) (see Figure 11). Both schemes provide
        connectionless integrity, source authentication, and an anti-replay service [30].
        The tradeoff between ESP and AH is the increased latency in the encryption and
        decryption of data in ESP and a “narrower” authentication in ESP, which
        normally does not protect the IP header “outside” the ESP header [30], although
        IKE can be used to negotiate the security association (SA), which includes the
        secret symmetric keys. In this case, the addresses in the header (transport mode)
        or new/outer header (tunnel mode) are indirectly protected, since only the entity
        that negotiated the SA can encrypt/decrypt or authenticate the packets.. Both
        schemes insert an IPsec header (and optionally other data) into the packet for
        purposes, such as authentication.

        IPsec also supports two modes of delivery: Transport and Tunnel. Transport
        mode encrypts the payload (data) and upper layer headers in the IP packet. The


                                                                                           63
