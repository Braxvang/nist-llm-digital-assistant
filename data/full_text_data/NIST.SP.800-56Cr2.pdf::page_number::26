                                                                                               NIST SP 800-56C REV. 2                                  RECOMMENDATION FOR KEY DERIVATION METHODS
                                                                                                                                                                    IN KEY ESTABLISHMENT SCHEMES


                                                                                                  describe the possibilities for the auxiliary MAC algorithm, which shall be chosen in
                                                                                                  accordance with the selection requirements specified in Section 7.

                                                                                               Implementation-Dependent Auxiliary PRF-based KDF:
                                                                                                 One of the general-purpose, PRF-based key-derivation functions defined in [SP 800-108] shall
                                                                                                 be used for key expansion. These key-derivation functions employ an approved MAC
                                                                                                 algorithm as the PRF. In this Recommendation, the PRF used by the KDF in key expansion is
                                                                                                 determined by the MAC algorithm that is used for randomness extraction. Specifically:

                                                                                                  a. If HMAC-hash is used in the randomness-extraction step, then the same HMAC-hash (i.e.,
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Cr2




                                                                                                     using the same hash function, hash) shall be used as the PRF in the key-expansion step;
                                                                                                     and

                                                                                                  b. If AES-128-CMAC, AES-192-CMAC, or AES-256-CMAC is used in the randomness-
                                                                                                     extraction step, then only AES-128-CMAC (i.e., the CMAC mode of AES-128) shall be
                                                                                                     used as the PRF in the key-expansion step.

                                                                                                  The rationale for these rules is discussed in Section 8.3.

                                                                                               Input:
                                                                                               1. Z – A byte string that represents the shared secret. It is used as the “message” during the
                                                                                                  execution of the MAC algorithm employed in the randomness-extraction step.
                                                                                               2. OtherInput, which includes:
                                                                                                  a. salt – A non-null (secret or non-secret) byte string used as the MAC key during the
                                                                                                     execution of the randomness-extraction step (i.e., step 1 in the process shown below). This
                                                                                                     salt could be, for example, a value computed from nonces exchanged as part of a key-
                                                                                                     establishment protocol that employs one or more of the key-agreement schemes specified
                                                                                                     in [SP 800-56A] or [SP 800-56B], a value already shared by the protocol participants, or a
                                                                                                     value that is pre-determined by the protocol. The possibilities for the length of salt are
                                                                                                     determined by the auxiliary MAC algorithm that is used for randomness extraction:

                                                                                                        (1) The HMAC-hash algorithm as defined in [FIPS 198] can accommodate keys of any
                                                                                                            length up to the maximum bit length permitted for input to the hash function, hash.
                                                                                                            Therefore, the length of the byte string salt can be as large as allowed for any string
                                                                                                            used as input to hash. However, if the bit length of salt is greater than the bit length
                                                                                                            specified for a single input block for hash, then the value of salt is replaced by
                                                                                                            hash(salt) as part of the HMAC computation. (Input-block lengths for the approved
                                                                                                            hash functions that can be employed to implement HMAC-hash are included in column
                                                                                                            4 of Table 1 in Section 4.2; also see Table 4 of Section 5.2.) In the absence of an agreed-
                                                                                                            upon alternative, the input salt value shall be an all-zero byte string whose length is
                                                                                                            equal to that of a single input block for the hash function, hash.

                                                                                                        (2) AES-N-CMAC requires keys that are N bits long (for N = 128, 192, or 256), depending
                                                                                                            upon the AES variant that is used in the implementation. The bit length of salt shall be



                                                                                                                                                  18
