NIST SP 800-166                                                   DERIVED PIV APPLICATION AND
                                                                  DATA MODEL TEST GUIDELINES

                             •   CLA is set to:
                                  1. '00' if command chaining is not needed or
                                  2. '10' if command chaining is used. (The last
                                     chain of the command sets CLA to '00')
                             •   P1, algorithm reference, is set to '07', '11' or
                                 '14'
                             •   P2, key reference, is set to '9C' indicating the
                                 digital signature key
                             •   Data field in the command is to include '81'
                                 specifying a challenge, followed by a randomly
                                 generated challenge (with an incorrect length
                                 based on the chosen algorithm [e.g., challenge is
                                 greater than they key size]), and '82 00' in
                                 order to request a response
 Expected Result(s)   1. From Step 1, the command returns the application property template
                         with the status word '90 00'.
                      2. From Step 2, the command returns status word '90 00'.
                      3. From Step 3, the command returns status word '6A 86' (incorrect
                         parameter in P1 or P2).
                      4. From Step 4, the command returns status word '90 00'.
                      5. From Step 5, the command returns status word '6A 80' (incorrect
                         parameter in command data field).
 Postcondition(s)     N/A

8.3.3.7 General Authenticate with the Key Management Key

 Test Assertion       TA-08.03.03.07
 Purpose              Verifies that the Derived PIV Application responds to the GENERAL
                      AUTHENTICATE command appropriately when using the key
                      management key.
 DTR(s)               • DTR-06.02.02.09
                      • DTR-06.03.01.01
                      • DTR-06.03.01.02
                      • DTR-06.03.04.03
                      • DTR-06.03.04.05
 Vendor               None.
 Documentation
 Precondition(s)      •   A token with the Derived PIV Application is inserted into an
                          appropriate token reader.
                      •   Suitable drivers have been loaded between the test system and an
                          instance of the reader.
                      •   The Derived PIV Application Password is recorded.
                      •   The Derived PIV Application Password’s retry counter is not 0.
 Test Scenario        1. Send the SELECT command with
                            • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                      2. Send the GENERAL AUTHENTICATE command
                            • CLA is set to:



                                            55
