NIST SP 800-85A-4                                         PIV CARD APPLICATION & MIDDLEWARE
                                                                   INTERFACE TEST GUIDELINES

 Postcondition(s)      N/A


C.2.4.4        Virtual Contact Interface
 Purpose               1. Validates the GENERAL AUTHENTICATE command to:
                       2. Authenticate the PIV Card Application to the Test Toolkit
                           Application (INTERNAL AUTHENTICATE).
                       3. Authenticate the client application (EXTERNAL
                           AUTHENTICATE).
                       4. Two-way authentication of PIV Card Application and Test
                           Toolkit Application (MUTUAL AUTHENTICATE).
                       5. Sign with the '9C' digital signature private key.
                       6. Enable key-establishment functionality with the '9D' key
                           management private key.
                       7. Enable key history mechanism functionality with retired key
                           management private keys.
 Reference(s)          1. SP 800-73-4 Part 2, Section 3.2.4
                       2. AS05.01, AS03.06, AS05.25, AS05.34 through AS05.36B
 Precondition(s)       1. The IUT is placed within the reading range of the contactless
                          reader.
                       2. There exists a valid PC/SC connection between the test system
                          and the contactless reader.
                       3. No other contactless card is within the proximity of the reader.
                       4. The PIV Card Application is the currently selected application on
                          the card.
                       5. The security status indicator is set to FALSE for all authenticators
                          except the pairing code.
                       6. There exists a valid VCI connection to the card.
 Test Scenario         1. Send SELECT card command without secure messaging with
                          • AID == 'A0 00 00 03 08 00 00 10 00 01 00'
                       2. Perform steps 2 – 17 in C.2.4.1 using the '0C' CLA byte
 Expected Result(s)    1. Command returns the application property template with the
                          status word '90 00' at the end.
                       2. See expected results for C.2.4.1 except for steps 5 and 6, which
                          will result in '69 82' (security status not satisfied).
 Postcondition(s)      N/A




                                       C-39
