                                                                                               NIST SP 800-56B REV. 2                            RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                      USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                               5.6.1 Unilateral Key Confirmation for Key-Establishment Schemes
                                                                                               As specified in this Recommendation, unilateral key confirmation occurs when one participant in
                                                                                               the execution of a key-establishment scheme (the key-confirmation “provider”) demonstrates to
                                                                                               the satisfaction of the other participant (the key-confirmation “recipient”) that both the KC
                                                                                               provider and the KC recipient have possession of the same secret MacKey.
                                                                                               MacKey shall be a symmetric key that is unique to a specific execution of a key-establishment
                                                                                               scheme and (from the perspective of the KC provider) shall be unpredictable prior to that key-
                                                                                               establishment transaction. In the case of a key-agreement scheme, MacKey is derived using the
                                                                                               shared secret Z created during the execution of that scheme (see Section 5.5 for the details of key
                                                                                               derivation). In the case of a key-transport scheme, MacKey is included as part of the transported
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                               keying material. Step_2 below specifies how MacKey is to be extracted from the derived or
                                                                                               transported keying material.
                                                                                               MacKey and certain context-specific MacData (as specified below) are used by the KC provider
                                                                                               as input to an approved MAC algorithm to obtain a MAC tag that is sent to the KC recipient. The
                                                                                               recipient performs an independent computation of the MAC tag. If the MAC tag value computed
                                                                                               by the KC recipient matches the MAC tag value received from the KC provider, then key
                                                                                               confirmation is successful. (See Section 5.2 for MAC-tag generation and verification, and Section
                                                                                               5.6.3 for a discussion of MAC-tag security.)
                                                                                               In the case of a scheme providing key-agreement, successful key confirmation following key
                                                                                               agreement provides assurance to the KC recipient that the same Z value has been used by both
                                                                                               parties to correctly derive the keying material (which includes MacKey). In the case of a key-
                                                                                               transport scheme (see Section 9.2.4), successful key confirmation provides assurance to the KC
                                                                                               recipient (who sent the keying material) that the transported keying material (which includes
                                                                                               MacKey) has been correctly decrypted by the party to whom it was sent.
                                                                                               A close examination of the KC process shows that each of the pair-wise key-establishment
                                                                                               schemes specified in this Recommendation that incorporate key confirmation can be used to
                                                                                               provide the KC recipient with assurance that the KC provider is currently in possession of the
                                                                                               (correct) private key – the one corresponding to the KC provider’s public key-establishment key.
                                                                                               The use of transaction-specific values for both MacKey and MacData prevents (for all practical
                                                                                               purposes) the replay of any previously computed value of MacTag. The receipt of a correctly
                                                                                               computed MAC tag provides assurance to the KC recipient that the KC provider has used the
                                                                                               correct private key during the current transaction – to successfully recover the secret data that is a
                                                                                               prerequisite to learning the value of MacKey.
                                                                                               To include unilateral key confirmation, the following steps shall be incorporated into the scheme.
                                                                                               (Additional details will be provided for each scheme in the appropriate subsections of Sections 8
                                                                                               and 9.) In the discussion that follows, the key-confirmation provider, P, may be either party U or
                                                                                               party V, as long as the KC provider, P, contributes a key pair to the key-establishment transaction.
                                                                                               The key-confirmation recipient, R, is the other party.
                                                                                                  1. The provider, P, computes
                                                                                                        MacDataP = message_stringP || IDP || IDR || EphemDataP || EphemDataR {|| TextP}
                                                                                                      where

                                                                                                                                                30
