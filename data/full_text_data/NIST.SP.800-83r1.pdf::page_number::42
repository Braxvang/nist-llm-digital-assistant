                                 GUIDE TO MALWARE INCIDENT PREVENTION AND HANDLING FOR DESKTOPS AND LAPTOPS


success of the eradication. A reduction in the number of infected hosts would demonstrate that the
incident response team was making progress and would help the team choose the best strategy for
handling the remaining hosts and allocate sufficient time and resources. It can be tempting to declare an
incident resolved once the number of infected hosts has dropped significantly from the original numbers,
but the organization should strive to reduce the suspected numbers of infected and vulnerable machines to
low enough levels that if they were all connected to the network at once and the vulnerable machines all
became infected, the overall impact of the infections would be minimal.

4.5   Recovery

The two main aspects of recovery from malware incidents are restoring the functionality and data of
infected hosts and removing temporary containment measures. Additional actions to restore hosts are not
necessary for most malware incidents that cause limited host damage (for example, an infection that
simply altered a few data files and was completely removable with antivirus software). As discussed in
Section 4.4, for malware incidents that are far more damaging, such as Trojan horses, rootkits, or
backdoors, corrupting thousands of system and data files, or wiping out hard drives, it is often best to first
rebuild the host, then secure the host so that it is no longer vulnerable to the malware threat.
Organizations should carefully consider possible worst-case scenarios, such as a new malware threat that
necessitates rebuilding a large percentage of the organization’s workstations, and determine how the hosts
would be recovered in these cases. This should include identifying who would perform the recovery tasks,
estimating how many hours of labor would be needed and how much calendar time would elapse, and
determining how the recovery efforts should be prioritized.

Determining when to remove temporary containment measures, such as suspended services (e.g., email)
or connectivity (e.g., Internet access, VPN for telecommuters), is often a difficult decision during major
malware incidents. For example, suppose that email has been shut down to stop the spread of a malware
infection while vulnerable hosts are patched and infected hosts undergo individual malware containment,
eradication, and recovery measures. It might take days or weeks for all vulnerable hosts to be located and
patched and for all infected hosts to be cleaned, but email cannot remain suspended for that period of
time. When email service is restored, it is almost certain that an infected host will begin spreading the
malware again at some time. However, if nearly all hosts have been patched and cleaned, the impact of a
new malware infection should be minimal. Incident response teams should strive to keep containment
measures in place until the estimated number of infected hosts and hosts vulnerable to infection is
sufficiently low that subsequent incidents should be of little consequence. Incident handlers should also
consider alternative containment measures that could adequately maintain containment of the incident
while causing less of an impact on the normal functions of the organization. However, even though the
incident response team should assess the risks of restoring the service, management should ultimately be
responsible for determining what should be done, based on the incident response team’s recommendations
and management’s understanding of the business impact of maintaining the containment measures.

4.6   Lessons Learned

When a major malware incident occurs, the primary individuals performing the response usually work
intensively for days or weeks. As the major handling efforts end, the key people are usually mentally and
physically fatigued, and are behind in performing other tasks that were pending during the incident
handling period. Consequently, the lessons learned phase of incident response might be significantly
delayed or skipped altogether for major malware incidents. However, because major malware incidents
can be extremely expensive to handle, it is particularly important for organizations to conduct robust
lessons learned activities for major malware incidents. Although it is reasonable to give handlers and
other key people a few days to catch up on other tasks, review meetings and other efforts should occur
expeditiously, while the incident is still fresh in everyone’s minds. The lessons learned process for


                                                     31
