                                                              GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6




                    Figure 4-7. Reverse Routability—BU and BUA Protected with Kbm

Now, over the optimized route, the MN sends normal traffic with the Home Address Option, and the CN
sends normal traffic with a Type 2 Routing Header.

To prevent various abuses, restrictions exist on using the Home Address Option and Type 2 Routing
Header. For the former, the rules are:

   Only one Home Address Option is allowed per packet, it must not be altered en route, it must contain
    a routable, unicast address, and it must not cause changes in the routing or binding cache.

   A BU at a CN must be authenticated with a Kbn established with return routability.

   A BU at a HA must be authenticated with transport mode ESP.

   All other cases must correspond to an entry in the binding cache.
The rules for Type 2 Routing Headers are:

   Only one type 2 routing header is allowed per packet, and it may only have one segment remaining.

   The HoA in the Type 2 Routing Header cannot have smaller scope than the CoA in the destination, it
    must be routable and unicast, and it must be the correct one for the MN.
In summary, an attacker has to intercept two messages sent along different paths to get Kbm. Perhaps the
greatest danger of this is on the MN’s local link, but here IPsec with encryption protects the Home
Keygen Token in the Home Test (message 3).

RFC 4449 describes an efficient alternative to return routability, whereby the MN and CN have pre-
shared a Kcn and nonces, and both can compute Kbm directly. This may be useful, for example, when the
MN accesses servers at its home site. The CN needs to trust the MN not to use its pre-shared data to


                                                  4-24
