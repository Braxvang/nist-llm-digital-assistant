NIST SP 800-90A Rev. 1                                            Recommendation for Random Number
                                                                   Generation Using Deterministic RBGs


        4. (status, entropy_input) = Get_entropy_input (security_strength, 1000,
           prediction_resistance_request).
        5. If (status ≠ “Success”), then Return (status, -1).
                                              Comment: Increment the nonce; actual coding must
                                              ensure that it wraps when the storage limit is
                                              reached.
        6. instantiation_nonce = instantiation_nonce + 1.
                                                      Comment: The instantiate algorithm is
                                                      provided in steps 7 to 11.
        7. seed_material = entropy_input || instantiation_nonce || personalization_string.
        8. seed = Hash_df (seed_material, 440).       Comment: Hash_df is defined in Section
                                                      10.3.1.

        9. V = seed.
        10. C = Hash_df ((0x00 || V), 440).
        11. reseed_counter = 1.
                                                      Comment: Find an unused internal state.
        12. (status, state_handle) = Find_state_space ( ).
        13. If (status ≠ “Success”), then Return (status, -1).
        14. Save the internal state.
           14.1 internal_state (state_handle).V = V.
           14.2 internal_state (state_handle).C = C.
           14.3 internal_state (state_handle).reseed_counter = reseed_counter.
           14.4 internal_state (state_handle). security_strength = security_strength.
           14.5 internal_state (state_handle).prediction_resistance_flag =
                prediction_resistance_flag.
        15. Return (“Success”, state_handle).
B.1.2      Reseeding a Hash_DRBG Instantiation

The implementation is designed to return a text message as the status when an error is
encountered.
Hash_DRBG_Reseed_function:
   Input: integer (state_handle, prediction_resistance_request), bitstring additional_input.
   Output: string status.
   Process:
                                              Comment: Check the validity of the state_handle.


                                                 73
