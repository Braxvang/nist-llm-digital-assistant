                                                                   GUIDELINES ON FIREWALLS AND FIREWALL POLICY


3.3   Architecture with Multiple Layers of Firewalls

There is no limitation on where a firewall can be placed in a network. While firewalls should be at the
edge of a logical network boundary, creating an “inside” and “outside” on either side of the firewall, a
network administrator may wish to have additional boundaries within the network and deploy additional
firewalls to establish such boundaries. The use of multiple layers of firewalls is quite common to provide
defense-in-depth. An example of this was mentioned in Section 2.2.1, where a host-based firewall creates
a boundary just before the host it is installed upon and adds another set of firewall policies to the
architecture of the network. Using multiple layers of network firewalls is another common technique.

A typical situation that requires multiple layers of network firewalls is the presence of internal users with
varying levels of trust. For example, an organization might want to protect its accounting databases from
being accessed by users who are not part of the accounting department. This could be accomplished by
placing one firewall at the edge of the network (to prevent general access to the network from the
Internet) and another at the edge of the internal network that defines the boundary of the accounting
department. The inner firewall would block access to the database server by anyone outside the
accounting network while allowing limited access to other resources on the accounting network. Another
typical use for firewalls inside a network with a firewall at its edge involves visitors who need access to
the Internet. Many organizations deploy specific wireless access points within their networks for visitor
use. A firewall between the access points and the rest of the internal network can prevent visitors from
accessing the local network with the same privileges as an employee.

Placing a firewall within a network that already has one at the edge requires good planning and policy
coordination to prevent inadvertent security lapses. When designing policies for an inner firewall, the
administrator could make assumptions that result in poor policy choices—for example, if the inner
firewall’s administrator assumes that the outer firewall is already preventing certain types of traffic from
reaching the inner firewall, and the outer firewall’s administrator later modifies existing policy, hosts
behind the inner firewall will be exposed to additional threats. A better approach is to duplicate outer
firewall policies that are also relevant for inner firewalls on each inner firewall. This may be difficult if
these firewalls are not able to coordinate their policies automatically, which is particularly likely when
firewalls are from different manufacturers.

Another common problem with using multiple layers of network firewalls is the increased difficulty it
presents in tracing firewall problems. If one firewall stands between a user and a server, and the user
cannot connect to the server, it is easy to check that firewall’s logs to see if the connection is being
permitted. But if multiple firewalls are involved, the problem becomes more difficult because an
administrator must locate all firewalls in the chain and check their logs to find where the problem
originates. The presence of multiple layers of application-proxy gateways is particularly daunting,
because each gateway can change a message, which makes debugging even more difficult.

3.4   Summary of Recommendations

The following items summarize the major recommendations from this section:

 In general, a firewall should fit into a current network’s layout. However, an organization might
  change its network architecture at the same time as it deploys a firewall as part of an overall security
  upgrade.
 Different common network architectures lead to very different choices for where to place a firewall,
  so an organization should assess which architecture works best for its security goals.




                                                     3-4
