                                                                                             NIST SP 800-193                                           PLATFORM FIRMWARE RESILIENCY GUIDELINES


                                                                                                            Note: Integrity verification could also be performed at runtime. These mechanisms
                                                                                                            may or may not be anchored in the RTD.

                                                                                                     b) Symbiont devices may rely on a host device to perform detection. If the symbiont
                                                                                                        device boots independently from the host device, integrity verification of the
                                                                                                        symbiont’s device firmware shall be performed prior to execution of code outside the
                                                                                                        host CTD. In such cases, the following additional requirements apply:
                                                                                                        i) The symbiont’s firmware shall be protected according to the requirements in
                                                                                                           Section 4.2.1.
                                                                                                        ii) The host device should be capable of immediately triggering a recovery of the
                                                                                                            symbiont’s firmware, followed by a restart of the device, in cases where
                                                                                                            corruption is detected.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-193




                                                                                                     c) Certain hardware devices (e.g., FPGAs, CPLDs) may have field-upgradable logic
                                                                                                        rather than firmware code, often referred to as configuration bitstream. If these
                                                                                                        devices do not have the ability to support cryptographic verification or the ability to
                                                                                                        measure and report in conformance with a) or b), they shall use hardware-based
                                                                                                        mechanisms to detect device load failures.
                                                                                                     d) Other techniques (e.g., watchdog timers) may be used in combination with
                                                                                                        cryptographic integrity checks to detect other problems with the initialization process
                                                                                                        of platform devices.
                                                                                                3) If corruption is detected, the RTD or CTD should be capable of starting a recovery
                                                                                                   process to restore the device firmware code back to an authentic version.
                                                                                                4) The detection mechanism should be capable of creating notifications of corruption.
                                                                                                5) The detection mechanism should be capable of logging events when corruption is
                                                                                                   detected.
                                                                                                6) The detection mechanisms may be capable of using policies set by the Platform
                                                                                                   Administrator which define the actions taken by the RTD/CTD in the above guidelines.

                                                                                             4.3.2   Detection of Corrupted Critical Data

                                                                                             This section describes mechanisms to detect invalid or corrupted critical data in platform
                                                                                             devices. As noted above, invalid critical data could render a device inoperable or disable certain
                                                                                             critical security functionality. Verifying critical data is challenging, because data is often
                                                                                             intended to be user-configurable. The guidelines in this section recommend either directly
                                                                                             verifying critical data contents or implementing other mechanisms to look for symptoms of data
                                                                                             corruption.

                                                                                                1) The RTD or CTD shall perform integrity checks on the critical data prior to use. Integrity
                                                                                                   checks may take the form, for example, of validating the data against known valid values
                                                                                                   or verifying the hash of the data storage.
                                                                                                2) Either as an alternative to integrity checks (for devices that cannot support such a
                                                                                                   capability) or in addition to those checks, the RTD or CTD may use watchdog timers to
                                                                                                   detect potential corruption of critical data.

                                                                                                                                              26
