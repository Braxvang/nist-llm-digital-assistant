NIST SP 800-38G                                                METHODS FOR FORMAT-PRESERVING ENCRYPTION



x mod m               The nonnegative remainder of the integer x modulo the positive integer m.

X [i]                 The i th element of the string X.

X [i .. j]            The substring of the string X from X [i] to X [j], including X [i] and X [j].

X⊕Y                   The bitwise exclusive-OR of bit strings X and Y whose bit lengths are equal.

X || Y                The concatenation of numeral strings X and Y.

0s                    The bit string that consists of s consecutive ‘0’ bits.

4       Preliminaries

4.1      Representation of Character Strings

The data inputs and outputs for FF1 and FF3 are sequences of numbers that can represent both
numeric and non-numeric data, as discussed below.

A finite set of two or more symbols is called an alphabet. The symbols in an alphabet are called
the characters of the alphabet. The number of characters in an alphabet is called the base,
denoted by radix; thus, radix ≥ 2.

A character string is a finite sequence of characters from an alphabet; individual characters may
repeat in the string. In this publication, character strings (and bit strings) are presented in the
Courier New font.

Thus, for the alphabet of lower-case English letters,

                  {a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z},

hello and cannot are character strings, but Hello and can’t are not, because the symbols
“H” and “ ’ ” are not in the alphabet.

SSNs or CCNs can be regarded as character strings in the alphabet of base ten numerals, namely,
{0, 1, 2, 3, 4, 5, 6, 7, 8, 9}. The notion of numerals is generalized to any given base as follows:
the set of base radix numerals is

                                             {0, 1, …, radix-1}.

The data inputs and outputs to the FF1 and FF3 encryption and decryption functions must be
finite sequences of numerals, i.e., numeral strings. If the data to be encrypted is formatted in an
alphabet that is not already the set of base radix numerals, then each character must be
represented by a distinct numeral in order to apply FF1 or FF3.

For example, the natural representation of lower-case English letters with base 26 numerals is

                              a→0, b→1, c→2, … x→23, y→24, z→25.

                                                        6
