      NIST SP 800-63C-4 ipd                                               Digital Identity Guidelines
      December 2022                                                       Federation and Assertions


848   applicable provisions and requirements in the SP 800-63 guidelines. The IdP SHALL
849   determine which identity attributes are passed to the allowlisted RP upon authentication.
850   IdPs SHALL make allowlists available to subscribers as described in Sec. 9.2.
851   IdP allowlists SHALL uniquely identify RPs through the means of domain names,
852   cryptographic keys, or other identifiers applicable to the federation protocol in use. Any
853   entities that share an identifier SHALL be considered equivalent for the purposes of the
854   allowlist. For example, a wildcard domain identifier of “*.example.com” would match
855   the domains “www.example.com”, “service.example.com”, and “unknown.example.com”
856   equally. All three of these sites would be treated as the same RP for disclosure decisions
857   using the allowlist. Allowlists SHOULD be as specific as possible to avoid unintentional
858   impersonation of an RP.

859   5.3.2. IdP Blocklists of RPs
860   IdPs MAY establish blocklists of RPs not authorized to receive authentication assertions
861   or attributes from the IdP, even if requested to do so by the subscriber. If an RP is on an
862   IdP’s blocklist, the IdP SHALL NOT produce an assertion targeting the RP in question
863   under any circumstances.
864   IdP blocklists SHALL uniquely identify RPs through the means of domain names,
865   cryptographic keys, or other identifiers applicable to the federation protocol in use. Any
866   entities that share an identifier SHALL be considered equivalent for the purposes of the
867   blocklist. For example, a wildcard domain identifier of “*.example.com” would match
868   the domains “www.example.com”, “service.example.com”, and “unknown.example.com”
869   equally. All three of these sites would be treated as the same RP for decisions using the
870   blocklist.

871   5.3.3. IdP Runtime Decisions
872   Every RP that is in a trust agreement with an IdP but not on an allowlist or a blocklist
873   with that IdP SHALL be governed by a default policy in which runtime authorization
874   decisions will be made by an authorized party identified by the trust agreement. In most
875   circumstances, and for practical purposes, the authorized party is the subscriber; however,
876   it is possible for an administrator or other party to be prompted on behalf of the subscriber.
877   Note that in a dynamic trust agreement, only a runtime decision can be used to authorize
878   the release of attributes.
879   In this mode of operation, the authorized party is prompted by the IdP during the
880   federation transaction for their consent to provide an authentication assertion and release
881   specific attributes to the RP on behalf of the subscriber. The IdP SHALL provide the
882   authorized party with explicit notice and prompt them for positive confirmation before
883   any attributes about the subscriber are transmitted to the RP. At a minimum, the notice
884    SHOULD be provided by the party in the position to provide the most effective notice and
885   obtain confirmation, consistent with Sec. 9.2. The IdP SHALL disclose which attributes

                                                   22
