SECURE DOMAIN NAME SYSTEM (DNS) DEPLOYMENT GUIDE



           example.com         IN    DNSKEY      256     3    8   BQFG+KGJ7………. (Base64 encoded
           key string)

Hence, the contents of the file containing the public key can be readily added to the zone file
(zonedb.example.com) contents by using the following command:

           cat *.key >> /var/named/zonedb.example.com

After the DNSKEY RR containing the public key is added to the zone file, the zone’s serial number in the
SOA RR must be increased prior to actually signing the zone.

9.4       Secure Storage of Private Keys (DNSSEC-OP2)

The private keys in the KSK and ZSK key pairs should be protected from unauthorized access. If
possible, the private keys should be stored offline (with respect to the Internet facing DNSSEC-aware
name server) in a physically secure, non-network-accessible machine along with the zone file master
copy. The signatures generated by using the private keys should be transferred to the primary
authoritative name servers through a load process, using a dynamically established network connection
(rather than a permanent network link).

This strategy is not feasible in situations in which the DNSSEC-aware name server has to support
dynamic updates. To support dynamic update transactions, the DNSSEC-aware name server (which
usually is a primary authoritative name server) has to have both the zone file master copy and the private
key corresponding to the zone-signing key (ZSK-private) online to immediately update the signatures for
the updated RRsets. The private key corresponding to the key-signing key (KSK-private) can still be kept
offline. In this scenario, the following measures must be taken to protect ZSK-private:

      •    The shell from which the key generation program/utility is invoked should not be accessible
           except by authorized zone administrators/operators.

      •    The directory in which the private key files are stored (usually a subdirectory under a directory
           with the same name as the zone, with the file names in that directory having the name structure
           K<zonename>.+AlgorithmID+<keytag>.private in BIND) should not be accessible/visible except
           to authorized zone administrators/operators.

      •    Sufficient fault tolerance should be provided for the contents of the directory containing the
           private key files, either by having a mirrored disk or through periodic backups on tape,
           CD/DVDs, or optical media. The backup media also should be protected against disclosure,
           tampering, or theft.

      •    Another strategy is to store the private keys in an encrypted file system.


Checklist item 16: The private keys corresponding to both the ZSK and the KSK should not be kept on
the DNSSEC-aware primary authoritative name server when the name server does not support dynamic
updates. If dynamic update is supported, the private key corresponding to the ZSK alone should be kept
on the name server, with appropriate directory/file-level access control list-based or cryptography-based
protections.




                                                       9-8
