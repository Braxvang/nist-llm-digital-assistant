                                                                          GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6




       Version (4)        Traffic Class (8)                              Flow Label (20 bits)

                     Payload length (16)                           Next Header (8)                Hop Limit (8)

                                                Source Address (128 bits)

                                             Destination Address (128 bits)


                          Figure 2-1. The IPv6 Packet Header Format (Field Sizes in Bits)7

    2.3.4   Extension Headers

An IPv4 header can be extended from 20 bytes to a maximum of 60 bytes, but this option is rarely used
because it impedes performance and is often administratively prohibited for security reasons. IPv6 has a
new method to handle options, which allows substantially improved processing and avoids some of the
security problems that IPv4 options generated. IPv6 RFC 2460 defines six extension headers: hop-by-
hop option header, routing header, fragment header, destination options header, authentication header
(AH), and encapsulating security payload (ESP) header. Each extension header is identified by the Next
Header field in the preceding header. Section 3.4 describes extension headers in detail.

    2.3.5   Mandatory Internet Protocol Security (IPsec) Support

IP security (IPsec) is a suite of protocols for securing Internet Protocol (IP) communications by
authenticating the sender and providing integrity protection plus optionally confidentiality for the
transmitted data. This is accomplished through the use of two extension headers: the Encapsulating
Security Payload (ESP) and the Authentication Header (AH). The negotiation and management of IPsec
security protections and the associated secret keys is handled by the Internet Key Exchange (IKE)
protocol. IPsec is a mandatory part of an IPv6 implementation; however, its use is not required. IPsec is
also specified for securing particular IPv6 protocols (e.g., Mobile IPv6 and OSPFv3 [Open Shortest Path
First version 3]). Section 5.3 describes IPsec in detail.

    2.3.6   Mobility

Mobile IPv6 (MIPv6) is an enhanced protocol supporting roaming for a mobile node, so that it can move
from one network to another without losing IP-layer connectivity (as defined in RFC 3775). RFC 3344,
IP Mobility Support for IPv4, describes Mobile IP concepts and specifications for IPv4. Nevertheless,
using Mobile IP with IPv4 has various limitations, such as limited address space, dependence on address
resolution protocol (ARP), and challenges with handover when a device moves from one access point to
another. Mobile IPv6 uses IPv6â€™s vast address space and Neighbor Discovery (RFC 4861) to solve the
handover problem at the network layer and maintain connections to applications and services if a device
changes its temporary IP address. Mobile IPv6 also introduces new security concerns such as route
optimization (RFC 4449) where data flow between the home agent and mobile node will need to be
appropriately secured.



7
     Additional illustration and explanation of the major differences between the IPv6 and IPv4 headers can be found in the GAO
     report, Internet Protocol Version 6: Federal Agencies Need to Plan for Transition and Manage Security Risks.


                                                             2-4
