                                NIST Special Publication 800-38D


8.2.1 Deterministic Construction

In the deterministic construction, the IV is the concatenation of two fields, called the fixed field
and the invocation field. The fixed field shall identify the device, or, more generally, the context
for the instance of the authenticated encryption function. The invocation field shall identify the
sets of inputs to the authenticated encryption function in that particular device.

For any given key, no two distinct devices shall share the same fixed field, and no two distinct
sets of inputs to any single device shall share the same invocation field. Compliance with these
two requirements implies compliance with the uniqueness requirement on IVs in Sec. 8.

If desired, the fixed field itself may be constructed from two or more smaller fields. Moreover,
one of those smaller fields could consist of bits that are arbitrary (i.e., not necessarily
deterministic nor unique to the device), as long as the remaining bits ensure that the fixed field is
not repeated in its entirety for some other device with the same key.

Similarly, the entire fixed field may consist of arbitrary bits when there is only one context to
identify, such as when a fresh key is limited to a single session of a communications protocol. In
this case, if different participants in the session share a common fixed field, then the protocol
shall ensure that the invocation fields are distinct for distinct data inputs.

The invocation field typically is either 1) an integer counter or 2) a linear feedback shift register
that is driven by a primitive polynomial to ensure a maximal cycle length. In either case, the
invocation field increments upon each invocation of the authenticated encryption function.

The lengths and positions of the fixed field and the invocation field shall be fixed for each
supported IV length for the life of the key. In order to promote interoperability for the default IV
length of 96 bits, this Recommendation suggests, but does not require, that the leading (i.e.,
leftmost) 32 bits of the IV hold the fixed field; and that the trailing (i.e., rightmost) 64 bits hold
the invocation field.

8.2.2 RBG-based Construction

In the RBG-based construction, the IV is the concatenation of two fields, called the random field
and the free field. For each IV length that is supported by the implementation and used with the
RBG-based construction, the lengths of these fields shall be fixed for the life of the key.
Moreover, the length of the random field shall be at least 96 bits; the free field may be empty.

If i is a supported IV length that is associated to the RBG-based construction, then let r(i) denote
the bit length of the random field. The random field shall either consist of 1) an output string of
r(i) bits from an approved RBG with a sufficient security strength, or 2) the result of applying the
r(i)–bit incrementing function to the random field of the preceding IV for the given key. The
r(i)–bit output string from the RBG is called a direct random string, and the random fields that
result from applying the r(i)–bit incrementing function are called its successors.




                                                 20
