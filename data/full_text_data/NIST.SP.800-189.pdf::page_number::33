                                                                                             NIST SP 800-189                                                                 RESILIENT INTERDOMAIN TRAFFIC EXCHANGE:
                                                                                                                                                                                     BGP SECURITY & DDOS MITIGATION

                                                                                                         provider. In this case, only the default route should be accepted and nothing else. If the
                                                                                                         leaf customer requires the full routing table from the transit provider, then it should apply
                                                                                                         the following inbound prefix filters:

                                                                                                              •    Unallocated prefixes
                                                                                                              •    Special-purpose prefixes
                                                                                                              •    Prefixes that the AS (i.e., leaf customer) originates
                                                                                                              •    Prefixes that exceed a specificity limit
                                                                                                              •    Default route

                                                                                                       Security Recommendation 34: Outbound prefix filtering for leaf customer facing
                                                                                                       transit provider – A leaf customer network should apply a very simple outbound policy
                                                                                                       of announcing only the prefixes it originates. However, it may additionally apply the same
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-189




                                                                                                       outbound prefix filters as those for a lateral peer (see Section 4.5.1) to observe extra
                                                                                                       caution.

                                                                                             4.6       Role of RPKI in Prefix Filtering

                                                                                             An ISP can retrieve (from RPKI registries) all available route origin authorizations (ROAs)
                                                                                             corresponding to autonomous systems (ASes) that are known to belong in their customer cone
                                                                                             (see definition in Section 2.3).14 From the available ROAs, it is possible to determine the
                                                                                             prefixes that can be originated from the ASes in the customer cone. As the RPKI registries
                                                                                             become mature with increasing adoption, the prefix lists derived from ROAs will become useful
                                                                                             for prefix filtering. Even in the early stages of RPKI adoption, the prefix lists (from ROAs) can
                                                                                             help cross-check and/or augment the prefix filter lists that an ISP constructs by other means.

                                                                                                       Security Recommendation 35: The ROA data (available from RPKI registries) should
                                                                                                       be used to construct and/or augment prefix filter lists for customer interfaces. 15 16

                                                                                             4.7       AS Path Validation (Emerging/Future)

                                                                                             The IETF standard for BGP path validation (BGP-PV), namely BGPsec [RFC8205], is available
                                                                                             but commercial vendor implementations are not currently available. Hence, this section briefly
                                                                                             describes the technology and standards but does not make any security recommendations
                                                                                             concerning BGP-PV.

                                                                                             As observed in Sections 4.3 and 4.3.1, BGP origin validation (BGP-OV) is necessary but, by
                                                                                             itself, is insufficient for fully securing the prefix and AS path in BGP announcements. BGP path


                                                                                             14
                                                                                                  The list of ASes in an AS’s customer cone can be determined by forming the list of unique origin ASes in all BGP
                                                                                                    announcements received (i.e., currently in the Adj-RIB-ins [RFC4271]) on all customer interfaces at the AS under
                                                                                                    consideration (see Step 3 in Section 3.4 in [EFP-uRPF]). This can be done in the network management system (off the
                                                                                                    router).

                                                                                             15
                                                                                                Security Recommendation 35 is possibly more applicable to smaller ISPs that have accurate visibility of their customer cone.
                                                                                                    Larger ISPs tend not to have such visibility.
                                                                                             16
                                                                                                It is generally not feasible to apply this on peer interfaces because it is not possible to accurately know a peer’s customer cone.
                                                                                                    Of course, BGP-OV (see Section 4.3) for detecting invalid prefix announcements is applied on all interfaces.


                                                                                                                                                              22
