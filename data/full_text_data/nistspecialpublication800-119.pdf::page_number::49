                                                                GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


        Neighbor Advertisement (NA). A response to a NS message. A node may also send
         unsolicited NAs to announce a link-layer address change.

        Redirect Message. Used by routers to inform hosts of a better first hop for a destination.

A common use of the NS and NA messages is to resolve IP addresses by discovering the MAC (Media
Access Control) addresses of nodes on the same link. A sender must discover the recipient’s MAC
address to send a data packet. Figure 3-11 illustrates this example of the ND process.




                                Figure 3-11. Example of Neighbor Discovery

For NS, the sending node (Host A) knows the unicast address of the destination node (Host B) is local
because of the network prefix. Knowing this, it uses a link-local solicited-node multicast address to send
its NS message. The process that allows the sending node to resolve this link-local MAC address is as
follows:

Destination Node Unicast Address:
2001:DB8::1234:5678:BBBB

NS solicited node multicast destination address (last 24-bits of the unicast address):
FF02::1:FFxx:xxxx       final form  FF02::1:FF78:BBBB

The sending node takes the low-order 24-bits of the unicast address of the destination node and uses them
to fill in the link-local solicited-node multicast address with format ―FF02::1:FFxx:xxxx‖. The NS
message includes both the IPv6 and MAC address of the sender, so the recipient can answer directly and
supply its own MAC address. The destination node, knowing its unicast address, will listen for the
corresponding solicited node multicast address. When the multicast message arrives at the destination,


                                                    3-27
