    A STATISTICAL TEST SUITE FOR RANDOM AND PSEUDORANDOM NUMBER GENERATORS FOR CRYPTOGRAPHIC APPLICATIONS



    [2]     S. Pincus and R. E. Kalman, “Not all (possibly) “random” sequences are created equal,” Proc.
            Natl. Acad. Sci. USA. Vol. 94, April 1997, pp. 3513-3518.

    [3]     A. Rukhin (2000), “Approximate entropy for testing randomness,” Journal of Applied
            Probability. Vol. 37, 2000.


    3.13 Cumulative Sums (Cusum) Test
    This test is based on the maximum absolute value of the partial sums of the sequence represented in the
    ±1 fashion. Large values of this statistic indicate that there are either too many ones or too many zeros at
    the early stages of the sequence. Small values indicate that ones and zeros are intermixed too evenly. A
    dual test can be derived from the reversed time random walk with Sk′ = X n + … + X n−k +1 . With this
    definition, the interpretation of the test results is modified by replacing “the early stages” by the late
    stages.”

    The test is based on the limiting distribution of the maximum
                                                             €    of the absolute values of the partial sums,
    max1≤k≤n Sk ,
                                max1≤k≤n Sk         1 ∞                  (u − 2kz) 2 
                          lim P
                          n →∞
                                       n
                                               ≤ z =
                                                     2n k=−∞
                                                                      k
                                                             ∫ (−1) exp− 2 du
€                                4 ∞ (−1) j        (2 j + 1) 2 π 2 
                               = ∑             exp−                 = H(z),z > 0 .                  (10)
                                 π j= 0 2 j + 1         8z 2       
              €
    With the test statistic z = max1≤k≤n Sk (obs) / n , the randomness hypothesis is rejected for large values
    of z, and the corresponding
                    €                                  (                  )        (
                                P-value is 1− H max1≤k≤n Sk (obs) / n = 1− G max1≤k≤n Sk (obs) / n            )
    where the function G(z) is defined by the formula (11).
               €
    The series H(z) in the last line of (10) converges quickly and should be used for numerical calculation
    only for small values of z. The
                                  € function G(z) (which is equal to H(z) for all z) is preferable for the
    calculation for moderate and large values of max1≤k≤n Sk (obs) / n ,

                                        1     z
                                                 ∞              (u − 2kz) 2 
                                 G(z) =
                                        2 π
                                            ∫−z ∑    (−1) k
                                                            exp−
                                                                     2
                                                                              du
                                                                             
                                      €         k=−∞
                                         ∞

                                                       [
                                     = ∑ (−1) k Φ((2k + 1) z) − Φ((2k −1) z)   ]
                                       k=−∞
                                                           ∞
                      €
                                                                [
                            = Φ(z) − Φ(−z) + 2∑ (−1) k Φ((2k + 1) z) − Φ((2k −1) z)     ]
                                                       k=1
                                             ∞
                         €
                                                   [
                      = Φ(z) − Φ(−z) − 2∑ 2Φ(( 4k −1) z) − Φ(( 4k + 1) z) − Φ(( 4k − 3) z)    ]
                                             k=1

                  €                ≈ Φ(z) − Φ(−z) − 2[2Φ(3z) − Φ(5z) − Φ(z)]
                                              4         z2 
                                       ≈ 1−        exp− ,z → ∞                                       (11)
          €                                   2π z      2
                       €
    where Φ(x) is the standard normal distribution.

                             €
                                                               3-21
