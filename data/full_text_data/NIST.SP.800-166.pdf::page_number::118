NIST SP 800-166                                                   DERIVED PIV APPLICATION AND
                                                                  DATA MODEL TEST GUIDELINES

                          3. From Step 3, the algorithm value is in accordance with Table 3-
                             3 of [SP800-78]. If the algorithm value is id-RSASSA-PSS,
                             then the hashAlgorithm field in signature->parameters is
                             populated with SHA-256 (OID = 2.16.840.1.101.3.4.2.1). For
                             RSA with PKCS #1 v1.5 padding, the parameters field is
                             populated with NULL. For ECDSA, the parameters field is
                             absent.

9.3.2.2 Subject Public Key Algorithm

 Test Assertion           TA-09.03.02.02
 Purpose                  Verifies that the public key algorithm used for generating the keys
                          is as specified in Table 3-4 of [SP800-78].
 DTR(s)                   • DTR-07.03.02.03
                          • DTR-07.03.02.04
 Issuer Documentation     None.
 Precondition(s)          • A token with the Derived PIV Application is inserted into an
                             appropriate token reader.
                          • Suitable drivers have been loaded between the test system and
                             an instance of the reader.
                          • A digital signature certificate is present within the Derived PIV
                             Application.
 Test Scenario            1. Send the SELECT command with
                                • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                          2. Send the GET DATA command with
                                • Data field of the command containing the tag
                                   ('5FC10A') of the X.509 Certificate for
                                   Digital Signature data object
                          3. Extract subjectPublicKeyInfo->algorithm->algorithm
                             field value.
                          4. Match the algorithm value to the Table 3-4 of
                             [SP800-78].
                          5. If the algorithm is elliptic curve, ensure that an
                             OID from Table 3-5 of [SP800-78] is populated in
                             the subjectPublicKeyInfo->algorithm->parameters-
                             >namedCurve field.

                          Note: If the RSA algorithm is used, the
                          subjectPublicKeyInfo->algorithm->parameters field will
                          be NULL.
 Expected Result(s)       1. From Step 1, the command returns the application property
                             template with the status word '90 00'.
                          2. From Step 2, the command returns the requested data object
                             along with the status word '90 00'.
                          3. From Steps 4 and 5, the digital signature key is generated using
                             an allowed asymmetric key algorithm.




                                           111
