       NIST SP 800-63C-4 ipd                                              Digital Identity Guidelines
       December 2022                                                      Federation and Assertions


1548   smaller and easier to process by the RP. The contents of the assertion can then be limited
1549   to essential fields (e.g., unique subject identifiers) and information about the immediate
1550   authentication event being asserted.
1551   The RP often caches attributes provided by the IdP in an RP subscriber account, discussed
1552   in Sec. 5.4. Attributes provided in the assertion are passed on every login, and since the
1553   RP does not know the identity of the subscriber before the attribute is requested, the IdP
1554   is incentivized to include as much information as possible in the assertion itself. However,
1555   most of a subscriber’s attributes will not change in between subsequent logins, making
1556   this information redundant. As a consequence, most of these more-stable attributes can
1557   instead be made available through an identity API that is called by the RP only when
1558   necessary. The IdP can indicate in the assertion when the last time the subscriber’s
1559   attributes have been updated in the subscriber account, allowing the RP to decide if it
1560   needs to fetch the attributes anew or if those in the RP subscriber account are sufficient.
1561   Access to the identity API SHALL be time limited. The time limitation is separate from
1562   the validity time window of the assertion and the lifetime of the authenticated session
1563   at the RP. Access to an identity API by the RP without an associated valid assertion
1564    SHALL NOT be sufficient for the establishment of an authenticated session at the RP.

1565   A given identity API deployment is expected to be capable of providing attributes for all
1566   subscribers for whom the IdP can create assertions. However, when access to the identity
1567   API is granted within the context of a federation transaction, the attributes provided
1568   by an identity API SHALL be associated with only the single subscriber identified in
1569   the associated assertion. If the identity API is hosted by the IdP, the returned attributes
1570    SHALL include the subject identifier for the subscriber. This allows the RP to positively
1571   correlate the assertion’s subject to the returned attributes. Note that when access to
1572   an attribute API is provided as part of pre-provisioning of RP subscriber accounts as
1573   discussed in Sec. 5.4.1, the RP is usually granted blanket access to the identity API
1574   outside the context of the federated transaction and these requirements do not apply.

1575   6.3.1. Attribute Providers
1576   While most attribute APIs used in federation are hosted as part of the IdP, it is also
1577   possible for the IdP to grant access to identity APIs hosted by external attribute providers.
1578   These services provide attributes about the subscriber in addition to those made available
1579   directly from the IdP.
1580   When the IdP grants access to an attribute provider, the IdP is making an explicit
1581   statement that the information returned from the attribute provider is associated with the
1582   subscriber identified in the associated assertion. For the purposes of the trust agreement,
1583   the IdP is the responsible party for the accuracy and content of the attribute API.
1584   The attributes returned by the attribute provider are assumed to be independent of those
1585   returned directly from the IdP, and as such MAY use different identifiers, formats, or

                                                    46
