                                                                                               NIST SP 800-56B REV. 2                            RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                      USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                               Party V provides MacTagV to party U (as specified in Section 5.6.1, with P = V and R = U), where
                                                                                               MacTagV is computed (as specified in Section 5.2.1) using
                                                                                                                MacDataV = “KC_1_V” || IDV || IDU || NV || C{ || TextV}.
                                                                                               Party U uses the identical format and values to compute TMacTagBits[MAC(MacKey, MacDataV), and
                                                                                               then verify that it matches the MacTagV value provided by party V.
                                                                                               The MacKey used during key confirmation shall be destroyed by party V immediately after the
                                                                                               computation of MacTagV, and by party U immediately after the verification of the received
                                                                                               MacTagV or a (final) determination that the received MacTagV is in error.
                                                                                               Certain messages may be combined or sent in a different order (e.g., NV and MacTagV may be sent
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                               together, or NV may be sent before C).

                                                                                               8.3      KAS2 Key Agreement
                                                                                               In this family of key-agreement schemes, key-establishment key pairs are used by both party U
                                                                                               and party V.
                                                                                               The schemes in this family have the following general form:
                                                                                                     1. Party U generates a secret value (which will become a component of the shared secret) and
                                                                                                        a corresponding ciphertext using the RSASVE.GENERATE operation and party V’s public
                                                                                                        key-establishment key, and sends the ciphertext to party V.
                                                                                                     2. Party V recovers party U’s secret component from the ciphertext received from party U
                                                                                                        using the RSASVE.RECOVER operation and its private key-establishment key.
                                                                                                     3. Party V generates a secret value (which will become a second component of the shared
                                                                                                        secret) and the corresponding ciphertext using the RSASVE.GENERATE operation and
                                                                                                        party U’s public key-establishment key, and sends the ciphertext to party U.
                                                                                                     4. Party U recovers party V’s secret component from the ciphertext received from party V
                                                                                                        using the RSASVE.RECOVER operation and its private key-establishment key.
                                                                                                     5. Both parties concatenate the two secret components to form the shared secret, and then
                                                                                                        derive keying material from the shared secret and “other information” using a key-
                                                                                                        derivation method. The length of the keying material that can be agreed on is limited only
                                                                                                        by the length that can be output by the key-derivation method.
                                                                                                     6. Party U and/or party V may additionally provide key confirmation. If key confirmation is
                                                                                                        incorporated, then the derived keying material is parsed into two parts, MacKey and
                                                                                                        KeyData. MacKey is then used to compute a MAC tag of MacTagLen bytes on MacData
                                                                                                        (see Sections 5.2.1, 5.2.2, 5.6.1 and 5.6.3). Key confirmation may be either unilateral or
                                                                                                        bilateral. When key confirmation is performed, a MacTag is sent from a KC provider to a
                                                                                                        KC recipient.
                                                                                                        When unilateral key confirmation in performed: One party assumes the role of the KC
                                                                                                        provider, and the other party assumes the role of the KC recipient. If the MAC tag
                                                                                                        computed by the provider matches the MAC tag computed by the recipient, then the
                                                                                                        successful establishment of keying material is confirmed by the recipient.

                                                                                                                                                 79
