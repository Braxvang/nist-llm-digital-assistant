NIST SP 800-85A-4                                        PIV CARD APPLICATION & MIDDLEWARE
                                                                  INTERFACE TEST GUIDELINES

 Purpose               Ensure the PIV Middleware catches invalid card handles.
 Target                pivGenerateKeyPair
 Reference(s)          1. SP 800-73-4 Part 3, Section 3.4.2
                       2. AS04.10
 Precondition(s)       1. The client application owns a connection to the PIV Card
                          Application accessible through cardHandle.
                       2. The client application has successfully selected the PIV Card
                          Application.
                       3. Mutual authentication with the client application using the PIV
                          Card Application Administration key has taken place
 Test Steps            1. Set cardHandle := <<invalid cardHandle>>
                       2. Set keyReference := <<an existing key reference suitable
                          for use with the specified cryptographicMechanism >>
                       3. Set cryptographicMechanism := <<a recognized cryptographic
                          mechanism identifier>>
                       4. Create publicKey reference
                       5. Call pivGenerateKeyPair with
                          • (IN) cardHandle
                          • (IN) keyReference
                          • (IN) cryptographicMechanism
                          • (OUT) publicKey
                          • (INOUT) KeyLength
 Expected Result(s)    Call returns with status_word of PIV_INVALID_CARD_HANDLE.
 Postcondition(s)      The precondition states are unaffected.


B.8.2.2         Identify and Handle an Invalid keyReference or Algorithm Combination
 Purpose                Ensure that the PIV Middleware identifies and handles an invalid
                        key reference.
 Target                pivGenerateKeyPair
 Reference(s)          1. SP 800-73-4 Part 3, Section 3.4.2
                       2. AS04.10
 Precondition(s)       1. The client application owns a connection to the PIV Card
                          Application accessible through cardHandle.
                       2. The client application has successfully selected the PIV Card
                          Application.
                       3. Mutual authentication with the client application using the PIV
                          Card Application Administration key has taken place.
 Test Steps            1. Set cardHandle := <<valid cardHandle>>
                       2. Set keyReference := <<a key reference not found in the
                          specification>>
                       3. Set cryptographicMechanism := <<a recognized cryptographic
                          mechanism identifier>>
                       4. Create publicKey reference
                       5. Call pivGenerateKeyPair with
                          • (IN) cardHandle
                          • (IN) keyReference



                                       B-22
