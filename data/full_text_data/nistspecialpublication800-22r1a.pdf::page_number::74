            A STATISTICAL TEST SUITE FOR RANDOM AND PSEUDORANDOM NUMBER GENERATORS FOR CRYPTOGRAPHIC APPLICATIONS




            3.8 Overlapping Template Matching Test
            This test rejects sequences which show too many or too few occurrences of m-runs of ones, but can be
            easily modified to detect irregular occurrences of any periodic pattern B.

            To implement this test, parameters M and N are determined so that n = MN, i.e., the original string is
            partitioned into N blocks, each of length M.

            Let W̃ j = W̃ j ( m,n ) be the number of (possibly overlapping) runs of ones of length m in the jth block.
            The asymptotic distribution of Wj is the compound Poisson distribution (the so-called Pòlya-Aeppli law,
            see[1]):

    €                                                                λ(e t −1) 
                                                 E exp{tW̃ j } → exp                                       (5)
                                                                      2 − e t 

            when ( M − m + 1)2−m → λ > 0 (t is a real variable).

                                    €
            The corresponding probabilities can be expressed in terms of the confluent hypergeometric function
            Φ =1 F1 . If U denotes a random variable with the compound Poisson asymptotic distribution, then for u ≥
        €   1 with η = λ /2 .
                                                           u
                                                      e−η  u −1 η l ηe−2η
                                       P (U = u) =        ∑         = u Φ( u + 1,2,η) .
                                                      2 u l=1  l −1 l! 2
€
        € For example,
                                                          P (U = 0) = e−η ,
                            €                                         η
                                                         P (U = 1) = e−η ,
                                                                      2
                                                                  ηe−η
                                             €      P (U = 2) =         [η + 2] ,
                                                                    8
                                                                  −η  2          
                                             € P (U = 3) = ηe η + η + 1 ,
                                                                 8 6             
                                                              −η  3
                                           €                ηe η η        2
                                                                              3η 
                                              P (U = 4 ) =        +        +       + 1.
                                                             16  24 2         2       
                                       €
            More accurate, but also more complicated, expressions are given in [3]. These expressions yield the
            following probabilities:
                                   €
                                                               π0      0.364091
                                                               π1      0.185659
                                                               π2      0.139381
                                                               π3      0.100571
                                                               π4      0.0704323
                                                               π5      0.139865



                                                                    3-12
