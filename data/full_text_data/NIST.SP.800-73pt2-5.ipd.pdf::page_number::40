      NIST SP 800-73pt2-5 ipd (Initial Public Draft)                 Interfaces for Personal Identity Verification: Part 2
      September 2023                                                    PIV Card Application Card Command Interface

870   the command, as described in Section 4.2.3. The SK RMAC session key SHALL be used to add
871   integrity to the response, as described in Section 4.2.5.
872   Secure messaging specified in this section CAN be applied to the following commands:
873       •   GET DATA
874       •   VERIFY
875       •   CHANGE REFERENCE DATA
876       •   GENERAL AUTHENTICATE

877   4.2.1. Secure Messaging Data Objects
878   The command and response messages SHALL be BER-TLV encoded according to Table 21.
879                                     Table 21. Secure messaging data objects

                   Tag                                         Description
                '87'        Padding content indicator byte followed by the encrypted data
                '8E'        Cryptographic checksum (MAC)
                '97'        Le
                '99'        Status word


880   4.2.2. Command and Response Data Confidentiality
881   Under secure messaging, the PIV data is encrypted using AES in Cipher Block Chaining (CBC)
882   mode with the SK ENC session key, where SK ENC is a 128-bit key for CS2 and a 256-bit key for
883   CS7, as per Table 18. The encryption and encoding process for command data and response data
884   SHALL be the same. The encryption of the command data or response data and encoding in
885   BER-TLV format is illustrated Fig. 1. The encryption SHALL be computed over the entire
886   message before applying fragmentation for data transportation.




                                                             30
