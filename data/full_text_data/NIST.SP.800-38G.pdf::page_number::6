NIST SP 800-38G                                              METHODS FOR FORMAT-PRESERVING ENCRYPTION




1    Purpose

This publication is the seventh part in a series of Recommendations regarding the modes of
operation of block cipher algorithms. The purpose of this part is to provide approved methods for
format-preserving encryption (FPE).

2    Introduction

A block cipher mode of operation—or simply, mode—is an algorithm for the cryptographic
transformation of data that is based on a block cipher. The previously approved modes for
encryption are transformations on binary data, i.e., the inputs and outputs of the modes are bit
strings—sequences of ones and zeros. For sequences of non-binary symbols, however, there is
no natural and general way for the previously approved modes to produce encrypted data that has
the same format.

For example, a Social Security number (SSN) consists of nine decimal numerals, so it is an
integer that is less than one billion. This integer can be converted to a bit string as input to a
previously approved mode, but when the output bit string is converted back to an integer, it may
be greater than one billion, which would be too long for an SSN.

Format-preserving encryption (FPE) is designed for data that is not necessarily binary. In
particular, given any finite set of symbols, like the decimal numerals, a method for FPE
transforms data that is formatted as a sequence of the symbols in such a way that the encrypted
form of the data has the same format, including the length, as the original data. Thus, an FPE-
encrypted SSN would be a sequence of nine decimal digits.

FPE facilitates the targeting of encryption to sensitive information, as well as the retrofitting of
encryption technology to legacy applications, where a conventional encryption mode might not
be feasible. For example, database applications may not support changes to the length or format
of data fields. FPE has emerged as a useful cryptographic tool, whose applications include
financial-information security, data sanitization1, and the transparent encryption of fields in
legacy databases.

The two FPE modes specified in this publication are abbreviated FF1 and FF3, to indicate that
they are format-preserving, Feistel-based encryption modes. FF1 was submitted to NIST under
the name FFX[Radix] in [2]. FF3 is a component of the FPE method that was submitted to NIST
under the name BPS in [3]. In particular, FF3 is essentially equivalent to the BPS-BC component
of BPS, instantiated with a 128-bit block cipher. The full BPS mode—in particular, its chaining
mechanism for longer input strings—is not approved in this publication.

A third mode, FF2—submitted to NIST under the name VAES3—was included in the initial
draft of this publication. As part of the public review of Draft NIST Special Publication (SP)
800-38G and as part of its routine consultation with other agencies, NIST was advised by the
National Security Agency in general terms that the FF2 mode in the draft did not provide the

1
 The sanitization of personally identifiable information in a database—whether by FPE or other methods—does not
necessarily provide strong assurance that individuals cannot be re-identified; for example, see [4].

                                                       1
