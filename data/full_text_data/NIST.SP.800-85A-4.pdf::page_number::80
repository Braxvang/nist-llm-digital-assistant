NIST SP 800-85A-4                                         PIV CARD APPLICATION & MIDDLEWARE
                                                                   INTERFACE TEST GUIDELINES




B.6.1.2         Get a Reference to Data Object that Requires Login
 Purpose               Ensure the PIV Middleware reads data objects from the card that
                       require a login.
 Target                pivGetData
 Reference(s)          1. SP 800-73-4 Part 3, Section 3.2.4
                       2. AS02.03, AS04.01, AS04.02A-R4, AS04.06
 Precondition(s)       1. The client application owns a connection to the PIV Card
                          Application accessible through cardHandle.
                       2. The client application has successfully selected the PIV Card
                          Application.
                       3. The client is not logged into the PIV Card Application.
 Test Steps            1. Set cardHandle := <<valid cardHandle>>
                       2. Set authenticators := <<valid authenticators byte sequence
                          for PIV Card Application PIN>>
                       3. Call pivLogIntoCardApplication with
                          • (IN) cardHandle
                          • (IN) authenticators
                          • (IN) AuthLength
                       4. Set OID := <<valid OID>> (Repeat this for all implemented
                          objects in the following set - Fingerprints, Printed
                          Information, Facial Image, Iris Images, and Pairing Code
                          Reference Data Container)
                       5. Create data reference
                       6. Call pivGetData with (each data object identified in step
                          4)
                          • (IN) cardHandle
                          • (IN) OID
                          • (IN) oidLength
                          • (OUT) data
                          • (INOUT) DataLength
                       7. Logout and reset security conditions for PIV Middleware
                          and PIV Card Application
                       8. Repeat steps 2 through 7 using the Global PIN
                       9. Repeat steps 2 through 7 using the OCC data
 Expected Result(s)    Step 6: Call returns with status_word of PIV_OK in all cases and sets
                       reference to data.
                       Step 8: Call returns with status_word of PIV_OK in all cases and sets
                       reference to data.
                       Step 9:
                           • Call returns with status_word of PIV_OK in response to the
                               requests for the Printed Information and Pairing Code
                               Reference Data Container and sets reference to data.
                           • Call returns with status_word of
                               PIV_SECURITY_CONDITIONS_NOT_SATISFIED in response to the
                               requests for the Cardholder Fingerprints, Cardholder Facial



                                       B-14
