                               Federal S/MIME V3 Client Profile


Working Group in the “Federal Public Key Infrastructure (PKI) X.509 Certificate and CRL
Extensions Profile” [CERTCRL]. Conformance to this S/MIME V3 Profile requires
conformance to [CERTCRL].

2.1.3 Cryptographic Messaging Systems (CMS) Content Types
Conforming implementations MUST be able to generate and receive the following CMS Content
Types embedded in a ContentInfo object as defined in [RFC2630]:

   •   SignedData
   •   EnvelopedData
   •   Receipt

Conforming implementations MUST be able to generate and receive the following CMS content
types as embedded content:

   •   Data

Note: The inclusion of Signed Receipts in Sections 2.2, 2.3, and 3.1 implies that implementations
MUST include the Receipt content type from [RFC2634].

In S/MIME messages, the Data content type is only used within SignedData or EnvelopedData
content types and always contains a MIME-encoded message.

Conforming implementations MUST be able to process nested S/MIME security layers such that
signed data may appear within enveloped data and enveloped data may appear within signed
data. Details of nesting of content types within MIME types are contained in [RFC2634]
Clauses 1.1 and 1.2. Nesting beyond triple wrapping as defined in [RFC2634] Clauses 1.1 and
1.2 is not required.

2.1.4 MIME Encoding
S/MIME is used to secure MIME content. Traditionally S/MIME implementations have used
Base64 MIME encoding for all information. (Base64 encoding is used to transfer binary
information through Internet (SMTP) mail because Internet mail was originally designed to
transfer ASCII information only. Therefore to ensure that binary information is passed through
the Internet without modification, it is necessary to translate the information into an ASCII
representation such as Base64.) Unfortunately Base64 encoding applied to binary information
causes an increase of message size of at least 33 percent and thus represents a waste of network
bandwidth, and possibly storage at either end.

S/MIME uses ASN.1 Basic Encoding Rules (BER) to represent data [X.208] [X.209]. There are
multiple layers of BER encoded data in S/MIME messages, each usually “wrapped” in Base64
encoding. While it is necessary to have the outermost binary (BER) representation Base64
encoded for passage through the Internet, inner binary representations need not have Base64
encoding applied, although most implementations apply Base64 even to inner binary
representations.




                                            5
