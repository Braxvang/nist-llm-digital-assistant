      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

872              Secure Messaging and Authentication Using a Secure Messaging Key (SM-
873              AUTH)
874   A PIV Card Application MAY optionally support SM. When secure messaging is established,
875   the PIV Card Application is authenticated to the relying system, and a set of symmetric session
876   keys are established. The symmetric session keys are used to provide confidentiality and
877   integrity protection for the card commands that are sent to the card using secure messaging as
878   well as for the responses from the PIV Card.
879   If implemented, SM for non-card management operations SHALL only be established using the
880   PIV Secure Messaging key specified in Table 5 and the SM protocol in accordance with the
881   specifications in Section 4 of SP 800-73-5 Part 2.
882   A PIV Card Application may optionally support authentication using the Secure Messaging key
883   (SM-AUTH). When SM-AUTH is supported, the PIV Card and therefore the cardholder is
884   authenticated to the relying system.

885              Virtual Contact Interface
886   The term “virtual contact interface (VCI)” is used in this document as shorthand for a security
887   condition. As described in access control rules in this document and in SP 800-73-5 Part 2, all
888   non-card management operations that are allowed over the contact interface MAY be carried out
889   over the contactless interface if the VCI security condition is satisfied. Support for the VCI is
890   optional.
891   The VCI security condition supports two different configurations for the establishment of the
892   VCI. In the default (and recommended) configuration, the VCI is only established after both
893   secure messaging has been established and the pairing code has been presented to the card using
894   secure messaging. In the non-default configuration, the VCI is established through secure
895   messaging without any further steps.
896   The VCI security condition is:
897           (command is submitted over secure messaging) AND (the Discovery Object is present)
898           AND (Bit 4 of the first byte of the PIN Usage Policy is one) AND ((the security status
899           indicator associated with the pairing code is TRUE) OR (Bit 3 of the first byte of the PIN
900           Usage Policy is one))
901   PIV Card Applications that support the VCI SHALL support the configuration in which Bit 3 of
902   the first byte of the PIN Usage Policy is set to zero (i.e., the configuration in which submission
903   of the pairing code to the PIV Card Application is required to establish the VCI) and MAY
904   additionally support the configuration in which Bit 3 of the first byte of the PIN Usage Policy is
905   set to one. Card management systems (CMS) SHALL be configured to set Bit 3 of the first byte
906   of the PIN Usage Policy to zero by default whenever the Discovery Object is present.
907   Requiring that the pairing code be submitted to the PIV Card Application in order to establish the
908   VCI protects the previously contact-restricted X.509 certificates from skimming 15 and also

      15
         Skimming is when data is surreptitiously obtained from a contactless card using a hidden reader that powers, commands, and reads from the
      card within the maximum read distance (reported as about 25 cm with ISO/IEC 14443 smart cards like the PIV Card).


                                                                         24
