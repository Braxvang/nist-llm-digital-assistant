                                                               GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


the packet to identify the upper-layer protocol and perhaps the process that sent the packet. Informational
messages may contain configuration information such as a local router’s address in a Router
Advertisement (RA) message.



  3.5.2   Differences between IPv6 and IPv4 ICMP

Several differences exist between the ICMP specifications for IPv4 and IPv6. These include using ND to
replace ARP, dynamic PMTU discovery, and several automated administrative functions unique to IPv6.
In particular, some of these differences are:

        Next Header Value. IPv6 identifies ICMPv6 messages with a NH value of 58. In IPv4, the
         corresponding next protocol value is 1.

        Neighbor Discovery (ND) replaces ARP. The ICMPv6 ND function serves to locate link-
         local neighbors and is similar to the function of ARP with IPv4. However, IPv4 has no means
         to detect whether a neighbor is reachable. With IPv6, ND locates link-local routers, identifies
         duplicate IPv6 addresses, and eliminates the link-local broadcast traffic generated by ARP.
         This substantially improves packet delivery in case of failed routers or link interfaces that
         changed their link-layer address, which solves the problem of outdated ARP caches.

        Increased PMTU. The minimum MTU that nodes are required to handle under IPv4 is 576
         bytes. In IPv6, all links must handle a datagram size of at least 1280 bytes, and the minimum
         recommended MTU is 1500 bytes. This is a dramatic increase in the minimum payload each
         packet must be able to carry, and it results in higher efficiency because fewer headers may
         need to be processed for a given amount of data.

        Elimination of in-transit packet fragmentation through the use of PMTU discovery. In
         IPv4, packets may be fragmented at any point: at the source or in transit by routers forwarding
         those packets. In IPv6, only the source may fragment packets. The result of this requirement
         is that the packet source must use ICMPv6 to determine the PMTU prior to sending traffic and
         perform fragmentation where needed. The destination node performs reassembly of
         fragmented packets under both IPv4 and IPv6.

        Multicast Listener Discovery (MLD). This is a set of three ICMPv6 messages equivalent to
         version 2 of the Internet Group Management Protocol (IGMP) for IPv4 used to manage subnet
         multicast membership. Instead of using IGMP, IPv6 uses ICMPv6 messages for the same
         functionality, now called MLD. MLD is the protocol that allows multicast listeners to register
         for multicast addresses they want to receive. Unlike IPv4, IPv6 does not have broadcast
         addresses. In IPv6, multicast is used with ICMPv6 for infrastructure applications like
         neighbor discovery and autoconfiguration on local links. IPv6 multicast addresses have new
         capabilities such as scope, which limits the network realm in which a multicast address is
         applicable; and embedded unicast prefixes, which limit the scope of the address to the portion
         of the network that is addressed by that prefix.

ICMPv6 specifies a framework for control messages to provide IPv6 with error handling and parameter
establishment functions. Several of ICMPv6’s functions are new or different from ICMP under IPv4.
Furthermore, ICMPv6 is a fundamental and essential component of any IPv6 implementation. For
example, no IPv6 or dual stack IPv4/IPv6 network can function properly without ICMPv6. The next
sections contain more detail about ND, Autoconfiguration, and the security ramifications of ICMPv6.


                                                   3-25
