                                                                                              NIST SP 800-77 REV. 1                                                                 GUIDE TO IPSEC VPNS


                                                                                              Public keys can be distributed to the endpoints via trusted provisioning software or can be
                                                                                              fetched on demand from DNSSEC or a directory service (e.g., Lightweight Directory Access
                                                                                              Protocol [LDAP]) based on the ID presented during the IKE exchange. Instead of specifying the
                                                                                              validity period in a certificate, these publishing services can simply remove the key when it is no
                                                                                              longer needed. The public key for a particular ID specified in IKE resides in the DNS or
                                                                                              directory service under that ID name. Revocation is accomplished by removing the public key
                                                                                              from the publishing serviceâ€™s database.

                                                                                              For resource-constrained embedded devices that authenticate using a single, hard-coded public
                                                                                              key, a certificate by itself can be too large to be contained or operated on and serves no purpose
                                                                                              since certificate validation is not performed.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              One disadvantage of raw public keys is that there are not as many tools that support these
                                                                                              because most IKE implementations have been written to be used with certificates or PSKs.

                                                                                              7.2.2.4 EAP

                                                                                              EAP support is included in IKEv2. Both older and newer EAP methods are supported. EAP can
                                                                                              be used as the only authentication method or as a second authentication method. Often, different
                                                                                              authentication methods are used: the server is authenticated using certificate-based
                                                                                              authentication, and the client (typically a laptop or mobile device) is authenticated using an EAP
                                                                                              method. EAP authentication allows additional types of authentications to be used, such as a
                                                                                              username with a password (EAP-MSCHAPv2), a user (not host) certificate (EAP-TLS), or an
                                                                                              EAP method supporting two-factor authentication. EAP authentication is mostly used for laptops
                                                                                              and mobile phones.

                                                                                              7.2.3    Cryptography for Confidentiality and Integrity Protection and for Key Exchange

                                                                                              Setting the cryptographic policy for confidentiality and integrity protection and for key exchange
                                                                                              involves choosing encryption and integrity protection algorithms, 56 key lengths, DH groups for
                                                                                              key exchange, and IKE and ESP lifetimes. For up-to-date policies and advice on these settings,
                                                                                              see NIST SP 800-131A [18] and FIPS 140 [13][14] as well as the recommendations of the IETF
                                                                                              for IKE [25] and ESP [63]. Note that these documents will be updated over time or be obsoleted
                                                                                              for newer publications.

                                                                                              The IKE protocol sends just a few packets per hour, so it makes sense to be extra cautious and
                                                                                              pick strong algorithms with large enough keys and, specifically, a strong DH group. Approved
                                                                                              DH groups are identified in NIST SP 800-56A [64]. The bulk of the CPU power of an IPsec host
                                                                                              will be spent on IPsec, not IKE. In IKE, the most CPU-intensive operation is the DH calculation.
                                                                                              When an IPsec host has hundreds or thousands of IKE (re)connections, choosing the right DH
                                                                                              group becomes very important.

                                                                                              The use of strong key sizes is recommended for IKE. The performance impact of larger key sizes
                                                                                              is minimal because IKE traffic is negligible compared to IPsec traffic. For IPsec (ESP), the key


                                                                                              56   Only FIPS-validated implementations of NIST-approved algorithms shall be used.



                                                                                                                                                          69
