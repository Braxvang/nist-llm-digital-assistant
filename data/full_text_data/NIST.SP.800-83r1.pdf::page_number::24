                                        GUIDE TO MALWARE INCIDENT PREVENTION AND HANDLING FOR DESKTOPS AND LAPTOPS


See NIST SP 800-94, Guide to Intrusion Detection and Prevention Systems (IDPS) for more information
on IPSs. 10

3.4.3     Firewalls

A network firewall is a device deployed between networks to restrict which types of traffic can pass from
one network to another. A host-based firewall is a piece of software running on a single host that can
restrict incoming and outgoing network activity for that host only. Both types of firewalls can be useful
for preventing malware incidents. Organizations should configure their firewalls with deny by default
rulesets, meaning that the firewalls deny all incoming traffic that is not expressly permitted. With such
rulesets in place, malware could not spread using services deemed unnecessary to the organization.11
Organizations should also restrict outgoing traffic to the degree feasible, with a focus on preventing the
use of prohibited services commonly used by malware.

When a major new malware threat targeting a network service is impending, organizations might need to
rely on firewalls to prevent an incident. To prepare for worst-case situations, organizations should be
ready to add or change firewall rules quickly to prevent a network service–based malware incident.
Firewall rules might also be helpful in stopping malware that relies on particular IP addresses, such as a
worm that downloads Trojan horses from one of five external hosts. Adding a rule that blocks all activity
involving the external hosts’ IP addresses could prevent the Trojan horses from reaching the organization.

More information on firewalls is available from NIST SP 800-41 Revision 1, Guidelines on Firewalls and
Firewall Policy (http://csrc.nist.gov/publications/PubsSPs.html#800-41).

3.4.4     Content Filtering/Inspection

Organizations should use content inspection and filtering technologies for stopping email-based malware
threats. Organizations should use spam filtering technologies to reduce the amount of spam that reaches
users. 12 Spam is often used for malware delivery, particularly phishing attacks, so reducing spam should
lead to a corresponding decline in spam-triggered malware incidents. Organizations should also consider
configuring their email servers and clients to block attachments with file extensions that are associated
with malicious code (e.g., .pif, .vbs), and suspicious file extension combinations (e.g., .txt.vbs, .htm.exe).
However, this might also inadvertently block legitimate activity. Some organizations alter suspicious
email attachment file extensions so that a recipient would have to save the attachment and rename it
before running it, which can be a good compromise between functionality and security.

Organizations should also use content inspection and filtering technologies for stopping web-based
malware threats. Web content filtering software has several ways of doing this; although it is typically
thought of as preventing access to materials that are inappropriate for the workplace, it may also contain
blacklist and reputation information (see below). It can also block undesired file types, such as by file
extension or by mobile code type. For particularly high security situations, organizations should consider


10
     http://csrc.nist.gov/publications/PubsSPs.html#800-94
11
     The use of some services cannot be blocked easily through firewall rulesets. For example, some peer-to-peer file sharing
     services and instant messaging services can use port numbers designated for other services, such as HTTP or Simple Mail
     Transfer Protocol (SMTP). Attempting to prevent the use of such services by blocking port numbers might cause legitimate
     services to be blocked. In such cases, it might be necessary to block access to particular IP addresses that host portions of the
     services, such as instant messaging servers. Also, as described later in this section, application proxies can identify some
     instances in which one service is used when another is expected.
12
     In addition to the standard spam filtering technologies, there are also emerging solutions that aim to reduce spam through
     email authentication. An example is the Domain-based Message Authentication, Reporting & Conformance (DMARC)
     specification (http://www.dmarc.org/).


                                                                 13
