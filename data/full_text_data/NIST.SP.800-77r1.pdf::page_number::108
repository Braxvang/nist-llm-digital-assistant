                                                                                              NIST SP 800-77 REV. 1                                                                               GUIDE TO IPSEC VPNS


                                                                                              SSH tunnel-based VPNs are resource-intensive and complex to set up. They require the
                                                                                              installation and configuration of SSH client software on each user’s machine, as well as the
                                                                                              reconfiguration of client applications to use the tunnel. Each user must also have login privileges
                                                                                              on a server within the organization. Because this server typically needs to be directly accessible
                                                                                              from the internet, it is susceptible to attack. Generally, users need to have solid technical skills so
                                                                                              that they can configure systems and applications themselves, as well as troubleshoot problems
                                                                                              that occur. The most common users of SSH tunnel-based VPNs are small groups of IT
                                                                                              administrators.

                                                                                              8.5     Obsoleted and Deprecated VPN Protocols
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              A number of commonly used VPN protocols are no longer suitable for use. Some of these were
                                                                                              designed for dial-up internet connections. Some used encryption techniques that were broken or
                                                                                              have become too weak to withstand current computational attacks. Early VPN protocols were
                                                                                              implemented on top of PPP [76]. These solutions were built as extensions to secure modem-
                                                                                              based connections and are no longer appropriate to deploy, both from architectural and
                                                                                              cryptographic points of view. The protocols listed in this section must not be used.

                                                                                              8.5.1     Point-to-Point Tunneling Protocol (PPTP)

                                                                                              The Point-to-Point Tunneling Protocol (PPTP) [77] uses Generic Routing Encapsulation (GRE,
                                                                                              IP protocol 47) as its transport protocol. The GRE tunnel is used to send PPP packets. Similar to
                                                                                              the ESP protocol, NAT routers often do not forward this protocol. PPTP uses TCP port 1723 as
                                                                                              its control plane. It uses the Microsoft Point-to-Point Encryption (MPPE) mechanism at the PPP
                                                                                              layer for encryption. MPPE uses the deprecated RSA RC4 algorithm with 40-bit or 128-bit keys
                                                                                              [78]. For authentication it can use the Password Authentication Protocol (PAP) [79] or
                                                                                              Challenge-Handshake Authentication Protocol (CHAP) [80]. Microsoft created the Microsoft
                                                                                              Challenge-Handshake Authentication Protocol version 1 (MS-CHAPv1) and version 2 (MS-
                                                                                              CHAPv2) to provide stronger forms of authentication, but researchers have found serious
                                                                                              weaknesses in MS-CHAP. 75 The original version of PPTP contained serious security flaws.
                                                                                              PPTP version 2 addressed many of these issues, but researchers have identified weaknesses with
                                                                                              this version as well (in addition to the MS-CHAP issues). 76 PPTP should not be used, and if it is
                                                                                              used regardless of its weaknesses, it should be considered a plaintext protocol with no functional
                                                                                              confidentiality or integrity protection.

                                                                                              8.5.2     Layer 2 Tunneling Protocol (L2TP)

                                                                                              The Layer 2 Tunneling Protocol (L2TP) [81] is the successor to PPTP. Instead of using the GRE
                                                                                              protocol, it encapsulates PPP packets inside UDP on port 1701. For confidentiality and integrity
                                                                                              of the data plane, it depends on IPsec. Some implementations support encryption at the PPP
                                                                                              layer, meaning that to enable IPsec support, one has to (confusingly) disable “L2TP encryption.”


                                                                                              75    Jochen Eisinger’s paper, “Exploiting Known Security Holes in Microsoft’s PPTP Authentication Extensions (MS-
                                                                                                    CHAPv2),” discusses the weakness of MS-CHAP and is located at http://www2.informatik.uni-
                                                                                                    freiburg.de/~eisinger/paper/pptp_mschapv2.pdf.
                                                                                              76    For more information on PPTP security issues, see Bruce Schneier’s “Analysis of Microsoft PPTP Version 2” page, located
                                                                                                    at https://www.schneier.com/academic/pptp/.



                                                                                                                                                            91
