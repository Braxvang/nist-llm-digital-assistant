                                                                                              NIST SP 800-77 REV. 1                                                                               GUIDE TO IPSEC VPNS


                                                                                              organizational computer resources since that internet connection could be used to attack or
                                                                                              infiltrate the VPN connection. If an organization normally has a strict firewall preventing
                                                                                              unauthorized access of the organization’s computer resources by the hosts in the local network, it
                                                                                              would not want a remote host to bypass this security when it is connecting from a remote
                                                                                              location. In that case, a remote host will send all its traffic via the VPN connection to the VPN
                                                                                              gateway; this allows IPsec protection to be applied to all of the traffic. Traffic received and
                                                                                              decrypted by the VPN gateway that is not meant for the local organization can be sent to the
                                                                                              organization’s firewall for inspection and then sent onwards through the organization’s internet
                                                                                              connection. Similarly, response traffic from the internet flows back via the organization’s
                                                                                              firewall to the VPN gateway and is then sent via the VPN connection to the remote host.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              As shown in Figure 3, the remote access VPN does not provide full protection for data
                                                                                              throughout transit. The dashed lines indicate that communications between the gateway and the
                                                                                              destination hosts (e.g., servers, laptops, desktops) on the right side of the figure are not protected.
                                                                                              The remote access VPN architecture is most often used when connecting hosts on unsecured
                                                                                              networks to resources on secured networks, such as linking traveling employees around the
                                                                                              world to headquarters over the internet. The remote access VPN is somewhat complex to
                                                                                              implement and maintain in terms of user and host management: the VPN gateway (or a
                                                                                              designated device) must manage the credentials of all of the remote devices (hosts) and their
                                                                                              authorized users, and all of these might frequently change. Remote access VPNs are typically not
                                                                                              transparent to users because they must authenticate before using the VPN. Also, the user’s
                                                                                              remote device needs to have a VPN connection configured. Some devices do not allow more
                                                                                              than one VPN connection to be active at a time.

                                                                                              Remote access users can find themselves on networks that, intentionally or not, cause VPN
                                                                                              connections to fail. Some unintentional failures can be worked around by always having the
                                                                                              latest software and IPsec VPN features supported. 12 Standard IKE runs over the UDP protocol,
                                                                                              and ESP can also use UDP. Some networks block all UDP packets, causing IKE and ESP-over-
                                                                                              UDP traffic to be dropped. As a method of last resort, IPsec communication can be tunneled over
                                                                                              TCP, which is a more universally accepted protocol. For added insurance, TLS can be used in
                                                                                              conjunction with TCP to work around network failures with native IPsec packets.

                                                                                              Modern devices often have more than one network interface, and the user can switch between
                                                                                              network interfaces automatically. For instance, when a mobile device loses a WiFi connection, it
                                                                                              can automatically fall back to a mobile network (Long-Term Evolution [LTE]/5th Generation
                                                                                              [5G]) provider. IPsec provides mobility support to ensure that the VPN connection continues
                                                                                              working without interruption when switching between such networks.




                                                                                              12   A common unintentional breaking of IPsec occurs when a network does not handle IP fragmentation correctly. This can
                                                                                                   cause the setup of the IPsec connection to fail. Modern implementations of IPsec support their own IKE fragmentation,
                                                                                                   which ensures that the network layer never needs to fragment IKE packets.



                                                                                                                                                            14
