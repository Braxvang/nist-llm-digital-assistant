Special Publication 800-85B                                   PIV Data Model Testing Specification


Precondition          1.      A valid PIV card is inserted into the contact reader.
                      2.      A valid PC/SC connection exists between the test application and the
                              contact reader.
                      3.      The test application is currently connected to the card application
                              which is accessible through card handle.
                      4.      A valid card holder facial image is present on the PIV card.
Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<Card Holder Facial Image
                         (2.16.840.1.101.3.7.2.96.48)>>
                      3. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      4. Extract the SignerInfos field contents from the
                         CBEFF_SIGNATURE_BLOCK
Expected              The signerInfos field in the SignedData contains a single SignerInfo.
Result(s)


10.3.1.7 Verify Signer Identifier in SignerInfo

Purpose               Confirms that the sid in the SignerInfo uses the issuerAndSerialNumber
                      choice.
Reference(s)          1.      FIPS201, Section 4.4.2
                      2.      AS06.03.10
Precondition          1.      A valid PIV card is inserted into the contact reader.
                      2.      A valid PC/SC connection exists between the test application and the
                              contact reader.
                      3.      The test application is currently connected to the card application
                              which is accessible through card handle.
                      4.      A valid card holder facial image is present on the PIV card.
Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<Card Holder Facial Image
                         (2.16.840.1.101.3.7.2.96.48)>>
                      3. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      4. Extract the signerInfo->sid field contents from the
                         CBEFF_SIGNATURE_BLOCK
                      5. Extract the certificates field contents from the
                         CBEFF_SIGNATURE_BLOCK (if present)
                      6. If a certificate extracted from the certificates field
                         of the CBEFF_SIGNATURE_BLOCK does not exist, then
                         extract the certificates field contents from the
                         asymmetric signature of the CHUID
                      7. Extract the issuer and serialNumber fields from the
                         certificate obtained in the previous step



                                                                                                     Page 98
