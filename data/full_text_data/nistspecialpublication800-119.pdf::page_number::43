                                                                         GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


Extension headers provide important services and functions for the IPv6 protocol. They may direct
intermediary nodes about how packet payloads are to be handled prior to reaching their ultimate
destination. Defined extension headers for the IPv6 protocol should occur in a recommended order. RFC
2460, Internet Protocol, version 6 (IPv6) Specification, indicates that future extension header
specifications may be more precise when it comes to ordering. To accommodate the definition and
deployment of additional extension headers, each extension header includes information that instructs the
receiver how to behave if it does not recognize a new extension header type. The two basic types of
behavior are: skip the unrecognized extension header but continue processing the packet or discard the
packet.

The following table illustrates the recommended order for extension headers. Only the Hop-by-Hop
Options are required by the specification to be placed immediately after the IPv6 header (literally the
IPv6 ―next header‖). Note that more than one extension header may be used in a packet. In those cases,
RFC 2460 recommends the first four extension headers be prioritized according to the first four entries in
the table below.

                                                                                                19
                           Table 3-4. IPv6 Extension Headers and Upper Layer Protocols

            Extension Header                Type                                 Remarks
     Hop-by-hop Options                    0         used for options that apply to intermediate routers
     Routing                               43        used for source routing
     Fragment                              44        processed only by the final recipient
     Destination Options                   60        used for options that apply only for the final recipient
     Authentication header (AH)            51        used for IPsec integrity protection
     Encapsulating Security Payload        50        used for IPsec integrity and confidentiality protection
     (ESP)
     Mobility                              135       used for managing mobile IPv6 bindings
                 Protocol                   Type                                 Remarks
     TCP                                   6         protocol type for Transmission Control Protocol
     UDP                                   17        protocol type for User Datagram Protocol
     IPv6-in-IPv6                          41        protocol type for IPv6 in IPv6 tunnels
     GRE                                   47        protocol type for Generic Routing Encapsulation tunnels
     ICMPv6                                58        protocol type, Internet Control Message Protocol for IPv6
     No next header                        59        dummy packet, often used with ESP
     OSPF                                  89        protocol type, Open Shortest Path First version 3 routing
                                                     protocol
     PIM                                   103       protocol type, Protocol Independent Multicast routing
     SCTP                                  132       protocol type, Stream Control Transmission Protocol


A NH value of 43 causes the node specified in the Destination Address to examine the Routing Header
for further routing instructions. A Routing Header initially contains (1) an ordered list of intermediate
Destination Addresses that the packet traverses on its way to its final destination at the end of the list and
(2) a pointer to the first one of these. Each time the Destination Address in the IPv6 header is reached,
the next Destination Address from the Routing Header is swapped with the Destination Address in the
IPv6 header, and the pointer in the Routing Header is advanced until the final destination is reached.

19
     A full list of Extension Headers and Upper Layer Protocols can be found at IANA, Protocol Numbers.


                                                           3-21
