GUIDE TO INTEGRATING FORENSIC TECHNIQUES INTO INCIDENT RESPONSE



        network activity. At a minimum, the data should indicate which server was attacked and on what
        port number, which indicates which network service was targeted. Identifying the service is very
        important to finding the exploited vulnerability and developing a mitigation strategy to prevent
        similar incidents from occurring on other systems. From an analysis standpoint, knowing the
        targeted service and port number is also important because the information can be used to identify
        other likely data sources and to query them for relevant information. Some network IDS
        deployments may record additional useful information, such as application data (e.g., Web
        requests and responses, e-mail headers and file attachment names). The application data may
        contain words, phrases, or other character sequences that are associated with a particular worm.
    ! Network-Based Firewall. Firewalls are typically configured to log blocked connection attempts,
      including the intended destination IP address and port. Accordingly, firewalls might have records
      of worm activity that they blocked. Some worms attempt to exploit multiple services or service
      ports; firewall records might show that a worm has actually tried to establish connections to at
      least four different port numbers, but that the firewall blocked connections using three of the
      ports. This information could be useful in identifying the worm. If firewalls are configured to
      record permitted connections, their logs may show which hosts within the organization have
      received worm traffic or been infected and generated their own worm traffic. This is particularly
      useful for situations in which network IDS sensors do not monitor all traffic that reaches the
      firewall. Other perimeter devices that the worm traffic may have passed through, such as routers,
      VPN gateways, and remote access servers, may record information similar to that logged by
      network-based firewalls.
    ! Host IDS and Firewall. IDS and firewall products running on the infected system may contain
      more detailed information than network IDS and firewall products. For example, a host IDS can
      identify changes to files or configuration settings on the host that were performed by a worm.
      This information is helpful not only in planning containment, eradication, and recovery activities
      by determining how the worm has affected the host, but also in identifying which worm infected
      the system. However, because many worms disable host-based security controls and destroy log
      entries, data from host IDS and firewall software may be limited or missing. If the software was
      configured to forward copies of its logs to centralized log servers, then queries to those servers
      may provide some information.
    ! Antivirus Software. Because the threat reached the server and successfully breached it, it is
      unlikely that network or host-based antivirus software contains any record of the threat. If
      antivirus software had detected the worm, it should have stopped it. However, it is possible that
      the antivirus software saw the worm but somehow failed to stop it, or that the antivirus software
      was updated since the infection with new signatures that can recognize the worm. The incident
      handler can also scan the server for worms using a current version of antivirus software from a
      forensic toolkit.
    ! Application Logs. If the worm used a common application protocol, such as HTTP or SMTP,
      information regarding it might be recorded in several places, such as application server logs,
      proxy servers, and application-specific security controls. Less common application protocols
      probably have information only in the application server logs. Application logs record extensive
      details on the application-specific characteristics of the activity, and are particularly helpful at
      identifying attack characteristics from less common applications.
The goal in the initial information gathering effort is to identify enough characteristics for positive
identification of the worm. This can be challenging, particularly for worms that have dozens of variants;
these variants often have similar characteristics but have different effects on systems. Analysts can
perform queries on antivirus vendorsâ€™ malware databases, searching for identified characteristics such as



                                                    8-2
