NIST SP 800-166                                       DERIVED PIV APPLICATION AND
                                                      DATA MODEL TEST GUIDELINES

                  NOTE: The following tests are to be performed only if the
                  Derived PIV Application supports the use of the '9B' key
                  (Derived PIV Token Management Key)

                  5. Perform mutual authentication of Derived PIV
                     Application and the Test Toolkit Application using Test
                     Assertion TA-08.03.03.03 (GENERAL AUTHENTICATE)
                  6. Repeat Steps 2, 3, and 4.
                  7. Repeat Step 2 with the cryptographic mechanism
                     identifier value in the data field set to a value that
                     is not supported by the Derived PIV Application.
                  8. Repeat Step 2 with P2 set to a key reference value that
                     is not supported by the Derived PIV Application.
                  9. Send the VERIFY command with
                         • P2, key reference value, is set to '80'
                         • Data field of the command will contain the
                            correct Derived PIV Application Password, padded
                            with 'FF' (if necessary) to complete the total
                            length of the value to 8 bytes
                  10. Send the GENERAL AUTHENTICATE command
                         • CLA is set to:
                             1. '00' if command chaining is not needed or
                             2. '10' if command chaining is used. (The last
                                chain of the command sets CLA to '00')
                         • P1, algorithm reference, is set to '07' or '11'
                         • P2, key reference, is set to '9A'
                         • Data field in the command is to include '81'
                            specifying a challenge, followed by a randomly
                            generated challenge, and '82 00' in order to
                            request a response
                  11. If the X.509 Certificate for Digital Signature is
                      supported, send the GENERAL AUTHENTICATE command
                         • CLA is set to:
                             1. '00' if command chaining is not needed or
                             2. '10' if command chaining is used. (The last
                                chain of the command sets CLA to '00')
                         • P1, algorithm reference, is set to '07', '11' or
                            '14'
                         • P2, key reference, is set to '9C'
                         • Data field in the command is to include '81'
                            specifying a challenge, followed by a randomly
                            generated challenge, and '82 00' in order to
                            request a response
                  12. If the X.509 Certificate for Key Management and the
                      on-token generation of the key management key is
                      supported, send the GENERAL AUTHENTICATE command
                         • CLA is set to:
                             1. '00' if command chaining is not needed or
                             2. '10' if command chaining is used. (The last
                                chain of the command sets CLA to '00')
                         • P1, algorithm reference, is set to '07', '11' or
                            '14'
                         • P2, key reference, is set to '9D' indicating the
                            key management key



                                    85
