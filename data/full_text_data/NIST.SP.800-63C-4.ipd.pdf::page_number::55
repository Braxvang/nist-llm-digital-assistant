       NIST SP 800-63C-4 ipd                                             Digital Identity Guidelines
       December 2022                                                     Federation and Assertions


1439   6.2.1. Assertion Identiﬁer
1440   Assertions SHALL be sufficiently unique to permit unique identification by the target
1441   RP. Assertions MAY accomplish this by use of an embedded nonce, issuance timestamp,
1442   assertion identifier, or a combination of these or other techniques.

1443   6.2.2. Signed Assertion
1444   Assertions SHALL be cryptographically signed by the issuer (IdP). The RP SHALL
1445   validate the digital signature or MAC of each such assertion based on the issuer’s key.
1446   This signature SHALL cover the entire assertion, including its identifier, issuer, audience,
1447   subject, and expiration.
1448   The assertion signature SHALL either be a digital signature using asymmetric keys or a
1449   MAC using a symmetric key shared between the RP and issuer. Shared symmetric keys
1450   used for this purpose by the IdP SHALL be independent for each RP to which they send
1451   assertions, and are normally established during registration of the RP. Public keys for
1452   verifying digital signatures SHALL be transferred to the RP in a secure manner, and
1453    MAY be fetched by the RP in a secure fashion at runtime, such as through an HTTPS
1454   URL hosted by the IdP. Approved cryptography SHALL be used.

1455   6.2.3. Encrypted Assertion
1456   Encrypted assertions protect the contents of the assertion from being read by unintended
1457   parties, ensuring that only the targeted RP is able to read the assertion. Encrypting
1458   assertions provides two primary benefits: the assertion contents cannot be seen by any
1459   party other than the intended RP, and the assertion cannot be used by any RP other than
1460   the targeted one.
1461   When encrypting assertions, the IdP SHALL encrypt the contents of the assertion using
1462   either the RP’s public key or a shared symmetric key. Shared symmetric keys used
1463   for this purpose by the IdP SHALL be independent for each RP to which they send
1464   assertions, and are normally established during registration of the RP. Public keys for
1465   encryption SHALL be securely transferred to the IdP and MAY be fetched by the IdP in
1466   a secure fashion at runtime, such as through an HTTPS URL hosted by the RP.
1467   All encryption of assertions SHALL use approved cryptography.
1468   When personally-identifiable information is included in the assertion and the assertion
1469   is handled by intermediaries such as a browser, the federation protocol SHALL encrypt
1470   assertions to protect the sensitive information in the assertion from leaking to unintended
1471   parties. For example, a SAML assertion can be encrypted using XML-Encryption, or an
1472   OpenID Connect ID Token can be encrypted using JSON Web Encryption (JWE).




                                                   43
