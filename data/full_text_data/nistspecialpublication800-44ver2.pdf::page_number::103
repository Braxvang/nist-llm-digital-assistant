                                                                             GUIDELINES ON SECURING PUBLIC WEB SERVERS



 Amount of traffic the server receives

 General threat level (certain sites receive many more attacks than other sites and thus should have
  their logs reviewed more frequently)

 Specific threats (at certain times, specific threats arise that may require more frequent log file
  analysis)

 Vulnerability of the Web server

 Value of data and services provided by the Web server.

Reviews should take place regularly (e.g., daily) and when a suspicious activity has been noted or a threat
warning has been issued. Obviously, the task could quickly become burdensome to a Web server
administrator. To reduce this burden, automated log analysis tools have been developed (see Section
9.1.5).

In addition, a long-term and more in-depth analysis of the logs is needed. Because a typical Web server
attack can involve hundreds of unique requests, an attacker may attempt to disguise a Web server attack
by increasing the interval between requests. In this case, reviewing a single day’s or week’s logs may not
show recognizable trends. However, when trends are analyzed over a week, month, or quarter, multiple
attacks from the same host or subnet can be more easily recognized.

Log files should be protected to ensure that if an attacker does compromise a Web server, the log files
cannot be altered to cover the attack. Although encryption can be useful in protecting log files, the best
solution is to store log files on a host separate from the Web server. This is often called a centralized
logging server. Centralized logging is often performed using syslog, which is a standard logging
protocol. 74 Alternately, some organizations use security information and event management (SIEM)
software that uses centralized servers to perform log analysis, database servers to store logs, and either
agents installed on the individual hosts or processes running on the centralized servers to transfer Web
server logs or log data from the hosts to the servers and parse the logs. 75

Log files should be backed up and archived regularly. Archiving log files for a period of time is
important for several reasons, including supporting certain legal actions and troubleshooting problems
with the Web server. The retention period for archived log files depends on a number of factors,
including the following:

 Legal requirements

 Organizational requirements

 Size of logs (which is directly related to the traffic of the site and the number of details logged)

 Value of Web server data and services

 Threat level.



74
     Syslog is defined in IETF RFC 3164, The BSD Syslog Protocol, which is available at http://www.ietf.org/rfc/rfc3164.txt.
75
     More information on syslog and SIEM implementations is provided in NIST SP 800-92, Guide to Computer Security Log
     Management, which is available at http://csrc.nist.gov/publications/nistpubs/.


                                                             9-4
