NIST SP 800-85A-4                                           PIV CARD APPLICATION & MIDDLEWARE
                                                                     INTERFACE TEST GUIDELINES

B.1.1.2          Initiate Shared Connection
 Purpose                  Confirm that a shared connection can be established by two distinct
                          client applications to the PIV Card with a specific ICC.
 Target                 pivConnect
 Reference(s)           1. SP 800-73-4 Part 3, Section 3.1.2
                        2. AS04.01, AS04.02, AS04.02A-R4
 Precondition(s)        1. A valid connection description is provided for the card reader.
                        2. There exists a valid physical connection between an instance of
                           the PIV Card and a client application.
                        3. Another client application is currently connected via a shared
                           connection to the PIV Card Application.
 Test Steps             1. Set sharedConnection := true
                        2. Set connectionDescription := <<valid connection>>
                        3. Create cardHandle reference
                        4. Call pivConnect with
                           • (IN) sharedConnection
                           • (INOUT) connectionDescription
                           • (INOUT) CDLength
                           • (OUT) cardHandle
 Expected Result(s)     Call returns with status_word of PIV_OK and initialized cardHandle.
 Postcondition(s)       Both client applications are connected through the same connection
                        to the PIV Card Application.

B.1.2           Test Assertions for Error Conditions

B.1.2.1          Malformed Connection Description
 Purpose               Confirm that the correct status word is returned when a malformed
                       connection description is used.
 Target                 pivConnect
 Reference(s)           1.   SP 800-73-4 Part 3, Section 3.1.2
                        2.   AS04.01, AS04.02, AS04.02A-R4
 Precondition(s)        1.   An invalid connection description is provided for the card reader.
                        2.   There exists a valid physical connection between an instance of
                             the PIV Card and the client application.
 Test Steps             1. Set sharedConnection := true | false
                        2. Set connectionDescription := <<invalid connection>>
                        3. Create cardHandle reference
                        4. Call pivConnect with
                           • (IN) sharedConnection
                           • (INOUT) connectionDescription
                           • (INOUT) CDLength
                           • (OUT) cardHandle
 Expected Result(s)     Call returns with status_word of
                        PIV_CONNECTION_DESCRIPTION_MALFORMED.
 Postcondition(s)       1. The cardHandle variable is not initialized.



                                          B-2
