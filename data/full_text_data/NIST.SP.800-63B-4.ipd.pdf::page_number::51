       NIST SP 800-63B-4 ipd                                                Digital Identity Guidelines
       December 2022                                         Authentication and Lifecycle Management


1498   limiting MAY be implemented by the verifier. In all other cases, rate limiting SHALL
1499   be implemented in the authenticator. Once the limit of 10 attempts is reached, the
1500   authenticator SHALL be disabled and a different authenticator SHALL be required for
1501   authentication.
1502   If the authenticator verifies the activation secret locally (rather than using it for decryption
1503   of a key), verification SHALL be performed within a hardware-based authenticator or
1504   in a secure element (e.g., TEE, TPM) that releases the authentication secret only upon
1505   presentation of the correct activation secret. In other circumstances (i.e., software-based
1506   multi-factor authenticators), the authenticator SHALL use the memorized secret as a key
1507   to decrypt its stored authentication secret. Approved cryptography SHALL be used.

1508   5.2.12. Connected Authenticators
1509   Cryptographic authenticators require a direct connection between the authenticator and
1510   the endpoint being authenticated. This connection MAY be wired (e.g., USB or direct
1511   connection with a smartcard) or wireless (e.g., NFC, Bluetooth). While in most cases
1512   wired connections can be presumed to be secure from eavesdropping and adversary-
1513   in-the-middle attacks, additional precautions are required for authenticators that are
1514   connected via wireless technologies.
1515   Wired authenticator connections include both authenticators that are embedded in
1516   endpoints (e.g., in a TPM) and those that are connected via an external interface, such as
1517   USB. Claimants SHOULD be advised to use trusted hardware (cables, etc.) for external
1518   connections for additional assurance that they have not been compromised.
1519   Wireless authenticator connections are potentially vulnerable to threats including
1520   eavesdropping, injection, and relay attacks. The potential for such attacks depends on
1521   the effective range of the wireless technology being used.
1522   Wireless technologies having an effective range of 1 meter or more (e.g., Bluetooth
1523   LE) SHALL use an authenticated encrypted connection between the authenticator
1524   and endpoint. A pairing process SHALL be used to establish a key for encrypted
1525   communication between the authenticator and endpoint. A temporary wired connection
1526   between the devices MAY also be used to establish the key in lieu of the pairing process.
1527   The pairing process SHALL be authenticated through the use of a pairing code. The
1528   pairing code SHALL be associated with either the authenticator or endpoint and SHALL
1529   have at least 20 bits or 6 decimal digits of entropy. The pairing code MAY be printed on
1530   the associated device and SHALL be conveyed between the devices by manual entry or
1531   by using a QR code or similar representation that is optically communicated. An example
1532   of this is the pairing code used with the virtual contact interface specified in [SP800-73].
1533   The entire authentication transaction SHALL be encrypted using a key established by the
1534   pairing process.
1535   When a wireless technology with an effective range of less than 1 meter is in use (e.g.,
1536   NFC), the activation secret, if any, transmitted from the endpoint to authenticator SHALL

                                                     39
