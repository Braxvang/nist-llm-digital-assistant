                                                                                               NIST SP 800-177 REV. 1                                                            TRUSTWORTHY EMAIL




                                                                                               should be delivered, ﬂagged, or discarded. Both SPF and DKIM oﬀer implementation ﬂexibility
                                                                                               and diﬀerent settings can have diﬀerent eﬀects at the receiver. However, neither SPF nor DKIM
                                                                                               include a mechanism to tell receivers if SPF or DKIM are in active use, nor do they have
                                                                                               feedback mechanism to inform sending domain owners of the eﬀectiveness of their
                                                                                               authentication techniques. For example, if a message arrives at a receiver without a DKIM
                                                                                               signature, DKIM provides no mechanism to allow the receiver to learn if the message is
                                                                                               authentic but was sent from a sender that did not implement DKIM, or if the message is a spoof.

                                                                                               DMARC [RFC7489] allows email sending domain owners to specify policy on how receivers
                                                                                               can verify the authenticity of their email, how the receiver can handle email that fails to verify,
                                                                                               and the frequency and types of report that receivers should send back. DMARC beneﬁts
                                                                                               receivers by removing the guesswork about which security protocols are in use, allowing more
                                                                                               certainty in quarantining and rejecting inauthentic mail.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-177r1




                                                                                               To further improve authentication, DMARC adds a link between the domain of the sender with
                                                                                               the authentication results for SPF and DKIM. In particular, receivers compare the domain in the
                                                                                               message-From: address in the message to the SPF and DKIM results (if deployed) and the
                                                                                               DMARC policy in the DNS. �e results of this data gathering are used to determine how the mail
                                                                                               should be handled. �us, when an email fails SPF and DKIM veriﬁcation, or the message-From:
                                                                                               domain-part doesn’t match the authentication results, the email can be treated as inauthentic
                                                                                               according to the sending domain owners DMARC policy.

                                                                                               DMARC also provides a mechanism that allows receivers to send reports to the domain owner
                                                                                               about mail claiming to originate from their domain. �ese reports can be used to illuminate the
                                                                                               extent to which unauthorized users are using the domain, and the proportion of mail received that
                                                                                               is from the purported sender.

                                                                                               4.6.1    DMARC on the Sender Side

                                                                                               DMARC policies work in conjunction with SPF and/or DKIM, so a mail domain owner
                                                                                               intending to deploy DMARC must deploy SPF or DKIM or (preferably) both. To deploy
                                                                                               DMARC, the sending domain owner will publish SPF and/or DKIM RRs in the DNS and
                                                                                               calculate a signature for the DKIM header of every outgoing message. �e domain owner also
                                                                                               publishes a DMARC policy in the DNS advising receivers on how to treat messages purporting
                                                                                               to originate from the sender’s domain. �e domain owner does this by publishing its DMARC
                                                                                               policy as a TXT record in the DNS 12; identiﬁed by creating a _dmarc DNS record and
                                                                                               publishing it in the sending domain name. For example, the DMARC policy for “example.gov”
                                                                                               would reside at the fully qualiﬁed domain name _dmarc.example.gov.

                                                                                               When implementing email authentication for a domain for the ﬁrst time, a sending domain owner
                                                                                               is advised to ﬁrst publish a DMARC RR with a “none” policy before deploying SPF or DKIM.
                                                                                               �is allows the sending domain owner to immediately receive reports indicating the volume of



                                                                                               12 Example tool: https://dmarcguide.globalcyberalliance.org/




                                                                                                                                                              43
