                                                                                               NIST SP 800-56A Rev. 3                               Recommendation for Pair-Wise Key Establishment
                                                                                                                                                            Using Discrete Logarithm Cryptography

                                                                                               6.3.3.3 C(0e, 2s) Scheme with Bilateral Key Confirmation
                                                                                               Figure_17 depicts a typical flow for a C(0e, 2s) scheme with bilateral key confirmation. In
                                                                                               this method, party U and party V assume the roles of both the provider and the recipient in
                                                                                               order to obtain bilateral key confirmation. A nonce (NonceV) shall be provided by party V to
                                                                                               party U and used (in addition to the shared secret Z and the nonce, NonceU, provided by party
                                                                                               U) as input to the key-derivation method employed by the scheme. NonceV is also used as
                                                                                               the EphemDataV during MacTag computations. The successful completion of the key-
                                                                                               confirmation process provides each party with assurance that the other party has derived the
                                                                                               same secret Z value. If NonceU is a random nonce, then party U obtains assurance that party
                                                                                               V has actively participated in the process; if NonceV is a random nonce, then party V obtains
                                                                                               assurance that party U has actively participated in the process. See Section 5.4 for a
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                               discussion about the length and security strength required for the nonce.


                                                                                                                 U                                            V
                                                                                                                            U’s Static Public Key
                                                                                                                                                                    Obtain static public
                                                                                                                            V’s Static Public Key                   keys


                                                                                                                                  NonceU
                                                                                                                                                                    U sends a nonce

                                                                                                                              NonceV, MacTagV
                                                                                                                                                                    V sends a nonce with
                                                                                                                                                                    key-confirmation
                                                                                                                                  MacTagU
                                                                                                                                                                    U’s key-confirmation




                                                                                                              Figure 17: C(0e, 2s) scheme with bilateral key confirmation

                                                                                               To provide bilateral key confirmation (as described in Section 5.9.2), party U and party V
                                                                                               exchange and verify MacTags that have been computed (as specified in Section 5.2.1) using
                                                                                                                   EphemDataU = NonceU, and EphemDataV = NonceV.
                                                                                               Party V provides MacTagV to party U (as specified in Sections 5.9.1 and 5.9.2, with P = V
                                                                                               and R = U); MacTagV is computed by party V (and verified by party U) using
                                                                                                            MacDataV = “KC_2_V” || IDV || IDU || NonceV || NonceU {|| TextV}.
                                                                                               Party U provides MacTagU to party V (as specified in Sections 5.9.1 and 5.9.2, with P = U
                                                                                               and R = V); MacTagU is computed by party U (and verified by party V) using
                                                                                                            MacDataU = “KC_2_U” || IDU || IDV || NonceU || NonceV {|| TextU}.

                                                                                                                                            110
