NIST SP 800-166                                                  DERIVED PIV APPLICATION AND
                                                                 DATA MODEL TEST GUIDELINES

                         83' (reference data change operation blocked) when the maximum
                         number of tries is exceeded.
                     5. From Step 5, the command returns status word '69 83' (reference
                         data change operation blocked).
 Postcondition(s)    The Derived PIV Application Password’s retry counter and the PUK’s
                     retry counter are 0.

8.3.6 RESET RETRY COUNTER Command

8.3.6.1 Reset Retry Counter for the Derived PIV Application Password

 Test Assertion      TA-08.03.06.01
 Purpose             Verifies that the Derived PIV Application changes the password with
                     the RESET RETRY COUNTER command when the PUK and
                     command format are correct.
 DTR(s)              • DTR-06.02.02.09
                     • DTR-06.03.01.01
                     • DTR-06.03.07.01
                     • DTR-06.03.07.08
 Vendor              None.
 Documentation
 Precondition(s)     •   A token with the Derived PIV Application is inserted into an
                         appropriate token reader.
                     •   Suitable drivers have been loaded between the test system and an
                         instance of the reader.
                     •   The PUK is recorded.
                     •   The reset retry value for the Derived PIV Application Password is
                         recorded.
                     •   The Derived PIV Application Password’s retry counter and the
                         PUK’s retry counter are not 0.
 Test Scenario       1. Send the SELECT command with
                           • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                     2. Send the VERIFY command with
                           • P2, key reference value, is set to '80'
                           • Data field of the command contains an arbitrary,
                              but correctly formatted password other than what
                              is obtained from the vendor, padded with 'FF' (as
                              necessary) to complete the total length of the
                              value to 8 bytes
                     3. Send the RESET RETRY COUNTER command with
                           • P2, key reference value, is set to '80'
                           • Data field of the command contains the PUK value
                              for key reference '80' concatenated without
                              delimitation with a new password padded with 'FF'
                              (if necessary) to complete the total length of
                              the value to 8 bytes.



                                           74
