                                                                                               NIST SP 800-56A Rev. 3                            Recommendation for Pair-Wise Key Establishment
                                                                                                                                                         Using Discrete Logarithm Cryptography

                                                                                                              For FFC schemes, i’s ephemeral public key, ti, is converted from a field
                                                                                                              element in GF(p) to a byte string by representing the field element as an
                                                                                                              integer in the interval [2, p − 2], and then converting the integer to a byte
                                                                                                              string as specified in Appendix C.1.
                                                                                                              For ECC schemes, the coordinates of i’s ephemeral public key, Qe,i, are
                                                                                                              converted from field elements to byte strings as specified in Appendix C.2
                                                                                                              and concatenated (with the x coordinate first) to form a single byte string.
                                                                                                      - TextP is an optional byte string that may be used during key confirmation and
                                                                                                        that is known by both parties.
                                                                                                      The content of each of the components that are concatenated to form MacDataP shall
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                                      be precisely defined and unambiguously represented. A component’s content may be
                                                                                                      represented, for example, as a fixed-length bit string or in the form Datalen || Data,
                                                                                                      where Data is a variable-length string of zero or more (eight-bit) bytes, and Datalen
                                                                                                      is a fixed-length, big-endian counter that indicates the length (in bytes) of Data.
                                                                                                      These requirements could also be satisfied by using a specific ASN.1 DER encoding
                                                                                                      of each component. It is imperative that the provider and recipient have agreed upon
                                                                                                      the content and format that will be used for each component of MacDataP.
                                                                                                  3. After computing the shared secret Z and applying the key-derivation method to obtain
                                                                                                     DerivedKeyingMaterial (see Section 5.8 and SP 800-56C), the provider uses agreed-
                                                                                                     upon bit lengths to parse DerivedKeyingMaterial into two parts, MacKey and
                                                                                                     KeyData, of the pre-agreed lengths:
                                                                                                        MacKey || KeyData = DerivedKeyingMaterial.
                                                                                                  4. Using an agreed-upon bit length for MacTagBits, the provider computes MacTagP
                                                                                                     (see Sections 5.2.1 and 5.9.3):
                                                                                                        MacTagP = TMacTagBits[MAC (MacKey, MacDataP)],
                                                                                                      and sends it to the recipient.
                                                                                                  5. The recipient forms MacDataP, determines MacKey, computes MacTagP in the same
                                                                                                     manner as the provider, and then verifies that the computed MacTagP is equal to the
                                                                                                     value received from the provider. If the values are equal, then the recipient is assured
                                                                                                     that the provider has derived the same value for MacKey and that the provider shares
                                                                                                     the recipient’s value of MacDataP. The assurance of a shared value for MacKey
                                                                                                     provides assurance to the recipient that the provider also shares the secret value (Z)
                                                                                                     from which MacKey and KeyData are derived. Thus, the recipient also has assurance
                                                                                                     that the provider could compute KeyData correctly.
                                                                                               Both parties shall destroy the MacKey once it is no longer needed to provide or obtain key
                                                                                               confirmation.
                                                                                               If, during a key-agreement transaction, it happens that MacTagP cannot be verified by the
                                                                                               recipient, then key confirmation has failed, and all of the derived keying material (MacKey
                                                                                               and KeyData) shall be destroyed by each participant. In particular, DerivedKeyingMaterial
                                                                                               shall not be revealed by either participant to any other party (not even to the other


                                                                                                                                            60
