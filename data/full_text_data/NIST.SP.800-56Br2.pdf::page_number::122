                                                                                               NIST SP 800-56B REV. 2                            RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                      USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                                           f. If x = 1, go to Step 5.
                                                                                                           g. Continue.
                                                                                                   4. Output “prime factors not found,” and exit without further processing.
                                                                                                   5. Let p = GCD(y – 1, n) and let q = n/p.
                                                                                                   6. Output (p, q) as the prime factors.
                                                                                               Any local copies of d, p, q , m, t, r, x, y, g and any intermediate values used during the execution
                                                                                               of the RecoverPrimeFactors function shall be destroyed prior to or during steps 4 and 6. Note that
                                                                                               this includes the values for p and q that are output in step 6.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                               Notes:

                                                                                                  1. According to Fact 1 in [Boneh 1999], the probability that one of the values of y in an
                                                                                                     iteration of Step 3 reveals the factors of the modulus is at least 1/2, so on average, no more
                                                                                                     than two iterations of that step will be required. If the prime factors are not revealed after
                                                                                                     100 iterations, then the probability is overwhelming that the modulus is not the product of
                                                                                                     two prime factors, or that the public and private exponents are not consistent with each
                                                                                                     other.
                                                                                                  2. The algorithm bears some resemblance to the Miller-Rabin primality-testing algorithm
                                                                                                     (see, e.g., FIPS 186).
                                                                                                  3. The order of the recovered prime factors p and q may be the reverse of the order in which
                                                                                                     the factors were generated originally.
                                                                                                  4. All local copies of d, p, q, and and any other local/intermediate values used during the
                                                                                                     execution of the RecoverPrimeFactors function shall be destroyed prior to the early
                                                                                                     termination of the process due to an error, or (in the absence of errors), prior to or during
                                                                                                     the the completion of step 6.

                                                                                               C.2 Deterministic Prime-Factor Recovery
                                                                                               The following (deterministic) algorithm also recovers the prime factors of a modulus, given the
                                                                                               public and private exponents. A proof of correctness is provided below.
                                                                                               Function call: RecoverPrimeFactors(n, e, d)
                                                                                               Input:
                                                                                                  1. n: modulus.
                                                                                                  2. e: public exponent.
                                                                                                  3. d: private exponent.

                                                                                               Output:
                                                                                                 (p, q): prime factors of modulus, with p > q.

                                                                                               Assumptions:

                                                                                                                                               112
