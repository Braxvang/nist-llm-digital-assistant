                                                                                              NIST SP 800-77 REV. 1                                                            GUIDE TO IPSEC VPNS


                                                                                              9.4.2   Designing the Solution
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                                                              Figure 20: Mesh Encryption Using IPsec

                                                                                              Connection Establishment. A packet-triggered, IPsec-based solution is chosen. Since IPsec can
                                                                                              easily be added to physical servers, virtual servers, and container-based instances, the solution
                                                                                              should work across most of the global infrastructure.

                                                                                              Authentication. Since certificates are already used to identify many services, the IPsec nodes
                                                                                              will be authenticated using machine certificates signed by a private CA. At a later date,
                                                                                              DNSSEC-based authentication using public keys will be evaluated, which will reduce the
                                                                                              overhead of running a CA and remove the need for certificate renewal. A Federal agency shall
                                                                                              use its authorized PKI to issue certificates for the IPsec peers, and these certificates shall be used
                                                                                              for authentication.

                                                                                              Confidentiality and Integrity. Since it is expected that some nodes will have hundreds of IPsec
                                                                                              connections, it is important to pick the most optimum cryptography: AES-GCM with 128-bit
                                                                                              keys for IKE and IPsec and DH group 19 to provide 128 bits of security strength for the key
                                                                                              exchange.

                                                                                              Lifetime and Idletime. Standard IKE SA and IPsec SA lifetimes are used. However, since these
                                                                                              are not negotiated, individual managers can tune these later to optimum values, depending on
                                                                                              their traffic patterns. Similarly, idletimes are set to 15 minutes to prevent the accumulation of too
                                                                                              many idle IKE and IPsec sessions per host, and idletimes can be tuned at a later stage as well.

                                                                                              IPsec Mode. All networks are already connected via IPsec gateways, so no NAT is deployed,
                                                                                              and the IPsec connections can use the transport mode, resulting in a larger effective MTU than if
                                                                                              an IPsec tunnel mode was used. Transport mode also prevents a node from creating a custom
                                                                                              policy covering more than itself.


                                                                                                                                               117
