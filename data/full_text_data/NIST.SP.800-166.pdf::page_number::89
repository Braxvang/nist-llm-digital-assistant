NIST SP 800-166                                                                            DERIVED PIV APPLICATION AND
                                                                                           DATA MODEL TEST GUIDELINES

 Precondition(s)                 •    A token with the Derived PIV Application is inserted into an
                                      appropriate token reader.
                                 •    Suitable drivers have been loaded between the test system and an
                                      instance of the reader.
                                 •    The Derived PIV Application Token Management Key is recorded.
                                 •    The mutual authentication of the Derived PIV Application and the
                                      Test Toolkit Application has not been performed.
                                 •    Data objects to be loaded are equal to the minimum container sizes
                                      specified for that object. 14
 Test Scenario                   1. Send the SELECT command with
                                       • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                                 2. Send the PUT DATA command with
                                       • CLA is set to:
                                           1. '00' if command chaining is not needed or
                                           2. '10' if command chaining is used. (The last
                                              chain of the command sets CLA to '00')
                                       • Data field in the command is to include the tag
                                          of the X.509 Certificate for PIV Authentication
                                          data object ('5FC105')
                                       • Data field in the command is to include data
                                          object that will be placed in the X.509
                                          Certificate for PIV Authentication container
                                 3. If the X.509 Certificate for Digital Signature is
                                    supported, repeat Step 2 with
                                       • Data field in the command is to include the tag
                                          of the X.509 Certificate for Digital Signature
                                          data object ('5FC10A')
                                       • Data field in the command is to include the data
                                          content that will be placed in the X.509
                                          Certificate for Digital Signature container
                                 4. If the X.509 Certificate for Key Management is
                                    supported, repeat Step 2 with
                                       • Data field in the command is to include the tag
                                          of the X.509 Certificate for Key Management data
                                          object ('5FC10B')
                                       • Data field in the command is to include the data
                                          object that will placed in the X.509 Certificate
                                          for Key Management container
                                 5. If the token supports the Discovery Object, repeat Step
                                    2 with
                                       • Data field in the command is to include the tag
                                          of the Discovery Object ('7E')
                                       • Data field in the command is to include the data
                                          object that will placed in the Discovery Object
                                          container
                                 6. If the Security Object is supported, repeat Step 2 with
                                       • Data field in the command is to include the tag
                                          of the Security Object ('5FC106')




14
     Data objects for the containers do not have to be properly formatted for this test.


                                                             82
