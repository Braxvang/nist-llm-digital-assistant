                                                                                             NIST SP 800-90B                                                    RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                        USED FOR RANDOM BIT GENERATION

                                                                                             Descriptions of the individual tests will provide guidance on when to use each of these conversions.

                                                                                             5.1.1   Excursion Test Statistic

                                                                                             The excursion test statistic measures how far the running sum of sample values deviates from its
                                                                                             average value at each point in the dataset. Given S = (s1,…, sL), the test statistic T is the largest
                                                                                             deviation from the average and is calculated as follows:

                                                                                                 1. Calculate the average of the sample values, i.e., 𝑋𝑋� = (s1 + s2 + … + sL) / L
                                                                                                 2. For i = 1 to L
                                                                                                              Calculate di = | ∑𝑖𝑖𝑗𝑗=1 𝑠𝑠𝑗𝑗 − 𝑖𝑖 × 𝑋𝑋� |.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                                 3. T = max (d1,…, dL).
                                                                                             Example 1: Let the input sequence be S = (2, 15, 4, 10, 9). The average of the sample values is 8,
                                                                                             and d1 = |2–8| = 6; d2 = |(2+15) – (2×8)| = 1; d3 = |(2+15+4) – (3×8)| = 3; d4 = |(2+15+4+10) –
                                                                                             (4×8)| = 1; and d5 = |(2+15+4+10+9) – (5×8)| = 0. Then, T = max(6, 1, 3, 1, 0) = 6.

                                                                                             Handling binary data: The test can be applied to binary data, and no additional conversion steps
                                                                                             are required.

                                                                                             5.1.2   Number of Directional Runs

                                                                                             This test statistic determines the number of runs constructed using the relations between
                                                                                             consecutive samples. Given S = (s1, …, sL), the test statistic T is calculated as follows:

                                                                                                 1. Construct the sequence 𝑆𝑆 ′ = (𝑠𝑠1′ ,…, 𝑠𝑠𝐿𝐿−1
                                                                                                                                              ′
                                                                                                                                                   ), where
                                                                                                                                                         −1,   if 𝑠𝑠𝑖𝑖 > 𝑠𝑠𝑖𝑖+1
                                                                                                                                             𝑠𝑠𝑖𝑖′ = �
                                                                                                                                                         +1,   if 𝑠𝑠𝑖𝑖 ≤ 𝑠𝑠𝑖𝑖+1

                                                                                                     for i = 1, …, L–1.

                                                                                                 2. The test statistic T is the number of runs in 𝑆𝑆 ′ .
                                                                                             Example 2: Let the input sequence be S = (2, 2, 2, 5, 7, 7, 9, 3, 1, 4, 4); then 𝑆𝑆 ′ = (+1, +1, +1, +1,
                                                                                             +1, +1, −1, −1, +1, +1). There are three runs: (+1, +1, +1, +1, +1, +1), (−1, −1) and (+1, +1), so T
                                                                                             = 3.

                                                                                             Handling binary data: To test binary input data, first apply Conversion I to the input sequence.

                                                                                             5.1.3   Length of Directional Runs

                                                                                             This test statistic determines the length of the longest run constructed using the relations between
                                                                                             consecutive samples. Given S = (s1,…, sL), the test statistic T is calculated as follows:

                                                                                                 1. Construct the sequence 𝑆𝑆 ′ = (𝑠𝑠1′ , … , 𝑠𝑠𝐿𝐿−1
                                                                                                                                                ′
                                                                                                                                                     ), where



                                                                                                                                                         31
