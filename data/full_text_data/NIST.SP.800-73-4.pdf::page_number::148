Special Publication 800-73-4                                                     Part 3: PIV Client Application
Interfaces for Personal Identity Verification                                          Programming Interface

                       cryptographicMechanism            The type of key pair to be generated. See Part 1,
                                                         Table 5.

                       publicKey                         BER-TLV data objects defining the public key
                                                         of the generated key pair. See Part 2, Table 11.

                       KeyLength                         As an input, length of the buffer allocated for
                                                         publicKey. As an output, length of the public
                                                         key related data retrieved from the PIV Card.

Return Codes:          PIV_OK
                       PIV_INVALID_CARD_HANDLE
                       PIV_SECURITY_CONDITIONS_NOT_SATISFIED
                       PIV_FUNCTION_NOT_SUPPORTED
                       PIV_INVALID_KEY_OR_KEYALG_COMBINATION
                       PIV_UNSUPPORTED_CRYPTOGRAPHIC_MECHANISM
                       PIV_CARD_READER_ERROR
                       PIV_INSUFFICIENT_BUFFER

If the length of public key related data retrieved from the PIV Card is longer than the buffer allocated by
the client application, then the PIV Middleware shall return PIV_INSUFFICIENT_BUFFER, but shall still
set KeyLength to the length of the public key related data retrieved from the PIV Card.




                                                    13
