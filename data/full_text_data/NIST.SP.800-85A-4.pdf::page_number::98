NIST SP 800-85A-4                                              PIV CARD APPLICATION & MIDDLEWARE
                                                                        INTERFACE TEST GUIDELINES

 Target                  pivMiddlewareVersion
 Reference(s)            1. SP 800-73-4 Part 3, Section 3.1.1
                         2. AS04.01, AS04.02A-R4, AS04.03B-R4
 Precondition(s)         N/A
 Test Steps              1. Call pivMiddlewareVersion with
                            • (OUT) version
 Expected Result(s)      Function call returns with the version string “800-73-4 Client API” or
                         “800-73-4 Client API with SM” if secure messaging is supported.
 Postcondition(s)        N/A


B.11          pivEstablishSecureMessaging

The following tests shall be performed using a PIV Card that has implemented support for the
virtual contact interface (VCI) and that has been configured to require submission of a pairing
code in order to establish the VCI. These tests need to be performed using a card that has been
configured to require submission of a pairing code in order to test the ability of the PIV
Middleware to submit the pairing code over secure messaging when the client application calls
pivLogIntoCardApplication with a pairing code. It is not necessary to also test the ability of the
PIV Middleware to work with a card that is configured to not require the submission of a pairing
code in order to establish the VCI since the middleware performs the same steps for each
function regardless of whether the PIV Card is configured to require the pairing code.


B.11.1          Valid Test Assertions

B.11.1.1         Establish Secure Messaging
 Purpose                 Ensure the PIV Middleware can establish secure messaging session
                         with the PIV Card Application.
 Target                  pivEstablishSecureMessaging
 Reference(s)            1. SP 800-73-4 Part 3, Section 3.2.2
                         2. AS04.07A-R4
 Precondition(s)         1. A valid PIV Card is placed within the reading range of the
                            contactless reader.
                         2. There exists a valid connection between the test system and an
                            instance of the contactless reader.
                         3. The client application owns a connection to the PIV Card
                            Application accessible through cardHandle.
                         4. The client application has successfully selected the PIV Card
                            Application.
                         5. No other contactless card is within the proximity of the reader.
 Test Steps              1. Set cardHandle := <<valid cardHandle>>
                         2. Call pivEstablishSecureMessaging with
                            • (IN) cardHandle



                                           B-32
