                                                                                            GUIDE TO SECURE WEB SERVICES



specifications within SOAP messages and what headers and elements are necessary to correctly process
the ciphertext.

3.1.3    Security Concerns of WS-Security

There are several concerns prevalent in a WS-Security compliant Web service. Many of these concerns
are not specific to WS-Security and apply to message integrity and confidentiality mechanisms in general.

WS-Security can be susceptible to replay attacks. An attacker may be able to reuse a WS-Security packet
that is recorded. To mitigate this problem, timestamps, sequence numbers, and expirations should be sent
signed within the WS-Security message. The receiving endpoint should then check to make sure that the
message received has not been replayed.

WS-Security provides support for tokens that can be sent in the WS-Security header of a SOAP message.
Without proper safeguards, these security tokens can be substituted. It is important when using WS-
Security tokens to sign the appropriate portions of the message. WS-Security headers that are signed by
the sender can be used to detect alterations.

Credential management may be a concern with WS-Security. PKI is most commonly deployed using
X.509 certificates. PKI is used in e-commerce for performing SSL/TLS transactions over the World
Wide Web. In many security architectures, user credentials are presented in the form of X.509
certificates. To this end, XML protocols and Web services security protocols have been developed to
work with PKIs and X.509 in particular. XML Encryption can use a PKI for encrypting XML messages
while XML Signature relies on a PKI for digitally signing XML content using algorithms similar to those
defined in FIPS 186-2 23. As such, Web services innately support working within a PKI. Management of
X.509 certificates and other credentials may or may not be provided by the SOA. While SOAP-compliant
services exist to interact with a PKI (e.g., XKMS), most installed PKIs use older non-XML-based
protocols which require certificate management to take place out-of-band from XML-based
communication.

Most WS-Security, SAML, and XML Security libraries do not perform full certificate validation by
default. All certificate libraries will validate to make sure that the certificate was signed by a trusted
Certificate Authority (CA). Most certificate libraries are not configured—and may not adequately
support—checking the certificate against the CA’s Certificate Revocation List (CRL) or the Online
Certificate Status Protocol (OCSP), the two main standards for detecting whether or not a certificate has
been revoked. To support the more advanced features of PKI certificate management, either additional
libraries or appropriate versions of the Web services framework should be used. For example, newer
versions of Java (1.5+) support OCSP, and Microsoft’s Windows XP and Windows Server 2003 support
OCSP for .NET-based Web services. For some applications, they may need to interact explicitly with the
CRL or OCSP responder through some API to fully use PKI certificate management. Some PKI libraries,
however, will perform CRL or OCSP checking automatically when validating digital signatures. The use
of CRLs, OCSP, and PKI authentication is described in more detail in FIPS 196 24, NIST SP 800-32 25 and
NIST SP 800-25 26.



23
     FIPS 186-2, Digital Signature Standard, is available at http://csrc.nist.gov/publications/fips/.
24
     FIPS 196, Entity Authentication Using Public Key Cryptography, is available at http://csrc.nist.gov/publications/fips/.
25
     NIST SP 800-32, Introduction to Public Key Technology and the Federal PKI Infrastructure, is available at
     http://csrc.nist.gov/publications/nistpubs/.
26
     NIST SP 800-25, Federal Agency Use of Public Key Technology for Digital Signatures and Authentication, is available at
     http://csrc.nist.gov/publications/nistpubs/.


                                                             3-3
