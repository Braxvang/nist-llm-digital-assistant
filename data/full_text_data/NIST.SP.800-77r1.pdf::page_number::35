                                                                                              NIST SP 800-77 REV. 1                                                                                 GUIDE TO IPSEC VPNS


                                                                                              hosts and not by the security controller. The hosts could optionally transfer these secret keys to
                                                                                              their security controller to facilitate monitoring via decryption by the security controller or
                                                                                              another dedicated monitoring device that takes its configuration from the security controller.

                                                                                              When establishing a connection between two hosts in two different networks, if the hosts do not
                                                                                              have enough resources to negotiate an IPsec connection, the security controller in each network
                                                                                              can negotiate an IPsec connection with the security controller in the other network on behalf of
                                                                                              its host and give the keying material and security policies for the IPsec connection to that host.
                                                                                              The two hosts receive the exact same IPsec policies and the same encryption keys from their
                                                                                              security controllers to install in their IPsec subsystems (key exchange is performed by the two
                                                                                              corresponding security controllers). This latter method is called an IKEless IPsec connection. It
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              is not the preferred method since, in this case, the security controllers are aware of all of the
                                                                                              secret keys used by their hosts, and the security controllers (or whoever manages to get control
                                                                                              of one of them) can decrypt all of the host-to-host IPsec-protected traffic or masquerade as one
                                                                                              of the hosts under its control. An IKEless connection can also be established by a single security
                                                                                              controller between two of its own managed nodes.

                                                                                              A third method for configuring hosts by a security controller is for the hosts to give their key-
                                                                                              exchange public keys to the security controller. When two hosts establish an IPsec connection,
                                                                                              the security controller distributes each host’s key-exchange public key and a nonce to the other
                                                                                              host. Each of the hosts uses the public key and nonce from the other host along with its own
                                                                                              private key to generate a secret shared key, which is then used for an IPsec connection. The
                                                                                              security controller does not know the private keys or the shared key of the IPsec devices.
                                                                                              Therefore, the security controllers cannot decrypt any host-to-host communication and cannot
                                                                                              masquerade as one of the hosts. 15 The same method can be used for two nodes behind different
                                                                                              security controllers. In that case, the security controllers distribute the nodes’ public keys to each
                                                                                              other and relay these to the nodes they manage.

                                                                                              2.4.3.2 Anonymous IPsec VPN

                                                                                              The hardest part of deploying an IPsec implementation is the authentication mechanisms, which
                                                                                              depend on the prior deployment of a CA or other identity verifier mechanism. If a network only
                                                                                              needs to protect itself from passive attackers (i.e., attackers that can eavesdrop but not send their
                                                                                              own malicious packets), then anonymous IPsec can be used. Therefore, anonymous IPsec
                                                                                              connections are typically host-to-host connections and not gateway-based connections 16 because
                                                                                              an IPsec gateway typically requires authentication of the connecting gateway or host and
                                                                                              authenticates itself to that entity. A variant of this is server-only authenticated IPsec. This works
                                                                                              similarly to regular HTTPS connections where a client connects to the server and the server has
                                                                                              to authenticate itself to the client, but the client remains anonymous. Any client authentication
                                                                                              then happens at the application layer and not at the network layer.




                                                                                              15   This is currently specified in an IETF draft document, draft-carrel-ipsecme-controller-ike [37].
                                                                                              16   This means neither a gateway-to-gateway connection (Section 2.4.1) nor a remote access connection (Section 2.4.2).



                                                                                                                                                             18
