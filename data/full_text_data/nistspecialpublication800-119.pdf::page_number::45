                                                                         GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


A standard IPv6 header precedes every ICMPv6 message. The IPv6 header may or may not contain
extension headers. The IPv6 header identifies the ICMPv6 header with a NH value of 58.

ICMPv6 messages have the following general format, illustrated in Figure 3-10:




                                         Figure 3-10. ICMPv6 Message Format

           Type. Indicates the message type. This eight-bit value determines the format of the
            remaining data; see Tables 3-5 and 3-6, below.

           Code. Depends on the message type (see below). This eight-bit value is used to create an
            additional level of message granularity.

           Checksum. This 16-bit field is used to detect data corruption in the ICMPv6 message and
            parts of the IPv6 header. In ICMPv6, the checksum calculation includes portions of the IPv6
            header, called a pseudo-header, since these fields are not contained within the ICMPv6 data.
            The reason for the change is to protect ICMP from misdelivery or corruption of those fields of
            the IPv6 header on which it depends, which, unlike IPv4, are not covered by an Internet-layer
            checksum. The Next Header field is included in the pseudo-header for ICMP and contains the
            value 58, which identifies the IPv6 version of ICMP.

           Message Body. Field length varies depending on the type and code of the message. ICMPv6
            messages are grouped into two classes: error messages and informational messages.

The ICMPv6 specification defines two classes of ICMP messages: error and informational. Other
protocols such as Mobile IPv6 define additional messages within each class. Tables 3-5 and 3-6 provide
an overview of some of the most common message types20, along with the additional code information,
which depends on the message type.




20
     The full list of ICMPv6 Message Numbers and Codes can be found at the IANA ICMPv6 Registry.


                                                            3-23
