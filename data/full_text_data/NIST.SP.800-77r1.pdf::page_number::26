                                                                                              NIST SP 800-77 REV. 1                                                                       GUIDE TO IPSEC VPNS


                                                                                                       180 [30] (i.e., Secure Hash Algorithm [SHA]: SHA-1 or the SHA-2 family of hash
                                                                                                       functions, also known as HMAC-SHA-2). 8 The SHA-3 family might be added in the
                                                                                                       future.
                                                                                                   •   A mode of AES, as specified in FIPS 197 [31]. Included modes are AES-Cipher Block
                                                                                                       Chaining (AES-CBC), AES-Cipher-Based Message Authentication Code (AES-CMAC)
                                                                                                       [32], and AES-Galois Message Authentication Code (AES-GMAC) [33]. While
                                                                                                       commonly deployed on Internet of Things (IoT) devices, AES-XCBC 9 is not a NIST-
                                                                                                       approved integrity algorithm.

                                                                                              2.3.3    Establishment of Shared Secret Keys
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              VPNs typically use the DH key exchange algorithm to create a confidential communication
                                                                                              channel to calculate a shared key between the two endpoints that an eavesdropper cannot obtain
                                                                                              or compute. DH key exchanges can be based on finite field cryptography (“classic” or “modular”
                                                                                              DH) or on elliptic curve cryptography (ECDH). After performing the DH key exchange and
                                                                                              calculating the shared key, the endpoints still need to authenticate each other to ensure that the
                                                                                              confidential communication channel is set up with the expected party and not somebody else.

                                                                                              2.3.4    Peer Authentication

                                                                                              A digital signature algorithm is used for peer authentication. It uses two separate keys: a public
                                                                                              key and a private key. The private key is used to digitally sign data to be sent to a receiving party
                                                                                              along with the signature, and the public key is used by the receiver to verify the digital signature
                                                                                              on the received data. These keys are often referred to as public/private key pairs. When an
                                                                                              individual’s private key is used to digitally sign data, only that same individual’s corresponding
                                                                                              public key can be used to verify the digital signature. Common algorithms that are used to
                                                                                              generate and verify digital signatures include RSA, the Digital Signature Algorithm (DSA) 10,
                                                                                              and the Elliptic Curve Digital Signature Algorithm (ECDSA). NIST-approved digital signature
                                                                                              algorithms are specified in FIPS 186 [34][35].

                                                                                              VPNs usually use asymmetric cryptography for identity authentication. Such a public/private key
                                                                                              pair can be used by itself or contained within an X.509 certificate. A VPN entity is authenticated
                                                                                              by proving it has possession of the private key that corresponds to a known public key as well as
                                                                                              the secret key computed by the parties during the DH key exchange. This binds the private
                                                                                              communication channel (i.e., the VPN) to the expected identities. The public key can verify this
                                                                                              proof without having a copy of the private key. Thus, as long as both parties each have the




                                                                                              8    The term HMAC-SHA-2 is used throughout the document to mean HMAC using a hash function from the SHA-2 family:
                                                                                                   HMAC-SHA256, HMAC-SHA384, or HMAC-SHA512.
                                                                                              9 eXtended Cipher Block Chaining.
                                                                                              10 DSA may not be allowed for signature generation in the future, see draft FIPS 186-5,

                                                                                                   https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-5-draft.pdf, for details




                                                                                                                                                       9
