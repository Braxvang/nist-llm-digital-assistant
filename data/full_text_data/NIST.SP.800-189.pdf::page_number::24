                                                                                             NIST SP 800-189                                                RESILIENT INTERDOMAIN TRAFFIC EXCHANGE:
                                                                                                                                                                    BGP SECURITY & DDOS MITIGATION
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-189




                                                                                                                 Figure 6: RPKI data retrieval, caching, and propagation to routers

                                                                                             A BGP router can use the ROA information retrieved from an RPKI cache server to mitigate the
                                                                                             risk of prefix hijacks and some forms of route leaks in advertised routes. A BGP router would
                                                                                             typically receive a validated list of {prefix, maxlength, origin AS} tuples (derived from valid
                                                                                             ROAs) from one or more RPKI cache servers. This list may be called a white list. The router
                                                                                             makes use of this list with the BGP origin validation (BGP-OV) process depicted in Figure 7 to
                                                                                             determine the validation state of an advertised route [RFC6811]. A BGP route is deemed to have
                                                                                             a “Valid” origin if the {prefix, origin AS} pair in the advertised route can be corroborated with
                                                                                             the list (i.e., the pair is permissible in accordance with at least one ROA; see Figure 7 for the
                                                                                             details). A route is considered “Invalid” if there is a mismatch with the list (i.e., AS number does
                                                                                             not match, or the prefix length exceeds maxlength; see Figure 7 for additional details). Further, a
                                                                                             route is deemed “NotFound” if the prefix announced is not covered by any prefix in the white list
                                                                                             (i.e., there is no ROA that contains a prefix that equals or subsumes the announced prefix). When
                                                                                             an AS_SET [RFC4271] is present in a BGP update, it is not possible to clearly determine the
                                                                                             origin AS from the AS_PATH [RFC6811]. Thus, an update containing an AS_SET in its
                                                                                             AS_PATH can never receive an assessment of “Valid” in the origin validation process (see
                                                                                             Figure 7). The use of AS_SET in BGP updates is discouraged in BCP 172 [RFC6472]. The
                                                                                             RPKI-based origin validation may be supplemented by validation based on IRR data (see Section
                                                                                             4.1).




                                                                                                                                                13
