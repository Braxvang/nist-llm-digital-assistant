      NIST SP 800-73pt2-5 ipd (Initial Public Draft)                                 Interfaces for Personal Identity Verification: Part 2
      September 2023                                                                    PIV Card Application Card Command Interface




942
943                                                Fig. 2. PIV data integrity of command


944   4.2.4. Command With PIV Secure Messaging
945   For secure messaging, the secure messaging data field SHALL be constructed as the
946   concatenation of the following:
947        •    The BER-TLV-encoded encrypted PIV data; 20
948        •    The 3-btye BER-TLV-encoded L e , as described in Section 4.2.3, if L e would have been
949             included in a message sent without secure messaging;
950        •    The 10-byte BER-TLV-encoded C-MAC of the command, as described in Section 4.2.3;
951             and
952        •    A new L e field, which SHALL be 1 byte and SHALL have a value of '00'. 21



      20
        The data field may be absent in the case of the VERIFY command.
      21
        Note that the new Le field is always included in the command — even if Le would have been absent if the command were sent without secure
      messaging — since a response is always expected, even if the expected response only consists of the BER-TLV-encoded status word and
      response MAC (R-MAC).



                                                                          33
