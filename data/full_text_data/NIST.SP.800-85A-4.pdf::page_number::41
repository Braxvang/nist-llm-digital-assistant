NIST SP 800-85A-4                                            PIV CARD APPLICATION & MIDDLEWARE
                                                                      INTERFACE TEST GUIDELINES



AS04.05A-R4: The PIV Middleware shall not submit authenticators to the PIV Card over a
contactless interface without secure messaging. If secure messaging has not been established,
then the pivLogIntoCardApplication function shall return
PIV_SECURITY_CONDITIONS_NOT_SATISFIED.

Required Vendor Information

VE04.05A-R4: The vendor shall state in its documentation that the card supports the assertions
made in AS04.05A-R4.

Required Test Procedures

TE04.05A-R4.01: The tester shall validate that that the vendor documentation contains the
information required in VE04.05A-R4.

A.4.2.3    pivGetData

AS04.06: The purpose of pivGetData is to return the entire data content of the named data
object.

Required Test Procedures

TE04.06.01: The tester shall validate that the PIV Middleware implements the pivGetData as per
SP 800-73-4 Part 3.

AS04.06A-R4: If the length of the retrieved data is longer than the buffer allocated by the
client application, then the PIV Middleware shall return PIV_INSUFFICIENT_BUFFER, but
shall still set DataLength to the length of the retrieved data.

Required Test Procedures

TE04.06A-R4.01: The tester shall ensure that the PIV Middleware returns
PIV_INSUFFICIENT_BUFFER if the length of the retrieved data is longer than the buffer allocated
by the client application


A.4.2.4    pivLogoutOfCardApplication

AS04.07: The purpose of pivLogoutOfCardApplication is to reset the application security
state/status of the PIV Card Application.

Required Test Procedures

TE04.07.01: The tester shall validate that the PIV Middleware implements the
pivLogoutOfCardApplication as per SP 800-73-4 Part 3.


                                         A-13
