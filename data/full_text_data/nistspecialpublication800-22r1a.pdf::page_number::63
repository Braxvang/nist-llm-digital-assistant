    A STATISTICAL TEST SUITE FOR RANDOM AND PSEUDORANDOM NUMBER GENERATORS FOR CRYPTOGRAPHIC APPLICATIONS



    3.    Technical Description of Tests

    This section contains the mathematical background for the tests in the NIST test suite. Each subsection
    corresponds to the appropriate subsection in Section 2. The relevant references for each subsection are
    provided at the end of that subsection.

    3.1 Frequency (Monobits) Test
    The most basic test is that of the null hypothesis: in a sequence of independent identically distributed
    Bernoulli random variables (X's or ε's, where X = 2ε-1, and so Sn = X1 + … + Xn = 2(ε1 + … + εn) – n), the
    probability of ones is 1/2. By the classic De Moivre-Laplace theorem, for a sufficiently large number of
    trials, the distribution of the binomial sum, normalized by n , is closely approximated by a standard
    normal distribution. This test makes use of that approximation to assess the closeness of the fraction of
    1's to 1/2. All subsequent tests are conditioned on having passed this first basic test.

    The test is derived from the well-known limit Central
                                                  €       Limit Theorem for the random walk, Sn = X1 + … +
    Xn. According to the Central Limit Theorem,

                                             Sn               1    z −u 2 / 2
                                    lim P(
                                    n →∞      n
                                                ≤ z) = Φ(z) ≡    ∫
                                                              2π −∞
                                                                    e         du                          (1)


    This classical result serves as the basis of the simplest test for randomness. It implies that, for positive z,

                       €                             Sn
                                                P(      ≤ z) = 2Φ(z) −1.
                                                      n

    According to the test based on the statistic s = Sn / n , evaluate the observed value s(obs) =
    X1 + … + X n / n , and then €
                                calculate the corresponding P-value, which is
    2[1− Φ( s(obs) )] = erfc( s(obs) / n ) . Here, erfc is the (complementary) error function
                                       € €                                   €
       €                                                 2    ∞ −u 2
€                                            erfc(z) =
                                                         π z
                                                             ∫ e du .
€
                                                  References for Test

    [1]     Kai Lai Chung, Elementary
                                €       Probability Theory with Stochastic Processes. New York: Springer-
            Verlag, 1979 (especially pp. 210-217).

    [2]     Jim Pitman, Probability. New York: Springer-Verlag, 1993 (especially pp. 93-108).


    3.2 Frequency Test within a Block
    The test seeks to detect localized deviations from the ideal 50% frequency of 1's by decomposing the test
    sequence into a number of nonoverlapping subsequences and applying a chi-square test for a
    homogeneous match of empirical frequencies to the ideal 1/2. Small P-values indicate large deviations
    from the equal proportion of ones and zeros in at least one of the substrings. The string of 0's and 1's (or
    equivalent -1's and 1's) is partitioned into a number of disjoint substrings. For each substring, the
    proportion of ones is computed. A chi-square statistic compares these substring proportions to the ideal



                                                           3-1
