NIST SP 800-58                                              Voice Over IP Security
_____________________________________________________________________________


             Bob Calls Alice in an SIP Network (Protocol View)

       Bob                             Proxy Server(s)                             Alice
                    INVITE Alice
                                                    INVITE Alice@123.45.67.8

                                                      OK from Alice@123.45.67.8
             OK from Alice@123.45.67.8

                    ACK Alice with route
                    Alice@123.45.67.8

                                                     ACK Alice@123.45.67.8


                                   CONVERSATION

               BYE Alice@123.45.67.8
                                                    BYE Alice@123.45.67.8
                                                             OK
                     OK


                                      Figure 6. SIP Protocol


      We have already discussed some of the problems with incoming VOIP
      connections against NAT (see Section 4.2). Now we will look more in depth at
      the SIP specific problems with incoming calls. Rosenberg & Schulzrinne [22]
      trace the problem back to the registration process itself. When a user contacts the
      registrar, they provide their IP address as their reachable address and this is stored
      in the location server. However, this is their private IP address. The proxy server
      deals only with global IP addresses, so when a message comes in for
      username@domain.com, it will attempt to route this call to the registered address,
      but in the public domain. For instance, if username@domain.com is registered to
      an internal IP address of 10.7.34.189, then the proxy server will attempt to
      forward the traffic to this address, but in the public domain. This address is
      unreachable for the proxy server and the connection will be refused. The solution
      to this is a delicate manipulation of IP addresses and an expansion of the
      responsibilities of the SIP proxy server.




46
