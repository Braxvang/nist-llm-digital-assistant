Special Publication 800-85B                                                PIV Data Model Testing Specification




8.       BER-TLV Test Assertions

Assumptions:
1.0                   When the length of the value field is between 0 and 127 bytes, the
                      length field consists of a single byte where bit 8 is set to 0 and bits
                      7 to 1 encode the number of bytes in the value field.

                      When the length of the value field is greater than 127 bytes, the length
                      field consists of two or more bytes. The first byte is '81', '82', '83'
                      or '84' where the low order nibble of each of these possible first-byte
                      values (1, 2, 3, or 4 respectively) encodes the number of subsequent
                      and remaining bytes in the length field. These subsequent and
                      remaining bytes are taken together in order to be a big-endian integer
                      encoding the number of bytes in the value field. Table 8-1 shows the
                      encoding of the length field.
1.1                   Each BER-TLV tag is encoded as three bytes.
1.2                   Each data object returned is appended with a 2 byte status word.
1.3                   All variable length value fields can have zero lengths, which will
                      result in a tag length field being immediately followed by the next
                      tag, if applicable.
1.4                   The final byte of the command string can be set to 0x00 to retrieve an
                      entire data object regardless of the size of that object.

Number of                First Byte             Subsequent Bytes                 Length of
Bytes in the                                                                     the Value Field
Length Field
1 byte                   ‘00’ to ‘7F’           None                             0 to 127
2 byte                   ‘81’                   '00' to 'FF'                     0 to 255
3 byte                   ‘82’                   '0000' to 'FFFF'                 0 to 65,535
4 byte                   ‘83’                   '000000' to 'FFFFFF'             0 to 16,777,215
5 byte                   ‘84’                   '00000000' to 'FFFFFFFF'         0 to 4,294,967,295

                                        Table 8-1. Encoding of Length Field


8.1      “Card Capabilities Container” Data Object
Purpose                   Confirms that the CCC of the PIV card Application conforms to the
                          PIV data model requirements as per Appendix A of SP80073.
Reference(s)              1. SP80073, Appendix A
                          2. TE04.01.01.01
                          3. TE04.02.01.01
                          4. TE04.02.01.02



                                                                                                        Page 40
