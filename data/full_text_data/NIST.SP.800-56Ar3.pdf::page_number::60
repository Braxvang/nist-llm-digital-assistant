                                                                                               NIST SP 800-56A Rev. 3                             Recommendation for Pair-Wise Key Establishment
                                                                                                                                                          Using Discrete Logarithm Cryptography


                                                                                                  1. z = y B A mod p .
                                                                                                              x



                                                                                                  2. If ((z ≤ 1) OR (z = p – 1)), destroy all intermediate values used in the attempted
                                                                                                     computation of Z (including z), then output an error indicator, and exit this process
                                                                                                     without further processing.
                                                                                                  3. Else, convert z to Z using the integer-to-byte-string conversion routine defined in
                                                                                                     Appendix C.1.
                                                                                                  4. Destroy the results of all intermediate calculations used in the computation of Z
                                                                                                     (including z).
                                                                                                  5. Output Z.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                               Output: The shared secret Z or an error indicator.

                                                                                               5.7.1.2 Elliptic Curve Cryptography Cofactor Diffie-Hellman (ECC CDH)
                                                                                                       Primitive
                                                                                               A shared secret Z is computed using the domain parameters (q, FR, a, b{, SEED}, G, n, h),
                                                                                               the other party’s public key, and one’s own private key. This primitive is used in Section 6
                                                                                               by the Full Unified Model, Ephemeral Unified Model, One-Pass Unified Model, One-Pass
                                                                                               Diffie-Hellman and Static Unified Model schemes. Assume that the party performing the
                                                                                               computation is party A, and the other party is party B. Note that party A could be either party
                                                                                               U or party V.
                                                                                               Input:
                                                                                                  1. (q, FR, a, b{, SEED}, G, n, h): Domain parameters,
                                                                                                  2. dA : One’s own private key, and
                                                                                                  3. QB : The other party’s public key.
                                                                                               Process:
                                                                                                  1. Compute the point P = hdAQB.
                                                                                                  2. If P = Ø, destroy all intermediate values used in the attempted computation of P, then
                                                                                                     output an error indicator, and exit this process without further processing.
                                                                                                  3. Else, set z = xP, where xP is the x-coordinate of P, and convert z to Z, using the field-
                                                                                                     element-to-byte string conversion routine defined in Appendix C.2.
                                                                                                  4. Destroy the results of all intermediate calculations used in the computation of Z
                                                                                                     (including P and z).
                                                                                                  5. Output Z.
                                                                                               Output: The shared secret Z or an error indicator.




                                                                                                                                             49
