                                                                                             NIST SP 800-38B                                                                   BLOCK CIPHER MODES:
                                                                                                                                                                       CMAC MODE FOR AUTHENTICATION


                                                                                             are outside the scope of this Recommendation.

                                                                                             5.3    Subkeys

                                                                                             The block cipher key is used to derive two additional secret values, called the subkeys, denoted
                                                                                             K1 and K2. The length of each subkey is the block size. The subkeys are fixed for any invocation
                                                                                             of CMAC with the given key. Consequently, the subkeys may be precomputed and stored with
                                                                                             the key for repeated use; alternatively, the subkeys may be computed anew for each invocation.

                                                                                             Any intermediate value in the computation of the subkey, in particular, CIPHK(0b), shall also be
                                                                                             secret. This requirement precludes the system in which CMAC is implemented from using this
                                                                                             intermediate value publicly for some other purpose, for example, as an unpredictable value or as
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-38B




                                                                                             an integrity check value on the key.

                                                                                             One of the elements of the subkey generation process is a bit string, denoted Rb, that is completely
                                                                                             determined by the number of bits in a block. In particular, for the two block sizes of the currently
                                                                                             approved block ciphers, R128 = 012010000111, and R64 = 05911011.

                                                                                             In general, Rb is a representation of a certain irreducible binary polynomial of degree b, namely,
                                                                                             the lexicographically first among all such polynomials with the minimum possible number of
                                                                                             nonzero terms. If this polynomial is expressed as ub+cb-1ub-1+...+c2u2+c1u+c0, where the
                                                                                             coefficients cb-1, cb-2, ..., c2, c1, c0 are either 0 or 1, then Rb is the bit string cb-1cb-2...c2c1c0.

                                                                                             5.4    MAC Generation and Verification

                                                                                             As for any MAC algorithm, an authorized party applies the MAC generation process to the data to
                                                                                             be authenticated to produce a MAC for the data. Subsequently, any authorized party can apply the
                                                                                             verification process to the received data and the received MAC. Successful verification provides
                                                                                             assurance of data authenticity, as discussed in Appendix A, and, hence, of integrity.

                                                                                             5.5    Input and Output Data

                                                                                             For a given block cipher and key, the input to the MAC generation function is a bit string called
                                                                                             the message, denoted M. The bit length of M is denoted Mlen. The value of Mlen is not an essential
                                                                                             input for the MAC generation algorithm if the implementation has some other means of identifying
                                                                                             the last block in the partition of the message, as discussed in Sec. 6.2. Thus, in such a case, the
                                                                                             computation of the MAC may begin “on-line” before the entire message is available. In principle,
                                                                                             there is no restriction on the lengths of messages. In practice, however, the system in which CMAC
                                                                                             is implemented may restrict the length of the input messages to the MAC generation function.

                                                                                             The output of the MAC generation function is a bit string called the MAC, denoted T. The length
                                                                                             of T, denoted Tlen, is a parameter that shall be fixed for all invocations of CMAC with the given
                                                                                             key. The requirements for the selection of Tlen are given in Appendix A.

                                                                                             6     CMAC Specification



                                                                                                                                                6
