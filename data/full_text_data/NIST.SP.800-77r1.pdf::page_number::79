                                                                                              NIST SP 800-77 REV. 1                                                                                 GUIDE TO IPSEC VPNS


                                                                                              7.2.1.1 Gateway Placement

                                                                                              Due to the layered defense strategy used to protect enterprise networks, IPsec gateway placement
                                                                                              is often a challenging task. As described later in this section, the gateway’s placement has
                                                                                              security, functionality, and performance implications. The gateway’s placement may also have
                                                                                              an effect on other network devices, such as firewalls, routers, and switches. Incorporating an
                                                                                              IPsec gateway into a network architecture requires strong overall knowledge of the network and
                                                                                              security policy. The following are major factors to consider for IPsec gateway placement:

                                                                                                   •   Device Performance. IPsec can be computationally intensive, primarily because of
                                                                                                       encryption and decryption. Providing IPsec services from another device (e.g., a firewall
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                                       or router) may put too high of a load on the device during peak usage, causing service
                                                                                                       disruptions. A possible alternative is to offload the cryptographic operations to a
                                                                                                       specialized hardware device, such as a network card with built-in cryptographic
                                                                                                       functions. Organizations should also review their network architecture to determine if
                                                                                                       bottlenecks are likely to occur due to network devices (e.g., routers, firewalls) that cannot
                                                                                                       sustain the processing of peak volumes of network traffic that include IPsec-encapsulated
                                                                                                       packets. 47 For remote access architectures, the choice of DH group is important because
                                                                                                       it is the most computationally demanding part of IKE.
                                                                                                   •   Traffic Examination. If IPsec-encrypted traffic passes through a firewall, the firewall
                                                                                                       cannot determine what protocols the packets’ payloads contain, so it cannot filter the
                                                                                                       traffic based on those protocols. Intrusion detection systems encounter the same issue:
                                                                                                       they cannot examine encrypted traffic for attacks. However, it is generally recommended
                                                                                                       to design the IPsec architecture so that a firewall and intrusion detection software can
                                                                                                       examine the unencrypted traffic. Organizations most commonly address this by using
                                                                                                       their internet firewalls as VPN gateways or placing VPN gateway devices just outside
                                                                                                       their internet firewalls. A full mesh encryption bypasses all network-based firewalls and
                                                                                                       intrusion detection systems because those systems can only accept or reject the encrypted
                                                                                                       stream without being able to inspect the data that has been encrypted. This could mean a
                                                                                                       reduction of security. This is discussed in greater detail in [57].
                                                                                                   •   Traffic Not Protected by IPsec. Organizations should carefully consider the threats
                                                                                                       against network traffic after it has been processed by the receiving IPsec gateway and
                                                                                                       sent without IPsec protection across additional network segments. For example, an
                                                                                                       organization that wants to place its VPN gateway outside of its internet firewalls should
                                                                                                       ensure that the traffic passing between the IPsec gateway and the internet firewalls has
                                                                                                       sufficient protection against breaches of confidentiality and integrity.
                                                                                                   •   Gateway Outages. The architecture should take into consideration the effects of IPsec
                                                                                                       gateway outages, including planned maintenance outages and unplanned outages caused
                                                                                                       by failures or attacks. For example, if the IPsec gateway is placed inline near the internet
                                                                                                       connection point, meaning that all network traffic passes through it, a gateway failure
                                                                                                       could cause a loss of all internet connectivity for the organization. Also, larger IPsec


                                                                                              47   The network architecture review is also beneficial in identifying intermediate network devices that may need to be
                                                                                                   reconfigured to permit IPsec traffic to pass through.



                                                                                                                                                             62
