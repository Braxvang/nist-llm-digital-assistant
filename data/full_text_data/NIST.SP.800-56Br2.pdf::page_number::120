                                                                                               NIST SP 800-56B REV. 2                                          RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                                    USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                               Appendix B: Data Conversions (Normative)
                                                                                               B.1 Integer-to-Byte String (I2BS) Conversion
                                                                                               Input:           A non-negative integer X and the intended length n of the byte string satisfying
                                                                                                                               28n > X.
                                                                                               Output:          A byte string S of length n bytes.

                                                                                                  1. Qn+1 = X.
                                                                                                  2. For i = n to 1 by −1
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                                        2.1   Qi = (Qi+1)/256.
                                                                                                        2.2   Xi = Qi+1 − (Qi × 256).
                                                                                                        2.3   Si = (ai1, ai2, ai3, ai4, ai5, ai6, ai7, ai8),
                                                                                                                    the 8-bit binary representation of the non-negative integer
                                                                                                                    Xi = ai1 27 + ai2 26 + ai3 25 + ai4 24 + ai5 23 + ai6 22 + ai7 2 + ai8.
                                                                                                  3. Let S1, S2,…, Sn be the bytes of S from leftmost to rightmost.
                                                                                                  4. Output S.

                                                                                               B.2 Byte String to Integer (BS2I) Conversion
                                                                                               Input:           A non-empty byte string S (SLen is used to denote the length of the byte string).
                                                                                               Output:          A non-negative integer X.
                                                                                                  1. Let S1, S2,… SSLen be the bytes of S from first to last (i.e., from leftmost to rightmost).

                                                                                                  2. Let X = 0.

                                                                                                  3. For i = 1 to SLen by 1

                                                                                                        3.1 Let Xi = (ai127 + ai226 + ai325 + ai424 + ai523 + ai622 + ai72 + ai8),
                                                                                                                     where ai1, ai2, ai3, ai4, ai5, ai6, ai7, ai8 are the bits of Si from leftmost to rightmost;
                                                                                                                     i.e., Si = (ai1, ai2, ai3, ai4, ai5, ai6, ai7, ai8).

                                                                                                        3.2 Replace X by (X × 256) + Xi.

                                                                                                  4. Output X.




                                                                                                                                                           110
