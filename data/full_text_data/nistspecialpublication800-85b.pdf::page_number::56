Special Publication 800-85B                                     PIV Data Model Testing Specification




9.      Biometric Data Object Test Assertions

The test assertions documented in this section relate to testing the Card Holder Fingerprint object
and Facial Image on the PIV card for conformance to the common CBEFF Patron Format for
PIV specification (Table 8 of SP80076) as well as to INCITS 378 Profile for PIV card Templates
(Table 3 of SP80076) and INCITS 385 profile for Facial Image respectively.

9.1     CBEFF Patron Format for Fingerprint Template

9.1.1     CBEFF Structure for Fingerprint Template
Purpose                 Validates that the CBEFF structure generated complies with SP80076 Table
                        7, “Simple CBEFF Structure”.
References(s)          1. SP80076, Table 7.
                       2. AS05.01.01
                       3. AS05.01.03
Precondition(s)         1. All templates have been generated and stored on the PIV card.
                        2. A valid PIV card is inserted into the contact reader.
                        3. A valid PC/SC connection exists between the test application and the
                             contact reader.
                        4. The test application is currently connected to the card application
                             which is accessible through card handle.
                        5. A valid Card Holder Fingerprints object is present on the PIV card.
                        6. Security conditions to read the object are met.
Test Scenario           1. Set cardHandle := <<valid card handle>>
                        2. Set OID := <<Card Holder Fingerprints
                           (2.16.840.1.101.3.7.2.96.16)>>
                        3. Call pivGetData w/
                            • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                        4. Extract the BDB Length field of CBEFF Header.
                        5. Extract the SB Length field of CBEFF Header.
Expected Result(s) 1. From step 4: BDB Length field is non-zero and the recorded length
                      match the actual length.
                   2. From step 5: SB Length field is non-zero and the recorded length match
                      the actual length.
                   3. The Card Holder Fingerprint object length is equal to CBEFF Header
                      length + BDB Length + SB Length.

9.1.2     CBEFF Header for Fingerprint Template

9.1.2.1    Patron Header Version
Purpose                 Validates that the CBEFF field “Patron Header Version” complies with
                        SP80076 Table 8, “Patron Format PIV Specification”


                                                                                             Page 48
