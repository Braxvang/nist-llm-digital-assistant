                                                                     GUIDELINES ON SECURING PUBLIC WEB SERVERS



    capability for an administrator to define specific log file formats in the Web server configuration file
    using a particular syntax (if the default CLF format is insufficient).

9.1.2   Identifying Additional Logging Requirements

If a public Web server supports the execution of programs, scripts, or plug-ins, it may be necessary for the
programs, scripts, or plug-ins to perform additional logging. Often, critical events take place within the
Web application code itself and will not be logged by the Web server. If Webmasters develop or acquire
application programs, scripts, or plug-ins, it is strongly recommended that they define and implement a
comprehensive and easy-to-understand logging approach based on the logging mechanisms provided by
the Web server host OS. Log information associated with programs, scripts, and plug-ins can add
significantly to the typical information logged by the Web server and may prove invaluable when
investigating events.

9.1.3   Recommended Generic Logging Configuration

The following configuration is a good starting point for logging into public Web servers [Alle00]:

 Use the combined log format for storing the Transfer Log, or manually configure the information
  described by the combined log format to be the standard format for the Transfer Log.

 Enable the Referrer Log or Agent Log if the combined log format is unavailable.

 Establish different log file names for different virtual Web sites that may be implemented as part of a
  single physical Web server.

 Use the remote user identity as specified in RFC 1413.

 Ensure procedures or mechanisms are in place so that log files do not fill up the hard drive.

Ensuring that sufficient log capacity is available is a concern because logs often take considerably more
space than administrators initially estimate, especially when logging is set to a highly detailed level.
Administrators should closely monitor the size of the log files when they implement different logging
settings to ensure that the log files do not fill up the allocated storage. Because of the size of the log files,
removing and archiving the logs more frequently or reducing the logging level of detail may be necessary.

Some Web server programs provide a capability to enforce or disable the checking of specified access
controls during program startup. This level of control may be helpful, for example, to avoid inadvertent
alteration of log files because of errors in file access administration. Web server administrators should
determine the circumstances under which they may wish to enable such checks (assuming the Web server
software supports this feature).

9.1.4   Reviewing and Retaining Log Files

Reviewing log files is a tedious and time-consuming task that informs administrators of events that have
already occurred. Accordingly, files are often useful for corroborating other evidence, such as a CPU
utilization spike or anomalous network traffic reported by an IDPS. When a log is used to corroborate
other evidence, a focused review is in order. For example, if an IDPS reported an outbound FTP
connection from the Web server at 8:17 a.m., then a review of the logs generated around 8:17 a.m. is
appropriate. Web server logs should also be reviewed for indications of attacks. The frequency of the
reviews depends on the following factors:



                                                      9-3
