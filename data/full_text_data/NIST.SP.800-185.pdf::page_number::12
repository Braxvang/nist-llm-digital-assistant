                                                                                             NIST SP 800-185                                                   SHA-3 DERIVED FUNCTIONS: CSHAKE,
                                                                                                                                                              KMAC, TUPLEHASH, AND PARALLELHASH



                                                                                             As an example, encode_string(S) where S is the empty string "" will yield 10000000
                                                                                             00000000.

                                                                                             Note that if the bit string S is not byte-oriented (i.e., len(S) is not a multiple of 8), the bit string
                                                                                             returned from encode_string(S) is also not byte-oriented. However, if len(S) is a multiple of 8,
                                                                                             then the length of the output of encode_string(S) will also be a multiple of 8.

                                                                                             2.3.3   Padding

                                                                                             The bytepad(X, w) function prepends an encoding of the integer w to an input string X, then pads
                                                                                             the result with zeros until it is a byte string whose length in bytes is a multiple of w. In general,
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-185




                                                                                             bytepad is intended to be used on encoded strings—the byte string bytepad(encode_string(S), w)
                                                                                             can be parsed unambiguously from its beginning, whereas bytepad does not provide
                                                                                             unambiguous padding for all input strings.

                                                                                             The definition of bytepad() is as follows:

                                                                                             bytepad(X, w):
                                                                                             Validity Conditions: w > 0

                                                                                             1. z = left_encode(w) || X.
                                                                                             2. while len(z) mod 8 ≠ 0:
                                                                                                    z = z || 0
                                                                                             3. while (len(z)/8) mod w ≠ 0:
                                                                                                    z = z || 00000000
                                                                                             4. return z.

                                                                                             2.3.4   Substrings

                                                                                             Let parameters a and b be non-negative integers that denote a specific position in a bit string X.
                                                                                             Informally, the substring(X, a, b) function returns a substring from the bit string X containing the
                                                                                             values at bit positions a, a+1, ..., b−1, inclusive. More precisely, the substring function operates
                                                                                             as defined below. Note that all bit positions in the input and output strings are indexed from zero.
                                                                                             Thus, the first bit in a string is in position 0, and the last bit in an n-bit string is in position n−1.

                                                                                             substring(X, a, b):

                                                                                             1. If a ≥ b or a ≥ len(X):
                                                                                                    return the empty string.
                                                                                             2. Else if b ≤ len(X):
                                                                                                    return the bits of X from position a to position b−1, inclusive.
                                                                                             3. Else:
                                                                                                    return the bits of X from position a to position len(X)−1, inclusive.



                                                                                                                                                6
