                                                                                               NIST SP 800-56A Rev. 3                              Recommendation for Pair-Wise Key Establishment
                                                                                                                                                           Using Discrete Logarithm Cryptography

                                                                                               6.2.1.5.3 C(1e, 2s) Scheme with Bilateral Key Confirmation
                                                                                               Figure_11 depicts a typical flow for a C(1e, 2s) scheme with bilateral key confirmation. In
                                                                                               this method, party U and party V assume the roles of both the provider and the recipient to
                                                                                               obtain bilateral key confirmation. Since party V does not contribute an ephemeral public key
                                                                                               during the key-agreement process, a nonce (NonceV) shall be provided by party V to party U
                                                                                               and used (in addition to the shared secret Z) as input to the key-derivation method employed
                                                                                               by the scheme. NonceV is also used as the EphemDataV during MacTag computations. The
                                                                                               successful completion of the key-confirmation process provides each party with assurance
                                                                                               that the other party has derived the same secret Z value. Party U obtains assurance that party
                                                                                               V has actively participated in the process; if NonceV is a random nonce, then party V also
                                                                                               obtains assurance that party U has actively participated in the process; see Section 5.4 for a
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                               discussion of the length and security strength required for the nonce.


                                                                                                               U                                            V
                                                                                                                          U’s Static Public Key                   Obtain static public
                                                                                                                                                                  keys
                                                                                                                           V’s Static Public Key


                                                                                                                                                                  U sends an ephemeral
                                                                                                                        U’s Ephemeral Public Key
                                                                                                                                                                  public key

                                                                                                                              NonceV, MacTagV
                                                                                                                                                                  V’s key confirmation
                                                                                                                                                                  with a nonce
                                                                                                                                  MacTagU
                                                                                                                                                                  U’s key confirmation



                                                                                                              Figure 11: C(1e, 2s) scheme with bilateral key confirmation
                                                                                               To provide bilateral key confirmation (as described in Section 5.9.2), party U and party V
                                                                                               exchange and verify MacTags that have been computed (as specified in Sections 5.2.1) using
                                                                                                               EphemDataU = EphemPubKeyU and EphemDataV = NonceV.
                                                                                               Party V provides MacTagV to party U (as specified in Sections 5.9.1 and 5.9.2, with P = V
                                                                                               and R = U); MacTagV is computed by party V (and verified by U) using
                                                                                                        MacDataV = “KC_2_V” || IDV || IDU || NonceV || EphemPubKeyU {|| TextV}.
                                                                                               Party U provides MacTagU to party V (as specified in Sections 5.9.1 and 5.9.2, with P = U
                                                                                               and R = V); MacTagU is computed by party U (and verified by party V) using
                                                                                                       MacDataU = “KC_2_U” || IDU || IDV || EphemPubKeyU || NonceV {|| TextU}.


                                                                                                                                            95
