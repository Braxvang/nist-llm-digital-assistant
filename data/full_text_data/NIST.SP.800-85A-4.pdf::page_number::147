NIST SP 800-85A-4                                                                 PIV CARD APPLICATION & MIDDLEWARE
                                                                                           INTERFACE TEST GUIDELINES

                                 12. Repeat step 9 with P2 set to '9E' (Card Authentication
                                     key) and P1 (algorithm reference) set to '07' or '11'
                                     and the template '81' containing a randomly generated
                                     challenge
                                 13. Send GENERAL AUTHENTICATE card command
                                    • P1, algorithm reference, is set to '27' or '2E'
                                    • P2, key reference, is set to '04' indicating the PIV
                                       Secure Messaging key
                                 14. Repeat step 1 with the cryptographic mechanism
                                     identifier value in the data field set to a value that
                                     is not supported by the card.
                                 15. Repeat step 1 with P2 set to a key reference value that
                                     is not supported by the card
 Expected Result(s)              1.  Command returns '69 82' (security status not satisfied).
                                 2.  Command returns '69 82' (security status not satisfied).
                                 3.  Command returns '69 82' (security status not satisfied).
                                 4.  Command returns '69 82' (security status not satisfied).
                                 5.  Command returns '69 82' (security status not satisfied).
                                 6.  The two test invocations referred to in step 2 should return the
                                     same responses as 5a and 5b of Expected Results under test
                                     C.2.4.1.
                                 7. For referenced steps 1 through 5, command returns status word
                                     '90 00' and the data field contains the '7F49' template with the
                                     generated public key, which consists of either a modulus and
                                     public exponent (RSA) or a point (elliptic curve cryptography).
                                 8. The command returns '90 00'
                                 9. The command returns the signed challenge with '90 00' at the
                                     end. Verify the signed challenge using the PIV Authentication
                                     public key that was returned in step 7.
                                 10. The VERIFY command returns '90 00' The GENERAL
                                     AUTHENTICATE command returns the signed data with '90 00'
                                     at the end. Verify the signature using the hash sent to the card
                                     and the digital signature public key that was returned in step 7.
                                 11. For algorithm reference '07' as P1 value, the command returns
                                     the transported key with '90 00' at the end. Compare the
                                     plaintext key to the one received in the response from the card.
                                     For algorithm reference '11' or '14' as P1 value, the command
                                     returns the shared secret Z 18 with '90 00' at the end. Compare
                                     the shared secret computed by the card with shared secret
                                     computed off the card (using the key management public key
                                     that was returned in step 7).
                                 12. The command returns the signed challenge with '90 00' at the
                                     end. Verify the signed challenge using the Card Authentication
                                     public key that was returned in step 7.

18
     Z is the X coordinate of point P as defined in SP 800-56A, Section 5.7.1.2


                                                      C-46
