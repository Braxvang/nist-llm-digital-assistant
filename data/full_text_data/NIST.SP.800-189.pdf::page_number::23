                                                                                             NIST SP 800-189                                                RESILIENT INTERDOMAIN TRAFFIC EXCHANGE:
                                                                                                                                                                    BGP SECURITY & DDOS MITIGATION

                                                                                             4.3   BGP Origin Validation (BGP-OV)

                                                                                             Once an address prefix owner obtains a CA certificate, they can generate an end-entity (EE)
                                                                                             certificate and use the private key associated with the EE certificate to digitally sign a route
                                                                                             origin authorization (ROA) [RFC6482] [RFC6811]. An ROA declares a specific AS as an
                                                                                             authorized originator of BGP announcements for the prefix (see Figure 5). It specifies one or
                                                                                             more prefixes (optionally a maxlength per prefix) and a single AS number. If a maxlength is
                                                                                             specified for a prefix in the ROA, then any more-specific (i.e., longer) prefixes (subsumed under
                                                                                             the prefix) with a length not exceeding the maxlength are permitted to be originated from the
                                                                                             specified AS. In the absence of an explicit maxlength for a prefix, the maxlength is equal to the
                                                                                             length of the prefix itself. If the resource owner has a resource certificate listing multiple
                                                                                             prefixes, they can create one ROA in which some or all those prefixes are listed. Alternatively,
                                                                                             they can create one ROA per prefix.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-189




                                                                                                               Figure 5: Creation of Route Origin Authorization (ROA) by prefix owner

                                                                                             ROAs can also be created (signed) by an ISP (transit provider) on behalf of its customer based
                                                                                             on a service agreement provided that the ISP suballocated the address space to the customer. The
                                                                                             ISP can offer a service to its customers where the ISP creates and maintains CA certificates for
                                                                                             the customers’ resources and ROAs for the customers’ prefixes.

                                                                                             Once created, RPKI data is used throughout the internet by relying parties (RPs). RPs, such as
                                                                                             RPKI-validating servers, can access RPKI data from the repositories (see Figure 6) using either
                                                                                             the rsync protocol [Rsync] [Rsync-RPKI] or the RPKI Repository Delta Protocol (RRDP)
                                                                                             [RFC8182]. The RRDP protocol is often called “delta protocol” as shorthand. A BGP router
                                                                                             typically accesses the required ROA data from one or more RPKI cache servers that are
                                                                                             maintained by its AS. As shown in Figure 6, the RPKI-to-router protocol is used for
                                                                                             communication between the RPKI cache server and the router [RFC6810] [RFC8210]. More
                                                                                             details regarding secure routing architecture based on RPKI can be found in [RFC6480].


                                                                                                                                                12
