                                                                                               NIST SP 800-56B REV. 2                           RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                     USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                               Output:
                                                                                                  m: the plaintext; an integer such that 1 < m < (n – 1), or an error indicator.

                                                                                               7.1.2.3 Decryption with the Private Key in the CRT Format
                                                                                               Function call: RSADP(n, e, d, p, q, dP, dQ, qInv, c)
                                                                                                  1. (n, e, d, p, q, dP, dQ, qInv): the RSA private key, where dP = d mod (p – 1), dQ = d mod
                                                                                                      (q – 1) and qInv = q mod p.
                                                                                                  2. c: the ciphertext; an integer such that 1 < c < (n – 1).
                                                                                               Process:
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                                  1. If the ciphertext c does not satisfy 1 < c < (n – 1), output an indication that the ciphertext
                                                                                                     is out of range, and exit without further processing.
                                                                                                  2. mp = cdP mod p.
                                                                                                  3. mq = cdQ mod q.
                                                                                                  4. Let h = ((mp − mq) × qInv) mod p.
                                                                                                  5. Let m = (mq + (q × h)) mod n.
                                                                                                  6. Output m.

                                                                                               7.2 Encryption and Decryption Operations

                                                                                               7.2.1 RSA Secret-Value Encapsulation (RSASVE)
                                                                                               The RSASVE generate operation is used by one party in a key-establishment transaction to
                                                                                               generate and encrypt a secret value to produce ciphertext using the public key-establishment key
                                                                                               of the other party. When this ciphertext is received by that other party, and the secret value is
                                                                                               recovered (using the RSASVE recover operation and the corresponding private key-establishment
                                                                                               key), the secret value is then considered to be a shared secret. Secret-value encapsulation employs
                                                                                               a Random Bit Generator (RBG) to generate the secret value.
                                                                                               The RSASVE generate and recovery operations specified in Sections 7.2.1.2 and 7.2.1.3,
                                                                                               respectively, are based on the RSAEP and RSADP primitives (see Section 7.1). These operations
                                                                                               are used by the KAS1 and KAS2 key-agreement families (see Sections 8.2 and 8.3).

                                                                                               7.2.1.1 RSASVE Components
                                                                                               RSASVE uses the following components:
                                                                                                  1. RBG:             An approved random bit generator (see Section 5.3).

                                                                                                  2. RSAEP:           RSA Encryption Primitive (see Section 7.1.1).

                                                                                                  3. RSADP:           RSA Decryption Primitive (see Section 7.1.2).




                                                                                                                                                63
