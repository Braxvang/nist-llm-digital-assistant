      NIST SP 800-63C-4 ipd                                             Digital Identity Guidelines
      December 2022                                                     Federation and Assertions


547       • The AAL of the currently active session of the subscriber at the IdP, or an
548         indication that no AAL claim is being made
549       • The FAL of the federated transaction
550   The RP gets this xAL information from a combination of parameters in the trust
551   agreement as described in Sec. 5.1 and information included in the assertion as described
552   in Sec. 6. If the xAL is unchanging for all messages between the IdP and RP, the xAL
553   information SHALL be included in the parameters of the trust agreement between the IdP
554   and RP. If the xAL varies, the information SHALL be included as part of the assertion as
555   discussed in Sec. 6.
556   The IdP MAY indicate that no claim is made to the IAL or AAL for a given federation
557   transaction. In such cases, no default value is assigned to the resulting xAL. That is to
558   say, a federation transaction without an IAL declaration in either the trust agreement or
559   the assertion is functionally considered to have “no IAL” and the RP cannot assume the
560   account meets “IAL1”, the lowest numbered IAL described in this suite.
561   The RP SHALL determine the minimum IAL, AAL, and FAL it is willing to accept for
562   access to any offered functionality. An RP MAY vary its functionality based on the IAL,
563   AAL, and FAL of a specific federated authentication. For example, an RP can allow
564   login at AAL2 for common functionality (e.g., viewing the status of a dam system) but
565   require AAL3 be used for higher risk functionality (e.g., changing the flow rates of a
566   dam system). Similarly, an RP could restrict management functionality to only certain
567   subscriber accounts which have been identity proofed at IAL2, while allowing logins
568   from all subscriber accounts regardless of IAL.
569   In a federation process, only the IdP has direct access to the details of the subscriber
570   account, which determines the applicable IAL, and the authentication event at the IdP,
571   which determines the applicable AAL. Consequently, the RP SHALL consider the IdP’s
572   declaration of the IAL and AAL as the sole source of these levels for a given federated
573   transaction.
574   The RP SHALL ensure that the federation transaction meets the requirements of the FAL
575   declared in the assertion. For example, the RP needs to ensure the presentation method
576   meets the injection protection requirements at FAL2 and above, and that the appropriate
577   bound authenticator is presented at FAL3.
578   IdPs SHALL support a mechanism for RPs to specify a set of minimum acceptable xALs
579   as part of the trust agreement and SHOULD support the RP specifying a more strict
580   minimum set at runtime as part of the federation transaction. When an RP requests a
581   particular xAL, the IdP SHOULD fulfill that request, if possible, and SHALL indicate the
582   resulting xAL in the assertion. For example, if the subscriber has an active session that
583   was authenticated at AAL1, but the RP has requested AAL2, the IdP needs to prompt the
584   subscriber for AAL2 authentication to step up the security of the session at the IdP during


                                                   10
