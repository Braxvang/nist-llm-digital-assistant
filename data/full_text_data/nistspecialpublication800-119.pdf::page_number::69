                                                                GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


work are noted (e.g., multicast with SHIM6 and IPsec).

    4.2.1   IPv6 Multicast Specifications

In addition to providing an essential part of the IPv6 infrastructure, multicast applications include
groupware, multimedia distribution, searching, routing, database replication, grid computing, and real-
time information delivery.

With IPv6, multicast addresses have scope ranging from a single interface or link to the global Internet.
They can be permanently assigned and well-known, as in the examples above, or they can be used
transiently for specific purposes.

RFC 4291, IP Version 6 Addressing Architecture, defines a multicast address as: ―An identifier for a set
of interfaces (typically belonging to different nodes). A packet sent to a multicast address is delivered to
all interfaces identified by that address.‖ Normally, these are the addresses that have previously joined a
given multicast group. The Multicast Listener Discovery (MLD) Protocol is the method interfaces use to
join and leave multicast groups, and routers keep track of these groups for each interface on which they
forward packets. Version 2 (MLDv2) (RFC 3810) manages multicast group membership with two
ICMPv6 message types:

    Multicast Listener Query (Type = 130)

    Version 2 Multicast Listener Report (Type = 143).
MLDv2 is backward compatible with MLDv1 (RFC 2710), so MLDv2 also supports:

    Version 1 Multicast Listener Report (Type = 131)

    Version 1 Multicast Listener Done (Type = 132).
All of these messages are sent with a link-local IPv6 source address (or the unspecified source address if
necessary), an IPv6 Hop Limit of 1, and an IPv6 Router Alert option (RFC 2711) in a Hop-by-Hop
Options header. (The Router Alert option forces routers to examine MLD messages sent to IPv6
multicast addresses in which the routers themselves previously had no interest.)

How routers actually implement multicast depends on the Layer 2 networking technology. It is trivial on
point-to-point links; it may be implemented by using promiscuous mode on link layers with a natural
broadcast capability; or it may require Layer 2 protocol logic on non-broadcast multi-access link layers.

The biggest change introduced in MLDv2 is Source Specific Multicast. MLDv2 allows an interface to
specify, for each multicast address, from which source addresses it does or does not want to receive
packets.

RFC 4604 updates MLDv2 and describes source-specific multicast for IPv4 (IGMPv3) and IPv6
(MLDv2) in a single document.

As stated above, IPv6 multicast addresses are easy to recognize. They are exactly the addresses
beginning with eight 1 bits or hexadecimal FF:

            |   8    | 4 | 4 |                    112 bits
            +--------+----+----+--------------------------------/.../---------+
            |11111111|flgs|scop|                  group ID                    |
            +--------+----+----+--------------------------------/.../---------+



                                                    4-6
