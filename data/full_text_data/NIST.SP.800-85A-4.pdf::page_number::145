NIST SP 800-85A-4                                       PIV CARD APPLICATION & MIDDLEWARE
                                                                 INTERFACE TEST GUIDELINES

C.3.1.4        Virtual Contact Interface
 Purpose               Validates that the PUT DATA command cannot be issued through
                       the VCI.
 Reference(s)          1. SP 800-73-4 Part 2, Table 2
                       2. AS05.03
 Precondition(s)       1. The existing values of all data objects have been recorded.
                       2. The IUT is placed within the reading range of the contactless
                          reader.
                       3. There exists a valid PC/SC connection between the test system
                          and the contactless reader.
                       4. No other contactless card is within the proximity of the reader.
                       5. The PIV Card Application is the currently selected application on
                          the card.
                       6. There exists a valid VCI connection to the card.
 Test Scenario         Repeat steps 1-17 of C.3.1.1 using the '0C' CLA byte
 Expected Result(s) The commands return an error status word for referenced steps 1-17.
 Postcondition(s)      The data container values remain unchanged.


C.3.2        GENERATE ASYMMETRIC KEY PAIR command

C.3.2.1        Contact Interface
 Purpose               Validates that the card executes the GENERATE ASYMMETRIC
                       KEY PAIR command for the following conditions:
                       1. Without the security condition satisfied.
                       2. After the security condition (authenticating with the PIV Card
                           Application Administrator) is satisfied.
 Reference(s)          1. SP 800-73-4, Section Part 2, 3.3.2
                       2. AS05.01, AS05.38 through AS05.40
 Precondition(s)       1. The IUT is inserted into the contact reader.
                       2. There exists a valid PC/SC connection between the test system
                          and the contact reader.
                       3. The PIV Card Application is the currently selected application on
                          the card.
                       4. The mutual authentication of PIV Card Application and the Test
                          Toolkit Application has not been performed.
 Test Scenario         1.  Send GENERATE ASYMMETRIC KEY PAIR card command with
                          •  P2 is set to value '9A'
                          •  Data field in the command is to include either '07' or
                             '11' as the cryptographic mechanism identifier
                       2. Send GENERATE ASYMMETRIC KEY PAIR card command with
                          • P2 is set to value '9C'
                          • Data field in the command is to include either '07',
                             '11', '14' as the cryptographic mechanism identifier



                                      C-44
