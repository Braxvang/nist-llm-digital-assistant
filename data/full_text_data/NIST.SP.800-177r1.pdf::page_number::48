                                                                                               NIST SP 800-177 REV. 1                                                          TRUSTWORTHY EMAIL




                                                                                               Security Recommendation 4-2: Organizations should deploy DNSSEC for all DNS name
                                                                                               servers and validate DNSSEC responses on all systems that receive email.

                                                                                               4.5     DomainKeys Identified Mail (DKIM)

                                                                                               DomainKeys Identified Mail (DKIM) permits a person, role, or organization that owns the
                                                                                               signing domain to claim some responsibility for a message by associating the domain with the
                                                                                               message. This can be an author's organization, an operational relay, or one of their agents. DKIM
                                                                                               separates the question of the identity of the signer of the message from the purported author of
                                                                                               the message. Assertion of responsibility is validated through a cryptographic signature and by
                                                                                               querying the signer's domain directly to retrieve the appropriate public key. Message transit from
                                                                                               author to recipient is through relays that typically make no substantive change to the message
                                                                                               content and thus preserve the DKIM signature. Because the DKIM signature covers the message
                                                                                               body, it also protects the integrity of the email communication. Changes to a message body will
                                                                                               result in a DKIM signature validation failure, which is why some mailing lists (that add footers
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-177r1




                                                                                               to email messages or change Subject header fields) will cause DKIM signature validation
                                                                                               failures (discussed below).

                                                                                               A DKIM signature is generated by the signing MTA using the email message body and headers
                                                                                               and places it in the header of the message along with information for the client to use in
                                                                                               validation of the signature (i.e., key selector, algorithm, etc.). When the receiving MTA gets the
                                                                                               message, it attempts to validate the signature by looking for the public key indicated in the
                                                                                               DKIM signature. �e MTA issues a DNS query for a text resource record (TXT RR) that
                                                                                               contains the encoded key.

                                                                                               Like SPF (see Section 4.4), DKIM allows an enterprise to vouch for an email message sent from
                                                                                               a domain it does not control (as would be listed in the SMTP envelope). �e sender only needs
                                                                                               the private key to generate signatures. �is allows an enterprise to have email sent on its behalf
                                                                                               by an approved third party. �e presence of the public key in the enterprises' DNS implies that
                                                                                               there is a relationship between the enterprise and the sender.

                                                                                               Since DKIM requires the use cryptographic keys, enterprises must have a key management plan
                                                                                               in place to generate, store and retire key pairs. Administrative boundaries complicate this plan if
                                                                                               one organization sends mail on another organization's behalf.

                                                                                               4.5.1    Background

                                                                                               DKIM was originally developed as part of a private sector consortium and only later transitioned
                                                                                               to an IETF standard. �e threat model that the DKIM protocol is designed to protect against was
                                                                                               published as [RFC4686] and assumes bad actors with an extensive corpus of mail messages from
                                                                                               the domains being impersonated, knowledge of the businesses being impersonated, access to
                                                                                               business public keys, and the ability to submit messages to MTAs and MSAs at many locations
                                                                                               across the Internet. �e original DKIM protocol speciﬁcation was developed as [RFC4871],
                                                                                               which is now considered obsolete. �e speciﬁcation underwent several revisions and updates and
                                                                                               the current version of the DKIM speciﬁcation is published as [RFC6376].



                                                                                                                                               35
