                                                                                             NIST SP 800-208                                                                             RECOMMENDATION FOR STATEFUL
                                                                                                                                                                                        HASH-BASED SIGNATURE SCHEMES

                                                                                             8        Conformance

                                                                                             8.1      Key Generation and Signature Generation

                                                                                             Cryptographic modules that implement signature generation for a parameter set shall also
                                                                                             implement key generation for that parameter set. Implementations of the key generation and
                                                                                             signature algorithms in this document shall only be validated for use within hardware
                                                                                             cryptographic modules. The cryptographic modules shall be validated to provide FIPS 140-2 or
                                                                                             FIPS 140-3 [19] Level 3 or higher physical security, and the operational environment shall be
                                                                                             non-modifiable or limited. 8 In addition, a cryptographic module that implements the key
                                                                                             generation or signature algorithms shall only operate in an approved mode of operation and
                                                                                             shall not implement a bypass mode. The cryptographic module shall not allow for the export of
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-208




                                                                                             private keying material. The entropy source for any approved random bit generator [6] used in
                                                                                             the implementation shall be located inside the cryptographic moduleâ€™s physical boundary.
                                                                                             In order to prevent the possible reuse of an OTS key, when the cryptographic module accepts a
                                                                                             request to sign a message, the cryptographic module shall increment the leaf index of the private
                                                                                             key (q in LMS, idx in XMSS, idx_sig in XMSSMT) and shall store the incremented leaf index
                                                                                             value in nonvolatile storage before exporting a signature value or accepting another request to
                                                                                             sign a message. The cryptographic module shall not use an OTS key to generate a digital
                                                                                             signature more than one time. 9
                                                                                             Cryptographic modules that implement LMS key and signature generation shall support at least
                                                                                             one of the LM-OTS parameter sets in Section 4. For each LM-OTS parameter set supported by a
                                                                                             cryptographic module, the cryptographic module shall support at least one LMS parameter set
                                                                                             from Section 4 that uses the same hash function as the LM-OTS parameter set. Cryptographic
                                                                                             modules that implement LMS key and signature generation shall generate random data in
                                                                                             accordance with Section 6.1.
                                                                                             Cryptographic modules that implement XMSS key and signature generation shall implement
                                                                                             Algorithm 10 and Algorithm 12 from [1] for at least one of the XMSS parameter sets in Section
                                                                                             5. (The WOTS+ key generation method specified in Algorithm 10' in Section 7.2.1 shall be
                                                                                             used.) Cryptographic modules that support implementation of XMSSMT key and signature
                                                                                             generation shall implement Algorithm 10' and Algorithm 12' from Section 7.2.1 of this
                                                                                             document for at least one of the XMSSMT parameter sets in Section 5. Cryptographic modules
                                                                                             that implement XMSS or XMSSMT key and signature generation shall generate random data in
                                                                                             accordance with Section 6.2.




                                                                                             8   See Section 4.6 of FIPS 140-2 [19] and Section 7.6 of ISO/IEC 19790.
                                                                                             9   In some implementations of HSS or XMSSMT (e.g., Algorithm 16 in [1]), the root of the LMS or XMSS tree used to create the
                                                                                                 signature is signed by its parent each time a signature is generated. This results in an OTS key being used to generate a digital
                                                                                                 signature more than once. While the OTS key is used more than once, the message being signed is the same, so the result is to
                                                                                                 just recreate the same signature (as long as the randomizer value is the same each time). However, as noted in [9] and [10],
                                                                                                 such implementations are vulnerable to fault injection attacks. Implementations compliant with this publication must sign the
                                                                                                 root of each tree only once. The resulting signature may be stored within the cryptographic module, or it may be exported from
                                                                                                 the cryptographic module for storage elsewhere.


                                                                                                                                                              28
