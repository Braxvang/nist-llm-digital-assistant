NIST SP 800-58                                             Voice Over IP Security
    _________________________________________________________________________

 7.1.1    Stateful Firewalls

         Most VOIP traffic travels across UDP ports. Firewalls typically process such
         traffic using a technique called packet filtering. Packet filtering investigates the
         headers of each packet attempting to cross the firewall and uses the IP addresses,
         port numbers, and protocol type (collectively known as the 5-tuple) contained
         therein to determine the packets’ legitimacy. In VOIP and other media streaming
         protocols, this information can also be used to distinguish between the start of a
         connection and an established connection. There are two types of packet filtering
         firewalls, stateless and stateful. Stateless firewalls retain no memory of traffic
         that has occurred earlier in the session. Stateful firewalls do remember previous
         traffic and can also investigate the application data in a packet. Thus, stateful
         firewalls can handle application traffic that may not be destined for a static port.

 7.1.2    VOIP specific Firewall Needs

         In addition to the standard firewall practices, firewalls are often deployed in VOIP
         networks with the added responsibility of brokering the data flow between the
         voice and data segments of the network. This is a crucial functionality for a
         network containing PC-Based IP phones that are on the data network, but need to
         send voice messages. All voice traffic emanating from or traveling to such
         devices would have to be explicitly allowed in if no firewall was present because
         RTP makes use of dynamic UDP ports (of which there are thousands). Leaving
         this many UDP ports open is an egregious breach of security. Thus, it is
         recommended that all PC-based phones be placed behind a stateful firewall to
         broker VOIP media traffic. Without such a mechanism, a UDP DoS attack could
         compromise the network by exploiting the plethora of open ports. This is one
         example of how firewalls are used to provide a logical segmentation of the
         network, providing a barrier between voice and data sectors. Halpern [23]
         identifies some of the key points of collision between voice and data traffic where
         firewalls are necessary, including:

            •    PC-Based IP phones (data) require access to the (voice) segment to place
                 calls, leave messages, etc.
            •    IP Phones and call managers (voice) accessing voice mail (data),
            •    users (data) accessing the proxy server (voice)
            •    the proxy server (voice) accessing network resources (data).
            •    traffic from IP Phones (voice) to the call processing manager (voice) or
                 proxy server (voice) must pass through the firewall because such contacts
                 use the data segment as an intermediary.

         Halpern [23] provides details for all these connections. Firewalls could also be
         used to broker traffic between physically segmented traffic (one network for
         VOIP, one network for data) but such an implementation is fiscally and physically
         unacceptable for most organizations, since one of the benefits of VOIP is voice
         and data sharing the same physical network.



                                                                                           53
