                                                                                               NIST SP 800-56A Rev. 3                                Recommendation for Pair-Wise Key Establishment
                                                                                                                                                             Using Discrete Logarithm Cryptography

                                                                                               6.3.3.2 C(0e, 2s) Scheme with Unilateral Key Confirmation Provided by Party
                                                                                               V to Party U
                                                                                               Figure_16 depicts a typical flow for a C(0e, 2s) scheme with unilateral key confirmation
                                                                                               from party V to party U. In this situation, party V and party U assume the roles of key-
                                                                                               confirmation provider and recipient, respectively. The successful completion of the key-
                                                                                               confirmation process provides party U with assurance that party V has derived the same
                                                                                               secret Z value; if NonceU is a random nonce, then party U also obtains assurance that party
                                                                                               V has actively participated in the process; see Section 5.4 for a discussion of the length and
                                                                                               security strength required for the nonce.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                                              U                                              V
                                                                                                                             U’s Static Public Key
                                                                                                                                                                    Obtain static public
                                                                                                                             V’s Static Public Key                  keys

                                                                                                                                   NonceU
                                                                                                                                                                    U sends a nonce
                                                                                                                                   MacTagV
                                                                                                                                                                    V’s key confirmation




                                                                                               Figure 16: C(0e, 2s) scheme with unilateral key confirmation from party V to party U
                                                                                               To provide (and receive) key confirmation (as described in Section 5.9.1), both parties set
                                                                                                                        EphemDataV = Null, and EphemDataU = NonceU.
                                                                                               Party V provides MacTagV to party U (as specified in 5.9.1, with P = V and R = U), where
                                                                                               MacTagV is computed (as specified in Section 5.2.1) using
                                                                                                              MacDataV = “KC_1_V” || IDV || IDU || Null || NonceU {|| TextV}.
                                                                                               Party U (the key-confirmation recipient) uses the same format for MacDataV to compute its
                                                                                               own version of MacTagV, and then verifies that the newly computed MacTag matches the
                                                                                               value provided by party V.
                                                                                               Party V shall destroy its copy of MacKey immediately after computing MacTagV. Party U
                                                                                               shall immediately destroy its copy of MacKey after determining whether or not the
                                                                                               received and newly computed MacTagV values match. If they do not match, then party U
                                                                                               shall also destroy the KeyData portion of the DerivedKeyingMaterial (see Section 5.9.1)
                                                                                               and notify party V that MacTagV could not be verified. In this case, party V shall also
                                                                                               destroy the KeyData portion of the DerivedKeyingMaterial.


                                                                                                                                               109
