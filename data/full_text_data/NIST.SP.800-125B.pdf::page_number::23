NIST SP 800-125B                                                     SECURE VIRTUAL NETWORK CONFIGURATION
                                                                                        FOR VM PROTECTION


               VM-based subnet-level virtual firewall does). A special class of NIC-level firewall is a
               distributed firewall (available mostly in solutions providing overlay-based virtual network
               segmentation), which can be used to filter traffic into and out of any VM located in any
               virtualized host in the infrastructure.

4.1       Physical Firewalls for VM Protection

In this early scheme, the inter-VM virtual network traffic inside a virtualized host is routed out of that
virtual network (often called network in the box) on to the physical network (via the pNICs connected to
the uplink ports of the virtual switches to which VM are connected). On this network is installed a
firewall with filtering rules pertaining to traffic flowing out of and into each VM on the virtualized host.
The VLAN traffic emerging out of the virtualized host is inspected by this firewall and is then either
dropped or passed back into the virtual network and on to the target VM.

4.1.1      Advantages

The advantage is leveraging mature, sophisticated firewall rules and other capabilities of physical firewall
technologies.

4.1.2      Disadvantages

The use of physical firewalls for inspection and filtering of virtual network traffic carries a number of
disadvantages, including the following:

      •    The performance penalty due to increased latency involved in routing the virtual network traffic
           to the physical network outside the virtualized host and then back to the virtual network inside the
           virtualized host. This phenomenon is known as hairpinning. The hairpinning route may require
           multiple hops from the pNIC of the virtualized host to the network location of the firewall
           appliance, further increasing latency.
      •    The error-prone manual process involved in maintaining the state information about various VMs
           as the composition of VMs inside a virtualized host changes due to VM migrations.
      •    The physical firewall’s potential lack of integration with the virtualization management system.
           This may hamper the automation of provisioning and the update of firewall rules that may be
           continuously changing because of VM profile changes.
      •    The overhead and latency in shuttling packets back and forth between the firewall and other
           service appliances if the firewall is not rich enough to support those services (e.g., application
           load balancing, policy-based routing).

4.2       Subnet-Level Virtual Firewalls

Virtual firewalls are entirely software-based artifacts, packaged as a virtual security appliance and run on
specially prepared (hardened) VMs. The first generation of virtual firewalls operated in bridge mode –
that is just like their physical counterpart, they can be placed at a strategic location within the network –
in this case the virtual network of a virtualized host. These firewalls can either be stateful or application
firewalls. In addition, many of them offer additional features such as network address translation (NAT),
Dynamic Host Configuration Protocol (DHCP), and site-to-site Internet Protocol Security (IPsec) virtual
private networking (VPN) as well as load balancing for selective protocols such as Transmission Control
Protocol (TCP), Hypertext Transfer Protocol (HTTP), and HTTP over Transport Layer Security
(HTTPS).

                                                        16
