                                                     GUIDE TO INTRUSION DETECTION AND PREVENTION SYSTEMS (IDPS)



4.      Network-Based IDPS

A network-based IDPS monitors network traffic for particular network segments or devices and analyzes
network, transport, and application protocols to identify suspicious activity. This section provides a
detailed discussion of network-based IDPS technologies. First, it contains a brief overview of TCP/IP,
which is background material for understanding the rest of Section 4. Next, it covers the major
components of network-based IDPSs and explains the architectures typically used for deploying the
components. It also examines the security capabilities of the technologies in depth, including the
methodologies they use to identify suspicious activity. The rest of the section discusses the management
capabilities of the technologies and provides recommendations for implementation and operation.

4.1     Networking Overview

TCP/IP is widely used throughout the world to provide network communications. TCP/IP
communications are composed of four layers that work together. When a user wants to transfer data
across networks, the data is passed from the highest layer through intermediate layers to the lowest layer,
with each layer adding more information. The lowest layer sends the accumulated data through the
physical network; the data is then passed up through the layers to its destination. Essentially, the data
produced by a layer is encapsulated in a larger container by the layer below it. The four TCP/IP layers,
from highest to lowest, are shown in Figure 4-1.


          Application Layer. This layer sends and receives data for particular applications, such as
          Domain Name System (DNS), Hypertext Transfer Protocol (HTTP), and Simple Mail Transfer
          Protocol (SMTP).
          Transport Layer. This layer provides connection-oriented or connectionless services for
          transporting application layer services between networks. The transport layer can optionally
          ensure the reliability of communications. Transmission Control Protocol (TCP) and User
          Datagram Protocol (UDP) are commonly used transport layer protocols.
          Internet Protocol (IP) Layer (also known as Network Layer). This layer routes packets
          across networks. IPv4 is the fundamental network layer protocol for TCP/IP. Other commonly
          used protocols at the network layer are IPv6, Internet Control Message Protocol (ICMP), and
          Internet Group Management Protocol (IGMP).
          Hardware Layer (also known as Data Link Layer). This layer handles communications on the
          physical network components. The best known data link layer protocol is Ethernet.

                                            Figure 4-1. TCP/IP Layers



The four TCP/IP layers work together to transfer data between hosts. Network-based IDPSs typically
perform most of their analysis at the application layer. They also analyze activity at the transport and
network layers both to identify attacks at those layers and to facilitate the analysis of the application layer
activity (e.g., a TCP port number may indicate which application is being used). Some network-based
IDPSs also perform limited analysis at the hardware layer. Sections 4.1.1 through 4.1.4 describe each
layer in greater detail.

4.1.1    Application Layer

The application layer enables applications to transfer data between an application server and client. An
example of an application layer protocol is Hypertext Transfer Protocol (HTTP), which transfers data
between a Web server and a Web browser. Other common application layer protocols include Domain
Name System (DNS), File Transfer Protocol (FTP), Simple Mail Transfer Protocol (SMTP), and Simple


                                                        4-1
