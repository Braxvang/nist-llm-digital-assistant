                                                                                               NIST SP 800-56A Rev. 3                                Recommendation for Pair-Wise Key Establishment
                                                                                                                                                             Using Discrete Logarithm Cryptography

                                                                                               Actions: Party V derives secret keying material as follows:
                                                                                                  1. Receive an ephemeral public key tU (purportedly) from party U. If tU is not received,
                                                                                                     then output an error indicator, and exit this process without performing the remaining
                                                                                                     actions.
                                                                                                  2. Verify that tU is a valid ephemeral public key for the parameters D as specified in
                                                                                                     Section 5.6.2.3. If assurance of public key validity cannot be obtained, then output an
                                                                                                     error indicator, and exit without performing the remaining actions.
                                                                                                  3. Use the MQV1 form of the FFC MQV primitive in Section 5.7.2.1.2 to derive a
                                                                                                     shared secret Z from the set of domain parameters D, party V’s static private key xV,
                                                                                                     party U’s static public key yU, party V’s static private key xV (for a second time), party
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                                     V’s static public key yV, and party U’s ephemeral public key tU. If the call to the FFC
                                                                                                     MQV primitive outputs an error indicator, destroy the results of all intermediate
                                                                                                     calculations used in the attempted computation of Z; then output an error indicator,
                                                                                                     and exit this process without performing the remaining actions.
                                                                                                  4. Use the agreed-upon key-derivation method to derive secret keying material with the
                                                                                                     specified length from the shared secret value Z and other input (see Section 5.8). If
                                                                                                     the key-derivation method outputs an error indicator, destroy all copies of Z; then
                                                                                                     output an error indicator, and exit this process without performing the remaining
                                                                                                     action.
                                                                                                  5. Destroy all copies of the shared secret Z and output DerivedKeyingMaterial.
                                                                                               Output: The bit string DerivedKeyingMaterial of length L bits or an error indicator.
                                                                                               Note: Key confirmation can be incorporated into this scheme. See Section 6.2.1.5 for
                                                                                               details.
                                                                                               MQV1 is summarized in Table 17.
                                                                                                                  Table 17: MQV1 key-agreement scheme summary.

                                                                                                                                     Party U                                Party V

                                                                                                Domain                  (p, q, g{, SEED, counter})            (p, q, g{, SEED, counter})
                                                                                                parameters

                                                                                                                        Static private key xU                 Static private key xV
                                                                                                Static data
                                                                                                                        Static public key yU                  Static public key yV

                                                                                                                        Ephemeral private key rU              N/A
                                                                                                Ephemeral data
                                                                                                                        Ephemeral public key tU
                                                                                                                        C




                                                                                                Computation             Compute Z by calling FFC MQV Compute Z by calling FFC MQV
                                                                                                                        using xU, yV, rU, tU, and yV (again) using xV, yU, xV (again), yV, and tU



                                                                                                                                                89
