NIST SP 800-166                                                DERIVED PIV APPLICATION AND
                                                               DATA MODEL TEST GUIDELINES

 Purpose           Verifies that the Derived PIV Application does not change the value of
                   the Derived PIV Application Password when an incorrect PUK is
                   provided.
 DTR(s)            •  DTR-06.02.02.09
                   •  DTR-06.03.01.01
                   •  DTR-06.03.07.02
                   •  DTR-06.03.07.03
                   •  DTR-06.03.07.05
                   •  DTR-06.03.07.06
                   • DTR-06.03.07.07
 Vendor            None.
 Documentation
 Precondition(s)   •   A token with the Derived PIV Application is inserted into an
                       appropriate token reader.
                   •   Suitable drivers have been loaded between the test system and an
                       instance of the reader.
                   •   The Derived PIV Application Password and the PUK are recorded.
                   •   The Derived PIV Application Password’s retry counter is not 0 and
                       the PUK’s retry counter greater than 1.
 Test Scenario     1. Send the SELECT command with
                         • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                   2. Send the VERIFY command with
                         • P2, key reference value, is set to '80'
                         • Data field of the command contains an arbitrary,
                            but correctly formatted, Derived PIV Application
                            Password, padded with 'FF' (as necessary) to
                            complete the total length of the value to 8 bytes
                   3. Send the RESET RETRY COUNTER with
                         • P2, key reference value, is set to '80'
                         • Data field of the command contains an incorrect
                            PUK value concatenated without delimitation with
                            a new valid password value padded with 'FF' to
                            complete the total length of the value to 8
                            bytes.
                   4. Obtain number of remaining retries of the '80' key
                      reference by sending the VERIFY command with
                         • P2, key reference value, is set to '80'
                         • P1 parameter is '00' and both L c and the data
                            field are absent
                   5. Send the RESET RETRY COUNTER with
                         • P2, key reference value, is set to '80'
                         • Data field of the command containing an incorrect
                            PUK value concatenated without delimitation with
                            a new password padded with 'FF' (if necessary) to
                            complete the total length of the value to 8
                            bytes. This operation is repeated until the
                            number of resets allowed is exceeded
                   6. Send the RESET RETRY COUNTER with



                                         80
