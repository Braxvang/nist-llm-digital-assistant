                                                                                               NIST SP 800-56A Rev. 3                                  Recommendation for Pair-Wise Key Establishment
                                                                                                                                                               Using Discrete Logarithm Cryptography

                                                                                                  6. Use the agreed-upon key-derivation method to derive secret keying material with the
                                                                                                     specified length from the shared secret value Z and other input (see Section 5.8). If
                                                                                                     the key-derivation method outputs an error indicator, destroy all copies of Z and the
                                                                                                     ephemeral private key de,U; then output an error indicator, and exit this process
                                                                                                     without performing the remaining actions.
                                                                                                  7. Destroy de,U and all copies of the shared secret Z.
                                                                                                  8.   Output the derived keying material.
                                                                                               Output: The derived keying material or an error indicator.
                                                                                               Note: Key confirmation can be incorporated into this scheme. See Section 6.1.1.5 for details.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                               The Full Unified Model is summarized in Table 10.
                                                                                                              Table 10: Full unified model key-agreement scheme summary

                                                                                                                                     Party U                                 Party V

                                                                                                Domain                  D = (q, FR, a, b{, SEED}, G, n, h) D = (q, FR, a, b{, SEED}, G, n, h)
                                                                                                parameters

                                                                                                Static data             Static private key ds,U                Static private key ds,V
                                                                                                                        Static public key Qs,U                 Static public key Qs,V

                                                                                                Ephemeral data          Ephemeral private key de,U             Ephemeral private key de,V
                                                                                                                        Ephemeral public key Qe,U              Ephemeral public key Qe,V

                                                                                                                        1. Compute Zs by calling ECC 1. Compute Zs by calling ECC
                                                                                                                           CDH using ds,U and Qs,V      CDH using ds,V and Qs,U
                                                                                                Computation             2. Compute Ze by calling ECC 2. Compute Ze by calling ECC
                                                                                                                           CDH using de,U and Qe,V      CDH using de,V and Qe,U
                                                                                                                        3. Compute Z = Ze || Zs                3. Compute Z = Ze || Zs

                                                                                                                        1. Compute                             1. Compute
                                                                                                Derive secret              DerivedKeyingMaterial                  DerivedKeyingMaterial
                                                                                                keying material
                                                                                                                        2. Destroy Z                           2. Destroy Z

                                                                                               6.1.1.3 MQV2, C(2e, 2s, FFC MQV) Scheme
                                                                                               This section describes the MQV2 scheme. Assurance of secure key establishment using this
                                                                                               scheme can only be obtained when the assumptions in Section 6.1.1 are true. In particular, it
                                                                                               is assumed that party U has obtained the static public key yV of party V, and party V has
                                                                                               obtained the static public key yU of party U.
                                                                                               With the exception of key derivation, MQV2 is “symmetric” in the actions of parties U and
                                                                                               V. Only the actions performed by party U are specified here; a specification of the actions

                                                                                                                                                  71
