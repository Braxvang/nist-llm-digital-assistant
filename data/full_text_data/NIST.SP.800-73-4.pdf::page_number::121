Special Publication 800-73-4                               Interfaces for Personal Identity Verification – Part 2:
                                                           PIV Card Application Card Command Interface

A.5.2.1.1 The GENERAL AUTHENTICATE Command

The sequence of commands to perform the ECC CDH primitive from [SP800-56A, Section 5.7.1.2] with
the private ECC KMK is illustrated below for ECC: Curve P-256:

Command – GENERAL AUTHENTICATE

 CLA                 '00'
 INS                 '87'
 P1                  '11'
 P2                  '9D'
 Lc                  Length of data field
                     '7C' – L1 {'82' '00' '85' L2 { '04' || X || Y}} , where
                           •   '04' || X || Y is the other party’s public key, a point on Curve
                               P-256, encoded without the use of point compression as
 Data Field                    described in [SECG, Section 2.3.3].
                           •   The length of each coordinate (X and Y) is 32 bytes and
                           •   The value of L2 is 65 bytes
 Le                  '00'


Response:

                     '7C' – L1 {'82' L2 {shared secret Z}} where
                          •   Z is the X coordinate of point P as defined in [SP800-56A,
 Data Field
                              Section 5.7.1.2]
                          •   L2 is 32 bytes
 SW1-SW2             '90 00' (Status word)


A.5.2.2 PIV KMK Specific ECDH Key Agreement Schemes

SP 800-56A describes five different ECDH key agreement schemes that a client application cryptographic
module may implement. These schemes differ in 1) the number of keys (1 or 2) and 2) the type of keys
(ephemeral or static) used by each party. Since the PIV Card only computes the ECC CDH primitive
using its static private key, the client application cryptographic module only employs the PIV Card in
implementing an ECDH key agreement scheme when the scheme involves the use of the cardholder’s
static key pair. The ECDH key agreement schemes that involve the use of at least one party’s static key
pair, and thus may involve the use of the PIV Card are:

          +   C(2e, 2s) – Each party has a static key pair and generates an ephemeral key pair [SP800-
              56A, Section 6.1.1]
              In this scheme, the information sent between the client application and the PIV Card is the
              same when acting as the initiator or the responder; the other party’s static public key is sent
              to the PIV Card, and a static shared secret is returned by the PIV Card in plaintext. Note
              that an ephemeral key pair is generated by the client application, and the private key of that
              key pair is combined with the other party’s ephemeral public key to produce an ephemeral
              shared secret.
          +   C(1e, 2s) – The initiator has a static key pair and generates an ephemeral key pair, while
              the responder has a static key pair [SP800-56A, Section 6.2.1]



                                                          46
