NIST SP 800-85A-4                                        PIV CARD APPLICATION & MIDDLEWARE
                                                                  INTERFACE TEST GUIDELINES

 Test Scenario        1. Send SELECT card command with
                         • AID == 'A0 00 00 03 08 00 00 10 00 01 00'
                      2. Repeat steps 3, 7b, 8, and 9 of C.2.4.1
                      3. Repeat steps 4 and 6 of C.2.4.1, if the key types
                         specified in the tests are supported
 Expected Result(s)   1. The command returns the application property template with the
                         status word '90 00' at the end.
                      2. Referenced Steps:
                         • Steps 3, 7b, and 8 referenced in C.2.4.1 the command returns
                             '69 82' (security status not satisfied).
                         • Step 9 referenced in C.2.4.1 returns the signed challenge with
                             '90 00' at the end. Verify the signed challenge.
                      3. Referenced Steps:
                         • Step 4 referenced in C.2.4.1 the command returns the
                             encrypted challenge with '90 00' at the end. Decrypt the
                             encrypted challenge and compare it to the one sent to the
                             card.
                         • Step 6 referenced in C.2.4.1 returns '69 82' (security status not
                             satisfied).
                      NOTE: For step 9: If ECDSA with algorithm '11' is used, the response
                      data field contains r and s.
 Postcondition(s)     N/A


C.2.4.3        Secure Messaging Interface
 Purpose              Validates internal authentication and mutual authentication of the
                      PIV Card and the Test Toolkit to ensure that the private keys in use
                      are accessible only through the appropriate interface.
 Reference(s)         3. SP 800-73-4 Part 2, Table 2
                      4. AS05.03, AS05.34, AS05.36A, AS05.36B
 Precondition(s)      1. The IUT is placed within the reading range of the contactless
                          reader.
                      2. There exists a valid PC/SC connection between the test system
                          and the contactless reader.
                      3. No other contactless card is within the proximity of the reader.
                      4. Secure messaging session keys have been established and secure
                          messaging is used in the test scenario.
 Test Scenario        1.  Send SELECT card command with
                           • AID == 'A0 00 00 03 08 00 00 10 00 01 00'
                      2.   Repeat steps 2 and 3 from C.2.4.2 using the '0C' CLA byte
 Expected Result(s)   1. The command returns the application property template with the
                         status word '90 00' at the end.
                      2. The referenced commands return the same expected results as in
                         C.2.4.2.



                                      C-38
