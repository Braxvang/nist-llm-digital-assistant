Special Publication 800-85B                                   PIV Data Model Testing Specification


10.4.2.6 Verify Digest Algorithm in SignerInfo

Purpose               Confirm that the digestAlgorithm field of the SignerInfo is in accordance
                      with Table 3-7 of SP80078.
Reference(s)          1.      AS06.04.09
Precondition          1.      A valid PIV card is inserted into the contact reader.
                      2.      A valid PC/SC connection exists between the test application and the
                              contact reader.
                      3.      The test application is currently connected to the card application
                              which is accessible through card handle.
                      4.      A valid security object is present on the PIV card.
                      5.      A valid CHUID is present on the PIV card.
Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<Security Object
                         (2.16.840.1.101.3.7.2.144.0)>>
                      3. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      4. Extract the SignerInfo->digestAlgorithm field from the
                         security object
                      5. Set OID := <<CHUID (2.16.840.1.101.3.7.2.48.0)>>
                      6. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      7. Extract the expiration date value from the CHUID (i.e.
                          Tag 0x35)
                      8. Extract the certificates field contents from the
                          asymmetric signature of the CHUID
                      9. From the certificate obtained (from the CHUID signature
                          field), extract the subjectPublicKeyInfo-
                          >subjectPublicKey
                      10. Compute the size of the signer’s public key
                      11. Match the digest algorithm obtained from step 4 with
                          Table 3-7 of SP80078 based on the card expiration date,
                          and the public key algorithm and size used to sign the
                          security object
                      12. Extract the digestAlgorithms field contents from the
                          security object’s SignedData
Expected              The digestAlgorithm field value of the SignerInfo is in accordance with
Result(s)             Table 3-7 of SP80078 and it matches the value present in the
                      digestAlgorithms field of the SignedData.




                                                                                                Page 111
