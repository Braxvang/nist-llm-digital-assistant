NIST SP 800-166                                                   DERIVED PIV APPLICATION AND
                                                                  DATA MODEL TEST GUIDELINES

                         3. From Step 5, the command returns the Discovery Object and/or
                            Key History Object.
                         4. From Step 6, the actual hashes of the data objects extracted in
                            Step 5 are identical to their corresponding hash values present
                            in the Security Object.

9.2.1.2 Presence of CMS SignedData

 Test Assertion          TA-09.02.01.02
 Purpose                 Verifies that the Security Object contains an asymmetric digital
                         signature, implemented as a SignedData type in accordance with
                         [RFC5652].
 DTR(s)                  • DTR-07.02.01.02
                         • DTR-07.02.01.03
 Issuer Documentation    None.
 Precondition(s)         • A token with the Derived PIV Application is inserted into an
                             appropriate token reader.
                         • Suitable drivers have been loaded between the test system and
                             an instance of the reader.
                         • A Security Object is present within the Derived PIV
                             Application.
 Test Scenario           1. Send the SELECT command with
                               • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                         2. Send the GET DATA command with
                               • Data field of the command containing the tag
                                  ('5FC106') of the Security Object
                         3. Parse the obtained Security Object and extract the
                            contents from the asymmetric digital signature
                            field (i.e., tag 0xBB)
                         4. Process the contents of the digital signature
 Expected Result(s)      1. From Step 1, the command returns the application property
                            template with the status word '90 00'.
                         2. From Step 2, the command returns the requested data object
                            along with the status word '90 00'.
                         3. From Step 4, the content of the digital signature is an object
                            that is a SignedData type which is in accordance with
                            [RFC5652].

9.2.1.3 SignedData Version

 Test Assertion          TA-09.02.01.03
 Purpose                 Verifies that the version of the SignedData content type is v3.
 DTR(s)                  • DTR-07.02.01.04
 Issuer Documentation    None.
 Precondition(s)         • A token with the Derived PIV Application is inserted into an
                            appropriate token reader.


                                          96
