                                NIST SP 800-135, Revision 1



The hash-based KDFs in ANS X9.42-2001 and ANS X9.63-2001 are approved when
the following conditions are satisfied:
      (1) Each of the hash-based KDFs is performed in the context of an ANS X9.42-
          2001 or ANS X9.63-2001 key agreement scheme.
      (2) The hash function is one of the hash functions specified in FIPS 180-3.
      (3) The hash function deployed in the hash-based KDF meets the security
          strength(s) required by the cryptographic function(s) for which the keying
          material is being generated. The security strengths of approved hash
          functions used in KDFs can be found in SP 800-57 [SP 800-57].
Note that any KDF that meets the specification of either the ANS X9.42-2001 or
ANS X9.63-2001 hash-based KDF and is used in a scheme specified in one of these
two Standards is approved when conditions (2) and (3) above are met. For example,
the KDF specified in Section 2.1.2 (Generation of Keying Material) of RFC 2631 and
the KDF (specified in [SEC1]) used in RFC 3278 are approved.

5.2      Secure Shell (SSH) Key Derivation Function
SSH is a protocol used between clients and servers for secure remote login and other
secure network services over an insecure network or the Internet. The Internet
Engineering Task Force (IETF) governs the SSH protocol (see RFC 4251). The SSH
protocol consists of three major components: the Transport Layer Protocol (RFC
4253 [RFC 4253]), the User Authentication Protocol (RFC 4252 [RFC 4252]) and the
Connection Protocol (RFC 4254 [RFC 4254]). The Transport Layer Protocol provides
server authentication, confidentiality, and integrity.

Output from a key exchange 6 (see Section 7.2 of RFC 4253) in the Transport Layer
Protocol is a shared secret, “K”, and a hash value, “H”. In the protocol, K, H and a
specific set of other non-secret values are input to a hash function-based KDF to
derive keying material. Different KDFs produce keying material for different
cryptographic functions; however, the KDFs are similar (see below). The
specifications for the KDFs in the Transport Layer Protocol can be found in Section
7.2 of RFC 4253.

The following is a description of the KDF used to derive a key, where HASH denotes
a hash function, such as SHA-1 as specified in FIPS 180-3. The key to be derived is
denoted by KEY, and the length of KEY is denoted by L. The length of the hash
function output is denoted by HASH_Length.

N = L Hash _ Length 

X is a character, such as A, B, C, D, E or F, depending on the type of key desired.

6
  The key exchange method specified for the protocol is one of the key agreement primitives described
in SP 800-56A.


                                                 13
