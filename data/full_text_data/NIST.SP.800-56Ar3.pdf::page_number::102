                                                                                               NIST SP 800-56A Rev. 3                                   Recommendation for Pair-Wise Key Establishment
                                                                                                                                                                Using Discrete Logarithm Cryptography

                                                                                                  1. Receive an ephemeral public key Qe,U (purportedly) from party U. If Qe,U is not
                                                                                                     received, then output an error indicator, and exit this process without performing the
                                                                                                     remaining actions.
                                                                                                  2. Verify that Qe,U is a valid ephemeral public key for the parameters D as specified in
                                                                                                     Section 5.6.2.3.2 or 5.6.2.3.3. If assurance of public key validity cannot be obtained,
                                                                                                     then output an error indicator, and exit without performing the remaining actions.
                                                                                                  3. Use the One-Pass MQV form of the ECC MQV primitive in Section 5.7.2.3.2 to
                                                                                                     derive a shared secret value Z from the set of domain parameters D, party V’s static
                                                                                                     private key ds,V, party U’s static public key Qs,U, party V’s static private key ds,V (for a
                                                                                                     second time), party V’s static public key Qs,V, and party U’s ephemeral public key
                                                                                                     Qe,U. If the call to the ECC MQV primitive outputs an error indicator, destroy the
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                                     results of all intermediate calculations used in the attempted computation of Z; then
                                                                                                     output an error indicator, and exit this process without performing the remaining
                                                                                                     actions.
                                                                                                  4. Use the agreed-upon key-derivation method to derive secret keying material with the
                                                                                                     specified length from the shared secret value Z and other input (see Section 5.8). If
                                                                                                     the key-derivation method outputs an error indicator, destroy all copies of Z; then
                                                                                                     output an error indicator, and exit this process without performing the remaining
                                                                                                     action.
                                                                                                  5. Destroy all copies of the shared secret Z and output the derived keying material.
                                                                                               Output: The derived keying material or an error indicator.
                                                                                               Note: Key confirmation can be incorporated into this scheme. See Section 6.2.1.5 for
                                                                                               details.
                                                                                               The One-Pass MQV scheme is summarized in Table 18.
                                                                                                          Table 18: One-pass MQV model key-agreement scheme summary

                                                                                                                                      Party U                                  Party V

                                                                                                Domain                  (q, FR, a, b{, SEED}, G, n, h)          (q, FR, a, b{, SEED}, G, n, h)
                                                                                                parameters

                                                                                                                        Static private key ds,U                 Static private key ds,V
                                                                                                Static data
                                                                                                                        Static public key Qs,U                  Static public key Qs,V

                                                                                                Ephemeral data          Ephemeral private key de,U              N/A
                                                                                                                        Ephemeral public key Qe,U

                                                                                                                        Compute Z by calling ECC MQV Compute Z by calling ECC MQV
                                                                                                Computation             using ds,U, Qs,V, de,U, Qe,U, and Qs,V using ds,V, Qs,U, ds,V (again), Qs,V, and
                                                                                                                        (again)                                Qe,U



                                                                                                                                                  91
