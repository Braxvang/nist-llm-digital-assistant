                                                                GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


Better security for tunnels is available if both endpoints are under the same administrative control or have
a trust relationship sufficient to set up cryptographic security. RFC 4891, Using IPsec to Secure IPv6-in-
IPv4 Tunnels, explains the easiest way to set up IPsec ESP to secure IPv6 over IPv4 encapsulation.

RFC 4213, Basic Transition Mechanisms for IPv6 Hosts and Routers, recommends sending the same
response as for ―destination unreachable‖ when dropping a packet for security reasons. Otherwise, an
attacker could probe for the existence of the tunnel endpoint in preparation for other attacks.

The following sections address specific deployment and security issues for various tunneling
mechanisms. Section 6.5.2 covers configured tunneling of IPv6 over IPv4. Automatic tunneling
mechanisms in general are discussed in Section 6.5.3, following by detailed discussions of various
automatic tunneling mechanisms in Sections 6.5.4 through 6.5.10.

  6.5.2   Configured Tunneling

Configured tunnels establish connections before traffic using the tunnel arrives. Configured tunnels are
set up and maintained by network administrators. Establishing remote endpoints outside the organization
may require peering agreements and may not use optimal paths between peering sites. The general model
for configured tunnels is to set them up and use them router-to-router for regular traffic between sites.

6.5.2.1     Using Configured Tunnels

Configured tunnels provide a straightforward way to use the IPv4 routing and forwarding infrastructure to
carry IPv6 traffic to IPv6 islands. RFC 4213 further describes configured tunnels. This document
contains details about maintaining state information at the tunnel endpoints, constructing the IPv4
encapsulation, handling MTUs and fragmentation, running neighbor discovery through a tunnel, and
dealing with ICMPv4 (Internet Control Message Protocol for IPv4) error messages.

For instance, in tunneling with IPv6 over IPv4 using protocol 41, the endpoint routers at both ends of a
configured tunnel are provided with the four parameters defining the tunnel (IPv4 and IPv6 source and
destination addresses of both endpoints). Commonly, IPv6 traffic on a link reaches a default router that
serves as the endpoint of a configured tunnel and knows how to use IPv4 as the next hop to forward the
IPv6 traffic. The tunnel will not work if protocol 41 is blocked (e.g., filtered by NAT devices).
Configured tunnels can also tunnel IPv4 over IPv6. Tunnels may use GRE encapsulation or MPLS
instead of protocol 41.

Using configured tunnels does not scale well, because of the need to set up and maintain each one
manually. However, configured tunnels provide a much greater degree of control than using automatic
tunneling.

6.5.2.2     Security Considerations for Configured Tunnels

General security considerations for tunneling are covered in Section 6.5.1 and in RFC 4942. The
following points apply to security for configured tunnels:

        After decapsulation, packets with a multicast, loopback, IPv4 compatible or IPv4 mapped
         source address must be discarded. Apply normal ingress filtering, which may require
         manually maintaining IPv6 prefix lists.
        The tunnel endpoints must be configured to allow the encapsulated packet to get through any
         instances of security policy enforcement: packet filters, application layer gateways, intrusion
         detection or prevention systems, and so forth.


                                                    6-15
