                                                                                             NIST SP 800-90B                                                           RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                               USED FOR RANDOM BIT GENERATION

                                                                                                       detected by the developer-defined continuous tests. This evidence may be a proof or the
                                                                                                       results of statistical simulations.
                                                                                                  c. The continuous tests may include additional tests defined by the developer.
                                                                                             2. When the health tests fail, the entropy source shall notify the consuming application (e.g., the
                                                                                                RBG) of the error condition. The developer may have defined different types of failures (e.g.,
                                                                                                intermittent and persistent), and the application is allowed to react differently to different types
                                                                                                of failures (e.g., by inhibiting output for a short time). The developer is allowed to define
                                                                                                different cutoff values to detect intermittent and persistent failures. If so, these values (with
                                                                                                corresponding false alarm probabilities) shall be specified in the submission documentation.
                                                                                                If the entropy source detects intermittent failures and allows the noise source to return to
                                                                                                normal functioning, the designer shall provide evidence that: a) The intermittent failures
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                                handled in this way are indeed extremely likely to be intermittent failures; and b) the tests will
                                                                                                detect a permanent failure when one occurs, and will ultimately signal an error condition to
                                                                                                the consuming application and cease operation. In the case where a persistent failure is
                                                                                                detected, the entropy source shall not produce any outputs. The module may support being
                                                                                                reset or returned to operation by the consuming application or system. (An example of a
                                                                                                situation where this would make sense is a remote system whose cryptographic module cannot
                                                                                                be replaced quickly, but which must continue functioning.)
                                                                                             3. The optimal value for the false positive probability may depend on the rate that the entropy
                                                                                                source produces its outputs. For the approved continuous health tests, the false positive
                                                                                                probability8 is recommended to be between 2−20 and 2−40. Lower probability values are
                                                                                                acceptable. The submitter shall specify and document a false positive probability suitable for
                                                                                                their application.
                                                                                             4. The entropy source's startup tests shall run the continuous health tests over at least 1024
                                                                                                consecutive samples. The startup tests may include other tests defined by the developer. The
                                                                                                samples subjected to startup testing may be released for operational use after the startup tests
                                                                                                have been passed, or may be discarded at any time.
                                                                                             5. The entropy source shall support on-demand testing. The on-demand tests shall include at
                                                                                                least the same testing done by the start-up tests. The entropy source may support on-demand
                                                                                                testing by restarting the entropy source and rerunning the startup tests, or by rerunning the
                                                                                                startup tests without restarting the entropy source. The documentation shall specify the
                                                                                                approach used for on-demand testing. The on-demand tests may include other tests defined by
                                                                                                the developer, in addition to the testing done in the start-up tests.
                                                                                             6. Health tests shall be performed on the noise source samples before any conditioning is done.
                                                                                                Additional health tests may be performed on the outputs of the conditioning function.
                                                                                             7. The submitter shall provide documentation that specifies all entropy source health tests and
                                                                                                their rationale. The documentation shall include a description of the health tests, source code,
                                                                                                the rate and conditions under which each health test is performed (e.g., at power-up,



                                                                                             8 Having a high false positive probability and discarding the outputs when the test raises an alarm may result in a reduction in the

                                                                                             entropy of the outputs. For the recommended range, the loss can be considered negligible.


                                                                                                                                                             24
