                                                                                               NIST SP 800-56B REV. 2                              RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                        USING INTEGER FACTORIZATION CRYPTOGRAPHY




                                                                                               Appendix C: Prime-Factor Recovery (Normative)
                                                                                               Two methods for prime-factor recovery are provided below: Appendix C.1 provides a probabilistic
                                                                                               method, and Appendix C.2 provides a determinitic method. Prime-factor recovery is required
                                                                                               during key-pair validation using the basic format (see Section 6.4.1.2.1).

                                                                                               C.1 Probabilistic Prime-Factor Recovery
                                                                                               The following algorithm recovers the prime factors of a modulus, given the public and private
                                                                                               exponents. The algorithm is based on Fact 1 in [Boneh 1999].
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                               Function call: RecoverPrimeFactors(n, e, d)
                                                                                               Input:
                                                                                                  1. n: modulus.

                                                                                                  2. e: public exponent.

                                                                                                  3. d: private exponent.

                                                                                               Output:
                                                                                                 1. (p, q): prime factors of modulus.

                                                                                               Errors: “prime factors not found”
                                                                                               Assumptions: The modulus n is the product of two prime factors p and q; the public and private
                                                                                               exponents satisfy de ≡ 1 (mod λ(n)) where λ(n) = LCM(p – 1, q – 1).
                                                                                               Process:
                                                                                                  1. Let m = de – 1. If m is odd, then go to Step 4.
                                                                                                  2. Write m as m = 2tr, where r is the largest odd integer dividing m, and t ≥ 1.
                                                                                                  3. For i = 1 to 100 do:
                                                                                                           a. Generate a random integer g in the range [0, n−1].
                                                                                                           b. Let y = gr mod n.
                                                                                                           c. If y = 1 or y = n – 1, then go to Step g.
                                                                                                           d. For j = 1 to t – 1 do:
                                                                                                                  i.    Let x = y2 mod n.
                                                                                                                 ii.    If x = 1, go to Step 5.
                                                                                                                iii.    If x = n – 1, go to Step g.
                                                                                                                iv.     Let y = x.
                                                                                                           e. Let x = y2 mod n.
                                                                                                                                                  111
