                                               GUIDE TO INTEGRATING FORENSIC TECHNIQUES INTO INCIDENT RESPONSE



      ! Internet Service Provider Records. ISPs may collect network traffic-related data as part of
        their normal operations and when investigating unusual activity, such as extremely high volumes
        of traffic or an apparent attack. Usual ISP records often might be kept only for days or hours.
        Section 6.3.1 discusses legal considerations involved in collecting network traffic data from ISPs
        and other third parties.
      ! Client/Server Applications. Some client/server applications used over networks may record
        information regarding successful and failed usage attempts, which could include connection-
        related data such as the client’s IP address and port. The data fields recorded (if any) vary widely
        among applications.
      ! Hosts’ Network Configurations and Connections. Sections 5.1.2 and 5.2.1 describe the types
        of network information that can be collected from individual hosts, including the TCP and UDP
        ports at which a host is listening.
6.3     Collecting Network Traffic Data

As described in Section 6.2, organizations typically have network traffic data recorded in many places
during normal operations. Organizations also use the same data recording mechanisms to collect
additional data on an as-needed basis when investigating incidents or troubleshooting problems. For
example, a network administrator or incident handler might deploy a packet sniffer to examine unusual
packets sent by a host.

Network traffic data is usually recorded to a log or stored in a packet capture file. In most cases,
collecting the data is as simple as collecting the logs and packet capture files. Section 4 describes how to
collect files in an appropriate manner for evidentiary purposes. If data is not stored in a file (e.g., traffic
flow map displayed graphically, data displayed on the console screen only), screen captures or
photographs of the screen might be needed. Although collecting network traffic data is typically
straightforward, there are several important legal and technical issues that can make data collection more
complicated.

6.3.1     Legal Considerations

Collecting network traffic can pose legal issues. Among these issues is the capture (intentional or
incidental) of information with privacy or security implications, such as passwords or the contents of e-
mails. This could expose the information to the staff members who are analyzing the collected data or
administering the recording systems (e.g., IDS sensors). Organizations should have policies in place
regarding the handling of inadvertent disclosures of sensitive information. Another problem with
capturing data such as e-mails and text documents is that long-term storage of such information might
violate an organization’s data retention policy. It is also important to have policies regarding the
monitoring of networks and to have warning banners on systems that indicate that activity may be
monitored.

Although most network traffic data collection occurs as part of regular operations, it can also occur as part
of troubleshooting or incident handling. In the latter case, it is important to follow consistent processes
and to document all actions performed. For example, recording all packets sent and received by a
particular user should be initiated only after the successful completion of a formal request and approval
process. Organizations should have policies that clearly explain what types of monitoring can and cannot
be performed without approval, and that describe or reference the procedures that detail the request and
approval process.




                                                      6-9
