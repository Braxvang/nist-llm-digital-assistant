                                      NIST Special Publication 800-38F



For TKW, an analogue of the above analysis applies, adapted to the smaller semiblock size.

The length of the ciphertext affects the probability that some set of indices will satisfy the
collision conditions. One can estimate this probability for a fixed value of m by modeling some
of the individual collisions as independent events that occur with probability 2-64. In particular,
beginning at index 6m, one considers the probability of individual collisions as follows:

      • At index j, if Aj ≠ Bj, or if j < m, one next considers the index j-1.
      • At index j, if Aj = Bj and j > m, one next considers the index j-m-1.

This procedure will consider exactly m indices; if it identifies collisions at six or more indices,
then the first six collisions will satisfy the collision conditions. Conversely, if there are six
indices that satisfy the collision conditions, then this procedure will identify collisions at six or
more indices. Consequently, for KW, the probability, P, that the forgery attack succeeds in this
model is

                                                m −i                                     m −i
                       m  1   2 64 − 1                    m  1   2 64 − 1 
                  5             i                         m              i

        P = 1 − ∑   64   64                  = ∑   64   64                  .
                i = 0  i  2  2                     i = 6  i  2  2         

If 264/m is sufficiently large, then only the first term is significant, so that

                          6
            1  m 
        P≈    ⋅       .
           720  2 64 

Consequently, if m < 254, as required in Sec. 5.3.1, then P < 2-64.

For TKW, the analogous conclusion is that if m < 228, as required in Sec. 5.3.1, then P < 2-32.

A.5      Additional Analysis
Within [10], Rogaway and Shrimpton provide an analysis of AESKW as specified in [2], much
of which also applies to the key-wrap variants in this Recommendation. Among other criticisms,
the authors emphasize the lack of a proof that the underlying structure of KW meets the goal of
deterministic authenticated encryption that they formalize in the paper. Nevertheless, the authors
expect that the AES Key Wrap achieves this property, possibly even in a particularly strong
manner, i.e., with “beyond-birthday-phenomenon security.”




                                                                21
