       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management


989    In order to provide replay resistance as described in Sec. 5.2.8, verifiers SHALL accept a
990    given OTP only once while it is valid. In the event a claimant’s authentication is denied
991    due to duplicate use of an OTP, verifiers MAY warn the claimant in case an attacker has
992    been able to authenticate in advance. Verifiers MAY also warn a subscriber in an existing
993    session of the attempted duplicate use of an OTP.
994    Time-based OTPs [TOTP] SHALL have a defined lifetime that is determined by the
995    expected clock drift — in either direction — of the authenticator over its lifetime, plus
996    allowance for network delay and user entry of the OTP.
997    If the authenticator output has less than 64 bits of entropy, the verifier SHALL implement
998    a rate-limiting mechanism that effectively limits the number of failed authentication
999    attempts that can be made on the subscriber account as described in Sec. 5.2.2.

1000   5.1.5. Multi-Factor OTP Devices
1001   A multi-factor OTP device generates OTPs for use in authentication after activation
1002   through input of an activation factor. This includes hardware devices and software-
1003   based OTP generators installed on devices such as mobile phones. The second factor
1004   of authentication may be achieved through some kind of integral entry pad, an integral
1005   biometric (e.g., fingerprint) reader, or a direct computer interface (e.g., USB port). The
1006   OTP is displayed on the device and manually input for transmission to the verifier. For
1007   example, an OTP device may display 6 characters at a time, thereby proving possession
1008   and control of the device. The multi-factor OTP device is something you have, and it
1009    SHALL be activated by either something you know or something you are.


1010   5.1.5.1. Multi-Factor OTP Authenticators
1011   Multi-factor OTP authenticators operate in a similar manner to single-factor OTP
1012   authenticators (see Sec. 5.1.4.1), except that they require the presentation and verification
1013   of either a memorized secret or a biometric characteristic to obtain the OTP from the
1014   authenticator. Each use of the authenticator SHALL require the input of the activation
1015   factor.
1016   In addition to activation information, multi-factor OTP authenticators contain two
1017   persistent values. The first is a symmetric key that persists for the device’s lifetime. The
1018   second is a nonce that is either changed each time the authenticator is used or is based on
1019   a real-time clock.
1020   The secret key and its algorithm SHALL provide at least the minimum security
1021   strength specified in the latest revision of [SP800-131A] (112 bits as of the date of this
1022   publication). The nonce SHALL be of sufficient length to ensure that it is unique for each
1023   operation of the device over its lifetime. If a subscriber needs to change the device used
1024   for a software-based OTP authenticator, they SHOULD bind the authenticator application



                                                    25
