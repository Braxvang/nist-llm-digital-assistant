                                                                           GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


 Router renumbering
This section defines and discusses two cryptographic security mechanisms for autoconfiguration and
ND—IPsec and SEND.

 Alternative methods for providing security to ND communications include: 802.1X45, IEEE macsec46,
and an IETF layer 2 solution called RA-Guard47.

     5.4.1   Using IPsec to Secure Autoconfiguration and ND

IPsec can, in principle, be used to secure any IP packet, but deciding how IPsec should cover all of the
different types and uses of ICMPv6 messages and actually specifying this behavior are not simple tasks.
Certain ICMPv6 messages are used with mobility or multicast; others, such as the following, report error
conditions or simply provide information:

 Destination unreachable
 Packet too big (also used to determine PMTU)
 Time exceeded
 Parameter problem
 Echo request
 Echo reply.
These are not used in autoconfiguration or ND; securing these messages is covered in Section 3.5.2 and
3.5.3. This section covers:

 NS and NA messages used in stateless address autoconfiguration (SLAAC) and Duplicate Address
  Detection (DAD)
 RS and RA messages used for router and prefix discovery
 NS and NA messages used for address resolution and reachability detection
 Redirect and router renumbering messages sent by routers.
These messages use a variety of types of addressing. Most of them use a unicast source address, but
autoconfiguration RS and NS messages also use the unspecified all-zero address (::). Both unicast and
multicast destination addresses are used.

RFCs 2461 and 2462 (which have now been replaced by RFC 4861 and RFC 4862, respectively) suggest
that IPsec AH SAs be used to secure these messages. No specific attention was given to what SAs are
needed, how they are established, or how they work (or do not work) with IPsec’s key management
protocols (IKEv1 and later IKEv2). Subsequent attempts to use this mechanism ran into problems:




45
      IEEE 802.1X.
46
      IEEE 802.1AE. See also MACSec: A Security Solution that Protects LANS from Internal Threats.
47
      See the current version of the IETF Internet Draft, IPv6 Router Advertisement Guard, Work in Progress.


                                                             5-18
