                                                                                               NIST SP 800-56B REV. 2                                 RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                           USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                               destruction of these locally stored values shall occur prior to or during any exit from the routine
                                                                                               (whether exiting early because of an error, or exiting normally).

                                                                                               6.4.1.2.3   rsakpv1-crt
                                                                                               rsakpv1-crt is the key-pair validation method corresponding to rsakpg1-crt.
                                                                                               Function call: rsakpv1-crt (s, nBits, efixed, (npub, epub), (npriv, epriv, d, p, q, dP, dQ, qInv))
                                                                                               The inputs, outputs and errors are the same as in rsakpv1-basic (see Section 6.4.1.2.1) except that
                                                                                               the private key is in the Chinese Remainder Theorem format: (npriv, epriv, d, p, q, dP, dQ, qInv).
                                                                                               The steps are the same as in rsakpv1-basic except that in processing:
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                                   A. Step 2 is replaced by the following:
                                                                                                           2. Compare the public exponents:
                                                                                                                If (epub ≠ efixed) or (epub ≠ epriv), output an indication of an invalid key pair, and exit
                                                                                                                without further processing.
                                                                                                   B. Step 3 is replaced by
                                                                                                           3. Check the modulus:
                                                                                                                    a. If npub ≠ p × q, or npub ≠ npriv, output an indication of an invalid key pair, and
                                                                                                                       exit without further processing.
                                                                                                                    b. If len(npub) ≠ nBits, output an indication of an invalid key pair, and exit
                                                                                                                       without further processing.
                                                                                                                    c. If nBits is not a positive even integer, output an indication of an invalid key
                                                                                                                       pair, and exit without further processing.
                                                                                                   C. Step 4 (prime-factor recovery) is omitted (i.e., not used),
                                                                                                   D. Step 7 is replaced by the following two steps:
                                                                                                           7. Check the CRT components: Check that the components dP, dQ and qInv satisfy
                                                                                                                    a. 1 < dP < (p – 1).
                                                                                                                    b. 1 < dQ < (q – 1).
                                                                                                                    c. 1 < qInv < p.
                                                                                                                    d. 1 = (dP × efixed) mod (p – 1).
                                                                                                                    e. 1 = (dQ × efixed) mod (q – 1).
                                                                                                                    f. 1 = (qInv × q) mod p.
                                                                                                                If any of the criteria in Section 6.2.1 are not met, output an indication of an invalid
                                                                                                                key pair, and exit without further processing.
                                                                                                           8. Output an indication that the key pair is valid.
                                                                                               A routine that implements this validation function shall destroy any local copies of p, q, d, dP, dQ,
                                                                                               and qInv, as well as any other locally stored values used or produced during the execution of the
                                                                                                                                                     50
