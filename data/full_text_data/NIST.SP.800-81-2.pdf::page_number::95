                                                           SECURE DOMAIN NAME SYSTEM (DNS) DEPLOYMENT GUIDE



The iterations value should be reviewed annually and changed if conditions warrant. Since the average
DNS query response time is in the range of 25 to 200 ms, the iterations value should be chose to reflect
the number of hash calculations the average processor could do in that time period. However, in practice
the value should be lower to account for client processing power and to speed response for valid clients.
Basic empirical work has shown that the ideal iteration value when using SHA-1 should be between 1 and
500, with values 1-200 recommended for average zones. Anything over 500 iterations, it becomes more
expensive than validating a signature generated by a 2048 bit RSA key for valid clients. If SHA-256 is
used, the value should be between 1 and 300, again with values between 1 and 100 for the majority of
zones in practice, as it takes more time to perform a SHA-256 calculation than a SHA-1 calculation.

The OPT-OUT option is designed to aid deployment in very large zones with a very large number of
delegations (signed and unsigned). With the OPT-OUT option, the NSEC3 span only links signed
delegations, so there are no NSEC3 RRs for names of unsigned delegation. This means there would be a
shorter NSEC3 chain, as not every name has an NSEC3 RR associated with it, and the zone signing
should take less time. Also, if there are frequent changes, the NSEC3 chain may not have to be changed
if unsigned delegations are added or deleted. The drawback is there may be an NSEC3 span an attacker
can use to spoof the existence of new, unsigned zones. However, NSEC signed zones can also have
spoofed unsigned delegations, but the attacker is limited to re-directing existing names in the zone, while
an attacker could spoof completely new unsigned delegations in a zone signed with NSEC3 and using
OPT-OUT.


Checklist Item 26: If the zone is signed using NSEC3 RRs, the salt value should be changed every time
the zone is completely resigned. The value of the salt should be random, and the length should be short
enough to prevent a FQDN to be too long for the DNS protocol (1 to 15 octets should be sufficient).

Checklist Item 27: If the zone is signed using NSEC3 RRs, the iterations value should be based on
available computing power available to clients and attackers. The value should be reviewed annually and
increased if the evaluation conditions change. Initial values should be between 1 and 200 iterations when
using SHA-1 and 1 and 100 if using SHA-256.



10.5 Resource Record TTL Value Recommendations

As mentioned in Section 3.1, each RRset in a zone has its own Time-to-Live value (TTL). This TTL tells
clients how long (in seconds) it should be stored in its cache upon receipt. When a client receives a DNS
response to a query and performs all relevant checks, it stores the resulting RRsets in its cache. The client
cache decrements the TTL value of each RRset in its cache, and when the TTL for any RRset reaches
zero, it is purged form the cache. This prevents caches from growing too large, as well as getting old,
possibly incorrect, DNS data out of caches and prevents them from being returned to future queries.

The zone administrator assigns the TTL value for each RRset individually or for the entire zone and
different RRsets in the same zone can have different values. The zone administrator should set the TTL
value long enough to insure that the RRset will be useful for caches, but short enough that any changes to
the RRset will be propagated quickly through the DNS (and old information purged). DNSSEC (Section
X.X) signature validity periods should also be taken into consideration as well. TTL values should be a
fraction of the validity period of the RRSIG that covers the RRset. DNSSEC aware clients will
decrement the TTL value of an RRset it its cache to the signature expiration date if that date is before the
projected Time-to-Live. That way, the RRset will be purged before it the signature expires (and will be



                                                    10-5
