                                                                                             NIST SP 800-90B                                               RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                   USED FOR RANDOM BIT GENERATION

                                                                                             of m-bit tuples to their expected values that are calculated by multiplying the probabilities of each
                                                                                             successive bit, i.e., assuming that the samples are independent. If nearby bits are not independent,
                                                                                             then the expected probabilities of m-bit tuples derived from their bit probabilities will be biased
                                                                                             for the whole dataset, and a chi-square test statistic will be much larger than expected.

                                                                                             Given the input binary data S = (s1, …, sL), the length of the tuples, m, is determined as follows:
                                                                                                                                                                                                # 0′s in 𝑆𝑆
                                                                                                 1. Let p0 and p1 be the proportion of zeroes and ones in S, respectively, i.e., 𝑝𝑝0 =               𝐿𝐿
                                                                                                                                                                                                              ,
                                                                                                                 # 1′s in 𝑆𝑆
                                                                                                     and 𝑝𝑝1 =        𝐿𝐿
                                                                                                                                .
                                                                                                                                                                    𝐿𝐿
                                                                                                 2. Find the maximum integer m such that min(𝑝𝑝0 , 𝑝𝑝1 )𝑚𝑚 �𝑚𝑚� ≥ 5. If m is greater than 11, set
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                                    m = 11. If m is 1, the test fails. For example, for p0 = 0.14, p1 = 0.86, and L = 1000, m = 2.
                                                                                             The test is applied if m ≥ 2.

                                                                                                 1. Initialize T to 0.
                                                                                                 2. Partition S into non-overlapping m-bit blocks, denoted as 𝐵𝐵 = (𝐵𝐵1,…, 𝐵𝐵� 𝐿𝐿 � ). If L is not a
                                                                                                                                                                                           𝑚𝑚
                                                                                                     multiple of m, discard the remaining bits.
                                                                                                 3. For each possible m-bit tuple (a1, a2, …, am)
                                                                                                         a. Let o be the number of times that the pattern (a1, a2, …, am) occurs in the input B.
                                                                                                         b. Let w be the number of ones in (a1, a2, …, am).
                                                                                                                                          𝐿𝐿
                                                                                                         c. Let e = 𝑝𝑝1𝑤𝑤 (𝑝𝑝0 )𝑚𝑚−𝑤𝑤 �𝑚𝑚�.
                                                                                                                           (𝑜𝑜−𝑒𝑒)2
                                                                                                         d. T = T +                   .
                                                                                                                               𝑒𝑒

                                                                                             The test fails if the test statistic T is greater than the critical value of chi-square with 2m–2 degrees
                                                                                             of freedom, when the type I error is chosen as 0.001.

                                                                                             5.2.4   Testing Goodness-of-fit for Binary Data

                                                                                             This test checks the distribution of the number of ones in non-overlapping intervals of the input
                                                                                             data to determine whether the distribution of the ones remains the same throughout the sequence.
                                                                                             Given the input binary data S = (s1, …, sL), the test description is as follows:

                                                                                                 1. Let p be the proportion of ones in the entire sequence S, i.e., p = (the number of ones in S)/
                                                                                                    L.
                                                                                                                                                                                      𝐿𝐿
                                                                                                 2. Partition S into ten non-overlapping subsets of length �10�, where 𝑆𝑆𝑑𝑑 =
                                                                                                    (𝑠𝑠𝑑𝑑⌊𝐿𝐿/10⌋+1 , … , 𝑠𝑠(𝑑𝑑+1)⌊𝐿𝐿/10⌋ ) for d = 0, …, 9. If L is not a multiple of 10, the remaining bits
                                                                                                    are discarded.
                                                                                                 3. Initialize T to 0.
                                                                                                 4. Let the expected number of zeros and ones in each sub-sequence Sd be


                                                                                                                                                   38
