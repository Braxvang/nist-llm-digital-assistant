5.2.3 Randomized Hashing for Digital Signatures
As described in Section 5.2, the overall security strength of a digital signature is limited
by the collision resistance strength of the hash function. However, when using the
randomized hashing technique specified in SP 800-106 [SP 800-106], a randomized hash
function may support a higher level of security with respect to a particular potential
vulnerability, offering enhanced protection to a message signer against a collision attack
by a malicious message preparer who formulates the message to be signed, but does not
actually sign the message.
In such an attack, the malicious message preparer would endeavor to find two messages
that hash to the same value. Once the message signer had generated a signature for one of
the messages, the malicious preparer could accuse the signer of having signed the other
message instead.
In situations where one party is asked to sign messages prepared by another party, the
level of protection (in bits) that is provided to the message signer against a collision
attack by using randomized hashing is determined by the minimum of the following three
quantities:
    • The second preimage resistance strength (in bits) of the hash function.
    • The security strength (in bits) of the random bit generator (RBG) employed by the
      signer to produce bit strings used to randomize messages, or, the collision
      resistance strength (in bits) of the hash function – whichever is larger.
    • The sum of the collision resistance strength (in bits) of the hash function and the
      smaller of these two quantities:
         (1) The length (in bits) of bit strings used to randomize messages (denoted rv
             in SP 800-106), and
         (2) The length (in bits) of the RBG output used to generate rv (as specified in
             Section 3.3 of SP 800-106).
When randomized hashing is used, the RBG (see Section 5.5 below for more
information) employed to produce the bit strings used to randomize messages shall
support a security strength that is equal to or greater than the security strength of the
signing algorithm. See SP 800-57, Part 1, for information about security strengths of
different signing algorithms. The randomization process itself shall conform to the
specifications of SP 800-106 for digital signature applications supporting at least 112 bits
of security. Under these conditions, SHA-1-based randomized hashing could provide 112
bits of security strength against a collision attack by a malicious message preparer, even
though the unrandomized SHA-1 function has a collision resistance strength that is less
than 80 bits.
It is important to note what the use of randomized hashing for digital signatures does and
does not provide:
       1)      Randomized hashing can offer a message signer additional protection by
               reducing the likelihood that a message preparer can find multiple
               messages that yield the same hash value during the digital signature

                                             12
