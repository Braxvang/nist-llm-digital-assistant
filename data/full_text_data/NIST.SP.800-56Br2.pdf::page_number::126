                                                                                               NIST SP 800-56B REV. 2                                 RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                           USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                                It suffices to verify that 0 < uv ≤ n /(p + q – 1). By the assumptions on the sizes of p, q, and n, it
                                                                                                follows that p + q – 1 < 2(nBits/2)+1 and n > 2(nBits – 1), so that n /(p + q – 1) > 2(nBits/2) – 2. If it can be
                                                                                                shown that the product uv is less than 2(nBits/2) – 2, then the proof of Lemma 3 will be complete.
                                                                                                Lemma 2 implies that 1 ≤ uv ≤ u2 < e2. By assumption, e < 2256, so e2 < 2512. Since this document
                                                                                                requires nBits ≥ 2048, it follows that 2(nBits/2) – 2 ≥ 21022. The fact that uv < 2512 < 21022 ≤
                                                                                                2(nBits/2) – 2 completes the proof of the lemma.
                                                                                               Note: Lemma 3 (and hence the proof of correctness for the RecoverPrimeFactors process) is true
                                                                                               under conditions more general than those used in the proof above, which invoked the bounds on
                                                                                               the sizes of e, p, q, and n that are required by this Recommendation. For example, it suffices to
                                                                                               know that those four values satisfy the condition 1 < e2 ≤ n /(p + q – 1) and that d < λ(n).
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                               Now consider the quantities m and r computed in step 2 of the RecoverPrimeFactors process.
                                                                                               Combining equation (5) with Lemma 3 yields
                                                                                                                m = a /n = (uv – 1) and        r = a – mn = n – uv (p + q – 1).
                                                                                               Therefore, in step 3 of the process,
                                                                                                                b = ( (n – r)/(m + 1) ) + 1 = ( uv (p + q – 1))/(uv) ) + 1 = p + q,
                                                                                               and in step 4,
                                                                                                                ϒ = (b2 – 4n)1/2 = ( (p + q)2 – 4pq)1/2 = ( (p – q)2)1/2 = p – q.
                                                                                               These values for b and ϒ ensure that p and q are correctly recovered in step 5, since
                                                                                                                        p = (b + ϒ)/2 and q = (b – ϒ)/2.




                                                                                                                                                     116
