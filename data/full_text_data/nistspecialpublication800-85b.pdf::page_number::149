Special Publication 800-85B                                  PIV Data Model Testing Specification



11.4.2.7 Verify FASC-N

Purpose                 Confirms that the subjectAltName extension contains the FASC-N of
                        the card holder and that it matches to that present in the CHUID.
Reference(s)            1.    FIPS201, Section 5.4.2.1
                        2.    AS07.04.09
                        3.    AS07.04.13
Precondition            1.    A valid PIV card is inserted into the contact reader.
                        2.    A valid PC/SC connection exists between the test application and
                              the contact reader.
                        3.    The test application is currently connected to the card application
                              which is accessible through card handle.
                        4.    A card authentication key and corresponding certificate are present
                              on the PIV card.
                        5.    A valid CHUID is present on the PIV card.
Test Steps              1. Set cardHandle := <<valid card handle>>
                        2. Set OID := <<Card Authentication Certificate
                           (2.16.840.1.101.3.7.2.5.0)>>
                        3. Call pivGetData with the following parameters
                           • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                        4. Extract the GeneralNames field from the subjectAltName
                           extension in the certificate
                        5. Parse the different GeneralName fields
                        6. Set OID := <<CHUID (2.16.840.1.103.3.7.2.48.0)>>
                        7. Call pivGetData with the following parameters
                           • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                        8. Parse the CHUID and extract the FASC-N
Expected Result(s)      A GeneralName field exists that contains an otherName with a type-id
                        asserting the pivFASC-N OID. The value field of this otherName
                        contains the FASC-N for the cardholder which matches the FASC-N
                        obtained from parsing the CHUID.


11.4.2.8 Verify RSA exponent

Purpose                 For RSA keys, confirms that the exponent of the RSA asymmetric key
                        for card authentication is greater than or equal to 65,537.
Reference(s)            1.    SP80078, Section 3.1
                        2.    AS07.04.14




                                                                                                    Page 141
