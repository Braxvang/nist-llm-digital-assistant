Special Publication 800-85B                                  PIV Data Model Testing Specification


Reference(s)            1.    FIPS201, Section 5.4.2.1
                        2.    AS07.01.08
                        3.    AS07.01.12
Precondition            1.    A valid PIV card is inserted into the contact reader.
                        2.    A valid PC/SC connection exists between the test application and
                              the contact reader.
                        3.    The test application is currently connected to the card application
                              which is accessible through card handle.
                        4.    A PIV authentication key and corresponding certificate are present
                              on the PIV card.
                        5.    A valid CHUID is present on the PIV card.
Test Steps              1. Set cardHandle := <<valid card handle>>
                        2. Set OID := <<PIV Authentication Certificate
                           (2.16.840.1.101.3.7.2.1.1)>>
                        3. Call pivGetData with the following parameters
                           • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                        4. Extract the GeneralNames field from the subjectAltName
                           extension in the certificate
                        5. Parse the different GeneralName fields
                        6. Set OID := <<CHUID (2.16.840.1.103.3.7.2.48.0)>>
                        7. Call pivGetData with the following parameters
                           • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                        8. Parse the CHUID and extract the FASC-N
Expected Result(s)      A GeneralName field exists that contains an otherName with a type-id
                        asserting the pivFASC-N OID. The value field of this otherName
                        contains the FASC-N for the cardholder which matches the FASC-N
                        obtained from parsing the CHUID.


11.1.2.7 Verify expiration dates consistency

Purpose                 Confirms that the expiration date of the PIV authentication certificate is
                        not past the expiration date of the PIV card.
Reference(s)            1.    FIPS201, Section 5.3.2.1
                        2.    AS07.01.13




                                                                                               Page 120
