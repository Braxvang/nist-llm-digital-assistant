SP 800-132      Recommendation for Password-Based Key Derivation        December 2010



Option 2a, an MK (or a portion of an MK) that is generated from the password is used
directly to protect the DPK. In Option 2b, an MK (or a portion of an MK) that is
generated from the password is used to derive keying material using an approved KDF,
and the derived keying material (or portion of the derived keying material) is used to
protect the DPK.

The means to protect the DPK(s) shall use an approved authenticated encryption mode,
such as one of the modes that is defined in [3,4], or a NIST-approved encryption
algorithm/mode in conjunction with a NIST-approved authentication scheme.

The use of an approved authenticated encryption mode, or equivalent combination,
allows the detection of an incorrect MK or incorrect derived keying material and, by
extension, an incorrect password, thus avoiding the lengthy process of decrypting the
protected data using an incorrect DPK. Depending on the method that is used to protect
the DPK(s), data in addition to the salt and counter (e.g., an initialization vector) may
need to be made available for decryption and encryption purposes (see Appendix A.3).

For options 2a and 2b, changing a password changes the key that protects the associated
DPK(s). Therefore, whenever a password is changed, any DPK that is protected by the
retiring password shall be recovered (e.g., decrypted) using the MK or the derived keying
material that is associated with the retiring password, and then re-protected (e.g.,
encrypted) using the appropriate MK or the derived keying material that is associated
with a new password.


6      References

    [1] FIPS 198-1, The Keyed-Hash Message Authentication Code (HMAC), July 2008
    [2] NIST SP 800-108, Recommendation for Key Derivation Using Pseudorandom
        Functions, October 2009.
    [3] NIST SP 800-38 C, Recommendation for Block Cipher Modes of Operation: the
        CCM Mode for Authentication and Confidentiality, May 2004.
    [4] NIST SP 800-38 D, Recommendation for Block Cipher Modes of Operation:
        Galois/Counter Mode (GCM) and GMAC, November 2007.

                                           10
