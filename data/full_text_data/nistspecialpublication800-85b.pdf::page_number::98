Special Publication 800-85B                                   PIV Data Model Testing Specification


Test Steps              1. Set cardHandle := <<valid card handle>>
                        2. Set OID := <<Card Holder Fingerprints
                           (2.16.840.1.101.3.7.2.96.16)>>
                        3. Call pivGetData with the following parameters
                           • (IN) cardHandle
                               • (IN) OID
                               • (OUT) data
                        4. Parse the SignerInfo-> signedAttrs field contents from
                           the CBEFF_SIGNATURE_BLOCK to locate the pivFASC-N
                           attribute (OID=2.16.840.1.101.3.6.6) and its
                           corresponding attribute value
                        5. Set OID := <<CHUID (2.16.840.1.103.3.7.2.48.0)>>
                        6. Call pivGetData with the following parameters
                           • (IN) cardHandle
                               • (IN) OID
                               • (OUT) data
                        7. Parse the CHUID and extract the FASC-N
Expected Result(s)      A pivFASC-N attribute exists in the signedAttrs of the SignerInfo and
                        its value matches the FASC-N present in the CHUID of the PIV card.


10.2.1.12 Verify signature algorithm in SignerInfo

Purpose               Confirms that the signatureAlgorithm field specified in the SignerInfo
                      field is in accordance with Table 3-4 of SP80078 and based on the PIV card
                      expiration date in accordance with Table 3-3 of SP80078.
Reference(s)          1.      SP80078, Section 3.2.1
                      2.      AS06.02.15
Precondition          1.      A valid PIV card is inserted into the contact reader.
                      2.      A valid PC/SC connection exists between the test application and the
                              contact reader.
                      3.      The test application is currently connected to the card application
                              which is accessible through card handle.
                      4.      A valid card holder fingerprint object is present on the PIV card.
                      5.      A valid CHUID object is present on the PIV card.




                                                                                                     Page 90
