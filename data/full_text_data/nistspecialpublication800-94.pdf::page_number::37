                                                           GUIDE TO INTRUSION DETECTION AND PREVENTION SYSTEMS (IDPS)



possible message codes that indicate what is unreachable (e.g., network, host, protocol). Most ICMP
message types are not intended to elicit a response. 18

4.1.4     Hardware Layer

As the name implies, the hardware layer, also called the data link layer, involves the physical components
of the network, including cables, routers, switches, and network interface cards (NIC). The hardware
layer also includes various hardware layer protocols, with Ethernet being the most widely used. Ethernet
relies on the concept of a media access control (MAC) address, which is a unique six-byte value (such as
00-02-B4-DA-92-2C) that is permanently assigned to a particular NIC. 19 Each frame, the logical unit at
the hardware layer, contains two MAC addresses, which indicate the MAC address of the NIC that just
routed the frame and the MAC address of the next NIC to which the frame is being sent. As a frame
passes through networking equipment (such as routers and firewalls) on its way between the original
source host and the final destination host, the MAC addresses are updated to refer to the local source and
destination. Several separate hardware layer transmissions may be linked together within a single
network layer transmission.

In addition to the MAC addresses, each frame also contains an EtherType value, which indicates the
protocol that the frameâ€™s payload contains (typically IP or Address Resolution Protocol [ARP]). 20 When
IP is used, each IP address maps to a particular MAC address. (Because multiple IP addresses can map to
a single MAC address, a MAC address does not necessarily uniquely identify an IP address.)

4.2     Components and Architecture

This section describes the major components of typical network-based IDPSs and illustrates the most
common network architectures for these components. It also provides recommendations for the
placement of network-based IDPS sensors.

4.2.1     Typical Components

A typical network-based IDPS is composed of sensors, one or more management servers, multiple
consoles, and optionally one or more database servers (if the network-based IDPS supports their use). All
of these components are similar to other types of IDPS technologies, except for the sensors. A network-
based IDPS sensor monitors and analyzes network activity on one or more network segments. The
network interface cards that will be performing monitoring are placed into promiscuous mode, which
means that they will accept all incoming packets that they see, regardless of their intended destinations.
Most IDPS deployments use multiple sensors, with large deployments having hundreds of sensors.
Sensors are available in two formats:

 Appliance. An appliance-based sensor is comprised of specialized hardware and sensor software.
  The hardware is typically optimized for sensor use, including specialized NICs and NIC drivers for
  efficient capture of packets, and specialized processors or other hardware components that assist in
  analysis. Parts or all of the IDPS software might reside in firmware for increased efficiency.


18
      ICMP is designed to limit responses, particularly to error messages. If ICMP had not been designed in this way, message
      loops could occur. For example, if Host A received an ICMP error message from Host B and responded with an error
      message, and Host B responded to that error message with an error message, the two hosts could continue sending error
      messages regarding the error messages.
19
      Various software utilities are publicly available that allow people to configure systems to spoof other MAC addresses.
      There have also been cases in which manufacturers accidentally created NICs with duplicate MAC addresses.
20
      EtherType value 0x0800 is IP, while 0x0806 is ARP. See http://www.iana.org/assignments/ethernet-numbers for more
      information on EtherType values.


                                                              4-3
