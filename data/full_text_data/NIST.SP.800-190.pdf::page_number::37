                                                                                             NIST SP 800-190                                                             APPLICATION CONTAINER SECURITY GUIDE


                                                                                             specific characteristics of the apps running in the containers. This dynamic rule management is
                                                                                             critical due to the scale and rate of change of containerized apps, as well as their ephemeral
                                                                                             networking topology.

                                                                                             Specifically, app-aware tools should provide the following capabilities:

                                                                                                 •   Automated determination of proper container networking surfaces, including both
                                                                                                     inbound ports and process-port bindings;
                                                                                                 •   Detection of traffic flows both between containers and other network entities, over both
                                                                                                     ‘on the wire’ traffic and encapsulated traffic; and
                                                                                                 •   Detection of network anomalies, such as unexpected traffic flows within the
                                                                                                     organization’s network, port scanning, or outbound access to potentially dangerous
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-190




                                                                                                     destinations.

                                                                                             4.4.3   Insecure container runtime configurations

                                                                                             Organizations should automate compliance with container runtime configuration standards.
                                                                                             Documented technical implementation guidance, such as the Center for Internet Security Docker
                                                                                             Benchmark [20], provides details on options and recommended settings, but operationalizing this
                                                                                             guidance depends on automation. Organizations can use a variety of tools to “scan” and assess
                                                                                             their compliance at a point in time, but such approaches do not scale. Instead, organizations
                                                                                             should use tools or processes that continuously assess configuration settings across the
                                                                                             environment and actively enforce them.

                                                                                             Additionally, mandatory access control (MAC) technologies like SELinux [21] and AppArmor
                                                                                             [22] provide enhanced control and isolation for containers running Linux OSs. For example,
                                                                                             these technologies can be used to provide additional segmentation and assurance that containers
                                                                                             should only be able to access specific file paths, processes, and network sockets, further
                                                                                             constraining the ability of even a compromised container to impact the host or other containers.
                                                                                             MAC technologies provide protection at the host OS layer, ensuring that only specific files,
                                                                                             paths, and processes are accessible to containerized apps. Organizations are encouraged to use
                                                                                             the MAC technologies provided by their host OSs in all container deployments.

                                                                                             Secure computing (seccomp) 7 profiles are another mechanism that can be used to constrain the
                                                                                             system-level capabilities containers are allocated at runtime. Common container runtimes like
                                                                                             Docker include default seccomp profiles that drop system calls that are unsafe and typically
                                                                                             unnecessary for container operation. Additionally, custom profiles can be created and passed to
                                                                                             container runtimes to further limit their capabilities. At a minimum, organizations should ensure
                                                                                             that containers are run with the default profiles provided by their runtime and should consider
                                                                                             using additional profiles for high-risk apps.

                                                                                             4.4.4   App vulnerabilities

                                                                                             Existing host-based intrusion detection processes and tools are often unable to detect and prevent
                                                                                             attacks within containers due to the differing technical architecture and operational practices


                                                                                             7   For more information on seccomp, see https://www.kernel.org/doc/Documentation/prctl/seccomp_filter.txt.

                                                                                                                                                        25
