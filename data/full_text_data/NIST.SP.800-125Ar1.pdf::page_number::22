NIST SP 800-125A REV. 1                                                    SECURITY RECOMMENDATIONS FOR
                                                                       SERVER-BASED HYPERVISOR PLATFORMS

5. SECURITY RECOMMENDATIONS FOR HY-BF2

 Security recommendations for all three forms of device virtualization discussed in section 2.2.2 as well as for
 self-virtualized devices are provided in this section.

 Security Recommendation HY-SR-6A (Emulation): Because of the complexity of emulating a
 hardware device through software, emulation, apart from suffering performance penalties, also
 increases the size of the TCB especially in situations where the guest OS has native device drivers and
 the device emulation code runs as a kernel module with the same privilege level as the hypervisor.
 Hence emulation should only be used where complexity is manageable (e.g., USB host controller).

 Security Recommendation HY-SR-6B (Para-virtualization): In situations where para-virtualized
 device drivers are used in VMs, mediation of access to physical devices should be enabled by
 running back-end device drivers (which control the physical device attached to the hypervisor host)
 in a dedicated VM rather than in the hypervisor. This facilitates running the back-end device driver
 code at a privilege level lower than that of the hypervisor. Additionally, the hypervisor platform
 should include hardware support in the form of I/O Memory Management Unit (IOMMU) for
 validating and translating access from the driver domainâ€™s underlying hardware device to host
 memory. The specific IOMMU feature that is mandatory is DMA remapping where the DMA call
 from a device to guest physical address (GPA) must be translated to host physical address (HPA) and
 then checked whether the HPA address falls within the protection domain assigned to that device.
 Combining these mechanisms enables reducing the size of the TCB as well as reducing the impact of
 faulty device or device driver behavior (restricted to device-driver VM as opposed to the hypervisor).

 Security Recommendation HY-SR-6C (Passthrough or self-virtualizing hardware devices): For
 situations where VMs need to be given dedicated access to DMA capable devices, the hypervisor
 platform should include hardware support in the form of I/O Memory Management Unit (IOMMU)
 for validating and translating all device access to host memory. This recommendation also applies to
 use of self-virtualizing hardware devices (based on SR-IOV specification). The specific IOMMU
 feature that is mandatory is DMA remapping where the DMA call from a device to guest physical
 address (GPA) must be translated to host physical address (HPA) and then checked whether the HPA
 address falls within the protection domain assigned to that device.

 The following security recommendations are applicable irrespective of the type of device
 virtualization:

 Security Recommendation HY-SR-7 (Device access): It should be possible to set up an Access
 Control List (ACL) to restrict the access of each VM process to only the devices assigned to that VM.
 To enable this, the hypervisor configuration should support a feature to mark VMs (semantically, a set
 of tasks) and/or have a feature to specify a whitelist, or list of allowable of devices, for each VM.

 Security Recommendation HY-SR-8 (Device Usage): It should be possible to set resource limits for
 network bandwidth and I/O bandwidth (e.g., disk read/write speeds) for each VM to prevent denial-of-
 service (DOS) attacks. Additionally, the proper use of resource limits localizes the impact of a DOS to
 the VM or the cluster for which the resource limit is defined.




                                                      15
