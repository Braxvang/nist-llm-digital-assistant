NIST SP 800-219r1                                                     Automated Secure Configuration
July 2023                                                                  Guidance from the mSCP

title: "Apple macOS 11 (Big Sur) Test Baseline"
description: |
  This guide describes the prudent actions to take when securing a macOS 11
system against the Test Baseline.
authors: |
  |===
  |Joe Doe|NIST
  |===
profile:
  - section: "Authentication"
    rules:
       - auth_pam_login_smartcard_enforce
       - auth_pam_su_smartcard_enforce
       - auth_pam_sudo_smartcard_enforce
       - auth_smartcard_allow
  - section: "Auditing"
    rules:
       - audit_acls_files_configure
       - audit_acls_files_mode_configure
       - audit_acls_folder_wheel_configure

                               Fig. 1. Security Baseline YAML File.


3.2.1. Rule File Composition
A YAML rule file is broken down into the following subsections. This list and the following
example are from the Rules section of the mSCP wiki.
   •   id – The id should match the file name without the yaml file extension.

   •   title – The title is a human-readable title of the rule.

   •   discussion – The discussion should provide a concise description of the intended use
       of the rule.
   •   check – Every rule will have a check. A shell-based check should be able to validate and
       check most rules.
   •   result – Expected results from the check.

   •   fix – The fix will appear in a document when generated. If a fix includes
       [source,bash], the fix will be used for generating the script to enforce the rule.

   •   references – The references include a Common Configuration Enumeration (CCE)
       identifier and a mapping of the security frameworks, guidance, and individual controls
       that have been mapped to the rule. See the official repository of NIST CCEs [12] for
       more information.
   •   macOS – The validated macOS version for this rule.

   •   odv – If a rule supports the ODV functionality, then the odv section should be present. At
       a minimum, this field should contain a hint (provides a description when tailoring a
       baseline) and a default value that replaces the $ODV variable.
   •   tags – Tags are keywords used to categorize and identify related rules, and they can be
       added to or modified as needed. Tags can also be used to make index-based searching of
       the rules faster and easier.


                                                7
