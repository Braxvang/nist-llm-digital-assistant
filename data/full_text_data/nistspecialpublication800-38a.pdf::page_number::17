same ciphertext block. If this property is undesirable in a particular application, the ECB mode
should not be used.

The ECB mode is illustrated in Figure 1.

6.2   The Cipher Block Chaining Mode

The Cipher Block Chaining (CBC) mode is a confidentiality mode whose encryption process
features the combining (“chaining”) of the plaintext blocks with the previous ciphertext blocks.
The CBC mode requires an IV to combine with the first plaintext block. The IV need not be
secret, but it must be unpredictable; the generation of such IVs is discussed in Appendix C.
Also, the integrity of the IV should be protected, as discussed in Appendix D. The CBC mode is
defined as follows:

       CBC Encryption:                     C1 = CIPHK(P1 ⊕ IV);
                                           Cj = CIPHK(Pj ⊕ Cj-1)             for j = 2 … n.
                                                        -1
       CBC Decryption:                     P1 = CIPH K(C1) ⊕ IV;
                                           Pj = CIPH K(Cj) ⊕ Cj-1
                                                    -1
                                                                             for j = 2 … n.


                     INITIALIZATION   PLAINTEXT 1        PLAINTEXT 2          PLAINTEXT n
                        VECTOR
                                            ⊕                     ⊕                ⊕
           ENCRYPT




                                       INPUT BLOCK 1         INPUT BLOCK 2    INPUT BLOCK n

                                         CIPHK                 CIPHK            CIPHK
                                      OUTPUT BLOCK 1    OUTPUT BLOCK 2       OUTPUT BLOCK n



                                      CIPHERTEXT 1       CIPHERTEXT 2        CIPHERTEXT n




                                      CIPHERTEXT 1       CIPHERTEXT 2         CIPHERTEXT n
           DECRYPT




                                      INPUT BLOCK 1          INPUT BLOCK 2    INPUT BLOCK n

                                        CIPH-1K                CIPH-1   K      CIPH-1K
                                      OUTPUT BLOCK 1    OUTPUT BLOCK 2       OUTPUT BLOCK n
                                            ⊕                     ⊕                ⊕
                     INITIALIZATION
                         VECTOR        PLAINTEXT 1           PLAINTEXT 2      PLAINTEXT n




                                         Figure 2: The CBC Mode


In CBC encryption, the first input block is formed by exclusive-ORing the first block of the
plaintext with the IV. The forward cipher function is applied to the first input block, and the



                                                       10
