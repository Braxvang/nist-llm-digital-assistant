Special Publication 800-85B                                  PIV Data Model Testing Specification


Test Steps              1. Set cardHandle := <<valid card handle>>
                        2. Set OID := <<Card Authentication Certificate
                           (2.16.840.1.101.3.7.2.5.0)>>
                        3. Call pivGetData w/
                           • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                        8. Extract validity->notAfter->utcTime field value from
                            the certificate
                        9. Extract subjectPublicKeyInfo->algorithm->algorithm
                            field value
                        10. Extract the subjectPublicKeyInfo->subjectPublicKey
                            from the certificate
                        11. Match the key size to Table 3-3 of SP80078 based on the
                            algorithm obtained from the step 3 and the date
                            obtained from step 2

                        Note: - Since the ECDSA keys do not have any size
                        restrictions based on dates, this test case does not apply
                        to these types of keys

Expected Result(s)      The key sizes used adhere to the time period for use requirement.


11.4.2 Data Integrity Checks

11.4.2.1 Verify key usage extension

Purpose                 Confirms that the card authentication certificate asserts the appropriate
                        purpose of the key.
Reference(s)            1.    FIPS201, Section 5.4.2.1
                        2.    AS07.04.05
Precondition            1.    A valid PIV card is inserted into the contact reader.
                        2.    A valid PC/SC connection exists between the test application and
                              the contact reader.
                        3.    The test application is currently connected to the card application
                              which is accessible through card handle.
                        4.    A card authentication key and corresponding certificate are present
                              on the PIV card.
Test Steps              1. Set cardHandle := <<valid card handle>>
                        2. Set OID := <<Card Authentication Certificate
                           (2.16.840.1.101.3.7.2.5.0)>>
                        3. Call pivGetData w/
                           • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                        4. Extract the value of the keyUsage extension field from
                           the certificate

Expected Result(s)      The digitalSignature bit has been set. No other bits have been set.



                                                                                                    Page 137
