GUIDE TO INTEGRATING FORENSIC TECHNIQUES INTO INCIDENT RESPONSE



to the IP address through the DNS application layer protocol. The primary reason for entering a domain
name instead of an IP address is that the former is generally easier for people to remember. In addition,
where a domain name is likely to remain the same, a host’s IP address can change over time; by
referencing a host by domain name, which is then mapped to the host’s IP address, users can reach the
host no matter what IP address the host is currently using.

6.1.4     Hardware Layer

As the name implies, the hardware layer involves the physical components of the network, including
cables, routers, switches, and NIC. The hardware layer also includes various hardware layer protocols;
Ethernet is the most widely used of these protocols. Ethernet relies on the concept of a MAC address,
which is a unique 6-byte value (such as 00-02-B4-DA-92-2C) that is permanently assigned to a particular
NIC.89 Each frame contains two MAC addresses, which indicate the MAC address of the NIC that just
routed the frame and the MAC address of the next NIC to which the frame is being sent. As a frame
passes through networking equipment (such as routers and firewalls) on its way between the original
source host and the final destination host, the MAC addresses are updated to refer to the local source and
destination. Several separate hardware layer transmissions may be linked together within a single IP layer
transmission.

In addition to the MAC addresses, each frame also contains an EtherType value, which indicates the
protocol that the frame’s payload contains (typically IP or Address Resolution Protocol [ARP]).90 When
IP is used, each IP address maps to a particular MAC address. (Because multiple IP addresses can map to
a single MAC address, a MAC address does not necessarily uniquely identify an IP address.)

6.1.5     Layers’ Significance in Network Forensics

Each of the four layers of the TCP/IP protocol suite contains important information. The hardware layer
provides information about physical components, while other layers describe logical aspects. For events
within a network, an analyst can map an IP address (logical identifier at the IP layer) to the MAC address
of a particular NIC (physical identifier at the physical layer), thereby identifying a host of interest. The
combination of the IP protocol number (IP layer field) and port numbers (transport layer fields) can tell an
analyst which application was most likely being used or targeted. This can be verified by examining the
application layer data.

Network forensic analysis relies on all of the layers. When analysts begin to examine data, they typically
have limited information—most likely an IP address of interest and perhaps protocol and port
information. Nevertheless, this is enough information to support searching common data sources for
more information. In most cases, the application layer contains the actual activity of interest—most
attacks are against vulnerabilities in applications (including services), and nearly all misuse involves
misuse of applications. Analysts need IP addresses so that they can identify the hosts that may have been
involved in the activity. The hosts may also contain additional data that would be of use in analyzing the
activity. Although some events of interest may not have relevant application-level data (e.g., a distributed
denial of service attack designed to consume all network bandwidth), most do; network forensics provides
important support to the analysis of application-layer activities.


89
     The first 3 bytes of each MAC address indicate the vendor of the NIC; a list of mappings is available at
     http://standards.ieee.org/regauth/oui/oui.txt. However, various software utilities are publicly available that allow people to
     configure systems to spoof other MAC addresses. There have also been cases in which manufacturers accidentally created
     NICs with duplicate MAC addresses.
90
     EtherType value 0x0800 is IP, while 0x0806 is ARP. See http://www.iana.org/assignments/ethernet-numbers for more
     information on EtherType values.


                                                                6-4
