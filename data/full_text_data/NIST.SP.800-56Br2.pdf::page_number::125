                                                                                               NIST SP 800-56B REV. 2                             RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                       USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                               Combining Lemma 1 with equation (1) above yields
                                                                                                                       (p – 1)(q – 1) = λ(n) × GCD(n – 1, λ(n)).                              (2)
                                                                                               Consider the quantity a = (de – 1) × GCD(n, de – 1) from step 1 of the RecoverPrimeFactors
                                                                                               process. Since e > 1, the congruence de ≡ 1 (mod λ(n)) implies that de – 1 = u λ(n) for some
                                                                                               positive integer u. Substituting u λ(n) for de – 1 in the expression for a yields
                                                                                                               a = (de – 1) × GCD(n – 1, de – 1) = u λ(n) × GCD(n – 1, u λ(n)).               (3)
                                                                                               GCD(n – 1, λ(n)) is a common divisor of n – 1 and u λ(n), and so is also a divisor of their GCD.
                                                                                               Let v = GCD(n – 1, u λ(n)) / GCD(n – 1, λ(n)).
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                               Lemma 2: 1 ≤ v ≤ u < e
                                                                                               Proof of Lemma 2:
                                                                                                The assumption that the positive integer d is less than λ(n) and the fact that u = (de – 1)/λ(n)
                                                                                                implies that u < e. Since v is a positive integer, it is true that 1 ≤ v. It remains to show that
                                                                                                v ≤ u. Using
                                                                                                               GCD(n – 1, u λ(n)) = (n – 1)(u λ(n)) / LCM(n – 1, u λ(n))
                                                                                                and
                                                                                                               GCD(n – 1, λ(n)) = (n – 1)(λ(n)) / LCM(n – 1, λ(n)),
                                                                                                It follows that
                                                                                                       v = GCD(n – 1, u λ(n)) / GCD(n – 1, λ(n)) = u × LCM(n – 1, λ(n))/LCM(n – 1, u λ(n)),
                                                                                                which can be rewritten to obtain
                                                                                                                       LCM(n – 1, u λ(n)) / LCM(n – 1, λ(n)) = u/v.
                                                                                                Since LCM(n – 1, u λ(n)) is a common multiple of n – 1 and λ(n), it is a multiple of the least
                                                                                                common multiple of n – 1 and λ(n). Therefore, u/v = LCM(n – 1, u λ(n)) / LCM(n – 1, λ(n)) is a
                                                                                                positive integer. From 1 ≤ u/v, one obtains v ≤ u, completing the proof of the lemma.


                                                                                               Using GCD(n – 1, u λ(n)) = v GCD(n – 1, λ(n)) together with equations (2) and (3) above, it follows
                                                                                               that
                                                                                                      a = u λ(n) × v GCD(n – 1, λ(n)) = uv ( λ(n) × GCD(n – 1, λ(n)) ) = uv (p – 1)(q – 1).   (4)
                                                                                               Since (p – 1)(q – 1) = n – (p + q – 1), equation (4) above shows that
                                                                                                               a = uv n – uv (p + q – 1) = (uv – 1) n + ( n – uv (p + q – 1) )                (5)


                                                                                               Lemma 3: 0 ≤ n – uv (p + q – 1) < n
                                                                                               Proof of Lemma 3:

                                                                                                                                                 115
