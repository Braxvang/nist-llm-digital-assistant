                                                                                               NIST SP 800-56B REV. 2                          RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                    USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                               termination of the actions due to an error, or (in the absence of errors), prior to or during the
                                                                                               completion of step 8.
                                                                                               The messages may be sent in a different order, i.e., CV may be sent before CU.
                                                                                               It is extremely important that an implementation not reveal any sensitive information. It is also
                                                                                               important to conceal partial information about ZU, ZV and Z to prevent chosen-ciphertext attacks
                                                                                               on the secret-value encapsulation scheme. In particular, the observable behavior of the key-
                                                                                               agreement process should not reveal partial information about the shared secret Z.

                                                                                               8.3.3 KAS2 Key Confirmation
                                                                                               The KAS2 key-confirmation schemes are based on the KAS2-basic scheme.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                               8.3.3.1 KAS2 Key-Confirmation Components
                                                                                               The components for KAS2 key agreement with key confirmation are the components in Section
                                                                                               8.1, plus the following:
                                                                                                  MAC: A message authentication code algorithm with the following parameters (see Section
                                                                                                  5.2)
                                                                                                      a. MacKeyLen: the byte length of MacKey.
                                                                                                      b. MacTagLen: the byte length of MacTag. (MacTagBits, as used in Section 5.2, is equal
                                                                                                         to 8 Ã— MacTagLen.)
                                                                                               MacKey shall be the first MacKeyLen bytes of the keying material and shall be used only for the
                                                                                               key-confirmation operation of a single transaction. For KAS2 key confirmation, the length of the
                                                                                               keying material shall be at least MacKeyLen bytes. The keying material is usually longer than
                                                                                               MacKeyLen bytes so that other keying material is available for subsequent operations.

                                                                                               8.3.3.2 KAS2-Party_V-confirmation
                                                                                               Figure 9 depicts a typical flow for a KAS2 scheme with unilateral key confirmation from party V
                                                                                               to party U. In this scheme, party V and party U assume the roles of the key-confirmation provider
                                                                                               and recipient, respectively. The successful completion of the key-confirmation process provides
                                                                                               party U with a) assurance that party V has derived the same secret Z value, and b) assurance that
                                                                                               party V has actively participated in the process.




                                                                                                                                              83
