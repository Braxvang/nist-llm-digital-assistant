NIST SP 800-85A-4                                           PIV CARD APPLICATION & MIDDLEWARE
                                                                     INTERFACE TEST GUIDELINES

B.6.2.6          Identify and Handle an Insufficient Buffer
 Purpose                 Ensure that the PIV Middleware identifies and handles an
                         insufficient buffer for data retrieved from the card.
 Target                  pivGetData
 Reference(s)            1. SP 800-73-4 Part 3, Section 3.2.4
                         2. AS04.06A-R4
 Precondition(s)         1. The client application owns a connection to the PIV Card
                            Application accessible through cardHandle.
                         2. The client application has successfully selected the PIV Card
                            Application.
                         3. Length of the buffer allocated for data by the client application is
                            only 1 byte.
 Test Steps              1. Set cardHandle := <<valid cardHandle>>
                         2. Set OID := <<OID of X.509 Certificate for Card
                            Authentication>>
                         3. Create data reference
                         4. Call pivGetData with
                            • (IN) cardHandle
                            • (IN) OID
                            • (IN) oidLength
                            • (OUT) data
                            • (INOUT) DataLength
 Expected Result(s)      Call returns with status_word of PIV_INSUFFICIENT_BUFFER and does
                         not initialize data reference, but sets the DataLength parameter to the
                         length of the retrieved data.
 Postcondition(s)        The precondition states are unaffected.


B.7           pivPutData

B.7.1           Valid Test Assertions

B.7.1.1          Write Data to an Object on the Card through the Client Application
 Purpose                Ensure the PIV Middleware writes the entire data content to an
                        object on the PIV Card Application.
 Target                  pivPutData
 Reference(s)            1. SP 800-73-4 Part 3, Section 3.4.1
                         2. AS04.01, AS04.02A-R4, AS04.09
 Precondition(s)         1. The client application owns a connection to the PIV Card
                            Application accessible through cardHandle.
                         2. The client application has successfully selected the PIV Card
                            Application.
                         3. Mutual authentication with the client application using the PIV
                            Card Application Administration key has taken place.
 Test Steps              1. Set cardHandle := <<valid cardHandle>>



                                         B-18
