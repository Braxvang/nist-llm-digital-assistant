NIST SP 800-166                                                  DERIVED PIV APPLICATION AND
                                                                 DATA MODEL TEST GUIDELINES

                         •   Suitable drivers have been loaded between the test system and
                             an instance of the reader.
                         •   A Security Object is present within the Derived PIV
                             Application.
 Test Scenario           1. Send the SELECT command with
                               • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                         2. Send the GET DATA command with
                               • Data field of the command containing the tag
                                  ('5FC106') of the Security Object
                         3. Extract the version field contents from the
                            asymmetric signature of the Security Object (i.e.,
                            tag 0xBB)
 Expected Result(s)      1. From Step 1, the command returns the application property
                            template with the status word '90 00'.
                         2. From Step 2, the command returns the requested data object
                            along with the status word '90 00'.
                         3. From Step 3, the value of the version field of the SignedData is
                            v3.

9.2.1.4 SignedData digestAlgorithms

 Test Assertion          TA-09.02.01.04
 Purpose                 Verifies that the digestAlgorithms field of the SignedData content
                         type is in accordance with Table 3-2 of [SP800-78].
 DTR(s)                  • DTR-07.02.01.05
 Issuer Documentation    None.
 Precondition(s)         • A token with the Derived PIV Application is inserted into an
                            appropriate token reader.
                         • Suitable drivers have been loaded between the test system and
                            an instance of the reader.
                         • A Security Object is present within the Derived PIV
                            Application.
 Test Scenario           1. Send the SELECT command with
                               • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                         2. Send the GET DATA command with
                               • Data field of the command containing the tag
                                  ('5FC106') of the Security Object
                         3. Extract the digestAlgorithms and certificates
                            fields contents from the Security Object.
                         4. From the certificate obtained, extract the
                            subjectPublicKeyInfo->subjectPublicKey and
                            determine the type and size of the signer’s public
                            key.
                         5. Determine the digest algorithm specified in the
                            digestAlgorithms field obtained in Step 3 using
                            Table 3-6 of [SP800-78].
                         6. Match the digest algorithm obtained from Step 5 to
                            an entry of Table 3-2 of [SP800-78] based on the
                            public key algorithm and size (Step 4).



                                          97
