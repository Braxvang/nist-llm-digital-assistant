                                                                                              NIST SP 800-77 REV. 1                                                                                 GUIDE TO IPSEC VPNS


                                                                                                   18. Apply the access control list. The access control list is applied to the back-facing
                                                                                                       interface.

                                                                                                       interface g1/1
                                                                                                        ip access-group outside_in in

                                                                                                   19. Enable the generation of syslog messages. The following commands will enable syslog
                                                                                                       message generation for IKE and IPsec, providing visibility when the sessions start and
                                                                                                       end.

                                                                                                       Crypto logging ikev2
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                                       crypto logging session

                                                                                                   20. Review the configuration. After configuring both routers, the administrators review the
                                                                                                       routersâ€™ configurations to ensure that all the necessary settings are in place. 83 The
                                                                                                       following commands can be used to display the policies:

                                                                                                       show crypto ikev2 policy
                                                                                                       show crypto ikev2 profile
                                                                                                       show crypto ipsec profile
                                                                                                       show crypto map
                                                                                                       show run | section crypto
                                                                                                       show run interface tunnel 1

                                                                                                   21. Test the solution. Administrators can test the solution by attempting to gain access to the
                                                                                                       main office resources from a desktop at the remote office. The test should also include
                                                                                                       the use of packet sniffers to monitor the network traffic at both offices and confirm that it
                                                                                                       is properly protected. If successful, the configuration could be updated to use AES 256-
                                                                                                       bit keys for ESP encryption. If the test is unsuccessful, the administrators should
                                                                                                       troubleshoot the problem, make any necessary corrections or changes, then test the
                                                                                                       solution again. 84 Additional test actions should include implementing the restrictive
                                                                                                       packet filters, verifying them, and verifying that the correct algorithms are used. For
                                                                                                       example, some IPsec implementations have a fallback policy that causes weaker
                                                                                                       algorithms to be used if the user-selected settings cannot be negotiated successfully; this
                                                                                                       could provide inadequate protection for communications.

                                                                                              9.1.4    Analysis

                                                                                              Setting up an IPsec tunnel between internet routers can be effective in connecting remote offices
                                                                                              with multiple users to another network. It can reduce costs because remote offices only need
                                                                                              internet connectivity rather than a leased line. In addition, all traffic from the remote office could


                                                                                              83   Appendix C.1 contains a sample configuration file from one of the routers.
                                                                                              84   The debug crypto ikev2, debug crypto ipsec, and debug crypto engine commands cause the router to display any errors
                                                                                                   related to the crypto implementation in the terminal window. This can be useful in determining why a connection is failing.
                                                                                                   The clear crypto ikev2 sa and clear crypto ipsec sa commands can also be used to clear part or all of the IKE and SA
                                                                                                   databases, which may clear some errors.



                                                                                                                                                            102
