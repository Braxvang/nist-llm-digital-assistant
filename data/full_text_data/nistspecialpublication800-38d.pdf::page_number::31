                                  NIST Special Publication 800-38D


When power is restored, neither the preceding IV nor any other previous IV shall immediately be
repeated for the key. One way to avoid such a repetition would be to ensure that the invocation
field value that is periodically stored in the non-volatile memory is always one or more values
ahead of the operational value in the sequence.

One potential advantage of the RBG-based construction is that the RBG may be designed to
recover from a loss of power in a straightforward manner, i.e., without requiring action from the
IT professional that maintains the system. For example, the RBG may incorporate a non-
deterministic source of bits that would automatically be available to the RBG when power is
restored.

Alternatively, the entire state of the RBG may be stored periodically in non-volatile memory. In
this case, similar to the deterministic construction, when power is restored, the design shall
ensure that the RBG shall not output strings for use within new IVs until the state of the RBG is
advanced beyond the state that generated the last IV for the key. In other words, the direct
random string for the first new IV shall be, with high probability, different than the direct
random string in any IV that was generated before the loss of power.

Even if the process is not automatic, the IT professional who maintains the system may simply
reinitialize the RBG when power is restored, for example, with a fresh seed. In this case, either
the design of the module or the IT professional that maintains the system shall ensure that
compliance is maintained with the independence condition on the RBGs in Sec. 8.2.2.

9.2       Operational Considerations

Compliance with the uniqueness requirement on IVs, and hence the security of GCM, ultimately
depends on the IT professional who configures, deploys, and maintains the GCM modules within
a particular system. The documentation for a GCM module shall give the IT professional
detailed instructions that are tailored to the particular design of the module.

The following are some typical operational considerations for the uniqueness requirement:

      •    Is the configuration of any GCM module, or any operational value, vulnerable to control
           or influence from any unauthorized party?

      •    For any given key, how are configuration choices enforced across all modules that ever
           implement the authenticated encryption function?

      •    How is the freshness of keys assured, as discussed in Sec. 8.1?

      •    If an implementation does not exclusively use 96-bit IVs that are generated by the
           deterministic construction, how is the requirement in Sec 8.3 on the number of
           invocations ensured?

      •    As discussed in Sec. 9.1, how does IV generation within the modules recover from a loss
           of power without violating the uniqueness requirement on IVs?




                                                   23
