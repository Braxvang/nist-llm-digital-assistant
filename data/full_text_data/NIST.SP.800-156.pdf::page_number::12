NIST SP 800-156                                                   REPRESENTATION OF PIV CHAIN-OF-TRUST
                                                                                FOR IMPORT AND EXPORT


3     Chain-of-Trust Schema Description

The chain-of-trust data is encoded in the XML format specified in this document. The
chain-of-trust XML records are intended to be used in a direct-exchange. While log and
historical data are not included in the XML chain-of-trust record, the issuer of the chain-
of-trust record should be able to correlate the chain-of-trust record to the associated log
and historic data, if requested to do so by the recipient of the chain-of-trust record. The
<PIVTrustChain> element may include the records for multiple subjects, with each
<EnrollmentRecord> element containing the record for a single subject.

This section contains an overview of the elements that may appear in a chain-of-trust
XML file.

3.1   Schema Header and Namespace Declarations

The following schema fragment defines the XML namespaces and other header
information for the PIV chain-of-trust schema:
<xs:schema elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema"
       targetNamespace="http://csrc.nist.gov/ns/piv/chain-of-trust/1.0"
       xmlns="http://csrc.nist.gov/ns/piv/chain-of-trust/1.0"
       xmlns:ds="http://www.w3.org/2000/09/xmldsig#"
       xmlns:xenc="http://www.w3.org/2001/04/xmlenc#">

<xs:import namespace="http://www.w3.org/2000/09/xmldsig#"
       schemaLocation="http://www.w3.org/TR/2002/REC-xmldsig-core-20020212/xmldsig-core-
       schema.xsd"/>
<xs:import namespace="http://www.w3.org/2001/04/xmlenc#"
       schemaLocation="http://www.w3.org/TR/2002/REC-xmlenc-core-20021210/xenc-schema.xsd"/>

3.2   Element <PIVChainOfTrust>

The following schema fragment defines the <PIVChainOfTrust> element:
<xs:element name="PIVChainOfTrust" type="PIVChainOfTrustType"/>


The <PIVChainOfTrust> element is of PIVChainOfTrustType complex type, and
carries one or more <EnrollmentRecord> elements.

3.3   Complex Type PIVChainOfTrustType

The following schema fragment defines the PIVChainOfTrustType complex type:
<xs:complexType name="PIVChainOfTrustType">
  <xs:sequence>
    <xs:choice>
      <xs:sequence>
        <xs:element ref="xenc:EncryptedData" minOccurs="1" maxOccurs="1"/>
        <xs:element ref="xenc:EncryptedKey" minOccurs="1" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:sequence>
        <xs:element name="EnrollmentRecord" type="EnrollmentRecordType" minOccurs="1"
       maxOccurs="unbounded"/>
        <xs:element ref="ds:Signature" minOccurs="1" maxOccurs="1"/>
      </xs:sequence>
    </xs:choice>
  </xs:sequence>

                                                6
