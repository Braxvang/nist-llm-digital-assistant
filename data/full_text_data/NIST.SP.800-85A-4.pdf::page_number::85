NIST SP 800-85A-4                                         PIV CARD APPLICATION & MIDDLEWARE
                                                                   INTERFACE TEST GUIDELINES

                        2. Set OID := <<valid OID>>
                        3. Set data := <<a correctly formatted byte sequence>
                        4. Call pivPutData with (for all data objects)
                           • (IN) cardHandle
                           • (IN) OID
                           • (IN) oidLength
                           • (IN) data
                           • (IN) dataLength
 Expected Result(s)     Call returns with status_word of PIV_OK for each test case.
 Postcondition(s)       Validate that the PIV Card Application has written the entire dataset
                        of the selected object requested by the client application by issuing
                        pivGetData function call.



B.7.2           Test Assertions for Error Conditions

B.7.2.1          Identify and Handle an Invalid cardHandle
 Purpose                 Ensure the PIV Middleware identifies and responds to an invalid
                         card handle.
 Target                 pivPutData
 Reference(s)           1. SP 800-73-4 Part 3, Section 3.4.1
                        2. AS04.09
 Precondition(s)        1. The client application owns a connection to the PIV Card
                           Application accessible through cardHandle.
                        2. The client application has successfully selected the PIV Card
                           Application.
                        3. Mutual authentication with the client application using the PIV
                           Card Application Administration key has taken place.
 Test Steps             1. Set cardHandle := <<invalid cardHandle>>
                        2. Set OID := <<valid OID>>
                        3. Set data := <<a correctly formatted byte sequence>
                        4. Call pivPutData with
                           • (IN) cardHandle
                           • (IN) OID
                           • (IN) oidLength
                           • (IN) data
                           • (IN) dataLength
 Expected Result(s)     Call returns with status_word of PIV_INVALID_CARD_HANDLE.
 Postcondition(s)       The precondition states remain unchanged.


B.7.2.2       Identify and Handle an Invalid Object Identifier (OID)
 Purpose              Ensure the PIV Middleware identifies and handles an invalid OID.
 Target               pivPutData
 Reference(s)         1. SP 800-73-4 Part 3, Section 3.4.1
                      2. AS04.09


                                         B-19
