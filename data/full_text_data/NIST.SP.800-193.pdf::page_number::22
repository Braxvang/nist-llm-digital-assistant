                                                                                             NIST SP 800-193                                           PLATFORM FIRMWARE RESILIENCY GUIDELINES


                                                                                             3.5     Firmware Update Mechanisms

                                                                                             A central tenet to the firmware protection guidelines is ensuring that only authentic and
                                                                                             authorized firmware update images may be applied to platform devices. An update image is
                                                                                             authentic if the source (e.g., the device, system manufacturer, or another authorized entity) and
                                                                                             integrity can be successfully verified. Technical processes to verify images before applying
                                                                                             updates are called authenticated update mechanisms.

                                                                                             Authorization, however, is the permission to perform an update. While authentication is
                                                                                             typically rooted in the device or system manufacturer, authorization to perform updates is
                                                                                             typically rooted in the device or system owner.

                                                                                             3.5.1    Authenticated Update Mechanism
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-193




                                                                                             An authenticated update mechanism employs digital signatures to ensure the authenticity of the
                                                                                             firmware update image. An update of the firmware image using an authenticated update
                                                                                             mechanism relies on a Root of Trust for Update (RTU) that contains a signature verification
                                                                                             algorithm and a key store that includes the public key needed to verify the signature on the
                                                                                             firmware update image. The key store and the signature verification algorithm are stored in a
                                                                                             protected fashion on the computer system and are modifiable only through use of an
                                                                                             authenticated update mechanism or a secure local update mechanism.

                                                                                             The key store in the RTU includes a public key used to verify the signature [7] on a firmware
                                                                                             update image or includes a hash [6] of the public key if a copy of the public key is provided with
                                                                                             the firmware update image. In the latter case, the update mechanism hashes the public key
                                                                                             provided with the firmware update image and ensures that it matches a hash which appears in the
                                                                                             key store before using the provided public key to verify the signature on the firmware update
                                                                                             image.

                                                                                             It is possible that the private key corresponding to the public key in the key store may become
                                                                                             “compromised”, for example, by the private key being stolen and exposed. An attacker that gains
                                                                                             access to this key could sign invalid firmware that might damage platform devices or inject
                                                                                             malware into the platform. Proper use of signatures thus necessitates provisions to recover from
                                                                                             a key compromise. A variety of techniques may be used to recover from these situations.
                                                                                             Examples range from the complex, including key hierarchies, to simpler, including updating the
                                                                                             key store when recovering (or updating) the rest of an image.

                                                                                             3.5.2    Authorized Update Mechanism

                                                                                             A system and its supporting management software and firmware may provide several authorized
                                                                                             mechanisms for legitimately updating a firmware image. These include:

                                                                                                   1) User-Initiated Updates: Vendors typically supply end users with utilities capable of
                                                                                                      updating a firmware image. This could be from external media to perform these updates,
                                                                                                      or via utilities that can update the firmware image from the user’s normal operating
                                                                                                      system. Depending on the security mechanisms implemented on the system, these
                                                                                                      utilities might directly update the firmware image or they may schedule an update for the
                                                                                                      next system reboot. The updated code will encounter critical data written by a different

                                                                                                                                              14
