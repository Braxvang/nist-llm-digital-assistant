                                                                                               NIST SP 800-177 REV. 1                                                                            TRUSTWORTHY EMAIL




                                                                                               4.4.2      SPF on the Sender Side

                                                                                               Deploying SPF for a sending domain is fairly straightforward. It does not even require SPF
                                                                                               aware code in mail servers, as receivers, not senders, perform the SPF processing. �e only
                                                                                               necessary actions are identifying IP addresses or ranges of permitted sending hosts for a given
                                                                                               domain and adding that information in the DNS as a new resource record.

                                                                                               4.4.2.1 Identifying Permitted Senders for a Domain and Setting the Policy

                                                                                               �e ﬁrst step in deploying SPF for a sending domain is to identify all the hosts that send email
                                                                                               out of the domain (i.e., SMTP servers that are tasked with being email gateways to the Internet).
                                                                                               �is can be hard to do because:

                                                                                                      •    �ere may be mail-sending SMTP servers within sub-units of the organization that are
                                                                                                           not known to higher-level management.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-177r1




                                                                                                      •    �ere may be other organizations that send mail on behalf of the organization (such as e-
                                                                                                           mail marketing ﬁrms or legitimate bulk-mailers).
                                                                                                      •    Individuals who work remotely for the organization may send mail using their
                                                                                                           organization’s email address but a local mail relay.

                                                                                               If the senders cannot be listed with certainty, the SPF policy can indicate that receivers should
                                                                                               not necessarily reject messages that fail SPF checks by using the “~” or “?” mechanisms, rather
                                                                                               than the “-“ mechanism (see 4.3.2.2 below) in the SPF TXT record.

                                                                                               Note: Deployment of DMARC [RFC7489] (discussed below) allows for reporting SPF check
                                                                                               results back to sending domain owners, which allows senders to modify and improve their policy
                                                                                               to minimize improper rejections.

                                                                                               4.4.2.2 Forming the SPF Resource Record

                                                                                               Once all the outgoing senders are identiﬁed, the appropriate policy can be encoded and put into
                                                                                               the domain database. �e SPF syntax is fairly rich and can express complex relationships
                                                                                               between senders. Not only can entities be identiﬁed and called out, but the SPF statement can
                                                                                               also request what emphasis should be placed on each test.

                                                                                               SPF statements are encoded in ASCII text (as they are stored in DNS TXT resource records) and
                                                                                               checks are processed in left to right order. Every statement begins with v=spf1 to indicate that
                                                                                               this is an SPF (version 1) statement 8.

                                                                                               Other mechanisms are listed in Table 4-1:




                                                                                               8
                                                                                                   Note that there is a technology called SenderID that uses "v=spf2.0", but it is not an updated version of SPF, but a
                                                                                                     different protocol, not recommended in these guidelines.

                                                                                                                                                           30
