the key exchange (see the SSH TLP protocol discussion in Section 10.1.1). Using the
encrypted SSH tunnel, the server can securely perform any client authentication. The
UAP provides a single authenticated tunnel for the SSH connection protocol.

10.1.3 Connection Protocol (CP)
The Connection Protocol [RFC 4254] multiplexes the encrypted tunnel used by SSH into
several logical channels. The CP defines how interactive login sessions, remote execution
of commands, forwarded TCP/IP connections, and forwarded X11 connections [X11] can
be run simultaneously over an established SSH Transport Layer and User Authentication
connection.

10.2 Security and Compliance Issues
10.2.1 TLP Issues

10.2.1.1 Algorithm Negotiation
In this step of the TLP, the algorithms to be used for the key exchange (i.e., key
agreement), public key authentication, data encryption and message authentication are
selected.
    1. The SSH server and client should choose the same NIST-approved cryptographic
         algorithms for both communication directions (data streams) for a particular
         cryptographic service. For example, the same encryption algorithm and MAC-
         generation algorithm should be used for both communication directions to
         provide confidentiality and integrity protection, respectively.
       Note: The cryptographic algorithms selected for use depend on the algorithms that
       are supported by both the server and the client, and by the client’s preference
       levels for these algorithms in each of its algorithm lists offered in the negotiation;
       the client’s preference level is indicated by the order in which the algorithms are
       listed. See [RFC 4253, Sec. 7.1] for the defined procedure for selecting the
       cryptographic algorithms.

   2. Suite B cryptographic algorithms are recommended for use when supported by
      both the client and server systems. Suite B cryptographic algorithms are specified
      in [RFC 6239]. They are:
          Key agreement (key exchange): ecdh-sha2-nistp256 and ecdh-sha2-nistp384
           (see Section 10.2.1.2).
          Public key algorithm (for server and client authentications): x509v3-ecdsa-
           sha2-nistp256 and x509v3-ecdsa-sha2-nistp384 (see Section 10.2.1.3).
            The public keys are conveyed in X.509 version 3 certificates.
          Encryption and MAC: AEAD_AES_128_GCM and AEAD_AES_256_GCM
           (see Sections 10.2.1.4 and 10.2.1.5).

10.2.1.2 Key Agreement /Key Exchange Algorithms
Two families of Diffie-Hellman key-agreement/key-exchange algorithms have been
specified for use in SSH: those based on finite fields and those based on elliptic curves.

                                             63
