                                                                                               NIST SP 800-56B REV. 2                          RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                    USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                                         - message_stringP is a six-byte character string, with a value of “KC_1_U” when
                                                                                                           party U is providing the MAC tag, or “KC_1_V” when party V is providing the
                                                                                                           MAC tag. (Note that these values will be changed for bilateral key confirmation, as
                                                                                                           specified in Section 5.6.2).
                                                                                                         - IDP is the identifier used to label the key-confirmation provider.
                                                                                                         - IDR is the identifier used to label the key-confirmation recipient.
                                                                                                         - EphemDataP and EphemDataR are (ephemeral) values contributed by the KC
                                                                                                           provider and recipient, respectively. These values are specified in the sections
                                                                                                           describing the schemes that include key confirmation.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                                         - TextP is an optional bit string that may be used during key confirmation and that is
                                                                                                           known by both parties.
                                                                                                      The content of each of the components that are concatenated to form MacDataP shall be
                                                                                                      precisely defined and unambiguously represented. A particular component’s content may
                                                                                                      be represented, for example, as a fixed-length bit string or in the form Datalen || Data,
                                                                                                      where Data is a variable-length string of zero or more (eight-bit) bytes, and Datalen is a
                                                                                                      fixed-length, big-endian counter that indicates the length (in bytes) of Data. These
                                                                                                      requirements could also be satisfied by using a specific ASN.1 DER encoding of each
                                                                                                      component. It is imperative that the provider and recipient have agreed upon the content
                                                                                                      and format that will be used for each component of MacDataP.
                                                                                                      MacData shall include a non-null identifier, IDP, for the key-confirmation provider.
                                                                                                      Depending upon the circumstances, the key-confirmation recipient’s identifier, IDR, may
                                                                                                      be replaced by a null string. The rules for selecting IDP and IDR are as follows:
                                                                                                         As specified in this Recommendation, the key-confirmation provider must own a key
                                                                                                         pair that is employed by the basic key-establishment scheme (KAS1-basic, KAS2-
                                                                                                         basic or KTS-OAEP-basic) that determines the MacKey value used in the key-
                                                                                                         confirmation computations performed during the transaction. The identifier, IDp,
                                                                                                         included in MacDataP shall be one that has a trusted association with the public key of
                                                                                                         that key pair.
                                                                                                         For the KAS2 family of schemes, the identifier of the key-confirmation recipient
                                                                                                         included in MacDataP (i.e., IDR) shall be one that has a trusted association with the
                                                                                                         public key of the key pair used by the key-confirmation recipient during the transaction.
                                                                                                         If the key-confirmation recipient does not own a key pair employed for key-
                                                                                                         establishment purposes, and no identifier has been used to label that party during the
                                                                                                         execution of the basic key-establishment scheme employed by the transaction, then IDR
                                                                                                         may be replaced by a null string. However, if an identifier is desired/required for that
                                                                                                         party for key confirmation purposes, then a non-null value for IDR, shall be
                                                                                                         selected/assigned in accordance with the requirements of the protocol relying upon the
                                                                                                         transaction.
                                                                                                         Whenever a particular identifier has been used to label the key-confirmation recipient
                                                                                                         or key-confirmation provider in the execution of the basic key-establishment scheme

                                                                                                                                              31
