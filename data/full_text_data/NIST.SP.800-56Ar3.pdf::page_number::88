                                                                                               NIST SP 800-56A Rev. 3                                Recommendation for Pair-Wise Key Establishment
                                                                                                                                                             Using Discrete Logarithm Cryptography

                                                                                               in the combined key-agreement/key-confirmation process). They may also be sent
                                                                                               separately.
                                                                                               Party V shall destroy its copy of MacKey immediately after computing MacTagV. Party U
                                                                                               shall immediately destroy its copy of MacKey after determining whether or not the received
                                                                                               and newly computed MacTagV values match. If they do not match, then party U shall also
                                                                                               destroy the KeyData portion of the DerivedKeyingMaterial (see Section 5.9.1) and notify
                                                                                               party V that MacTagV could not be verified. In this case, party V shall also destroy the
                                                                                               KeyData portion of the DerivedKeyingMaterial.

                                                                                               6.1.1.5.3 C(2e, 2s) Scheme with Bilateral Key Confirmation
                                                                                               Figure_6 depicts a typical flow for a C(2e, 2s) scheme with bilateral key confirmation. In
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                               this method, party U and party V assume the roles of both the provider and the recipient in
                                                                                               order to obtain bilateral key confirmation. The successful completion of the key-confirmation
                                                                                               process provides each party with a) assurance that the other party has derived the same secret
                                                                                               Z value, and b) assurance that the other party has actively participated in the process.


                                                                                                                 U                                              V
                                                                                                                             U’s Static Public Key

                                                                                                                             V’s Static Public Key                     Obtain static
                                                                                                                                                                       public keys

                                                                                                                           U’s Ephemeral Public Key                    U sends an ephemeral
                                                                                                                                                                       public key

                                                                                                                        V’s Ephemeral Public Key, MacTagV              V sends an ephemeral
                                                                                                                                                                       public key with key
                                                                                                                                                                       confirmation
                                                                                                                                   MacTagU
                                                                                                                                                                       U’s key
                                                                                                                                                                       confirmation



                                                                                                              Figure 6: C(2e, 2s) scheme with bilateral key confirmation

                                                                                               To provide bilateral key confirmation (as described in Section 5.9.2), party U and party V
                                                                                               exchange and verify MacTags that have been computed (as specified in Section 5.2.1) using
                                                                                                          EphemDataU = EphemPubKeyU, and EphemDataV = EphemPubKeyV.
                                                                                               Party V provides MacTagV to party U (as specified in Sections 5.9.1 and 5.9.2, with P = V
                                                                                               and R = U); MacTagV is computed by party V (and verified by party U) using
                                                                                                   MacDataV = “KC_2_V” || IDV || IDU || EphemPubKeyV || EphemPubKeyU {|| TextV}.
                                                                                                                                             77
