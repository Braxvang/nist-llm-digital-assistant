                                                                                               NIST SP 800-56A Rev. 3                              Recommendation for Pair-Wise Key Establishment
                                                                                                                                                           Using Discrete Logarithm Cryptography

                                                                                                      2. If s is not the maximum security strength that can be supported by the domain
                                                                                                         parameters, then return an ERROR indication as the status and (Invalid_d,
                                                                                                         Invalid_Q) as the key pair; then exit the process without performing the remaining
                                                                                                         steps.
                                                                                                      3. L = len(n) + 64.
                                                                                                      4. Obtain a string of L returned_bits using an RBG with a security strength of s bits
                                                                                                         or more (see Section 5 in SP 800-133). If an ERROR indication is returned, then
                                                                                                         return an ERROR indication as the status and (Invalid_d, Invalid_Q) as the key
                                                                                                         pair; then exit the process without performing the remaining steps.
                                                                                                      5. Convert returned_bits to the (non-negative) integer c in the interval
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                                         [0, 2L – 1] (see Appendix C.4).
                                                                                                      6. d = (c mod (n – 1)) + 1.
                                                                                                      7. Q = dG.
                                                                                                      8. Return SUCCESS as the status and (d, Q) as the key pair.
                                                                                                  Output: SUCCESS and (d, Q), or
                                                                                                      an ERROR indication and (Invalid_d, Invalid_Q).

                                                                                               5.6.1.2.2 Key Pair Generation by Testing Candidates
                                                                                               In this method, a random number is obtained and tested to determine whether or not it will
                                                                                               produce a value of d in the correct interval. If d would be outside the interval, another random
                                                                                               number is obtained (i.e., the process is iterated until an acceptable value of d is obtained).
                                                                                               The following process or its equivalent may be used to generate an ECC key pair.
                                                                                                  Input:
                                                                                                      1. (q, FR, a, b {, domain_parameter_seed}, G, n, h)
                                                                                                                  The ECC domain parameters that are used for this process. n is a prime
                                                                                                                  number, and G is a point on the elliptic curve (with the additive order n).
                                                                                                      2. s        The maximum security strength to be supported by the key pair.
                                                                                                  Output:
                                                                                                      1. status The status returned from the key pair generation procedure. The status
                                                                                                                will indicate SUCCESS or an ERROR.
                                                                                                      2.   (d, Q) The generated private and public keys. If an error is encountered during
                                                                                                                  the generation process, invalid values for d and Q should be returned, as
                                                                                                                  represented by Invalid_d and Invalid_Q in the following specification; for
                                                                                                                  example, Invalid_d and Invalid_Q could be a point that is not on the
                                                                                                                  elliptic curve defined by the domain parameters. d is an integer in the
                                                                                                                  interval [1, n–1], and Q is an elliptic curve point.



                                                                                                                                             31
