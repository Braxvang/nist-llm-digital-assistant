NIST SP 800-90A Rev. 1                                              Recommendation for Random Number
                                                                     Generation Using Deterministic RBGs


             4.2     output_block = Block_Encrypt (Key, V).
             4.3     temp = temp || output_block.
       5. returned_bits = leftmost (temp, requested_number_of_bits).
                                                 Comment: Update for backtracking resistance.
       6. (Key, V) = CTR_DRBG_Update (additional_input, Key, V).
       7. reseed_counter = reseed_counter + 1.
       8. Return (SUCCESS, returned_bits, Key, V, reseed_counter).
10.2.1.5.2         Generating Pseudorandom Bits When a Derivation Function is Used

This method of generating bits is used when a derivation function is used by an implementation.
Let df be the derivation function specified in Section 10.3.2.
The following process or its equivalent shall be used as the generate algorithm for this DRBG
mechanism (see step 8 of the generate process in Section 9.3.3):
   CTR_DRBG_Generate_algorithm (working_state, requested_number_of_bits,
     additional_input):
       1. working_state: The current values for V, Key, and reseed_counter (see Section
          10.2.1.1).
       2. requested_number_of_bits: The number of pseudorandom bits to be returned to the
          generate function.
       3. additional_input: The additional input string received from the consuming
          application. Note that the length of the additional_input string may be zero.
   Output:
       1. status: The status returned from the function. The status will indicate SUCCESS, or
          indicate that a reseed is required before the requested pseudorandom bits can be
          generated.
       2. returned_bits: The pseudorandom bits returned to the generate function.
       3. working_state: The new values for V, Key, and reseed_counter.
   CTR_DRBG Generate Process:
       1. If reseed_counter > reseed_interval, then return an indication that a reseed is
          required.
       2. If (additional_input â‰  Null), then
                   2.1 additional_input = Block_Cipher_df (additional_input, seedlen).
                   2.2 (Key, V) = CTR_DRBG_Update (additional_input, Key, V).
             Else additional_input = 0seedlen.
       3. temp = Null.


                                                    57
