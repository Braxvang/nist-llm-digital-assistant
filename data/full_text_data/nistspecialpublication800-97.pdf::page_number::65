                                   ESTABLISHING WIRELESS ROBUST SECURITY NETWORKS: A GUIDE TO IEEE 802.11I



based access control. Using this concept, IEEE 802.1X achieves the objective of blocking access for
unauthorized parties in an IEEE 802.11 WLAN.

The authentication message flows between the client and the authenticator typically use the EAP over
LAN (EAPOL) protocol. RADIUS is the protocol most commonly used to transport EAP messages
between the authenticator and the AS. The steps in a typical successful IEEE 802.1X authentication
exchange when RADIUS is used to support authentication-related traffic on the DS are as follows:

    1. The supplicant (client) may start the exchange with an optional EAPOL-Start message.
    2. The EAP exchange begins with the authenticator issuing an EAP-Request/Identity frame to the
       supplicant.
    3. The supplicant replies with an EAP-Response/Identity frame, which the AP receives over the
       uncontrolled port. The packet is then encapsulated in RADIUS over EAP and passed on to the
       RADIUS server as a RADIUS-Access-Request packet.
    4. The AAA server replies with a RADIUS-Access-Challenge packet, which is passed on to the
       supplicant as an EAP-Request. This request is of the appropriate authentication type and contains
       relevant challenge information.
    5. The supplicant formulates an EAP-Response message and sends it to the authenticator. The
       response is translated by the authenticator into a Radius-Access-Request, with the response to the
       challenge as a data field. Steps 4 and 5 may be repeated multiple times, depending on the EAP
       method in use. For TLS tunneling methods, it is common for authentication to require 10-20
       round trips.
    6. The AAA server grants access with a Radius-Access-Accept packet. The authenticator issues an
       EAP-Success frame. (Some protocols require confirmation of the EAP success inside the TLS
       tunnel for authenticity validation.) The controlled port is authorized, and the user may begin to
       access the network.
    7. During the termination phase, when the supplicant is finished accessing the network, it may send
       an optional EAPOL-Logoff message to restore the controlled port to an unauthorized state.
Figure 5-10 depicts the authentication frame flow in an IEEE 802.11 RSNA. As shown, authentication
occurs between the STA and AS, with the AP assisting in the networking dialog. The IEEE 802.1X
controlled port is blocked before the EAP authentication procedures take place. The EAP authentication
process, which occurs over the IEEE 802.1X uncontrolled port, starts when the AP sends the EAP-
Request frame to the STA, or the STA sends the EAPOL-Start frame. EAP frames pass between the STA
and the AS via the uncontrolled ports.

At the conclusion of the authentication dialog, the AP controlled port is still blocked to general user
traffic. Although the authentication is successful, the ports remain blocked until the temporal keys are
installed in the STA and AP, which occurs during the 4-Way Handshake. This blocking keeps
unauthorized traffic from entering the DS and prevents any traffic from the DS from being transmitted
wirelessly. The STA may also initiate an IEEE 802.1X authentication frame exchange. In this case, the
exchange is the same, with the exception that the STA initiates it by issuing an EAPOL-Start message to
the AP.




                                                  5-13
