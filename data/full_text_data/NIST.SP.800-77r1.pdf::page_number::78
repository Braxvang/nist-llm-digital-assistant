                                                                                              NIST SP 800-77 REV. 1                                                          GUIDE TO IPSEC VPNS


                                                                                                      and remote access architectures), and host address space management considerations (for
                                                                                                      host-to-host and remote access architectures).
                                                                                                 •    Cryptography for Authentication. The IPsec implementation must have an
                                                                                                      authentication method selected, such as the use of a digital signature or PSK. Only NIST-
                                                                                                      approved methods and algorithms shall be used. See NIST SP 800-131A [18].
                                                                                                 •    Cryptography for Key Exchange, Confidentiality, and Integrity. The algorithms for
                                                                                                      DH key exchange, encryption, and integrity protection must be selected, as well as the
                                                                                                      key lengths for algorithms that support multiple key lengths. Only NIST-approved
                                                                                                      methods and algorithms shall be used. See NIST SP 800-131A [18].
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                                 •    Performance. Components of the IPsec implementation may need to take performance
                                                                                                      into consideration, such as tuning their configurations, using particular algorithms, or
                                                                                                      enabling particular options.
                                                                                                 •    Packet Filter. The packet filter determines what types of traffic should be permitted,
                                                                                                      what should be denied, and what protection and compression measures (if any) should be
                                                                                                      applied to each type of permitted traffic (e.g., ESP tunnel using AES for encryption and
                                                                                                      HMAC-SHA256 for integrity protection; Lempel-Ziv-Stac [LZS] for compression).

                                                                                              The decisions made regarding cryptography and packet filters are all documented in the IPsec
                                                                                              policy. In its simplest form, an IPsec policy is a set of rules that govern the use of the IPsec
                                                                                              protocol. It specifies the data to secure and the security method to use to secure that data. An
                                                                                              IPsec policy determines the type of traffic that is allowed through IPsec endpoints and generally
                                                                                              consists of a packet filter and a set of security parameters for traffic that matches the packet
                                                                                              filter. Those parameters include the authentication and encryption scheme and tunnel settings.
                                                                                              When communications occur, each packet filter can result in the establishment of one or more
                                                                                              IPsec SAs that enable protected communications satisfying the security policy for that packet
                                                                                              filter.

                                                                                              Other decisions should also be made during the design phase, such as setting IKE and IPsec SA
                                                                                              lifetimes and identifying which DH group number is best. In addition to meeting the
                                                                                              organization’s cryptographic requirements of NIST SP 800-131A [18] and FIPS 140 [13][14],
                                                                                              design decisions should incorporate the organization’s logging and data management strategies,
                                                                                              incident response and recovery plans, resource replication and failover needs, and current and
                                                                                              future network characteristics, such as the use of wireless, NAT, and IPv6. Section 7.2.6 covers
                                                                                              these considerations and design decisions in more detail.

                                                                                              7.2.1   Architecture

                                                                                              The architecture of the IPsec implementation refers to the selection of devices and software to
                                                                                              provide IPsec services and the placement of IPsec endpoints within the existing network
                                                                                              infrastructure. These two considerations are often closely tied together; for example, a decision
                                                                                              could be made to use the existing internet firewall as the IPsec gateway. This section explores
                                                                                              three particular aspects of IPsec architecture: gateway placement, IPsec client software for hosts,
                                                                                              and host address space management.




                                                                                                                                              61
