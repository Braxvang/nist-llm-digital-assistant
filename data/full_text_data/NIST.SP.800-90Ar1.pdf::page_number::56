NIST SP 800-90A Rev. 1                 HMAC_DRBG           Recommendation for Random Number
                                                            Generation Using Deterministic RBGs


   HMAC_DRBG_Generate_algorithm (working_state, requested_number_of_bits,
       additional_input):
       1. working_state: The current values for V, Key and reseed_counter (see Section
          10.1.2.1).
       2. requested_number_of_bits: The number of pseudorandom bits to be returned to
          the generate function.
       3. additional_input: The additional input string received from the consuming
          application. Note that the length of the additional_input string may be zero.
       Output:
       1. status: The status returned from the function. The status will indicate
          SUCCESS, or indicate that a reseed is required before the requested
          pseudorandom bits can be generated.
       2. returned_bits: The pseudorandom bits to be returned to the generate function.
       3. new_working_state: The new values for V, Key and reseed_counter.
   HMAC_DRBG Generate Process:
       1. If reseed_counter > reseed_interval, then return an indication that a reseed is
          required.
       2. If additional_input â‰  Null, then (Key, V) =
          HMAC_DRBG_Update (additional_input, Key, V).
       3. temp = Null.
       4. While (len (temp) < requested_number_of_bits) do:
           4.1   V = HMAC (Key, V).
           4.2   temp = temp || V.
       5. returned_bits = leftmost (temp, requested_number_of_bits).
       6. (Key, V) = HMAC_DRBG_Update (additional_input, Key, V).
       7. reseed_counter = reseed_counter + 1.
       8. Return (SUCCESS, returned_bits, Key, V, reseed_counter).




                                            47
