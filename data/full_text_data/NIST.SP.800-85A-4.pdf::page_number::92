NIST SP 800-85A-4                                        PIV CARD APPLICATION & MIDDLEWARE
                                                                  INTERFACE TEST GUIDELINES

                         key (with algorithm '07') or a public key (with algorithms
                         '11' or '14') instead of a challenge

 Expected Result(s)   Call returns with status_word of PIV_OK with the algorithmOutput
                      carrying the signed challenge, transported key, shared secret Z, or a
                      signature from the card.
 Postcondition(s)     N/A

B.9.1.2       Mutual Authentication of Client Application and Card Application
 Purpose             Exercise the PIV Card Application to perform Mutual Authenticate.
 Target              pivCrypt
 Reference(s)        1. SP 800-73-4 Part 3, Section 3.3.1
                     2. AS04.01, AS04.02A-R4, AS04.08
 Precondition(s)     1. The client application owns a connection to the PIV Card
                        Application accessible through cardHandle.
                     2. The client application has successfully executed the
                        pivSelectCardApplication command.
 Test Steps          1. Set cardHandle := <<valid cardHandle>>
                      2. Set keyReference := <<'9B'>>
                      3. Set algorithmIdentifier := <<'00', '03', '08', '0A', or
                         '0C'>>
                      4. Set algorithmInput := <<Use the Dynamic Authentication
                         Template format (Table 7 of SP 800-73-4 Part 2) to request
                         a witness from the card, then issue a second call that
                         contains the decryption of the encrypted challenge from
                         the card appended with the client’s application-generated
                         challenge.>>
                      5. Create algorithmOutput reference
                      6. Call pivCrypt with
                         • (IN) cardHandle
                         • (IN) algorithmIdentifier
                         • (IN) keyReference
                         • (IN) algorithmInput
                         • (IN) inputLength
                         • (OUT) algorithmOutput
                         • (INOUT) outputLength
 Expected Result(s)   1. The first call returns with status_word of PIV_OK with the
                          algorithmOutput carrying the encrypted challenge from the card.
                      2. The second call returns with status_word of PIV_OK with
                          algorithmOutput carrying the encrypted data of the client’s
                          application-generated challenge.
 Postcondition(s)     The client application and the PIV Card Application are mutually
                      authenticated and set security state accordingly.


B.9.1.3        Authenticate the Client Application to Card Application
 Purpose             Exercise the PIV Card Application to perform External Authenticate.



                                      B-26
