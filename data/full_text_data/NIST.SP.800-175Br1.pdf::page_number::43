                                                                                                NIST SP 800-175B REV. 1                        GUIDELINE FOR USING CRYPTO STANDARDS IN THE
                                                                                                                                                            FED. GOV'T.: CRYPTO MECHANISMS

                                                                                                MACs are used to detect data modifications that occur between the initial generation of the
                                                                                                MAC and the verification of the received or retrieved MAC. They do not detect errors that
                                                                                                occur before the MAC is originally generated. The use of MACs to provide data integrity
                                                                                                and source authentication depends on limiting knowledge of the secret key to only those
                                                                                                parties generating the MAC and those intended to retrieve or receive it. Since a MAC key
                                                                                                is shared among a community of users (e.g., two or more parties), only those parties sharing
                                                                                                the key can compute a correct MAC on given data.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-175Br1




                                                                                                                  Figure 3: Message Authentication and Verification
                                                                                                Figure 3 depicts the use of message authentication codes:
                                                                                                   •   A message authentication code (MAC1) is computed on data (M1) using a key (K).
                                                                                                       M1 and MAC1 are then saved or transmitted.
                                                                                                   •   At a later time, the integrity of the saved or received data is checked. Consider the
                                                                                                       saved or received data as M2 and the saved or received message authentication code
                                                                                                       as MAC1.
                                                                                                   •   Compute a message authentication code on M2 using the same key (K), and label
                                                                                                       that message authentication code as MAC2.
                                                                                                   •   If MAC1 = MAC2, then it can be assumed that M2 (the saved or retrieved data) is the
                                                                                                       same as the data on which MAC1 was computed (M1) (i.e., M1 = M2).
                                                                                                Assurance of data integrity is frequently provided using non-cryptographic techniques
                                                                                                known as error detection codes. However, these codes can be altered by an adversary to
                                                                                                the adversary’s benefit. The use of an approved cryptographic mechanism, such as a
                                                                                                MAC, addresses this problem. That is, the assurance of integrity provided by a MAC is
                                                                                                based on the assumption that it is not likely that anyone could correctly generate a MAC
                                                                                                without knowing the cryptographic key. An adversary without knowledge of the key will
                                                                                                not be able to modify data and then generate a verifiable MAC on the modified data. It is
                                                                                                therefore crucial that MAC keys be kept secret.



                                                                                                                                            35
