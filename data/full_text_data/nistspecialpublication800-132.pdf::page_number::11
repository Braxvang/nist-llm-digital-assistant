SP 800-132            Recommendation for Password-Based Key Derivation    December 2010



5.3      PBKDF Specification

The following algorithm for the derivation of MKs from passwords is based on an
algorithm specified in [6], where it was specified as PBKDF2 and used HMAC [1] with
SHA-1 as a PRF. This Recommendation approves PBKDF2 as the PBKDF using HMAC
with any approved hash function as the PRF. The digest size of the hash function in bits
is denoted as hLen.

The details of the PBKDF algorithm are given below.


Input:            P        Password
                  S        Salt
                  C        Iteration count
                  kLen     Length of MK in bits; at most (232-1)  hLen
Parameter: PRF             HMAC with an approved hash function
                  hlen     Digest size of the hash function
Output:           mk       Master key
Algorithm:
      If (kLen > (232-1)  hLen)
             Return an error indicator and stop ;
      len = kLen / hLen ;
      r = kLen – (len – 1)  hLen ;
      For i = 1 to len
           T i = 0;
           U 0 = S || Int(i);
          For j = 1 to C
                  U j = HMAC(P, U j-1 )
                  Ti = Ti  Uj
      Return mk = T 1 || T 2 || … || T len <0…r-1>




                                                 7
