                                                                                               NIST SP 800-56B REV. 2                               RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                         USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                               5.2.1 MacTag Computation for Key Confirmation
                                                                                               The computation of a MAC tag is represented as follows:
                                                                                                                           MacTag = TMacTagBits[MAC(MacKey, MacData)].
                                                                                               To compute a MAC tag:
                                                                                               1. An approved, agreed-upon MAC algorithm (see FIPS 198, SP 800-38B or SP 800-185) is
                                                                                                  used with MacKey to compute a MAC on the MacData, where MacKey is a symmetric key,
                                                                                                  and MacData represents the data on which the MAC tag is computed. The minimum length of
                                                                                                  MacKey is specified in Section 5.6.3.
                                                                                                     MacKey is obtained from the DerivedKeyingMaterial (when a key-agreement scheme employs
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                                     key confirmation) or obtained from the TransportedKeyingMaterial (when a key-transport
                                                                                                     scheme employs key confirmation), as specified in Section 5.6.1.1.
                                                                                                     The resulting MAC consists of MacOutputBits bits, which is the full output length of the
                                                                                                     selected MAC algorithm.
                                                                                               2. The output of the MAC algorithm is input to a truncation function TMacTagBits to obtain the most
                                                                                                  significant (i.e., leftmost) MacTagBits bits, where MacTagBits represents the intended length
                                                                                                  of MacTag, which is required to be less than or equal to MacOutputBits. (When MacTagBits
                                                                                                  equals MacOutputBits, TMacTagBits acts as the identity function.) The minimum value for
                                                                                                  MacTagBits is specified in Section 5.6.3.
                                                                                               Note: A routine implementing a Mac-tag computation for key confirmation shall destroy any local
                                                                                               copies of MacKey and MacData, any locally stored portions of MacTag, and any other locally
                                                                                               stored values used or produced during the execution of the routine; their destruction shall occur
                                                                                               prior to or during any exit from the routine – whether exiting early because of an error or exiting
                                                                                               normally with MacTag as the output.

                                                                                               5.2.2 MacTag Verification for Key Confirmation
                                                                                               To verify the MAC tag received during key confirmation, a new MAC tag, MacTag′, is computed
                                                                                               as specified in Section 5.2.1 using the values of MacKey, MacTagBits, and MacData possessed by
                                                                                               the key-confirmation recipient. MacTag′ is compared with the received MAC tag (i.e., MacTag).
                                                                                               If their values are equal, then it may be inferred that the same MacKey, MacTagBits, and MacData
                                                                                               values were used in the computation of MacTag and MacTag′. That is, successful verification
                                                                                               provides evidence that the key-confirmation provider has obtained the same MAC key as the key-
                                                                                               confirmation recipient.

                                                                                               5.3         Random Bit Generators
                                                                                               Whenever this Recommendation requires the use of a randomly generated value (for example, for
                                                                                               obtaining keys or nonces), the values shall be generated using an approved random bit generator
                                                                                               (RBG), as specified in SP 800-90, 15 that supports an appropriate security strength.



                                                                                               15
                                                                                                    SP 800-90, Recommendation for Random Number Generation.
                                                                                                                                                   23
