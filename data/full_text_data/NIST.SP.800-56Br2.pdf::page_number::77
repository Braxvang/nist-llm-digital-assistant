                                                                                               NIST SP 800-56B REV. 2                           RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                     USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                                  3. RBG:             An approved random bit generator (see Section 5.3).
                                                                                                  4. RSAEP:           RSA Encryption Primitive (see Section 7.1.1).
                                                                                                  5. RSADP:           RSA Decryption Primitive (see Section 7.1.2).

                                                                                               7.2.2.2 The Mask Generation Function (MGF)
                                                                                               MGF is a mask-generation function based on an approved hash function (see Section 5.1). The
                                                                                               purpose of the MGF is to generate a string of bits that may be used to “mask” other bit strings. The
                                                                                               MGF is used by the RSA-OAEP-based schemes specified in Section 9.2.
                                                                                               Let hash be an approved hash function.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                               For the purposes of this Recommendation, the MGF shall not be invoked more than once by each
                                                                                               party during a given transaction using a given MGF seed (i.e., a mask shall be derived only once
                                                                                               by each party from a given MGF seed).

                                                                                               Function call: MGF(mgfSeed, maskLen)
                                                                                               Auxiliary Function:
                                                                                                  hash: an approved hash function (see Section 5.1).
                                                                                               Implementation-Dependent Parameters:
                                                                                                  1. hashLen: an integer that indicates the byte length of the output block of the auxiliary hash
                                                                                                     function, hash.
                                                                                                  2. max_hash_inputLen: an integer that indicates the maximum-permitted byte length of the
                                                                                                     bit string, x, that is used as input to the auxiliary hash function, hash.
                                                                                               Input:
                                                                                                  1. mgfSeed: a byte string from which the mask is generated.
                                                                                                  2. maskLen: the intended byte length of the mask.
                                                                                               Process:
                                                                                                  1. If maskLen > 232 hashLen, output an error indicator, and exit from this process without
                                                                                                     performing the remaining actions.
                                                                                                  2. If mgfSeed is more than max_hash_inputLen bytes in length, then output an error indicator,
                                                                                                     and exit this process without performing the remaining actions.
                                                                                                  3. Set T = the null string.
                                                                                                  4. For counter from 0 to  maskLen / hashLen  – 1, do the following:
                                                                                                          a) Let D = I2BS(counter, 4) (see Appendix B.1).
                                                                                                          b) Let T = T || hash(mgfSeed || D).
                                                                                                  5. Output the leftmost maskLen bytes of T as the byte string mask.



                                                                                                                                                67
