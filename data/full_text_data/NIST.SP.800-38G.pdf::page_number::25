NIST SP 800-38G                                        METHODS FOR FORMAT-PRESERVING ENCRYPTION




Appendix A: Parameter Choices and Security

The values of the parameters, e.g., radix, minlen, and maxlen affect the security that FF1 and FF3
can offer, because, as for any FPE method, encrypted data may be vulnerable to guessing attacks
when the number of possible inputs is sufficiently small.

In particular, for a base radix numeral string S, there are radix LEN(S) possible values. For any
ciphertext C, the corresponding plaintext has the same length; therefore, an attacker can guess
the plaintext with probability 1/radix LEN(C) by selecting a numeral string of LEN(C) at random.
Repeated guesses increase the attacker’s probability of success proportionately: with g distinct
guesses, the probability is g/ radix LEN(C).

For example, SSNs are base 10 numeral strings of length 9, so there are one billion possibilities.
If an attacker could guess a thousand different values for an SSN, one of the guesses would be
correct with probability 1000/109, i.e., one in a million.

The specifications of FF1 and FF3 only impose a modest absolute minimum on the number of
possible inputs; in particular, radix minlen ≥ 100, in order to preclude a generic meet-in-the-middle
attack on the Feistel structure [14].

However, in order to limit the effectiveness of guessing attacks, the value radix minlen should
generally be at least one million, and, depending on that value, the implementation should also
limit the number of guesses that an attacker can mount, if possible. The minimum of one million
is suggested rather than required, in recognition that radix and minlen are usually determined by
the needs of the implementation.

In order to prevent attacks against one instance of encryption from applying to other instances,
implementations should enforce the use of different tweaks for different instances, as discussed
in Appendix C. Usually, tweaks are non-secret information that can be associated with instances
of encryption. For FF3, the tweak length is fixed, but for FF1 the maximum tweak length
parameter, maxTlen, should be chosen to accommodate the desired tweaks for the
implementation.

Two other potential parameters of the Feistel structure are fixed for FF1 and FF3, namely, the
number of Feistel rounds and the imbalance, i.e., the values of the lengths u and v in Figure 1.
Both of these parameters were set with consideration to both performance and security
requirements. See Appendix H of [1] for a discussion.

Appendix B: Security Goal

The designers of FFX aimed to achieve strong-pseudorandom permutation (PRP) security for a
conventional block cipher [7]. In the FFX proposal to NIST [1], the designers of FFX cite the
history of cryptographic results concerning Feistel networks as underlying their selection of the
FFX mechanism. They assert that, under the assumption that the underlying round function is a
good pseudorandom function (PRF), contemporary cryptographic results and experience indicate
that FFX achieves several cryptographic goals, including nonadaptive message-recovery
security, chosen-plaintext security, and even PRP-security against an adaptive chosen-ciphertext

                                                 20
