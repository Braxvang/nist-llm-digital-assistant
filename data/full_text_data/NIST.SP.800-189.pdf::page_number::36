                                                                                             NIST SP 800-189                                             RESILIENT INTERDOMAIN TRAFFIC EXCHANGE:
                                                                                                                                                                 BGP SECURITY & DDOS MITIGATION

                                                                                             BGP updates from ingress to egress (within the AS) using a BGP community [NANOG-list].
                                                                                             The BGP community used is non-transitive because it does not propagate in eBGP (between
                                                                                             ASes). Each BGP update is tagged on ingress to indicate that it was received in eBGP from a
                                                                                             customer, lateral peer, or transit provider. Further, a route that originated within the AS is tagged
                                                                                             to indicate the same. At the egress point, the sending router applies an egress policy that makes
                                                                                             use of the tagging. Routes that are received from a customer are allowed on the egress to be
                                                                                             forwarded to any type of peer (e.g., customer, lateral peer, or transit provider). However, routes
                                                                                             received from a lateral peer or transit provider are forwarded only to customers (i.e., they are not
                                                                                             allowed to be forwarded to a lateral peer or transit provider). These ingress and egress policies
                                                                                             are central to route leak prevention within an AS (intra-AS).

                                                                                                   Security Recommendation 37: An AS operator should have an ingress policy to tag
                                                                                                   routes internally (locally within the AS) to communicate from ingress to egress regarding
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-189




                                                                                                   the type of peer (customer, lateral peer, or transit provider) from which the route was
                                                                                                   received.

                                                                                                   Security Recommendation 38: An AS operator should have an egress policy to utilize
                                                                                                   the tagged information (in Security Recommendation 37) to prevent route leaks when
                                                                                                   routes are forwarded on the egress. The AS should not forward routes received from a
                                                                                                   transit provider to another transit provider or a lateral peer. Also, the AS should not
                                                                                                   forward routes received from a lateral peer to another lateral peer or a transit provider.

                                                                                             The above intra-AS solution for the prevention of route leaks can also be implemented using a
                                                                                             BGP attribute (instead of BGP community). The advantage of an attribute-based solution
                                                                                             [RouteLeak2] is that it can be made available in commercial routers as a standard feature, which
                                                                                             in turn minimizes manual network operator actions. However, such a solution involves an update
                                                                                             to the BGP protocol [RFC4271] and requires standardization, which takes time and is currently
                                                                                             in progress in the IETF [RouteLeak2].

                                                                                             The second type of inter-AS solution is intended to work in eBGP across AS hops. With the
                                                                                             inter-AS solution, the focus shifts to detection and mitigation in case a route leak has already
                                                                                             occurred and started to propagate. If a leak indeed propagates out of an AS, then the peer AS or
                                                                                             any AS along the subsequent AS path should be able to detect and stop it. A solution for inter-
                                                                                             AS route leak detection and mitigation is also work in progress in the IETF [RouteLeak1]
                                                                                             [RouteLeak3].

                                                                                             For robustness of the internet routing infrastructure, inter-AS route leak detection and mitigation
                                                                                             capabilities will also need to be implemented in addition to the intra-AS prevention capability.
                                                                                             When mechanisms for route leak detection and mitigation capabilities are standardized and
                                                                                             become available in products, this document will be updated to include appropriate security
                                                                                             recommendations to reflect the same.

                                                                                             4.10 Generalized TTL Security Mechanism (GTSM)

                                                                                             Time to Live (TTL) is an 8-bit field in each IP packet and is decremented by one on each hop.
                                                                                             The Generalized TTL Security Mechanism (GTSM) [RFC5082] makes use of the TTL to
                                                                                             provide an additional security mechanism for BGP messages. Typically, a BGP session runs


                                                                                                                                              25
