                                                                                             NIST SP 800-208                              RECOMMENDATION FOR STATEFUL
                                                                                                                                         HASH-BASED SIGNATURE SCHEMES

                                                                                               Output: signature Sig

                                                                                               // Send XMSS'_sign() command to one of the bottom-level key pairs
                                                                                               Sig_tmp = XMSS'_sign(M);

                                                                                               idx_sig = getIdx(Sig_tmp);

                                                                                               // Determine which bottom-level tree was used to sign the message
                                                                                               // by extracting the most significant bits of idx_sig.
                                                                                               t = [idx_sig â€“ (idx_sig mod 2^(h / d))]/ 2^(h / d));

                                                                                               // Append the signature of the signing key pair's root
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-208




                                                                                               // (just the output of treeSig, not idx_sig or r).
                                                                                               Sig = Sig_tmp || getSig(SigPK[t]);
                                                                                               return Sig;




                                                                                                                            27
