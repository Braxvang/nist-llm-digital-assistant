                                 NIST Special Publication 800-38D


9 Practical Considerations for Validating Implementations

Both the designer of a GCM implementation and the information technology (IT) professional
who deploys and maintains it within a particular system have important roles in meeting the
uniqueness requirement in Sec. 8, as discussed in Secs. 9.1 and 9.2 below.

The additional requirements in these two sections are provided for the purpose of demonstrating
compliance with the uniqueness requirement in Sec. 8 within a validation program. Specifically,
analogous to the requirements in Ref. [9], the requirements in these two sections apply to
implementations that are validated against the requirements of FIPS Pub. 140-2 (Ref. [3]), or any
superseding version of FIPS 140.

Implementations that are not validated against the requirements of FIPS Pub. 140-2 may interpret
the requirements in Secs. 9.1 and 9.2 as recommendations.

9.1     Design Considerations

In order to inhibit an unauthorized party from controlling or influencing the generation of IVs,
GCM shall be implemented only within a cryptographic module that meets the requirements of
FIPS Pub. 140-2. In particular, the cryptographic boundary of the module shall contain a
“generation unit” that produces IVs according to one of the constructions in Sec. 8.2 above.

The documentation of the module for its validation against the requirements of FIPS 140-2 shall
describe how the module complies with the uniqueness requirement on IVs. At a minimum, the
documentation shall address the considerations in this section, and clearly document the
responsibilities of the IT professional who configures, deploys, and maintains the GCM
implementations within a larger system.

The following are three important design considerations for GCM modules:

      1. The freshness of keys shall be assured, as discussed in Sec. 8.1.

      2. The IV shall be a critical security parameter as defined in FIPS Pub. 140-2 until the
         authenticated encryption function is invoked with the IV. Prior to this invocation, the IV
         shall be provided the same protection as other critical security parameters in a module
         that is validated to the requirements in FIPS Pub. 140-2.

      3. A loss of power to the module shall not cause the repetition of IVs. If the generation unit
         cannot recover from a loss of power, then the authenticated encryption function shall
         enter a failure state until a fresh key can be established.

The IV construction that is implemented from Sec. 8.2 above affects the options for recovery
from a loss of power. For the deterministic construction, all of the deterministic elements that
are necessary to construct the IV would have to be available when power is restored. For
example, these elements could be stored in non-volatile memory.




                                                  22
