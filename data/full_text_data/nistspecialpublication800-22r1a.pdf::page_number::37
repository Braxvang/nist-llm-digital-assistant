A STATISTICAL TEST SUITE FOR RANDOM AND PSEUDORANDOM NUMBER GENERATORS FOR CRYPTOGRAPHIC APPLICATIONS



        ε         The sequence of bits as generated by the RNG or PRNG being tested; this exists as a
                  global structure at the time of the function call; ε = ε1, ε2, … , εn.

        B         The m-bit template to be matched; B is a string of ones and zeros (of length m) which is
                  defined in a template library of non-periodic patterns contained within the test code.

        M         The length in bits of the substring of ε to be tested.

        N         The number of independent blocks. N has been fixed at 8 in the test code.

2.7.3   Test Statistic and Reference Distribution
        χ2(obs):       A measure of how well the observed number of template “hits” matches the
                       expected number of template “hits” (under an assumption of randomness).

The reference distribution for the test statistic is the χ2 distribution.

2.7.4   Test Description
(1)     Partition the sequence into N independent blocks of length M.

        For example, if ε = 10100100101110010110, then n = 20. If N = 2 and M = 10, then the two
        blocks would be 1010010010 and 1110010110.

(2)     Let Wj (j = 1, …, N) be the number of times that B (the template) occurs within the block j. Note
        that j = 1,…,N. The search for matches proceeds by creating an m-bit window on the sequence,
        comparing the bits within that window against the template. If there is no match, the window
        slides over one bit , e.g., if m = 3 and the current window contains bits 3 to 5, then the next
        window will contain bits 4 to 6. If there is a match, the window slides over m bits, e.g., if the
        current (successful) window contains bits 3 to 5, then the next window will contain bits 6 to 8.

        For the above example, if m = 3 and the template B = 001, then the examination proceeds as
        follows:

                                           Block 1                                 Block 2
            Bit Positions           Bits             W1                     Bits             W2
                 1-3                101               0                     111               0
                 2-4                010               0                     110               0
                 3-5                100               0                     100               0
                 4-6             001 (hit)      Increment to 1           001 (hit)      Increment to 1
                 5-7           Not examined                            Not examined
                 6-8           Not examined                            Not examined
                 7-9                001         Increment to 2              011               1
                8-10             010 (hit)            2                     110               1

        Thus, W1 = 2, and W2 = 1.

(3)     Under an assumption of randomness, compute the theoretical mean µ and variance σ2:
                                                                       1 2m −1 
                                  µ = (M-m+1)/2m              σ 2 = M  m − 2m  .
                                                                      2    2   



                                                       2-15
