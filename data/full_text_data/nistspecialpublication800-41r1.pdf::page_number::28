                                                                                  GUIDELINES ON FIREWALLS AND FIREWALL POLICY


4.       Firewall Policy

A firewall policy dictates how firewalls should handle network traffic for specific IP addresses and
address ranges, protocols, applications, and content types (e.g., active content) based on the
organization’s information security policies. Before a firewall policy is created, some form of risk
analysis should be performed to develop a list of the types of traffic needed by the organization and
categorize how they must be secured—including which types of traffic can traverse a firewall under what
circumstances. 16 This risk analysis should be based on an evaluation of threats; vulnerabilities;
countermeasures in place to mitigate vulnerabilities; and the impact if systems or data are compromised.
Firewall policy should be documented in the system security plan and maintained and updated frequently
as classes of new attacks or vulnerabilities arise, or as the organization’s needs regarding network
applications change. The policy should also include specific guidance on how to address changes to the
ruleset.

Generally, firewalls should block all inbound and outbound traffic that has not been expressly permitted
by the firewall policy—traffic that is not needed by the organization. This practice, known as deny by
default, decreases the risk of attack and can also reduce the volume of traffic carried on the organization’s
networks. Because of the dynamic nature of hosts, networks, protocols, and applications, deny by default
is a more secure approach than permitting all traffic that is not explicitly forbidden.

This section provides details on what types of traffic should be blocked. Section 4.1 discusses policies for
packet filtering and stateful inspection based on IP addresses and other IP characteristics. Section 4.2
covers policies relating to application-specific traffic. Section 4.3 covers access based on user identity,
and Section 4.4 describes policies triggered by network activity.

4.1      Policies Based on IP Addresses and Protocols

Firewall policies should only allow necessary IP protocols through. Examples of commonly used IP
protocols, with their IP protocol numbers, 17 are ICMP (1), TCP (6), and UDP (17). Other IP protocols,
such as IPsec components Encapsulating Security Payload (ESP) (50) and Authentication Header (AH)
(51) and routing protocols, may also need to pass through firewalls. These necessary protocols should be
restricted whenever possible to the specific hosts and networks within the organization with a need to use
them. By permitting only necessary protocols, all unnecessary IP protocols are denied by default.

Some IP protocols are rarely passed between an outside network and an organization’s LAN, and
therefore can simply be blocked in both directions at the firewall. For example, IGMP is a protocol used
to control multicast networks, but multicast is rarely used, and when it is, it is often not used across the
Internet. Therefore, blocking all IGMP traffic in both directions is feasible if multicast is not used.

4.1.1      IP Addresses and Other IP Characteristics

Firewall policies should only permit appropriate source and destination IP addresses to be used. Specific
recommendations for IP addresses include:

 Traffic with invalid source or destination addresses should always be blocked, regardless of the
  firewall location. Examples of relatively common invalid IPv4 addresses are 127.0.0.0 to


16
      The process to perform a risk assessment and create this type of list is not detailed here. For additional information, see
      NIST SP 800-30, Risk Management Guide for Information Technology Systems, and SP 800-18 Revision 1, Guide for
      Developing Security Plans for Federal Information Systems, at http://csrc.nist.gov/publications/PubsSPs.html.
17
      IP protocol number assignments are defined in http://www.iana.org/assignments/protocol-numbers.


                                                                 4-1
