                                                                                               NIST SP 800-56A Rev. 3                                Recommendation for Pair-Wise Key Establishment
                                                                                                                                                             Using Discrete Logarithm Cryptography

                                                                                               dhEphem is summarized in Table 13.
                                                                                                                 Table 13: dhEphem key-agreement scheme summary

                                                                                                                                     Party U                                Party V

                                                                                                Domain                  (p, q, g{, SEED, counter})            (p, q, g{, SEED, counter})
                                                                                                parameters

                                                                                                Static data             N/A                                   N/A

                                                                                                                        Ephemeral private key rU              Ephemeral private key rV
                                                                                                Ephemeral data
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                                                        Ephemeral public key tU               Ephemeral public key tV

                                                                                                                        Compute Z by calling FFC DH Compute Z by calling FFC DH
                                                                                                Computation
                                                                                                                        using rU and tV             using rV and tU

                                                                                                                        1. Compute                            1. Compute
                                                                                                Derive secret              DerivedKeyingMaterial                 DerivedKeyingMaterial
                                                                                                keying material
                                                                                                                        2. Destroy Z                          2. Destroy Z

                                                                                               6.1.2.2 (Cofactor) Ephemeral Unified Model, C(2e, 0s, ECC CDH) Scheme
                                                                                               This section describes the Ephemeral Unified Model scheme. Assurance of secure key
                                                                                               establishment using this scheme can only be obtained when the assumptions in Section 6.1.2
                                                                                               are true.
                                                                                               With the exception of key derivation, the Ephemeral Unified Model scheme is “symmetric”
                                                                                               in the actions of parties U and V. Only the actions performed by party U are specified here;
                                                                                               a specification of the actions performed by party V may be obtained by systematically
                                                                                               replacing the letter “U” by “V” (and vice versa) in the actions listed below. Note, however,
                                                                                               that parties U and V must use identical orderings of the bit strings that are input to the key-
                                                                                               derivation method.
                                                                                               Party U shall execute the following actions to a) establish a shared secret value Z with party
                                                                                               V, and b) derive secret keying material from Z.
                                                                                               Actions: Party U generates a shared secret and derives secret keying material as follows:
                                                                                                  1. Generate an ephemeral key pair (de,U, Qe,U) from the domain parameters D as specified
                                                                                                     in Section 5.6.1.2. Send the public key Qe,U to party V. Receive an ephemeral public
                                                                                                     key Qe,V (purportedly) from party V. If Qe,V is not received, destroy the ephemeral
                                                                                                     private key de,U; then output an error indicator, and exit this process without
                                                                                                     performing the remaining actions.
                                                                                                  2. Verify that Qe,V is a valid ephemeral public key for the parameters D as specified in
                                                                                                     Section 5.6.2.3. If assurance of public key validity cannot be obtained, destroy the
                                                                                                     ephemeral private key de,U; then output an error indicator, and exit this process
                                                                                                     without performing the remaining actions.
                                                                                                                                               80
