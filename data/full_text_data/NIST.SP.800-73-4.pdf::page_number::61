Special Publication 800-73-4          Interfaces for Personal Identity Verification – Part 1: PIV
                                   Card Application Namespace, Data Model and Representation



Appendix C–– PIV Algorithm Identifier Discovery

Relying parties interact with many PIV Cards with the same native key type implemented by different
key sizes and algorithms. 26 For example, a relying party performing the authentication mechanism
described in Appendix B.1.2 (Authentication using the PIV Authentication key) can expect to
perform a challenge and response cryptographic authentication with a 2048-bit RSA key or an
ECDSA (Curve P-256) key.

This appendix describes recommended procedures for key size and algorithm discovery (PIV
algorithm ID discovery) to facilitate cryptographic authentication initiated by the relying party to
make appropriate decisions for granting access to logical networks and systems as well as physical
access control systems. The discovery procedure is defined in terms of asymmetric and symmetric
cryptographic authentication.

C.1       PIV Algorithm Identifier Discovery for Asymmetric Cryptographic
          Authentication

As illustrated in the authentication mechanisms in Appendix B, an asymmetric cryptographic
authentication involves issuing a challenge (request to sign a nonce) to the PIV Card. The relying
party issuing the command provides the nonce to be signed, the key reference, and the PIV algorithm
identifier as parameters of the command. The nonce is random data generated by the relying party and
the key reference is known. The PIV algorithm identifier, on the other hand, is unknown to the
relying party and needs to be identified in order to issue the challenge command. The PIV algorithm
identifier can be derived from the previous steps of the authentication mechanism. The relying party,
prior to issuing the challenge command, retrieved and parsed the X.509 certificate from the card in
order to 1) validate the certificate and 2) extract the public key for the pending verification of the
signed nonce once returned from the card. It is during the parsing of the X.509 certificate that the PIV
algorithm identifier can be identified in two steps: 27

          Step 1: Algorithm Type Discovery:
          The X.509 certificate stores the public key in the subjectPublicKeyInfo field. The
          subjectPublicKeyInfo data structure has an algorithm field, which includes an OID that
          identifies the public key’s algorithm (RSA or ECC) as listed in Table 3-4 of SP 800-78.

          Step 2: Key Size Discovery:
          If the algorithm type, as determined in Step 1, is ECC then the key size is determined by the
          elliptic curve on which the key has been generated, which is P-256 for all elliptic curve PIV
          Authentication keys and Card Authentication keys.

          If the algorithm type, as determined in Step 1, is RSA then the key size is determined by the
          public key’s modulus. The public key appears in the subjectPublicKey field of
          subjectPublicKeyInfo and is encoded as a sequence that includes both the key’s modulus and
          public exponent.




26 Table 3-1, SP 800-78 lists the various algorithms and key sizes that may be used for each PIV key type.
27 The PIV algorithm identifiers specify both the key size and the algorithm for the key references. Thus both values have to

be discovered in order to derive the PIV algorithm identifier.




                                                                 48
