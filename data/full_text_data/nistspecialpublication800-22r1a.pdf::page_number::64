    A STATISTICAL TEST SUITE FOR RANDOM AND PSEUDORANDOM NUMBER GENERATORS FOR CRYPTOGRAPHIC APPLICATIONS



    1/2. The statistic is referred to a chi-squared distribution with the degrees of freedom equal to the number
    of substrings.

    The parameters of this test are M and N, so that n = MN, i.e., the original string is partitioned into N
    substrings, each of length M. For each of these substrings, the probability of ones is estimated by the
    observed relative frequency of 1's, π i , i = 1,…,N. The sum

                                                                                               N             2
                                                                                  1
                                                              Χ (obs) = 4 M ∑π i − 
                                                                  2

                                       €                                    i=1
                                                                                  2

    under the randomness hypothesis has the Χ2-distribution with N degrees of freedom. The reported P-
    value is
                                           €
                             ∞                                            ∞
                         ∫       2
                             Χ (obs)
                                        e−u / 2 u N / 2−1du           ∫   Χ 2 (obs)/ 2
                                                                                         e−u u N / 2−1du9           N Χ 2 (obs)
                                                              =                                             = igamc( ,          ).
                                     Γ(N /2)2 N / 2                               Γ(N /2)                           2      2

                                                                      References for Test

    [1]   € Nick Maclaren, “Cryptographic Pseudo-random Numbers in Simulation,” Cambridge Security
            Workshop on Fast Software Encryption. Dec. 1993. Cambridge, U.K.: R. Anderson, pp. 185-190.

    [2]     Donald E. Knuth, The Art of Computer Programming. Vol 2: Seminumerical Algorithms. 3rd ed.
            Reading, Mass: Addison-Wesley, 1998 (especially pp. 42-47).

    [3]     Milton Abramowitz and Irene Stegun, Handbook of Mathematical Functions: NBS Applied
            Mathematics Series 55. Washington, D.C.: U.S. Government Printing Office, 1967.


    3.3 Runs Test
    This variant of a classic nonparametric test looks at “runs” defined as substrings of consecutive 1's and
    consecutive 0's, and considers whether the oscillation among such homogeneous substrings is too fast or
    too slow.

    The specific test used here is based on the distribution of the total number of runs, Vn. For the fixed
    proportion π =     ∑ ε j /n (which by the Frequency test of Section 3.1 must have been established to be
                             j

                     1  2
    close to 0.5: π − ≤    ).
                     2   n
    €                                                    V − 2nπ (1− π )
                                                   lim P( n              ≤ z) = Φ(z).                                                (2)
                                                   n →∞   2 n π (1− π )
     €
    To evaluate Vn, define for k = 1,…,n-1, r(k) = 0 if εk = εk +1 and r(k) = 1 if εk ≠ εk +1 . Then
             n−1
    Vn = ∑         r(k) + 1. The
                              € P-value reported is
             k=1


                                             €              € V (obs) − €
                                                                        2nπ (1− π )€
                                                          erfc( n                  ).
€                                                                 2 2n π (1− π )


                                                                                         3-2
                                           €
