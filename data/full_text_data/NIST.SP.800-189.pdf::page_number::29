                                                                                             NIST SP 800-189                                                                   RESILIENT INTERDOMAIN TRAFFIC EXCHANGE:
                                                                                                                                                                                       BGP SECURITY & DDOS MITIGATION

                                                                                             update of prefix filters.

                                                                                             4.4.2       Special Purpose Prefixes

                                                                                             IANA maintains registries for special-purpose IPv4 and IPv6 addresses [IANA-v4-sp] [IANA-
                                                                                             v6-sp]. These registries also include specification of the routing scope of the special-purpose
                                                                                             prefixes.

                                                                                                         Security Recommendation 20: Prefixes that are marked “False” in column “Global”
                                                                                                         [IANA-v4-sp] [IANA-v6-sp] are forbidden from routing in the global internet and should
                                                                                                         be rejected if received from an external BGP (eBGP) peer.

                                                                                             4.4.3       Prefixes Owned by an AS
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-189




                                                                                             An AS may originate one or multiple prefixes. In the inbound direction, the AS should (in most
                                                                                             cases) reject routes for the prefixes (subnets) it originates if received from any of its eBGP peers
                                                                                             (transit provider, customer, or lateral peer). In general, the data traffic destined for these prefixes
                                                                                             should stay local and should not be leaked over external peering. However, if the AS operator is
                                                                                             uncertain whether a prefix they originate is single-homed or multi-homed, then the AS should
                                                                                             accept the prefix advertisement from an eBGP peer (and assign a lower local preference value)
                                                                                             so that the desired redundancy is maintained.

                                                                                                         Security Recommendation 21: For single-homed prefixes (subnets) that are owned
                                                                                                         and originated by an AS, any routes for those prefixes received at that AS from eBGP
                                                                                                         peers should be rejected.

                                                                                             4.4.4       Prefixes that Exceed a Specificity Limit

                                                                                             Normally, ISPs neither announce nor accept routes for prefixes that are more specific than a
                                                                                             certain level of specificity. For example, maximum acceptable prefix lengths are mentioned in
                                                                                             existing practices as /24 for IPv4 [RIPE-399] and /48 for IPv6 [RIPE-532]. The level of
                                                                                             specificity that is acceptable is decided by each AS operator and communicated with peers. In
                                                                                             instances when Flowspec (see Section 5.5) [RFC5575] [RFC5575bis] [Ryburn] is used between
                                                                                             adjacent ASes for DDoS mitigation, the two ASes may mutually agree to accept longer prefix
                                                                                             lengths (e.g., a /32 for IPv4) but only for certain pre-agreed prefixes. That is, the announced
                                                                                             more-specific prefix must be contained within a pre-agreed prefix.

                                                                                                         Security Recommendation 22: It is recommended that an eBGP router should set
                                                                                                         the specificity limit for each eBGP peer and reject prefixes that exceed the specificity
                                                                                                         limit on a per-peer basis. 9

                                                                                             Some operators may choose to reject prefix announcements that are less-specific than /8 and /11
                                                                                             for IPv4 and IPv6, respectively.




                                                                                             9
                                                                                                 The specificity limit may be the same for all peers (e.g., /24 for IPv4 and /48 for IPv6).


                                                                                                                                                                 18
