NIST SP 800-166                                                    DERIVED PIV APPLICATION AND
                                                                   DATA MODEL TEST GUIDELINES

 Test Scenario        1. Send the SELECT command with
                            • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                      2. Send the RESET RETRY COUNTER with
                            • P2, key reference value, is set to '80'
                            • Data field of the command contains the correct
                               PUK value for key reference '80' concatenated
                               without delimitation with an arbitrary new
                               password value that contains 0x5B in the first
                               byte position, all other non-padded bytes contain
                               values limited to either 0x30–0x39 or 0x41-0x5A
                               or 0x61-0x7A. The new password should be padded
                               with 'FF' (if necessary) to complete the total
                               length of the value to 8 bytes
                      3. Repeat Step 2 five times with byte positions 2, 3, 4,
                         5, and 6 of the password containing the 0x5B byte,
                         respectively.
                      4. Send the VERIFY command with
                            • P2, key reference value, is set to '80'
                            • Data field of the command will contain the
                               correct Derived PIV Application Password, padded
                               with 'FF' (if necessary) to complete the total
                               length of the value to 8 bytes
 Expected Result(s)   1. From Step 1, the command returns the application property template
                         with the status word '90 00'.
                      2. From Step 2, the command returns status word '6A 80' (incorrect
                         parameter in command data field).
                      3. From Step 3, each time the command returns status word '6A 80'
                         (incorrect parameter in command data field).
                      4. From Step 4, the command returns status word '90 00'.
 Postcondition(s)     Current password is unchanged.


8.3.6.5 Reset Retry Counter with an incorrect length for the PUK

 Test Assertion       TA-08.03.06.05
 Purpose              Verifies that the Derived PIV Application does not set a new password
                      with the RESET RETRY COUNTER command when the PUK length is
                      incorrect.
 DTR(s)               •  DTR-06.02.02.09
                      •  DTR-06.03.01.01
                      •  DTR-06.03.07.04
                      •  DTR-06.03.07.05
                      •  DTR-06.03.07.06
                      • DTR-06.03.07.07
 Vendor               None.
 Documentation
 Precondition(s)      •   A token with the Derived PIV Application is inserted into an
                          appropriate token reader.


                                            78
