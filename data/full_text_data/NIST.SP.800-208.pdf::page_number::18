                                                                                             NIST SP 800-208                                                                            RECOMMENDATION FOR STATEFUL
                                                                                                                                                                                       HASH-BASED SIGNATURE SCHEMES




                                                                                                                                              Figure 4: A Merkle Hash Tree
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-208




                                                                                             Figure 4 depicts a hash tree that contains eight OTS public keys (k0 ‚Ä¶ k7). The eight keys are
                                                                                             each hashed to form the leaves of the tree (h0 ‚Ä¶ h7), and the eight leaf values are hashed in pairs
                                                                                             to create the next level up in the tree (h01, h23, h45, h67). These four hash values are again hashed in
                                                                                             pairs to create h0‚àí3 and h4‚àí7, which are hashed together to create the long-term public key, h0‚àí7.
                                                                                             In order for an entity that had already received h0‚àí7 in a secure manner to verify a message
                                                                                             signed using k2, the signer would need to provide h3, h01, and h4‚àí7 in addition to k2. The verifier
                                                                                             would compute ‚Ñé2‚Ä≤ = ùêªùêª(ùëòùëò2 ), ‚Ñé23 ‚Ä≤
                                                                                                                                  = ùêªùêª(‚Ñé2‚Ä≤ ||‚Ñé3 ), ‚Ñé0‚àí3
                                                                                                                                                     ‚Ä≤                ‚Ä≤ ),
                                                                                                                                                          = ùêªùêª(‚Ñé01 ||‚Ñé23        ‚Ä≤
                                                                                                                                                                           and ‚Ñé0‚àí7 =
                                                                                                  ‚Ä≤                ‚Ä≤
                                                                                             ùêªùêª(‚Ñé0‚àí3 ||‚Ñé4‚àí7 ). If ‚Ñé0‚àí7 is the same as h0‚àí7, then k2 may be used to verify the message signature.

                                                                                             3.3      Two-Level Trees

                                                                                             Both [1] and [2] define single tree and multi-tree variants of their signature schemes. In an
                                                                                             instance that involves two levels of trees, as shown in Figure 5, the OTS keys that form the
                                                                                             leaves of the top-level tree sign the roots of the trees at the bottom level, and the OTS keys that
                                                                                             form the leaves of the bottom-level trees are used to sign the messages. The root of the top-level
                                                                                             tree is the long-term public key for the signature scheme. 3




                                                                                             3   While this section only describes two-level trees, HSS allows for up to eight levels of trees, and XMSSMT allows for up to 12
                                                                                                 levels of trees.


                                                                                                                                                              9
