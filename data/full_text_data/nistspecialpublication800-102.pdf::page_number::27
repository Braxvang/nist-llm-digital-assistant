       However, even though they may be omitted from the transmitted TSP data,
       both the entire user_supplied_info and the entire TTA_supplied_info shall be
       included in the timestamped_data that is used in the generation / verification of
              timestamp_signatureTTA = SIGTTA(timestamped_data).
       Upon receiving the TSP from the TTA, entity A then 1) checks that the
       transmitted portions of the user_supplied_info are correct and 2) verifies the
       timestamp_signatureTTA using the TTA’s public signature verification key.
   4. Entity A assembles D and sends it to entity B:
           D = M, TSP
       where TSP is as defined in step 3.
       If any portion of the user_supplied_info was omitted from the TSP received from
       the TTA, then the entire user_supplied_info shall be inserted into the TSP used in
       the assembly of D unless there is a mutual agreement between entity A and entity
       B, in which case, any portion of the user_supplied_info may be omitted from the
       TSP data transmitted to entity B if it is known or can be determined by entity B.
       However, the entire user_supplied_info shall be included in the
       timestamped_data that is used in the generation / verification of
       timestamp_signatureTTA and SIGA(M, Nonce).
       If any portion of the TTA_supplied_info was omitted from the TSP received from
       the TTA, then the entire TTA_supplied_info shall be inserted into the TSP used in
       the assembly of D unless there is a mutual agreement between entity A and entity
       B, in which case, any portion of the TTA_supplied_info may be omitted from the
       TSP data transmitted by entity A if it is known or can be determined by entity B.
       However, the entire TTA_supplied_info shall be included in the
       timestamped_data that is used in the generation / verification of
       timestamp_signatureTTA and SIGA(M, Nonce).
   5. Upon receiving D, entity B does the following:
           •   Verifies SIGA(M, Nonce) using entity A’s verification public key, and
           •   Verifies timestamp_signatureTTA using the TTA’s public signature
               verification key.
       Note that the order of performing these verifications is irrelevant; it is only
       important that both verifications are successful.
In addition to what has been determined by entity B in step 3 of Section 5.1, the
verifications in step 5 provide entity B with evidence that SIGA(M, Nonce) was generated
between the time that the Nonce was sent to entity A and the time indicated in the
timestamp

5.2.2 Entity B Requests the Timestamp
Entity B may request a timestamp after receiving the message D from entity A. The TTA
that provides the timestamp may need to be trusted only by entity B unless another party


                                             27
