                                                                              GUIDE TO SECURE WEB SERVICES



support WS-Security, a Web service needs to be able to access public keys for all nodes with which it will
interact, not simply those nodes it communicates with directly. This allows WS-Security to prevent man-
in-the-middle attacks.

One of the main drawbacks associated with WS-Security is its use of asymmetric cryptographic
algorithms for encryption, which are computationally intensive. To remedy this situation, the WS-
SecureConversation specification was developed, allowing Web services to create a symmetric session
key (similar to how SSL/TLS functions) to allow faster symmetric cryptographic algorithms to be used
for message-level security. WS-SecureConversation is well-suited for Web services that receive or send
large volumes of messages to a small number of services.

3.6.4   Role of XML Gateways in Integrity Protection

SOAP travels over HTTP, which is traditionally left open for Web traffic at perimeter firewalls.
Additionally, with the advent of Liberty and SAML V2.0â€™s Reverse SOAP (PAOS) specification, SOAP
messages can pass through firewalls that limit incoming HTTP traffic but allow outgoing HTTP traffic.
Some firewalls have begun to support blocking or allowing SOAP requests based on the source or
destination of the request, but more robust and intelligent firewalls are needed to defend networks against
malicious SOAP attacks.

To this end, XML gateways were developed to offer the functionality of application-level firewalls
specifically for Web services. Application-aware firewalls are nothing new; they have been around in the
form of HTTP proxies for HTTP-based traffic and allow organizations to limit what an application-layer
protocol can and cannot do.

An XML gateway acts as the Web service and forwards all communication to the internal Web service,
acting as an intermediary between untrusted services and the internal Web service. XML gateways can
provide sophisticated authentication and authorization services, potentially improving the security of the
Web service by having all SOAP messages pass through a hardened gateway before reaching any of the
custom-developed code. XML gateways can restrict access based on source, destination, or WS-Security
authentication tokens.

XML gateways also support schema validation and some offer support for SOAP intrusion prevention
against the following attacks that target vulnerabilities native to XML and XML based services:

 WSDL scanning. Attempts to retrieve the WSDL of Web services to gain information that may be
  useful for an attack
 Parameter tampering. Modification of the parameters a Web service expects to receive in an
  attempt to bypass input validation and gain unauthorized access to some functionality
 Replay attacks. Attempts to resend SOAP requests to repeat sensitive transactions
 Recursive/oversized payload attacks. Attempts to perform a denial of service against the Web
  service by sending messages designed to overload the XML parser
 External reference attacks. Attempts to bypass protections by including external references that
  will be downloaded after the XML has been validated but before its processed by the application
 Schema poisoning. Supplying a schema with the XML document such that the XML validator will
  use the supplied schema, allowing a malicious XML document to be validated without error




                                                   3-32
