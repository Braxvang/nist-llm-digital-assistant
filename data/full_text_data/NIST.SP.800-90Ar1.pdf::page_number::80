NIST SP 800-90A Rev. 1                                              Recommendation for Random Number
                                                                     Generation Using Deterministic RBGs


                         Appendix B: (Informative)
               Example Pseudocode for Each DRBG Mechanism
The internal states in these examples are considered to be an array of states, identified by
state_handle. A particular state is addressed as internal_state (state_handle), where the value of
state_handle begins at 0 and ends at n-1, and n is the number of internal states provided by an
implementation. A particular element in the internal state is addressed by internal_state
(state_handle).element. In an empty internal state, all bitstrings are set to Null, and all integers
are set to 0.
For each example in this appendix, arbitrary values have been selected that are consistent with
the allowed values for each DRBG mechanism, as specified in the appropriate table in Section
10.
The pseudocode in this appendix does not include the necessary conversions (e.g., integer to
bitstring) for an implementation. When conversions are required, they shall be accomplished as
specified in Appendix A.
The following routine is defined for these pseudocode examples:
   Find_state_space (): A function that finds an unused internal state. The function returns a
   status (either “Success” or a message indicating that an unused internal state is not available)
   and, if status = “Success”, a state_handle that points to an available internal_state in the
   array of internal states. If status ≠ “Success”, an invalid state_handle is returned.
When the uninstantantiate function is invoked in the following examples, the function specified
in Section 9.4 is called.

B.1 Hash_DRBG Example

This example of Hash_DRBG uses the SHA-1 hash function, and prediction resistance is
supported. Both a personalization string and additional input are supported. A 32-bit
incrementing counter is used as the nonce for instantiation (instantiation_nonce); the nonce is
initialized when the DRBG is instantiated (e.g., by a call to the clock or by setting it to a fixed
value) and is incremented for each instantiation.
A total of ten internal states are provided (i.e., ten instantiations may be handled simultaneously).
For this implementation, the functions and algorithms are “inline”, i.e., the algorithms are not
called as separate routines from the function envelopes. Also, the Get_entropy_input function
uses only three input parameters, since the first two parameters (as specified in Section 9) have
the same value.
The internal state contains values for V, C, reseed_counter, security_strength and
prediction_resistance_flag, where V and C are bitstrings, and reseed_counter, security_strength
and the prediction_resistance_flag are integers. A requested prediction resistance capability is
indicated when prediction_resistance_flag = 1.
In accordance with Table 2 in Section 10.1, the 112- and 128-bit security strengths may be
instantiated. Using SHA-1, the following definitions are applicable for the instantiate, generate
and reseed functions and algorithms:


                                                  71
