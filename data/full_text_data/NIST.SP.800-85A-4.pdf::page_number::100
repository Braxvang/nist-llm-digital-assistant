NIST SP 800-85A-4                                             PIV CARD APPLICATION & MIDDLEWARE
                                                                       INTERFACE TEST GUIDELINES

                        5. Perform pivLogIntoCardApplication from step 2 and repeat
                           step 4 using the '9C' key
 Expected Result(s)     Each function call returns the status_word PIV_OK.
 Postcondition(s)       The security status of the pairing code and PIN used in steps 1 and 2 are set
                        to TRUE.

B.11.2          Test Assertions for Error Conditions

B.11.2.1      Identify and Handle an Invalid cardHandle
 Purpose              Ensure the PIV Middleware detects invalid card handles.
 Target               pivEstablishSecureMessaging
 Reference(s)         1. SP 800-73-4 Part 3, Section 3.2.2
                      2. AS04.07A-R4
 Precondition(s)      1. A valid PIV Card is placed within the reading range of the
                         contactless reader.
                      2. There exists a valid connection between the test system and an
                         instance of the contactless reader.
                      3. The client application owns a connection to the PIV Card
                         Application accessible through cardHandle.
                      4. The client application has successfully selected the PIV Card
                         Application.
                      5. No other contactless card is within the proximity of the reader.
                      6. Secure messaging has not been established.
 Test Steps           1. Set cardHandle := <<an invalid cardHandle>>
                        2. Call pivEstablishSecureMessaging with
                           â€¢ (IN) cardHandle
 Expected Result(s)     Call returns with status_word of PIV_INVALID_CARD_HANDLE.
 Postcondition(s)       1. The PIV Middleware remains in the state it had prior to the
                           pivEstablishSecureMessaging function call.
                        2. The precondition states are unaffected.


B.11.2.2         Secure Messaging Failure
 Purpose                Ensure the PIV Middleware correctly handles a secure messaging
                        failure.
 Target                 pivEstablishSecureMessaging
 Reference(s)           1. SP 800-73-4 Part 3, Section 3.2.2
                        2. AS04.07A-R4
 Precondition(s)        1. A valid PIV Card is placed within the reading range of the
                           contactless reader.
                        2. There exists a valid connection between the test system and an
                           instance of the contactless reader.
                        3. The client application owns a shared connection to the PIV Card
                           Application (sharedConnection := true).


                                          B-34
