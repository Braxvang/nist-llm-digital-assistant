                                                                GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


these operating systems have not been fully proven. A review of the National Vulnerabilities Database
(NVD)51 shows stack vulnerabilities in most major operating systems. As new vulnerabilities are
exposed, vendors will release updates. With any new code, vendors will need time to stabilize or harden
their code. When deploying IPv6, an organization should understand that the code used in the IPv6
protocol stacks could be relatively new.

IPv4 Layer 2 and layer 3 attacks are possible because IPv4 assumes all network nodes will behave in a
trustworthy manner. IPv4 uses ARP to associate physical addressing to logical addressing.

This assumption allowed attacks that interfered with IP address resolution and the association of physical
addresses with logical addresses. As discussed in Section 3.5.2, IPv6 does not use ARP to map IP
addresses to physical interfaces. Instead, IPv6 uses ICMPv6. IPv6 uses ICMP for neighbor discovery
and stateless address autoconfiguration processes that associate physical and logical addresses. IPv6 is
still vulnerable to layer 3 attacks. A type of layer 3 attack is the host initialization attack. Three common
host initialization attacks are:

         Neighbor Solicitation (NS). For neighbor discovery, a client node sends an NS message. The
          problem is that any node can claim to be any other node on the LAN. An attacker can falsify a
          NS message with their MAC address and the fake IP address. This technique is similar to
          ARP spoofing in IPv4 and only works on link-local.
         Router Solicitation (RS). With stateless address autoconfiguration, the client node sends an
          RS message. Like the NS attack, any node can claim to be the default router and subvert the
          initialization process. These attacks are link-local scoped.
         Duplicate Address Detection (DAD) Process. When a node attempts to configure its link-local
          address, it runs DAD. An attacker can cause a denial of service attack by responding to a
          DAD request. As a result, the victim’s interface will fail to initialize.
The subnet size in IPv6 can present its own security challenges. These challenges are discussed in RFC
5157, IPv6 Implications for Network Scanning. The subnet size is much larger than it was in IPv4; a
default subnet can have 264 addresses. The issues with scanning an address space this large was discussed
in Section 2.4. Subnet size and resulting lengthy scan times are often presented as security features since
they will slow down a malicious scanner or the propagation of malicious logic. The subnet size, however,
makes it difficult for network and system administrators to manage assets. Attackers and administrators
need to rely on other discovery techniques like layer 2 discovery and DNS to find hosts. The large
address space makes it more difficult to find rogue hosts, possibly causing administrators to rely on
passive discovery techniques. Administrators may need to resort to predictable or sequential numbering
schemas for device addressing.

To mitigate most layer 3 vulnerabilities, administrators should consider using fixed addressing or
DHCPv6 with DHCP rogue detection instead of stateless address autoconfiguration. Autoconfiguration
and ND can be secured with SEND. More information on SEND is available in Section 5.4.2. Layer 2
discovery, 802.1x based network access control, and good configuration management practices will help
to mitigate layer 3 vulnerabilities.

The deployment of IPv6 reinforces the basic security lessons learned with IPv4. These security practices
include defense in depth, diversity, patching, configuration management, access control, and system and
network administrator best practices. Good security practices remain unchanged with the deployment of
IPv6. Good security practices will reduce exposure and recovery time in case of a security event.

51
     NIST, NVD.


                                                    6-3
