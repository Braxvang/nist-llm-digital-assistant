10 The Secure Shell (SSH)
10.1 Description
SSH is a protocol between clients and servers for secure remote login and other secure
network services over an insecure network or the Internet. The Internet Engineering Task
Force (IETF) governs the SSH protocol [RFC 4251]42. The SSH protocol consists of
three major components: the Transport Layer Protocol [RFC 4253], the User
Authentication Protocol [RFC 4252] and the Connection Protocol [RFC 4254].

10.1.1 Transport Layer Protocol (SSH-TLP)
The Transport Layer Protocol (TLP) provides server authentication, confidentiality, and
integrity with perfect forward secrecy43. The establishment of an SSH connection is
initiated using the TLP, which negotiates the algorithms to be used and authenticates the
server. TLP does not provide client authentication.

The algorithm-negotiation step of the protocol is used to determine the algorithms to be
used by the client and server for key agreement (called key exchange in the protocol),
server authentication, encryption and data integrity. The encryption and data-integrity
algorithms that protect communications from the client to the server and from the server
to the client are independently selected, i.e., the encryption algorithm protecting
communication from the client to the server may be different than the encryption
algorithm protecting communication from the server to the client.

After the algorithm negotiation is completed, the TLP authenticates the server to the
client in a key-exchange process [RFC 4253, Sec. 8]) that provides keys and IVs for the
selected cryptographic algorithms. The key-exchange process provides assurance that the
server is the owner of the public key, but additional steps may be required to verify the
server’s identity; see Section 10.2.1.2 for a discussion on the verification of the server’s
public host key.

The protocol provides data- integrity protection by choosing a MAC algorithm for each
communication direction between the server and the client. However, the protocol also
allows this service (i.e., data-integrity protection) to be disabled.

10.1.2 The User Authentication Protocol (UAP)
The User Authentication Protocol authenticates the client to the server. After the TLP is
completed, the server and the client communicate using an encrypted SSH tunnel44 that
uses the selected encryption algorithm(s) from the negotiation process and the keys from

42
  This section discusses SSH version 2, sometimes called SSH2 or SSH-2. SSH1 never became a standard
protocol and was later replaced by the SSH2 protocol, which is the SSH protocol in [RFC 4251].
43
  Perfect forward secrecy is a cryptographic property of a key-establishment method in which the
compromise of a currently established session key or long-term private key does not cause the compromise
of any earlier established session keys.
44
  An encrypted tunnel is an end-to-end communication connection where all of the data traffic going
through the connection is encrypted.

                                                   62
