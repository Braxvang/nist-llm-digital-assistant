                                                                                               NIST SP 800-56A Rev. 3                            Recommendation for Pair-Wise Key Establishment
                                                                                                                                                         Using Discrete Logarithm Cryptography

                                                                                               Party U provides MacTagU to party V (as specified in Sections 5.9.1 and 5.9.2, with P = U
                                                                                               and R = V); MacTagU is computed by party U (and verified by party V) using
                                                                                                   MacDataU = “KC_2_U” || IDU || IDV || EphemPubKeyU || EphemPubKeyV {|| TextU}.
                                                                                               Note that in Figure_6, party V’s ephemeral public key (EphemPubKeyV) and the MacTag
                                                                                               (MacTagV) are depicted as being sent in the same message (to reduce the number of passes
                                                                                               in the combined key-agreement/key-confirmation process). They may also be sent
                                                                                               separately, and if sent separately, then the order in which the MacTags are sent could be
                                                                                               reversed.
                                                                                               Each party shall destroy its copy of MacKey immediately after 1) using it to generate a MAC
                                                                                               tag to be sent to the other party and 2) determining whether or not the MAC tag received
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                               from the other party matches the MAC tag that it computed. However, if either party is not
                                                                                               able to verify the received MAC tag, that party shall also destroy the KeyData portion of the
                                                                                               DerivedKeyingMaterial (see Section 5.9.1) and notify the other party of the failure. In this
                                                                                               case, the other party shall destroy both the MacKey (if it has not already done so) as well as
                                                                                               the KeyData portion of the DerivedKeyingMaterial.

                                                                                               6.1.2 C(2e, 0s) Schemes
                                                                                               For this category, only Diffie-Hellman schemes are specified. Each party generates
                                                                                               ephemeral key pairs with the same domain parameters. The two parties exchange ephemeral
                                                                                               public keys and then compute the shared secret. The secret keying material is derived using
                                                                                               the shared secret (see Figure 7).


                                                                                                                        U                                          V

                                                                                                                                 U’s Ephemeral Public Key
                                                                                                                                                                          Exchange
                                                                                                                                 V’s Ephemeral Public Key                 ephemeral
                                                                                                                                                                          public keys




                                                                                                  Figure 7: C(2e, 0s) schemes: each party contributes only an ephemeral key pair
                                                                                               Assumptions: In order to execute a C(2e, 0s) key-establishment scheme in compliance with
                                                                                               this Recommendation, the following assumptions shall be true.
                                                                                                  1. Each party has an authentic copy of the same set of domain parameters, D. These
                                                                                                     parameters are either approved for use in the intended application (see Section
                                                                                                     5.5.1). For FFC schemes, D = (p, q, g{, SEED, counter}); for ECC schemes, D = (q,
                                                                                                     FR, a, b{, SEED}, G, n, h). Furthermore, each party has obtained assurance of the
                                                                                                     validity of these domain parameters as specified in Section 5.5.2.


                                                                                                                                            78
