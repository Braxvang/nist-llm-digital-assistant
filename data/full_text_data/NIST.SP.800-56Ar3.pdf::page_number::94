                                                                                               NIST SP 800-56A Rev. 3                             Recommendation for Pair-Wise Key Establishment
                                                                                                                                                          Using Discrete Logarithm Cryptography

                                                                                                      has obtained assurance of the validity of its own static public key as specified in
                                                                                                      Section 5.6.2.1.3. Each party has also obtained assurance of its possession of the
                                                                                                      correct value for its own private key as specified in Section 5.6.2.1.5.
                                                                                                  3. The parties have agreed upon an approved key-derivation method, as well as an
                                                                                                     approved algorithm to be used with that method (e.g., a hash function) and other
                                                                                                     associated parameters to be used for key derivation (see Section 5.8).
                                                                                                  4. If key confirmation is used, the parties have also agreed upon an approved MAC and
                                                                                                     associated parameters, including the lengths of MacKey and MacTag (see Section
                                                                                                     5.9.3). If party V provides key confirmation to party U, the parties have agreed upon
                                                                                                     the form of NonceV, which should be a random nonce (see Section 5.4).
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                                  5. Prior to or during the key-agreement process, each party receives the other party’s
                                                                                                     static public key in a trusted manner (e.g., from a certificate signed by a trusted CA
                                                                                                     or directly from the other party, who is trusted by the recipient). Each party has
                                                                                                     obtained assurance of the validity of the other party’s static public key as specified in
                                                                                                     Section 5.6.2.2.1.
                                                                                                  6. The recipient of a static public key has obtained assurance that its (claimed) owner is
                                                                                                     (or was) in possession of the corresponding static private key, as specified in Section
                                                                                                     5.6.2.2.3.
                                                                                                  7. When an identifier is used to label a party during the key-agreement process, that
                                                                                                     identifier has a trusted association to that party’s static public key. (In other words,
                                                                                                     whenever both the identifier and static public key of one participant are employed in
                                                                                                     the key-agreement process, they are associated in a manner that is trusted by the other
                                                                                                     participant.) When an identifier is used to label a party during the key-agreement
                                                                                                     process, both parties are aware of the particular identifier employed for that purpose.

                                                                                               6.2.1.1 dhHybridOneFlow, C(1e, 2s, FFC DH) Scheme
                                                                                               This section describes the dhHybridOneFlow scheme. Assurance of secure key establishment
                                                                                               using this scheme can only be obtained when the assumptions in Section 6.2.1 are true. In
                                                                                               particular, it is assumed that party U has obtained the static public key yV of party V, and
                                                                                               party V has obtained the static public key yU of party U.
                                                                                               In this scheme, each party has different actions, which are presented separately below.
                                                                                               However, note that parties U and V must use identical orderings of the bit strings that are
                                                                                               input to the key-derivation method.

                                                                                               Party U shall execute the following actions to a) establish a shared secret value Z with party
                                                                                               V, and b) derive secret keying material from Z.
                                                                                               Actions: Party U generates a shared secret and derives secret keying material as follows:
                                                                                                  1. Generate an ephemeral key pair (rU, tU) from the domain parameters D as specified
                                                                                                     in Section 5.6.1.1. Send the public key tU to party V.
                                                                                                  2. Use the FFC DH primitive in Section 5.7.1.1 to derive a shared secret Zs from the set
                                                                                                     of domain parameters D, party U’s static private key xU, and party V’s static public

                                                                                                                                            83
