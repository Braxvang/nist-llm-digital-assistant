                                                      GUIDE TO INTEGRATING FORENSIC TECHNIQUES INTO INCIDENT RESPONSE



product name, service name or port number, text strings within the malware, and files or settings modified
on the target.126 Virtually any instance of malware, other than the latest threats (e.g., released in the past
several hours), is likely to be included in major malware databases. Each database entry typically
contains extensive information on how the worm spreads, how it affects systems (e.g., what changes it
makes), and how it can be eradicated, including measures concerning prevention of infections on other
systems.

If a search of malware databases does not lead to identification of the worm, then the incident handler
may need to perform additional research and analysis to discover the information usually provided by
malware database entries. Although the organization can send a copy of the worm to the organization’s
antivirus vendor for analysis and identification, the organization should perform its own analysis in the
meantime, since the time frame for the vendor’s response is unknown. To gather more information, the
analyst can examine the infection through the following methods:

      ! Current State of the Host. The analyst can examine the host to look at several aspects of its
        current state. In this case, it is probably most effective to examine the network connections
        listing to identify unusual connections (e.g., large number, unexpected port number usage,
        unexpected hosts) and unexpected listening ports (e.g., backdoors created by the worm). Other
        steps that may be useful include identifying unknown processes in the running processes list and
        examining the host’s logs to reveal any unusual entries that may be related to the infection.
      ! Host’s Network Activity. The analyst can collect worm traffic being generated by the infected
        server through a packet sniffer and protocol analyzer. This may provide enough additional
        information regarding the characteristics of the worm to enable the analyst to locate it in major
        malware databases.
Worm incidents often necessitate as rapid a response as possible, because an infected system may be
attacking other systems inside and outside the organization. In addition, worms often install backdoors
and other tools on systems that permit attackers to gain remote access to infected systems, which can
create additional damage. Accordingly, organizations may choose to disconnect infected systems from
networks immediately, instead of performing data collection for the host first. This step may make it
considerably more difficult for analysts to identify a worm and to determine its effects on systems—for
example, if systems are disconnected from the network, network activity and certain aspects of the host
state will not be available. In such cases, the analyst may need to perform a more detailed forensic
analysis of the server, such as collecting its filesystems and examining them for signs of malicious
activity (e.g., altered system executables) to determine exactly what happened to the server. The analyst
can also examine non-volatile characteristics of the server’s OS, such as looking for administrative-level
user accounts and groups that may have been added by the worm. Ultimately, the analyst should gather
enough information to identify the worm’s behavior in sufficient detail to enable the incident response
team to act effectively to contain, eradicate, and recover from the incident.

8.2     Threatening E-mail

An incident handler responds to a request for assistance with an internal investigation. An employee has
been accused of sending a threatening e-mail to another employee through the organization’s e-mail
system. The incident handler has been asked to help investigators find all data sources that may contain

126
      Malware databases are maintained by several vendors, including Computer Associates
      (http://www3.ca.com/securityadvisor/virusinfo/default.aspx), F-Secure (http://www.f-secure.com/virus-info/), Network
      Associates (http://vil.nai.com/vil/default.aspx), Sophos (http://www.sophos.com/virusinfo/analyses/), Symantec
      (http://securityresponse.symantec.com/avcenter/vinfodb.html), and Trend Micro
      (http://www.trendmicro.com/vinfo/virusencyclo/).


                                                              8-3
