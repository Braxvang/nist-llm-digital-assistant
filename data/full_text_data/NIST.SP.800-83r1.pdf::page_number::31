                                 GUIDE TO MALWARE INCIDENT PREVENTION AND HANDLING FOR DESKTOPS AND LAPTOPS


     Malware category (e.g., virus, worm, Trojan horse)
     Services, ports, protocols, etc. that are attacked
     Vulnerabilities that are exploited (e.g., software flaws, misconfigurations, social engineering)
     Malicious filenames, sizes, content, and other metadata (e.g., email subjects, web URLs)
     Which versions of operating systems, devices, applications, etc., may be affected
     How the malware affects the infected host, including the names and locations of affected files,
      altered configuration settings, installed backdoor ports, etc.
     How the malware propagates and how to approach containment
     How to remove the malware from the host.
Unfortunately, the newest threats might not be included in malware databases for several hours or days,
depending on the relative importance of the threat, and highly customized threats might not be included in
malware databases at all. Therefore, incident handlers may need to consult other sources of information.
One option is using public security mailing lists, which might contain first-hand accounts of malware
incidents; however, such reports are often incomplete or inaccurate, so incident handlers should validate
any information obtained from these sources. Another potentially valuable source of malware
characteristic information is peers at other organizations. Other organizations may have already been
affected and gathered data on the threat. Establishing and maintaining good relationships with peers at
other organizations that face similar problems can be advantageous for all involved. An alternative source
of information is self-discovery by performing malware analysis (see Section 4.2.4). This is particularly
important if the malware is highly customized; there may be no other way of getting details for the
malware other than doing a hands-on analysis.

4.2.2   Identifying Infected Hosts

Identifying hosts that are infected by malware is part of every malware incident. Once identified, infected
hosts can undergo the appropriate containment, eradication, and recovery actions. Unfortunately,
identifying all infected hosts is often complicated by the dynamic nature of computing. For instance,
people shut hosts down, disconnect them from networks, or move them from place to place, making it
extremely difficult to identify which hosts are currently infected. In addition, some hosts can boot to
multiple OSs or use virtual operating system software; an infection in one OS instantiation might not be
detectable when a host is currently using another OS.

Accurate identification of infected hosts can also be complicated by other factors. For example, hosts with
unmitigated vulnerabilities might be disinfected and reinfected multiple times. Some instances of
malware actually remove some or all traces of other malware, which could cause the partially or fully
removed infections to go undetected. In addition, the data concerning infected hosts might come from
several sources—antivirus software, IDSs, SIEMs, user reports, and other methods—and be very difficult
to consolidate and keep current.

Given the number of malware threats, all infection identification should be performed through automated
means (as described in Sections 4.2.2.1 and 4.2.2.2). Manual identification methods, such as relying on
users to identify and report infected hosts, and having technical staff personally check each host, are not
feasible for most situations. Organizations should carefully consider host identification issues so that they
are prepared to use multiple identification strategies as part of implementing effective containment
strategies. Organizations should also determine which types of identifying information might be needed



                                                     20
