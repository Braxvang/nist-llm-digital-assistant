       NIST SP 800-90C 3pd (Third Public Draft)                           Recommendation for RBG Constructions
       September 2022

1619   RBG3(XOR)_DRBG_Instantiate:
1620       Input: integer (prediction_resistance_flag), string personalization_string.
1621       Output: integer status, integer state_handle.
1622       Process:
1623          1. (status, RBG3(XOR)_state_handle) = Instantiate_function(256,
1624             prediction_resistance_flag, personalization_string).
1625           2. Return (status, RBG3(XOR)_state_handle).
1626   In step 1, the DRBG is instantiated at a security strength of 256 bits. The
1627   prediction_resistance_flag and personalization_string (when provided as input to the
1628   RBG3(XOR)_DRBG_Instantiate function) shall be used in step 1.
1629   In step 2, the status and RBG3(XOR)_state_handle that were obtained in step 1 are returned. Note
1630   that if the status does not indicate a successful instantiate process (i.e., a failure is indicated), the
1631   returned state handle shall be invalid (e.g., a Null value). The handling of status codes is discussed
1632   in Section 2.8.3.

1633   6.2.1.2.        Random and Pseudorandom Bit Generation
1634   Let n be the requested number of bits to be generated, and let the RBG3(XOR)_state_handle be
1635   the value returned by the instantiation function for RBG3’s DRBG instantiation (see Section
1636   6.2.1.1). Random bits with full entropy shall be generated by the RBG3(XOR) construction using
1637   the following generate function:
1638   RBG3(XOR)_Generate:
1639     Input: integer (RBG3(XOR)_state_handle, n, prediction_resistance_request), string
1640     additional_input.
1641       Output: integer status, string returned_bits.
1642       Process:
1643          1. (status, ES_bits) = Request_entropy(n).
1644           2. If (status ≠ SUCCESS), then return (status, invalid_string).
1645           3. (status, DRBG_bits) = Generate_function(RBG3(XOR)_state_handle, n, 256,
1646              prediction_resistance_request, additional_input).
1647           4. If (status ≠ SUCCESS), then return (status, invalid_string).
1648           5. returned_bits = ES_bits ⊕ DRBG_bits.
1649           6. Return (SUCCESS, returned_bits).
1650   Step 1 requests that the entropy sources generate bits. Since full-entropy bits are required, the
1651   (place holder) Request_entropy call shall be replaced by one of the following:




                                                          46
