       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management


1834   lower AAL than the authentication event but SHALL NOT be considered at a higher AAL
1835   than the authentication event.
1836   Secrets used for session binding SHALL meet all of the following requirements:
1837      1. Secrets are generated by the session host during an interaction, typically
1838         immediately following authentication.
1839      2. Secrets are generated by an approved random bit generator [SP800-90Ar1] and
1840         contain at least 64 bits of entropy.
1841      3. Secrets are erased or invalidated by the session subject when the subscriber logs
1842         out.
1843      4. Secrets are sent to and received from the device using an authenticated protected
1844         channel.
1845      5. Secrets will time out and are not accepted after the times specified in Sections 4.1.3,
1846         4.2.3, and 4.3.3, as appropriate for the AAL.
1847      6. Secrets are not made available to insecure communications between the host and
1848         subscriberâ€™s endpoint.
1849   In addition, secrets used for session binding SHOULD be erased on the subscriber
1850   endpoint when they log out or when the secret is deemed to have expired. They
1851    SHOULD NOT be placed in insecure locations such as HTML5 Local Storage due to
1852   the potential exposure of local storage to cross-site scripting (XSS) attacks.
1853   Authenticated sessions SHALL NOT fall back to an insecure transport, such as from https
1854   to http, following authentication.
1855   URLs or POST content SHALL contain a session identifier that SHALL be verified by
1856   the RP to protect against cross-site request forgery.
1857   There are several mechanisms for managing a session over time. The following sections
1858   give different examples along with additional requirements and considerations particular
1859   to each example technology. Additional informative guidance is available in the OWASP
1860   Session Management Cheat Sheet [OWASP-session].

1861   7.1.1. Browser Cookies
1862   Browser cookies are the predominant mechanism by which a session will be created and
1863   tracked for a subscriber accessing a service. Cookies are not authenticators, but they are
1864   suitable as short-term secrets (for the duration of a session).
1865   Cookies used for session maintenance SHALL meet all of the following requirements:
1866      1. Cookies are tagged to be accessible only on secure (HTTPS) sessions.
1867      2. Cookies are accessible to the minimum practical set of hostnames and paths.

                                                    49
