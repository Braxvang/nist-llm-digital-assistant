                                                                                             NIST SP 800-90B                                                 RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                     USED FOR RANDOM BIT GENERATION

                                                                                                                Min-Entropy and Optimum Guessing Attack Cost

                                                                                             Suppose that an adversary wants to determine at least one of several secret values, where each
                                                                                             secret value is independently chosen from a set of M possibilities, with probability distribution P
                                                                                             = {p1, p2, …, pM}. Assume that these probabilities are sorted so that p1 ≥ p2 ≥ …≥ pM . Consider a
                                                                                             guessing strategy aimed at successfully guessing as many secret values as possible. The adversary's
                                                                                             goal would be to minimize the expected number of guesses per successful recovery. Such a strategy
                                                                                             would consist of guessing a maximum of k possibilities for a given secret value, moving on to a
                                                                                             new secret value when either a guess is correct, or k incorrect guesses for the current value have
                                                                                             been made. In general, the optimum value of k can be anywhere in the range 1 ≤ k ≤ M, depending
                                                                                             on the probability distribution P. Note that when k = M, the Mth guess is considered a valid (though
                                                                                             trivial) guess. Regardless of the value of k chosen, it is clear that the k guesses selected for a given
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                             secret value should be the k most likely possible values, in decreasing order of probability.

                                                                                             The expected work per success can be computed for this attack as follows. For 1 ≤ j ≤ k – 1, the
                                                                                             attacker will make exactly j guesses if the secret value is the jth most likely value, an event having
                                                                                             probability pj. The attacker will make exactly k guesses if the secret value is not any of the k – 1
                                                                                             most likely values, an event having probability 1 − ∑𝑘𝑘−1
                                                                                                                                                    𝑗𝑗=1 𝑝𝑝𝑗𝑗 . Thus, the expected number of guesses
                                                                                             for the attack is given by the following:

                                                                                                                                                                       𝑘𝑘−1

                                                                                                                        𝑝𝑝1 + 2𝑝𝑝2 + ⋯ + (𝑘𝑘 − 1)𝑝𝑝𝑘𝑘−1 + 𝑘𝑘 �1 − � 𝑝𝑝𝑗𝑗 �.
                                                                                                                                                                       𝑗𝑗=1


                                                                                             Since this attack will be successful if and only if the secret value is one of the k most likely
                                                                                             possibilities, which is the case with probability ∑𝑘𝑘𝑗𝑗=1 𝑝𝑝𝑗𝑗 , the expected number of times the attack
                                                                                             must be performed until the first success is the reciprocal of this probability. Multiplying this
                                                                                             reciprocal by the expected number of guesses per attack gives the following as the expected work
                                                                                             per success:

                                                                                                                              𝑝𝑝1 + 2𝑝𝑝2 + ⋯ + (𝑘𝑘 − 1)𝑝𝑝𝑘𝑘−1 + 𝑘𝑘 �1 − ∑𝑘𝑘−1
                                                                                                                                                                         𝑗𝑗=1 𝑝𝑝𝑗𝑗 �
                                                                                                                𝑊𝑊𝑘𝑘 (𝑃𝑃) =                                                            .
                                                                                                                                                    ∑𝑘𝑘𝑗𝑗=1 𝑝𝑝𝑗𝑗

                                                                                             It is not critical to determine the value k* that minimizes 𝑊𝑊𝑘𝑘 (𝑃𝑃), since the min-entropy of P leads
                                                                                             to an accurate approximation (and sometimes the exact value) of 𝑊𝑊𝑘𝑘 ∗ (𝑃𝑃). Stated more precisely,
                                                                                                          1                                                                          1    1
                                                                                             𝑊𝑊1 (𝑃𝑃) = 𝑝𝑝 is an upper bound of 𝑊𝑊𝑘𝑘 ∗ (𝑃𝑃), and it can be shown that 𝑊𝑊𝑘𝑘 (𝑃𝑃) ≥ 2𝑝𝑝 + 2 for all k
                                                                                                        1                                                                                  1
                                                                                             such that 1 ≤ k ≤ M. Since the min-entropy of P is − log 2 (𝑝𝑝1 ), these two bounds imply that the
                                                                                             error between the min-entropy of P and log 2 (𝑊𝑊𝑘𝑘 ∗ (𝑃𝑃)) can be bounded as follows:

                                                                                                                     0 ≤ − log 2 𝑝𝑝1 − log 2 �𝑊𝑊𝑘𝑘 ∗ (𝑃𝑃)� ≤ 1 − log 2 (𝑝𝑝1 + 1).
                                                                                                                 1
                                                                                             Notice that since 𝑀𝑀 ≤ 𝑝𝑝1 ≤ 1, the upper bound on the error approaches 0 as 𝑝𝑝1 → 1, and
                                                                                                                                                                   1
                                                                                             alternatively, this bound approaches 1 as 𝑀𝑀 → ∞ and 𝑝𝑝1 → 𝑀𝑀. In other words, the min-entropy of



                                                                                                                                                  69
