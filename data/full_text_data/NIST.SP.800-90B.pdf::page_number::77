                                                                                             NIST SP 800-90B                                                 RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                     USED FOR RANDOM BIT GENERATION

                                                                                                                Min-Entropy and Optimum Guessing Attack Cost

                                                                                             Suppose that an adversary wants to determine at least one of several secret values, where each
                                                                                             secret value is independently chosen from a set of M possibilities, with probability distribution P
                                                                                             = {p1, p2, â€¦, pM}. Assume that these probabilities are sorted so that p1 â‰¥ p2 â‰¥ â€¦â‰¥ pM . Consider a
                                                                                             guessing strategy aimed at successfully guessing as many secret values as possible. The adversary's
                                                                                             goal would be to minimize the expected number of guesses per successful recovery. Such a strategy
                                                                                             would consist of guessing a maximum of k possibilities for a given secret value, moving on to a
                                                                                             new secret value when either a guess is correct, or k incorrect guesses for the current value have
                                                                                             been made. In general, the optimum value of k can be anywhere in the range 1 â‰¤ k â‰¤ M, depending
                                                                                             on the probability distribution P. Note that when k = M, the Mth guess is considered a valid (though
                                                                                             trivial) guess. Regardless of the value of k chosen, it is clear that the k guesses selected for a given
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                             secret value should be the k most likely possible values, in decreasing order of probability.

                                                                                             The expected work per success can be computed for this attack as follows. For 1 â‰¤ j â‰¤ k â€“ 1, the
                                                                                             attacker will make exactly j guesses if the secret value is the jth most likely value, an event having
                                                                                             probability pj. The attacker will make exactly k guesses if the secret value is not any of the k â€“ 1
                                                                                             most likely values, an event having probability 1 âˆ’ âˆ‘ğ‘˜ğ‘˜âˆ’1
                                                                                                                                                    ğ‘—ğ‘—=1 ğ‘ğ‘ğ‘—ğ‘— . Thus, the expected number of guesses
                                                                                             for the attack is given by the following:

                                                                                                                                                                       ğ‘˜ğ‘˜âˆ’1

                                                                                                                        ğ‘ğ‘1 + 2ğ‘ğ‘2 + â‹¯ + (ğ‘˜ğ‘˜ âˆ’ 1)ğ‘ğ‘ğ‘˜ğ‘˜âˆ’1 + ğ‘˜ğ‘˜ ï¿½1 âˆ’ ï¿½ ğ‘ğ‘ğ‘—ğ‘— ï¿½.
                                                                                                                                                                       ğ‘—ğ‘—=1


                                                                                             Since this attack will be successful if and only if the secret value is one of the k most likely
                                                                                             possibilities, which is the case with probability âˆ‘ğ‘˜ğ‘˜ğ‘—ğ‘—=1 ğ‘ğ‘ğ‘—ğ‘— , the expected number of times the attack
                                                                                             must be performed until the first success is the reciprocal of this probability. Multiplying this
                                                                                             reciprocal by the expected number of guesses per attack gives the following as the expected work
                                                                                             per success:

                                                                                                                              ğ‘ğ‘1 + 2ğ‘ğ‘2 + â‹¯ + (ğ‘˜ğ‘˜ âˆ’ 1)ğ‘ğ‘ğ‘˜ğ‘˜âˆ’1 + ğ‘˜ğ‘˜ ï¿½1 âˆ’ âˆ‘ğ‘˜ğ‘˜âˆ’1
                                                                                                                                                                         ğ‘—ğ‘—=1 ğ‘ğ‘ğ‘—ğ‘— ï¿½
                                                                                                                ğ‘Šğ‘Šğ‘˜ğ‘˜ (ğ‘ƒğ‘ƒ) =                                                            .
                                                                                                                                                    âˆ‘ğ‘˜ğ‘˜ğ‘—ğ‘—=1 ğ‘ğ‘ğ‘—ğ‘—

                                                                                             It is not critical to determine the value k* that minimizes ğ‘Šğ‘Šğ‘˜ğ‘˜ (ğ‘ƒğ‘ƒ), since the min-entropy of P leads
                                                                                             to an accurate approximation (and sometimes the exact value) of ğ‘Šğ‘Šğ‘˜ğ‘˜ âˆ— (ğ‘ƒğ‘ƒ). Stated more precisely,
                                                                                                          1                                                                          1    1
                                                                                             ğ‘Šğ‘Š1 (ğ‘ƒğ‘ƒ) = ğ‘ğ‘ is an upper bound of ğ‘Šğ‘Šğ‘˜ğ‘˜ âˆ— (ğ‘ƒğ‘ƒ), and it can be shown that ğ‘Šğ‘Šğ‘˜ğ‘˜ (ğ‘ƒğ‘ƒ) â‰¥ 2ğ‘ğ‘ + 2 for all k
                                                                                                        1                                                                                  1
                                                                                             such that 1 â‰¤ k â‰¤ M. Since the min-entropy of P is âˆ’ log 2 (ğ‘ğ‘1 ), these two bounds imply that the
                                                                                             error between the min-entropy of P and log 2 (ğ‘Šğ‘Šğ‘˜ğ‘˜ âˆ— (ğ‘ƒğ‘ƒ)) can be bounded as follows:

                                                                                                                     0 â‰¤ âˆ’ log 2 ğ‘ğ‘1 âˆ’ log 2 ï¿½ğ‘Šğ‘Šğ‘˜ğ‘˜ âˆ— (ğ‘ƒğ‘ƒ)ï¿½ â‰¤ 1 âˆ’ log 2 (ğ‘ğ‘1 + 1).
                                                                                                                 1
                                                                                             Notice that since ğ‘€ğ‘€ â‰¤ ğ‘ğ‘1 â‰¤ 1, the upper bound on the error approaches 0 as ğ‘ğ‘1 â†’ 1, and
                                                                                                                                                                   1
                                                                                             alternatively, this bound approaches 1 as ğ‘€ğ‘€ â†’ âˆ and ğ‘ğ‘1 â†’ ğ‘€ğ‘€. In other words, the min-entropy of



                                                                                                                                                  69
