                               Federal S/MIME V3 Client Profile


Conforming implementations MUST be able to receive messages where inner MIME encodings
are not individually Base64 encoded. There is no requirement that S/MIME implementations
generate messages with inner MIME encodings without Base64, although S/MIME
implementations SHOULD be able to generate messages with Base64 encoding applied only to
the outermost binary data.

2.1.5 Mail Access Protocols (POP/IMAP)
To send S/MIME messages over the Internet each end user (e.g., e-mail client) must have one or
more e-mail accounts on an SMTP-enabled server (i.e., a standard Internet mail server).
Normally, each client also needs a “mail access” protocol, (e.g., POP, IMAP) to support transfer
of messages to/from the e-mail server and their local computer. With respect to this S/MIME V3
Client Profile, the “mail access” protocol is out-of-scope.


2.2 S/MIME Message Generation
S/MIME implementations MUST be able to generate S/MIME messages that are correctly
formatted as per IETF S/MIME V3 specifications and include sufficient information for the
recipient to verify the signature or decrypt the data. In addition, these messages MAY include
information to allow the recipient to generate secure responses.

2.2.1 Sending Signed Messages
    • S/MIME implementations MUST be able to generate SignerInfo including signed
      attributes.
    • S/MIME implementations MUST be able to generate SMIMECapabilities and
      signingTime attributes.
    • S/MIME implementations SHOULD be able to generate signingCertificate attributes.
    • S/MIME implementations MUST be able to include user certificates and appropriate
      CRLs.
    • S/MIME implementations MUST be able to generate multipart/signed (i.e., "clear")
      messages.
    • S/MIME implementations MUST be able to request return signed receipt messages (as
      specified in [RFC 2634]) where the receipt goes to the message originator. (Requesting a
      return signed receipt where the receipt is directed to a third party is out of scope for this
      profile, and thus claims to conformance will not be tested. However, correctly
      responding to the reception of such a signed receipt request is required, as stated in
      Clause 2.3.2)

2.2.2 Sending Encrypted Messages
    • S/MIME implementations MUST be able to generate symmetric keys, encrypt messages
      using these keys, and encrypt symmetric keys using PKCS#1 v1.5 RSA keys as defined
      in [RFC2313].
    • S/MIME implementations SHOULD be able to generate Diffie-Hellman keys and derive
      pairwise symmetric key-encryption keys (KEK) as defined in [RFC2631], and then use
      the KEK to encrypt the content-encryption key as specified in [RFC2630].
    • S/MIME implementations MUST be able to encrypt a message for multiple recipients.




                                             6
