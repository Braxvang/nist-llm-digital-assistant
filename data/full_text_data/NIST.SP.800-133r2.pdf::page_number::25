                                                                                               NIST SP 800-133 REV. 2                                                      RECOMMENDATION FOR
                                                                                                                                                                   CRYPTOGRAPHIC KEY GENERATION

                                                                                               6.2       Derivation of Symmetric Keys
                                                                                               Symmetric keys are often obtained from the output of an approved key-derivation method
                                                                                               (KDM), which is a cryptographic process specifically designed to transform secret input values
                                                                                               into bit strings that can be parsed into cryptographic keys and/or other secret keying material.
                                                                                               Approved KDMs have been constructed from more basic cryptographic components, such as an
                                                                                               approved hash function, as specified in FIPS 180 or FIPS 202; HMAC (using an approved hash
                                                                                               function), as specified in FIPS 198; AES-CMAC, as specified in FIPS 197 and SP 800-38B; or a
                                                                                               KMAC variant, as specified in SP 800-185.
                                                                                               Depending on the application and the KDM, the input to a KDM may include, for example, one
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-133r2




                                                                                               or more of the following:
                                                                                                     •   A shared secret value produced during the execution of a key-agreement scheme;
                                                                                                     •   A cryptographic key (i.e., a key-derivation key (KDK));
                                                                                                     •   A password or passphrase;
                                                                                                     •   A salt value, which may be secret or non-secret, fixed, or randomly selected;
                                                                                                     •   A nonce (including RBG output) that may, for example, indicate the algorithm to be
                                                                                                         associated with the key (e.g., AES), the use of the key (e.g., email), or any other
                                                                                                         information that may be useful for associating a particular execution of the KDM with the
                                                                                                         key(s) to be derived.
                                                                                               Approved key-derivation methods can be divided into two categories:
                                                                                                     1) The first category consists of one-step key-derivation methods, which are usually called
                                                                                                        key-derivation functions (KDFs). General-purpose KDFs are based on pseudorandom
                                                                                                        functions (PRFs) that use a KDK (and other input) to generate additional keys (see SP 800-
                                                                                                        108). Some special-purpose KDFs, which are employed only as components of key-
                                                                                                        agreement schemes, are used to obtain keying material from the shared secrets produced
                                                                                                        during the execution of such schemes (see SP 800-56C and SP 800-135); other special-
                                                                                                        purpose KDFs are to be used only for password-based protection of stored data and/or the
                                                                                                        keys that protect that data (see SP 800-132).
                                                                                                     2) The second category consists of extraction-then-expansion key-derivation procedures that
                                                                                                        involve two steps:
                                                                                                            a. Randomness extraction to obtain a single cryptographic key-derivation key. The
                                                                                                               extraction of a KDK from a shared secret produced during the execution of a key-
                                                                                                               agreement scheme is described in SP 800-56C. The HMAC-based extraction of a
                                                                                                               symmetric key from the concatenation of pre-existing symmetric keys (and,
                                                                                                               perhaps, other data) is described in Section 6.3 (along with other methods of
                                                                                                               combining preexisting keys to form a new key). The key resulting from a key-
                                                                                                               extraction process can be used as a KDK for key expansion.




                                                                                                                                                19
