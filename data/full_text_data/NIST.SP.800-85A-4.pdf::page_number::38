NIST SP 800-85A-4                                                         PIV CARD APPLICATION & MIDDLEWARE
                                                                                   INTERFACE TEST GUIDELINES

    PIV MiddlewarePIV Middleware   Section                   PIV Card Application      Mapping Description
    Functions                                                Card Command 4
    pivSelectCardApplication       A.4.2.1                   SELECT                    Passes the AID value. Sets
                                                                                       the value for ‘Currently
                                                                                       Selected Application’ on the
                                                                                       PIV Card. Establishes the PIV
                                                                                       Card Application security
                                                                                       status.
    pivLogIntoCardApplication      A.4.2.2                   VERIFY                    Provides the key reference for
                                                                                       PIV Card Application PIN,
                                                                                       Global PIN, pairng code, or
                                                                                       OCC as well as its
                                                                                       corresponding value.
                                                                                       Sets/updates the PIV Card
                                                                                       Application security status on
                                                                                       the card; optionally (according
                                                                                       to discovery object)
                                                                                       establishes VCI with pairing
                                                                                       code after
                                                                                       pivEstablishSecureMessaging
                                                                                       is invoked.
    pivLogOutOfCardApplication     A.4.2.4                   VERIFY                    Resets the security status on
                                                                                       all local key references.
    pivGetData                     A.4.2.3                   GET DATA                  Maps the OID to BER-TLV tag
                                                                                       for the selected object.
    pivPutData                     A.4.4.1                   PUT DATA                  Maps the OID to BER-TLV tag
                                                                                       for the selected object.
    pivGenerateKeyPair             A.4.4.2                   GENERATE                  Passes the key reference and
                                                             ASYMMETRIC KEY            cryptographic mechanism
                                                             PAIR                      identifier value.
    pivCrypt                       A.4.3.1                   GENERAL                   Passes the key reference,
                                                             AUTHENTICATE              cryptographic algorithm
                                                                                       reference and the string to be
                                                                                       acted upon. Sets/updates the
                                                                                       PIV Card Application security
                                                                                       status on the card, if
                                                                                       applicable.
    pivMiddlewareVersion           A4.1.3                    No equivalent             Returns the PIV Middleware
                                                             command                   version supported by the PIV
                                                                                       Middleware IUT.
    pivEstablishSecureMessaging    A.4.2.5                   GENERAL                   Passes the key reference and
                                                             AUTHENTICATE 5            cryptographic algorithm
                                                                                       reference to the PIV Card
                                                                                       Application in order to
                                                                                       establish secure messaging.
                                                                                       Establishes, controls, and
                                                                                       maintains the session key.


A.4.1.1          pivConnect

AS04.02: The purpose of pivConnect is to connect the PIV API to the PIV Card Application
on a specific ICC.

5
 In order to establish a VCI, pivLogIntoCardApplication may be required (as indicated in the Discovery Object) after
successful execution of pivEstablishSecureMessaging.


                                                  A-10
