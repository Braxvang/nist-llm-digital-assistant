                                                                                               NIST SP 800-56A Rev. 3                                Recommendation for Pair-Wise Key Establishment
                                                                                                                                                             Using Discrete Logarithm Cryptography


                                                                                                                        Static private key xU                Static private key xV
                                                                                                  Static data
                                                                                                                        Static public key yU                 Static public key yV

                                                                                                  Ephemeral             Ephemeral private key rU             Ephemeral private key rV
                                                                                                  data                  Ephemeral public key tU              Ephemeral public key tV

                                                                                                                        Compute Z by calling FFC MQV Compute Z by calling FFC MQV
                                                                                                  Computation
                                                                                                                        using xU, yV, rU, tU, and tV using xV, yU, rV, tV, and tU

                                                                                                  Derive secret         1. Compute                           1. Compute
                                                                                                                           DerivedKeyingMaterial                DerivedKeyingMaterial
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                                  keying
                                                                                                  material              2. Destroy Z                         2. Destroy Z

                                                                                               6.1.1.4 Full MQV, C(2e, 2s, ECC MQV) Scheme
                                                                                               This section describes the Full MQV scheme. Assurance of secure key establishment using
                                                                                               this scheme can only be obtained when the assumptions in Section 6.1.1 are true. In
                                                                                               particular, it is assumed that party U has obtained the static public key Qs,V of party V, and
                                                                                               party V has obtained the static public key Qs,U of party U.
                                                                                               With the exception of key derivation, the Full MQV scheme is “symmetric” in the actions of
                                                                                               parties U and V. Only the actions performed by party U are specified here; a specification of
                                                                                               the actions performed by party V may be obtained by systematically replacing the letter “U”
                                                                                               by “V” (and vice versa) in the actions listed below. Note, however, that parties U and V must
                                                                                               use identical orderings of the bit strings that are input to the key-derivation method.
                                                                                               Party U shall execute the following actions to a) establish a shared secret value Z with party
                                                                                               V, and b) derive secret keying material from Z.
                                                                                               Actions: Party U generates a shared secret and derives secret keying material as follows:
                                                                                                  1. Generate an ephemeral key pair (de,U, Qe,U) from the domain parameters D as specified
                                                                                                     in Section 5.6.1.2. Send the public key Qe,U to party V. Receive an ephemeral public
                                                                                                     key Qe,V (purportedly) from party V. If Qe,V is not received, destroy the ephemeral
                                                                                                     private key de,U; then output an error indicator, and exit this process without
                                                                                                     performing the remaining actions.
                                                                                                  2. Verify that Qe,V is a valid ephemeral public key for the parameters D as specified in
                                                                                                     Section 5.6.2.3. If assurance of public key validity cannot be obtained, destroy the
                                                                                                     ephemeral private key de,U; then output an error indicator, and exit this process
                                                                                                     without performing the remaining actions.
                                                                                                  3. Use the Full MQV form of the ECC MQV primitive in Section 5.7.2.3.1 to derive a
                                                                                                     shared secret value Z from the set of domain parameters D, party U’s static private
                                                                                                     key ds,U, party V’s static public key Qs,V, party U’s ephemeral private key de,U, party
                                                                                                     U’s ephemeral public key Qe,U, and party V’s ephemeral public key Qe,V. If the call to
                                                                                                     the ECC MQV primitive outputs an error indicator, destroy the ephemeral private
                                                                                                     key de,U, and destroy the results of all intermediate calculations used in the attempted
                                                                                                                                                73
