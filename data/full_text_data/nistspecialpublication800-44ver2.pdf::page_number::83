                                                                                 GUIDELINES ON SECURING PUBLIC WEB SERVERS



 Create and store a backup copy of the encryption keys on read-only media in case the keys are deleted
  accidentally. If the keys are lost and cannot be recovered from backup media, a new key pair and
  certificate must be created. Note that the backup copy of the keys must be physically secured and
  should be encrypted as well.

 Store the original certificate in a folder or partition accessible by only Web or system administrators
  and secured by appropriate authentication mechanisms.

 Consider running a file integrity checker in the Web server (see Section 8.2.2) and ensure that it is
  monitoring for any changes to the certificate.

 Examine system logs regularly to validate and ensure prevention of unauthorized system access.

If a malicious user gains unauthorized access to a Web server, the integrity of the entire server is lost
immediately once the encryption key pair is modified. Once a key in an SSL/TLS certificate is
compromised, it can remain compromised; for example, some CAs do not issue revocation information,
and many client implementations do not obtain or process revocation information.

Once a certificate is ready, it needs to be installed, and SSL needs to be enabled and configured. Some
steps are common to all Web servers:

 Disable SSL 1.0 and SSL 2.0.

 Configure SSL/TLS to restrict cryptographic algorithms to the selected cipher suite(s) (see Section
  7.5.4).

 Indicate the location of the SSL/TLS certificate and instruct the server to start using SSL/TLS. In
  certain cases, the Web server must be instructed to begin using SSL/TLS, and even given the location
  of the SSL/TLS certificate and private keys if they were stored as files on the hard drive.

 Instruct server to listen on TCP port 443. This is the default TCP port from which SSL/TLS
  resources are accessed by clients (other ports can be used). In most cases, if the server was not
  previously using SSL/TLS, this port would be disabled for security reasons. It will probably be
  necessary to configure the network infrastructure supporting the Web server to allow SSL/TLS traffic
  (see Section 8.2). All ports other than TCP 443 should be closed and the network infrastructure (e.g.,
  firewalls) should be updated to block attempts to connect to all other ports. However, if the Web
  server is to host both HTTP and HTTPS content, TCP 80 should be open as well.

 Configure the server to protect the necessary resources (directories and/or files) using SSL/TLS.
  Configure the Web server application so that the appropriate resources are protected with SSL/TLS.
  These resources are then accessible only from a URL that starts with “https://”.

Newer versions of the HTML standard have been amended to include a response to inform clients when a
file they have requested is available only via SSL/TLS. The HTTP status code 403.4 indicates that a
HTTP GET request must be prefixed with an https:// because the resource requested is protected with
SSL/TLS. For more information, consult RFCs 2246, 2626, and 2817. 60 Most current Web browsers also
provide users with some user-friendly visual indication of a server’s SSL/TLS certificate status, such as
changing the color of a status bar.



60
     http://www.ietf.org/rfc/rfc2246.txt, http://www.ietf.org/rfc/rfc2626.txt and http://www.ietf.org/rfc/rfc2817.txt


                                                               7-11
