                                                                                               NIST SP 800-177 REV. 1                                                                               TRUSTWORTHY EMAIL




                                                                                               not require the MTA to have the full message and can be done before any further and more
                                                                                               computationally expensive content checks. 30

                                                                                               6.3.3      Content Filtering

                                                                                               �e third type of UBE ﬁltering measures involves analysis of the actual contents of an email
                                                                                               message. �ese ﬁltering techniques examine the content of a mail message for words, phrases or
                                                                                               other elements (images, web links, etc.) that indicate that the message may be UBE.

                                                                                               Examining the textual content of an email message is done using word/phrase ﬁlters or Bayesian
                                                                                               ﬁlters [UBE1] to identify possible UBE. Since these techniques are not foolproof, most tools that
                                                                                               use these techniques allow for administrators or end users to set the threshold for UBE
                                                                                               identiﬁcation or allow messages to be marked as possible UBE to prevent false positives and the
                                                                                               deletion of valid transactional messages.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-177r1




                                                                                               Messages that contain URLs or other non-text elements (or attachments) can also be ﬁltered and
                                                                                               tested for possible malware, UBE advertisements, etc. �is could be done via blacklisting
                                                                                               (blocking email containing links to known malicious sites) or by opening the links in a
                                                                                               sandboxed browser-like component 31 in an automated fashion to record the results. If the activity
                                                                                               corresponds to anomalous or known malicious activity, the message will be tagged as malicious
                                                                                               UBE and deleted before placed into the end-user's in-box.

                                                                                               Content ﬁltering and URL analysis is more computationally expensive than other UBE ﬁltering
                                                                                               techniques since the checks are done over the message contents. �is means that the checks are
                                                                                               often done after blacklisting and domain-based authentication checks have completed. �is
                                                                                               avoids accepting and processing email from a known bad or malicious sender. End-to-end
                                                                                               encryption of messages (e.g., S/MIME or OpenPGP) can also prevent content ﬁltering.

                                                                                               Content ﬁltering could also be applied to outgoing email to identify possible botnet infection or
                                                                                               malicious code attempting to use systems within the enterprise to send UBE. Some content ﬁlters
                                                                                               may include organization-speciﬁc ﬁlters or keywords to prevent the loss of private or
                                                                                               conﬁdential information.

                                                                                               6.4      User Education

                                                                                               �e ﬁnal line of defense against malicious UBE is an educated end user. An email user that is
                                                                                               aware of the risks inherent in using email should be less likely to fall victim to fraud attempts,
                                                                                               social engineering or convinced into clicking links containing malware. While such training may
                                                                                               not stop all suspicious email, often times an educated end user can sometimes detect and avoid
                                                                                               malicious UBE that passes all automated checks.




                                                                                               30 Messages are transmitted incrementally with SMTP, header by header and then body contents and attachments. This allows for

                                                                                                     incremental and ‘just-in-time’ header and content filtering.
                                                                                               31 Sometimes called a "detonation chamber."




                                                                                                                                                                78
