                                                      GUIDE TO INTEGRATING FORENSIC TECHNIQUES INTO INCIDENT RESPONSE



6.4.4     Attacker Identification

When analyzing most attacks, identifying the attacker is not an immediate, primary concern: ensuring that
the attack is stopped and recovering systems and data are the main interests. If an attack is ongoing, such
as an extended denial of service attack, organizations might want to identify the IP address used by the
attacker so that the attack can be stopped. Unfortunately, this is often not as simple as it sounds. The
following items explain potential issues involving the IP addresses apparently used to conduct an attack:

      ! Spoofed IP Addresses. Many attacks use spoofed IP addresses. Spoofing is far more difficult to
        perform successfully for attacks that require connections to be established, so it is most
        commonly used in cases where connections are not needed.111 When packets are spoofed, usually
        the attacker has no interest in seeing the response. This is not always true—attackers could spoof
        an address from a subnet that they monitor, so that when the response goes to that system, they
        can sniff it from the network. Sometimes spoofing occurs by accident, such as an attacker
        misconfiguring a tool and accidentally using internal NAT addresses. Sometimes an attacker
        spoofs a particular address on purpose—for example, the spoofed address might be the actual
        intended target of the attack, and the organization seeing the activity might simply be a
        middleman.
      ! Many Source IP Addresses. Some attacks appear to use hundreds or thousands of different
        source IP addresses. Sometimes this appearance reflects reality—for example, DDoS attacks
        typically rely on large numbers of compromised machines performing a coordinated attack.
        Sometimes this appearance is illusory—an attack might not require the use of real source IP
        addresses, so the attacker generates many different fake IP addresses to add confusion.
        Sometimes attackers will use one real IP address and many fake ones; in that case, it might be
        possible to identify the real IP address by looking for other network activity occurring before or
        after the attack that uses any of the same IP addresses. Finding a match does not confirm that it
        was the attacker’s address; the attacker could have inadvertently or purposely spoofed a
        legitimate IP address that happened to be interacting with the organization.
      ! Validity of the IP Address. Because IP addresses are often assigned dynamically, the system
        currently at a particular IP address might not be the same system that was there when the attack
        occurred. In addition, many IP addresses do not belong to end-user systems, but instead to
        network infrastructure components that substitute their IP address for the actual source address,
        such as a firewall performing NAT. Some attackers use anonymizers, which are intermediate
        servers that perform activity on a user’s behalf to preserve the user’s privacy.
Several ways of validating the identity of a suspicious host are as follows:

      ! Contact the IP Address Owner. The Regional Internet Registries, such as the American
        Registry for Internet Numbers (ARIN),112 provide WHOIS query mechanisms on their Web sites
        for identifying the organization or person that owns—is responsible for—a particular IP address.
        This information can be helpful in analyzing some attacks, such as seeing that three different IP
        addresses generating suspicious activity are all registered to the same owner. However, in most
        cases, analysts should not contact the owner directly; instead, they should provide information
        about the owner to the management and legal advisors of the analyst’s organization, who can
        initiate contact with the organization or give the analyst approval to do so if needed. This caution

111
      Connectionless protocols such as ICMP and UDP are the most likely to be spoofed.
112
      ARIN’s web site is at http://www.arin.net/. The other registries are the Asia Pacific Network Information Centre (APNIC),
      located at http://www.apnic.net/; Latin American and Caribbean IP Address Regional Registry (LACNIC), located at
      http://lacnic.net/; and Réseaux IP Européens Network Coordination Centre (RIPE NCC), located at http://www.ripe.net/.


                                                              6-17
