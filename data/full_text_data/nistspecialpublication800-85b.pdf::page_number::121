Special Publication 800-85B                                   PIV Data Model Testing Specification


Precondition          1.      A valid PIV card is inserted into the contact reader.
                      2.      A valid PC/SC connection exists between the test application and the
                              contact reader.
                      3.      The test application is currently connected to the card application
                              which is accessible through card handle.
                      4.      A valid security object is present on the PIV card.
                      5.      A valid CHUID is present on the PIV card.
Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<Security Object
                         (2.16.840.1.101.3.7.2.144.0)>>
                      3. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      4. Extract the contents of the Security Object asymmetric
                         signature (TAG 0xBB)
                      5. Set OID := <<CHUID (2.16.840.1.101.3.7.2.48.0)>>
                      6. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      7. Extract the certificates field contents from the
                         asymmetric signature of the CHUID.
                      8. Using the certificate extracted from the CHUID
                         asymmetric signature block, verify the signature of the
                         security object
Expected              The certificates field of the SignedData for the CHUID contains the
Result(s)             certificate that can be used to verify the digital signature on the security
                      object.




                                                                                                Page 113
