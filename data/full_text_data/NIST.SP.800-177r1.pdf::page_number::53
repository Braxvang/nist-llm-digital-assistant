                                                                                               NIST SP 800-177 REV. 1                                                        TRUSTWORTHY EMAIL




                                                                                               describes the complete set of maintenance operations for DKIM in detail, but the three most
                                                                                               common operations are summarized below.

                                                                                               4.5.8.1 Introduction of a New DKIM Key

                                                                                               When initially deploying DKIM for enterprise email, or a new email service to support an
                                                                                               organization, an administrator should insure that the corresponding public key is available for
                                                                                               validation. �us, the DNS entry with the DKIM public portion should be published in the
                                                                                               sender's domain before the sending MTA begins using the private portion to generate signatures.
                                                                                               �e order should be:

                                                                                                  1.   Generate a DKIM key pair and determine the selector that will be used by the MTA(s).
                                                                                                  2.   Generate and publish the DKIM TXT RR in the sending domain's DNS.
                                                                                                  3.   Ensure that the DKIM TXT RR is returned in queries.
                                                                                                  4.   Conﬁgure the sending MTA(s) to use the private portion.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-177r1




                                                                                                  5.   Begin using the DKIM key pair with email.


                                                                                               4.5.8.2 Changing an Active DKIM Key Pair

                                                                                               DKIM keys may change for various purposes: suspected weakness or compromise, scheduled
                                                                                               policy, change in operator, or because the DKIM key has reached the end of its lifetime.

                                                                                               Changing, or rolling, a DKIM key pair consists of introducing a new DKIM key before its use
                                                                                               and keeping the old, outgoing key in the DNS long enough for clients to obtain it to validate
                                                                                               signatures. �is requires multiple DNS changes with a wait time between them. �e relevant
                                                                                               steps are:

                                                                                                  1. Generate a new DKIM key pair.
                                                                                                  2. Generate a new DKIM TXT RR, with a diﬀerent selector value than the outgoing DKIM
                                                                                                     key and publish it in the enterprise’s DNS. At this point, the DNS will be serving both the
                                                                                                     old and the new DKIM entries.
                                                                                                  3. Reconﬁgure the sending MTA(s) to use the new DKIM key.
                                                                                                  4. Validate the correctness of the public key.
                                                                                                  5. Begin using the new DKIM key for signature generation.
                                                                                                  6. Wait a period of time.
                                                                                                  7. Delete the outgoing DKIM TXT RR.
                                                                                                  8. Delete or archive the retired DKIM key according to enterprise policy.


                                                                                               �e necessary period of time to wait before deleting the outgoing DKIM key’s TXT RR cannot
                                                                                               be a universal constant value due to the nature of DNS and SMTP (i.e., mail queuing). An
                                                                                               enterprise cannot be certain when all of its email has passed DKIM checks using its old key. An
                                                                                               old DKIM key could still be queried for by a receiving MTA for hours (or potentially days) after
                                                                                               the email had been sent. �erefore, the outgoing DKIM key should be kept in the DNS for a
                                                                                               period of time (potentially a week) before ﬁnal deletion.


                                                                                                                                              40
