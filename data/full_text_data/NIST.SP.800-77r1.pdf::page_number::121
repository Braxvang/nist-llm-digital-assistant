                                                                                              NIST SP 800-77 REV. 1                                                             GUIDE TO IPSEC VPNS


                                                                                              management since whenever a branch office is added or modified, all other branches need to
                                                                                              have their IPsec configurations updated. Any network inspection configurations and packet
                                                                                              filters can still be centrally managed but need to be pushed out to the branch locations.

                                                                                              9.2       Protecting Communications for Remote Users

                                                                                              A system administrator of a federal agency has been granting SSH access to individual
                                                                                              developers who sometimes work from home. While usable for remote logins via SSH, reaching
                                                                                              various reporting servers required complicated port forwarding configurations for SSH that were
                                                                                              prone to misconfiguration. It was decided that a proper remote access VPN should be deployed.
                                                                                              It would allow the remote users to directly access the agency’s servers from their browsers once
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              connected to the VPN without needing SSH.

                                                                                              The system administrator also learned that the WiFi at the office was using WPA2 security,
                                                                                              which had seen a number of attacks and was no longer considered secure enough. However, the
                                                                                              WiFi hardware vendor had no plans to support WPA3 for the hardware that they used. The
                                                                                              system administrator wanted to treat the office WiFi as insecure and require the remote access
                                                                                              VPN to connect to the office network, even from the office WiFi network.

                                                                                              9.2.1      Identifying Needs and Evaluating Options

                                                                                              As described below, the federal agency may consider a few options for protecting the
                                                                                              connections to their secure internal network for remote users as well as local WiFi users.

                                                                                                    •    Network Layer Solution: Network Layer VPN. The organization could establish
                                                                                                         network layer VPNs between the developers and the agency’s main office. The VPN
                                                                                                         tunnels would provide access to the agency internal resources without the need to hop
                                                                                                         through a number of servers via SSH. The organization considers each possible network
                                                                                                         layer VPN architecture, as follows:
                                                                                                            o A gateway-to-gateway VPN solution is not suitable because the developers work
                                                                                                              from a number of remote locations, such as co-sharing spaces, hotels, and coffee
                                                                                                              shops. The developers need access from their laptops and phones, not desktops at
                                                                                                              home.
                                                                                                            o The agency already has a flexible FreeBSD-based internet gateway. A remote
                                                                                                              access VPN solution for FreeBSD would allow the agency to use its existing
                                                                                                              gateway, eliminating additional hardware costs. Each remote device would need
                                                                                                              VPN client software installed, but the developers’ laptops and phones already
                                                                                                              support IKEv2 remote access VPNs, so additional labor would be limited to
                                                                                                              supporting the developers in performing the configuration and troubleshooting
                                                                                                              issues. The agency would not even need to pay for additional VPN client licenses.
                                                                                                    •    Transport Layer Solution: Web-Based Access Solution. The agency could provide
                                                                                                         web-based access to resources. This could be accomplished by deploying secured web-
                                                                                                         based services. This solution would meet the requirement to protect the data in transit, but
                                                                                                         it would require the agency to deploy, secure, and maintain a public web server
                                                                                                         connected to the internet. Additionally, all HTTPS services would need to be


                                                                                                                                                 104
