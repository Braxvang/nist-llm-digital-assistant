                                                                                               NIST SP 800-56B REV. 2                              RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                        USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                                  termination of the process due to an error, or (in the absence of errors) prior to or during the
                                                                                                  the completion of step 6.

                                                                                               Proof of Correctness:
                                                                                               Since (by definition), λ(n) = LCM(p – 1, q – 1),
                                                                                                  (p – 1)(q – 1) = LCM(p – 1, q – 1) × GCD(p – 1, q – 1) = λ(n) × GCD(p – 1, q – 1)                 (1)


                                                                                               Lemma 1: GCD(p – 1, q – 1) = GCD(n – 1, λ(n))
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                               Proof of Lemma 1:
                                                                                                Since n – 1 = (p – 1)(q – 1) + (p – 1) + (q – 1) and λ(n) is a divisor of (p – 1)(q – 1), it follows
                                                                                                that GCD(n – 1, λ(n)) = GCD( (p – 1) + (q – 1), λ(n) ).
                                                                                                Any common divisor of p – 1 and q – 1 will also be a divisor of both (p – 1) + (q – 1) and λ(n),
                                                                                                and hence a divisor of GCD( (p – 1) + ( q – 1), λ(n) ). In particular, GCD(p – 1, q – 1) is a divisor
                                                                                                of GCD( (p – 1) + (q – 1), λ(n) ), and so, GCD(p – 1, q – 1) ≤ GCD( (p – 1) + (q – 1), λ(n) ).
                                                                                                To establish that GCD( (p – 1) + (q – 1), λ(n) ) ≤ GCD(p – 1, q – 1) – and hence that the two
                                                                                                GCDs are equal. Let { hi | 1 ≤ i ≤ m } denote the set of primes that are divisors of either p – 1 or
                                                                                                q – 1. Then the factorizations of p – 1, q – 1, and λ(n) have the forms
                                                                                                                              p – 1 = h1x(1) × h2x(2) × … × hmx(m),
                                                                                                                              q – 1 = h1y(1) × h2y(2) × … × hmy(m), and
                                                                                                                               λ(n) = h1z(1) × h2z(2) × … × hmz(m),
                                                                                                where { x(i) | 1 ≤ i ≤ m }, { y(i) | 1 ≤ i ≤ m }, and { z(i) | 1 ≤ i ≤ m } are sets of non-negative
                                                                                                integers satisfying z(i) = max( x(i), y(i) ). If j is a divisor of λ(n), then j has the form
                                                                                                                 j = h1w(1) × h2w(2) × … × hmw(m), with 0 ≤ w(i) ≤ z(i) for 1 ≤ i ≤ m.
                                                                                                Suppose that j is also a divisor of (p – 1) + (q – 1) and that, for a particular value of i, z(i) = x(i).
                                                                                                In this case, hiw(i) will divide both p – 1 and the sum (p – 1) + (q – 1), hence hiw(i) will divide their
                                                                                                difference, q – 1. Similarly, if z(i) = y(i), then hiw(i) will divide both q – 1 and the sum (p – 1) +
                                                                                                (q – 1), hence hiw(i) will divide p – 1 as well. Thus, each prime-power factor of j is a common
                                                                                                divisor of p – 1 and q – 1, and so the same is true of j. This shows that any common divisor j of
                                                                                                λ(n) and the sum (p – 1) + (q – 1) is also a common divisor of p – 1 and q – 1, and hence a divisor
                                                                                                of GCD(p – 1, q – 1).
                                                                                                In particular, GCD( (p – 1) + (q – 1), λ(n) ) is a divisor of GCD(p – 1, q – 1), from which it
                                                                                                follows that GCD( (p – 1) + (q – 1), λ(n) ) ≤ GCD(p – 1, q – 1). Combining this result with the
                                                                                                previously established inequality GCD(p – 1, q – 1) ≤ GCD( (p – 1) + (q – 1), λ(n) ), proves the
                                                                                                lemma’s claim: GCD(p – 1, q – 1) = GCD( (p – 1) + (q – 1), λ(n) ) = GCD(n – 1, λ(n)).



                                                                                                                                                 114
