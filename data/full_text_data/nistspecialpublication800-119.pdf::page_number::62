                                                                       GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


algorithm was specified, but TSIG now requires HMAC-SHA-1 and HMAC-SHA-256 as well (RFC
4635)28. It can be used to authenticate dynamic updates as coming from an approved client, responses as
coming from an approved recursive name server, or zone transfers as coming from an authoritative server.
Its most common use is to protect zone transfers, but protecting dynamic updates is an important
application as well.

TSIG is widely deployed and strongly recommended. Normally, network administrators use an out-of-
band mechanism to configure name servers and resolvers with shared secrets. However, a secure,
automated mechanism for key distribution and key update is a much more desirable solution. It simplifies
operations and enhances security. The TKEY (Transaction Key) protocol (RFC 2930) offers several
options—the Diffie-Hellman method is a practical choice. One limitation with TSIG is that there are no
levels of authority, so any host with the secret key may update any record.

An alternative to TSIG called SIG(0) and described in RFC 2931 uses public keys and digital signatures
instead of message authentication codes based on shared secrets. It is far less widely used than TSIG, but
it may be a practical alternative especially for securing dynamic updates.

DNSSEC provides an entirely different set of cryptographic security mechanisms. Its objective is to
secure the DNS database itself by deploying a hierarchical infrastructure of signed resource records and
its own built-in public key infrastructure. It accomplishes this by defining four new types of resource
record. The RRSIG resource record (RR) contains a digital signature of another resource record. The
DNSKEY (Domain Name System Key) resource record contains a signature verification key; it, in turn, is
signed with an RRSIG resource record. The DS (delegation signer) RR names the signer of a delegation.
If DNSSEC is fully deployed, the DS records can form a chain from any zone to the root. The NSEC
(next secure) resource record specifies the name of the next secured entry in a zone (in lexicographic
order), so that the non-existence of a resource record can be verified cryptographically.

Besides its added complexity, especially for signing large zones, DNSSEC also increases the size of files
and messages substantially. Also, administrators need to protect the secrecy of their private signing keys
carefully. DNSSEC has not been deployed widely yet, but this is gradually changing. Newer releases of
DNS software support DNSSEC, and plans are underway to sign the root and many major top-level
domains. The US Government’s .gov root was signed in Feb. 2009, and OMB mandated29 that the
Government’s second-level domains should be signed by Dec. 2009. OMB Memorandum M-08-23 states:
―The Government’s reliance on the Internet to disseminate and provide access to information has
increased significantly over the years, as have the risks associated with potential unauthorized use,
compromise, and loss of the .gov domain space. Almost every instance of network communication
begins with a request to the Domain Name System (DNS) to resolve a human readable name for a
network resource (e.g., www.usa.gov) into the technical information (e.g., Internet Protocol address)
necessary to actually access the remote resource. DNSSEC provides cryptographic protections to DNS
communication exchanges, thereby removing threats of DNS-based attacks and improving the overall
integrity and authenticity of information processed over the Internet.‖ It is hoped that this will provide
the impetus and experience necessary to get DNSSEC deployed for commonly used services and large
enterprises throughout the Internet.

     3.7.3.3 IPv6-Specific DNS Security Recommendations

During any IPv6 deployment, DNS services may have to support both IPv4 and IPv6. In fact, DNS


28
     RFC 4635, HMAC SHA TSIG Algorithm Identifiers, specifies additional mandatory and optional TSIG algorithms and how
     to handle truncation of the message digest.
29
     OMB Memorandum M-08-23, Securing the Federal Government’s Domain Name System Infrastructure.


                                                         3-40
