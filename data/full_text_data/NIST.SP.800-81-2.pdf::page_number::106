SECURE DOMAIN NAME SYSTEM (DNS) DEPLOYMENT GUIDE



    3. Zone administrator waits the TTL of the zone, then adds the new DNSKEY RRs of algorithm B
       and resigns the SOA RR and DNSKEY RRset.
    4. The Zone administrator sends the algorithm B key material (either DNSKEY RR or DS RR) to
       their parent zone if applicable. If the zone administrator believes they will sign with both
       algorithm A and B for some time, there should be an agreement that the parent zone maintains
       both DS RRs (for both algorithms) during this period.
At this point the zone can be maintained as is. When the zone administrator wishes to retire algorithm A
and solely sign using algorithm B, the following steps should be taken:

    5. The zone administrator asks its parent zone to remove the DS RR generated using the KSK of
       algorithm A.
    6. The zone administrator waits for the TTL of the (now removed) DS. Next, the zone administrator
       removes the KSK and ZSK of algorithm A from the zone, resigns the SOA RR and DNSKEY
       RRset (with both algorithm A and B), but maintains the RRSIGs generated by algorithm A over
       the zone data.
    7. The zone administrator waits the TTL of the zone, and then strips the RRSIGs of algorithm A
       from the zone. Only the SOA RR needs to be resigned at this step, as the rest of the zone data has
       not changed. The zone is now signed solely with algorithm B at this point.
There are two main concerns an administrator needs to keep in mind when transitioning to a new
DNSSEC algorithm. First, during this transition period, response messages from the zone will be larger
due to the presence of multiple RRSIGs for every RRset in the zone. During steps 4-6, the DNSKEY
RRset for the zone would contain four DNSKEY RRs and four RRSIGs (one from each key in the set).
It is not recommended that any other key maintenance operation be done in conjunction with this
transition, such as pre-publishing a new ZSK. If the administrator chooses to operate using two signing
algorithms for an extended period of time, it is recommended to stagger key maintenance operators so
only one key (out of the minimum two KSK’s and two ZSK’s) should be rolled at a given time.

Secondly, when the transition is complete, the zone may become provably unsecure for some validators.
End user validators that do not understand the new algorithm will act as if the zone was provably
insecure, as valiadators will not be able to validate RRSIGs generated by the unknown algorithm.

11.5.1 Special Considerations in Key Rollovers with Multiple Signing Algorithms in Use

There is an issue that arises when deploying a new digital signature algorithm with a signed zone. The
zone administrators now have to maintain two different key life cycles. There can be a problem when the
administrator wishes to pre-publish new ZSK's or KSK's in a zone that is signed by two or more
algorithms.

One common rollover regime is to pre-publish the next ZSK the same time as the current ZSK. So there
would normally be three DNSKEY RRs in a zone's keyset: one active KSK, one active ZSK, and one
pre-published ZSK. So if two algorithms are used, there would be twice that number, or six DNSKEY
RRs in the zone's keyset. Once a year (or once every 1 to 2 years), the KSK is also rolled over so there
will be a period when a pre-published KSK will also appear in the zone for a total of four DNSKEYs in
the zone for each cryptographic suite in use (eight total if two different suites are used).

The solution would be to stagger key rollovers to minimize the number of pre-published keys in the zone
(see Figure 11-X using RSA/SHA-1 and RSA/SHA-256 as the old and new algorithms). One way of
doing this is to extend the active key lifetime of each ZSK to two months, then alternating the rollover of
either cryptographic suite's ZSK each month. At least one key is rolled over every month, but which


                                                   11-8
