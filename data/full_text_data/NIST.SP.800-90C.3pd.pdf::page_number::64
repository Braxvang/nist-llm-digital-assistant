       NIST SP 800-90C 3pd (Third Public Draft)                            Recommendation for RBG Constructions
       September 2022

1763   The strategy used for obtaining full-entropy output from the RBG3(RS) construction requires
1764   obtaining sufficient fresh entropy and subsequently extracting full entropy bits from the output
1765   block in accordance with item 11 of Section 2.6.
1766   For the RBG3(RS)_Generate function:
1767       •   Let n be the requested number of full-entropy bits to be generated by an RBG3(RS)
1768           construction.
1769       •   Let RBG3(RS)_state_handle be a state handle returned from the instantiate function (see
1770           Section 6.3.1.1).
1771   Random bits with full entropy shall be generated as follows:
1772   RBG3(RS)_ Generate:
1773       Input: integer (RBG3(RS)_state_handle, n), string additional_input.
1774       Output: integer status, bitstring returned_bits.
1775       Process:
1776             1. full-entropy_bits =Null.
1777               2. sum = 0.
1778               3. While (sum < n),
1779                   3.1   Obtain generated_bits from the entropy source.
1780                   3.2   If (status ≠ SUCCESS), then return (status, invalid_bitstring).
1781                   3.3   full-entropy_bits = full_entropy_bits || generated_bits.
1782                   3.4   sum = sum + len(generated_bits).
1783               4. Return (SUCCESS, leftmost(full-entropy_bits, n)).
1784   In steps 1 and 2, the bitstring intended to collect the generated bits for returning to the calling
1785   application (i.e., full-entropy_bits) is initialized to the Null bitstring, and the counter for the number
1786   of bits obtained for fulfilling the request is initialized to zero.
1787   Step 3 is iterated until n bits have been generated.
1788       In step 3.1, the DRBG is requested to obtain sufficient entropy so that a bitstring with full
1789       entropy can be extracted from the output block. The form of the request depends on the DRBG
1790       algorithm used in the RBG3(RS) construction and the method for obtaining a full-entropy
1791       bitstring (see Section 2.6, item 11). Note that extracting fewer full-entropy bits from the
1792       DRBG’s output block is permitted.
1793           For a CTR_DRBG (with or without a derivation function), a maximum of 128 bits with
1794           full entropy can be provided from the AES output block for each iteration of the DRBG as
1795           follows:
1796                   (status, generated_bits) = Generate_function(RBG3(RS)_state_handle, 128,
1797                   256, prediction_resistance_request = TRUE, additional_input).



                                                          51
