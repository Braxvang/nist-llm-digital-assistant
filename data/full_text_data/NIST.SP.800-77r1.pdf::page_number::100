                                                                                              NIST SP 800-77 REV. 1                                                              GUIDE TO IPSEC VPNS


                                                                                              solution and resolve issues prior to enterprise-wide deployment. Most of the issues that can occur
                                                                                              during IPsec deployment are the same types of issues that occur during any large IT deployment.
                                                                                              Typical issues that are IPsec-specific are as follows:

                                                                                                    •    Encrypted traffic can negatively affect services such as firewalls, intrusion detection,
                                                                                                         QoS, remote monitoring (RMON) probes, and congestion control protocols.
                                                                                                    •    Unexpected performance issues may arise, either with the IPsec components themselves
                                                                                                         (e.g., gateways) or with intermediate devices, such as routers.
                                                                                                    •    IPsec may not work properly on some production networks because of firewalls, routers,
                                                                                                         and other intermediate, packet-filtering devices that block IPsec traffic. The devices
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                                         might have been misconfigured for IPsec traffic or not configured at all (e.g., if the IPsec
                                                                                                         implementers were not aware of the existence of a device). Misconfigured devices are
                                                                                                         more likely to be an issue with organizations that use a wider variety of network devices
                                                                                                         or have decentralized network device administration and management. In such
                                                                                                         environments, the changes needed to permit IPsec could vary widely among devices.
                                                                                                    •    The environment may change during the deployment. For example, IPsec client software
                                                                                                         may be broken by a new operating system update. This issue can be handled rather easily
                                                                                                         in a managed environment, but it can pose a major problem if users have full control over
                                                                                                         their systems and can select their own client software.

                                                                                              7.5       Manage the Solution

                                                                                              The last phase of the IPsec planning and implementation model lasts the longest. Managing the
                                                                                              solution involves maintaining the IPsec architecture, policies, software, and other components of
                                                                                              the deployed solution. Examples of typical maintenance actions are testing and applying patches
                                                                                              to IPsec software, deploying IPsec to additional remote sites, configuring additional user laptops
                                                                                              as IPsec clients, performing key management duties (e.g., issuing new credentials, revoking
                                                                                              credentials for compromised systems or departing users), and adapting the policies as
                                                                                              requirements change. It is also important to monitor the performance of the IPsec components so
                                                                                              that potential resource issues can be identified and addressed before the components become
                                                                                              overwhelmed. Another important task is to perform testing periodically to verify that the IPsec
                                                                                              controls are functioning as expected. Any new hardware, software, or significant configuration
                                                                                              changes start the process again at the Identify Needs phase. This ensures that the IPsec solution
                                                                                              lifecycle operates effectively and efficiently.

                                                                                              Another aspect of managing the IPsec solution is handling operational issues. For example, a
                                                                                              common problem is poor performance caused by undesired fragmentation or by not utilizing
                                                                                              enough resources (e.g., other available CPUs or sufficient memory) to perform networking tasks.
                                                                                              When troubleshooting IPsec connections, a network sniffer, such as tcpdump or Wireshark, can
                                                                                              be helpful. A sniffer allows the administrator to analyze the communications as they take place
                                                                                              and correct problems. IPsec gateway logs and client logs may also be valuable resources during
                                                                                              troubleshooting; firewall and router logs may validate whether the IPsec traffic is reaching them,
                                                                                              passing through them, or being blocked.




                                                                                                                                                  83
