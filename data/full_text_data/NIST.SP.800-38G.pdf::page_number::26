NIST SP 800-38G                                         METHODS FOR FORMAT-PRESERVING ENCRYPTION


attack. The quantitative security depends on the number of rounds used, the imbalance, and the
adversary's access to plaintext-ciphertext pairs. See [1] for details.

Appendix C: Tweaks

Tweaks have been supported in stand-alone block ciphers, such as Schroeppel’s Hasty Pudding
[15], and the notion was later formalized and investigated by Liskov, Rivest, and Wagner [6].
Tweaks are important for FPE modes, because FPE may be used in settings where the number of
possible character strings is relatively small. In such settings, the tweak should vary with each
instance of the encryption whenever possible.

For example, suppose that in an application for CCNs, the leading six digits and the trailing four
digits need to be available to the application, so that only the remaining six digits in the middle
of the CCNs are encrypted. There are a million different possibilities for these middle-six digits,
so, in a database of 100 million CCNs, about a hundred distinct CCNs would be expected to
share each possible value for these six digits. If the hundred CCNs that shared a given value for
the middle-six digits were encrypted with the same tweak, then their ciphertexts would be the
same. If, however, the other ten digits had been the tweak for the encryption of the middle-six
digits, then the hundred ciphertexts would almost certainly be different.

Similarly, in the encrypted database, about a hundred CCNs would be expected to share each
possible value for the ciphertext, i.e., the middle-six digits. If the hundred CCNs that produce a
given ciphertext had been encrypted with the same tweak, then the corresponding plaintexts
would also be the same. This outcome would be undesirable because the compromise of the
confidentiality of any of the hundred CCNs would reveal the others.

If, however, the leading six digits and the trailing four digits of the CCN had been used as the
tweak, then the corresponding plaintexts would almost certainly be different. Therefore, for
example, learning that the decryption of 111111-770611-1111 is 111111-123456-1111 would
not reveal any information about the decryption of 999999-770611-9999, because the tweak in
that case was different.

In general, if there is information that is available and statically associated with a plaintext, it is
recommended to use that information as a tweak for the plaintext. Ideally, the non-secret tweak
associated with a plaintext is associated only with that plaintext.

Extensive tweaking means that fewer plaintexts are encrypted under any given tweak. This
corresponds, in the security model that is described in [1], to fewer queries to the target instance
of the encryption.

Appendix D: Examples

Examples for FF1 and FF3 are available at the examples page on NIST’s Computer Security
Resource Center website: http://csrc.nist.gov/groups/ST/toolkit/examples.html.




                                                  21
