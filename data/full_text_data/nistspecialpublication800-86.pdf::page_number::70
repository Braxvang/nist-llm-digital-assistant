GUIDE TO INTEGRATING FORENSIC TECHNIQUES INTO INCIDENT RESPONSE



Another potential legal issue is the preservation of original logs. As described in Section 6.4, many
organizations send copies of network traffic logs to centralized devices, as well as use tools that interpret
and analyze network traffic. In cases where logs may be needed as evidence, organizations may wish to
collect copies of the original log files, the centralized log files, and interpreted log data, in case there are
any questions regarding the fidelity of the copying and interpretation processes. Section 6.4 contains
more information on this.

As privacy has become a greater concern to organizations, many have become less willing to share
information with each other, including network forensic data. For example, most ISPs now require a
court order before providing any information related to suspicious network activity that might have
passed through their infrastructure. Although this preserves privacy and reduces the burden on and
liability of the ISPs, it also slows down the investigative process. This is particularly challenging when
an organization is attempting to trace an ongoing network-based attack to its source, especially if the
traffic passes through several ISPs.

6.3.2     Technical Issues

Several technical issues might impede the collection of data about network traffic. This section describes
several of the major issues and provides guidance on what, if anything, can be done to mitigate each.

      ! Data Storage. When there is a large volume of network activity, particularly during adverse
        events such as attacks, logs may record many events in a short time. If insufficient storage is
        available, information about recent activity may be overwritten and lost. Organizations should
        estimate typical and peak log usage, determine how many hours’ or days’ worth of data should be
        retained, and ensure that systems and applications have sufficient storage available to meet those
        goals.104
      ! Encrypted Traffic. When protocols such as IP Security (IPsec), SSH, and Secure Sockets Layer
        (SSL) are used to encrypt network traffic, devices monitoring network traffic along the encrypted
        path can see only the most basic characteristics of the traffic, such as source and destination IP
        addresses. If VPNs or other tunneling techniques are being used, the IP addresses might be for
        the tunnel itself and not the true source and destination of the activity. To collect data about the
        decrypted traffic, a data source must be positioned where it can see the decrypted activity. For
        example, placing an IDS sensor immediately behind a VPN gateway can be effective at
        identifying anomalous activity in the decrypted communications. If communications are
        encrypted all the way to the internal host (e.g., an SSL-encrypted Web session), then devices
        monitoring network traffic cannot see the decrypted packets. Organizations should consider
        establishing policies that specify the appropriate use of traffic encryption technologies, so that
        security controls such as IDS sensors can monitor the contents of traffic that does not need to be
        or should not be encrypted.
      ! Services Running on Unexpected Ports. Applications such as IDSs and protocol analyzers
        often rely on port numbers to identify which service is in use for a given connection.
        Unfortunately, as described in Section 6.1.2, most services can be run on any port number.
        Because traffic involving services running on unexpected port numbers may not be captured,
        monitored, or analyzed properly, use of unauthorized services (e.g., providing Web services on an

104
      Organizations should also provide sufficient data storage to keep logs associated with computer security incidents for a
      substantially longer time than other logs, as needed. For example, General Records Schedule (GRS) 24, Information
      Technology Operations and Management Records, specifies that “computer security incident handling, reporting and
      follow-up records” should be destroyed “3 years after all necessary follow-up actions have been completed.” GRS 24 is
      available from the National Archives and Records Administration at http://www.archives.gov/records-mgmt/ardor/.


                                                               6-10
