                                                                                             NIST SP 800-204                                                                                                     SECURITY STRATEGIES FOR
                                                                                                                                                                                                 MICROSERVICES-BASED APPLICATION SYSTEMS

                                                                                                                                             Table 6: Security Strategies for Microservices

                                                                                               Security Strategy                                                                                            Microservices Core Feature /
                                                                                                                                                    Security Strategy
                                                                                                  Identifier                                                                                                 Architectural Framework
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-204




                                                                                                   MS-SS-1         •   Authentication to microservices APIs that have access to sensitive data should              Authentication
                                                                                                                       not be done simply by using API keys. Access to such APIs should require
                                                                                                                       authentication tokens that have either been digitally signed (e.g., client
                                                                                                                       credentials grant) or that is verified with an authoritative source. Additionally,
                                                                                                                       some services may require either single-use tokens or short-lived tokens
                                                                                                                       (tokens that expire after a short time period) to limit the damage a compromised
                                                                                                                       token can cause.
                                                                                                                   •   Authentication tokens should be handle-based, cryptographically signed, or
                                                                                                                       protected by an HMAC scheme.

                                                                                                                   •   Every API Key that is used in the application should have restrictions specified
                                                                                                                       both for the applications (e.g., mobile app, IP address) and the set of APIs
                                                                                                                       where they can be used.
                                                                                                                   •   The restriction scope for functionality of every API Key should be
                                                                                                                       commensurate with the level of assurance provided during identity proofing,
                                                                                                                       whether it be machine or human driven identity proofing.
                                                                                                                   •   When stateless authentication tokens (e.g., JSON Web Tokens (JWT)) are
                                                                                                                       used by implementing shared libraries associated with a microservice, the
                                                                                                                       following security precautions must be observed: (a) the token expiry times
                                                                                                                       should be as short as possible since they determine the duration of the session
                                                                                                                       and an active session cannot be revoked, and (b) the token secret key must not
                                                                                                                       be a part of the library code, it must be a dynamic variable represented by an
                                                                                                                       environmental variable or specified in an environment data file. The key value
                                                                                                                       should be stored in a data vault solution.
                                                                                                                   •   If standards-based techniques such as OAuth or OpenID connect are
                                                                                                                       implemented, they must be deployed securely [19].




                                                                                                                                                                  34
