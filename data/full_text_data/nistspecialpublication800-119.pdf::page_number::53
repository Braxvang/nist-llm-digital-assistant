                                                                          GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


other nodes to forward packets to non-existent routers and resulting in a denial of service or man-in-the-
middle attack. Additionally, malicious responses to DAD messages can cause denial of service
conditions on a local network segment; DAD can be disabled on specific network or security device
interfaces to prevent Denial of Service (DOS) attacks. Spoofed NS/NA packets can cause redirect or
DOS attacks. Secure Neighbor Discovery (SEND) was developed to help mitigate some of the security
issues caused by rogue devices. SEND is discussed in more detail in Section 5.4.

Router access control lists (ACLs), firewalls, and other security components must be carefully managed
to retain ICMPv6 functionality. Any security measures on a network segment must allow IPv6 nodes to
use ICMPv6 to accomplish Neighbor Discovery, PMTU discovery, and other essential tasks. If an IPv6
default router on a network segment is unable to receive and reply to legitimate RS messages, nodes
sending those messages may experience a denial of service condition. PMTU messages should also be
allowed to traverse network perimeters, to enable proper functioning of IPv6 end-to-end communications.

Some ICMPv6 traffic (e.g., RS and RA) is only useful on the local segment, uses link-local addresses,
and should never be routed. Port-based ACLs can be used to prevent any Ethernet port from receiving
RA messages coming inbound to the network from an end-user computer. ACLs implemented on
common routers can be configured to allow other appropriate ICMPv6 traffic to pass despite the presence
of the default deny all parameter. Network administrators should confirm the inherent ICMPv6
capabilities of their router’s operating system and confirm the configuration parameters that govern the
handling of ICMPv6. There may be places in the network (e.g., a Demilitarized Zone [DMZ]) where it
makes sense to disable Neighbor Discovery and use static neighbor cache entries instead.

Any IP network, whether it is IPv4-only or a dual stack IPv4/IPv6 network, must have the capability to
detect and examine ICMPv6 and IPv6 packets. Without this capability, rogue IPv6 nodes may be
operating on a network that is intended to handle only IPv4. ICMPv6 is fundamental to the operation of
IPv6 networks, and even malicious IPv6 nodes will depend upon ICMPv6 to operate. Network
administrators and managers should evaluate the capability of their existing tools used to monitor ICMP
traffic for similar support for ICMPv6.

Use of IPsec to authenticate the sender and validate the contents of ICMPv6 messages is often not
possible. Additionally, establishing security associations with all possible sources of ICMPv6 messages
is generally not possible. Furthermore, some ICMP messages (e.g., PMTU) may be returned from
intermediate routers, not from the message’s ultimate destination. A further discussion about the use of
IPsec with ICMPv6 is included in Section 5.4.1. Due to this inability to establish security associations,
alternatives should be used to reduce the vulnerability to ICMPv6-based attacks.

It is essential to establish strict filtering policies in site firewalls to limit ICMPv6 messages that can pass
between the site and the Internet. Firewall treatment of ICMPv6 traffic requires finer-grained handling
than may have sufficed for IPv4. Certain IPv6 features, such as Path MTU Discovery, require the
transmission of the associated ICMPv6 messages (e.g., Packet Too Big) for proper functionality. On the
other hand, messages associated with other features, like Network Discovery, should not be transmitted
from outside the local link.

Hence, providing only a blanket "allow all"/"block all" choice for ICMP traffic handling, which may have
been adequate for IPv4, is not appropriate for IPv6. The Federal IPv6 Profile21 requires firewalls to at
least be able to block/allow ICMPv6 traffic selectively based on type and code.

More sophisticated firewalls can do better: by associating connection-specific ICMPv6 types (such as

21
     NIST SP 500-267 , A Profile for IPv6 in the U.S. Government – Version 1.0.


                                                            3-31
