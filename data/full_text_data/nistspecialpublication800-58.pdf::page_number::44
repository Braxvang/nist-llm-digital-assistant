NIST SP 800-58                                             Voice Over IP Security
    _________________________________________________________________________


 5     SIP

        SIP is the IETF specified protocol for initiating a two-way communication
        session. It is considered by some to be simpler than H.323 [18][16], though it is
        now the largest RFC in IETF history. SIP is text based; thereby avoiding the
        ASN.1 associated parsing issues that exist with the H.323 protocol suite, if
        S/MIME is not used as part of SIP inherent security measures.. Also, SIP is an
        application level protocol, that is, it is decoupled from the protocol layer it is
        transported across. It can be carried by TCP, UDP, or SCTP. UDP may be used
        to decrease overhead and increase speed and efficiency, or TCP may be used if
        SSL/TLS is incorporated for security services. Newer implementations may use
        stream control transmission protocol (SCTP), developed in the IETF SIGTRAN
        working group (RFC 2960) specifically to transport signaling protocols. SCTP
        offers increased resistance to DoS attacks through a four-way handshake method,
        the ability to multi-home, and optional bundling of multiple user messages into a
        single SCTP packet. Additional security services can be used with SCTP via RFC
        3436 (TLS over SCTP) or 3554 (SCTP over IP Sec). Unlike H.323, only one port
        is used in SIP (note that H.323 may also be used in a way that uses only one port
        – direct routed calls). The default value for this port is 5060.

 5.1    SIP Architecture

        The architecture of a SIP network is different from the H.323 structure. A SIP
        network is made up of end points, a proxy and/or redirect server, location server,
        and registrar. A diagram is provided in Figure 5. In the SIP model, a user is not
        bound to a specific host (neither is this the case in H.323, gatekeeper provides
        address resolution). The user initially reports their location to a registrar, which
        may be integrated into a proxy or redirect server. This information is in turn
        stored in the external location server.

        Messages from endpoints must be routed through either a proxy or redirect server.
        The proxy server intercepts messages from endpoints or other services, inspects
        their “To:” field, contacts the location server to resolve the username into an
        address and forwards the message along to the appropriate end point or another
        server. Redirect servers perform the same resolution functionality, but the onus is
        placed on the end points to perform the actual transmission. That is, Redirect
        servers obtain the actual address of the destination from the location server and
        return this information to the original sender, which then must send its message
        directly to this resolved address (similar to H.323 direct routed calls with
        gatekeeper).

        The SIP protocol itself is modeled on the three-way handshake method
        implemented in TCP (see Figure 6). We will consider the setup here when a
        proxy server is used to mediate between endpoints. The process is similar with a
        redirect server, but with the extra step of returning the resolved address to the
        source endpoint. During the setup process, communication details are negotiated


                                                                                           39
