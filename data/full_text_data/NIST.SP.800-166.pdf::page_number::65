NIST SP 800-166                                                                               DERIVED PIV APPLICATION AND
                                                                                              DATA MODEL TEST GUIDELINES

                                                      o Read the certificate(s) and key references
                                                        (pairs) from the vendor provided URL file.
                                                        For each key reference value in the range
                                                        (0x95 – keysWithOffCardCerts + 1) through
                                                        0x95, verify that the provided URL file
                                                        includes that key reference, issue a
                                                        challenge for that key reference (follow
                                                        Step 2 from TA-08.03.03.07), and verify
                                                        the response using the public key from the
                                                        corresponding certificate from the
                                                        provided URL file
                                            •    If keysWithOnCardCerts > 0 and
                                                 keyWithOffCardCerts = 0
                                                    o   For each key reference value in the range
                                                        0x82 through (0x82 + keysWithOnCardCerts –
                                                        1), read the certificates from the token
                                                        and issue a challenge for each retired
                                                        private key 12 (follow Step 2 from TA-
                                                        08.03.03.07), and verify the response
                                                        using the public key from the
                                                        corresponding certificate.
                                            •    If keysWithOnCardCerts > 0 and
                                                 keyWithOffCardCerts > 0
                                                        For each key reference value in the range
                                                        0x82 through (0x82 + keysWithOnCardCerts –
                                                        1) and in the range (0x95 –
                                                        keysWithOffCardCerts + 1) through 0x95,
                                                        verify that the provided URL file includes
                                                        that key reference, issue a challenge for
                                                        that key reference (follow Step 2 from TA-
                                                        08.03.03.07), and verify the response
                                                        using the public key from the
                                                        corresponding certificate from the
                                                        provided URL file.
 Expected Result(s)               1. From Step 1, the command returns the application property template
                                     with the status word '90 00'.
                                  2. From Step 2, the command returns status word '90 00'.
                                  3. From Step 3, the GET DATA commands return the requested data
                                     along with status word '90 00'. Each GENERAL AUTHENTICATE
                                     command:
                                         a. For key transport (as indicated by algorithm reference '07' as
                                            P1 value), the command returns the transported key with
                                            status word '90 00' at the end. Compare the test toolkit
                                            application’s copy of the plaintext key to the one received in
                                            the response from the token.
                                         b. For ECDH, (as indicated by algorithm reference '11' or '14'
                                            as P1 value), the command returns the shared secret Z with
                                            status word '90 00'. Compare the shared secret computed by
                                            the token with the shared secret computed off token.
 Postcondition(s)                 N/A

12
     See Table 7 of [SP800-73], Part 1 for the association of certificate BER-TLV tags to corresponding key reference values.


                                                                58
