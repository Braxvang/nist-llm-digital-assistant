                                NIST SP 800-135, Revision 1



      (SKEYID_e is used as a key derivation key to derive a symmetric encryption key
      to provide confidentiality for the current SAâ€™s messages. More details about this
      function can be found in Appendix B of RFC 2409.)
CKY-I and CKY-R are non-secret values. The technical details of these variables are
provided in RFC 2409. Figure 2 below shows the feedback function that produces the
SKEYID_d, SKEYID_a and SKEYID_e above. This function conforms to the
specification of the key expansion step in SP 800-56C.
                SKEYID
    gxy || CKY-I || CKY-R


                                          i=0                i=1              i=2



                                  HMAC                HMAC             HMAC




                                  SKEYID_d           SKEYID_a        SKEYID_e


                         Figure 2: Key expansion Step in IKEv1


Note that both SKEYID and the Diffie-Hellman shared secret gxy are secret values and
are used as inputs to the HMAC in the key expansion step. Also note that all three
resulting keys (i.e., SKEYID_d, SKEYID_a and SKEYID_e) are pseudorandom keys.
The IKEv1 2 KDFs are approved when the following conditions are satisfied:
      (1) The IKEv1 KDFs are performed in the context of the IKEv1 protocol.
      (2) The PRF is an HMAC-based PRF.
      (3) The HMAC and HASH are NIST-approved algorithms and are used as
          specified in FIPSs 198-1 [FIPS 198-1] and 180-3, respectively.




2
 Note that when the function (randomness extraction step) used to produce the SKEYID is SKEYID =
HMAC (Ni_b || Nr_b, gxy) as described earlier in this section, the IKEv1 KDF is compliant with the
current specification of SP 800-56C.


                                                 9
