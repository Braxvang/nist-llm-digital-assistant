GUIDE TO INTRUSION DETECTION AND PREVENTION SYSTEMS (IDPS)



Network-based IDPSs may be unable to perform full analysis under high loads. Passive IDPS sensors
might drop some packets, which could cause some incidents to go undetected, especially if stateful
protocol analysis methods are in use. For inline IDPS sensors, dropping packets under high loads causes
disruptions in network availability; also, delays in processing packets could cause unacceptably high
latency. To avoid this, organizations using inline IDPS sensors should select ones that can recognize high
load conditions and either pass certain types of network traffic through the sensor without performing full
analysis (i.e., partial or no analysis) or drop low-priority traffic to reduce load. Many vendors attempt to
optimize their sensors to provide better performance under high loads by taking measures such as using
specialized hardware (e.g., high-bandwidth network cards) and recompiling components of their software
to incorporate settings and other customizations made by administrators. Although vendors typically rate
their sensors by maximum bandwidth capability, the actual capacity of any product depends on several
factors, including the following:

 The network, transport, and application layer protocols in use, and the depth of analysis performed for
  each protocol. Vendors often rate their products based on their ability to perform reasonable analysis
  of a “typical” mix of protocols. The level of analysis that an individual organization wants to perform
  and the organization’s mix of protocols may vary significantly from the tested conditions.
 The longevity of connections. For example, a sensor might have less overhead for one long-term
  connection than several consecutive short-term connections.
 The number of simultaneous connections. Sensors usually are limited as to how many connections
  for which they can track state.
IDPS sensors are susceptible to various types of attacks. Attackers can generate unusually large volumes
of traffic, such as distributed denial of service (DDoS) attacks, and anomalous activity (e.g., unusually
fragmented packets) to attempt to exhaust a sensor’s resources or cause it to crash. Another attack
technique, known as blinding, generates network traffic that is likely to trigger many IDPS alerts in a
short period of time; typically, the network traffic is specially crafted to take advantage of typical
configurations of IDPS sensors. In many cases, the blinding traffic is not intended to actually attack any
targets. An attacker runs the “real” attack separately at the same time as the blinding traffic. The
attacker’s goal is that the blinding traffic will either cause the IDPS to fail in some way or generate so
many alerts that the alerts for the real attack will go unnoticed. Many IDPS sensors can recognize the use
of common DDoS and blinding tools and techniques; the sensors can alert administrators to the attack and
then ignore the rest of the activity, reducing the load on the sensors. Organizations should select products
that offer features that make them resistant to failure due to attack.

4.3.4     Prevention Capabilities

Network-based IDPS sensors offer various prevention capabilities, including the following (grouped by
sensor type):

 Passive Only

     –    Ending the Current TCP Session. A passive sensor can attempt to end an existing TCP session
          by sending TCP reset packets to both endpoints; this is sometimes called session sniping. 24 The
          sensor does this to make it appear to each endpoint that the other endpoint is trying to end the
          connection. The goal is for one of the endpoints to terminate the connection before an attack can
          succeed. Unfortunately, in many cases the reset packets are not received in time because the

24
     An inline sensor could potentially use this technique, but it is much weaker than other methods that inline sensors can
     perform, so in practice session sniping is rarely used on inline sensors.


                                                              4-12
