NIST SP 800-166                                                  DERIVED PIV APPLICATION AND
                                                                 DATA MODEL TEST GUIDELINES

 Precondition(s)        •     A token with the Derived PIV Application is inserted into an
                              appropriate token reader.
                        •     Suitable drivers have been loaded between the test system and
                              an instance of the reader.
                        •     A key management certificate is present within the Derived
                              PIV Application.
 Test Scenario          1. Send the SELECT command with
                              • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                        2. Send the GET DATA command with
                              • Data field of the command containing the tag
                                 ('5FC10B') of the X.509 Certificate for Key
                                 Management data object
                        3. Extract subjectPublicKeyInfo->algorithm->algorithm
                           field value.
                        4. Extract the subjectPublicKeyInfo->subjectPublicKey
                           from the certificate.
                        5. Match the key size to Table 3-1 of [SP800-78].
 Expected Result(s)     1. From Step 1, the command returns the application property
                           template with the status word '90 00'.
                        2. From Step 2, the command returns the requested data object
                           along with the status word '90 00'.
                        3. From Step 5, the key size is in accordance with Table 3-1 of
                           [SP800-78].

9.3.3.4 Key Usage Extension

 Test Assertion         TA-09.03.03.04
 Purpose                Verifies the key management certificate asserts the appropriate
                        purposes for the key.
 DTR(s)                 • DTR-07.03.03.05
 Issuer Documentation   None.
 Precondition(s)        • A Token with the Derived PIV Application is inserted into an
                           appropriate token reader.
                        • Suitable drivers have been loaded between the test system and
                           an instance of the reader.
                        • A key management certificate is present within the Derived
                           PIV Application.
 Test Scenario          1. Send the SELECT command with
                              • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                        2. Send the GET DATA command with
                              • Data field of the command containing the tag
                                 ('5FC10B') of the X.509 Certificate for Key
                                 Management data object
                        4. Extract subjectPublicKeyInfo->algorithm->algorithm
                            field value.
                        5. Extract the value of the keyUsage extension from
                            the certificate.




                                           119
