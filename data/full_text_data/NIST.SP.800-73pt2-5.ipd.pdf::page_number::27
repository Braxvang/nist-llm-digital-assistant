      NIST SP 800-73pt2-5 ipd (Initial Public Draft)                                Interfaces for Personal Identity Verification: Part 2
      September 2023                                                                   PIV Card Application Card Command Interface

670   3.2.4. GENERAL AUTHENTICATE Card Command
671   The GENERAL AUTHENTICATE card command performs a cryptographic operation, such as
672   an authentication protocol, using the data provided in the data field of the command and returns
673   the result of the cryptographic operation in the response data field. 12
674   The GENERAL AUTHENTICATE command SHALL be used with the PIV authentication keys
675   ('9A', '9B', '9E') to authenticate the card or a card application to the client application
676   (INTERNAL AUTHENTICATE), to authenticate an entity to the card (EXTERNAL
677   AUTHENTICATE), and to perform a mutual authentication between the card and an entity
678   external to the card (MUTUAL AUTHENTICATE).
679   The GENERAL AUTHENTICATE command SHALL be used with the digital signature key
680   ('9C') to realize the signing functionality on the PIV client application programming interface.
681   Data to be signed is expected to be hashed off-card. Appendix A.4 illustrates the use of the
682   GENERAL AUTHENTICATE command for signature generation.
683   The GENERAL AUTHENTICATE command SHALL be used with the key management key
684   ('9D') and the retired key management keys ('82' â€“ '95') to realize the key establishment schemes
685   specified in SP 800-78 (ECDH and RSA). Appendix A.5 illustrates the use of the GENERAL
686   AUTHENTICATE command for key establishment schemes aided by the PIV Card Application.
687   The GENERAL AUTHENTICATE command SHALL be used with the PIV Secure Messaging
688   key ('04') and cryptographic algorithm identifier '27' or '2E' to establish session keys for secure
689   messaging, as specified in Section 4. If key reference '04' is specified in P2, then algorithm
690   identifiers in P1 other than '27' and '2E' SHALL NOT be permitted, and the PIV Card
691   Application SHALL return the status word '6A 86'.
692   The GENERAL AUTHENTICATE command supports command chaining to permit the
693   uninterrupted transmission of long command data fields to the PIV Card Application. If a card
694   command other than the GENERAL AUTHENTICATE command is received by the PIV Card
695   Application before the termination of a GENERAL AUTHENTICATE chain, the PIV Card
696   Application SHALL roll back to the state it was in immediately prior to the reception of the first
697   command in the interrupted chain. In other words, an interrupted GENERAL AUTHENTICATE
698   chain has no effect on the PIV Card Application.
699   Command Syntax
                                               '00' or '10' indicating command chaining
                     CLA
                                               '0C' or '1C' for secure messaging
                     INS                       '87'
                     P1                        Algorithm reference. See Table 18 and [SP800-78, Table 9]
                     P2                        Key reference. See Table 5, Part 1 for key reference values
                     Lc                        Length of data field
                     Data Field                See Table 7
                     Le                        Absent or '00'




      12
         The GET RESPONSE command is used to return the complete result of the cryptographic operation with keys sizes such as 2048 or 3072 bits
      RSA. The GET RESPONSE command is illustrated in Appendix A.4.1 (Command 3).



                                                                          17
