                                                                                             NIST SP 800-90B                                                                   RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                                       USED FOR RANDOM BIT GENERATION

                                                                                                                                                                                   𝐿𝐿
                                                                                                                                                              𝑒𝑒0 = (1 − 𝑝𝑝) �        �,
                                                                                                                                                                                  10
                                                                                                                                                                               𝐿𝐿
                                                                                                                                                                 𝑒𝑒1 = 𝑝𝑝 �       �,
                                                                                                                                                                              10
                                                                                                 respectively.
                                                                                                 5. For d = 0 to 9
                                                                                                           a. Let 𝑜𝑜0 and 𝑜𝑜1 be the number of zeros and ones in 𝑆𝑆𝑑𝑑 , respectively.
                                                                                                                        (𝑜𝑜0 −𝑒𝑒0 )2       (𝑜𝑜1 −𝑒𝑒1 )2
                                                                                                           b. T = T +                  +                  .
                                                                                                                            𝑒𝑒0                𝑒𝑒1
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                             T is a chi-square random variable with nine degrees of freedom. The test fails if T is larger than
                                                                                             the critical value at 0.001, which is 27.887.

                                                                                             5.2.5     Length of the Longest Repeated Substring Test

                                                                                             This test checks the IID assumption using the length of the longest repeated substring. If this length
                                                                                             is significantly longer than the expected value, then the test invalidates the IID assumption. The
                                                                                             test can be applied to binary and non-binary inputs.

                                                                                             Given the input S = (s1, …, sL), where si ϵ A = {x1, …, xk},
                                                                                                                                                                                                number of 𝑥𝑥𝑖𝑖 in 𝑆𝑆
                                                                                                1. Find the proportion 𝑝𝑝𝑖𝑖 of each possible input value xi in S, i.e., 𝑝𝑝𝑖𝑖 =                           𝐿𝐿
                                                                                                                                                                                                                       .

                                                                                                2. Calculate the collision probability as pcol = ∑𝑘𝑘𝑖𝑖=1 𝑝𝑝𝑖𝑖2 .
                                                                                                3. Find the length of the longest repeated substring W, i.e., find the largest W such that, for at
                                                                                                   least one i ≠ j, si = sj, si+1 = sj+1, ... , si+W-1 = sj+W-1.
                                                                                                4. The number of overlapping subsequences of length W in S is L–W+1, and the number of pairs
                                                                                                                                     𝐿𝐿 − 𝑊𝑊 + 1
                                                                                                     of overlapping subsequences is �            �.
                                                                                                                                          2
                                                                                                5. Let X be a binomially distributed random variable with parameters N=�𝐿𝐿 − 𝑊𝑊 + 1� and a
                                                                                                                                                                                        2
                                                                                                     probability of success pcolW. Calculate the probability that X is greater than or equal to 1, i.e.,
                                                                                                     Pr (X ≥ 1) = 1− Pr (X = 0) = 1− (1− pcolW)N.
                                                                                             The test fails if Pr (X ≥ 1) is less than 0.001.




                                                                                                                                                                  39
