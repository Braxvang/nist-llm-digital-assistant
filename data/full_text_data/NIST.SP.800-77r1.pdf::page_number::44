                                                                                              NIST SP 800-77 REV. 1                                                                                GUIDE TO IPSEC VPNS


                                                                                              3.3     IKE Authentication Models

                                                                                              Different deployments require different authentication methods. Usually, hosts authenticate each
                                                                                              other using the same authentication method. But sometimes a client host authenticates a server
                                                                                              host differently from the method used by the server to authenticate the client.

                                                                                              3.3.1     Certificate-Based Authentication

                                                                                              This method, also called machine certificate authentication, is most often used for deploying
                                                                                              IPsec within an organization when it involves a large number of devices. The organization can
                                                                                              set up a new internal X.509 certificate deployment or reuse an existing X.509 certificate-based
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              solution. Setting up a new host does not require any changes to the already deployed hosts.
                                                                                              Certificate revocation lists (CRLs) and the Online Certificate Status Protocol (OCSP) can be
                                                                                              used to revoke a particular certificate. Remote access VPN clients are often authenticated using
                                                                                              X.509 certificates. Cloud (mesh) encryption also often uses certificate-based authentication.

                                                                                              A host that requires the other end to authenticate itself using certificates can send a CERTREQ
                                                                                              payload (during IKE_SA_INIT or IKE_AUTH). Both parties then exchange their certificates in
                                                                                              CERT payloads during the IKE_AUTH exchange. Intermediate CAs can also be sent as part of
                                                                                              the CERT payload. 28

                                                                                              Since certificate-based authentication requires certificates generated by CAs that may not be
                                                                                              trusted by the organizations verifying the certificates, this method is not always a usable solution
                                                                                              to connect two different organizations since one (or both) of the organizations would need to
                                                                                              trust an external CA party not under their own control. For U.S. Government organizations, the
                                                                                              Common Policy CA can be used as a mutually trusted CA.

                                                                                              3.3.2     Extensible Authentication Protocol (EAP)

                                                                                              EAP is a framework for adding arbitrary authentication methods in a standardized way to any
                                                                                              protocol. It uses a model of a client, a server, and a backend authentication, authorization, and
                                                                                              accounting (AAA) server. The client initiates an EAP authentication to the server. The server
                                                                                              forwards these messages to and from the AAA server. The AAA server will let the server and
                                                                                              client know that the client and server have successfully authenticated each other. AAA protocols
                                                                                              with EAP support include Remote Authentication Dial-In User Service (RADIUS) [39] and
                                                                                              Diameter [40].

                                                                                              The most common EAP method used with IKEv2 is EAP-TLS, although EAP-Microsoft
                                                                                              Challenge Handshake Authentication Protocol version 2 (EAP-MSCHAPv2) is used as well.
                                                                                              EAP-TLS uses certificates issued to users instead of certificates issued to hosts. Some devices,
                                                                                              such as mobile phones, often do not make such a distinction. However, laptops generally have
                                                                                              non-privileged users that cannot modify the operating systemâ€™s machine certificate store. These


                                                                                              28    Some implementations have (wrongly) implemented sending multiple intermediate CA chains using Public Key
                                                                                                    Cryptography Standard #7 (PKCS#7). This has caused some interoperability issues. It is best to avoid intermediate CAs
                                                                                                    when possible.



                                                                                                                                                             27
