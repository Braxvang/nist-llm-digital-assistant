NIST SP 800-166                                                   DERIVED PIV APPLICATION AND
                                                                  DATA MODEL TEST GUIDELINES

                             •   Data field of the command will contain an
                                 arbitrary password value that contains 0x5B in
                                 the first byte position, all other non-padded
                                 bytes contain values limited to either 0x30–0x39
                                 or 0x41-0x5A or 0x61-0x7A concatenated without
                                 delimitation with a properly formatted new
                                 password value where all non-padded bytes contain
                                 values limited to either 0x30–0x39 or 0x41-0x5A
                                 or 0x61-0x7A. Both passwords should be padded
                                 with 'FF'(as needed) to complete the total length
                                 of each value to 8 bytes. (repeat test five times
                                 with byte positions 2, 3, 4, 5, and 6 containing
                                 the 0x5B byte, respectively)

                                 Note: In Step 2 it may be necessary to send the
                                 VERIFY command with a correct Derived PIV
                                 Application Password in order to prevent the
                                 retry counter from decrementing to zero.
 Expected Result(s)   1. From Step 1, the command returns the application property template
                         with the status word '90 00'.
                      2. From Step 2, the command returns either status word: 1) '6A 80'
                         (incorrect parameter in command data field) or 2) '63 CX' and the
                         retry counter is decremented by 1 (where 'X' is the number of tries
                         remaining).
 Postcondition(s)     Current password is unchanged.

8.3.5.6 Change Reference Data with a Correctly Formatted but Incorrect Current
        Password or with a Correctly Formatted but Incorrect PUK

 Test Assertion       TA-08.03.05.06
 Purpose              Verifies that the Derived PIV Application responds appropriately when
                      the CHANGE REFERENCE DATA command is sent repeatedly with a
                      correctly formatted, but incorrect, Derived PIV Application Password or
                      with a correctly formatted, but incorrect, PUK value.
 DTR(s)               •  DTR-06.02.02.09
                      •  DTR-06.03.01.01
                      •  DTR-06.03.06.04
                      •  DTR-06.03.06.05
                      •  DTR-06.03.06.07
                      • DTR-06.03.06.09
 Vendor               None.
 Documentation
 Precondition(s)      •   A token with the Derived PIV Application is inserted into an
                          appropriate token reader.
                      •   Suitable drivers have been loaded between the test system and an
                          instance of the reader.
                      •   The Derived PIV Application Password and the PUK are recorded.


                                            72
