      NIST SP 800-73pt3-5 ipd (Initial Public Draft)                                Interfaces for Personal Identity Verification: Part 3
      September 2023                                                                                                    PIV Client API

438   Parameters: cardHandle                                          Opaque identifier of the card to be acted upon as
439                                                                   returned by pivConnect. The cardHandle remains
440                                                                   valid after execution of this function.
441   Return Codes:                   PIV_OK
442                                   PIV_INVALID_CARD_HANDLE
443                                   PIV_CARD_READER_ERROR


444             Entry Points for Cryptographic Operations

445   3.3.1. pivCrypt
446   Purpose:             Perform a cryptographic operation, 3 such as encryption or signing on a sequence
447                        of bytes. SP 800-73-5 Part1, Appendix C describes recommended procedures for
448                        PIV algorithm identifier discovery.
449   Prototype:           status_word pivCrypt(
450                                   IN handle                                  cardHandle,
451                                   IN byte                                    algorithmIdentifier,
452                                   IN byte                                    keyReference,
453                                   IN sequence of byte                        algorithmInput,
454                                   IN LONG                                    inputLength,
455                                   OUT sequence of byte                       algorithmOutput,
456                                   INOUT LONG                                 outputLength
457                                   );

458   Parameters: cardHandle                                          Opaque identifier of the card to be acted upon as
459                                                                   returned by pivConnect
460                        algorithmIdentifier                        Identifier of the cryptographic algorithm to be used
461                                                                   for the cryptographic operation [SP800-78, Tables 9
462                                                                   and 10 ]
463                        keyReference                               Identifier of the on-card key to be used for the
464                                                                   cryptographic operation. See [SP800-78, Table 8]
465                                                                   and SP 800-73-5 Part1, Table 5.
466                        algorithmInput                             Sequence of bytes used as the input to the
467                                                                   cryptographic operation. The algorithmInput for
468                                                                   RSA algorithms SHALL be restricted to the range 0
469                                                                   to n-1, where n is the RSA modulus.
470                        inputLength                                Length of the algorithm input


      3
        The pivCrypt function does not perform any cryptographic operations itself. It provides the interface to the GENERAL AUTHENTICATE
      command to perform cryptographic operations on-card. All cryptographic operations are performed outside of the PIV Middleware except for SM
      on the client side.


                                                                       11
