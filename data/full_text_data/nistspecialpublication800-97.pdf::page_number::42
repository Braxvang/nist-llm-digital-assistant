ESTABLISHING WIRELESS ROBUST SECURITY NETWORKS: A GUIDE TO IEEE 802.11I




                                                     Pre-shared Key (PSK)
                                              Key Distribution is performed out-of-
                                            band – A secure channel must be used to
                                                 guarantee security in an RSNA




                                                                     Wired Ethernet LAN


                                                          AP
                               STA
                                                                                           AS


                                Figure 4-5. Out-of-Band Key Distribution for the PSK

As shown in Figure 4-4, the root key—either the PSK or the AAAK—is used to formulate the Pairwise
Master Key (PMK). The PMK is a key-generating key used for the derivation of the Pairwise Transient
Key (PTK), along with the MAC address of the STA and AP and nonces that each creates for the key
generation process. Using the STA and AP addresses in the generation of the PTK provides protection
against session hijacking and impersonation; using nonces provides additional random keying material.
The PTK is composed of the following three keys:

      EAP Over LAN (EAPOL) Key Confirmation Key (EAPOL-KCK), which is used to support
       the integrity and data origin authenticity of STA-to-AP control frames during operational setup of
       an RSN. 34 It also performs an access control function: proof-of-possession of the PMK. An
       entity that possesses the PMK is authorized to use the link.
      EAPOL Key Encryption Key (EAPOL-KEK), which is used to protect the confidentiality of
       keys and other data during some RSNA procedures.
      Temporal Key (TK), which is used to provide the actual protection for user traffic.
Figure 4-4 shows the bit length of each of these keys. The PSK is 256 bits long, and the AAAK is 256
bits long or greater. The TK has two different sizes depending on the data confidentiality and integrity
protocol that is used (128 bits for CCMP, 256 bits for TKIP). This is due to differences in cryptographic
approaches. Also shown beneath each key is the condition under which the key is generated. For
instance, the PMK is created for each session following the EAP authentication process.

Figure 4-4 also shows the Pseudo-Random Function (PRF), which is an algorithm that is used to generate
the PTK from the PMK. It uses HMAC-SHA-1 35 with specific inputs: the PMK, two 256-bit nonces, 36
and the addresses of the STA and AP. The PRF may be used in IEEE 802.11 for the generation of keys
of bit lengths 128, 192, 256, 384 and 512.




34
     EAPOL is discussed in Section 5.
35
     HMAC is defined in RFC 2104, HMAC: Keyed-Hashing for Message Authentication (http://www.ietf.org/rfc/rfc2104.txt).
     SHA-1 is defined by FIPS PUB 180-2 (http://csrc.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf).
36
     A nonce is a non-repeating or random number that is used by a message exchange protocol for detecting replay attacks.


                                                               4-6
