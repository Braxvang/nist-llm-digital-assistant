NIST SP 800-166                                                   DERIVED PIV APPLICATION AND
                                                                  DATA MODEL TEST GUIDELINES

                            with X indicating the number of further allowed retries) (verify
                            the error code supplied matches what is described in vendor
                            documentation).
                         5. From Step 5, the command returns status word '6A 80' (incorrect
                            parameter in command data field) or '63 CX' (verification failed,
                            with X indicating the number of further allowed retries) (verify
                            the error code supplied matches what is described in vendor
                            documentation).
 Postcondition(s)        N/A

8.3.4.4 Verify with an Incorrect Format for the Current Password

 Test Assertion          TA-08.03.04.05
 Purpose                 Verifies that the Derived PIV Application responds appropriately to
                         the VERIFY command when an incorrectly formatted password is
                         passed.
 DTR(s)                  • DTR-06.02.02.09
                         • DTR-06.02.02.13
                         • DTR-06.02.02.14
                         • DTR-06.02.02.15
                         • DTR-06.03.01.01
 Vendor Documentation    The vendor to provide in its documentation the status word returned
                         by the Derived PIV Application when the password format
                         requirements are not met.
 Precondition(s)         • A token with the Derived PIV Application is inserted into an
                             appropriate token reader.
                         • Suitable drivers have been loaded between the test system and
                             an instance of the reader.
                         • The Derived PIV Application Password is recorded.
                         • The Derived PIV Application Password’s retry counter is greater
                             than 1.
 Test Scenario           1. Send the SELECT command with
                               • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                         2. Send the VERIFY command with
                               • P2, key reference value, is set to '80'
                               • Data field of the command will contain an
                                  arbitrary Derived PIV Application Password
                                  where the first byte is 0x5B and all other
                                  non-padded bytes contain values limited to
                                  either 0x30–0x39 or 0x41-0x5A or 0x61-0x7A,
                                  padded with 'FF' to complete the total length
                                  of the value to 8 bytes
                         3. Repeat Step 2 five times with byte positions 2, 3,
                            4, 5, and 6 containing the 0x5B byte, respectively.

                         Note: It may be necessary to send the VERIFY command
                         with a correct Derived PIV Application Password in



                                           64
