GUIDE TO INTRUSION DETECTION AND PREVENTION SYSTEMS (IDPS)



completed, testers should ensure that any hardware on loan from IDPS vendors has its writable media
sanitized appropriately to remove the organization’s data. 57

9.6.2.1 Network-Based

Valuable insights into network-based IDPS security capabilities (especially detection accuracy and
tuning), performance with the organization’s network traffic, and the operation and maintenance of the
IDPS can be gained by performing real-world testing of the IDPS. However, it is generally prudent to
keep the IDPS somewhat separate from the production environment during this testing so that the IDPS
does not adversely affect it (e.g., increase latency) and so that any vulnerabilities in the IDPS cannot be
exploited by attackers. An IDS load balancer is ideal for giving multiple sensors identical copies of the
network traffic simultaneously, allowing for side-by-side comparisons of the products, while isolating the
sensors and preventing them from inadvertently disrupting production (traffic passes through a load
balancer in only one direction). Depending on the network architecture, it may be possible to test sensors
in inline deployments by duplicating traffic at the network locations where each of an inline sensor’s
network interfaces would be and feeding that traffic to the inline sensors’ interfaces. Otherwise, most
inline sensors can be placed into a passive mode and tested as passive; the benefit of testing them with
production traffic in inline mode is to study their performance.

Lab testing of network-based IDPSs is most beneficial for evaluating the following:

 The prevention capabilities of products. Testers can set up test systems (targets and attacking
  systems), generate attacks, and monitor the effectiveness of each IDPS’s prevention actions.
 The performance of inline sensor deployments. If this cannot be done as part of real-world testing,
  testers could use network traffic generation tools or replay previously recorded traffic to generate
  activity to pass through the sensor.
 Design and implementation-related characteristics. Product reliability could be tested by
  deploying multiple sensors or management servers, configuring them for failover conditions,
  generating traffic for them to process, and then intentionally causing a failure of one component and
  monitoring the resulting product behavior. Interoperability could be tested by configuring test
  systems representing the products with which the IDPS must interoperate, and then generating
  activity that should cause the products to work together. The security of the IDPS itself can also be
  tested through vulnerability scanning, penetration testing, and other methods.
9.6.2.2 Wireless

The methods to be used for testing wireless IDPSs should be selected primarily by the format of the
wireless IDPS sensors to be tested:

 Mobile sensors, fixed sensors, and sensors bundled with APs. 58 Testing of security capabilities,
  performance, and some facets of operation and maintenance can typically be performed by using the
  sensors in production environments, with the caveat that prevention capabilities should be disabled.
  Prevention capabilities could be evaluated in an isolated test environment that is out of range of all
  other wireless local area networks. This test environment would contain test access points and test
  wireless clients using the access points; testers might need to set up test systems that the wireless

57
     For more information on media sanitization, see NIST SP 800-88, Guidelines for Media Sanitization, which is available at
     http://csrc.nist.gov/publications/nistpubs/.
58
     For sensors bundled with APs, these test instructions assume that a non-production AP is used for the testing. Deploying
     sensor software onto production APs for testing purposes is not recommended because it could disrupt the production
     environment.


                                                             9-16
