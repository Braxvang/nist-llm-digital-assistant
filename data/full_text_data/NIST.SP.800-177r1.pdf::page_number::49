                                                                                               NIST SP 800-177 REV. 1                                                                                   TRUSTWORTHY EMAIL




                                                                                               4.5.2     DKIM on the Sender Side

                                                                                               Unlike SPF, DKIM requires specialized functionality on the sender MTA to generate the
                                                                                               signatures. �erefore, the ﬁrst step in deploying DKIM is to ensure that the organization has an
                                                                                               MTA that can support the generation of DKIM signatures. DKIM support is currently available
                                                                                               in some implementations or can be added using open source ﬁlters 10. Administrators should
                                                                                               remember that since DKIM involves digital signatures, signing MTAs should also have
                                                                                               appropriate cryptographic tools to create and store keys and perform cryptographic operations.

                                                                                               4.5.3     Generation and Distribution of the DKIM Key Pair

                                                                                               �e next step in deploying DKIM, after ensuring that the sending MTA is DKIM-aware, is to
                                                                                               generate a signing key pair.

                                                                                               Cryptographic keys should be generated in accordance with NIST SP 800-57,
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-177r1




                                                                                               “Recommendations for Key Management” [SP800-57pt1] and NIST SP 800-133,
                                                                                               “Recommendations for Cryptographic Key Generation.” [SP800-133] Although there exist web-
                                                                                               based systems for generating DKIM public/private key pairs and automatically producing the
                                                                                               corresponding DNS entries, such systems should not be used for federal information systems
                                                                                               because they may compromise the organization’s private key.

                                                                                               Currently the DKIM standard speciﬁes that messages must be signed with one of two digital
                                                                                               signature algorithms: RSA/SHA-256 and the Edwards-curve Digital Signature Algorithm
                                                                                               Curve25519 (ed25519) [RFC8463]. Of these, only RSA/SHA-256 is approved for use by
                                                                                               government agencies with DKIM, as the hash algorithm SHA-1 is no longer approved for use in
                                                                                               conjunction with digital signatures (see Table 4-3).
                                                                                                                              Table 4-3: Recommended Cryptographic Key Parameters

                                                                                                         DKIM Specified               Approved for                 Recommended                    Recommended
                                                                                                           Algorithm                Government Use?                   Length                         Lifetime
                                                                                                       RSA/SHA-256                           YES                        2048 bits                      1-2 years

                                                                                                       ed25519                               NO 11                       256 bits                         N/A

                                                                                               Once the key pair is generated, the administrator should determine a selector name to use with
                                                                                               the key. A DKIM selector name is a unique identiﬁer for the key that is used to distinguish one
                                                                                               DKIM key from any other potential keys used by the same sending domain, allowing diﬀerent
                                                                                               MTAs to be conﬁgured with diﬀerent signing keys. �is selector name is used by receiving
                                                                                               MTAs to query the validating key.




                                                                                               10 Mail filters are sometimes called “milters.” A milter is a process subordinate to a MTA that can be deployed to perform special

                                                                                                 message header or body processing.
                                                                                               11 As of the time of writing, ed25519 is being considered for approval, but has not been approved for use for federal systems.




                                                                                                                                                              36
