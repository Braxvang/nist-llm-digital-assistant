Special Publication 800-85B                                 PIV Data Model Testing Specification


Precondition(s)           1.   A valid PIV card is inserted into the contact reader.
                          2.   A valid PC/SC connection exists between the test application and the
                               contact reader.
                          3.   The test application is currently connected to the card application
                               which is accessible through card handle.
                          4.   A valid CCC is present on the PIV card.
Test Scenario             1. Set cardHandle := <<valid card handle>>.
                          2. Set OID := <<CCC (2.16.840.1.101.3.7.1.219.0)>>.
                          3. Call pivGetData w/
                             • (IN) cardHandle
                               • (IN) OID
                               • (OUT) data
                          4. Read and parse the byte array in accordance with BER-TLV
                             format.
Expected Result(s)        1. The size of the byte array does not exceed 297 bytes.
                          2. All mandatory tags in CCC table are present.
                          3. The values of the available tags conform with the vendor
                             provided data.


8.2   “Card Holder Unique Identifier” Data Object
Purpose                   Confirms that the CHUID of the PIV card Application conforms to
                          the PIV data model requirements as per Appendix A of SP80073.
Reference(s)              1. SP80073, Appendix A
                          2. TE04.01.01.01
                          3. TE04.03.01.01
Precondition(s)           1. A valid PIV card is inserted into the contact reader.
                          2. A valid PC/SC connection exists between the test application and the
                              contact reader.
                          3. The test application is currently connected to the card application
                              which is accessible through card handle.
                          4. A valid CHUID is present on the PIV card.
Test Scenario             1. Set cardHandle := <<valid card handle>>
                          2. Set OID := <<CHUID (2.16.840.1.101.3.7.2.48.0)>>
                          3. Call pivGetData w/
                              • (IN) cardHandle
                               • (IN) OID
                               • (OUT) data
                          4. Read and parse the byte array in accordance with BER-TLV
                             format.
Expected Result(s)        1.   The size of the byte array does not exceed 3395 bytes.
                          2.   All mandatory tags in CHIID table are present.
                          3.   Expiration date is encoded as YYYYMMDD.
                          4.   Expriation date is within the next five years.



                                                                                                   Page 41
