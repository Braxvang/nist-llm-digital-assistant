NIST SP 800-85A-4                                            PIV CARD APPLICATION & MIDDLEWARE
                                                                      INTERFACE TEST GUIDELINES

 Expected Result(s)      All calls return with status_word :=
                         PIV_SECURITY_STATUS_NOT_SATISFIED and does not initialize data
                         reference.
 Postcondition(s)        The client application remains in the state it had before the call.


B.8           pivGenerateKeyPair

B.8.1           Valid Test Assertions

B.8.1.1          Generate an Asymmetric Key Pair
 Purpose               Ensure the PIV Middleware initiates generation of an asymmetric
                       key pair on the PIV Card.
 Target                  pivGenerateKeyPair
 Reference(s)            1. SP 800-73-4 Part 3, Section 3.4.2
                         2. AS04.01, AS04.02A-R4, AS04.10
 Precondition(s)         1. The client application owns a connection to the PIV Card
                            Application accessible through cardHandle.
                         2. The client application has successfully selected the PIV Card
                            Application.
                         3. Mutual authentication with the client application using the PIV
                            Card Application Administration key has taken place.
 Test Steps              1. Set cardHandle := <<valid cardHandle>>
                         2. Set keyReference := <<'9A'>>
                         3. Set cryptographicMechanism:= <<'07' or '11'>>
                         4. Create publicKey reference
                         5. Call pivGenerateKeyPair with
                            • (IN) cardHandle
                            • (IN) keyReference
                            • (IN) cryptographicMechanism
                            • (OUT) publicKey
                            • (INOUT) KeyLength
                         6. Repeat steps 1 through 5 for key references '04', '9C',
                            '9D', and '9E', using an appropriate cryptographic
                            mechanism identifier from Table 5 in SP 800-73-4 Part 1
                            for the key reference.
 Expected Result(s)      Each call returns with status_word of PIV_OK and a reference to the
                         publicKey.
 Postcondition(s)        A public key / private key pair is created on the card and the private
                         key is accessible to the client application with the applicable
                         reference.


B.8.2           Test Assertions for Error Conditions

B.8.2.1          Identify and Handle an Invalid cardHandle



                                         B-21
