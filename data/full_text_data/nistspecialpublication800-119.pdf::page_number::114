                                                               GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


     functions (SHA-224, SHA-256, SHA-384 and SHA-512) instead of SHA-1 after 2010 for those
     applications. The use of SHA-1 for key derivation and random number generation is permitted
     beyond 2010.
     Since the SHA-1 vulnerabilities do not affect HMAC-SHA-1, its continued use is permissible. IPsec
     and IKE use HMAC-SHA-1, and not SHA-1, for integrity protection.
 Use combined encryption-integrity modes for high-speed implementations
 Provide elliptic curve alternatives to public key cryptography based on modular arithmetic in IKEv1
  and IKEv2.
Of these, the following are likely to be the most important:

 RFC 4309 specifies the first combined mode encryption and integrity algorithm based on AES in
  Counter Mode. More recently, a more efficient construction called Galois Counter Mode has become
  an alternative choice. RFC 4543 describes its use for integrity protection in ESP and AH; RFC 4106
  defines its use within ESP as a combined mode algorithm.
 RFC 4868 (HMAC-SHA-256), which is likely to be included in mainstream implementations
 RFCs 5903, 4754, and 4869, which are of interest to those who want to use IKEv2 with elliptic curve
  public key cryptography.
Government agencies are required to use only those cryptographic algorithms that are also defined in a
FIPS (Federal Information Processing Standard). Most of the mainstream algorithms defined for use
within IPsec and IKE satisfy this requirement. The exception is AES-XCBC (both the MAC [Message
Authentication Code] and the PRF [Pseudo-Random Function]), which is therefore not approved for
government use.


IKE and key management

 RFC 4430 Kerberized Internet Negotiation of Keys (KINK)
 RFC 4718 IKEv2 Clarifications and Implementation Guidelines
 RFC 3706 A Traffic-Based Method of Detecting Dead Internet Key Exchange (IKE) Peers
 RFC 3947 Negotiation of NAT-Traversal in the IKE
 RFC 4304 Extended Sequence Number (ESN) Addendum to IPsec Domain of
           Interpretation (DOI) for Internet Security Association and Key Management
           Protocol (ISAKMP)
RFCs 3706, 3947 and 4304 define additional features for IKEv1; for IKEv2, these features are included in
RFC 4306 and its replacement, RFC 5996.

Applications (routing, mobility, IPv6 over IPv4 tunneling)

 RFC 4552 Authentication/Confidentiality for OSPFv3
 RFC 4555 IKEv2 Mobility and Multihoming Protocol (MOBIKE)



                                                   5-12
