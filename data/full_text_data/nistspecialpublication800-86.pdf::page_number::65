                                                        GUIDE TO INTEGRATING FORENSIC TECHNIQUES INTO INCIDENT RESPONSE



6.2      Network Traffic Data Sources

Organizations typically have several types of information sources concerning network traffic that might
be useful for network forensics. These sources collectively capture important data from all four TCP/IP
layers. The following subsections highlight the major categories of network traffic data sources—
firewalls and routers, packet sniffers and protocol analyzers, IDSs, remote access, security event
management software, and network forensic analysis tools—as well as several other types of data sources.
The subsections explain the purpose of each source described and the type of data that is typically
collected and can potentially be collected.

6.2.1      Firewalls and Routers

Network-based devices such as firewalls and routers, and host-based devices such as personal firewalls,
examine network traffic and permit or deny it based on a set of rules. Firewalls and routers are usually
configured to log basic information for most or all denied connection attempts and connectionless
packets; some log every packet.91 Information logged typically includes the date and time the packet was
processed, the source and destination IP addresses, the transport layer protocol (e.g., TCP, UDP, ICMP),
and basic protocol information (e.g., TCP or UDP port numbers, ICMP type and code). The content of
packets is usually not recorded.

Network-based firewalls and routers that perform network address translation (NAT) may contain
additional valuable data regarding network traffic. NAT is the process of mapping addresses on one
network to addresses on another network; this is most often accomplished by mapping private addresses92
from an internal network to one or more public addresses on a network that is connected to the Internet.
NAT differentiates multiple internal addresses that are mapped to a single external address by assigning a
different source port number to the external address for each internal address. The NAT device typically
records each NAT address and port mapping.

Some firewalls also act as proxies. A proxy receives a request from a client, and then sends a request on
the client’s behalf to the desired destination. When a proxy is used, each successful connection attempt
actually results in the creation of two separate connections: one between the client and the proxy server,
and another between the proxy server and the true destination. Proxy servers may log basic information
about each connection. Many proxies are application-specific, and some actually perform some analysis
and validation of application protocols, such as HTTP. The proxy may reject client requests that appear
to be invalid and log information regarding these requests.93

In addition to providing NAT and proxying services, firewalls and routers may perform such other
functions as intrusion detection and VPN. The intrusion detection and VPN functions are discussed in
more detail in Sections 6.2.3 and 6.2.4, respectively.

6.2.2      Packet Sniffers and Protocol Analyzers

Packet sniffers are designed to monitor network traffic on wired or wireless networks and capture packets.
Normally, a NIC accepts only the incoming packets that are specifically intended for it. But when a NIC
91
      Although logging all packets records more information about recent network activity than does logging information for
      connections and connection attempts, space limitations might permit packets to be kept for a short time only. In addition,
      the overhead required to record all packets might cause the system’s performance to degrade.
92
      The proper name for private addresses is RFC 1918 addresses. RFC 1918, Address Allocation for Private Internets, is
      available at http://www.ietf.org/rfc/rfc1918.txt.
93
      Some organizations configure their networks and network security so that all network traffic passing through the network
      perimeter for common applications is proxied, preventing individual users from bypassing the proxies. In such an
      environment, the proxy server logs can be particularly valuable for network forensics.


                                                                6-5
