                                 GUIDE TO MALWARE INCIDENT PREVENTION AND HANDLING FOR DESKTOPS AND LAPTOPS


and what data sources might record the information. For example, a host’s current IP address is typically
needed for remote actions; of course, a host’s physical location is needed for local actions. One piece of
information can often be used to determine others, such as mapping an IP address to a media access
control (MAC) address, which could then be mapped to a switch serving a particular group of offices. If
an IP address can be mapped to a host owner or user—for example, by recording the mapping during
network login—the owner or user can be contacted to provide the host’s location.

The difficulty in identifying the physical location of an infected host depends on several factors. In a
managed environment, identifying a host’s location is often relatively easy because of the standardized
manner in which things are done. For example, host names might contain the user’s ID or office number,
or the host’s serial number (which can be tied to a user ID). Also, asset inventory management tools
might contain current information on host characteristics. In other environments, especially those in
which users have full control over their hosts and network management is not centralized, it might be
challenging to link a machine to a location. For example, an administrator might know that the host at
address 10.3.1.70 appears to be infected but not have any idea where that machine resides or who uses it.
Administrators might need to track down an infected host through network devices. For example, a switch
port mapper can poll switches for a particular IP address and identify the switch port number and host
name associated with that IP address. If the infected host is several switches away, it can take hours to
track down a single machine; if the infected host is not directly switched, the administrator might still
need to manually trace connectivity through various wiring closets and network devices. An alternative is
to pull the network cable or shut down the switch port for an apparently infected host and wait for a user
to report an outage. This approach can inadvertently cause a loss of connectivity for small numbers of
uninfected hosts, but if performed carefully as a last-resort identification and containment method, it can
be quite effective.

Some organizations first make reasonable efforts to identify infected hosts and perform containment,
eradication, and recovery efforts on them, then implement measures to prevent hosts that have not been
verified as uninfected and properly secured from attaching to the network. These measures should be
discussed well in advance, and incident handlers should have prior written permission to lock out hosts
under certain circumstances. Generally, lockout measures are based on the characteristics of particular
hosts, such as MAC addresses or static IP addresses, but lockouts can also be performed based on user ID
if a host is associated with a single user. Another possibility is to use network login scripts to identify and
deny access to infected hosts, but this might be ineffective if an infected host starts spreading malware
after system boot but before user authentication. As described in Section 4.3.4, having a separate VLAN
for infected or unverified hosts can provide a good way to lock out hosts, as long as the mechanism to
detect infections is reliable. Although lockout methods might be needed only under extreme
circumstances, organizations should think in advance about how individual hosts or users could be locked
out so that if needed, lockouts can be performed rapidly.

Sections 4.2.2.1 through 4.2.2.3 discuss the possible categories of infected host identification techniques:
forensic, active, and manual.

4.2.2.1 Forensic Identification

Forensic identification is the practice of identifying infected hosts by looking for evidence of recent
infections. The evidence may be very recent (only a few minutes old) or not so recent (hours or days old);
the older the information is, the less accurate it is likely to be. The most obvious sources of evidence are
those that are designed to identify malware activity, such as antivirus software, content filtering (e.g.,
anti-spam measures), IPS, and SIEM technologies. The logs of security applications might contain
detailed records of suspicious activity, and might also indicate whether a security compromise occurred or
was prevented.


                                                      21
