                                                                                               NIST SP 800-56B REV. 2                               RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                         USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                                   D. Step 3 is replaced by
                                                                                                           3. Check the modulus:
                                                                                                                   a. If (npub ≠ p × q) or (npub ≠ npriv) output an indication of an invalid key pair,
                                                                                                                      and exit without further processing.
                                                                                                                   b. If len(npub) ≠ nBits, output an indication of an invalid key pair, and exit
                                                                                                                      without further processing.
                                                                                                                   c. If nBits is not a positive even integer, output an indication of an invalid key
                                                                                                                      pair, and exit without further processing.
                                                                                                   E. Step 4 (prime-factor recovery) is omitted (i.e., not used),
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                                   F. Step 7 is replaced by the following two steps:
                                                                                                           7. Check the CRT components: Check that the components dP, dQ and qInv satisfy
                                                                                                                   a. 1 < dP < (p – 1).
                                                                                                                   b. 1 < dQ < (q – 1).
                                                                                                                   c. 1 < qInv < p.
                                                                                                                   d. 1 = (dP × epub) mod (p – 1).
                                                                                                                   e. 1 = (dQ × epub) mod (q – 1).
                                                                                                                   f. 1 = (qInv × q) mod p.
                                                                                                               If any of the criteria in Section 6.2.1 are not met, output an indication of an invalid
                                                                                                               key pair, and exit without further processing.
                                                                                                           8. Output an indication that the key pair is valid.
                                                                                               A routine that implements this validation function shall destroy any local copies of p, q, d, dP, dQ,
                                                                                               and qInv, as well as any other locally stored values used or produced during the execution of the
                                                                                               routine. The destruction of these locally stored values shall occur prior to or during any exit from
                                                                                               the routine (whether exiting early because of an error, or exiting normally).

                                                                                               6.4.1.4 RSA Key-Pair Validation (Exponent-Creation Method Unknown)
                                                                                               Public-key validation may be performed when the intended fixed value or intended bit length of
                                                                                               the public exponent is unknown by the entity performing the validation (i.e., the entity is unaware
                                                                                               of whether the key pair was generated as specified in Section 6.3.1 or Section 6.3.2). The following
                                                                                               methods can be used as long as the entity performing the validation (i.e., the key-pair owner or a
                                                                                               TTP trusted by the owner) knows the intended bit length of the modulus and the targeted security
                                                                                               strength, and has possession of some representation of the key pair to be validated (including the
                                                                                               private key in either the basic, prime factor or crt format).

                                                                                               6.4.1.4.1   basic-pkv
                                                                                               In this format, the private key is represented as (n, d).
                                                                                               Function call: basic_pkv (s, nBits, (npub, epub), (npriv, d))

                                                                                                                                                   53
