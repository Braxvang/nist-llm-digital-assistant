                                                               GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


Note that, from a security point of view, simply examining the Destination Address in the IPv6 header
may not provide all of the information needed to make packet filtering decisions. An amplification attack,
resulting in severe congestion and DoS, can be caused by a packet with a Routing Header containing
multiple instances of the same address. Thus, it is crucial to perform ingress filtering that prohibits the
forwarding of packets with a Type 0 Routing Header (RFC 5095).

The NH field and the related extension headers provide IPv6 with flexibility and extensibility, while
taking advantage of fixed-length headers with a reduced number of fields as compared with IPv4. NH
functionality in IPv6 provides the foundation for enhanced services such as IPv6 security and mobility.
They should be kept in mind when securing IPv6 networks, to be discussed later in this document.

Using extension headers can have a number of security implications. Packets containing hop-by-hop
extension headers must be analyzed at every node along the forwarding path, and can potentially cause a
resource consumption attack. Extension headers also incorporate additional complexity for the purpose of
traffic filtering. An example is enforcing a policy that blocks IPv6 traffic with mobility headers if IPv6
mobility is not being used by an organization. Incorporating extension header filtering policies may also
impact a device’s overall performance. Filtering is discussed in greater detail in Section 6, and ICMPv6
recommended filtering recommendations are provided in Table 3-7. Extension headers can also be used
as a ―covert channel‖ to hide communications between two systems, e.g., in Destination Options.

3.5       Internet Control Message Protocol for IPv6 (ICMPv6)

The IPv6 specifications redefine the Internet Control Message Protocol (ICMP) of IPv4 with a number of
additions and changes. The resulting protocol is documented in RFC 4443 and called ICMPv6. Specific
details regarding ICMPv6 are provided here, along with examples of how the protocol differs from its
counterpart under IPv4.

ICMPv6 is an integral aspect of the IPv6 specification. It reports errors if packets cannot be processed
properly and sends informational messages about the status of the network. An operational IPv6 network
depends upon proper implementation and functionality of ICMPv6. To achieve secure IPv6 operations, it
is crucial that network administrators and managers understand the design of ICMPv6 and how it
functions. Managers of IPv4-only networks should consider adding the capability of detecting ICMPv6
traffic to enhance security on their networks.

ICMPv6 provides IPv6 with administrative and network diagnostic functions. ICMPv6 provides familiar
capabilities like ping and destination unreachable. In IPv6, as in IPv4, ping can be used by network
administrators as a diagnostic tool to confirm that a node’s address is properly configured and responsive
to specific ICMPv6 requests, called echo requests. ICMPv6 also makes new features like Neighbor
Discovery (ND) and path MTU discovery possible within IPv6. ND, described in RFC 4861, is the
process by which an IPv6 node may learn important information such as link layer addresses of interfaces
on its own link.

ND effectively replaces the Address Resolution Protocol (ARP) used with IPv4. ND’s multicast
messages eliminate the need for the link-level broadcast messages associated with ARP.

  3.5.1    ICMPv6 Specification Overview

This section provides an overview of the ICMPv6 specification. The intent of this section is to introduce
the reader to fundamentals of the ICMPv6 specification: message format, error handling, and diagnostics.
As mentioned previously, specific applications of ICMPv6 (MTU discovery, ND, etc.) are defined in their
respective RFCs.


                                                   3-22
