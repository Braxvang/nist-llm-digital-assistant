                                                                                             NIST SP 800-208                                                                             RECOMMENDATION FOR STATEFUL
                                                                                                                                                                                        HASH-BASED SIGNATURE SCHEMES

                                                                                             3            General Discussion

                                                                                             At a high level, XMSS and LMS are very similar. They each consist of two componentsâ€”a one-
                                                                                             time signature (OTS) scheme and a method for creating a single, long-term public key from a
                                                                                             large set of OTS public keys. A brief explanation of OTS schemes and the method for creating a
                                                                                             long-term public key from a large set of OTS public keys can be found in Sections 3 and 4 of
                                                                                             [14].

                                                                                             3.1          One-Time Signature Systems

                                                                                             Both LMS and XMSS make use of variants of the Winternitz signature scheme. In the Winternitz
                                                                                             signature scheme, the message to be signed is hashed to create a digest; the digest is encoded as a
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-208




                                                                                             base b number; 1 and then each digit of the digest is signed using a hash chain, as follows.

                                                                                             A hash chain is created by first randomly generating a secret value, x, which is the private key.
                                                                                             The size of x should generally correspond to the targeted security strength of the scheme. So, for
                                                                                             the parameter sets approved by this recommendation, x will be either 192 or 256 bits in length.
                                                                                             The public key, pub, is then created by applying the hash function, H, to the secret b â€“ 1 times,
                                                                                             ğ»ğ» ğ‘ğ‘âˆ’1 (ğ‘¥ğ‘¥). Figure 1 shows an example of a hash chain for the kth digit of a digest where b is 4.


                                                                                                   ğ‘¥ğ‘¥ğ‘˜ğ‘˜       H               ğ»ğ»(ğ‘¥ğ‘¥ğ‘˜ğ‘˜ )             H        ğ»ğ»ï¿½ğ»ğ»(ğ‘¥ğ‘¥ğ‘˜ğ‘˜ )ï¿½          H           ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘˜ğ‘˜ = ğ»ğ» ï¿½ğ»ğ»ï¿½ğ»ğ»(ğ‘¥ğ‘¥ğ‘˜ğ‘˜ )ï¿½ï¿½

                                                                                                                                          Figure 1: A sample Winternitz chain for b = 4

                                                                                             The kth digit of the digest, Nk, is signed by applying the hash function, H, to the private key Nk
                                                                                             times, ğ»ğ»ğ‘ğ‘ğ‘˜ğ‘˜ (ğ‘¥ğ‘¥ğ‘˜ğ‘˜ ). Figure 2 shows an example of a signature for the kth digit of the digest created
                                                                                             using the Winternitz chain in Figure 1 when Nk is 1. As shown, the signature is ğ‘ ğ‘ ğ‘˜ğ‘˜ = ğ»ğ»1 (ğ‘¥ğ‘¥ğ‘˜ğ‘˜ ) =
                                                                                             ğ»ğ»(ğ‘¥ğ‘¥ğ‘˜ğ‘˜ ). Figure 2 also shows how the signature, sk, can be verified. The hash function, H, is
                                                                                             applied to sk twice, and if the resulting value is the same as the public key, pubk, then the
                                                                                             signature is valid. In general, the signature for the kth digit of a digest can be verified by
                                                                                             checking that ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘˜ğ‘˜ = ğ»ğ»ğ‘ğ‘âˆ’1âˆ’ğ‘ğ‘ğ‘˜ğ‘˜ (ğ‘ ğ‘ ğ‘˜ğ‘˜ ).


                                                                                                 ğ‘¥ğ‘¥ğ‘˜ğ‘˜        H               ğ‘ ğ‘ ğ‘˜ğ‘˜ = ğ»ğ»(ğ‘¥ğ‘¥ğ‘˜ğ‘˜ )

                                                                                                                                   ğ‘ ğ‘ ğ‘˜ğ‘˜         H           ğ»ğ»(ğ‘ ğ‘ ğ‘˜ğ‘˜ )           H                ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘˜ğ‘˜ â‰Ÿ ğ»ğ»ï¿½ğ»ğ»(ğ‘ ğ‘ ğ‘˜ğ‘˜ )ï¿½

                                                                                                                       Figure 2: A sample Winternitz signature generation and verification

                                                                                             As noted in [14], simply signing the individual digits of the digest is not sufficient because an


                                                                                             1   The base b is referred to as the Winternitz parameter in this publication. RFC 8391 [1] specifies that the Winternitz parameter,
                                                                                                 denoted by w there, may be either 4 or 16 but only specifies parameter sets for w = 16. In RFC 8554 [2], the term â€œWinternitz
                                                                                                 parameter,â€ also denoted by w, refers to a different but related quantity: the number of bits of the digest that is encoded by b.
                                                                                                 RFC 8554 specifies that w may be 1, 2, 4, or 8, which corresponds to a b of 2, 4, 16, or 256, respectively.


                                                                                                                                                               7
