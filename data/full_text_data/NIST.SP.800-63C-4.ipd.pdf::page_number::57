       NIST SP 800-63C-4 ipd                                              Digital Identity Guidelines
       December 2022                                                      Federation and Assertions


1511   6.2.5.2. Pairwise Pseudonymous Identiﬁer Generation
1512   Pairwise pseudonymous identifiers SHALL contain no identifying information about
1513   the subscriber. They SHALL also be unguessable by a party having access to some
1514   information identifying the subscriber. Pairwise pseudonymous identifiers MAY be
1515   generated randomly and assigned to subscribers by the IdP or MAY be derived from
1516   other subscriber information if the derivation is done in an irreversible, unguessable
1517   manner (e.g., using a keyed hash function with a secret key).
1518   Normally, the identifiers SHALL only be known by and used by one pair of endpoints
1519   (e.g., IdP-RP). An IdP MAY generate the same identifier for a subscriber at multiple RPs
1520   at the request of those RPs, provided:
1521       • The trust agreement stipulates a shared pseudonymous identifier for a specific
1522         family of RPs;
1523       • The authorized party consents to and is notified of the use of a shared
1524         pseudonymous identifier;
1525       • Those RPs have a demonstrable relationship that justifies an operational need for
1526         the correlation, such as a shared security domain or shared legal ownership; and
1527       • All RPs sharing an identifier consent to being correlated in such a manner (i.e., one
1528         RP cannot request to have another RP’s PPI without that other RP’s knowledge and
1529         consent).
1530   The RPs SHALL conduct a privacy risk assessment to consider the privacy risks
1531   associated with requesting a common identifier. See Sec. 9.2 for further privacy
1532   considerations.
1533   The IdP SHALL ensure that only intended RPs are correlated; otherwise, a rogue RP
1534   could learn of the pseudonymous identifier for a set of correlated RPs by fraudulently
1535   posing as part of that set.

1536   6.3. Identity APIs
1537   Attributes about the subscriber, including profile information, MAY be provided to the
1538   RP through a protected attribute API known as the identity API. The RP is granted limited
1539   access to the identity API during the federation transaction, in concert with the assertion.
1540   For example, in OpenID Connect, the UserInfo Endpoint provides a standardized identity
1541   API for fetching attributes about the subscriber. This API is protected by an OAuth 2.0
1542   Access Token, which is issued to the RP along with OpenID Connect’s assertion, the ID
1543   Token. The use of identity APIs along with federation assertions has several advantages
1544   for the overall security, privacy, and efficiency of the federation system.
1545   By making attributes available at an identity API, the IdP no longer has to use the
1546   assertion to convey as much information to the RP. This not only means that sensitive
1547   attributes do not have to be carried in the assertion itself, it also makes the assertion

                                                    45
