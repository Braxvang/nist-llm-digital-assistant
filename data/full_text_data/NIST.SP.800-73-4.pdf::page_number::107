Special Publication 800-73-4                         Interfaces for Personal Identity Verification â€“ Part 2:
                                                     PIV Card Application Card Command Interface




                                    Figure 1. PIV Data Confidentiality
Initialization Vector (IV): The IV for the AES CBC encryption of command data shall be generated by
applying the AES block cipher to a 16-byte encryption counter. The initial value of the encryption counter
upon successful completion of the key establishment protocol shall be '00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 01'. The encryption counter shall be incremented by one after each APDU sent over secure
messaging (except for the GET RESPONSE command and APDUs with a CLA of '1C'), and it shall be
reset to its initial value after each successful completion of the key establishment protocol. The 16-byte
IV shall be created by encrypting the encryption counter with SK ENC using AES in the electronic
codebook (ECB) mode of operation.

The IV for the AES CBC encryption of response data shall also be generated by encrypting an encryption
counter with SK ENC using AES in the ECB mode of operation. The encryption counter value used to
generate the IV to encrypt the response data shall be the same as the encryption counter value used to
generate the IV to encrypt the corresponding request data, with the exception that the most significant
byte of the 16-byte counter shall be set to '80' (i.e., the IV used to encrypt the first response after
successful completion of the key establishment protocol shall be generated by encrypting '80 00 00 00 00
00 00 00 00 00 00 00 00 00 00 01' with SK ENC ).

Padding: Prior to encryption, one to sixteen bytes of padding data shall be appended to the PIV data. The
padding shall be '80' followed by the number of zeros needed to make the total length of the message to
be encrypted (PIV data plus padding) a multiple of sixteen bytes. The first byte of the value field of tag
'87', the padding-content indicator byte, shall be '01' to indicate that padding has been applied.


                                                    32
