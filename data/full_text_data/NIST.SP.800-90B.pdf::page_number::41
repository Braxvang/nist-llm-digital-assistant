                                                                                             NIST SP 800-90B                                             RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                 USED FOR RANDOM BIT GENERATION

                                                                                             Example 5: Let the input sequence be S = (5, 15, 12, 1, 13, 9, 4). The median of the input sequence
                                                                                             is 9. Then, 𝑆𝑆 ′ = (–1, +1, +1, –1, +1, +1, –1). The runs are (–1), (+1, +1), (–1), (+1, +1), and (–1).
                                                                                             There are five runs, hence T = 5.

                                                                                             Handling binary data: When the input data is binary, the median of the input data is assumed to
                                                                                             be 0.5. No additional conversion steps are required.

                                                                                             5.1.6   Length of Runs Based on Median

                                                                                             This test statistic determines the length of the longest run that is constructed with respect to the
                                                                                             median of the input data and is calculated as follows:
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                                1. Find the median 𝑋𝑋� of S = (s1, …, sL).
                                                                                                2. Construct a temporary sequence 𝑆𝑆 ′ = (𝑠𝑠1′ , … , 𝑠𝑠𝐿𝐿′ ) from the input sequence S = (s1, …, sL), as
                                                                                                                                                   −1,   if 𝑠𝑠𝑖𝑖 < 𝑋𝑋�
                                                                                                                                       𝑠𝑠𝑖𝑖′ = �
                                                                                                                                                   +1,   if 𝑠𝑠𝑖𝑖 ≥ 𝑋𝑋�

                                                                                                     for i = 1, …, L.

                                                                                                3. The test statistic T is the length of the longest run in 𝑆𝑆 ′ .
                                                                                             Example 6: Let the input sequence be S = (5, 15, 12, 1, 13, 9, 4). The median for this data subset
                                                                                             is 9. Then, S ' = (–1, +1, +1, –1, +1, +1, –1). The runs are (–1), (+1, +1), (–1), (+1, +1), and (–1).
                                                                                             The longest run has a length of 2; hence, T =2.

                                                                                             Handling binary data: When the input data is binary, the median of the input data is assumed to
                                                                                             be 0.5. No additional conversion steps are required.

                                                                                             5.1.7   Average Collision Test Statistic

                                                                                             The average collision test statistic counts the number of successive sample values until a duplicate
                                                                                             is found. The average collision test statistic is calculated as follows:

                                                                                                1. Let C be a list of the number of the samples observed to find two occurrences of the same
                                                                                                   value in the input sequence S = (s1, …, sL). C is initially empty.
                                                                                                2. Let i = 1.
                                                                                                3. While i < L
                                                                                                     a. Find the smallest j such that (si, …, si+j-1) contains two identical values. If no such j
                                                                                                        exists, break out of the while loop.
                                                                                                     b. Add j to the list C.
                                                                                                     c. i = i + j.
                                                                                                4. The test statistic T is the average of all values in the list C.
                                                                                             Example 7: Let the input sequence be S = (2, 1, 1, 2, 0, 1, 0, 1, 1, 2). The first collision occurs for
                                                                                             j = 3, since the second and third values are the same. 3 is added to the list C. Then, the first three

                                                                                                                                                   33
