NIST SP 800-85A-4                                       PIV CARD APPLICATION & MIDDLEWARE
                                                                 INTERFACE TEST GUIDELINES

 Expected Result(s)   Call returns with status_word of PIV_OK.
 Postcondition(s)     Secure messaging session is established.



B.11.1.2        Command Execution with Established Secure Messaging
 Purpose             Ensure the PIV Middleware implements ACRs across SM with VCI
                     and pairing code.
 Target               pivEstablishSecureMessaging
 Reference(s)         1. SP 800-73-4 Part 3, Section 3.2.2
                      2. AS04.07A-R4, AS04.07B-R4
 Precondition(s)      1. A valid PIV Card is placed within the reading range of the
                         contactless reader.
                      2. There exists a valid connection between the test system and an
                         instance of the contactless reader.
                      3. The client application owns a connection to the PIV Card
                         Application accessible through cardHandle.
                      4. The client application has successfully selected the PIV Card
                         Application.
                      5. No other contactless card is within the proximity of the reader.
                      6. Secure messaging has been established by calling the
                         pivEstablishSecureMessaging function.
 Test Steps           1. Call pivLogIntoCardApplication with '98'
                         • (IN) cardHandle
                         • (IN) authenticators
                         • (IN) AuthLength
                      2. Call pivLogIntoCardApplication with ('00' or '80')
                         • (IN) cardHandle
                         • (IN) authenticators
                         • (IN) AuthLength
                      3. Call pivGetData with (Cardholder Fingerprints, Facial
                         Image, Iris Images, Printed Information, and the Pairing
                         Code Reference Data Container)
                         • (IN) cardHandle
                         • (IN) OID
                         • (IN) oidLength
                         • (OUT) data
                         • (INOUT) DataLength
                      4. Call pivCrypt with ('9A', '9D', and all retired key
                         management keys ('82'-'95') located on the card)
                         • (IN) cardHandle
                         • (IN) algorithmIdentifier
                         • (IN) keyReference
                         • (IN) algorithmInput
                         • (IN) inputLength
                         • (OUT) algorithmOutput
                         • (INOUT) outputLength


                                      B-33
