                                                                                             NIST SP 800-90B                                                  RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                      USED FOR RANDOM BIT GENERATION

                                                                                             Let next() yield the next sample from the noise source. Given a continuous sequence of noise
                                                                                             samples, the cutoff value C and the window size W, the adaptive proportion test is performed as
                                                                                             follows:
                                                                                                    1. A= next()
                                                                                                    2. B=1.
                                                                                                    3. For i = 1 to W–1
                                                                                                            If (A = next()) B=B+1
                                                                                                            If (B ≥ C) signal a failure
                                                                                                    4. Go to Step 1.

                                                                                             The cutoff value C is chosen such that the probability of observing C or more identical samples in
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                             a window size of W is at most α. Mathematically, C satisfies the following equation 10:
                                                                                                                                            Pr (B ≥ C) ≤ α .
                                                                                             For binary sources, the developer is allowed to extend the test by also checking that W-B ≥ C,
                                                                                             which would guarantee that a binary value occurring too frequently will be caught on the first test
                                                                                             window.
                                                                                             For noise sources where the alphabet size is large (e.g., greater than 256), the submitter may reduce
                                                                                             the alphabet size to a lower value, using the method described in Section 6.4.

                                                                                             The following table gives example cutoff values for various min-entropy estimates per sample and
                                                                                             window sizes with α = 2−20.


                                                                                                               Table 2 Example cutoff values of the Adaptive Proportion Test

                                                                                                                                Binary data                Non-binary data
                                                                                                                                 W=1024                       W=512
                                                                                                                                        Cutoff                         Cutoff
                                                                                                                          Entropy                     Entropy
                                                                                                                                        Value C                        Value C
                                                                                                                             0.2           941             0.5            410
                                                                                                                             0.4           840              1             311
                                                                                                                             0.6           748              2             177
                                                                                                                             0.8           664              4              62
                                                                                                                              1            589              8              13




                                                                                             10 This probability can be computed using widely-available spreadsheet applications. In Microsoft Excel, Open Office

                                                                                             Calc,and iWork Numbers, the calculation is done with the function =CRITBINOM(). For example, in Microsoft Excel, C
                                                                                             would be computed as =1+CRITBINOM(W, power(2,( −H)),1−α).


                                                                                                                                                     27
