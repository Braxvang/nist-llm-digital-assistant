                                                        GUIDE TO INTEGRATING FORENSIC TECHNIQUES INTO INCIDENT RESPONSE



positives (incorrectly reporting benign activity as malicious) and false negatives (incorrectly classifying
malicious activity as benign). 107 Tools such as NFAT and IDS might also produce inaccurate alerts if
they do not process all packets within a connection. 108 Validation should be based on an analysis of
additional data (e.g., raw packets, supporting information captured by other sources), a review of
available information on alert validity (e.g., vendor comments on known false positives), and past
experience with the tool in question. In many cases, an experienced analyst can quickly examine the
supporting data and determine that an alert is a false positive and does not need further investigation.

Analysts may also need to examine secondary network traffic data sources, such as host-based firewall
logs and packet captures, and non-network traffic data sources, such as host OS audit logs and antivirus
software logs. The most common reasons for doing this are as follows:

      ! No Data on Primary Sources. In some cases, the typical primary network traffic data sources
        do not contain evidence of the activity. For example, an attack might have occurred between two
        hosts on an internal network segment that is not monitored or controlled by network security
        devices. In these cases, analysts should identify other likely data sources and examine them for
        evidence.
      ! Insufficient or Unvalidated Data on Primary Sources. Analysts might need to examine
        secondary data sources if primary data sources do not contain sufficient information or analysts
        need to validate the data. After reviewing one or more primary data sources, analysts should
        query the appropriate secondary data sources based on the pertinent data from the primary data
        sources. For example, if IDS records indicate an attack against the system at IP address
        10.20.30.40 with an apparent origin of IP address 10.3.0.1, querying other data sources using one
        or both IP addresses might uncover additional data regarding the activity. Analysts also use
        timestamps,109 protocols, port numbers, and other common data fields to narrow their search as
        necessary.
      ! Best Source of Data Elsewhere. Occasionally, the best sources of network traffic data are
        located on a particular host, such as host-based firewall and IDS logs on a system that was
        attacked. Although such data sources can be very helpful, their data may be altered or destroyed
        during a successful attack.
If additional data is needed but cannot be located and the suspicious activity is still occurring, analysts
might need to perform more data collection activities. For example, an analyst could perform packet
captures at an appropriate point on the network to gather more information. Other ways to collect more
information include configuring firewalls or routers to log more information on certain activity, setting an
IDS signature to capture packets for the activity, and writing a custom IDS signature that alerts when a
specific activity occurs. See Section 6.2 for additional guidance on tools that can collect data. Collecting
additional data may be helpful if the activity is ongoing or intermittent; if the activity has ended, there is
no opportunity to collect additional data.


107
      From an analyst’s perspective, the concept of false negatives is important because it means that security devices sometimes
      fail to report attacks that they have observed. Analysts should not assume that an activity is benign if security devices have
      not reported it as malicious.
108
      There are several possible causes for not processing all packets, including security device failure (e.g., outage, software
      bug), security device overload (e.g., unusually high volume of packets to process), and asynchronous routing. In
      asynchronous routing, the incoming packets and outgoing packets for a connection take different routes. If only one of these
      routes is monitored by a device such as an IDS sensor, the device can see only part of the connection.
109
      As mentioned in Section 4.3.3, organizations should use time synchronization to keep systems’ clocks consistent.
      Correlating an event among multiple network traffic sources is easier and more effective if the clocks are in synch. If event
      data sources are on separate devices, timestamps can be helpful in confirming the path that the packets used. (When packets
      traverse a network, it takes them some amount of time to get from one device to the next.)


                                                               6-13
