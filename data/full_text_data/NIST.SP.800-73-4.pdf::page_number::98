Special Publication 800-73-4                              Interfaces for Personal Identity Verification – Part 2:
                                                          PIV Card Application Card Command Interface

Sections 4.1.1 and 4.1.2 provide additional details about each of the protocol steps performed by the client
application and the PIV Card Application, and Section 4.1.3 defines the notations used in the description
of the protocol. Section 4.1.4 provides the details of the two cipher suites that may be supported by the
PIV Card Application. Section 4.1.5 specifies the format for the secure messaging card verifiable
certificate (CVC) that is used to authenticate the PIV Card Application and for the optional Intermediate
CVC that is used to verify the signature on the secure messaging CVC when the public key needed to
verify the signature on the secure messaging CVC does not appear in an X.509 content signing
certificate. Section 4.1.6 provides additional information about the key derivation function (KDF) used to
derive the session keys that are used during secure messaging, and Section 4.1.7 provides additional
information about the computation of the authentication cryptogram for key confirmation. Section 4.1.8
demonstrates the use of the GENERAL AUTHENTICATE command to perform the key establishment
protocol.

  4.1.1   Client Application Steps

Step #    Description                                                  Comment
H1        Set CB H to 0x00                                             The client application’s control byte is set
                                                                       to 0x00 to indicate the client application
                                                                       does not support persistent binding.
H2        Generate an ephemeral key pair (d eH ; Q eH )                Generate an ephemeral ECC key pair for
                                                                       the client application using an approved
                                                                       method [FIPS186, Appendix B] and
                                                                       perform partial public-key validation
                                                                       [SP800-56A, Section 5.6.2.3.2], either as
                                                                       part of the key generation process or as a
                                                                       separate process. If the 0xAC tag of the
                                                                       application property template (APT)
                                                                       includes '27', then generate an ephemeral
                                                                       key pair over Curve P-256. If the 0xAC tag
                                                                       of the APT includes '2E', then generate an
                                                                       ephemeral key pair over Curve P-384.
H3       Send CB H || ID sH || Q eH
Wait for response from PIV Card Application:
       CB ICC || N ICC || AuthCryptogram ICC || C ICC
H4       Check that CB ICC is 0x00                                     Verify that the card executed the protocol
                                                                       in accordance with the parameters specified
                                                                       in Step H1. Return an authentication error
                                                                       if check fails.




                                                        23
