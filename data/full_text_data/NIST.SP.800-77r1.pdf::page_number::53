                                                                                              NIST SP 800-77 REV. 1                                                          GUIDE TO IPSEC VPNS


                                                                                              4         The IPsec Protocols

                                                                                              IPsec is a collection of protocols that assist in protecting communications over networks. 35 This
                                                                                              section focuses on the primary component of IPsec—ESP, which protects the confidentiality and
                                                                                              integrity of data packets. The section also briefly covers the other IPsec components: the IP
                                                                                              Payload Compression Protocol (IPComp) and the Authentication Header (AH) protocol. All of
                                                                                              the parameters and cryptographic keys needed by the IPsec protocols are negotiated using the
                                                                                              IKE protocol as described in Section 3.

                                                                                              4.1       Encapsulating Security Payload (ESP)
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              ESP is the core IPsec security protocol. It has largely been unchanged since its second version,
                                                                                              which was published as RFC 2406 in 1998 [46]. The current version (IPsec-v3) was specified in
                                                                                              RFC 4303 in 2005 [24]. It contains only a few updates to the IPsec-v2 specification in RFC
                                                                                              2406. Since all of the changes to ESP are either backwards compatible or are new features that
                                                                                              would need to be negotiated via IKE before they are enabled for ESP, there are no compatibility
                                                                                              issues between IPsec implementations receiving and sending ESP packets. Regardless,
                                                                                              practically all current implementations support IPsec-v3. Features only available in IPsec-v3 are:
                                                                                                    •    Support for AEAD algorithms
                                                                                                    •    Extended Sequence Numbers (ESNs)
                                                                                                    •    Enhanced policy support (via Security Policy Database [SPD]/Security Association
                                                                                                         Database [SAD])
                                                                                                    •    Padding support
                                                                                                    •    Dummy packet support

                                                                                              The use of padding and the capability of sending dummy messages increase TFC by making it
                                                                                              harder for an eavesdropper who cannot decrypt the packets to deduce anything from the
                                                                                              encrypted packet sizes or timings.

                                                                                              ESP provides encryption and integrity protection. The outer header is not fully protected,
                                                                                              allowing for routers that forward ESP packets to still modify certain flags, such as the Quality of
                                                                                              Service (QoS) and Time to Live (TTL) values.

                                                                                              ESP’s encryption functionality can be disabled through the selection of the Null ESP encryption
                                                                                              algorithm or the AES-GMAC AEAD algorithm. AES-GMAC is a variant of the AES-GCM
                                                                                              algorithm, which provides integrity protection without encryption. ESP can be used to provide
                                                                                              either encryption and integrity protection or only integrity protection. AH deployments should be
                                                                                              migrated to these ESP algorithms. ESP supports AEAD and classic (non-AEAD) encryption with
                                                                                              integrity methods.




                                                                                              35    RFC 4301 provides an overview of IPsec [45].



                                                                                                                                                   36
