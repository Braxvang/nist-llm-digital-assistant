                                                                                               NIST SP 800-56B REV. 2                          RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                    USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                                      outputs an error indicator, return an error indicator without performing the remaining
                                                                                                      actions.
                                                                                                  5. Construct the mutually determined shared secret Z from ZU and ZV
                                                                                                          Z = ZU || ZV.
                                                                                                  6. Assemble the OtherInput for key derivation, including all requisite information (see
                                                                                                     Section 5.5).
                                                                                                  7   Use the agreed-upon key-derivation method (see Section 5.5) to derive secret keying
                                                                                                      material with the specified length from the shared secret Z and other input. If the key-
                                                                                                      derivation method outputs an error indicator, return an error indicator without performing
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                                      the remaining actions.
                                                                                                  8. Output the DerivedKeyingMaterial.
                                                                                               Any local copies of Z, ZU, ZV, PrivKeyU, OtherInput, DerivedKeyingMaterial and any intermediate
                                                                                               values used during the execution of party U’s actions shall be destroyed prior to the early
                                                                                               termination of the actions due to an error, or (in the absence of errors), prior to or during the
                                                                                               completion of step 8.
                                                                                               Party V shall execute the following key-agreement steps in order to a) establish a mutually
                                                                                               determined shared secret Z with party U, and b) derive secret keying material from Z.
                                                                                               Actions: Party V generates a shared secret and derives secret keying material as follows:
                                                                                                  1. Receive a ciphertext CU from party U.
                                                                                                  2. Use the RSASVE.RECOVER operation in Section 7.2.1.3 to recover ZU from the ciphertext
                                                                                                     CU using the private key-establishment key PrivKeyU. If the call to RSASVE.RECOVER
                                                                                                     outputs an error indicator, return an error indicator without performing the remaining
                                                                                                     actions.
                                                                                                  3. Use the RSASVE.GENERATE operation in Section 7.2.1.2 to generate a secret value ZV and
                                                                                                     a corresponding ciphertext CV using party U’s public key-establishment key PubKeyU.
                                                                                                  4. Send the ciphertext CV to party U.
                                                                                                  5. Construct the mutually determined shared secret Z from ZU and ZV
                                                                                                          Z = ZU || ZV.
                                                                                                  6. Assemble the OtherInput for key derivation, including all requisite information (see
                                                                                                     Section 5.5).
                                                                                                  7. Use the agreed-upon key-derivation method (see Section 5.5) to derive KBits of secret
                                                                                                     keying material DerivedKeyingMaterial from the shared secret Z and OtherInput. If the
                                                                                                     key-derivation method outputs an error indicator, return an error indicator without
                                                                                                     performing the remaining actions.
                                                                                                  8. Output the DerivedKeyingMaterial.
                                                                                               Any local copies of Z, ZU, ZV, PrivKeyV, OtherInput, DerivedKeyingMaterial and any intermediate
                                                                                               values used during the execution of party V’s actions shall be destroyed prior to the early

                                                                                                                                              82
