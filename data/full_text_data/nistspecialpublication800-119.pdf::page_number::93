                                                                  GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


     5. Prefer a destination with a source that has a matching label (in the policy table).
     6. Prefer a destination with higher precedence (in the policy table).
     7. Prefer a destination reached with native transport over one using encapsulation.
     8. Prefer a destination with smaller scope.
     9. Prefer a destination with a source having the longest matching prefix.
     10. Prefer a destination that occurred first in the original list. That is, leave the order unchanged.
    4.6.2   Differences from IPv4 Standards

The address selection problem itself is new with IPv6 for several reasons:

    Freedom to use more addresses because of the larger address space

    Scoped addresses (link local, unique local, etc.)

    Explicit rules that allow use of multiple addresses of the same type

    Prefix renumbering

    Address deprecation.
The address selection rules recognize MIPv6 and distinguish home addresses from care-of addresses. The
simultaneous presence of IPv4, IPv6, and transition tunneling protocols requires address selection rules
that integrate the use of both IPv4 and IPv6.

    4.6.3   Security Ramifications

The proper use of the address selection rules given here can have an impact on security, affecting data
availability and integrity. Improper address selection can result in dropping packets inadvertently or
inefficient packet forwarding, which are not security problems per se. Many attacks, however, use
spoofed addresses, which can be characterized as systems not following the rules.

Proper source address selection is important for ingress filtering. Note that it may be difficult for ingress
filtering to distinguish temporary addresses from spoofed ―in-prefix‖ addresses used in DOS attacks.
Denying newly established incoming TCP and UDP connections can prevent some spoofed source
address attacks by preventing datagrams with spoofed source addresses from transiting network
protection devices.

Address selection works across IPv4 and IPv6 addresses and can determine which is used when both are
available or which type of tunneling is used. Ensuring that address selection policy is correctly specified
can affect other assumptions about security.

The address selection rules can help enable some attacks on privacy. By probing a host with requests that
come from different source addresses and observing what source addresses the target uses for replies, one
can extract information about the set of addresses used by the target.

If an attacker were to compromise and modify the address selection policy table, this could cause a man-
in-the-middle or DOS attack. This can be mitigated by applying best practices of desktop and server
security (e.g., malware filtering in web and e-mail content, patching processes, removal of administrative


                                                      4-30
