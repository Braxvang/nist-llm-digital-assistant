                                          ESTABLISHING WIRELESS ROBUST SECURITY NETWORKS: A GUIDE TO IEEE 802.11I



          stations are part of the DS. Table 5-2 identifies the functions of each of the address fields for the
          four possible cases, as defined by the values for the To DS and From DS subfields.

                         Table 5-2. MAC Header Address Field Functions for Data Frames

        Function            “To DS”        “From DS”     Address 1     Address 2      Address 3     Address 4
                            Subfield       Subfield 50
 IBSS                           0               0         RA = DA          SA           BSSID           N/A
 Infrastructure BSS:
                                0               1         RA = DA        BSSID           SA             N/A
   From the AP
 Infrastructure BSS:
                                1               0        RA = BSSID        SA            DA             N/A
   To the AP
 Infrastructure BSS:
   Wireless DS                  1               1           RA             TA            DA             SA
   (AP to AP)



5.2     Phases of IEEE 802.11 RSN Operation

This section provides an overview of the operation of an IEEE 802.11 RSN. By grouping the frame
exchanges according to function, RSN operation may be thought of as occurring in five distinct phases,
some of which also occur in pre-RSN IEEE 802.11 implementations. Figure 5-4 depicts the phases in an
infrastructure mode configuration and maps them to the WLAN network components involved in each
phase, as well as end stations outside the WLAN RSN in the distribution system (e.g., other computers in
the wired network). The rectangles represent the sequence of frames between the network components.

The following items briefly describe each of the phases.

       Phase 1: Discovery. An AP uses Beacons and Probe Responses to advertise its IEEE 802.11i
        security policy. The STA uses these to identify an AP for a WLAN with which it wishes to
        communicate. The STA associates with the AP, which it uses to select the cipher suite and
        authentication mechanism when the Beacons and Probe Responses present a choice.
       Phase 2: Authentication. During this phase, the STA and AS prove their identities to each
        other. The AP blocks non-authentication traffic between the STA and AS until the authentication
        transaction is successful. The AP does not participate in the authentication transaction other than
        forwarding traffic between the STA and AS.
       Phase 3: Key Generation and Distribution. The AP and the STA perform several operations
        that cause cryptographic keys to be generated and placed on the AP and the STA. Frames are
        exchanged between the AP and STA only.
       Phase 4: Protected Data Transfer. Frames are exchanged between the STA and the end station
        through the AP. As denoted by the shading and the lock and key, secure data transfer occurs
        between the STA and the AP only; security is not provided end-to-end.
       Phase 5: Connection Termination. The AP and STA exchange frames. During this phase, the
        secure connection is torn down and the connection is restored to the original state.
Sections 5.3 through 5.7 provide in-depth discussion of each phase.

50
      Figure 5-3 shows the To DS and From DS fields.


                                                         5-5
