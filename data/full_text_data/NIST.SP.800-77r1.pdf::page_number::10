                                                                                              NIST SP 800-77 REV. 1                                                          GUIDE TO IPSEC VPNS


                                                                                                           Option                 Recommended                       Legacy          Expected

                                                                                               IPsec
                                                                                               Mode                   tunnel mode, transport mode
                                                                                               Protocol               ESP, IPComp                             AH
                                                                                               Version                IPsec-v3                                IPsec-v2
                                                                                               Encryption             AES-GCM, AES-CTR, AES-CBC, AES-
                                                                                                                      CCM (128, 192, 256-bit keys)
                                                                                               Integrity              HMAC-SHA256, HMAC-SHA384,                                  HMAC-SHA-3
                                                                                                                      HMAC-SHA512, AES-GMAC
                                                                                               Perfect Forward        Same or stronger DH as initial IKE DH
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                               Secrecy (PFS)
                                                                                               Lifetime               8 hours


                                                                                              NIST’s current cryptographic timeline requirements are specified in SP 800-131A [18]. Federal
                                                                                              agencies that want to provide IPsec VPN services in compliance with NIST’s recommendation
                                                                                              or requirements must ensure that their systems will be upgraded to NIST-recommended or
                                                                                              approved algorithms and key lengths before the current algorithms and their key lengths become
                                                                                              disallowed. Federal agencies should require their IPsec VPN vendors to have the necessary
                                                                                              upgrades available early enough for testing and deployment in the field.

                                                                                              The strongest possible cryptographic algorithms and key lengths that are NIST-approved should
                                                                                              be used for authentication, encryption, and integrity protection unless they are incompatible with
                                                                                              interoperability, performance, or export constraints.

                                                                                              In addition to providing specific recommendations related to configuring cryptography for IPsec,
                                                                                              this guide presents a phased approach to IPsec planning and implementation that can help in
                                                                                              achieving successful IPsec deployments. The five phases of the approach are as follows:

                                                                                                  1. Identify Needs – Identify the need to protect network communications and determine
                                                                                                     how that need can best be met.
                                                                                                  2. Design the Solution – Make design decisions in several areas, including architectural
                                                                                                     considerations, authentication methods, cryptographic policy, and packet filters. The
                                                                                                     placement of an IPsec gateway has potential security, functionality, and performance
                                                                                                     implications. An authentication solution should be selected based primarily on
                                                                                                     maintenance, scalability, and security. Packet filters should apply appropriate protections
                                                                                                     to traffic and not protect other types of traffic for performance or functionality reasons.
                                                                                                  3. Implement and Test a Prototype – Test a prototype of the designed solution in a lab or
                                                                                                     test environment to identify any potential issues. Testing should evaluate several factors,
                                                                                                     including connectivity, protection, authentication, application compatibility,
                                                                                                     management, logging, performance, the security of the implementation, and component
                                                                                                     interoperability.
                                                                                                  4. Deploy the Solution – Gradually deploy IPsec throughout the enterprise. Existing
                                                                                                     network infrastructure, applications, and users should be moved incrementally over time




                                                                                                                                                 viii
