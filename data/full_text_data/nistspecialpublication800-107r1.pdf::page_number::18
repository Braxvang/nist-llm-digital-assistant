5.3.5 Security of the HMAC Values
The successful verification of a MacTag does not completely guarantee that the
accompanying text is authentic; there is a slight chance that an adversary with no
knowledge of the HMAC key, K, can present a (MacTag, text) pair that will pass the
verification procedure. From the perspective of an adversary that does not know the
HMAC key K (i.e., the adversary is not among the community of users that share the
key), the assurance of authenticity provided by a MacTag depends on its length and on
the number of failed MacTag verifications allowed by a system for each value of the
HMAC key.
Let 2t be the number of failed MacTag verifications allowed by a system for each value
of the HMAC key. The MacTag length, λ, and the value of t need to be chosen to avoid
an unacceptable probability of falsely accepting forged data. The likelihood of accepting
forged data as authentic is (1/2)(λ - t). For example, if λ is 32, and a system allows 212
failed MacTag verifications for any given value of the HMAC key, then the likelihood of
accepting forged data is (1/2)20. In order to increase assurance of authenticity, either λ
would need to be increased, or the number of allowed failed MacTag verifications for
each value of the HMAC key would need to be decreased. To avoid having an
unacceptable probability of falsely accepting forged data at any time, the value of the
HMAC key must be changed to a new value before the number of failed MacTag
authentications reaches the maximum allowed number (2t). For the example above, with
λ = 32 and t = 20, the HMAC key must be changed before the number of failed MacTag
verifications reaches 212.
The table below provides the likelihoods of accepting forged data for different MacTag
lengths and allowed numbers of MAC verifications using a given value of the HMAC
key. This table is intended to assist the implementers of HMAC applications in security-
sensitive systems to assess the security risk associated with using MacTags.
                         Number of Failed Verifications Allowed (2t):
                    λ       220           230            235
                    40       2−20            2−10             2−5
                    64       2−44            2−34            2−29
                    96       2−76            2−66            2−61

                Table 2: Risks/Likelihoods of Accepting Forged Data
      -x
Each 2 entry displayed in Table 2 is the probability of accepting forged data given the
indicated choices for the MacTag length and the number of failed MacTag verifications
allowed for a fixed value of the HMAC key. If the probability is not acceptable for the
system, the HMAC key shall be changed to a new value before the number of failed
MAC verifications reaches 2t.
A commonly acceptable length for the MacTag is 64 bits; MacTags with lengths shorter
than 64 bits are discouraged.


                                            15
