                                                                                               NIST SP 800-56B REV. 2                            RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                      USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                                  2. Send the ciphertext C to party V.
                                                                                                  3. Obtain party V’s nonce NV from party V. If NV is not available, return an error indicator
                                                                                                     without performing the remaining actions.
                                                                                                  4. Assemble the OtherInput for key derivation, including the required nonce, NV, and any
                                                                                                     other requisite information (see Section 5.5).
                                                                                                  5. Use the agreed-upon key-derivation method (see Section 5.5) to derive secret keying
                                                                                                     material of the agreed-upon length from the shared secret value Z and OtherInput (see step
                                                                                                     4). If the key-derivation method outputs an error indicator, return an error indicator without
                                                                                                     performing the remaining actions.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                                  6.   Output the DerivedKeyingMaterial.
                                                                                               Any local copies of Z, OtherInput, DerivedKeyingMaterial and any intermediate values used
                                                                                               during the execution of party U’s actions shall be destroyed prior to the early termination of the
                                                                                               actions due to an error, or (in the absence of errors), prior to or during the the completion of step
                                                                                               6.
                                                                                               Party V shall execute the following key-agreement steps in order to a) establish a shared secret Z
                                                                                               with party U, and b) derive secret keying material from Z.
                                                                                               Actions: Party V obtains the shared secret and derives secret keying material as follows:
                                                                                                  1. Receive a ciphertext C from party U.
                                                                                                  2. Use the RSASVE.RECOVER operation in Section 7.2.1.3 to recover the secret value Z from
                                                                                                     the ciphertext C using the private key-establishment key, PrivKeyV; hereafter, Z is
                                                                                                     considered to be a shared secret. If the call to RSASVE.RECOVER outputs an error indicator,
                                                                                                     return an error indicator without performing the remaining actions.
                                                                                                  3. Obtain a nonce NV (see Section 5.4), and send NV to party U.
                                                                                                  4. Assemble the OtherInpu, for key derivation using the nonce NV and the identifiers IDU and
                                                                                                     IDV, if available (see Section 5.5).
                                                                                                  5. Use the agreed-upon key-derivation method to derive secret keying material with the
                                                                                                     agreed upon length from the shared secret value Z and other input. If the key-derivation
                                                                                                     method outputs an error indicator, return an error indicator without performing the
                                                                                                     remaining actions.
                                                                                                  6. Output the DerivedKeyingMaterial.
                                                                                               Any local copies of Z, PrivKeyV, OtherInput DerivedKeyingMaterial and any intermediate values
                                                                                               used during the execution of party V’s actions shall be destroyed prior to the early termination of
                                                                                               the actions due to an error, or (in the absence of errors) prior to or during the the completion of
                                                                                               step 6.
                                                                                               The messages may be sent in a different order, i.e., NV may be sent before C.
                                                                                               It is extremely important that an implementation not reveal any sensitive information. It is also
                                                                                               important to conceal partial information about the shared secret Z to prevent chosen-ciphertext
                                                                                               attacks on the secret-value encapsulation scheme.
                                                                                                                                                77
