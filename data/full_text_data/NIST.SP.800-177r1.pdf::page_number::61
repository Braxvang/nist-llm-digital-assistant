                                                                                               NIST SP 800-177 REV. 1                                                            TRUSTWORTHY EMAIL




                                                                                                         SPF and/or DKIM veriﬁcation steps. If there is a match with either the domain veriﬁed by
                                                                                                         SPF or DKIM, then the DMARC Identiﬁer Alignment check passes.
                                                                                                      6. �e receiver applies the DMARC policy found in the purported sender's DMARC record
                                                                                                         unless it conﬂicts with the receiver's local policy. �e receiver will also store the results
                                                                                                         of evaluating each received message for the purpose of compiling aggregate reports sent
                                                                                                         back to the domain owner (as speciﬁed in the rua tag).

                                                                                               Note that local email processing policy may override a sending domain owner’s stated DMARC
                                                                                               policy. �e receiver should also store the results of evaluating each received message in some
                                                                                               persistent form for the purpose of compiling aggregate reports.

                                                                                               Even if steps 2-5 in the above procedure yield no SPF or DKIM records to evaluate the message,
                                                                                               it is still useful to send aggregate reports based on the sending domain owner’s DMARC
                                                                                               preferences, as it helps shape sending domain responses to spam in the system.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-177r1




                                                                                               Security Recommendation 4-12: Mail receivers who evaluate SPF and DKIM results of
                                                                                               received messages are recommended to dispose them in accordance with the sending domain’s
                                                                                               published DMARC policy, if any. �ey are also recommended to initiate failure reports and
                                                                                               aggregate reports according to the sending domain’s DMARC policies.

                                                                                               4.6.5      Policy and Reporting

                                                                                               DMARC can be seen as consisting of two components: a policy on linking SPF and DKIM
                                                                                               checks to the message-From: address, and a reporting mechanism. �e reason for DMARC
                                                                                               reporting is so that domain owners can get feedback on their SPF, DKIM, Identiﬁer Alignment
                                                                                               and message disposition policies so these can be made more eﬀective. �e DMARC protocol
                                                                                               speciﬁes a system of aggregate reports sent by receivers on a periodic basis, and failure reports
                                                                                               sent on a message-by-message basis for email that fail some component part of the DMARC
                                                                                               checks. �e speciﬁed form in which receivers send aggregate reports is as a compressed (zipped)
                                                                                               XML ﬁle based on the AFRF format [RFC6591], [RFC7489] 13. Each aggregate report from a
                                                                                               mail receiver back to a particular domain owner includes aggregate ﬁgures for successful and
                                                                                               unsuccessful message authentications including:

                                                                                                      •   �e sending domain owner’s DMARC policy for that interval (domain owners may
                                                                                                          change policies and it is undetermined whether a receiver will respond based on the old
                                                                                                          policy or the new policy).
                                                                                                      •   �e message disposition by the receiver (i.e., delivered, quarantined, rejected).
                                                                                                      •   SPF result for a given SPF identiﬁer.
                                                                                                      •   DKIM result for a given DKIM identiﬁer.
                                                                                                      •   Whether identiﬁers are in alignment or not.



                                                                                               13   Appendix C of RFC 7489.


                                                                                                                                                  48
