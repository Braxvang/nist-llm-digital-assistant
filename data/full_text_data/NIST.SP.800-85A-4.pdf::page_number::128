NIST SP 800-85A-4                                 PIV CARD APPLICATION & MIDDLEWARE
                                                           INTERFACE TEST GUIDELINES

                      •   Data field of the command contains the PUK value for
                          key reference '80' concatenated without delimitation
                          with a new PIN (PIN 2) padded with 'FF' to complete the
                          total length of the value to 8 bytes
                    6. Obtain number of remaining retries of the '80' key
                        reference by sending the VERIFY command with
                       • P2, key reference value is set to '80'
                       • P1 parameter is '00' and both L c and the data field are
                          absent
                    7. Send VERIFY card command with
                       • P2, key reference value is set to '80'
                       • Data field of the command contains the new PIN (PIN 2)
                          value, padded with 'FF' to complete the total length of
                          the value to 8 bytes
                    Perform steps 8 - 10 only if the reset of the PIN’s retry
                    counter also resets the PUK retry counter
                    8. Send RESET RETRY COUNTER with
                       • P2, key reference value is set to '80'
                       • Data field of the command contains an incorrect PUK
                          value for key reference '80' concatenated without
                          delimitation with a new valid PIN value padded with
                          'FF' to complete the total length of the value to 8
                          bytes. (Record the number of remaining retries ‘X’ in
                          return code '63 CX')
                    9. Repeat step 5
                    10. Send RESET RETRY COUNTER with
                       • P2 key reference value is set to '80'
                       • Data field of the command contains an incorrect PUK
                          value for key reference '80' concatenated without
                          delimitation with a new valid PIN value padded with
                          'FF' to complete the total length of the value to 8
                          bytes. (Record the number of remaining retries ‘X’ in
                          return code '63 CX')
                    11. Send RESET RETRY COUNTER with
                       • P2, key reference value is set to '80'
                       • Data field of the command contains the correct PUK
                          value concatenated without delimitation with an
                          arbitrary PIN value that is less than 6 bytes but
                          padded to 8 bytes with 'FF'
                    12. Send RESET RETRY COUNTER with
                       • P2, key reference value, is set to '80'
                       • Data field of the command contains the correct PUK
                          value for key reference '80' concatenated without
                          delimitation with an arbitrary new PIN value that
                          contains 0x5A in the first byte position, all other
                          non-padded bytes contain values limited to 0x30 – 0x39.
                          The new PIN should be padded with 'FF' to complete the
                          total length of the value to 8 bytes (repeat test five
                          times with byte positions 2, 3, 4, 5, and 6 of the PIN
                          containing the 0x5A byte, respectively)
                    13. Send RESET RETRY COUNTER with
                       • P2, key reference value is set to '80'
                       • Data field of the command containing an incorrect PUK
                          value concatenated without delimitation with a new PIN



                                  C-27
