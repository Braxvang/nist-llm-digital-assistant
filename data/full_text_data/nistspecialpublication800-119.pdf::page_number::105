                                                                  GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


For these reasons, privacy addresses should not be turned on by default, and careful consideration should
be given case-by-case as to whether it is worth using. In many cases where enterprises are operating their
own networks, DHCPv6 address assignments may be preferable.

5.2     Cryptographically Generated Addresses

Cryptographically Generated Addresses (CGAs), also called Hash Based Addresses, provide a method to
prove ownership of the source address in a packet. The idea is to choose a public and private key pair
suitable for creating digital signatures with the private key and then to verify them with the public key
(see Figure 5-2). Then, the public key (along with other parameters) is used to generate an interface
identifier, the public key is inserted into the packet, and the packet is signed with the private key. Upon
receipt, the public key can be used to check both the address and signature. An attacker without the
private key could not sign a forged packet.




                Figure 5-2. Generating Cryptographic Addresses from Public-Private Key Pairs

Four processes are needed to make this work:

      The sender must:

      1. Generate a key pair and corresponding address.
      2. Insert the public key in a packet and sign it with the private key.

      The recipient must:
      3. Check that the source address corresponds to the public key.
      4. Verify the signature with the public key.
Note that using a CGA does not prove oneâ€™s actual identity, but it does show that the same entity (the one
with the private signing key) generated each of the packets, and that the packets were not subsequently
modified by another entity. The point is that no one without the private key can legitimately use the
CGA.

CGAs may be used to enhance security in any IPv6 network, but in many cases they have no discernible
advantage and more overhead than IPsec or higher-layer security protocols. They may be particularly
helpful, however, in cases involving ownership of a newly generated address. CGAs have been


                                                      5-3
