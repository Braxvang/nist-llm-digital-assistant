NIST SP 800-85A-4                                          PIV CARD APPLICATION & MIDDLEWARE
                                                                    INTERFACE TEST GUIDELINES

 Test Steps              1. Set cardHandle := <<invalid cardHandle>>
                         2. Call pivDisconnect with
                            • (IN) cardHandle
 Expected Result(s)      Call returns with status_word of PIV_INVALID_CARD_HANDLE.
 Postcondition(s)        The client application remains connected to the PIV Card
                         Application.


B.2.2.2          Disconnecting a Disconnected Client Application
 Purpose                Verify that when the client application tries to close a closed PIV
                        Card Application connection (i.e., with the same cardHandle), the
                        PIV Middleware returns an Invalid Card Handle message.
 Target                  pivDisconnect
 Reference(s)            1. SP 800-73-4 Part 3, Section 3.1.3
                         2. AS04.03
 Precondition(s)         1. A client application with a valid and open cardHandle to a PIV
                            Card Application that was previously closed.
                         2. The card is physically connected to the card reader.
 Test Steps              1. Call pivDisconnect with arguments
                            • (IN) cardHandle
 Expected Result(s)      Call returns with status_word of PIV_INVALID_CARD_HANDLE.
 Postcondition(s)        The client application remains unconnected to the PIV Card
                         Application.


B.3           pivSelectCardApplication

B.3.1           Valid Test Assertions

B.3.1.1          Select a Card Application with a Full AID
 Purpose                 Ensure that the PIV Middleware locates and selects a valid PIV Card
                         Application, stores its properties, and returns a reference to the
                         application properties.
 Target                  pivSelectCardApplication
 Reference(s)            1. SP 800-73-4 Part 3, Section 3.2.1
                         2. AS04.01, AS04.02A-R4, AS04.04
 Precondition(s)         1. The client application owns a connection accessible through
                            cardHandle through a contact reader.
 Test Steps              1. Set cardHandle := <<valid cardHandle>>
                         2. Set applicationID := <<AID of PIV Card Application>>
                         3. Create applicationProperties reference
                         4. Call pivSelectCardApplication with
                            • (IN) cardHandle
                            • (IN) applicationAID
                            • (IN) aidLength
                            • (OUT) applicationProperties


                                         B-6
