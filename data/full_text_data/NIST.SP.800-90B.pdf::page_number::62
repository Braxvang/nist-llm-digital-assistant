                                                                                             NIST SP 800-90B                                                      RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                          USED FOR RANDOM BIT GENERATION

                                                                                                  7. Calculate the predictor’s local performance, based on the longest run of correct predictions.
                                                                                                     Let r be one greater than the length of the longest run of ones in correct. Use a binary search
                                                                                                     to solve the following for 𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙 :

                                                                                                                                                   1 − 𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙 𝑥𝑥     1
                                                                                                                                     0.99 =                            × 𝑁𝑁+1 ,
                                                                                                                                                 (𝑟𝑟 + 1 − 𝑟𝑟𝑟𝑟)𝑞𝑞      𝑥𝑥

                                                                                                     where

                                                                                                                                                  𝑞𝑞 = 1 − 𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙

                                                                                                     and x = x10, derived by iterating the recurrence relation
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                                                                                             𝑟𝑟           𝑟𝑟+1
                                                                                                                                             𝑥𝑥𝑗𝑗 = 1 + 𝑞𝑞𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙 𝑥𝑥𝑗𝑗−1

                                                                                                     for j from 1 to 10, and x0=1. Note that solving for 𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙 using the logarithm of these
                                                                                                     equations is robust against overflows. Table 3 in Appendix G.2 provides some pre-
                                                                                                     calculated values of 𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙 .

                                                                                                  8. The min-entropy is the negative logarithm of the greater performance metric
                                                                                                                                                       ′                              1
                                                                                                                          min-entropy = −log 2 (max(𝑃𝑃𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 , 𝑃𝑃𝑙𝑙𝑜𝑜𝑐𝑐𝑐𝑐𝑐𝑐 , 𝑘𝑘)).

                                                                                             Example: Suppose that S = (2, 1, 3, 2, 1, 3, 1, 3, 1), so that L = 9 and N = 7. For the purpose of this
                                                                                             example, further suppose that D = 3 (instead of 16). After each iteration of step 4 is completed,
                                                                                             the values are:

                                                                                              i     subpredict           scoreboard         Winner             prediction        si       correcti-2   scoreboard
                                                                                                                         (step 4c)          (step 4c)                                                  (step 4e)
                                                                                              3     (Null, Null, Null)   (0, 0, 0)          1                  Null              3        0            (0, 0, 0)
                                                                                              4     (Null, Null, Null)   (0, 0, 0)          1                  Null              2        0            (0, 0, 0)
                                                                                              5     (1, Null, Null)      (0, 0, 0)          1                  1                 1        1            (1, 0, 0)
                                                                                              6     (3, 3, Null)         (1, 0, 0)          1                  3                 3        1            (2, 1, 0)
                                                                                              7     (2, 2, 2)            (2, 1, 0)          1                  2                 1        0            (2, 1, 0)
                                                                                              8     (3, Null, Null)      (2, 1, 0)          1                  3                 3        1            (3, 1, 0)
                                                                                              9     (2, 2, Null)         (3, 1, 0)          1                  2                 1        0            (3, 1, 0)

                                                                                             Let {x→y:c} denote a nonzero count c for the transition from x to y. Models M1, M2, and M3 are
                                                                                             shown below after step 4a (the model update step) for each value of i.




                                                                                                                                                      54
