                                                                                               NIST SP 800-177 REV. 1                                                         TRUSTWORTHY EMAIL




                                                                                               �e purpose of authenticating the sending domain is to guard against senders (both random and
                                                                                               malicious actors) from spooﬁng another’s domain and initiating messages with bogus content,
                                                                                               and against malicious actors from modifying message contents in transit. Sender Policy
                                                                                               Framework (SPF) is the standardized way for a sending domain to identify and assert the
                                                                                               authorized mail senders for a given domain. Domain Keys Identiﬁed Mail (DKIM) is the
                                                                                               mechanism for asserting sending servers and eliminating the vulnerability of man-in-the-middle
                                                                                               content modiﬁcation by using digital signatures generated from the sending mail server.

                                                                                               Domain based Message Authentication, Reporting and Conformance (DMARC) was conceived
                                                                                               to allow email senders to specify policy on how their mail should be handled, the types of
                                                                                               security reports that receivers can send back, and the frequency those reports should be sent.
                                                                                               Standardized handling of SPF and DKIM removes guesswork about whether a given message is
                                                                                               authentic, beneﬁtting receivers by allowing more certainty in quarantining and rejecting
                                                                                               unauthorized mail. In particular, receivers compare the “From” address in the message to the
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-177r1




                                                                                               SPF and DKIM results, if present, and the DMARC policy in the DNS. �e results are used to
                                                                                               determine how the mail should be handled. �e receiver sends reports to the domain owner about
                                                                                               mail claiming to originate from their domain. �ese reports should illuminate the extent to which
                                                                                               unauthorized users are using the domain, and the proportion of mail received that is “good.”

                                                                                               Man-in-the-middle attacks can intercept cleartext email messages as they are transmitted hop-by-
                                                                                               hop between mail relays. Any bad actor that can passively monitor network traﬃc can read such
                                                                                               mail as it travels from submission to delivery systems. Email message conﬁdentiality can be
                                                                                               assured by encrypting traﬃc along the path. �e Transport Layer Security Protocol (TLS) uses
                                                                                               an encrypted channel to protect message transfers from man-in-the-middle attacks. TLS relies on
                                                                                               the Public Key Infrastructure (PKI) system of X.509 certiﬁcates to carry exchange material and
                                                                                               provide information about the entity holding the certiﬁcate. �ese are usually generated by a
                                                                                               Certiﬁcate Authority (CA). �e global CA ecosystem has in recent years become the subject to
                                                                                               attack and has been successfully compromised more than once. One way to protect against CA
                                                                                               compromises is to use the DNS to allow domains to specify their intended certiﬁcates or vendor
                                                                                               CAs. Such uses of DNS require that the DNS itself be secured with DNSSEC. Correctly
                                                                                               conﬁgured deployment of TLS may not stop a passive eavesdropper from viewing encrypted
                                                                                               traﬃc but does practically eliminate the chance of deciphering it.

                                                                                               Server to server transport layer encryption also assures the integrity of email in transit, but
                                                                                               senders and receivers who desire end-to-end assurance, (i.e., mailbox to mailbox) may wish to
                                                                                               implement end-to-end, message-based authentication and conﬁdentiality protections. �e sender
                                                                                               may wish to digitally sign and/or encrypt the message content, and the receiver can authenticate
                                                                                               and/or decrypt the received message. Secure Multipurpose Internet Mail Extensions (S/MIME) is
                                                                                               the recommended protocol for email end-to-end authentication and conﬁdentiality. �is usage of
                                                                                               S/MIME is not common at the present time but is recommended. Certiﬁcate distribution remains
                                                                                               a signiﬁcant challenge when using S/MIME, especially the distribution of certiﬁcates between
                                                                                               organizations. Research is underway on protocols that will allow the DNS to be used as a
                                                                                               lightweight publication infrastructure for S/MIME certiﬁcates.

                                                                                               S/MIME is useful for authenticating email, since the protocol usually includes PKI certiﬁcates in
                                                                                               messages in order to authenticate them, avoiding the necessity of distributing the sender’s public

                                                                                                                                               v
