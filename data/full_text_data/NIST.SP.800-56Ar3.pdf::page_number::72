                                                                                               NIST SP 800-56A Rev. 3                              Recommendation for Pair-Wise Key Establishment
                                                                                                                                                           Using Discrete Logarithm Cryptography

                                                                                               participant), and the derived keying material shall not be used for any further purpose. In the
                                                                                               case of a key-confirmation failure, the key-agreement transaction shall be discontinued.
                                                                                               Unilateral key confirmation may be added in either direction to any of the C(2e, 2s), C(1e,
                                                                                               2s) and C(0e, 2s) schemes; it may also be added to the C(1e, 1s) schemes, but only when
                                                                                               party V (the party contributing the static key pair) is the key-confirmation provider, and party
                                                                                               U is the key-confirmation recipient. See the relevant subsections of Section 6.

                                                                                               5.9.2 Bilateral Key Confirmation for Key-Agreement Schemes
                                                                                               Bilateral key confirmation is an optional feature that can be incorporated into any key-
                                                                                               agreement scheme in which each party is required to own a static key-establishment key pair
                                                                                               that is used in the key-establishment process. Bilateral key confirmation is accomplished by
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                               performing unilateral key confirmation in both directions (with party U providing MacTagU
                                                                                               to recipient party V, and party V providing MacTagV to recipient party U) during the same
                                                                                               key-agreement transaction. If a party is not also required to contribute an ephemeral public
                                                                                               key to the key-establishment process, then that party shall instead contribute a nonce that is
                                                                                               used as part of the input to the key-derivation method employed by the scheme; the nonce
                                                                                               will also be used as part of the ephemeral data input to the MAC tag computations performed
                                                                                               during key conformation. See Section 5.4 for a discussion of the length and security strength
                                                                                               required for the nonce. Each party shall have an identifier, chosen in accordance with the
                                                                                               assumptions stated for the key-agreement scheme.
                                                                                               To include bilateral key confirmation, two instances of unilateral key confirmation (as
                                                                                               specified in Section 5.9.1, subject to the modifications listed below) shall be incorporated
                                                                                               into the scheme, once with party U as the key-confirmation provider (i.e., P = U and R = V)
                                                                                               and once with party V as the provider (i.e., P = V and R = U). Additional details will be
                                                                                               provided for each scheme in the appropriate subsections of Section 6.
                                                                                               In addition to setting P = U and R = V in one instance of the unilateral key-confirmation
                                                                                               procedure described in Section 5.9.1 and setting P = V and R = U in a second instance, the
                                                                                               following changes/clarifications apply when using the procedure for bilateral key
                                                                                               confirmation:
                                                                                                  1. When computing MacTagU, the value of the six-byte message_stringU that forms the
                                                                                                     initial segment of MacDataU is “KC_2_U”.
                                                                                                  2. When computing MacTagV, the value of the six-byte message_stringV that forms the
                                                                                                     initial segment of MacDataV is “KC_2_V”.
                                                                                                  3. If used at all, the value of the (optional) byte string TextU used to form the final
                                                                                                     segment of MacDataU can be different than the value of the (optional) byte string
                                                                                                     TextV used to form the final segment of MacDataV, provided that both parties are
                                                                                                     aware of the value(s) used.
                                                                                               Bilateral key confirmation may be added to the C(2e, 2s), C(1e, 2s) and C(0e, 2s) schemes,
                                                                                               as specified in the relevant subsections of Section 6.




                                                                                                                                             61
