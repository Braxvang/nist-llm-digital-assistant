                                                                                               NIST SP 800-56A Rev. 3                                       Recommendation for Pair-Wise Key Establishment
                                                                                                                                                                    Using Discrete Logarithm Cryptography

                                                                                               5.7.2.1.1 MQV2 Form of the FFC MQV Primitive
                                                                                               This form of invoking the FFC MQV primitive is used in Section 6.1.1.3 by the MQV2
                                                                                               scheme. In this form, each party uses both a static key pair and an ephemeral key pair.
                                                                                               Assume that the party performing the computation is party A, and the other party is party B.
                                                                                               Note that party A could be either party U or party V.
                                                                                               In this form, one’s own second private and public keys (items 4 and 5 of the input list in
                                                                                               Section 5.7.2.1) are one’s own ephemeral private and public keys (rA and tA), and the other
                                                                                               party’s second public key (item 6 in Section 5.7.2.1) is the other party’s ephemeral public
                                                                                               key (tB).

                                                                                               5.7.2.1.2 MQV1 Form of the FFC MQV Primitive
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                               This form of invoking the FFC MQV primitive is used in Section 6.2.1.3 by the MQV1
                                                                                               scheme. In this form, party U uses a static key pair and an ephemeral key pair, but party V
                                                                                               uses only a static key pair. One-Pass MQV uses the MQV primitive with party V’s static key
                                                                                               pair as the second key pair (as party V has no ephemeral key pair).
                                                                                               Party U uses party V’s static public key for the other party’s second public key; that is, when
                                                                                               party U uses the algorithm in Section 5.7.2.1, item 6 of the input list is party V’s static public
                                                                                               key (yB).
                                                                                               Party V uses his/her static private key for the second private key; that is, when party V uses
                                                                                               the algorithm in Section 5.7.2.1, item 4 of the input list is party V’s static private key xA, and
                                                                                               item 5 becomes his static public key (yA).

                                                                                               5.7.2.2 ECC MQV Associate Value Function
                                                                                               The associate value function is used by the ECC MQV family of key-agreement schemes to
                                                                                               compute an integer that is associated with an elliptic curve point. This Recommendation
                                                                                               defines avf(Q) to be the associate value function of a public key Q using the domain
                                                                                               parameters (q, FR, a, b{, SEED}, G, n, h).
                                                                                               Input:
                                                                                                  1. (q, FR, a, b{, SEED}, G, n, h): Domain parameters, and
                                                                                                  2. Q: A public key (that is, Q is a point in the subgroup of order n and not equal to the
                                                                                                      identity element Ø).
                                                                                               Process:
                                                                                                  1. Convert xQ to an integer xqi using the convention specified in Appendix C.3.
                                                                                                      2. Calculate
                                                                                                          xqm = xqi mod 2  f / 2 (where f = log 2 n ).

                                                                                                      3. Calculate the associate value function
                                                                                                          avf(Q) = xqm + 2  f / 2 . (See footnote25).

                                                                                               25
                                                                                                    Note that avf(Q) can be computed using only bit operations.

                                                                                                                                                      51
