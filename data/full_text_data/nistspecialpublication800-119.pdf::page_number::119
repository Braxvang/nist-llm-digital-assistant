                                                                 GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


Finally, some multicast issues, as noted above, remain open.

5.4   Secure Stateless Address Autoconfiguration and Neighbor Discovery

Security for autoconfiguration and neighbor discovery protocols has always been a difficult topic,
because it is naturally problematical to have pre-existing trust relationships with entities one has not yet
―discovered‖ or to use security before address configuration.

Attacks against address configuration and address resolution protocols include spoofing or hijacking
addresses, denial of service, propagating inaccurate information, forging unreachability conditions,
redirecting traffic, disabling routers, advertising bogus prefixes, misrepresenting network parameters, and
others. Most are directed at compromising the availability of the local network, but some may also target
confidentiality or integrity of information.

IPv4 networks have no means of stateless address autoconfiguration and perform neighbor discovery with
the Address Resolution Protocol (ARP). ARP has no cryptographic security mechanisms, and it has
always been subject to spoofing, cache poisoning, and denial-of-service attacks. Most installations cope
with this by restricting ARP to local links (it is inherently a non-routable Layer 2 protocol) and policing
the nodes on such local links. This has become increasingly difficult with wireless LANs. IPv6 neighbor
ND is implemented with ICMPv6, and it is both possible and desirable to make sure such messages are
not routed; since ND uses the ―All Nodes Addresses‖ link local multicast group, by default these
messages are not routed. It is also possible to apply cryptographic security to these messages.

The security requirements for autoconfiguration and ND vary according to the type of network used. For
a more detailed discussion and examples of this, see RFC 3756. For example:

 On a closed network within an enterprise, all users may trust each other to behave properly, and any
  malfunctioning nodes can be removed and corrected administratively. Cryptographically securing
  autoconfiguration and ND in this type of network may not be essential, but it could limit the damage
  that a corrupted (e.g. by malware) or malfunctioning node can do.
 In a college dormitory or on a network offering public access, for example, users depend on a
  trustworthy router to provide service, but they have little knowledge or control over what other users
  are doing. In this case, cryptographic authentication of autoconfiguration and ND represents a
  substantial improvement in robustness and security.
 In ad hoc networks, none of the nodes may start out trusting each other. In this case, it is likely that
  no basis for authentication exists, and there is no pre-existing key management infrastructure.
  Nevertheless, limited cryptographic protection can be provided.
IPv6 Autoconfiguration and ND use ICMPv6 messages to perform several different tasks. The main
ICMPv6 message types are:

 NS (Neighbor Solicitation)
 NA (Neighbor Advertisement)
 RS (Router Solicitation)
 RA (Router Advertisement)
 Redirect




                                                     5-17
