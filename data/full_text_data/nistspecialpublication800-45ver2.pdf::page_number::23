                                                                            GUIDELINES ON ELECTRONIC MAIL SECURITY



passwords for authentication, which can be intercepted by other hosts attached to the network. Section
2.4.4 briefly discusses the protocols used for Web-based mail access.

2.4.1   Post Office Protocol

POP was first developed in 1984. At its core, POP was nothing more than a way to copy messages from
the mail server mailbox to the mail client. It worked much like a traditional post office mailbox. The
mail client opens a connection to the mail server mailbox, downloads the email messages, and then closes
the connection. As described in RFC 918, only nine commands were originally available for POP (see
“Basic Commands” in Figure 2.5).


          Basic Commands from RFC 918
          USER <name>             Set username
          PASS <password>         Set password
          STAT                    Check the status of the mailbox, typically retrieves number of messages
          LIST [msg]              List messages in the mailbox; Optional argument for message [msg]
          RETR <msg>              Retrieve message <msg>
          DELE <msg>              Delete message <msg>
          QUIT                    Quit
          NOOP                    No operation
          RSET                    Reset

          Optional Commands from RFC 1939
          TOP <msg> <n>           Retrieve the top <n> lines of message <msg>
          UIDL [msg]              Retrieve unique id for [msg]
          APOP <name> <digest>    A more robust form of authentication than USER/PASS

          Extension Command from RFC 2449
          CAPA                    Retrieve a list of capabilities supported by the POP3 server


                                       Figure 2.5: POP3 Commands

Since 1984, POP has gone through several changes and is now in its third iteration as defined in RFC
1939. The basic command set is very similar to the command set of 1984; however, POP version 3 offers
a few new optional commands, listed in Figure 2.5. From a security standpoint, the addition of the APOP
was important, since it avoids transmitting a user’s password in the clear. Instead, a challenge/response
mechanism is used, by which the client responds with a cryptographic hash of the combined challenge
sent from the server and the user's password, for verification by a POP mail server performing the same
operation for the user in question.

RFC 2449, POP3 Extension Mechanism, defines an extension to POP3 that allows clients to discover
additional information about POP3 servers, such as which extensions and optional commands they
support. Figure 2.5 shows the command added to POP3 by the extension.

The POP mailbox access standard has some significant limitations. Typically, when users retrieve their
email, copies of the messages that reside on the server are deleted. This means that the user has the sole
responsibility of maintaining message archives. Although this may be acceptable for personal accounts, it
is generally unacceptable for most commercial or governmental organizations that have to meet certain
legal requirements. In addition, if a user employs several workstations for retrieving email, the messages
are dispersed on multiple hosts. POP may be configured so that the original messages are not deleted
from the server. However, the user will either have to download all of the messages previously viewed as


                                                      2-7
