                                                                                             NIST SP 800-189                                                               RESILIENT INTERDOMAIN TRAFFIC EXCHANGE:
                                                                                                                                                                                   BGP SECURITY & DDOS MITIGATION

                                                                                                       a maxlength, the prefix and the more-specific prefixes should be listed explicitly in
                                                                                                       multiple ROAs (i.e., one ROA per prefix or more-specific prefix). 7

                                                                                             4.4     Categories of Prefix Filters

                                                                                             BGP prefix filtering (also known as route filtering) is the most basic mechanism for protecting
                                                                                             BGP routers from accidental or malicious disruption [RFC7454]. Prefix filtering differs from
                                                                                             BGP-OV in that only the prefixes expected in a peering (e.g., customer) relationship are
                                                                                             accepted, and prefixes not expected—including bogons and unallocated—are rejected. Further,
                                                                                             origin validation is not a part of traditional prefix filtering, but it is complementary. Filtering
                                                                                             capabilities on both incoming prefixes (inbound prefix filtering) and outgoing prefixes (outbound
                                                                                             prefix filtering) should be implemented. Route filters are typically specified using a syntax
                                                                                             similar to that used for access control lists. One option is to list ranges of IP prefixes that are to
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-189




                                                                                             be denied and then permit all others. Alternatively, ranges of permitted prefixes can be specified,
                                                                                             and the rest denied. The choice of which approach to use depends on practical considerations
                                                                                             determined by system administrators. Typically, BGP peers should have matching prefix filters
                                                                                             (i.e., the outbound prefix filters of an AS should be matched by the inbound prefix filters of peers
                                                                                             that it communicates with). For example, if AS 64496 filters its outgoing prefixes towards peer
                                                                                             AS 64500 to permit only those in set P, then AS 64500 establishes incoming prefix filters to
                                                                                             ensure that the prefixes it accepts from AS 64496 are only those in set P.

                                                                                             Different types of prefix filters are described in the rest of Section 4.4, and their applicability is
                                                                                             described in the context of different peering relations in Section 4.5.

                                                                                             4.4.1     Unallocated Prefixes

                                                                                             The Internet Assigned Numbers Authority (IANA) allocates address space to RIRs. All the IPv4
                                                                                             address space (or prefixes), except for some reserved for future use, have been allocated by
                                                                                             IANA [IANA-v4-r]. The RIRs have also nearly fully allocated their IPv4 address space [IANA-
                                                                                             v4-r]. 8 The IPv6 address space is much larger than that of IPv4, and, understandably, the bulk of
                                                                                             it is unallocated. Therefore, it is a good practice to accept only those IPv6 prefix advertisements
                                                                                             that have been allocated by the IANA [IANA-v6-r]. Network operators should ensure that the
                                                                                             IPv6 prefix filters are updated regularly (normally, within a few weeks after any change in
                                                                                             allocation of IPv6 prefixes). In the absence of such regular updating processes, it is better not to
                                                                                             configure filters based on allocated prefixes. Team Cymru provides a service for updating bogon
                                                                                             prefix lists for IPv4 and IPv6 [Cymru-bogon].

                                                                                                       Security Recommendation 19: IPv6 routes should be filtered to permit only
                                                                                                       allocated IPv6 prefixes. Network operators should update IPv6 prefix filters regularly to
                                                                                                       include any newly allocated prefixes.

                                                                                             If prefix resource owners regularly register AS0 ROAs (see Section 4.3) for allocated (but
                                                                                             possibly currently unused) prefixes, then those ROAs could be a complementary source for the


                                                                                             7
                                                                                               In general, the use of maxlength should be avoided unless all or nearly all more-specific prefixes up to a maxlength are
                                                                                                   announced or intended to be announced [maxlength].
                                                                                             8
                                                                                               Some of the prefixes are designated for special use as discussed in Section 4.4.2.

                                                                                                                                                             17
