GUIDE TO INTRUSION DETECTION AND PREVENTION SYSTEMS (IDPS)



Stateful protocol analysis can identify unexpected sequences of commands, such as issuing the same
command repeatedly or issuing a command without first issuing a command upon which it is dependent.
Another state tracking feature of stateful protocol analysis is that for protocols that perform
authentication, the IDPS can keep track of the authenticator used for each session, and record the
authenticator used for suspicious activity. This is helpful when investigating an incident. Some IDPSs
can also use the authenticator information to define acceptable activity differently for multiple classes of
users or specific users.

The “protocol analysis” performed by stateful protocol analysis methods usually includes reasonableness
checks for individual commands, such as minimum and maximum lengths for arguments. If a command
typically has a username argument, and usernames have a maximum length of 20 characters, then an
argument with a length of 1000 characters is suspicious. If the large argument contains binary data, then
it is even more suspicious.

Stateful protocol analysis methods use protocol models, which are typically based primarily on protocol
standards from software vendors and standards bodies (e.g., Internet Engineering Task Force [IETF]
Request for Comments [RFC]). The protocol models also typically take into account variances in each
protocol’s implementation. Many standards are not exhaustively complete in explaining the details of the
protocol, which causes variations among implementations. Also, many vendors either violate standards
or add proprietary features, some of which may replace features from the standards. For proprietary
protocols, complete details about the protocols are often not available, making it difficult for IDPS
technologies to perform comprehensive, accurate analysis. As protocols are revised and vendors alter
their protocol implementations, IDPS protocol models need to be updated to reflect those changes.

The primary drawback to stateful protocol analysis methods is that they are very resource-intensive
because of the complexity of the analysis and the overhead involved in performing state tracking for
many simultaneous sessions. Another serious problem is that stateful protocol analysis methods cannot
detect attacks that do not violate the characteristics of generally acceptable protocol behavior, such as
performing many benign actions in a short period of time to cause a denial of service. Yet another
problem is that the protocol model used by an IDPS might conflict with the way the protocol is
implemented in particular versions of specific applications and operating systems, or how different client
and server implementations of the protocol interact.

2.4   Types of IDPS Technologies

There are many types of IDPS technologies. For the purposes of this document, they are divided into the
following four groups based on the type of events that they monitor and the ways in which they are
deployed:

 Network-Based, which monitors network traffic for particular network segments or devices and
  analyzes the network and application protocol activity to identify suspicious activity. It can identify
  many different types of events of interest. It is most commonly deployed at a boundary between
  networks, such as in proximity to border firewalls or routers, virtual private network (VPN) servers,
  remote access servers, and wireless networks. Section 4 contains extensive information on network-
  based IDPS technologies.
 Wireless, which monitors wireless network traffic and analyzes its wireless networking protocols to
  identify suspicious activity involving the protocols themselves. It cannot identify suspicious activity
  in the application or higher-layer network protocols (e.g., TCP, UDP) that the wireless network traffic
  is transferring. It is most commonly deployed within range of an organization’s wireless network to




                                                     2-6
