NIST SP 800-166                                                      DERIVED PIV APPLICATION AND
                                                                     DATA MODEL TEST GUIDELINES

 Precondition(s)             •   A token with the Derived PIV Application is inserted into an
                                 appropriate token reader.
                             •   Suitable drivers have been loaded between the test system and
                                 an instance of the reader.
                             •   A Security Object is present within the Derived PIV
                                 Application.
 Test Scenario               1. Send the SELECT command with
                                   • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                             2. Send the GET DATA command with
                                   • Data field of the command containing the tag
                                      ('5FC106') of the Security Object
                             3. Extract and parse the certificates field contents
                                from the Security Object.
                             4. Extract the value of the keyUsage extension from
                                the certificate.
 Expected Result(s)          1. From Step 1, the command returns the application property
                                template with the status word '90 00'.
                             2. From Step 2, the command the requested data object along with
                                the returns status word '90 00'.
                             3. From Step 4, the digitalSignature bit has been set. No other bits
                                have been set.

9.3.4.5 Certificate Policy

 Test Assertion              TA-09.03.04.05
 Purpose                     Verifies the Derived PIV Credential Issuer’s (content signing)
                             certificate asserts the appropriate certificate policy OID.
 DTR(s)                      • DTR-07.03.04.06
 Issuer Documentation        None.
 Precondition(s)             • A token with the Derived PIV Application is inserted into an
                                appropriate token reader.
                             • Suitable drivers have been loaded between the test system and
                                an instance of the reader.
                             • A Security Object is present within the Derived PIV
                                Application.
 Test Scenario               1. Send the SELECT command with
                                   • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                             2. Send the GET DATA command with
                                   • Data field of the command containing the tag
                                      ('5FC106') of the Security Object
                             3. Extract and parse the certificates field contents
                                from the Security Object.
                             4. Extract the value of the certificatePolicies
                                extension from the certificate.
 Expected Result(s)          1. From Step 1, the command returns the application property
                                template with the status word '90 00'.
                             2. From Step 2, the command the requested data object along with
                                the returns status word '90 00'.


                                              127
