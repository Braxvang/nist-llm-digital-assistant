NIST SP 800-85A-4                                          PIV CARD APPLICATION & MIDDLEWARE
                                                                    INTERFACE TEST GUIDELINES

                       2. The client application owns a connection to the PIV Card
                          Application accessible through cardHandle.
                       3. The client is logged into the PIV Card Application.
 Test Steps            1. Set cardHandle := <<valid cardHandle>>
                       2. Set OID := <<valid OID>> (Found in Table 3 of SP 800-73-4
                          Part 1 that is present but not used on the PIV Card
                       3. Create data reference
                       4. Call pivGetData with
                          • (IN) cardHandle
                          • (IN) OID
                          • (IN) oidLength
                          • (OUT) data
                          • (INOUT) DataLength
 Expected Result(s)    Call returns with status_word of PIV_DATA_OBJECT_NOT_FOUND and
                       does not initialize data reference.
 Postcondition(s)      The client application remains in the state it had before the call.


B.6.2.5         Security Conditions are Enforced for Secured Objects
 Purpose                Ensure that security conditions are enforced for retrieving data from
                        secured applications.
 Target                pivGetData
 Reference(s)          1. SP 800-73-4 Part 3, Section 3.2.4
                       2. AS04.06
 Precondition(s)       1. The client application currently owns a connection to the PIV
                          Card Application accessible through cardHandle.
                       2. The client application has successfully selected the PIV Card
                          Application.
                       3. The client is not logged into the PIV Card Application.
 Test Steps            1. Set cardHandle := <<valid cardHandle>>
                       2. Set OID := <<valid OID for each of the following objects:
                          Fingerprints, Facial Image, Printed Information, Iris
                          Images, and the Pairing Code Reference Data Container>>
                       3. Create data reference
                       4. Call pivGetData with (each data object identified in step
                          2)
                          • (IN) cardHandle
                          • (IN) OID
                          • (IN) oidLength
                          • (OUT) data
                          • (INOUT) DataLength
 Expected Result(s)    Call returns with status_word of
                       PIV_SECURITY_CONDITION_NOT_SATISFIED and does not set data
                       reference.
 Postcondition(s)      The client application remains in the state it had before the call.




                                       B-17
