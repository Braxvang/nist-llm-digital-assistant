                                                                                              NIST SP 800-77 REV. 1                                                           GUIDE TO IPSEC VPNS


                                                                                                     since the header fields are used to correctly process and deliver the data as it traverses the
                                                                                                     internet.
                                                                                                 •   ESP can be used in transport mode and tunnel mode.
                                                                                                         o In tunnel mode, ESP provides encryption (or null encryption) and integrity
                                                                                                           protection for an encapsulated IP packet, as well as integrity protection for the
                                                                                                           ESP header of the outer (constructed) IP packet.
                                                                                                         o In transport mode, ESP provides encryption (or null encryption) and integrity
                                                                                                           protection for the payload of the IP packet, as well as integrity protection for the
                                                                                                           ESP header. Transport mode is not compatible with NAT. Transport mode can
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                                           only be used for host-to-host deployments. It is commonly used for large-scale
                                                                                                           host-to-host mesh deployments within an administrative domain without NAT.
                                                                                                 •   ESP in tunnel mode is the most commonly used IPsec mode because it can encrypt the
                                                                                                     entire original IP packet, which conceals the true source and destination of the packet.
                                                                                                     ESP in tunnel mode is a requirement for gateway-to-gateway communications. ESP in
                                                                                                     tunnel mode can be encapsulated in UDP and TCP, making it compatible with NAT.
                                                                                                 •   ESP can add padding to packets and send dummy packets, further complicating attempts
                                                                                                     to perform traffic analysis.
                                                                                                 •   ESP can use IPComp but rarely does because the gains made from data compression
                                                                                                     depend strongly on the type of traffic sent. Applications sending a lot of data typically
                                                                                                     compress their data before providing it to the lower layers for transmission. Applying
                                                                                                     IPComp to already compressed data would waste CPU power.
                                                                                                 •   AH has been obsoleted and should not be implemented or deployed. If encryption is
                                                                                                     undesirable, ESP with null encryption (ESP-NULL) or AES-GMAC should be used
                                                                                                     instead of AH.




                                                                                                                                               46
