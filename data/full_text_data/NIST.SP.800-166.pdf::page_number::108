NIST SP 800-166                                                       DERIVED PIV APPLICATION AND
                                                                      DATA MODEL TEST GUIDELINES

                               signatureAlgorithm is in accordance with Table 3-3 of [SP800-
                               78].

9.2.1.9 Digital Signature

 Test Assertion             TA-09.02.01.09
 Purpose                    Verifies that the signature in the SignerInfo corresponds to the
                            Security Object and that it is signed with the Derived PIV
                            Credential Issuer’s (content signing) certificate.
 DTR(s)                     • DTR-07.02.01.11
 Issuer Documentation       None.
 Precondition(s)            • A token with the Derived PIV Application is inserted into an
                               appropriate token reader.
                            • Suitable drivers have been loaded between the test system and
                               an instance of the reader.
                            • A Security Object is present within the Derived PIV
                               Application.
 Test Scenario              1. Send the SELECT command with
                                  • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                            2. Send the GET DATA command with
                                  • Data field of the command containing the tag
                                     ('5FC106') of the Security Object
                            3. Extract the contents of the Security Object
                               asymmetric signature (TAG 0xBB).
                            4. Extract and parse the certificates field contents
                               from the Security Object.
                            5. Using the certificate extracted from the asymmetric
                               signature block, verify the signature of the
                               Security Object.
 Expected Result(s)         1. From Step 1, the command returns the application property
                               template with the status word '90 00'.
                            2. From Step 2, the command returns the requested data object
                               along with the status word '90 00'.
                            3. From Step 5, the certificates field of the SignedData contains
                               the Derived PIV Credential Issuer’s (content signing)
                               certificate, which is used to verify the digital signature on the
                               Security Object.




                                             101
