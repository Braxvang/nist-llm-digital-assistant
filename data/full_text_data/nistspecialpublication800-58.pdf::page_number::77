NIST SP 800-58                                              Voice Over IP Security
_____________________________________________________________________________




 9.4   Better Scheduling Schemes

       The incorporation of AES or some other speedy encryption algorithm could help
       temporarily alleviate the bottleneck, but this is not a scalable solution because it
       does not address the highest degree cause of the slowdown. Without a way for
       the crypto-engine to prioritize packets, the engine will still be susceptible to DoS
       attacks and starvation from data traffic impeding the time-urgent VOIP traffic. A
       few large packets can clog the queue long enough to make the VOIP packets over
       150 ms late (sometimes called head-of-line blocking), effectively destroying the
       call. Ideally, the crypto-engine would implement QoS scheduling to favor the
       voice packets, but this is not a realistic scenario due to speed and compactness
       constraints on the crypto-engine. One solution implemented in the latest routers
       is to schedule the packets with QoS in mind prior to the encryption phase.
       Although this heuristic solves the problem for all packet poised to enter the crypto
       engine at a given time, it does not address the problem of VOIP packets arriving
       at a crypto–engine queue that is already saturated with previously scheduled data
       packets. QoS prioritizing can also be done after the encryption process provided
       your encryption procedures preserve the ToS bits from the original IP header in
       the new IPsec header. This functionality is not guaranteed and is dependent on
       one’s network hardware and software, but if it is implemented it allows for QoS
       scheduling to be used at every hop the encrypted packets encounter. There are
       security concerns any time information on the contents of a packet is left in the
       clear, including this ToS-forwarding scheme, but with the sending and receiving
       addresses concealed, this is not as egregious as a cursory glance would make it
       seem. Still neither the pre-encryption or post-encryption schemes actually
       implement QoS or any other prioritizing scheme to enhance the crypto-engine’s
       FIFO scheduler. Speed and compactness constraints on this device may not allow
       such algorithms to be applied for some time.

 9.5   Compression of Packet Size

       A novel approach to the QoS issues associated with VOIPsec is proposed by
       Barbieri et al. at the conclusion of their studies of VOIPsec traffic. Their solution
       targets the increase in packet size stemming from the use of IPsec. They
       implemented cIPsec: a version of IPsec that compresses the internal header of a
       packet down to approximately four bytes. This is possible because much of the
       data in the internal headers of a packet remained constant or was duplicated in the
       outer header.

       The initial test results reported from the University of Milan indicate that the
       compression of IPsec headers results in bandwidth usage comparable to that of
       plain IP. This in turn results in considerably less jitter, latency, and better crypto-
       engine performance. The crypto-engine performance also improves. There is,
       of course, a price for these speedups. The compression scheme puts more strain
       on the CPU and memory capabilities of the endpoints in order to achieve the


72
