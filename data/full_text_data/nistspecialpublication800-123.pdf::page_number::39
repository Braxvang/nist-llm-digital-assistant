                                                                              GUIDE TO GENERAL SERVER SECURITY



server software permits administrators to select from multiple log formats, such as proprietary, database,
and delimiter-separated.

If a server supports the execution of programs, scripts, or plug-ins, it may be necessary for the programs,
scripts, or plug-ins to perform additional logging. Often, critical events take place within the application
code itself and will not be logged by the server. If server administrators develop or acquire application
programs, scripts, or plug-ins, it is strongly recommended that they define and implement a
comprehensive and easy-to-understand logging approach based on the logging mechanisms provided by
the server host OS. Log information associated with programs, scripts, and plug-ins can add significantly
to the typical information logged by the server and may prove invaluable when investigating events.

Ensuring that sufficient log capacity is available is a concern because logs often take considerably more
space than administrators initially estimate, especially when logging is set to a highly detailed level.
Administrators should closely monitor the size of the log files when they implement different logging
settings to ensure that the log files do not fill up the allocated storage. Because of the size of the log files,
removing and archiving the logs more frequently or reducing the logging level of detail may be necessary.

Some server programs provide a capability to enforce or disable the checking of specified access controls
during program startup. This level of control may be helpful, for example, to avoid inadvertent alteration
of log files because of errors in file access administration. Server administrators should determine the
circumstances under which they may wish to enable such checks (assuming the server software supports
this feature).

All servers should use time synchronization technologies, such as the Network Time Protocol (NTP), to
keep their internal clocks synchronized with an accurate time source. This provides accurate timestamps
for logs.

6.1.2   Reviewing and Retaining Log Files

Reviewing log files is a tedious and time-consuming task that informs administrators of events that have
already occurred. Accordingly, files are often useful for corroborating other evidence, such as a CPU
utilization spike or anomalous network traffic reported by an IDPS. When a log is used to corroborate
other evidence, a focused review is in order. For example, if an IDPS reported a suspicious outbound
FTP connection from a Web server at 8:17 a.m., then a review of the logs generated around 8:17 a.m. is
appropriate. Server logs should also be reviewed for indications of attacks. The frequency of the reviews
depends on the following factors:

 Amount of traffic the server receives

 General threat level (certain servers receive many more attacks than other servers and thus should
  have their logs reviewed more frequently)

 Specific threats (at certain times, specific threats arise that may require more frequent log file
  analysis)

 Vulnerability of the server

 Value of data and services provided by the server.

Reviews should take place regularly (e.g., daily) and when a suspicious activity has been noted or a threat
warning has been issued. Obviously, the task could quickly become burdensome to a server



                                                      6-2
