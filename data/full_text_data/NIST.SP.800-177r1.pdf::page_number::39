                                                                                               NIST SP 800-177 REV. 1                                                           TRUSTWORTHY EMAIL




                                                                                               headers, usually related to legitimate activities such as operating mailing lists, mail groups, and
                                                                                               end-user mail forwarding. It should be noted that mail server forwarding changes the source IP
                                                                                               address, and without rewriting the envelope-From: address, this can make SPF checks fail. On
                                                                                               the other hand, header rewriting, or adding a footer to mail content, may cause the DKIM
                                                                                               signature to fail. Both of these interventions can cause problems for DKIM validation and for
                                                                                               message delivery. Section 4.6 expands on the problems of mail forwarding, and its mitigations.

                                                                                               SPF, DKIM and DMARC authenticate that the sending MTA is an authorized, legitimate sender
                                                                                               of email messages for the domain-part of the envelope-From: (and message-From: for DMARC)
                                                                                               address, but these technologies do not verify that the email message is from a speciﬁc individual
                                                                                               or logical account. �at kind of assurance is provided by end-to-end security mechanisms such as
                                                                                               S/MIME (or OpenPGP). �e DKIM and S/MIME/OpenPGP signature standards are not-
                                                                                               interfering: DKIM signatures go in the email header, while S/MIME/OpenPGP signatures are
                                                                                               carried as MIME body parts. �e signatures are also complementary: a message is typically
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-177r1




                                                                                               signed by S/MIME or OpenPGP immediately after it is composed, typically by the sender’s
                                                                                               MUA, and the DKIM signature is added after the message passes through the sender’s MSA or
                                                                                               MTA.

                                                                                               �e interrelation of SPF, DKIM, DMARC, and S/MIME signatures are shown in the Figure 4-1
                                                                                               below:




                                                                                                                                                26
