                                                                                             NIST SP 800-90B                                            RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                USED FOR RANDOM BIT GENERATION

                                                                                             5.1.10 Covariance Test Statistic

                                                                                             The covariance test measures the strength of the lagged correlation. The test takes a lag value p <
                                                                                             L as input. The test statistic is calculated as follows:

                                                                                                   1. Initialize T to zero.
                                                                                                   2. For i = 1 to L – p
                                                                                                          T=T+(s i ×s i + p ).

                                                                                             Example 10: Let the input data be (5, 2, 6, 10, 12, 3, 1), and let p be 2. T is calculated as (5×6) +
                                                                                             (2×10) + (6×12) + (10×3) + (12×1) = 164.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                             Handling binary data: To test binary input data, first apply Conversion I to the input sequence.

                                                                                             The test is repeated for five different values of p: 1, 2, 8, 16, and 32.

                                                                                             5.1.11 Compression Test Statistic

                                                                                             General-purpose compression algorithms are well adapted for removing redundancy in a character
                                                                                             string, particularly involving commonly recurring subsequences of characters. The compression
                                                                                             test statistic for the input data is the length of that data subset after the samples are encoded into a
                                                                                             character string and processed by a general-purpose compression algorithm. The compression test
                                                                                             statistic is computed as follows:

                                                                                                   1. Encode the input data as a character string containing a list of values separated by a single
                                                                                                      space, e.g., “S = (144, 21, 139, 0, 0, 15)” becomes “144 21 139 0 0 15”.
                                                                                                   2. Compress the character string with the bzip2 compression algorithm provided in [BZ2].
                                                                                                   3. T is the length of the compressed string, in bytes.
                                                                                             Handling binary data: The test can be applied directly to binary data, with no conversion required.

                                                                                             5.2     Additional Chi-square Statistical Tests

                                                                                             This section includes additional chi-square statistical procedures to test independence and
                                                                                             goodness-of-fit. The independence tests attempt to discover dependencies in the probabilities
                                                                                             between successive samples in the (entire) sequence submitted for testing (see Section 5.2.1 for
                                                                                             non-binary data and Section 5.2.3 for binary data); the goodness-of-fit tests attempt to discover a
                                                                                             failure to follow the same distribution in ten data subsets produced from the (entire) input sequence
                                                                                             submitted for testing (see Section 5.2.2 for non-binary data and Section 5.2.4 for binary data). The
                                                                                             length of the longest repeated substring test is provided in Section 5.2.5.

                                                                                             5.2.1    Testing Independence for Non-Binary Data

                                                                                             Given the input S = (s1, …, sL), where si ϵ A = {x1, …, xk}, the following steps are initially performed
                                                                                             to determine the number of bins nbin needed for the chi-square tests.



                                                                                                                                               35
