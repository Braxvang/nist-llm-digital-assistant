NIST SP 800-85A-4                                           PIV CARD APPLICATION & MIDDLEWARE
                                                                     INTERFACE TEST GUIDELINES

                              • (INOUT) connectionDescription
                              • (INOUT) CDLength
                              • (OUT) cardHandle
 Expected Result(s)      Call returns with status_word of PIV_CONNECTION_FAILURE.
 Postcondition(s)        1. The client application previously connected remains connected.
                         2. The cardHandle variable is not initialized.
                         3. The requesting client application is not connected to the PIV Card
                            Application.


B.1.2.4          Attempting to Open an Unsupported Connection
 Purpose               Confirm that the PIV Middleware returns the correct status word
                       when an unsupported connection mode is attempted.
 Target                  pivConnect
 Reference(s)            1. SP 800-73-4 Part 3, Section 3.1.2
                         2. AS04.01, AS04.02, AS04.02A-R4
 Precondition(s)         1. An invalid connection mode (e.g., Integrated Services Digital
                            Network (ISDN)) is attempted.
                         2. There exists a valid physical connection between an instance of
                            the PIV Card and the client application.
 Test Steps              1. Set sharedConnection := true | false
                         2. Set connectionDescription := <<valid ISDN connection
                            string>>
                         3. Create cardHandle reference
                         4. Call pivConnect with
                            • (IN) sharedConnection
                            • (INOUT) connectionDescription
                            • (INOUT) CDLength
                            • (OUT) cardHandle
 Expected Result(s)      Call returns with status_word of PIV_CONNECTION_FAILURE.
 Postcondition(s)        1. The cardHandle variable is not initialized.
                         2. The client application is not connected to the PIV Card.


B.2           pivDisconnect

B.2.1           Valid Test Assertions

B.2.1.1          Disconnect an Exclusive Connection
 Purpose                Ensure that the PIV Middleware closes a currently open exclusive
                        PIV Card Application connection.
 Target                  pivDisconnect
 Reference(s)            1. SP 800-73-4 Part 3, Section 3.1.3
                         2. AS04.01, AS04.02A-R4, AS04.03




                                          B-4
