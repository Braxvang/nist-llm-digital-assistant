NIST SP 800-166                                                 DERIVED PIV APPLICATION AND
                                                                DATA MODEL TEST GUIDELINES

                                • Data field of the command containing the tag
                                  ('5FC105') of the X.509 Certificate for
                                  Derived PIV Authentication data object.
                         3. Send the VERIFY command with
                               • P2, key reference value, is set to '80'
                               • Data field of the command will contain the
                                  correct Derived PIV Application Password,
                                  padded with 'FF' (if necessary) to complete
                                  the total length of the value to 8 bytes
                         4. Send the GENERAL AUTHENTICATE command
                               • CLA is set to:
                                   1. '00' if command chaining is not needed or
                                      '10' if command chaining is used. (The
                                      last chain of the command sets CLA to
                                      '00')
                               • P1, algorithm reference, is set to '07' or
                                  '11'.
                                  P2, key reference, is set to '9A' indicating
                                  the Derived PIV Authentication Key
                               • Data field in the command is to include '81'
                                  specifying a challenge, followed by a
                                  randomly generated challenge, and '82 00' in
                                  order to request a response
                         5. Verify the signature obtained in Step 4 using the
                            subject public key from the certificate.
 Expected Result(s)      1. From Step 1, the command returns the application property
                            template with the status word '90 00'.
                         2. From Step 2, the command returns the requested data object
                            along with status word '90 00'.
                         3. From Step 3, the command returns the status word '90 00'.
                         4. From Step 4, the command returns the signed challenge with
                            the status word '90 00'.
                         5. From Step 5, the private key corresponds to the public key
                            contained in the certificate as the signature verification
                            succeeds.

9.3.1.8 UUID in the subjectAltName

 Test Assertion          TA-09.03.01.08
 Purpose                 Verifies that a UUID is populated in the subjectAltName field of
                         the Derived PIV Authentication certificate.
 DTR(s)                  • DTR-07.03.01.07
 Issuer Documentation    None.
 Precondition(s)         • A token with the Derived PIV Application is inserted into an
                            appropriate token reader.
                         • Suitable drivers have been loaded between the test system and
                            an instance of the reader.
                         • A Derived PIV Authentication certificate is present within the
                            Derived PIV Application.


                                         107
