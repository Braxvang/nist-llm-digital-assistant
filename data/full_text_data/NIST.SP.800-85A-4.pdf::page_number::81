NIST SP 800-85A-4                                         PIV CARD APPLICATION & MIDDLEWARE
                                                                   INTERFACE TEST GUIDELINES

                               Image, and Cardholder Iris Images and does not set the data
                               reference.
 Postcondition(s)       The client application is logged off of the PIV Card Application.
                        Only “free read” data can be read.


B.6.2           Test Assertions for Error Conditions

B.6.2.1          Identify and Handle an Invalid cardHandle
 Purpose                 Ensure the PIV Middleware recognizes and handles an invalid
                         cardHandle.
 Target                 pivGetData
 Reference(s)           1. SP 800-73-4 Part 3, Section 3.2.4
                        2. AS04.06
 Precondition(s)        1. The client application owns a connection to the PIV Card
                           Application accessible through cardHandle.
                        2. The client application has successfully selected the PIV Card
                           Application.
                        3. The client application is not logged into the PIV Card
                           Application.
 Test Steps             1. Set cardHandle := <<invalid cardHandle>>
                        2. Set OID := <<valid OID>>
                        3. Create data reference
                        4. Call pivGetData with
                           • (IN) cardHandle
                           • (IN) OID
                           • (IN) oidLength
                           • (OUT) data
                           • (INOUT) DataLength
 Expected Result(s)     Call returns with status_word of PIV_INVALID_CARD_HANDLE and does
                        not initialize data reference.
 Postcondition(s)       The precondition states remain unchanged.


B.6.2.2       Identify and Handle an Invalid Object Identifier
 Purpose              Ensure the PIV Middleware recognizes and handles an invalid OID.
 Target               pivGetData
 Reference(s)         1. SP 800-73-4 Part 3, Section 3.2.4
                      2. AS04.06
 Precondition(s)      1. The client application owns a connection to the PIV Card
                         Application accessible through cardHandle.
                      2. The client application is logged into the PIV Card Application.
 Test Steps           1. Set cardHandle := <<valid cardHandle>>
                        2. Set OID := <<invalid OID>> (Improper syntax or not found
                           in Table 3 of SP 800-73-4 Part 1)



                                         B-15
