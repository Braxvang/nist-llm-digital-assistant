                               Federal S/MIME V3 Client Profile


   •   S/MIME implementations MUST be able to process both multipart/signed (i.e., "clear")
       and application/pkcs7-signature MIME Type (i.e., "opaque") signed messages.
   •   S/MIME implementations MUST be able to acquire certificates by extracting certificates
       from incoming signed messages.
   •   S/MIME implementations MUST handle unknown attributes gracefully by accepting the
       message and informing the user.
   •   S/MIME implementations MUST be able to construct a certification path for the sender’s
       signature certificate, including CRLs, using LDAP. This is further described in Clause
       2.4.4. below.
   •   S/MIME implementations MUST validate the certification path where the end certificate
       is the sender’s signature certificate or reject the certificate.
   •   Whenever an S/MIME implementation indicates the signature on a message is valid, that
       implementation MUST display an authenticated name (e.g., the subject name or a
       subjectAltName) from the signer’s certificate.
   •   S/MIME implementations MUST compare the SubjectAltName.rfc822Name or PKCS#9
       emailAddress in the signer's certificate with the actual e-mail address used in the received
       message's “From” or “Sender” field (See [RFC3280] and [RFC2632].).
       1. If the addresses do not match or the certificate does not contain any e-mail addresses,
            the S/MIME implementation MUST display information to the user to allow the user
            to accept or reject the message. This information MUST be displayed the first time
            that an e-mail message arrives with a unique pair of “From” address and signer
            certificate.
       2. To avoid continual display of information in environments where certificates either
            do not contain e-mail address, or there are frequent mismatches between e-mail
            addresses used in the “From” field of RFC822 messages and those in the signer’s
            certificate, the implementation SHOULD allow the user the option of suppressing
            further display of information on subsequent messages received with the same unique
            pair of “From” address and signer certificate.
       3. The implementation MUST clearly differentiate between authenticated names (from
            the signer’s certificate) and unauthenticated names (e.g., the rfc822 “phrase” in
            “mailbox” in the address specification in the “From” field) when displaying signature
            validation information.
   •   S/MIME implementations MUST be able to generate return signed receipt messages as
       specified in [RFC2634]. Signed receipts SHOULD be sent to the entities named in the
       receiptsTo field of the receipt request according to the processing described in Section 2
       of [RFC2634]. Note: As specified in [RFC2634], this processing may cause modification
       in determining if return signed receipts should be sent according to the value of the
       mlExpansionHistory attribute (if any) contained in received messages.

2.3.3 Receiving Encrypted Messages
    • S/MIME implementations MUST be able to process encrypted messages. This includes
      recovering the symmetric key and using the key to decrypt the message.
    • S/MIME implementations MUST be able to process messages for one or more recipients.
    • Receiving agents SHOULD allow a transparent selection of the appropriate private key
      for decryption of an incoming message when the recipient has multiple certificates (each
      associated with a private key) used for key management.


                                            8
