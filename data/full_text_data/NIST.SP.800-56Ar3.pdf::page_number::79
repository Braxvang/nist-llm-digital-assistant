                                                                                               NIST SP 800-56A Rev. 3                             Recommendation for Pair-Wise Key Establishment
                                                                                                                                                          Using Discrete Logarithm Cryptography

                                                                                                  4. If key confirmation is used, the parties have also agreed upon an approved MAC and
                                                                                                     associated parameters, including the lengths of MacKey and MacTag, as specified in
                                                                                                     Section 5.9.3).
                                                                                                  5. Prior to or during the key-agreement process, each party receives the other party’s
                                                                                                     static public key in a trusted manner (e.g., from a certificate signed by a trusted CA
                                                                                                     or directly from the other party, who is trusted by the recipient). Each party has
                                                                                                     obtained assurance of the validity of the other party’s static public key as specified in
                                                                                                     Section 5.6.2.2.
                                                                                                  6. The recipient of a static public key has obtained assurance that its (claimed) owner is
                                                                                                     (or was) in possession of the corresponding static private key, as specified in Section
                                                                                                     5.6.2.2.3.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                                  7. When an identifier is used to label a party during the key-agreement process, that
                                                                                                     identifier has a trusted association to that party’s static public key. (In other words,
                                                                                                     whenever both the identifier and static public key of one participant are employed in
                                                                                                     the key-agreement process, they are associated in a manner that is trusted by the other
                                                                                                     participant.) When an identifier is used to label a party during the key-agreement
                                                                                                     process, both parties are aware of the identifier employed for that purpose.

                                                                                               6.1.1.1 dhHybrid1, C(2e, 2s, FFC DH) Scheme
                                                                                               This section describes the dhHybrid1 scheme. Assurance of secure key establishment using
                                                                                               this scheme can only be obtained when the assumptions in Section 6.1.1 are true. In
                                                                                               particular, it is assumed that party U has obtained the static public key yV of party V, and
                                                                                               party V has obtained the static public key yU of party U.
                                                                                               With the exception of key derivation, the dhHybrid1 scheme is “symmetric” in the actions
                                                                                               of parties U and V. Only the actions performed by party U are specified here; a specification
                                                                                               of the actions performed by party V may be obtained by systematically replacing the letter
                                                                                               “U” by “V” (and vice versa) in the actions listed below. Note, however, that parties U and V
                                                                                               must use identical orderings of the bit strings that are input to the key-derivation method.
                                                                                               Party U shall execute the following actions to a) establish a shared secret value Z with party
                                                                                               V, and b) derive secret keying material from Z.
                                                                                               Actions: Party U generates a shared secret and derives secret keying material as follows:
                                                                                                  1. Generate an ephemeral key pair (rU, tU) from the domain parameters D as specified in
                                                                                                     Section 5.6.1.1. Send the public key tU to party V. Receive an ephemeral public key
                                                                                                     tV (purportedly) from party V. If tV is not received, destroy the ephemeral private key
                                                                                                     rU, then output an error indicator, and exit this process without performing the
                                                                                                     remaining actions.
                                                                                                  2. Verify that tV is a valid ephemeral public key for the parameters D as specified in
                                                                                                     Section 5.6.2.3. If assurance of public key validity cannot be obtained, destroy the
                                                                                                     ephemeral private key rU; then, output an error indicator, and exit this process without
                                                                                                     performing the remaining actions.
                                                                                                  3. Use the FFC DH primitive in Section 5.7.1.1 to derive a shared secret Zs from the set
                                                                                                     of domain parameters D, party U’s static private key xU, and party V’s static public
                                                                                                                                            68
