                                                                   GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


        Traffic Class. Traffic class indicates the type of traffic or service. This eight-bit value is the
         same as type of service (TOS) in IPv4 and tags packets for special treatment during
         transmission. RFC 2474, Definition of the Differentiated Services Field (DS Field) in the IPv4
         and IPv6 Headers, describes how the Traffic Class field in IPv6 can be used. The Traffic
         Class field in the IPv6 header is referred to as the Differentiated Services (DS) field in RFC
         2474, as well as the TOS field in the IPv4 header.

        Flow Label. This is a 20-bit value used to identify packets belonging to the same flow or
         stream of data. It plays an important role in Quality of Service (QoS) differentiation under
         IPv6 (discussed in Section 4.3).

        Payload Length. Payload length is the length of data carried after the fixed IPv6 header.
         This 16-bit field identifies the length of the payload to which the 40-byte header is attached.
         The Payload Length field represents the payload length as an unsigned integer with a
         maximum value of 65535, so the maximum length is 40 + 65535 = 65575. (This limit can be
         extended with the Jumbogram Hop-by-Hop Option discussed in Section 4.5.)

        Next Header. Next Header (NH) contains a protocol number for an extension header or upper
         layer protocol. Called the Protocol Type field in IPv4, the NH field is part of a chain of
         headers. See Section 3.4 for a complete description.

        Hop Limit. Hop Limit defines the maximum number of hops a packet can transit, the same as
         the Time to Live (TTL) field in IPv4. (The IPv4 TTL was originally defined as a number of
         seconds, but it almost always means hop count.) Intermediate nodes decrement this unsigned
         eight-bit value by one for each node the packet traverses. For example, if a packet source sets
         the Hop Limit to four and there are four routers and five hops in the path between source and
         destination, the packet is discarded by the fourth router. That packet never reaches the
         destination, because the packet has a hop limit value of zero after being processed by the
         fourth router. Generalized TTL Security Mechanism (GTSM) is designed to protect a router
         or host’s TCP/IP (Transmission Control Protocol/Internet Protocol) based control plane from
         various attacks originating off of the local link. It is a simple security mechanism that avoids
         these remote attacks by requiring a maximum TTL or Hop Limit for incoming packets. Any
         packets from a remote attacker would have to travel through at least one intervening router,
         would have a lower-than-maximum TTL or Hop Limit (255 hops), and would be dropped on
         receipt. This mechanism based on an expected TTL value can provide a simple and
         reasonable defense against infrastructure attacks based on forged protocol packets from
         external sources. This is further described in RFC 5082.

        Source Address. This is a 128-bit value representing the unicast IPv6 address of the packet’s
         source. IPv6 addressing is discussed in Section 3.1.

        Destination Address. This is a 128-bit value representing the IPv6 address of the packet’s
         destination. It may be a unicast, multicast, or anycast address.

A packet capture of an IPv6 header is illustrated in Figure 3-7.




                                                    3-17
