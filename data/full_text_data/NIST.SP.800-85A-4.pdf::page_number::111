NIST SP 800-85A-4                               PIV CARD APPLICATION & MIDDLEWARE
                                                         INTERFACE TEST GUIDELINES

                             •   P2, key reference value is set to '80'
                             •   Data field of the command will contain the
                                 correct PIV Card Application PIN value, padded
                                 with 'FF' to complete the total length of the
                                 value to 10 bytes
                          8. Send VERIFY card command with
                              • P2, key reference value is set to '80'
                              • Data field of the command will contain the
                                 correct PIV Card Application PIN value, padded
                                 to 8 bytes with 'FF' in byte 7 and 'AA' in
                                 byte 8
                          9. Send VERIFY card command with
                              • P2, key reference value is set to '80'
                              • Data field of the command will contain an
                                 arbitrary 6-digit PIV Card Application PIN
                                 value where the first byte is 0x5A and all
                                 other non-padded bytes contain values limited
                                 to 0x30 – 0x39, padded with 'FF' to complete
                                 the total length of the value to 8 bytes
                          9a. Repeat step 9 five times with byte positions 2,
                               3, 4, 5, and 6 containing the 0x5A byte,
                               respectively.
                                   Note: It may be necessary to send the VERIFY
                                   command with a correct PIV Card Application
                                   PIN in order to prevent the retry counter
                                   from decrementing to zero.
                          10. Send VERIFY card command repeatedly, until after
                              the issuer specified maximum number of PIN tries
                              is exceeded with
                              • P2, key reference value is set to '80'
                              • Data field of the command will contain an
                                 arbitrary, but correctly formatted, PIN value
                                 other than what is obtained from the vendor,
                                 padded with 'FF' to complete the total length
                                 of the value to 8 bytes
                    2b.   Test case for implementations that support the Global
                          PIN ('00') for PIV data access and command execution
                           1. Send GET DATA command with
                              • Data field of the command containing the tag
                                 of the Cardholder Fingerprints data object
                           2. Send VERIFY card command with
                              • P2, key reference value is set to '00'
                              • Data field of the command will contain the
                                 correct Global PIN value, padded with 'FF' to
                                 complete the total length of the value to 8
                                 bytes
                           3. Send GET DATA command with
                              • Data field of the command containing the tag
                                 of the Cardholder Fingerprints data object
                           4. Reset the security status of the '00' key
                              reference by sending the VERIFY command with
                              • P2, key reference value is set to '00'
                              • P1 parameter is 'FF' and both L c and the data
                                 field are absent



                                 C-10
