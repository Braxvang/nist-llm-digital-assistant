                                                                                             NIST SP 800-90B                                                              RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                                  USED FOR RANDOM BIT GENERATION

                                                                                                                                                                 number of ğ‘¥ğ‘¥ in ğ‘†ğ‘†
                                                                                                                                                                       ğ‘–ğ‘–
                                                                                             1. Find the proportion ğ‘ğ‘ğ‘–ğ‘– of each xi in S, i.e., ğ‘ğ‘ğ‘–ğ‘– =            ğ¿ğ¿
                                                                                                                                                                                  . Calculate the expected number
                                                                                                of occurrences of each possible pair (ğ‘§ğ‘§ğ‘–ğ‘– , ğ‘§ğ‘§ğ‘—ğ‘— ) in S, as ğ‘’ğ‘’ğ‘–ğ‘–,ğ‘—ğ‘— = ğ‘ğ‘ğ‘–ğ‘– ğ‘ğ‘ğ‘—ğ‘— ğ¿ğ¿/2.
                                                                                             2. Allocate the possible (ğ‘§ğ‘§ğ‘–ğ‘– , ğ‘§ğ‘§ğ‘—ğ‘— ) pairs, starting from the smallest ğ‘’ğ‘’ğ‘–ğ‘–,ğ‘—ğ‘— , into bins such that the
                                                                                                expected value of each bin is at least five. The expected value of a bin is equal to the sum of
                                                                                                the ğ‘’ğ‘’ğ‘–ğ‘–,ğ‘—ğ‘— values of the pairs that are included in the bin. After allocating all pairs, if the expected
                                                                                                value of the last bin is less than five, merge the last two bins. Let nbin be the number of bins
                                                                                                constructed using this procedure.
                                                                                             After constructing the bins, the Chi-square test is executed as follows:

                                                                                             1. Let o be a list of nbin counts, each initialized to 0. For j=1 to L-1:
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                                a. If the pair (sj, sj+1) is in bin i, increment oi by 1.
                                                                                                b. Let j = j+2.
                                                                                                                                                   ğ‘›ğ‘›     (ğ‘œğ‘œğ‘–ğ‘– âˆ’ ğ¸ğ¸(ğµğµğµğµğµğµğ‘–ğ‘– ) )2
                                                                                             2. The test statistic is calculated as T = âˆ‘ğ‘–ğ‘–=1
                                                                                                                                           ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘
                                                                                                                                                                ğ¸ğ¸(ğµğµğµğµğµğµğ‘–ğ‘– )
                                                                                                                                                                                     . The test fails if T is greater than the
                                                                                                 critical value of the Chi-square test statistic with (nbin â€“1) â€“ (kâ€“1) = nbin â€“k degrees of freedom
                                                                                                 when the probability of type I error is chosen as 0.001. If the value of degrees of freedom is
                                                                                                 less than one, do not apply the test.
                                                                                             Example 11: Let S be (2, 2, 3, 1, 3, 2, 3, 2, 1, 3, 1, 1, 2, 3, 1, 1, 2, 2, 2, 3, 3, 2, 3, 2, 3, 1, 2, 2, 3, 3,
                                                                                             2, 2, 2, 1, 3, 3, 3, 2, 3, 2, 1, 3, 2, 3, 1, 2, 2, 3, 1, 1, 3, 2, 3, 2, 3, 1, 2, 2, 3, 3, 2, 2, 2, 1, 3, 3, 3, 2, 3,
                                                                                             2, 1, 2, 2, 3, 3, 3, 2, 3, 2, 1, 2, 2, 2, 1, 3, 3, 3, 2, 3, 2, 1, 3, 2, 3, 1, 2, 2, 3, 1, 1). The alphabet consists
                                                                                             of k = 3 values {1, 2, 3}; and p1, p2, and p3 are 0.21, 0.41 and 0.38, respectively. With L = 100, the
                                                                                             sorted expected values are calculated as:

                                                                                                              (zi, zj) (1,1) (1,3) (3,1) (1,2) (2,1) (3,3) (2,3) (3,2) (2,2)
                                                                                                               ğ‘’ğ‘’ğ‘–ğ‘–,ğ‘—ğ‘—   2.21   3.99       3.99     4.31        4.31            7.22     7.79    7.79   8.41
                                                                                             The pairs can be allocated into nbin = 6 bins.

                                                                                                                                       Bin Pairs                       ğ¸ğ¸(ğµğµğµğµğµğµğ‘–ğ‘– )
                                                                                                                                       1          (1,1), (1,3) 6.2
                                                                                                                                       2          (3,1), (1,2) 8.3
                                                                                                                                       3          (2,1), (3,3) 11.53
                                                                                                                                       4          (2,3)                7.79
                                                                                                                                       5          (3,2)                7.79
                                                                                                                                       6          (2,2)                8.41


                                                                                             The frequencies for the bins are calculated as 7, 6, 10, 8, 12, and 7 respectively, and the test statistic
                                                                                             is calculated as 3.46. The value of the degrees of freedom is 3 (= 6-3). The hypothesis is not
                                                                                             rejected, since the test statistic is less than the critical value 16.266.




                                                                                                                                                           36
