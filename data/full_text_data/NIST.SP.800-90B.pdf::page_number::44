                                                                                             NIST SP 800-90B                                                              RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                                  USED FOR RANDOM BIT GENERATION

                                                                                                                                                                 number of 𝑥𝑥 in 𝑆𝑆
                                                                                                                                                                       𝑖𝑖
                                                                                             1. Find the proportion 𝑝𝑝𝑖𝑖 of each xi in S, i.e., 𝑝𝑝𝑖𝑖 =            𝐿𝐿
                                                                                                                                                                                  . Calculate the expected number
                                                                                                of occurrences of each possible pair (𝑧𝑧𝑖𝑖 , 𝑧𝑧𝑗𝑗 ) in S, as 𝑒𝑒𝑖𝑖,𝑗𝑗 = 𝑝𝑝𝑖𝑖 𝑝𝑝𝑗𝑗 𝐿𝐿/2.
                                                                                             2. Allocate the possible (𝑧𝑧𝑖𝑖 , 𝑧𝑧𝑗𝑗 ) pairs, starting from the smallest 𝑒𝑒𝑖𝑖,𝑗𝑗 , into bins such that the
                                                                                                expected value of each bin is at least five. The expected value of a bin is equal to the sum of
                                                                                                the 𝑒𝑒𝑖𝑖,𝑗𝑗 values of the pairs that are included in the bin. After allocating all pairs, if the expected
                                                                                                value of the last bin is less than five, merge the last two bins. Let nbin be the number of bins
                                                                                                constructed using this procedure.
                                                                                             After constructing the bins, the Chi-square test is executed as follows:

                                                                                             1. Let o be a list of nbin counts, each initialized to 0. For j=1 to L-1:
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                                a. If the pair (sj, sj+1) is in bin i, increment oi by 1.
                                                                                                b. Let j = j+2.
                                                                                                                                                   𝑛𝑛     (𝑜𝑜𝑖𝑖 − 𝐸𝐸(𝐵𝐵𝐵𝐵𝐵𝐵𝑖𝑖 ) )2
                                                                                             2. The test statistic is calculated as T = ∑𝑖𝑖=1
                                                                                                                                           𝑏𝑏𝑏𝑏𝑏𝑏
                                                                                                                                                                𝐸𝐸(𝐵𝐵𝐵𝐵𝐵𝐵𝑖𝑖 )
                                                                                                                                                                                     . The test fails if T is greater than the
                                                                                                 critical value of the Chi-square test statistic with (nbin –1) – (k–1) = nbin –k degrees of freedom
                                                                                                 when the probability of type I error is chosen as 0.001. If the value of degrees of freedom is
                                                                                                 less than one, do not apply the test.
                                                                                             Example 11: Let S be (2, 2, 3, 1, 3, 2, 3, 2, 1, 3, 1, 1, 2, 3, 1, 1, 2, 2, 2, 3, 3, 2, 3, 2, 3, 1, 2, 2, 3, 3,
                                                                                             2, 2, 2, 1, 3, 3, 3, 2, 3, 2, 1, 3, 2, 3, 1, 2, 2, 3, 1, 1, 3, 2, 3, 2, 3, 1, 2, 2, 3, 3, 2, 2, 2, 1, 3, 3, 3, 2, 3,
                                                                                             2, 1, 2, 2, 3, 3, 3, 2, 3, 2, 1, 2, 2, 2, 1, 3, 3, 3, 2, 3, 2, 1, 3, 2, 3, 1, 2, 2, 3, 1, 1). The alphabet consists
                                                                                             of k = 3 values {1, 2, 3}; and p1, p2, and p3 are 0.21, 0.41 and 0.38, respectively. With L = 100, the
                                                                                             sorted expected values are calculated as:

                                                                                                              (zi, zj) (1,1) (1,3) (3,1) (1,2) (2,1) (3,3) (2,3) (3,2) (2,2)
                                                                                                               𝑒𝑒𝑖𝑖,𝑗𝑗   2.21   3.99       3.99     4.31        4.31            7.22     7.79    7.79   8.41
                                                                                             The pairs can be allocated into nbin = 6 bins.

                                                                                                                                       Bin Pairs                       𝐸𝐸(𝐵𝐵𝐵𝐵𝐵𝐵𝑖𝑖 )
                                                                                                                                       1          (1,1), (1,3) 6.2
                                                                                                                                       2          (3,1), (1,2) 8.3
                                                                                                                                       3          (2,1), (3,3) 11.53
                                                                                                                                       4          (2,3)                7.79
                                                                                                                                       5          (3,2)                7.79
                                                                                                                                       6          (2,2)                8.41


                                                                                             The frequencies for the bins are calculated as 7, 6, 10, 8, 12, and 7 respectively, and the test statistic
                                                                                             is calculated as 3.46. The value of the degrees of freedom is 3 (= 6-3). The hypothesis is not
                                                                                             rejected, since the test statistic is less than the critical value 16.266.




                                                                                                                                                           36
