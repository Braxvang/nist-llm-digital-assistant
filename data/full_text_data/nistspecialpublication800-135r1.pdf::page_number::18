                              NIST SP 800-135, Revision 1




The SSH KDFs are approved when the following conditions are satisfied:
      (1) They are performed in the context of the SSH protocol.
      (2) The hash function is one of the hash functions specified in FIPS 180-3.
      (3) The hash function deployed in the KDFs meets the security strength(s)
          required by the cryptographic function(s) for which the keying material is
          being generated. The security strengths of approved hash functions used in
          KDFs can be found in SP 800-57.

5.3       The Secure Real-time Transport Protocol (SRTP) Key Derivation
          Function
The SRTP is specified in RFC 3711. The protocol is intended to provide
confidentiality, message authentication, and replay protection to the Real-time
Transport Protocol (RTP) traffic and to the control traffic for RTP: the Real-time
Transport Control Protocol (RTCP) (RFC 3550 [RFC 3550]). Session encryption
keys (for a confidentiality service), cipher/encryption salts and authentication keys
(for message authentication) in the SRTP are derived from a single master key, called
k_master, using a KDF. Note that k_master is used as a key derivation key when
input to the KDF. Details of the KDF can be found in Sections 4.3, 5.3 and 7.1 of
RFC 3711.

Denote the cryptographic key (encryption key, cipher salt or authentication key
(HMAC key), etc…) to be derived as K. The length of K is denoted by L. Below is a
description of the KDF.

master_salt: a random non-secret value.

kdr: the key derivation rate. kdr is a number from the set {0, 1, 21, 22, 23…,224}.

index: a 48-bit value in RTP or a 32-bit value in RTCP. See Sections 3.2.1 and 4.3.2
of RFC 3711 for details.

A function, DIV, is defined as followed:

          a and x are non-negative integers.

          a DIV x = a | x  . (a DIV x) is represented as a bit string whose length (in
          bits) is the same as a.

label: an 8-bit value represented by two hexadecimal numbers from the set of {0x00,
0x01, 0x02, 0x03, 0x04, 0x05}. In the future, this set might also include any or all of
the values 0x06, 0x07,…,0xff.

           key_id = label || (index DIV kdr)

                                            15
