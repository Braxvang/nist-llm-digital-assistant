                                      GUIDE TO MALWARE INCIDENT PREVENTION AND HANDLING FOR DESKTOPS AND LAPTOPS


Organizations should carefully consider the possible approaches for their environment ahead of time,
select a sufficiently broad range of approaches, and develop procedures and technical capabilities to
perform each selected approach effectively when a malware incident occurs. Organizations should also
identify which individuals or groups can assist in identification efforts. For example, identification might
be performed by security administrators, system administrators, network administrators, desktop
administrators, mobile device administrators, and others, depending on the sources of identification
information. Organizations should ensure that everyone who might be involved in identification knows
what his or her role is and how to perform necessary tasks.

4.2.3    Prioritizing Incident Response

Once a malware incident has been validated, the next activity is to prioritize its handling. NIST SP 800-61
presents general guidelines for incident prioritization; this section extends those by including additional
factors to consider during prioritization.

Certain forms of malware, such as worms, tend to spread very quickly and can cause a substantial impact
in minutes or hours, so they often necessitate a high-priority response. Other forms of malware, such as
Trojan horses, tend to affect a single host; the response to such incidents should be based on the value of
the data and services provided by the host. Organizations should establish a set of criteria that identify the
appropriate level of response for various malware-related situations. The criteria should incorporate
considerations such as the following:

      How the malware entered the environment and what transmission mechanisms it uses
      What type of malware it is (e.g., virus, worm, Trojan horse)
      Which types of attacker tools are placed onto the host by the malware
      What networks and hosts the malware is affecting and how it is affecting them
      How the impact of the incident is likely to increase in the following minutes, hours, and days if
       the incident is not contained.
4.2.4    Malware Analysis

Incident handlers can study the behavior of malware by analyzing it either actively (executing the
malware) or forensically (examining the infected host for evidence of malware). Forensic approaches are
safer to perform on an infected host because they can examine the host without allowing the malware to
continue executing. However, sometimes it is significantly faster and easier to analyze malware by
monitoring it during execution. Such active approaches are best performed on malware test systems
instead of production hosts, to minimize possible damage caused by allowing the malware to execute.

Ideal active approaches involve an incident handler acquiring a malware sample from an infected host and
placing the malware on an isolated test system. Test systems often have a virtualized OS image; copies of
these builds can be infected, isolating any infection within the virtualized OS, and the infected image can
be replaced with a known good image after the analysis is complete. 17 On such test systems, the host OS
is kept uninfected so it can be used to monitor the execution of the malware within the virtualized OS.
The test system should include up-to-date tools for identifying malware (e.g., antivirus software, intrusion
detection systems), listing the currently running processes, and displaying network connections, as well as
many other potentially helpful utilities. There are various websites and books that provide detailed


17
     Some malware can detect the presence of a virtualized environment and change their behavior accordingly.


                                                             24
