                                                                                               NIST SP 800-56A Rev. 3                             Recommendation for Pair-Wise Key Establishment
                                                                                                                                                          Using Discrete Logarithm Cryptography

                                                                                               Unilateral key confirmation is an optional feature that can be incorporated into any key-
                                                                                               agreement scheme in which the key-confirmation provider is required to own a static key-
                                                                                               establishment key pair that is used in the key-establishment process. If the intended key-
                                                                                               confirmation recipient is not required to contribute an ephemeral public key to the key-
                                                                                               establishment process, then the recipient shall instead contribute a nonce that is used as part
                                                                                               of the input to the key-derivation method employed by the scheme. Each party shall have an
                                                                                               identifier, chosen in accordance with the assumptions stated for the key-agreement scheme.
                                                                                               To include unilateral key confirmation from a provider (who has a static key pair) to a
                                                                                               recipient, the following steps shall be incorporated into the scheme. Additional details will
                                                                                               be provided for each scheme in the appropriate subsections of Section 6. In the discussion
                                                                                               that follows, the key-confirmation provider, P, may be either party U or party V, as long as
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                               P has a static key pair. The key-confirmation recipient, R, is the other party.
                                                                                                  1. If the recipient, R, is not required to generate an ephemeral key pair as part of the
                                                                                                     key-agreement scheme, then R shall contribute a nonce to be used (in addition to the
                                                                                                     shared secret Z) as input to the key-derivation method employed by the scheme; that
                                                                                                     nonce will also be used as part of the ephemeral data input to the MAC tag
                                                                                                     computations performed during key conformation. See Section 5.4 for a discussion
                                                                                                     of the length and security strength required for the nonce.
                                                                                                  2. The provider, P, computes
                                                                                                    MacDataP = message_stringP || IDP || IDR || EphemDataP || EphemDataR {|| TextP}
                                                                                                      where
                                                                                                      - message_stringP is a six byte string with a value of “KC_1_U” when party U is
                                                                                                        providing the MacTag, or “KC_1_V” when party V is providing the MacTag.
                                                                                                        (Note that these values will be changed for bilateral key confirmation, as specified
                                                                                                        in Section 5.9.2.)
                                                                                                      - IDP is the identifier used to label the key-confirmation provider.
                                                                                                      - IDR is the identifier used to label the key-confirmation recipient.
                                                                                                      - EphemDataP and EphemDataR are ephemeral values (corresponding to ephemeral
                                                                                                        public keys or nonces) contributed by the provider and recipient, respectively.
                                                                                                        The ephemeral data is specified in the subsections of Section 6 that describe how
                                                                                                        key confirmation can be incorporated into the particular schemes included in this
                                                                                                        Recommendation.
                                                                                                          o EphemDataP is Null only in the case that the provider has contributed neither
                                                                                                            an ephemeral public key nor a nonce during the scheme. For example, in a
                                                                                                            C(1e, 2s) scheme with unilateral key confirmation from party V to party U as
                                                                                                            introduced in Section 6.2.1.5.2, party V only contributes a static key pair; in
                                                                                                            this case, EphemDataV can be Null.
                                                                                                          o When EphemDatai, (where i is P or R) is an ephemeral public key, the public
                                                                                                            key EphemPubKeyi is a byte string determined as follows:



                                                                                                                                             59
