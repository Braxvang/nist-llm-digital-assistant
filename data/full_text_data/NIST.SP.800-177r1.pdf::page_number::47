                                                                                               NIST SP 800-177 REV. 1                                                                      TRUSTWORTHY EMAIL




                                                                                               For instance, if example.com has its own sending MTA at 192.0.0.1 but also uses a third party
                                                                                               (third-example.net) to send non-transactional email as well, the SPF RR for example.com
                                                                                               would look like:

                                                                                               example.com IN TXT "v=spf1 ip4:192.0.0.1
                                                                                                            include:third-example.net -all"

                                                                                               As mentioned above, the include: mechanism does not simply concatenate the policy tests of the
                                                                                               included domain (here: third-example.net) but performs all the checks in the SPF policy
                                                                                               referenced and returns the ﬁnal result. An administrator should not include the modiﬁer "+"
                                                                                               (requiring the mechanism to pass in order for the whole check to pass) to the include: unless
                                                                                               they are also in control of the included domain, as any change to the SPF policy in the included
                                                                                               domain will aﬀect the SPF validation check for the sending domain.

                                                                                               4.4.5      SPF on the Receiver Side
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-177r1




                                                                                               Unlike senders, receivers need to have SPF-aware mail servers to check SPF policies. SPF has
                                                                                               been around in some form (either experimental or ﬁnalized) and available in just about all major
                                                                                               mail server implementations. �ere are also patches and libraries available for other
                                                                                               implementations to make them SPF-aware and perform SPF queries and processing 9. �ere may
                                                                                               be plug-ins available for a particular Mail User Agent so end users can perform SPF checks even
                                                                                               if their incoming mail server does not.

                                                                                               As mentioned above, SPF uses the envelope-From: address domain-part and the IP address of the
                                                                                               sender. �is means that SPF checks can be started before the actual text of the email message is
                                                                                               received. Alternatively, messages can be quickly received and held in quarantine until all the
                                                                                               checks are ﬁnished. In either event, checks must be completed before the mail message is sent to
                                                                                               an end user's inbox (unless the only SPF checks are performed by the end user using their own
                                                                                               MUA).

                                                                                               �e resulting action based on the SPF checks depends on local receiver policy and the statements
                                                                                               in the purported sending domain's SPF statement. �e action should be based on the modiﬁers
                                                                                               (listed above) on each mechanism. If no SPF TXT RR is returned in the query, or the SPF has
                                                                                               formatting errors that prevent parsing, the default behavior is to accept the message. �is is the
                                                                                               same behavior for mail servers that are not SPF-aware.

                                                                                               4.4.5.1 SPF Queries and DNS

                                                                                               Just as an organization that deploys SPF should also deploy DNSSEC [SP800-81], receivers that
                                                                                               perform SPF processing should also perform DNSSEC validation (if possible) on responses to
                                                                                               SPF queries. A mail server should be able to send queries to a validating DNS recursive server if
                                                                                               it cannot perform its own DNSSEC validation.




                                                                                               9
                                                                                                   A list of some SPF implementations can be found at http://www.openspf.org/Implementations.

                                                                                                                                                       34
