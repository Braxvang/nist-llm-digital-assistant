       NIST SP 800-63B-4 ipd                                             Digital Identity Guidelines
       December 2022                                      Authentication and Lifecycle Management


1025   on the new device to their subscriber account as described in Sec. 6.1.2.1 and invalidate
1026   the authenticator application that will no longer be used.
1027   The authenticator output is obtained by using an approved block cipher or hash function
1028   to combine the key and nonce in a secure manner. The authenticator output MAY be
1029   truncated to as few as 6 decimal digits (approximately 20 bits of entropy).
1030   If the nonce used to generate the authenticator output is based on a real-time clock, the
1031   nonce SHALL be changed at least once every 2 minutes.
1032   The use of an activation secret by the authenticator SHALL meet the requirements of
1033   Sec. 5.2.11. A biometric activation factor SHALL meet the requirements of Sec. 5.2.3,
1034   including limits on the number of consecutive authentication failures. Submission of the
1035   activation factor SHALL be a separate operation from unlocking of the host device (e.g.,
1036   smartphone), although the same activation factor used to unlock the host device MAY
1037   be used in the authentication operation. The unencrypted key and activation secret or
1038   biometric sample — and any biometric data derived from the biometric sample such as a
1039   probe produced through signal processing — SHALL be zeroized immediately after an
1040   OTP has been generated.

1041   5.1.5.2. Multi-Factor OTP Veriﬁers
1042   Multi-factor OTP verifiers effectively duplicate the process of generating the OTP used
1043   by the authenticator, but without the requirement that a second factor be provided. As
1044   such, the symmetric keys used by authenticators SHALL be strongly protected against
1045   unauthorized disclosure by the use of access controls that limit access to the keys to only
1046   those software components on the device requiring access.
1047   When a multi-factor OTP authenticator is being associated with a subscriber account,
1048   the verifier or associated CSP SHALL use approved cryptography to either generate
1049   and exchange or to obtain the secrets required to duplicate the authenticator output.
1050   The verifier or CSP SHALL also establish, by issuance of the authentictor, that
1051   the authenticator is a multi-factor device. Otherwise, the verifier SHALL treat the
1052   authenticator as single-factor, in accordance with Sec. 5.1.4.
1053   The verifier SHALL use approved encryption and an authenticated protected channel
1054   when collecting the OTP in order to provide resistance to eavesdropping and AitM attacks.
1055   In order to provide replay resistance as described in Sec. 5.2.8, verifiers SHALL accept a
1056   given OTP only once while it is valid. In the event a claimant’s authentication is denied
1057   due to duplicate use of an OTP, verifiers MAY warn the claimant in case an attacker has
1058   been able to authenticate in advance. Verifiers MAY also warn a subscriber in an existing
1059   session of the attempted duplicate use of an OTP.
1060   Time-based OTPs [TOTP] SHALL have a defined lifetime that is determined by the
1061   expected clock drift — in either direction — of the authenticator over its lifetime, plus
1062   allowance for network delay and user entry of the OTP.

                                                   26
