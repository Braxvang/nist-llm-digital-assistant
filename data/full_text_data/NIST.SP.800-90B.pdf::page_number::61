                                                                                             NIST SP 800-90B                                                             RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                                 USED FOR RANDOM BIT GENERATION

                                                                                             Given the input S = (s1, â€¦, sL), where si Ïµ A = {x1, â€¦, xk},

                                                                                                1. Let D = 16, and N = L âˆ’ 2. Let subpredict be a list of D values, each initialized to Null. Let
                                                                                                   correct be an array of N values, each initialized to 0. Let entries be an array of D values,
                                                                                                   each initialized to 0, and let maxEntries = 100 000.
                                                                                                2. For d = 1 to D, let Md be a set of counters, where Md[x, y] denotes the number of observed
                                                                                                   transitions from output x to output y for the d th-order MMC.
                                                                                                3. Let scoreboard be a list of D counters, each initialized to 0. Let winner = 1.
                                                                                                4. For i = 3 to L:
                                                                                                        a. For d = 1 to D:
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                                                  i. If d < iâˆ’1:
                                                                                                                               1. If [(si-d-1, â€¦,si-2), si-1] is in Md, increment Md[(si-dâˆ’1, â€¦,siâˆ’2), siâˆ’1] by
                                                                                                                                  1.
                                                                                                                               2. Else if entriesd < maxEntries, add a counter for [(siâˆ’dâˆ’1, â€¦,siâˆ’2), siâˆ’ 1]
                                                                                                                                  to the set, let Md[(siâˆ’dâˆ’1,â€¦,siâˆ’2), siâˆ’ 1] = 1 and increment entriesd by
                                                                                                                                  1.
                                                                                                        b. For d = 1 to D:
                                                                                                                  i. If d < i, find the y value that corresponds to the highest Md[(si-d,â€¦,si-1), y]
                                                                                                                     value, and denote that y as ymax. If there is a tie, let ymax be the greatest y
                                                                                                                     in the tie. Let subpredictd = ymax. If all possible values of Md [(si-d,â€¦,si-1),
                                                                                                                     y] are 0, then let subpredictd = Null.
                                                                                                        c. Let prediction = subpredictwinner.
                                                                                                        d. If (prediction = si), let correcti-2 = 1.
                                                                                                        e. Update the scoreboard. For d = 1 to D:
                                                                                                                  i. If (subpredictd = si)
                                                                                                                               1. Let scoreboardd = scoreboardd +1.
                                                                                                                               2. If scoreboardd â‰¥ scoreboardwinner, let winner = d.
                                                                                                5. Let C be the number of ones in correct.
                                                                                                                                                                                        ð¶ð¶
                                                                                                6. Calculate the predictorâ€™s global performance as ð‘ƒð‘ƒð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘” = ð‘ð‘ . The upper bound of the 99 %
                                                                                                                                                      â€²
                                                                                                   confidence interval on ð‘ƒð‘ƒð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘” , denoted ð‘ƒð‘ƒð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘” is calculated as:
                                                                                                                                                                   1
                                                                                                                                                    1 âˆ’ 0.01 ð‘ð‘ ,                               if ð‘ƒð‘ƒð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘” = 0
                                                                                                            â€²
                                                                                                         ð‘ƒð‘ƒð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘” =ï¿½
                                                                                                                                                           ð‘ƒð‘ƒ            ï¿½1âˆ’ð‘ƒð‘ƒ            ï¿½
                                                                                                                             min(1, ð‘ƒð‘ƒð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘” + 2.576ï¿½ ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘” ð‘ð‘âˆ’1 ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘”ð‘” ),     otherwise

                                                                                                    where 2.576 corresponds to the ð‘ð‘(1âˆ’0.005) value.



                                                                                                                                                              53
