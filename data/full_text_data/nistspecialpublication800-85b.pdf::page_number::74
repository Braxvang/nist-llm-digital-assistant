Special Publication 800-85B                               PIV Data Model Testing Specification



9.3     Fingerprint Template

9.3.1    General Record Header Conformance
Purpose             Verify that the General Record Header of the fingerprint template conforms to
                    specifications in Table 3 of SP80076.
Reference(s)        1. SP80076, Table 3
                    2. AS05.01.03
                    3. AS05.02.02
                    4. AS05.02.03
                    5. AS05.02.04
                    6. AS05.02.05
                    7. AS05.02.06
                    8. AS05.02.07
                    9. AS05.02.08
                    10. AS05.02.09
                    11. AS05.02.10
                    12. AS05.02.11
                    13. AS05.02.12
Precondition(s)     1. A valid PIV card is inserted into the contact reader.
                    2. A valid PC/SC connection exists between the test application and
                        the contact reader.
                    3. The test application is currently connected to the card application
                         which is accessible through card handle.
                    4. A valid Card Holder Fingerprints object is present on the PIV card.
                    5. Security conditions to read the object are met.
Test Scenario       1. Set cardHandle := <<valid card handle>>
                    2. Set OID := <<Card Holder Fingerprints
                       (2.16.840.1.101.3.7.2.96.16)>>
                    3. Call pivGetData w/
                        • (IN) cardHandle
                        • (IN) OID
                        • (OUT) data
                    4. Extract the value field for tag 0xBC, parse the first 88
                    bytes (CBEFF Header) to obtain the BDB and SB lengths and then
                    continue on to parse the General Record Header of the BDB
                    a.Extract contents of Format Identifier.
                    b.Extract contents of Version Number.
                    c.Extract contents of Record Length field.
                    d.Extract contents of CBEFF Product Identifier Owner
                    e.Extract contents of CBEFF Product Identifier Type
                    f.Extract contents of Capture Equipment Compliance field.
                    g.Extract contents of Capture Equipment ID
                    h.Extract contents of “Scanned Image in X Direction” field
                    i.Extract contents of “Scanned Image in Y Direction” field
                    j.Extract contents of X (horizontal) resolution.
                    k.Extract contents of Y (vertical) resolution.
                    l.Extract contents of “Number of Finger Views” field.
                    m.Extract contents of Reserved Byte.



                                                                                                 Page 66
