SECURE DOMAIN NAME SYSTEM (DNS) DEPLOYMENT GUIDE



In some installations, it may not be possible to switch over to the latest version of name server software
immediately. In these situations, the administrator should keep pace with vulnerabilities identified in the
operational version and associated security patches [BINDSEC].


Checklist item 1: When installing the upgraded version of name server software, the administrator
should make necessary changes to configuration parameters to take advantage of new security features.
Checklist item 2: Whether running the latest version or an earlier version, the administrator should be
aware of the vulnerabilities, exploits, security fixes, and patches for the version that is in operation in the
enterprise. The following actions are recommended (for BIND deployments):

            –   Subscribe to ISC’s mailing list called “bind-announce” or “nsd-users” for NSD

            –   Periodically refer to the BIND vulnerabilities page at
                http://www.isc.org/products/BIND/bind-security.html

            –   Refer to CERT®/CC’s Vulnerability Notes Database at http://www.kb.cert.org/vuls/ and the
                NIST NVD metabase at http://nvd.nist.gov/.


7.2.2       Turning off the Version Query

There is a feature in BIND that returns the version number of the server daemon running if a special
query is sent to the server. This query is for the string “version.bind” with query type TXT and query
class Chaos (CH). This information may be of use to attackers who are looking for a specific version of
BIND with a discovered weakness. BIND can be configured to refuse this type of query by having the
following command in the BIND configuration file (/etc/named.conf).

            options {
                 version none;
            };

There is a similar feature in NSD to refuse version queries. In the configuration file for NSD
(/etc/nsd/nsd.conf).

            server:
                 hide-version: yes


For Windows, the DNS version number can be changed using the dnscmd tool with the /config option
and changing the EnableVersionQuery property3.




Checklist item 3: To prevent information about which version of name server software is running on a
system, name servers should be configured to refuse queries for its version information..



3
    http://msdn.microsoft.com/en-us/library/cc422472(v=prot.10).aspx


                                                              7-2
