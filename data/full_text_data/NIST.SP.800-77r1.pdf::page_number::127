                                                                                              NIST SP 800-77 REV. 1                                                         GUIDE TO IPSEC VPNS


                                                                                                      file from universal serial bus (USB) media or an email attachment. Such profiles are
                                                                                                      usually encrypted by a password to ensure that the file can be sent over an insecure
                                                                                                      network. If provisioning is not supported, the configuration menu on the client will have
                                                                                                      an option to add a “VPN configuration.” This configuration will then ask for the remote
                                                                                                      VPN server’s DNS name, the type of configuration required, and some optional
                                                                                                      information. Some IPsec clients have an option to import a certificate bundle, while other
                                                                                                      IPsec clients require the user to import certificates separately from the VPN connection.
                                                                                                      Certificates are usually transported using the PKCS#12 format, which has an encrypted
                                                                                                      bundle consisting of a certificate, private key, and CA certificate that are protected by
                                                                                                      symmetric key wrapping using a key derived from a strong password.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                                 3. Test the tunnel settings. Once the parameters have been entered, the administrator starts
                                                                                                    the VPN connection.

                                                                                              9.2.3.3 Testing the Solution

                                                                                              After completing the configuration of the VPN router and the external test clients, the VPN
                                                                                              gateway administrator tests the solution to ensure that the external system can successfully
                                                                                              establish a secure tunnel to the VPN router and transfer encrypted traffic through the tunnel.
                                                                                              While ping commands are a good initial test to see if things appear to be working, they are not
                                                                                              enough since these packets are unusually small and will not indicate whether a large TCP stream
                                                                                              will work as well. Using a web browser to generate traffic is a better test. If the remote access
                                                                                              server provides both IPv4 and IPv6 lease IP addresses to the VPN clients, both types should be
                                                                                              verified to work properly. Traffic to both the corporate servers and the internet should be tested
                                                                                              to ensure proper functioning of the (lack or presence of) split tunnel configuration.

                                                                                              Tests should also ascertain that the VPN gateway will only negotiate IPsec tunnels for the
                                                                                              approved algorithm(s) and will block traffic that is not encrypted. The administrator should
                                                                                              monitor the VPN gateway’s logs for errors that indicate problems with the connection. The
                                                                                              gateway’s log report generation tool can be useful when troubleshooting issues because it can
                                                                                              indicate where connections are failing or where traffic is being dropped. The administrator also
                                                                                              deploys a packet sniffer on the gateway or an external test device to confirm that the traffic is
                                                                                              being protected.

                                                                                              MOBIKE is tested by using a phone that has mobile data and WiFi connectivity. The phone
                                                                                              establishes a VPN connection to the VPN server using the WiFi interface. The WiFi interface is
                                                                                              then disabled. The VPN connection should still be working. Logs on the VPN server can be
                                                                                              checked to see if the VPN client’s public IP address changed through a MOBIKE message. Re-
                                                                                              enabling WiFi should cause the VPN client to switch back to WiFi since that is usually the
                                                                                              preferred connection and will be faster and cheaper.

                                                                                              9.2.4   Analysis

                                                                                              IPsec tunnels established from external systems to a trusted gateway can be effective for
                                                                                              protecting sensitive information from eavesdroppers. Providing secure remote access for laptops,
                                                                                              phones, or other devices can be done using standard IKEv2 and IPsec software. Using the



                                                                                                                                             110
