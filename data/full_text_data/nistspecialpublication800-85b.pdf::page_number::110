Special Publication 800-85B                                    PIV Data Model Testing Specification


Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<Card Holder Facial Image
                         (2.16.840.1.101.3.7.2.96.48)>>
                      3. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      4. Parse the SignerInfo-> signedAttrs field contents from
                         the CBEFF_SIGNATURE_BLOCK to locate the pivSigner-DN
                         attribute (OID=2.16.840.1.101.3.6.5)
                      5. Extract the certificates field contents from the
                         CBEFF_SIGNATURE_BLOCK
                      6. If a certificate extracted from the certificates field
                         of the CBEFF_SIGNATURE_BLOCK does not exist, then
                         extract the certificates field contents from the
                         asymmetric signature of the CHUID
                      7. Extract the subject DN from the certificate obtained in
                         the previous step
Expected              The value of the subject DN obtained from the certificate in the
Result(s)             certificates field in the SignedData is identical to that obtained from the
                      pivSigner-DN attribute of the signedAttrs of the SignerInfo.


10.3.1.11 Verify FASC-N

Purpose                 Confirms that the signedAttrs of the SignerInfo includes the pivFASC-N
                        attribute whose value matches the value of the FASC-N in the CHUID
                        of the PIV card.
Reference(s)            1.     FIPS201, Section 4.4.2
                        2.     AS06.03.14
Precondition            1.     A valid PIV card is inserted into the contact reader.
                        2.     A valid PC/SC connection exists between the test application and
                               the contact reader.
                        3.     The test application is currently connected to the card application
                               which is accessible through card handle.
                        4.     A valid card holder facial image is present on the PIV card.
                        5.     A valid CHUID is present on the PIV card.




                                                                                                 Page 102
