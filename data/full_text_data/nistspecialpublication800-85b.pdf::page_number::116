Special Publication 800-85B                                   PIV Data Model Testing Specification


Precondition          1.      A valid PIV card is inserted into the contact reader.
                      2.      A valid PC/SC connection exists between the test application and the
                              contact reader.
                      3.      The test application is currently connected to the card application
                              which is accessible through card handle.
                      4.      A valid security object is present on the PIV card.
Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<Security Object
                         (2.16.840.1.101.3.7.2.144.0)>>
                      3. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      4. Parse the obtained security object and extract the
                         contents from the asymmetric digital signature field
                         (i.e. TAG 0xBB)
                      5. Process the contents of the digital signature
Expected              The security object is present in the security object buffer and contains an
Result(s)             asymmetric digital signature that is implemented as a SignedData type
                      according to RFC 3852.


10.4.2.2 Verify version in SignedData

Purpose               Confirms that the version of the SignedData content type is 1.
Reference(s)          1.      AS06.04.04
Precondition          1.      A valid PIV card is inserted into the contact reader.
                      2.      A valid PC/SC connection exists between the test application and the
                              contact reader.
                      3.      The test application is currently connected to the card application
                              which is accessible through card handle.
                      4.      A valid security object is present on the PIV card.
Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<Security Object
                         (2.16.840.1.101.3.7.2.144.0)>>
                      3. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      4. Extract the version field contents from the asymmetric
                         signature of the Security Object (i.e. TAG 0xBB)
Expected              The value of the version field of the SignedData is 1.
Result(s)




                                                                                                Page 108
