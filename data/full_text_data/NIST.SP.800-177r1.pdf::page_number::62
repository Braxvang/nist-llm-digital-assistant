                                                                                               NIST SP 800-177 REV. 1                                                          TRUSTWORTHY EMAIL




                                                                                                  •   Results classiﬁed by sender subdomain (whether or not a separate sp policy exists).
                                                                                                  •   �e sending and receiving domain pair.
                                                                                                  •   �e policy applied, and whether this is diﬀerent from the policy requested.
                                                                                                  •   �e number of successful authentications.
                                                                                                  •   Totals for all messages received.

                                                                                               Based on the return ﬂow of aggregate reports from the aggregation of all receivers, a domain
                                                                                               owner can build up a picture of the email being sent and how it appears to outside receivers. �is
                                                                                               allows the domain owner to identify gaps in email infrastructure and policy and how (and when)
                                                                                               it can be improved. In the early stages of building up this picture, the sending domain should set
                                                                                               a DMARC policy of p=none, so the ultimate disposition of a message that fails some checks
                                                                                               rests wholly on the receiver's local policy. As DMARC aggregate reports are collected, the
                                                                                               domain owner will have a quantitatively better assessment of the extent to which the sender’s
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-177r1




                                                                                               email is authenticated by outside receivers and will be able to set a policy of p=reject, indicating
                                                                                               that any message that fails the SPF, DKIM and alignment checks really should be rejected via a
                                                                                               SMTP reply code signaling rejection, or silently discarding the message. Note, however, mailing
                                                                                               lists and some other email uses (e.g., “share this post” type links) may fail DMARC validation
                                                                                               and may need to be considered when forming a policy. From their own traﬃc analysis, receivers
                                                                                               can develop a determination of whether a sending domain owner’s p=reject policy is suﬃciently
                                                                                               trustworthy to act on.

                                                                                               Failure reports from receivers to domain owners help debug and tune the component SPF and
                                                                                               DKIM mechanisms as well as alerting the domain owner that their domain is being used as part
                                                                                               of a phishing/spam campaign. Typical initial rollout of DMARC in an enterprise will include the
                                                                                               ruf tag with the values of the fo tag progressively modiﬁed to capture SPF debugging, DKIM
                                                                                               debugging or alignment debugging. Failure reports are expensive to produce and bear a real
                                                                                               danger of providing a DDoS source back to domain owners, so when suﬃcient conﬁdence is
                                                                                               gained in the integrity of the component mechanisms, the ruf tag may be dropped from DMARC
                                                                                               policy statements if the sending domain no longer wants to receive failure reports. Note however
                                                                                               that failure reports can also be used to alert domain owners about phishing attacks being
                                                                                               launched using their domain as the purported sender and therefore dropping the ruf tag is not
                                                                                               recommended.

                                                                                               �e same AFRF report format as for aggregate reports [RFC6591], [RFC7489] is also speciﬁed
                                                                                               for failure reports, but the DMARC standard updates it for the speciﬁcity of a single failure
                                                                                               report:

                                                                                                  •   Receivers include as much of the message and message header as is reasonable to allow
                                                                                                      the domain to investigate the failure.
                                                                                                  •   Add an Identity-Alignment ﬁeld, with DKIM and SPF DMARC-method ﬁelds as
                                                                                                      appropriate (see above).
                                                                                                  •   Optionally add a Delivery-Result ﬁeld.
                                                                                                  •   Add DKIM Domain, DKIM Identity and DKIM selector ﬁelds, if the message was DKIM
                                                                                                      signed. Optionally also add DKIM Canonical header and body ﬁelds.

                                                                                                                                                49
