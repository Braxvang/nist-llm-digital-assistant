NIST SP 800-85A-4                                 PIV CARD APPLICATION & MIDDLEWARE
                                                           INTERFACE TEST GUIDELINES

                             8. Send CHANGE REFERENCE DATA card command
                                repeatedly until after the issuer specified
                                maximum number of PIN tries is exceeded with
                                • P2, key reference value is set to '80'
                                • Data field of the command will contain an
                                   incorrect PIN value (anything other than PIN
                                   2), concatenated without delimitation with an
                                   arbitrary new PIN value (PIN 9). Both PINs
                                   should be padded with 'FF' to complete the
                                   total length of each value to 8 bytes
                       2b. Test case for implementations that support the Global
                            PIN ('00') for PIV data access and command execution
                            and the CHANGE REFERENCE DATA command with the Global
                            PIN is implemented with the PIV Card Application.
                             1. Perform steps 1-8 of 2a using key reference '00'
                                in place of key reference '80'
                    3. Test case for implementations for which the CHANGE
                       REFERENCE DATA command with the PUK is implemented with
                       the PIV Card Application
                             1. Send CHANGE REFERENCE DATA card command with
                                • P2, key reference value is set to '81'
                                • Data field of the command will contain the
                                   correct PUK value (PUK 1) concatenated without
                                   delimitation with an arbitrary new 8-byte PUK
                                   value (PUK 2)
                             2. Send CHANGE REFERENCE DATA card command with
                                • P2, key reference value is set to '81'
                                • Data field of the command will contain the
                                   correct PUK value (PUK 2) concatenated without
                                   delimitation with an arbitrary new 8-byte PUK
                                   value (PUK 3)
                             3. Send CHANGE REFERENCE DATA card command with
                                • P2, key reference value is set to '81'
                                • Data field of the command will contain the
                                   correct PUK value (PUK 3) concatenated without
                                   delimitation with an arbitrary new PUK value
                                   (PUK 4) that is less than 8 bytes
                             4. Send CHANGE REFERENCE DATA card command
                                repeatedly until after the issuer specified
                                maximum number of PIN tries is exceeded with
                                • P2, key reference value is set to '81'
                                • Data field of the command will contain an
                                   incorrect PUK value (anything other than PUK
                                   3), concatenated without delimitation with an
                                   arbitrary new PUK value (PUK 5)
                    4. Test case for implementations that support OCC
                             1. Send CHANGE REFERENCE DATA card command with
                                • P2, key reference value is set to '96'
                                • Data field of the command will contain an
                                   arbitrary value of 16 bytes
                                • (repeat test with key reference '97')
                    5. Test case for implementations that support the pairing
                       code
                             1. Send CHANGE REFERENCE DATA card command with



                                  C-21
