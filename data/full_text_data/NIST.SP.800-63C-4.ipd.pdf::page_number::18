      NIST SP 800-63C-4 ipd                                               Digital Identity Guidelines
      December 2022                                                       Federation and Assertions


412   4.   Federation Assurance Level (FAL)
413   This section is normative.
414   This section defines allowable federation assurance levels (FALs). The FAL describes
415   requirements for securing federation transactions, including requirements on how
416   relationships between IdPs and RPs are established and how assertions are presented
417   and protected. These levels can be requested by an RP at runtime or required by the
418   configuration of both the RP and the IdP for a given transaction. The FAL provides
419   assurances for the RP receiving the assertion as well as assurances for the IdP creating the
420   assertion to be used by an RP.
421   While many different federation implementation options are possible, the FAL is intended
422   to provide clear guidance representing increasingly secure deployment options. See
423   [SP800-63] for details on how to choose the most appropriate FAL.
424   Each FAL is characterized by a set of requirements that increase the security and
425   complexity as the FAL increases. These requirements are listed here and expanded in
426   other sections of this document:
427   Cryptographic Verifiability
428      The assertion presented in the federation protocol is traceable back to a specific IdP
429      that issued it, and that connection can be verified with a cryptographic mechanism
430      such as a digital signature or MAC. This also allows the RP to verify that the assertion
431      was not modified or forged. This is required at all FALs.

432   Audience Restriction
433     The assertion presented in the federation protocol is targeted to a specific RP and the
434     RP can verify that it is the intended audience of the assertion. This is required at all
435     FALs.

436   Injection Protection
437      The RP is strongly protected from an attacker presenting an assertion in circumstances
438      outside a current federation transaction request.

439   Trust Agreement
440      The IdP and RP have agreed to participate in a federation transaction with each other
441      for the purposes of logging in the subscriber to the RP. This can be traced back to a
442      static agreement between the parties or occur implicitly from the connection itself.

443   Registration
444      The IdP and RP have exchanged identifiers and key material to allow for the
445      verification of assertions and other artifacts during future federation transactions.



                                                    6
