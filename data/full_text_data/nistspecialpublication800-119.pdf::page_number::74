                                                                 GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


    Requiring a larger minimum MTU and PMTU discovery also increase efficiency.

    Eliminating in-route fragmentation removes one of the greatest sources of performance degradation in
     IPv4.

    Eliminating broadcast and building in better support for multicast and anycast make better use of
     network resources.

    A new Flow Label field and larger Traffic Class field in the main IPv6 header allow more efficient
     and finer grained differentiation of various types of traffic.
The IPv6 Traffic Class field replaces the IPv4 Type of Service field. The original intent of the IPv4 Type
of Service field has been replaced by diffserv (RFC 2474), which provides a use for the field. Although
the RFCs are vague on this point, this is the way the IPv6 Traffic Class is usually used, and the
functionality in IPv6 is equivalent to that in IPv4. Because of the way diffserv works, this field may be
rewritten in transit. For example, RFC 2474 describes how packet marking is performed by traffic
conditioners at network boundaries, including the edges of the network (first-hop router or source host)
and administrative boundaries, and RFC 3168 sets aside two bits in this field called Explicit Congestion
Notification for routers to indicate network congestion to end hosts.

When IPv6 QoS is mentioned, most frequently the last of these aspects, especially the Flow Label, is
cited. Rudimentary use of the Flow Label is defined in RFC 1809 and RFC 3697. A Flow label value is
always associated with a source and destination address pair with the same Hop-by-Hop options and
Routing Header. (A zero value means that the field is not being used.) This has the advantage of
specifying flows completely in the main header. It is not necessary to examine extension headers, upper
layer protocols, and port numbers to identify the packet. RFC 3697 recommends that each new transport
connection and application data stream be given a new value, and it requires that applications be able to
specify this value. It stipulates that Flow Labels be delivered intact, and it gives rules for timeouts and
reuse. Finally, it prohibits using specific bits or mathematical interpretations of the value—it is just a 20-
bit label.

Many IPv6 implementations do choose different Flow Label values for each TCP connection, for
example, but few if any make additional use of the field. Thus, realizing the potential for providing better
QoS offered by the IPv6 Flow Label lies in finding improved ways to use this feature in the future.

    4.3.2   Differences between IPv4 and IPv6 QoS

The specific differences in QoS capabilities between IPv4 and IPv6 are covered point-by-point in the
preceding section. The overall design of IPv6 is better thought out with respect to QoS; several specific
improvements in IPv6 allow for more efficient network usage, and room has been left for additional QoS
capabilities when these are defined.

    4.3.3   Security Ramifications

One aspect is securing the QoS mechanisms themselves, to prevent theft of service, traffic analysis, or
other attacks. For example, the Type of Service and Flow Label in the IPv6 header are not protected,
even by AH. This is because the Type of Service can be altered while a packet is in transit. Although
RFC 3697 specifies a nonalterable Flow Label field, when AH was originally designed, the Flow Label
was also thought to be capable of alteration; the updated version of AH maintained that view for
backwards compatibility. An application able to forge these fields may be able obtain preferred service
fraudulently. If this is a major concern, IPsec can be run in tunnel mode, the QoS parameters can be
copied from the inner header to the outer header, and the protected inner header can be compared with the


                                                     4-11
