                                                                                             NIST SP 800-90B                                                             RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                                 USED FOR RANDOM BIT GENERATION

                                                                                                  2. Partition the dataset, 𝑆𝑆 ′ , into two disjoint groups. These two groups will form the dictionary
                                                                                                     and the test data.
                                                                                                             a. Create the dictionary from the first d = 1000 elements of 𝑆𝑆 ′ , (𝑠𝑠1′ , … , 𝑠𝑠𝑑𝑑′ ).
                                                                                                                                                                     ′            ′
                                                                                                             b. Use the remaining 𝑣𝑣 = ⌊𝐿𝐿/𝑏𝑏⌋ − 𝑑𝑑 observations, (𝑠𝑠𝑑𝑑+1 , … , 𝑠𝑠⌊𝐿𝐿/𝑏𝑏⌋ ), for testing.
                                                                                                  3. Initialize the dictionary dict to an all zero array of size 2b. For i from 1 to d, let dict[𝑠𝑠𝑖𝑖′ ] = i.
                                                                                                     The value of dict[𝑠𝑠𝑖𝑖′ ] is the index of the last occurrence of each 𝑠𝑠𝑖𝑖′ in the dictionary.
                                                                                                  4. Run the test data against the dictionary created in Step 2.
                                                                                                             a. Let D be a list of length v.
                                                                                                             b. For i from 𝑑𝑑 + 1 to ⌊𝐿𝐿/𝑏𝑏⌋:
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                                                      i. If dict[𝑠𝑠𝑖𝑖′ ] is non-zero, then Di-d = i – dict[𝑠𝑠𝑖𝑖′ ]. Update the dictionary with the
                                                                                                                         index of the most recent observation, dict[𝑠𝑠𝑖𝑖′ ]=i.
                                                                                                                ii. If dict[si] is zero, add that value to the dictionary, i.e., dict[𝑠𝑠𝑖𝑖′ ] =i. Let Di-d =
                                                                                                                    i.
                                                                                                  5. Calculate the sample mean, 𝑋𝑋�, and sample standard deviation 13, 𝜎𝜎�, of (log2(D1), …,
                                                                                                     log2(Dv)).

                                                                                                                                                            ∑𝑣𝑣𝑖𝑖=1 log 2 𝐷𝐷𝑖𝑖
                                                                                                                                                    𝑋𝑋� =                      ,
                                                                                                                                                                    𝑣𝑣
                                                                                                                                                        𝑐𝑐 = 0.5907

                                                                                                       and

                                                                                                                                                      ∑𝑣𝑣 (log 2 𝐷𝐷𝑖𝑖 )2
                                                                                                                                            𝜎𝜎� = 𝑐𝑐 � 𝑖𝑖=1              − 𝑋𝑋� 2 .
                                                                                                                                                           𝑣𝑣 − 1

                                                                                                  6. Compute the lower-bound of the confidence interval for the mean, based on a normal
                                                                                                     distribution using

                                                                                                                                                        � = 𝑋𝑋� − 2.576𝜎𝜎�.
                                                                                                                                                       𝑋𝑋′
                                                                                                                                                                    √𝑣𝑣
                                                                                                  7. Using a binary search, solve for the parameter p, such that the following equation is true:
                                                                                                                                 � = 𝐺𝐺(𝑝𝑝) + (2𝑏𝑏 − 1)𝐺𝐺(𝑞𝑞),
                                                                                                                                𝑋𝑋′

                                                                                                       where



                                                                                             13 Note that a correction factor is applied to the standard deviation, as described in [Mau92] and computed with higher accuracy in

                                                                                              [CoNa98]. This correction factor reduces the standard deviation to account for dependencies in the Di values.


                                                                                                                                                             46
