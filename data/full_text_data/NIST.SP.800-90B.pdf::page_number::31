                                                                                             NIST SP 800-90B                                                        RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                            USED FOR RANDOM BIT GENERATION

                                                                                             Continuous health tests are run indefinitely on the outputs of the noise source 7 while the noise
                                                                                             source is operating. Continuous tests focus on the noise source behavior and aim to detect failures
                                                                                             as the noise source produces outputs. The purpose of continuous tests is to allow the entropy source
                                                                                             to detect many kinds of failures in its underlying noise source. These tests are run continuously on
                                                                                             all digitized samples obtained from the noise source, and so tests must have a very low probability
                                                                                             of raising a false alarm during the normal operation of the noise source. In many systems, a
                                                                                             reasonable false positive probability will make it extremely unlikely that a properly functioning
                                                                                             device will indicate a malfunction, even in a very long service life. Continuous tests are resource-
                                                                                             constrained − this limits their ability to detect noise source failures − so they are usually designed
                                                                                             so that only gross failures are likely to be detected.
                                                                                             Note that continuous health tests operate over a stream of values. These sample values may be
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                             output from the entropy source as they are generated and (optionally) processed by a conditioning
                                                                                             component; there is no need to inhibit output from the noise source or entropy source while running
                                                                                             the test. It is important to understand that this may result in poor entropy source outputs for a time,
                                                                                             since the error is only signaled once significant evidence has been accumulated, and these values
                                                                                             may have already been output by the entropy source. As a result, it is important that the false
                                                                                             positive probability be set to an acceptable level. In the following discussion, all calculations
                                                                                             assume that a false positive probability of approximately one error in 220 samples generated by the
                                                                                             noise source is acceptable; however, the formulas given can be adapted for different false positive
                                                                                             probabilities selected by the submitter.
                                                                                             On-demand health tests can be called at any time. This Recommendation does not require
                                                                                             performing testing during operation. However, it does require that the entropy source be capable
                                                                                             of performing on-demand health tests of the noise source output. Note that resetting, rebooting, or
                                                                                             powering up are acceptable methods for initiating an on-demand test if the procedure results in the
                                                                                             immediate execution of the start-up tests. Samples collected from the noise source during on-
                                                                                             demand health tests shall not be available for use until the tests are completed, however these
                                                                                             samples may be discarded at any time, or may be used after the completion of the tests providing
                                                                                             that there are no errors.
                                                                                             4.3      Requirements for Health Tests

                                                                                             Health tests on the noise source are a required component of an entropy source. The health tests
                                                                                             shall include both continuous and start-up tests.
                                                                                             1. The continuous tests shall include either:
                                                                                                   a. The approved continuous health tests, described in Section 4.4, or
                                                                                                   b. Some developer-defined tests that meet the requirements for a substitution of those
                                                                                                      approved tests, as described in Section 4.5. If developer-defined health tests are used in
                                                                                                      place of any of the approved health tests, the tester shall verify that the implemented tests
                                                                                                      detect the failure conditions detected by the approved continuous health tests, as described
                                                                                                      in Section 4.4. The need to use the two approved continuous health tests can be avoided
                                                                                                      by providing convincing evidence that the failure being considered will be reliably


                                                                                             7 Entropy sources may have a warm-up phase in which the outputs are inhibited for a time immediately after startup. Continuous

                                                                                                   health testing is not required during the warm up phase.


                                                                                                                                                              23
