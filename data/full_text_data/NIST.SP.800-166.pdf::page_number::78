NIST SP 800-166                                                   DERIVED PIV APPLICATION AND
                                                                  DATA MODEL TEST GUIDELINES

                      •   The Derived PIV Application Password’s retry counter is not 0.
 Test Scenario        1. Send the SELECT command with
                            • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                      2. Send the CHANGE REFERENCE DATA command with
                            • P2, key reference value, is set to '80'
                            • Data field of the command will contain the
                               correct password (password 1) padded to 8 bytes
                               with 'FF' (if needed) concatenated without
                               delimitation with an arbitrary new password value
                               that contains 0x5B in the first byte position,
                               all other non-padded bytes contain values limited
                               to either 0x30–0x39 or 0x41-0x5A or 0x61-0x7A
                               (password 2). Both passwords should be padded
                               with 'FF'(as needed) to complete the total length
                               of each value to 8 bytes (repeat test five times
                               with byte positions 2, 3, 4, 5, and 6 containing
                               the 0x5B byte, respectively)
 Expected Result(s)   1. From Step 1, the command returns the application property template
                         with the status word '90 00'.
                      2. From Step 2, each time the command returns status word '6A 80'
                         (incorrect parameter in command data field).
 Postcondition(s)     Current password is unchanged.

8.3.5.5 Change Reference Data with an Incorrect Format for the Current Password

 Test Assertion       TA-08.03.05.05
 Purpose              Verifies that the Derived PIV Application responds appropriately to the
                      CHANGE REFERENCE DATA command when the current password
                      format requirements are not met.
 DTR(s)               •  DTR-06.02.02.09
                      •  DTR-06.02.02.14
                      •  DTR-06.03.01.01
                      •  DTR-06.03.06.05
                      • DTR-06.03.06.08
 Vendor               None.
 Documentation
 Precondition(s)      •   A token with the Derived PIV Application is inserted into an
                          appropriate token reader.
                      •   Suitable drivers have been loaded between the test system and an
                          instance of the reader.
                      •   The Derived PIV Application Password is recorded.
                      •   The Derived PIV Application Password’s retry counter is not 0.
 Test Scenario        1. Send the SELECT command with
                            • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                      2. Send the CHANGE REFERENCE DATA command with
                            • P2, key reference value, is set to '80'




                                            71
