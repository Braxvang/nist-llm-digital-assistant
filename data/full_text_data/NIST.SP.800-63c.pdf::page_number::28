                                                                                             NIST SP 800-63C                                                         DIGITAL IDENTITY GUIDELINES:
                                                                                                                                                                       FEDERATION & ASSERTIONS

                                                                                             When pairwise pseudonymous identifiers are used with RPs alongside attributes, it may still be
                                                                                             possible for multiple colluding RPs to re-identify a subscriber by correlation across systems
                                                                                             using these identity attributes. For example, if two independent RPs each see the same subscriber
                                                                                             identified with different pairwise pseudonymous identifiers, they could still determine that the
                                                                                             subscriber is the same person by comparing the name, email address, physical address, or other
                                                                                             identifying attributes carried alongside the pairwise pseudonymous identifier in the respective
                                                                                             assertions. Privacy policies SHOULD prohibit such correlation, and pairwise pseudonymous
                                                                                             identifiers can increase effectiveness of these policies by increasing the administrative effort in
                                                                                             managing the attribute correlation.

                                                                                             Note that in a proxied federation model, the initial IdP may be unable to generate a pairwise
                                                                                             pseudonymous identifier for the ultimate RP, since the proxy could blind the IdP from knowing
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-63c




                                                                                             which RP is being accessed by the subscriber. In such situations, the pairwise pseudonymous
                                                                                             identifier is generally established between the IdP and the federation proxy itself. The proxy,
                                                                                             acting as an IdP, can itself provide pairwise pseudonymous identifiers to downstream RPs.
                                                                                             Depending on the protocol, the federation proxy may need to map the pairwise pseudonymous
                                                                                             identifiers back to the associated identifiers from upstream IdPs in order to allow the identity
                                                                                             protocol to function. In such cases, the proxy will be able to track and determine which pairwise
                                                                                             pseudonymous identifiers represent the same subscriber at different RPs. The proxy SHALL
                                                                                             NOT disclose the mapping between the pairwise pseudonymous identifier and any other
                                                                                             identifiers to a third party or use the information for any purpose other than federated
                                                                                             authentication, related fraud mitigation, to comply with law or legal process, or in the case of a
                                                                                             specific user request for the information.

                                                                                             6.3.2   Pairwise Pseudonymous Identifier Generation

                                                                                             Pairwise pseudonymous identifiers SHALL contain no identifying information about the
                                                                                             subscriber. They SHALL also be unguessable by a party having access to some information
                                                                                             identifying the subscriber. Pairwise pseudonymous identifiers MAY be generated randomly and
                                                                                             assigned to subscribers by the IdP or MAY be derived from other subscriber information if the
                                                                                             derivation is done in an irreversible, unguessable manner (e.g., using a keyed hash function with
                                                                                             a secret key). Normally, the identifiers SHALL only be known by and used by one pair of
                                                                                             endpoints (e.g., IdP-RP). However, an IdP MAY generate the same identifier for a subscriber at
                                                                                             multiple RPs at the request of those RPs, provided:

                                                                                                •    Those RPs have a demonstrable relationship that justifies an operational need for the
                                                                                                     correlation, such as a shared security domain or shared legal ownership; and
                                                                                                •    All RPs sharing an identifier consent to being correlated in such a manner.

                                                                                             The RPs SHALL conduct a privacy risk assessment to consider the privacy risks associated with
                                                                                             requesting a common identifier. See Section 9.2 for further privacy considerations.

                                                                                             The IdP SHALL ensure that only intended RPs are correlated; otherwise, a rogue RP could learn
                                                                                             of the pseudonymous identifier for a set of correlated RPs by fraudulently posing as part of that
                                                                                             set.




                                                                                                                                             19
