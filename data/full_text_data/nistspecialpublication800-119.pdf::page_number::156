                                                                          GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


tunneling method such as Teredo or IPv6 tunnel broker may be preferable for coping with IPv4 NAT.

NAT-PT has three variations:

          Basic NAT-PT provides translation of IPv6 addresses to a pool of IPv4 addresses. It tracks
           and possibly alters IPv6 port numbers so that multiple IPv6 interfaces can share a single IPv4
           address.
          NAPT-PT (Network Address Port Translator—Protocol Translator) is similar to NAT-PT, but
           it translates port numbers as well to avoid port number collisions that may break applications
           or even be exploited in an attack.
          DNS Application Level Gateway (DNS-ALG) is also specified, but gaps exist, a number of
           problems with it were indentified, the fixes are rather complicated, and it has not been widely
           used. The specifications are unclear about using NAT-PT without DNS-ALG.
6.6.2.2        Security Issues for NAT-PT

IPv4 NAT is often deployed as a security control, a function it was explicitly not intended to perform.
This opinion is widely stated in IETF documents, and it continues to be a point of controversy. Whether
deployed as a security device or to facilitate IPv4/IPv6 interoperability, NAT-PT has security
implications. An Internet Draft61 documents security issues related to NAT-PT. This Internet Draft,
although expired, contains lengthy descriptions of security considerations and some mitigation strategies
that will influence follow-on work. These issues include:

          IPsec, in all modes except ESP tunnel mode, cannot be translated.
          If the translator attempts to reassemble fragments, this allows a DOS attack.
          If the translator can be tricked into using a multicast address, this allows an amplified DOS
           attack.
          NAT-PT is vulnerable to DOS attacks that deplete its address pools.
          NAT-PT is incompatible with DNSSEC.
     6.6.3   Replacing NAT-PT

The IETF is defining two complementary network layer translation mechanisms to replace NAT-PT and
NAPT-PT. These are described in one RFC and four Internet Drafts62:

          Framework for IPv4/IPv6 Translation63
          IP/ICMP Translation Algorithm64
          NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4 Servers65


61
      See the expired IETF Internet Draft, NAT-PT Security Considerations.
62
      These Internet Drafts are works in progress being developed in the IETF’s behave Working Group: Behave Working Group
      Charter; Behave Document Status; Behave Presentations and Minutes.
63
      See the current version of the IETF Internet Draft, Framework for IPv4/IPv6 Translation, Work in Progress.
64
      See the current version of the IETF Internet Draft, IP/ICMP Translation Algorithm, Work in Progress.
65
      See the current version of the IETF Internet Draft, Stateful NAT64: Network Address and Protocol Translation from IPv6
      Clients to IPv4 Servers, Work in Progress.


                                                            6-34
