                                 NIST Special Publication 800-38F


negative integer n, the term “n semiblocks” means a bit string that can be represented as the
concatenation of n semiblocks , or, alternatively, a semiblock string of length n.

For each key-wrap variant, the wrapping function and the unwrapping function are invoked on
three or more semiblocks, although in principle, the definition could be extended to inputs of two
semiblocks. The length of the output is the same as the length of the input for both functions.

KW-AE and TKW-AE are defined on two or more semiblocks. For KWP-AE, the domain of
possible inputs is extended to nonempty octet strings. The upper bounds on the lengths of the
inputs to these functions are discussed in Section 5.3.1.

KW-AD and TKW-AD are defined on three or more semiblocks, and KWP-AD is defined on
two or more semiblocks.

5.3     Limits on Data Length
Mandatory limits on plaintext lengths for each key-wrap variant, and the corresponding limits on
ciphertext lengths, are described in Sec. 5.3.1. Additional, implementation-specific limits on the
data lengths are discussed in Sec. 5.3.2.

5.3.1       Mandatory Limits

The plaintext for KWP shall be an octet string, and KWP-AE is only defined when the length of
the plaintext is less than 232 octets, i.e., 229 semiblocks. KW can accept longer inputs;
nevertheless, the plaintext for KW-AE shall be limited to fewer than 254 semiblocks. The
plaintext for TKW-AE shall be limited to fewer than 228 semiblocks. Consequently, the
ciphertext for KW-AD is 254 or fewer semiblocks, and the ciphertext for TKW-AD is 228 or
fewer semiblocks. The motivation for these restrictions is discussed in Appendix A.4. Along
with the minimum length requirements from Sec. 5.2, this information is summarized in Table 1:

                           Table 1: Summary of Limits on Data Length

      Algorithm        Plaintext             Ciphertext           Reason for Upper Bound

        KW        2 to 254-1 semiblocks 3 to 254 semiblocks requirement—see Appendix A.4

        KWP         1 to 232-1 octets   2 to 229 semiblocks      undefined on other lengths

        TKW       2 to 228-1 semiblocks 3 to 228 semiblocks requirement—see Appendix A.4

Compliance with these requirements is the responsibility of the entities using, implementing,
installing, or configuring applications that incorporate this Recommendation.

5.3.2       Implementation-Specific Limits

Implementations of authenticated-encryption/decryption are not required to accept
plaintext/ciphertext inputs with every length that is described in Table 1. A length that is allowed




                                                10
