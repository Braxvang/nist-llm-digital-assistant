                                               TECHNICAL GUIDE TO INFORMATION SECURITY TESTING AND ASSESSMENT



4.2   Network Port and Service Identification

Network port and service identification involves using a port scanner to identify network ports and
services operating on active hosts—such as FTP and HTTP—and the application that is running each
identified service, such as Microsoft Internet Information Server (IIS) or Apache for the HTTP service.
Organizations should conduct network port and service identification to identify hosts if this has not
already been done by other means (e.g., network discovery), and flag potentially vulnerable services.
This information can be used to determine targets for penetration testing.

All basic scanners can identify active hosts and open ports, but some scanners are also able to provide
additional information on the scanned hosts. Information gathered during an open port scan can assist in
identifying the target operating system through a process called OS fingerprinting. For example, if a host
has TCP ports 135, 139, and 445 open, it is probably a Windows host, or possibly a Unix host running
Samba. Other items—such as the TCP packet sequence number generation and responses to packets—
also provide a clue to identifying the OS. But OS fingerprinting is not foolproof. For example, firewalls
block certain ports and types of traffic, and system administrators can configure their systems to respond
in nonstandard ways to camouflage the true OS.

Some scanners can help identify the application running on a particular port through a process called
service identification. Many scanners use a services file that lists common port numbers and typical
associated services—for example, a scanner that identifies that TCP port 80 is open on a host may report
that a web server is listening at that port—but additional steps are needed before this can be confirmed.
Some scanners can initiate communications with an observed port and analyze its communications to
determine what service is there, often by comparing the observed activity to a repository of information
on common services and service implementations. These techniques may also be used to identify the
service application and application version, such as which Web server software is in use—this process is
known as version scanning. A well-known form of version scanning, called banner grabbing, involves
capturing banner information transmitted by the remote port when a connection is initiated. This
information can include the application type, application version, and even OS type and version. Version
scanning is not foolproof, because a security-conscious administrator can alter the transmitted banners or
other characteristics in hopes of concealing the service’s true nature. However, version scanning is far
more accurate than simply relying on a scanner’s services file.

Scanner models support the various scanning methods with strengths and weaknesses that are normally
explained in their documentation. For example, some scanners work best scanning through firewalls,
while others are better suited for scans inside the firewall. Results will differ depending on the port
scanner used. Some scanners respond with a simple open or closed response for each port, while others
offer additional detail (e.g., filtered or unfiltered) that can assist the assessor in determining what other
types of scans would be helpful to gain additional information.

Network port and service identification often uses the IP address results of network discovery as the
devices to scan. Port scans can also be run independently on entire blocks of IP addresses—here, port
scanning performs network discovery by default through identifying the active hosts on the network. The
result of network discovery and network port and service identification is a list of all active devices
operating in the address space that responded to the port scanning tool, along with responding ports.
Additional active devices could exist that did not respond to scanning, such as those that are shielded by
firewalls or turned off. Assessors can try to find these devices by scanning the devices themselves,




                                                      4-3
