                                                                                             NIST SP 800-204                                                            SECURITY STRATEGIES FOR
                                                                                                                                                        MICROSERVICES-BASED APPLICATION SYSTEMS

                                                                                             5       Security Strategies for Architectural Frameworks in Microservices

                                                                                             The two main architectural frameworks considered in this document for microservices-based
                                                                                             application systems are the API gateway and service mesh. The primary security
                                                                                             considerations in the implementation of the API gateway involve choosing the right platform
                                                                                             for hosting it, proper integration and configuration with enterprise-wide authentication and
                                                                                             authorization frameworks, and securely leveraging the traffic flowing through it for security
                                                                                             monitoring and analysis.

                                                                                             Security strategy for API gateway implementation (MS-SS-12):
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-204




                                                                                                 •    Integrate the API gateway with an identity management application to provision
                                                                                                      credentials before activating the API.
                                                                                                 •    When identity management is invoked through the API gateway, connectors should be
                                                                                                      provided for integrating with identity providers (IdPs).
                                                                                                 •    The API gateway should have a connector to an artifact that can generate an access token
                                                                                                      for the client request (e.g., OAuth 2.0 Authorization Server).
                                                                                                 •    Securely channel all traffic information to a monitoring and/or analytics application for
                                                                                                      detecting attacks (e.g., denial of service, malicious actions) and unearthing explanations
                                                                                                      for degrading performance.
                                                                                                 •    Distributed gateway deployments (or a combination of initial gateway (that intercepts all
                                                                                                      client accesses) and microgateways (closer to microservices)) should have a token
                                                                                                      translation (exchange) service [18] between gateways. The token presented to the initial
                                                                                                      gateway should have permissions with a broad scope whereas the token presented to
                                                                                                      inside gateways (or microgateways) should be more narrowly scoped with specific
                                                                                                      permissions or an entirely different token type that is appropriate for the target
                                                                                                      microservice platform. This helps to implement the least privilege paradigm.

                                                                                             Implementing a service mesh can help ensure that proper configuration parameters associated
                                                                                             with various security policies are defined correctly in the control plane so that the intent of the
                                                                                             security policies are met, and the service mesh alone does not introduce new vulnerabilities.

                                                                                             Security strategy for service mesh implementation (MS-SS-13):

                                                                                                 •    Provide policy support for designating a specific communication protocol between pairs
                                                                                                      of services and specifying the traffic load between pairs of services based on application
                                                                                                      requirements.
                                                                                                 •    The default configuration should always enable access control policies for all services.
                                                                                                 •    Avoid configurations that may lead to privilege escalation (e.g., the service role
                                                                                                      permissions and binding of the service role to service user accounts).
                                                                                                 •    Service mesh deployments should have configuration capabilities to specify resource
                                                                                                      usage limits for its components. The absence of this feature creates the potential for these
                                                                                                      components to impact the resiliency and availability of the overall microservices
                                                                                                      application.


                                                                                                                                               27
