Special Publication 800-73-4                                                          Part 3: PIV Client Application
Interfaces for Personal Identity Verification                                               Programming Interface

3.4.1    pivPutData

Purpose:               Replace the entire data content of the named data object with the provided data.
Prototype:             status_word pivPutData(
                          IN handle            cardHandle,
                          IN string            OID,
                          IN LONG              oidLength,
                          IN sequence of byte data,
                          IN LONG              dataLength
                       );

Parameters:            cardHandle                  Opaque identifier of the card to be acted upon as
                                                   returned by pivConnect.
                       OID                         Object identifier of the object whose data content is to be
                                                   replaced coded as a string; for example,
                                                   “2.16.840.1.101.3.7.2.96.80”. See Part 1, Table 3.
                       oidLength                   Length of the object identifier.

                       data                        Data to be used to replace in its entirety the data content
                                                   of the named data object.
                       dataLength                  Length of the provided data.

Return Codes:          PIV_OK
                       PIV_INVALID_CARD_HANDLE
                       PIV_INVALID_OID
                       PIV_CARD_READER_ERROR
                       PIV_INSUFFICIENT_CARD_RESOURCE
                       PIV_SECURITY_CONDITIONS_NOT_SATISFIED
                       PIV_FUNCTION_NOT_SUPPORTED

3.4.2    pivGenerateKeyPair

Purpose:               Generates an asymmetric key pair in the currently selected card application.

                       If the provided key reference exists and the cryptographic mechanism associated with
                       the reference data identified by this key reference is the same as the provided
                       cryptographic mechanism, then the generated key pair replaces in entirety the key
                       pair currently associated with the key reference.

Prototype:             status_word pivGenerateKeyPair(
                          IN handle               cardHandle,
                          IN byte                 keyReference,
                          IN byte                 cryptographicMechanism,
                          OUT sequence of byte    publicKey,
                          INOUT LONG              KeyLength
                       );

Parameters:            cardHandle                          Opaque identifier of the card to be acted upon as
                                                           returned by pivConnect.

                       keyReference                        The key reference of the generated key pair.


                                                      12
