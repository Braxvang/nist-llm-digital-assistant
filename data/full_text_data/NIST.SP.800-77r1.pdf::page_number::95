                                                                                              NIST SP 800-77 REV. 1                                                                                 GUIDE TO IPSEC VPNS


                                                                                                                Identify other current and future requirements
                                                                                                                Consider the possible technical solutions and select the one that best meets the identified needs
                                                                                               Design the Solution—Architecture (Section 7.2.1)
                                                                                                                Determine where IPsec hosts and gateways should be located within the network architecture
                                                                                                                Select appropriate IPsec client software for hosts
                                                                                                                Determine whether split tunneling should be permitted
                                                                                                                Determine whether IPsec hosts should be issued virtual IP addresses
                                                                                               Design the Solution—IKE Authentication (Section 7.2.2)
                                                                                                                Decide which authentication methods should be supported
                                                                                               Design the Solution—Cryptography (Section 7.2.3)
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                                                Set the cryptographic policy
                                                                                               Design the Solution—High Speed and Large Server Considerations (Section 7.2.4)
                                                                                                                Tune the operating system for optimized network performance
                                                                                               Design the Solution—Packet Filter (Section 7.2.5)
                                                                                                                Determine which types of traffic should be permitted or denied
                                                                                                                Determine what protection and compression measures (if any) should be applied to traffic
                                                                                               Design the Solution—Other Design Considerations (Section 7.2.6)
                                                                                                                Select maximum lifetimes for IKE and IPsec SAs
                                                                                                                Choose IKEv2 or IKEv1; if using IKEv1, choose between main or aggressive mode
                                                                                                                Select an appropriate DH group number for each chosen encryption algorithm and key size
                                                                                                                Determine whether extra padding should be used to thwart traffic analysis
                                                                                                                Enable PFS if it would not negatively impact performance too much

                                                                                              7.3       Implement and Test Prototype

                                                                                              After the solution has been designed, the next step is to implement and test a prototype of the
                                                                                              design. This could be done in one or more environments, including lab, test, and production
                                                                                              networks. 63 Aspects of the solution to evaluate include the following:

                                                                                                    •    Connectivity. Users can establish and maintain connections that use IPsec for all types of
                                                                                                         traffic that are intended to be protected by IPsec and cannot establish connections for
                                                                                                         traffic that IPsec is intended to block. It is important to verify that all of the protocols that
                                                                                                         need to flow through the connection can do so. This should be tested after the initial SA
                                                                                                         negotiation as well as after the original SAs have expired and new IKE and IPsec SAs
                                                                                                         have been negotiated. (During testing, it may be helpful to temporarily shorten the SA
                                                                                                         lifetimes so that renegotiation occurs more quickly.) Connectivity testing should also
                                                                                                         evaluate possible fragmentation-related issues for IKE (e.g., certificates) and ESP (e.g.,
                                                                                                         TCP flow issues).




                                                                                              63    Ideally, implementation and testing should first be performed with a lab network and then a test network. Only
                                                                                                    implementations in final testing should be placed onto a production network. The nature of IPsec allows a phased
                                                                                                    introduction on the production network as well.



                                                                                                                                                             78
