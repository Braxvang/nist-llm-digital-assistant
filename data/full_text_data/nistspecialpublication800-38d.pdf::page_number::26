                                 NIST Special Publication 800-38D


            IV                                   P


            J0               inc32            GCTRK


                 A               0v             C              0u      [len(A)]64     [len(C)]64




                                              GHASHH                                0128


                                               GCTRK                                CIPH
                                                                                     K


                                                MSBt                                 H


                       T              if ≠          T′



                                      FAIL

                           Figure 4: GCM-ADK (IV, C, A, T) = P or FAIL.


8 Uniqueness Requirement on IVs and Keys

The IVs in GCM must fulfill the following “uniqueness” requirement:

The probability that the authenticated encryption function ever will be invoked with the
same IV and the same key on two (or more) distinct sets of input data shall be no greater
than 2-32.

Compliance with this requirement is crucial to the security of GCM. Across all instances of the
authenticated encryption function with a given key, if even one IV is ever repeated, then the
implementation may be vulnerable to the forgery attacks that are described in Ref [5] and
summarized in Appendix A. In practice, this requirement is almost as important as the secrecy
of the key.

The role of key establishment in supporting this requirement is discussed in Sec. 8.1. The two
allowed IV constructions for satisfying this requirement are given in Sec. 8.2. Constraints on the
number of invocations of the authenticated encryption function are given in Sec. 8.3.



                                               18
