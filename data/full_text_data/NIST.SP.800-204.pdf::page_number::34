                                                                                             NIST SP 800-204                                                             SECURITY STRATEGIES FOR
                                                                                                                                                         MICROSERVICES-BASED APPLICATION SYSTEMS

                                                                                             Security (integrity assurance) strategies for handling session persistence (MS-SS-10):

                                                                                                   •    The session information for a client must be stored securely.
                                                                                                   •    The artifact used for conveying the binding server information must be protected.
                                                                                                   •    Internal authorization tokens must not be provided back to the user, and the user's session
                                                                                                        tokens must not be passed beyond the gateway for use in policy decisions.

                                                                                             4.7       Countering Internet-based Attacks

                                                                                             Though it is impossible to protect against all types of Internet-based attacks including botnets,
                                                                                             microservice APIs must be provided with detection and prevention capabilities against
                                                                                             credential-stuffing and credential abuse attacks as well as the capability to detect malicious
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-204




                                                                                             botnets. This is especially critical for those applications where each of the microservices are
                                                                                             independently callable and carry their own sets of credentials. Credential abuse attacks can be
                                                                                             detected using offline threat analysis or run-time solutions [17]. Detection of botnet attacks is
                                                                                             provided by a dedicated bot manager product or as an add-on feature in web application firewalls
                                                                                             (WAF).

                                                                                             Security strategies for preventing credential abuse and stuffing attacks (MS-SS-11):

                                                                                                   •    A run-time prevention strategy for credential abuse is preferable to an offline strategy. A
                                                                                                        threshold for a designated time interval from a given location (e.g., IP address) for the
                                                                                                        number of login attempts should be established; if the threshold is exceeded, preventive
                                                                                                        measures must be triggered by the authentication/authorization server. This feature must
                                                                                                        be present when a bearer token is used, to detect its reuse and enforce prevention.
                                                                                                   •    A credential-stuffing detection solution has the capability to check user logins against the
                                                                                                        stolen credential database and warn legitimate users that their credentials have been
                                                                                                        stolen.
                                                                                                   •    Configure IDS and boundary devices to detect the following: (a) a denial of service attack
                                                                                                        and raise an alert before the service is no longer accessible, and (b) a distributed network
                                                                                                        probe.
                                                                                                   •    Configure service hosts to scan file uploads and the contents of each container's memory
                                                                                                        and file system for resident malware threats.




                                                                                                                                                26
