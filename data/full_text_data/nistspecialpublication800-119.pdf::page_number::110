                                                                               GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


          IPComp can provide lossless compression for IPsec payloads. Because applying compression
           algorithms to certain types of payloads may actually make them larger, IPComp, when used, is
           not applied to such data.


     5.3.2   Differences from IPv4 Standards

All major aspects of IPsec under IPv6 are the same as they are under IPv4. IPsec is defined for both
protocols in the same specifications. AH, ESP, tunnel mode, transport mode, SA, and other aspects of the
protocol are identical to those found within the IPv4 version. Coverage of the IP header in transport
mode, ICMP selectors, and fragmentation handling are different.

Once IPv6 is widely deployed, it is more likely to be deployed with end-to-end addressing rather than
with NAT. Thus, end-to-end IPsec is more feasible with IPv6. Work in the IETF on using IPsec to
secure applications and on IPsec application program interfaces (APIs) may prove to be more useful in
end-to-end IPv6 environments and is discussed in Section 5.3.4.

     5.3.3   Support for Multicast

The current version of IPsec does not fully support protection for multicast traffic, because IPsec was
designed specifically for protecting communications between two points, not among many points at once.
Each multicast packet may have many recipients (see Section 4.2), which raises many IPsec-related
issues. For example, many recipients may need to decrypt the same packet, but sharing a secret key
among them is not a sound security practice.39 Another issue is that many different hosts may be sending
packets to the multicast address. Because each of these hosts needs to share the same authentication
mechanism, one source host can spoof the identity of another source host, and the recipients may not be
able to detect it, eliminating IPsec’s data origin authentication capability. Also, the anti-replay protection
provided by the sequence number is not available, because multiple senders could simultaneously
generate legitimate packets that happen to use the same sequence number. These are but a few examples
of the problems caused by attempting to have IPsec provide support for multicast traffic. In addition, IKE
is inherently a two-party protocol running over UDP. Entirely different key management methods are
needed for multicast.

As of the writing of this guide, researchers have been attempting to find viable ways to extend IPsec so it
can support multicast traffic without losing its methods of protection, particularly source authentication.
RFC 5374, Multicast Extensions to the Security Architecture for the Internet Protocol, discusses the
issues and some approaches toward solutions. One of the biggest challenges is to find a solution that is
not too resource intensive. Because multicast is typically used for applications such as streaming video
that are constantly generating packets, IPsec cannot add too much overhead to the processing of each
packet or the applications’ functionality may be seriously impaired. Researchers expect that multiple
multicast solutions may be created, each addressing a particular multicast need (e.g., single-sender
multicast or multicast groups with a small number of members). It is outside the scope of this document
to examine the proposed methods. Detailed information is available from research efforts that have been
seeking solutions for multicast security issues, including the concluded Group Security Research Group
(GSEC) within the Internet Research Task Force (IRTF)40 and the Multicast Security (MSEC) Working



39
      If the hosts share the same secret key, and one host should no longer have access to the multicast traffic, then the secret key
      needs to be updated on all the remaining hosts in a timely manner. Distributing the new key in a secure manner to all these
      hosts may be extremely challenging.
40
      IRTF home page; GSEC Research Group Web page.


                                                                 5-8
