GUIDE TO INTRUSION DETECTION AND PREVENTION SYSTEMS (IDPS)



Network Management Protocol (SNMP). There are hundreds of unique application layer protocols in
common use, and many more that are not so common. Regardless of the protocol in use, application data
is generated and then passed to the transport layer for further processing.

4.1.2    Transport Layer

The transport layer is responsible for packaging data so that it can be transmitted between hosts. Most
applications that communicate over networks rely on the transport layer to ensure reliable delivery of
data. Generally, this is accomplished by using TCP. When loss of some application data is not a concern
(e.g., streaming audio, video), or the application itself ensures reliable delivery of data, UDP is typically
used. UDP is connectionless; one host simply sends data to another host without any preliminary
negotiations. Each TCP or UDP packet has a source port number and a destination port number. One of
the ports is associated with a server application on one system; the other port is associated with a
corresponding client application on the other system. Client systems typically select any available port
number for application use, whereas server systems usually have a static port number dedicated to each
application. Although UDP and TCP ports are very similar, they are distinct from each other and are not
interchangeable.

4.1.3    Network Layer

The network layer, also known as the IP layer, is responsible for handling the addressing and routing of
data that it receives from the transport layer. After the network layer has encapsulated the transport layer
data, the resulting logical units are referred to as packets. Each packet contains a header, which is
composed of various fields that specify characteristics of the transport protocol in use; optionally, packets
may also contain a payload, which holds the application data. The IP header contains a field called IP
Version, which indicates which version of IP is in use. Typically this is set to 4 for IPv4; but the use of
IPv6 is increasing, so this field may be set to 6 instead. 14 Other significant IP header fields are as
follows:

 Source and Destination IP Addresses. These are the “from” and “to” addresses that are intended to
  indicate the endpoints of the communication. 15 Examples of IP addresses are 10.3.1.70 (IPv4) and
  1000::2F:8A:400:427:9BD1 (IPv6).
 IP Protocol Number. This indicates which network or transport layer protocol the IP payload
  contains. 16 Commonly used IP numbers include 1 (ICMP), 6 (TCP), 17 (UDP), and 50
  (Encapsulating Security Payload [ESP]).
The network layer is also responsible for providing error and status information involving the addressing
and routing of data; it does this with ICMP. ICMP is a connectionless protocol that makes no attempt to
guarantee that its error and status messages are delivered. Because it is designed to transfer limited
information, not application data, ICMP does not have ports; instead, it has message types, which indicate
the purpose of each ICMP message. 17 Some message types also have message codes, which can be
thought of as subtypes. For example, the ICMP message type Destination Unreachable has several




14
     There are other possible IP version numbers as well, although none are commonly used. The official list of valid IP Version
     field values is available at http://www.iana.org/assignments/version-numbers. This document assumes the use of IPv4,
     unless otherwise specified.
15
     IP addresses are often inaccurate or misleading for identifying the actual endpoints of communication.
16
     The official list of valid IP Protocol Number values is available at http://www.iana.org/assignments/protocol-numbers.
17
     The current list of valid ICMP types is available at http://www.iana.org/assignments/icmp-parameters.


                                                              4-2
