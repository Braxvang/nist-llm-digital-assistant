                                  NIST Special Publication 800-38F


6.2   KW
Algorithm 3 specifies the authenticated-encryption function for KW for a given block cipher and
KEK. The wrapping function, W, specified in Algorithm 1 above, is invoked in Step 3 with the
same block cipher and KEK as prerequisites.

Algorithm 3: KW-AE(P)

Prerequisites:
KEK, K, for an approved, 128-bit block cipher;
designated cipher function, CIPHK;
definition of valid plaintext lengths.

Input:
plaintext P, with valid length.

Output:
ciphertext C.

Steps:
    1. Let ICV1 = 0xA6A6A6A6A6A6A6A6.
    2. Let S = ICV1 || P.
    3. Return C = W(S).

Algorithm 4 specifies the authenticated-decryption function for KW for a given block cipher and
KEK. The unwrapping function, W-1, specified in Algorithm 2 above, is invoked in Step 4 with
the same block cipher and KEK as prerequisites.

Algorithm 4: KW-AD(C)

Prerequisites:
KEK, K, for an approved, 128-bit block cipher;
inverse of the designated cipher function, CIPH-1K;
definition of valid ciphertext lengths.

Input:
purported ciphertext, C, with valid length.

Output:
Plaintext P or indication of inauthenticity, FAIL.

Steps:
    1. Let ICV1 = 0xA6A6A6A6A6A6A6A6.
    2. Let S = W-1(C).
    3. If MSB64(S) â‰ ICV1, then return FAIL and stop.
    4. Return P = LSB64(n-1)(S).




                                                 14
