NIST SP 800-85A-4                                       PIV CARD APPLICATION & MIDDLEWARE
                                                                 INTERFACE TEST GUIDELINES

                      4. No other contactless card is within the proximity of the reader.
                      5. Secure messaging has been successfully established by calling the
                         pivEstablishSecureMessaging function.
 Test Steps           1. Tester removes the PIV Card from the reading range of the
                         contactless reader so that the card loses power.
                      2. Tester brings the PIV Card back into range of the
                         contactless reader.
                      3. Set sharedConnection := true
                      4. Set connectionDescription := <<valid connection>>
                      5. Create cardHandle reference
                      6. Call pivConnect with
                         • (IN) sharedConnection
                         • (INOUT) connectionDescription
                         • (INOUT) CDLength
                         • (OUT) cardHandle
                      7. Call pivSelect with (AID of the PIV Card)
                         • (IN) cardHandle
                         • (IN) applicationAID
                         • (IN) AIDLength
                         • (OUT) applicationProperties
                         • (INOUT) APLength
                      8. Call pivGetData with (OID of the X.509 Certificate for
                         Card Authentication)
                         • (IN) cardHandle
                         • (IN) OID
                         • (IN) oidLength
                         • (OUT) data
                         • (INOUT) DataLength
 Expected Result(s)   1. Step 6 returns with status_word of PIV_OK and initialized
                         cardHandle.
                      2. Step 7 returns PIV_OK and the initialized application properties
                         reference.
                      3. Step 8 returns PIV_SM_FAILED.
 Postcondition(s)     Secure Messaging is not established




                                     B-35
