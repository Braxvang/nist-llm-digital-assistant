       NIST SP 800-63C-4 ipd                                               Digital Identity Guidelines
       December 2022                                                       Federation and Assertions


1473   6.2.4. Audience Restriction
1474   Assertions SHALL use audience restriction techniques to allow an RP to recognize
1475   whether or not it is the intended target of an issued assertion. All RPs SHALL check
1476   that the audience of an assertion contains an identifier for their RP to prevent the injection
1477   and replay of an assertion generated for one RP at another RP.

1478   6.2.5. Pairwise Pseudonymous IdentiÔ¨Åers
1479   In some circumstances, it is desirable to prevent the subscriber account from being easily
1480   linked at multiple RPs through use of a common identifier. A pairwise pseudonymous
1481   identifier (PPI) allows an IdP to provide multiple distinct federated identifiers to different
1482   RPs for a single subscriber account. This prevents different RPs from colluding together
1483   to track the subscriber using the federated identifier.

1484   6.2.5.1. General Requirements
1485   When using pairwise pseudonymous identifiers within the assertions generated by the
1486   IdP for the RP, the IdP SHALL generate a different federated identifier for each RP as
1487   described in Sec. 6.2.5.2 below.
1488   When PPIs are used with RPs alongside attributes, it may still be possible for multiple
1489   colluding RPs to re-identify a subscriber by correlation across systems using these
1490   identity attributes. For example, if two independent RPs each see the same subscriber
1491   identified with different pairwise pseudonymous identifiers, they could still determine
1492   that the subscriber is the same person by comparing the name, email address, physical
1493   address, or other identifying attributes carried alongside the pairwise pseudonymous
1494   identifier in the respective assertions. Privacy policies SHOULD prohibit such correlation,
1495   and pairwise pseudonymous identifiers can increase effectiveness of these policies by
1496   increasing the administrative effort in managing the attribute correlation.
1497   Note that in a proxied federation model, the initial IdP may be unable to generate a
1498   pairwise pseudonymous identifier for the ultimate RP, since the proxy could blind the
1499   IdP from knowing which RP is being accessed by the subscriber. In such situations,
1500   the pairwise pseudonymous identifier is generally established between the IdP and
1501   the federation proxy itself. The proxy, acting as an IdP, can itself provide pairwise
1502   pseudonymous identifiers to downstream RPs. Depending on the protocol, the federation
1503   proxy may need to map the pairwise pseudonymous identifiers back to the associated
1504   identifiers from upstream IdPs in order to allow the identity protocol to function. In
1505   such cases, the proxy will be able to track and determine which pairwise pseudonymous
1506   identifiers represent the same subscriber at different RPs. The proxy SHALL NOT
1507   disclose the mapping between the pairwise pseudonymous identifier and any other
1508   identifiers to a third party or use the information for any purpose other than federated
1509   authentication, related fraud mitigation, to comply with law or legal process, or in the
1510   case of a specific user request for the information.


                                                    44
