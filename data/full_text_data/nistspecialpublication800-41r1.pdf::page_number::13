                                                                   GUIDELINES ON FIREWALLS AND FIREWALL POLICY


 The network or transport protocol being used to communicate between source and destination hosts,
  such as TCP, UDP, or ICMP
 Possibly some characteristics of the transport layer communications sessions, such as session source
  and destination ports (e.g., TCP 80 for the destination port belonging to a web server, TCP 1320 for
  the source port belonging to a personal computer accessing the server)
 The interface being traversed by the packet, and its direction (inbound or outbound).
Filtering inbound traffic is known as ingress filtering. Outgoing traffic can also be filtered, a process
referred to as egress filtering. Here, organizations can implement restrictions on their internal traffic, such
as blocking the use of external file transfer protocol (FTP) servers or preventing denial of service (DoS)
attacks from being launched from within the organization against outside entities. Organizations should
only permit outbound traffic that uses the source IP addresses in use by the organization—a process that
helps block traffic with spoofed addresses from leaking onto other networks. Spoofed addresses can be
caused by malicious events such as malware infections or compromised hosts being used to launch
attacks, or by inadvertent misconfigurations.

Stateless packet filters are generally vulnerable to attacks and exploits that take advantage of problems
within the TCP/IP specification and protocol stack. For example, many packet filters are unable to detect
when a packet’s network layer addressing information has been spoofed or otherwise altered, or uses
options that are permitted by standards but generally used for malicious purposes, such as IP source
routing. Spoofing attacks, such as using incorrect addresses in the packet headers, are generally employed
by intruders to bypass the security controls implemented in a firewall platform. Firewalls that operate at
higher layers can thwart some spoofing attacks by verifying that a session is established, or by
authenticating users before allowing traffic to pass. Because of this, most firewalls that use packet filters
also maintain some state information for the packets that traverse the firewall.

Some packet filters can specifically filter packets that are fragmented. Packet fragmentation is allowed by
the TCP/IP specifications and is encouraged in situations where it is needed. However, packet
fragmentation has been used to make some attacks harder to detect (by placing them within fragmented
packets), and unusual fragmentation has also been used as a form of attack. For example, some network-
based attacks have used packets that should not exist in normal communications, such as sending some
fragments of a packet but not the first fragment, or sending packet fragments that overlap each other. To
prevent the use of fragmented packets in attacks, some firewalls have been configured to block
fragmented packets.

Today, fragmented packets on the Internet often occur not because of attacks, but because of virtual
private networking (VPN) technologies that encapsulate packets within other packets. If encapsulating a
packet would cause the new packet to exceed the maximum permitted size for the medium it will be
transmitted on, the packet must be fragmented. Fragmented packets being blocked by firewalls is a
common cause of VPN interoperability issues.

Some firewalls can reassemble fragments before passing them to the inside network, although this
requires additional firewall resources, particularly memory. Firewalls that have this reassembly feature
must implement it carefully, otherwise someone can readily mount a denial-of-service attack. Choosing
whether to block, reassemble, or pass fragmented packets is a tradeoff between overall network
interoperability and full system security. Given this, automatic blocking of all fragmented packets is not
recommended because of the legitimate and necessary uses of fragmentation on the Internet.




                                                     2-3
