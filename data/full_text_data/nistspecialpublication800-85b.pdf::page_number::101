Special Publication 800-85B                                   PIV Data Model Testing Specification


Expected Result(s)      A KeyPurposeId asserting id-PIV-content-signing exists in the extended
                        key usage extension.


10.2.2.2 Verify signer public key size

Purpose                 Confirms that the size of the public key for digital signature used to sign
                        the biometrics is based on the expiration of the PIV card and is in
                        accordance with Table 3-3 of SP80078.
Reference(s)            1.    SP80078, Section 3.1
                        2.    AS06.02.18
Precondition            1.    A valid PIV card is inserted into the contact reader.
                        2.    A valid PC/SC connection exists between the test application and
                              the contact reader.
                        3.    The test application is currently connected to the card application
                              which is accessible through card handle.
                        4.    A valid card holder fingerprint I is present on the PIV card.
Test Steps              1. Set cardHandle := <<valid card handle>>
                        2. Set OID := <<Card Holder Fingerprints
                           (2.16.840.1.101.3.7.2.96.16)>>
                        3. Call pivGetData w/
                           • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                        4. Extract the certificates field contents from the
                           CBEFF_SIGNATURE_BLOCK. If the certificate field is
                           omitted, then stop execution of this test assertion
                        5. Set OID := <<CHUID (2.16.840.1.101.3.7.2.48.0)>>
                        6. Call pivGetData w/
                           • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                        7. Extract the expiration date from the CHUID (i.e. Tag
                           0x35)
                        8. Extract subjectPublicKeyInfo->algorithm->algorithm
                           field value from the certificate obtained
                        9. Extract the subjectPublicKeyInfo->subjectPublicKey
                           from the certificate obtained

                        Note: - Since the ECDSA keys do not have any size
                        restrictions based on dates, this test case does not apply
                        to these types of keys

Expected Result(s)      Verify that the size of the key from Step 9, algorithm from Step 8 and
                        expiration date from Step 7 are consistent with entries in Table 3-3 of
                        SP80078.




                                                                                                     Page 93
