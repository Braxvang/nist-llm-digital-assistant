NIST SP 800-85A-4                                        PIV CARD APPLICATION & MIDDLEWARE
                                                                  INTERFACE TEST GUIDELINES

                       2. The client application is not connected to the PIV Card
                          Application.

B.1.2.2         Attempting to Share/Lock an Exclusive Connection
 Purpose              Ensure that when an exclusive connection is initially established that
                      no additional connections can be established.
 Target                pivConnect
 Reference(s)          1. SP 800-73-4 Part 3, Section 3.1.2
                       2. AS04.01, AS04.02, AS04.02A-R4
 Precondition(s)       1. A valid connection description is provided for the card reader.
                       2. There exists a valid physical connection between an instance of
                          the PIV Card and the client application.
                       3. An application owns an exclusive connection (sharedConnection
                          := false).
 Test Steps            1. Set sharedConnection := true | false
                       2. Set connectionDescription := <<valid connection>>
                       3. Create cardHandle reference
                       4. Call pivConnect with
                          • (IN) sharedConnection
                          • (INOUT) connectionDescription
                          • (INOUT) CDLength
                          • (OUT) cardHandle
 Expected Result(s)    Call returns with status_word of PIV_CONNECTION_LOCKED.
 Postcondition(s)      1. The client application previously connected remains connected.
                       2. The cardHandle variable is not initialized.
                       3. The requesting client application is not connected to the PIV Card
                          Application.


B.1.2.3         Attempting to Lock a Shared Connection
 Purpose              Ensure that the PIV Middleware does not lock a PIV Card
                      Application connection that has an open shared connection.
 Target                pivConnect
 Reference(s)          1. SP 800-73-4 Part 3, Section 3.1.2
                       2. AS04.01, AS04.02, AS04.02A-R4
 Precondition(s)       1. A valid connection description is provided for the card reader.
                       2. There exists a valid physical connection between an instance of
                          the PIV Card and the client application.
                       3. A client application owns a shared connection (sharedConnection
                          := true).
 Test Steps            1. Set sharedConnection := false
                       2. Set connectionDescription := <<valid connection>>
                       3. Create cardHandle reference
                       4. Call pivConnect with
                          • (IN)sharedConnection



                                        B-3
