                                                                                              NIST SP 800-77 REV. 1                                                                                 GUIDE TO IPSEC VPNS


                                                                                              of traffic). The (overloaded) servers are still required to perform full IKE exchanges to all
                                                                                              connecting clients and then redirect them to different server hosts.

                                                                                              Redirected messages sent in IKE_SA_INIT are not authenticated. Clients that accept such
                                                                                              redirected messages should take the necessary precautions to prevent denial-of-service attacks.
                                                                                              The advantage for the host performing the redirection is that it can redirect clients without
                                                                                              performing a full IKE exchange. 33 The disadvantage is that redirections in IKE_SA_INIT cannot
                                                                                              select the specific clients for redirection by their IDs since the client ID has not yet been
                                                                                              transmitted to the server.

                                                                                              Redirected messages can be used to provide a redundant set of servers for the gateway-to-
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              gateway deployment. A failing server can redirect clients to the other (backup) server. In such an
                                                                                              architecture, it is recommended that redirected messages be limited for each endpoint based on
                                                                                              preconfigured IP addresses.

                                                                                              3.9       Differences Between IKEv2 and the Obsolete IKEv1

                                                                                              The IKEv2 protocol builds on the lessons learned with IKEv1. IKEv2 is simpler, faster, and
                                                                                              more secure. IKEv2 has some important new features, such as mobility support (MOBIKE),
                                                                                              support for newer cryptographic algorithms, anti-distributed denial-of-service (DDoS) support,
                                                                                              and server redirection support. It is recommended that existing IKEv1 installations be upgraded
                                                                                              to IKEv2.

                                                                                              For those familiar with IKEv1, the main differences between IKEv1 and IKEv2 are:

                                                                                                    •    IKEv1 was designed to be a far more general-purpose key exchange protocol, but many
                                                                                                         extraneous features were not used. IKEv2 no longer has these features.
                                                                                                    •    Some IKEv1 protocol extensions are now part of the IKEv2 core specification, such as
                                                                                                         IKE fragmentation, 34 NAT traversal, and liveness detection (formerly called dead peer
                                                                                                         detection [DPD]). This means that these features are always available in IKEv2.
                                                                                                    •    IKEv1 has a large number of exchange types to choose from (e.g., main mode, aggressive
                                                                                                         mode, revised mode, etc.). With IKEv2, there is no choice of exchange methods, so this
                                                                                                         no longer needs to be explicitly configured.
                                                                                                    •    The IKEv2 exchange has anti-DDoS protection using cookies.
                                                                                                    •    When an IKEv1 endpoint uses the wrong PSK to encrypt a message, the other endpoint is
                                                                                                         unable to decrypt the encrypted message. For the endpoint receiving this erroneous
                                                                                                         message, it has no way to distinguish this error from other problems such as packet
                                                                                                         corruption.




                                                                                              33    Most importantly, it can skip the DH calculation, which is the most expensive operation of an IKE exchange.
                                                                                              34    Technically, IKE fragmentation is a separate RFC, but it is implemented by most vendors.



                                                                                                                                                             33
