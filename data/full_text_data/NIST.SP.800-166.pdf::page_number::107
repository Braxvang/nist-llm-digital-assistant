NIST SP 800-166                                                  DERIVED PIV APPLICATION AND
                                                                 DATA MODEL TEST GUIDELINES

                          7. Determine the digest algorithm specified in the
                             digestAlgorithm field obtained in Step 3 using
                             Table 3-6 of [SP800-78].
                          8. Match the digest algorithm obtained from Step 7 to
                             an entry of Table 3-2 of [SP800-78] based on the
                             public key algorithm and size (Step 6).
 Expected Result(s)       1. From Step 1, the command returns the application property
                             template with the status word '90 00'.
                          2. From Step 2, the command the requested data object along with
                             the returns status word '90 00'.
                          3. From Step 8, the digestAlgorithm field value of the SignerInfo
                             is in accordance with Tables 3-6 and 3-2 of [SP800-78] and it
                             matches the value present in the digestAlgorithms field of the
                             SignedData.

9.2.1.8 SignerInfo signatureAlgorithm

 Test Assertion           TA-09.02.01.08
 Purpose                  Verifies that for RSA with PKCS #1 v1.5 padding, the
                          signatureAlgorithm field specifies the rsaEncryption OID (as per
                          Section 3.2 of [RFC3370]) and for ECDSA and RSA with PSS
                          padding, the signatureAlgorithm is in accordance with Table 3-3 of
                          [SP800-78].
 DTR(s)                   • DTR-07.02.01.10
 Issuer Documentation     None.
 Precondition(s)          • A token with the Derived PIV Application is inserted into an
                              appropriate token reader.
                          • Suitable drivers have been loaded between the test system and
                              an instance of the reader.
                          • A Security Object is present within the Derived PIV
                              Application.
 Test Scenario            1. Send the SELECT command with
                                • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                          2. Send the GET DATA command with
                                • Data field of the command containing the tag
                                   ('5FC106') of the Security Object
                          3. From the signature block (tag 0xBB) match the
                             SignerInfo->signatureAlgorithm field contents to an
                             entry in Table 3-3 of [SP800-78].
 Expected Result(s)       1. From Step 1, the command returns the application property
                             template with the status word '90 00'.
                          2. From Step 2, the command returns the requested data object
                             along with the status word '90 00'.
                          3. From Step 3, the signatureAlgorithm field specified in the
                             SignerInfo field for RSA with PKCS #1 v1.5 padding specifies
                             the rsaEncryption OID (as per Section 3.2 of [RFC3370]) and
                             for ECDSA and RSA with PSS padding, the



                                          100
