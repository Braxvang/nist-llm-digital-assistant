NIST SP 800-85A-4                                      PIV CARD APPLICATION & MIDDLEWARE
                                                                INTERFACE TEST GUIDELINES

C.2.1.3        Secure Messaging Interface
 Purpose              Validates that only the paring code and OCC succeed in the VERIFY
                      command through the contactless interface using secure messaging
                      when a VCI has not been established.
 Reference(s)         1. SP 800-73-4 Part 2, Table 2
                      2. SP 800-73-4 Part 1, Table 4
                      3. AS05.03, AS05.04, AS05.13A-R4, AS05.13B-R4, AS05.15, and
                         AS05.16A-R4
 Precondition(s)      1. The IUT is placed within the reading range of the contactless
                         reader.
                      2. There exists a valid PC/SC connection between the test system
                         and the contactless reader.
                      3. No other contactless card is within the proximity of the reader.
                      4. The PIV Card Application is the currently selected application.
                      5. Secure messaging session keys have been established and secure
                         messaging is used in the test scenario.
 Test Scenario        NOTE: set CLA byte to '0C' for all commands to ensure they
                     are sent over secure messaging.
                     1. Send GET DATA command with
                        • Data field of the command containing the tag of the
                           Discovery Object. Parse the PIN Usage Policy to
                           discover the PIN, Pairing Code and OCC supported by the
                           card. Perform the test for all cases that match the PIN
                           Usage Policy
                     2. Perform the test for all cases that match the PIN Usage
                        Policy
                        2a. Test case for the mandatory PIV Card Application PIN
                             ('80')
                              1. Perform step 2a in C.2.1.2
                        2b. Test case for implementations that support the Global
                             PIN ('00') for PIV data access and command execution
                             as indicated by the Discovery Object’s PIN Usage
                             Policy
                              1. Perform step 2b in C.2.1.2
                        2c. Test case for implementations that support OCC ('96'
                            and '97') for PIV data access and command execution
                            as indicated by the Discovery Object’s PIN Usage
                            Policy
                              1. Send VERIFY card command with
                                 • P2, key reference value is set to '96'
                                 • Data field of the command will contain a value
                                    that matches the Primary Finger OCC value
                              2. Send VERIFY card command with
                                 • P2, key reference value is set to '97'
                                 • Data field of the command will contain a value
                                    that matches the Secondary Finger OCC value
                              3. Send VERIFY card command with
                                 • P2, key reference value is set to '80'
                                 • Data field of the command will contain the
                                    correct cardholder PIV Card Application PIN



                                     C-16
