NIST SP 800-38G                                         METHODS FOR FORMAT-PRESERVING ENCRYPTION


expected 128 bits of security strength. NIST cryptographers confirmed this assessment via the
security analysis in [5] and announced the removal of FF2 in [8]. An extension of the
VAES3/FF2 proposal [16] was submitted for NIST’s consideration in November 2015.

Each of these FPE modes fits within a larger framework, called FFX, for constructing FPE
mechanisms; FFX was submitted to NIST in [1]. The “X” indicates the flexibility to instantiate
the framework with different parameter sets, as well as FFX’s evolution from its precursor, the
Feistel Finite Set Encryption Mode.

The FFX framework itself is not specified in this publication; in fact, FF1 and FF3 are not
presented explicitly as instantiations of FFX parameter sets, but rather as separate algorithms, in
order to simplify the individual specifications.

FF1 and FF3 each employ the Feistel structure—see Sec. 4.5—which also underlies the Triple
Data Encryption Algorithm (TDEA) [12]. At the core of FF1 and FF3 are somewhat different
Feistel round functions that are derived from an approved block cipher with 128-bit blocks, i.e.,
the Advanced Encryption Standard (AES) algorithm [10].

In addition to the formatted data for which the modes provide confidentiality, each mode also
takes an additional input called the “tweak,” which is not necessarily secret. The tweak can be
regarded as a changeable part of the key, because together they determine the encryption and
decryption functions. Tweaks that vary can be especially important for implementations of FPE
modes, because the number of possible values for the confidential data is often relatively small,
as discussed in Appendix A and Appendix C.

FF1 and FF3 offer somewhat different performance advantages. FF1 supports a greater range of
lengths for the protected, formatted data, as well as flexibility in the length of the tweak. FF3
achieves greater throughput, mainly because its round count is eight, compared to ten for FF1.

3      Definitions and Notation

3.1     Definitions

alphabet              A finite set of two or more symbols.

                      FIPS-approved or NIST-recommended: an algorithm or technique that is
approved              either 1) specified in a FIPS or a NIST Recommendation, or 2) adopted in a
                      Federal Information Processing Standard (FIPS) or a NIST Recommendation.

base                  The number of characters in a given alphabet. The base is denoted by radix.

bit                   A binary digit: 0 or 1.

bit string            A finite, ordered sequence of bits.

                      For a given block cipher, a bit string whose length is the block size of the
block
                      block cipher.


                                                   2
