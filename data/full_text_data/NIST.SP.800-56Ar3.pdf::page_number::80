                                                                                               NIST SP 800-56A Rev. 3                                Recommendation for Pair-Wise Key Establishment
                                                                                                                                                             Using Discrete Logarithm Cryptography

                                                                                                      key yV. If the call to the FFC DH primitive outputs an error indicator, destroy the
                                                                                                      ephemeral private key rU, and destroy the results of all intermediate calculations used
                                                                                                      in the attempted computation of Zs; then output an error indicator, and exit this
                                                                                                      process without performing the remaining actions.
                                                                                                  4. Use the FFC DH primitive to derive a shared secret Ze from the set of domain
                                                                                                     parameters D, party U’s ephemeral private key rU, and party V’s ephemeral public
                                                                                                     key tV. If this call to the FFC DH primitive outputs an error indicator, destroy Zs and
                                                                                                     the ephemeral private key rU,, and destroy the results of all intermediate calculations
                                                                                                     used in the attempted computation of Ze; then, output an error indicator, and exit this
                                                                                                     process without performing the remaining actions.
                                                                                                  5. Compute the shared secret Z = Ze || Zs. Destroy Ze and Zs.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                                  6. Use the agreed-upon key-derivation method to derive secret keying material with the
                                                                                                     specified length from the shared secret value Z and other input (see Section 5.8). If
                                                                                                     the key-derivation method outputs an error indicator, destroy all copies of Z and the
                                                                                                     ephemeral private key rU, then output an error indicator, and exit this process without
                                                                                                     performing the remaining actions.
                                                                                                  7. Destroy rU and all copies of the shared secret Z.
                                                                                                  8. Output the derived keying material.
                                                                                               Output: The derived keying material or an error indicator.
                                                                                               Note: Key confirmation can be incorporated into this scheme. See Section 6.1.1.5 for details.
                                                                                               dhHybrid1 is summarized in Table 9.
                                                                                                                 Table 9: dhHybrid1 key-agreement scheme summary

                                                                                                                                    Party U                                Party V

                                                                                                Domain                  D = (p, q, g{, SEED, counter})      D = (p, q, g{, SEED, counter})
                                                                                                parameters

                                                                                                Static Data             Static private key xU               Static private key xV
                                                                                                                        Static public key yU                Static public key yV

                                                                                                                        Ephemeral private key rU            Ephemeral private key rV
                                                                                                Ephemeral Data
                                                                                                                        Ephemeral public key tU             Ephemeral public key tV

                                                                                                                        1. Compute Zs by calling FFC 1. Compute Zs by calling FFC DH
                                                                                                                           DH using xU and yV           using xV and yU
                                                                                                Computation             2. Compute Ze by calling FFC 2. Compute Ze by calling FFC DH
                                                                                                                           DH using rU and tV           using rV and tU
                                                                                                                        3. Compute Z = Ze || Zs             3. Compute Z = Ze || Zs


                                                                                                                                                69
