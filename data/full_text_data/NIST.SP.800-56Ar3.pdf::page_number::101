                                                                                               NIST SP 800-56A Rev. 3                              Recommendation for Pair-Wise Key Establishment
                                                                                                                                                           Using Discrete Logarithm Cryptography


                                                                                                                        1. Compute                          1. Compute
                                                                                                Derive secret              DerivedKeyingMaterial               DerivedKeyingMaterial
                                                                                                keying material
                                                                                                                        2. Destroy Z                        2. Destroy Z

                                                                                               6.2.1.4 One-Pass MQV, C(1e, 2s, ECC MQV) Scheme
                                                                                               This section describes the One-Pass MQV scheme. Assurance of secure key establishment
                                                                                               using this scheme can only be obtained when the assumptions in Section 6.2.1 are true. In
                                                                                               particular, it is assumed that party U has obtained the static public key Qs,V of party V, and
                                                                                               party V has obtained the static public key Qs,U of party U.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                               In this scheme, each party has different actions, which are presented separately below.
                                                                                               However, note that party U and party V must use identical orderings of the bit strings that
                                                                                               are input to the key-derivation method.
                                                                                               Party U shall execute the following actions to a) establish a shared secret value Z with party
                                                                                               V, and b) derive secret keying material from Z.
                                                                                               Actions: Party U generates a shared secret and derives secret keying material as follows:
                                                                                                  1. Generate an ephemeral key pair (de,U, Qe,U) from the domain parameters D as specified
                                                                                                     in Section 5.6.1.2. Send the public key Qe,U to party V.
                                                                                                  2. Use the One-Pass MQV form of the ECC MQV primitive in Section 5.7.2.3.2 to
                                                                                                     derive a shared secret value Z from the set of domain parameters D, party U’s static
                                                                                                     private key ds,U, party V’s static public key Qs,V, party U’s ephemeral private key de,U,
                                                                                                     party U’s ephemeral public key Qe,U, and (for a second time) party V’s static public
                                                                                                     key Qs,V. If the call to the ECC MQV primitive outputs an error indicator, destroy the
                                                                                                     ephemeral private key de,U, and destroy the results of all intermediate calculations
                                                                                                     used in the attempted computation of Z; then output an error indicator, and exit this
                                                                                                     process without performing the remaining actions.
                                                                                                  3. Use the agreed-upon key-derivation method to derive secret keying material with the
                                                                                                     specified length from the shared secret value Z and other input (see Section 5.8). If
                                                                                                     the key-derivation method outputs an error indicator, destroy all copies of Z and the
                                                                                                     ephemeral private key de,U; then output an error indicator, and exit this process
                                                                                                     without performing the remaining actions.
                                                                                                  4. Destroy de,U and all copies of the shared secret Z.
                                                                                                  5.   Output the derived keying material.
                                                                                               Output: The derived keying material or an error indicator.

                                                                                               Party V shall execute the following actions to a) establish a shared secret value Z with party
                                                                                               U, and b) derive shared secret keying material from Z.
                                                                                               Actions: Party V derives secret keying material as follows:




                                                                                                                                             90
