NIST SP 800-166                                                   DERIVED PIV APPLICATION AND
                                                                  DATA MODEL TEST GUIDELINES

                              •  A Key History Object followed by status word '90 00';
                              •  A zero-length data object followed by status word '90 00' -
                                 which indicates that a container for the Key History Object
                                 exists, but it has not been personalized; or
                             • Status word '6A 82' (data object not found) - which
                                 indicates the container for the Key History Object does not
                                 exist
                          3. From Step 3, all mandatory tags for the Key History Object are
                             present in the order indicated in Table 19 of [SP800-73], Part 1.
                          4. From Step 4, the command returns status word '90 00' along
                             with the Security Object.

9.1.6 Retired X.509 Certificates for Key Management

9.1.6.1 BER-TLV of Retired X.509 Certificates for Key Management

 Test Assertion           TA-09.01.06.01
 Purpose                  Verifies that the Retired X.509 Certificates for Key Management
                          (if present) conform to the Derived PIV data model requirements.
 DTR(s)                   • DTR-07.01.01.01
                          • DTR-07.01.07.01
 Issuer Documentation     None.

 Precondition(s)          •   A token with the Derived PIV Application is inserted into an
                              appropriate token reader.
                          •   Suitable drivers have been loaded between the test system and
                              an instance of the reader.
 Test Scenario            1. Send the SELECT command with
                                • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                          2. Send 20 GET DATA commands with
                                • Data field of each command containing the tag
                                   ('5FC10D' to '5FC120') for one of the 20
                                   Retired X.509 Certificates for Key Management
                          3. For each Retired X.509 Certificate for Key
                             Management retrieved in Step 2, read and parse the
                             byte array for each in accordance with BER-TLV
                             format.
 Expected Result(s)       1. From Step 1, the command returns the application property
                             template with the status word '90 00'.
                          2. From Step 2, each command returns one of the following:
                              • A Retired X.509 Certificate for Key Management followed
                                by status word '90 00';
                              • A zero-length data object followed by status word '90 00' –
                                which indicates that a container for the retired X.509
                                certificate exists, but it has not been personalized; or
                              • Status word '6A 82' (data object not found) – which



                                           93
