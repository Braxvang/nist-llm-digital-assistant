                                                                              GUIDE TO COMPUTER SECURITY LOG MANAGEMENT



          –    System or security administrators for a particular system are often responsible for analyzing
               its logs, but not for analyzing its log data on infrastructure log servers.56 Accordingly, the
               system logs need to contain all data of interest to the system-level administrators.
      Infrastructure level only. If logs are stored on the infrastructure servers, generally it is
       preferable to also store them at the system level. However, this is not always possible, such as
       systems with little capacity for logs or log sources not capable of storing logs locally (e.g., an
       application that can only log to a remote logging server).
Configuring log sources to store entries in the necessary locations, as well as transmit entries to the log
management infrastructure, can be tricky. As mentioned at the beginning of Section 5.1, log sources vary
greatly in their customizability. Examples are as follows:

      Some can only log to a single system log file. Log management infrastructures typically support
       common log file formats, such as comma-separated or tab-separated values, syslog, and
       databases. Some infrastructures also support the most popular proprietary log formats. If a log
       format is not supported by the infrastructure software, system-level administrators may need to
       get log conversion programs that can be run periodically to convert the logs to a format that the
       infrastructure can use. If this is not an option, then administrators may have to perform regular
       manual reviews of the log, and the log contents will not be sent to the infrastructure servers. Log
       sources that store their data in proprietary formats typically provide log viewer or analysis tools
       to assist administrators in performing analysis.
      Some can use multiple types of system logs, such as a proprietary format log or a standard format
       log (e.g., syslog). In many cases, the logs do not contain all of the same data; proprietary format
       logs often contain more data fields than the standard format logs. One option with some log
       sources is to send data to multiple system logs simultaneously. This allows system-level
       administrators to perform their analysis using the proprietary format logs, while making much of
       the data available in a standard format for the log management infrastructure.
      Some can log both at the system level and the infrastructure level simultaneously. It is even
       possible with some log sources to specify which types of log entries should go to each source,
       rather than sending the same entries to each log source.
Local log rotation is another important part of configuring log sources. System-level and infrastructure
administrators should configure all log sources to perform log rotation, preferably both at a regular time
(e.g., hourly, daily, weekly) and when a maximum log size is reached (e.g., 1 megabyte [MB], 10 MB,
100 MB).57 If a log source does not provide a log rotation capability, an administrator might need to
deploy a separate log rotation utility or script for the logs. Some log sources do not lend themselves to
third-party log rotation, such as some logs in proprietary formats. In these cases, the log sources typically
offer the administrator choices on what to do when the log becomes full, such as the following:

      Stop logging. This is generally an unacceptable option because it permits operations to continue
       without allowing monitoring of related security events.



56
     Some organizations allow system-level administrators to access their systems’ log data stored on the log management
     infrastructure’s log servers. This most often occurs for systems that cannot log locally or cannot retain log information for
     longer than a brief period.
57
     Administrators should be aware that log rotation is not always performed cleanly. Events in progress at the time that a log is
     rotated may have their associated log entries split between two log files. In some cases, the log source may continue to
     update the old log for events that were already in progress, so the archived log file might actually continue to change for
     some period of time, typically minutes.


                                                               5-3
