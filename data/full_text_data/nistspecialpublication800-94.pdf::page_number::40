GUIDE TO INTRUSION DETECTION AND PREVENTION SYSTEMS (IDPS)



        not be able to see all traffic, or spanning might be temporarily disabled. Also, many switches
        have only one spanning port, and there is often a need to have multiple technologies, such as
        network monitoring tools, network forensic analysis tools, and other IDPS sensors, monitor the
        same traffic.

    –   Network Tap. A network tap is a direct connection between a sensor and the physical network
        media itself, such as a fiber optic cable. The tap provides the sensor with a copy of all network
        traffic being carried by the media. Installing a tap generally involves some network downtime,
        and problems with a tap could cause additional downtime. Also, unlike spanning ports, which are
        usually already present throughout an organization, network taps need to be purchased as add-ons
        to the network.

    –   IDS Load Balancer. An IDS load balancer is a device that aggregates and directs network
        traffic to monitoring systems, including IDPS sensors. A load balancer can receive copies of
        network traffic from one or more spanning ports or network taps and aggregate traffic from
        different networks (e.g., reassemble a session that was split between two networks). The load
        balancer then distributes copies of the traffic to one or more listening devices, including IDPS
        sensors, based on a set of rules configured by an administrator. The rules tell the load balancer
        which types of traffic to provide to each listening device. Common configurations include the
        following:

            •   Send all traffic to multiple IDPS sensors. This could be done for high availability or to
                have multiple types of IDPS sensors perform concurrent analysis of the same activity.

            •   Dynamically split the traffic among multiple IDPS sensors based on volume. This is
                typically done to perform load balancing so that no sensor is overwhelmed with the
                amount of traffic and corresponding analysis.

            •   Split the traffic among multiple IDPS sensors based on IP addresses, protocols, or
                other characteristics. This could be done for load balancing purposes, such as having
                one IDPS sensor dedicated to Web activity and another IDPS sensor monitoring all other
                activity. Splitting traffic could also be done to perform more detailed analysis of certain
                types of traffic (e.g., activity involving the most important hosts).
        Splitting traffic among multiple IDPS sensors can cause a reduction in detection accuracy if
        related events or portions of a single event are seen by different sensors. For example, suppose
        that two sensors each see different steps of an attack; if each step is considered benign on its own
        but the two steps in sequence are malicious, then the attack might not be recognized.

Figure 4-3 shows examples of passive sensors connected to the monitored network using IDS load
balancers, network taps, and spanning ports.

As explained in Section 4.3.4, most techniques for having a sensor prevent intrusions require that the
sensor be deployed in inline mode, not passive. Because passive techniques monitor a copy of the traffic,
they typically provide no reliable way for a sensor to stop the traffic from reaching its destination. In
some cases, a passive sensor can place packets onto a network to attempt to disrupt a connection, but such
methods are generally less effective than inline methods. Generally, organizations should deploy sensors
inline if prevention methods will be used and passive if they will not.




                                                    4-6
