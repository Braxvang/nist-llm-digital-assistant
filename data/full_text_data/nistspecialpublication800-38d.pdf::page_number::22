                                     NIST Special Publication 800-38D


       8. Let Y = Y1 || Y2 || ... || Yn∗ .
       9. Return Y.

In Steps 1 and 2, the input string of arbitrary length is partitioned into a sequence of blocks to the
greatest extent possible, so that only the rightmost string in the sequence may be a “partial”
block. In Steps 3 and 4, the 32-bit incrementing function is iterated on the initial counter block
input to generate a sequence of counter blocks; the input block is the first block of the sequence.
In Steps 5 and 6, the block cipher is applied to the counter blocks and the results are XORed with
the corresponding blocks (or partial block) of the partition of the input string. In Step 7, the
sequence of results is concatenated to form the output.

Figure 2 below illustrates the GCTR function.

               ICB             inc            CB2        …            CBn-1           inc          CBn


             CIPHK                           CIPHK                   CIPHK                        CIPHK

      X1        ⊕                    X2       ⊕              Xn-1      ⊕                    Xn*    ⊕

                Y1                            Y2         …             Yn-1                        Y n*


                     Figure 2: GCTRK (ICB, X1 || X2 || ... || Xn*) = Y1 || Y2 || ... || Yn*.


7 GCM Specification

Algorithms 4 and 5 for the authenticated encryption and authenticated decryption functions of
GCM are specified in Secs. 7.1 and 7.2 below. The specifications include the inputs, the outputs,
the steps of the algorithm, diagrams, and summaries. The suggested notation does not indicate
the choice of the underlying block cipher. The inputs that are typically fixed across many
invocations of the function are called the prerequisites; however, some of the prerequisites may
also be regarded as (varying) input. The prerequisites and the other inputs shall meet the
requirements in Sec. 5.

For both algorithms, equivalent sets of steps that produce the correct output are permitted. For
example, in Algorithm 5, the verification of the tag may precede the computation of the
plaintext.

7.1   Algorithm for the Authenticated Encryption Function

Algorithm 4 below specifies the authenticated encryption function:




                                                       14
