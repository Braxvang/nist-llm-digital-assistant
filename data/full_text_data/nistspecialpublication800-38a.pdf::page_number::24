Appendix A: Padding

For the ECB, CBC, and CFB modes, the plaintext must be a sequence of one or more complete
data blocks (or, for CFB mode, data segments). In other words, for these three modes, the total
number of bits in the plaintext must be a positive multiple of the block (or segment) size.

If the data string to be encrypted does not initially satisfy this property, then the formatting of the
plaintext must entail an increase in the number of bits. A common way to achieve the necessary
increase is to append some extra bits, called padding, to the trailing end of the data string as the
last step in the formatting of the plaintext. An example of a padding method is to append a
single ‘1’ bit to the data string and then to pad the resulting string by as few ‘0’ bits, possibly
none, as are necessary to complete the final block (segment). Other methods may be used; in
general, the formatting of the plaintext is outside the scope of this recommendation.

For the above padding method, the padding bits can be removed unambiguously, provided the
receiver can determine that the message is indeed padded. One way to ensure that the receiver
does not mistakenly remove bits from an unpadded message is to require the sender to pad every
message, including messages in which the final block (segment) is already complete. For such
messages, an entire block (segment) of padding is appended. Alternatively, such messages can
be sent without padding if, for every message, the existence of padding can be reliably inferred,
e.g., from a message length indicator.




                                                  17
