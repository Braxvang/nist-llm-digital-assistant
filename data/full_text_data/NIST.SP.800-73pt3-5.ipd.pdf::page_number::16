      NIST SP 800-73pt3-5 ipd (Initial Public Draft)              Interfaces for Personal Identity Verification: Part 3
      September 2023                                                                                  PIV Client API

338   Parameters: cardHandle                           Opaque identifier of the card to be acted upon as
339                                                    returned by pivConnect
340                    aidLength                       Length of the PIV Card Application AID
341                    applicationAID                  The AID of the PIV Card Application that is to
342                                                    become the currently selected card application
343                    applicationProperties           The application properties of the selected PIV Card
344                                                    Application; see SP 800-73-5 Part2, Table 3
345                    APLength                        As an input, length of the buffer allocated for
346                                                    applicationProperties; as an output, length of the
347                                                    application properties
348   Return Codes:             PIV_OK
349                             PIV_INVALID_CARD_HANDLE
350                             PIV_CARD_APPLICATION_NOT_FOUND
351                             PIV_CARD_READER_ERROR
352                             PIV_INSUFFICIENT_BUFFER

353   If the length of application properties is longer than the buffer allocated by the client application,
354   then the PIV Middleware SHALL return PIV_INSUFFICIENT_BUFFER but SHALL still set
355   APLength to the length of the application properties.

356   3.2.2. pivEstablishSecureMessaging
357   Purpose:         Establish secure messaging with the PIV Card Application.
358   Prototype:       status_word pivEstablishSecureMessaging(
359                    IN handle         cardHandle,
360                             );

361   Parameters: cardHandle                                Opaque identifier of the card to be acted upon as
362                                                         returned by pivConnect
363   Return Codes:             PIV_OK
364                             PIV_INVALID_CARD_HANDLE
365                             PIV_CARD_READER_ERROR
366                             PIV_SM_FAILED

367   After successful execution of the key establishment protocol, the PIV Middleware SHALL
368   perform all subsequent GET DATA, VERIFY, and GENERAL AUTHENTICATE commands
369   over secure messaging with the exception of any subsequent uses of the GENERAL
370   AUTHENTICATE command to perform the key establishment protocol.

371   3.2.3. pivLogIntoCardApplication
372   Purpose:         Set the security state within the PIV Card Application.


                                                        8
