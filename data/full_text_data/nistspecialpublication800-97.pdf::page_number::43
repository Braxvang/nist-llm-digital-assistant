                                          ESTABLISHING WIRELESS ROBUST SECURITY NETWORKS: A GUIDE TO IEEE 802.11I




                                            Figure 4-6. Group Key Hierarchy




4.2.2     Group Key Hierarchy

The second key hierarchy defined by IEEE 802.11 is the Group Key Hierarchy, which is depicted in
Figure 4-6 and consists of a single key, the Group Temporal Key (GTK). Unlike the PMK, which is
generated using material from both supplicant and authenticator, the GTK is generated by the
authenticator (AP) and transmitted to its associated STAs. Exactly how this GTK is generated is
undefined and is likely to vary considerably in various vendor implementations, with possible
implications for security. IEEE 802.11i, however, requires that its value is computationally
indistinguishable from random.

The GTK is a 256-bit value for TKIP, 128 bit value for CCMP, and 40- or 104-bit value for WEP. Figure
4-6 also shows the time or condition under which each key is changed.

Table 4-1 presents all of the keys used in IEEE 802.11, as introduced by the IEEE 802.11i amendment.

4.3     Overview of RSN Data Confidentiality and Integrity Protocols

The IEEE 802.11i amendment defines two RSNA data confidentiality and integrity protocols: Temporal
Key Integrity Protocol (TKIP) and Counter Mode with Cipher Block Chaining MAC Protocol (CCMP).
According to its designers, TKIP was created to allow already-deployed devices to address the numerous
inadequacies of WEP. TKIP may be implemented through software updates; it does not require hardware
replacement of AP and STAs. However, because TKIP uses RC4 and the Michael message integrity code
(MIC) (described in Section 4.3.1.2), both of which have known weaknesses, TKIP is not suitable for
high assurance environments. For these environments, CCMP is considered the better solution.
However, CCMP requires computing resources that cannot be assumed on pre-RSN hardware. In nearly
all cases, organizations seeking to deploy IEEE 802.11 RSNs based on CCMP will need to replace some
of their existing IEEE 802.11 equipment. 37 Support for CCMP is mandatory for any device claiming
RSNA compliance, while TKIP support is optional. TKIP and CCMP are described further in Sections
4.3.1 and 4.3.2, respectively.




37
      A software upgrade to support CCMP is possible on most laptops, but not on most PDAs and APs.


                                                            4-7
