                                                                                             NIST SP 800-90B                                                            RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                                USED FOR RANDOM BIT GENERATION

                                                                                                   continuously, or on-demand), and include rationale indicating why each test is believed to be
                                                                                                   appropriate for detecting one or more failures in the noise source.
                                                                                             8. The submitter shall provide documentation of any known or suspected noise source failure
                                                                                                modes (e.g., the noise source starts producing periodic outputs like 101…01), and shall
                                                                                                include developer-defined continuous tests to detect those failures. These should include
                                                                                                potential failure modes that might be caused by an attack on the device.
                                                                                             9. Appropriate health tests that are tailored to the noise source should place special emphasis on
                                                                                                the detection of misbehavior near the boundary between the nominal operating environment
                                                                                                and abnormal conditions. This requires a thorough understanding of the operation of the noise
                                                                                                source.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                             4.4     Approved Continuous Health Tests

                                                                                             This recommendation provides two approved health tests: the Repetition Count test, and the
                                                                                             Adaptive Proportion test. If these two health tests are included among the continuous health tests
                                                                                             of the entropy source, no other tests are required. However, the developer is advised to include
                                                                                             additional continuous health tests tailored to the noise source.
                                                                                             Both tests are designed to require minimal resources, and to be computed on-the-fly while noise
                                                                                             source samples are being produced, possibly conditioned, and output by the entropy source.
                                                                                             Neither test needs to delay the availability of the noise source samples.
                                                                                             Like all statistical tests, both of these tests have a false positive probability – the probability that a
                                                                                             correctly functioning noise source will fail the test on a given output. In many applications, a
                                                                                             reasonable choice for the probability of type I error is α = 2−20; this value will be used in all the
                                                                                             calculations in the rest of this section. The developer of the entropy source shall determine a
                                                                                             reasonable probability of type I error (and corresponding cutoff values), based the details of the
                                                                                             entropy source and its consuming application.
                                                                                             4.4.1     Repetition Count Test

                                                                                             The goal of the Repetition Count Test is to quickly detect catastrophic failures that cause the noise
                                                                                             source to become "stuck" on a single output value for a long period of time. It can be considered
                                                                                             as an update of the "stuck test" that was previously required for random number generators within
                                                                                             FIPS-approved cryptographic modules. Note that this test is intended to detect a total failure of the
                                                                                             noise source.
                                                                                             Given the assessed min-entropy H of a noise source, the probability 9 of that source generating n
                                                                                             identical samples consecutively is at most 2−H(n-1). The test declares an error if a sample is repeated
                                                                                             C or more times. The cutoff value C is determined by the acceptable false-positive probability α
                                                                                             and the entropy estimate H using the following formula




                                                                                             9 This probability can be obtained as follows. Let a random variable take possible values with probabilities p , for i=1,..,k, where
                                                                                                                                                                                                           i
                                                                                             p1≥p2≥…≥pk . Then, the probability of producing any C identical consecutive samples is ∑ piC. Since, ∑ piC is less than or equal to
                                                                                             p1. p1C−1+ p2.p1C−1+…+ pk.p1C−1= (p1+…+pk) p1C−1 = p1C-1 = 2−H(C−1).


                                                                                                                                                             25
