NIST SP 800-90A Rev. 1                  HMAC_DRBG          Recommendation for Random Number
                                                            Generation Using Deterministic RBGs


10.1.2      HMAC_DRBG

HMAC_DRBG uses multiple occurrences of an approved keyed hash function, which is
based on an approved hash function. This DRBG mechanism uses the
HMAC_DRBG_Update function specified in Section 10.1.2.2 and the HMAC function
within the HMAC_DRBG_Update function as the derivation function during instantiation
and reseeding. The same hash function shall be used throughout an HMAC_DRBG
instantiation. The hash function used shall meet or exceed the security strength required by
the consuming application for DRBG
output (see [SP 800-57]).
Figure 9 depicts the HMAC_DRBG in
three stages. HMAC_DRBG is specified
using an internal function
(HMAC_DRBG_Update). This function
is called during the HMAC_DRBG
instantiate, generate and reseed algorithms
to adjust the internal state when new
entropy or additional input is provided, as
well as to update the internal state after
pseudorandom bits are generated. The
operations in the top portion of the figure
are only performed if the additional input
is not null. Figure 10 depicts the
HMAC_DRBG_Update function.
10.1.2.1      HMAC_DRBG Internal
              State

The internal state for HMAC_DRBG
consists of:
   1. The working_state:
         a. The value V of outlen bits,
            which is updated each time
            another outlen bits of output
            are produced (where outlen is
            specified in Table 2 of Section
            10.1).
         b. The outlen-bit Key, which is
            updated at least once each time
            that the DRBG mechanism

            generates pseudorandom bits.
                                                   Figure 9: HMAC_DRBG Generate Function
         c. A counter (reseed_counter) that
            indicates the number of requests for pseudorandom bits since instantiation or
            reseeding.

                                              43
