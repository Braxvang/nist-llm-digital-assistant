                                                                                              NIST SP 800-77 REV. 1                                                            GUIDE TO IPSEC VPNS


                                                                                                 •   Most gateway implementations interoperate with other vendors’ implementations, but
                                                                                                     many client implementations only interoperate with their own vendor’s gateway
                                                                                                     implementation.

                                                                                              The following are some IKE-related interoperability issues:

                                                                                                 •   Certificate Contents. Different implementations may encode or interpret certificate data
                                                                                                     fields (e.g., peer identity) differently or handle certificate extensions, such as EKU
                                                                                                     extensions, in conflicting ways. Some vendors have also implemented the sending of
                                                                                                     intermediary certificates in a non-standard way.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                                 •   Rekeying Behavior. When implementations renegotiate IKE or IPsec SAs, different
                                                                                                     rekeying behavior can result in lost traffic. One potential area of difficulty is related to
                                                                                                     timing, such as when to start using the new SA and when to delete the old SA. In
                                                                                                     addition, when an IKEv1 SA expires, some implementations delete all IPsec SAs that
                                                                                                     were negotiated using that IKEv1 SA. Other implementations allow the IPsec SAs to
                                                                                                     continue until they, in turn, expire. This can also cause interoperability problems. In
                                                                                                     IKEv1, an expired and terminated IKE SA does not cause its corresponding IPsec SA to
                                                                                                     be deleted, but without an IKE SA, this IPsec SA can no longer send or respond to DPD
                                                                                                     packets. IKEv2 resolved these issues by specifying that the deletion of an IKE SA causes
                                                                                                     the deletion of all of its IPsec SAs.
                                                                                                 •   Initial Contact Messages. Some implementations send an Initial Contact notification
                                                                                                     message when they begin an IKE negotiation with a peer for whom they have no current
                                                                                                     SAs. This can also be an indication that the sending implementation has rebooted and lost
                                                                                                     previously negotiated SAs. There can be incompatibility issues if one implementation
                                                                                                     sends and expects to receive this message, and the other one has not implemented this
                                                                                                     feature.
                                                                                                 •   DPD. DPD enables an endpoint to ensure that its peer is still able to communicate. This
                                                                                                     can help the endpoint avoid a situation in which it expends processing resources to send
                                                                                                     IPsec-protected traffic to a peer that is no longer available. If no traffic is sent through an
                                                                                                     SA for a preconfigured period of time, some implementations will delete the SA, even if
                                                                                                     the negotiated lifetime has not elapsed. DPD messages can be sent to ensure that an
                                                                                                     otherwise unused IPsec SA is kept alive. This can avoid NAT mapping timeouts and the
                                                                                                     deletion of inactive SAs.
                                                                                                 •   Vendor ID. One endpoint may depend on a proprietary custom vendor ID IKE payload
                                                                                                     to enable a feature that is either absent or inconsistently implemented. This has led some
                                                                                                     vendors to include vendor IDs of other vendors in their product to gain compatibility with
                                                                                                     the other vendor. This can lead to unexpected side effects when one vendor adds a
                                                                                                     different customization that is activated when the same vendor ID value is seen.
                                                                                                 •   Lifetimes. Peers may be configured with different values for IKE or IPsec SA lifetimes.
                                                                                                     IKEv2 allows the sending of the maximum accepted authentication lifetime, so a client
                                                                                                     connecting to a server will be told within which period of time it is supposed to
                                                                                                     reauthenticate.




                                                                                                                                               81
