                                                                                             NIST SP 800-90B                                           RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                               USED FOR RANDOM BIT GENERATION

                                                                                                               CBC-MAC Specification

                                                                                             CBC-MAC using a 128-bit approved block-cipher algorithm is one of the vetted conditioning
                                                                                             components. This CBC-MAC construction shall not be used for any other purpose than as the
                                                                                             algorithm for a conditioning component, as specified in Section 3.1.5.1.1. The following notation
                                                                                             is used for the construction.

                                                                                             Let E(Key, input_string) represent the approved encryption algorithm, with a Key and an
                                                                                             input_string as input parameters. The length of the input_string shall be an integer multiple of the
                                                                                             output length n of the block-cipher algorithm and shall always be the same length (i.e., variable
                                                                                             length strings shall not be used as input).
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                             Let n be the length (in bits) of the output block of the approved block cipher algorithm, and let w
                                                                                             be the number of n-bit blocks in the input_string.

                                                                                             Let output_string be the n-bit output of CBC-MAC.

                                                                                             CBC-MAC:
                                                                                               Input: bitstring Key, input_string.
                                                                                               Output: bitstring output_string.
                                                                                               Process:
                                                                                                    1. Let ùë†ùë†0 , ùë†ùë†1 , ‚Ä¶ ùë†ùë†ùë§ùë§‚àí1 be the sequence of blocks formed by dividing input string into n-bit
                                                                                                       blocks; i.e., each ùë†ùë†ùëñùëñ consists of n bits.
                                                                                                    2. V = 0.
                                                                                                    3. For i = 0 to w ‚àí 1
                                                                                                          V = E(Key, V ‚äï ùë†ùë†ùëñùëñ ).
                                                                                                    4. Output V as the CBC-MAC output.




                                                                                                                                              73
