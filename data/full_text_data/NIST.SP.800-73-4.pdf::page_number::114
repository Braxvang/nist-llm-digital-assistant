Special Publication 800-73-4                         Interfaces for Personal Identity Verification – Part 2:
                                                     PIV Card Application Card Command Interface



Appendix A—Examples of the Use of the GENERAL AUTHENTICATE Command

A.1           Authentication of the PIV Card Application Administrator

The PIV Card Application Administrator is authenticated by the PIV Card Application using a
challenge/response protocol. A challenge retrieved from the PIV Card Application is encrypted by the
client application and returned to the PIV Card Application associated with key reference '9B', the key
reference of the PIV Card Application Administration key. The PIV Card Application decrypts the
response using this reference data and the algorithm associated with the key reference (for example, 3
Key Triple DES – ECB, algorithm identifier '00'). If this decrypted value matches the previously provided
challenge, then the security status indicator of the PIV Card Application Administration key is set to
TRUE within the PIV Card Application.

Table 18 shows the GENERAL AUTHENTICATE card commands sent to the PIV Card Application to
realize this particular challenge/response protocol.

                      Table 18. Authentication of PIV Card Application Administrator

               Command                        Response                          Comment
      '00 87 00 9B 04 7C 02 81                                     Client application requests a
      00 00'                                                       challenge from the PIV Card
                                                                   Application.
                                    '7C 0A 81 08 01 02 03 04       Challenge ('01 02 03 04 05 06 07
                                    05 06 07 08 90 00'             08') returned to client application
                                                                   by the PIV Card Application.
      '00 87 00 9B 0C 7C 0A 82                                     Client application returns the
      08 88 77 66 55 44 33 22 11'                                  encryption of the challenge ('88
                                                                   77 66 55 44 33 22 11')
                                                                   referencing algorithm '00' and
                                                                   key reference '9B'. [SP800-78,
                                                                   Tables 6-1 and 6-2]
                                    '90 00'                        PIV Card Application indicates
                                                                   successful authentication of PIV
                                                                   Card Application Administrator
                                                                   after decrypting '88 77 66 55 44
                                                                   33 22 11' using the referenced
                                                                   algorithm and key and getting '01
                                                                   02 03 04 05 06 07 08'.

A.2           Mutual Authentication of Client Application and Card Application

The PIV Card Application Administrator and the PIV Card Application authenticate each other using a
challenge/response protocol. A witness retrieved from the PIV Card Application is decrypted by the client
application and returned to the PIV Card Application associated with key reference '9B', the key reference
of the PIV Card Application Administration key. The command including the decrypted witness also
includes a challenge for the PIV Card Application. The PIV Card Application verifies that the decrypted
witness matches the value that it encrypted to create the witness. If it does, then the security status
indicator of the PIV Card Application Administration key is set to TRUE within the PIV Card
Application, and the PIV Card Application encrypts the challenge that it received from the client



                                                   39
