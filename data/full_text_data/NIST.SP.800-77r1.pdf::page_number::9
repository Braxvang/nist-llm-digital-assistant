                                                                                              NIST SP 800-77 REV. 1                                                                         GUIDE TO IPSEC VPNS


                                                                                              FIPS-validated cryptographic modules shall be used in IPsec VPN deployments for compliance
                                                                                              with this guidance. The FIPS 140 specifications [13][14] define how cryptographic modules will
                                                                                              be validated. One requirement of FIPS 140 is that the module be capable of operating in a mode
                                                                                              where all algorithms are NIST approved. NIST-approved algorithms are specified in a FIPS
                                                                                              (e.g., FIPS 180, Secure Hash Standard) or in a NIST SP (e.g., SP 800-56A, Recommendation for
                                                                                              Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography). Some
                                                                                              implementations can run in both FIPS mode and non-FIPS mode, so it is important to set and
                                                                                              verify the mode of operation of the IKE and IPsec modules.

                                                                                              The Cryptographic Module Validation Program (CMVP) is a joint effort between NIST and the
                                                                                              Communications Security Establishment (CSE) of the Government of Canada for the validation
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              of cryptographic modules against FIPS 140 [13][14]. The Cryptographic Algorithm Validation
                                                                                              Program (CAVP) provides validation testing of FIPS-approved and NIST-recommended
                                                                                              cryptographic algorithms and their individual components. Cryptographic algorithm validation is
                                                                                              a prerequisite of cryptographic module validation.

                                                                                              Cryptographic recommendations in this document are based on the time of publication of this
                                                                                              document and may be superseded by other publications in the future. The References section
                                                                                              contains a list of relevant FIPS, SPs, and Internet Engineering Task Force (IETF) standards
                                                                                              related to IKE and IPsec.

                                                                                              Approved algorithms and their options for IKE and IPsec as of this writing are listed in Table 1.
                                                                                                                                   Table 1: Approved Algorithms and Options
                                                                                                             Option                    Recommended                               Legacy               Expected

                                                                                                  IKE
                                                                                                  Version                  IKEv2                                        IKEv1
                                                                                                  IKEv2 exchanges          All                                          -
                                                                                                  IKEv1 exchanges          Main Mode, Quick Mode                        Aggressive Mode
                                                                                                  Encryption               AES-GCM, AES-CTR, AES-CBC, AES-              TDEA 3
                                                                                                                           CCM (128, 192, 256-bit keys)
                                                                                                  Integrity/Pseudorandom   HMAC-SHA256, HMAC-SHA384,                    HMAC-SHA-1                HMAC-SHA-3
                                                                                                  Function (PRF)           HMAC-SHA512
                                                                                                  Diffie-Hellman (DH)      DH 14 to DH 21 RFC 3526 [15] and RFC                                   DH 31 and DH
                                                                                                  group                    5114 [16]                                                              32, RFC 8031
                                                                                                                                                                                                  [17]
                                                                                                  Peer authentication 4    RSA, DSA, and ECDSA with 128-bit             RSA, DSA, and
                                                                                                                           security strength (for example, RSA with     ECDSA with less than
                                                                                                                           3072-bit or larger key)                      112 bits of security
                                                                                                                                                                        strength
                                                                                                  Lifetime                 24 hours




                                                                                              3   NIST recommends upgrading all Triple Data Encryption Algorithm (TDEA) use to the Advanced Encryption Standard
                                                                                                  (AES). See https://csrc.nist.gov/News/2017/Update-to-Current-Use-and-Deprecation-of-TDEA for more information.
                                                                                              4 DSA may not be allowed for signature generation in the future, see draft FIPS 186-5,

                                                                                                  https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-5-draft.pdf, for details.



                                                                                                                                                        vii
