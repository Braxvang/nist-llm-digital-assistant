                                                                GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


to create a virtual private network (VPN)38 or to provide secure remote access to a private network. IPsec
is a complete set of protocol security services at the IP layer. It can provide entity authentication,
confidentiality, data origin authentication, replay detection, and data integrity. It also provides limited
traffic flow confidentiality, which masks packet sizes and rates and can make inferential attacks based on
traffic analysis substantially more difficult.

IPsec offers three primary models for protection, as follows:

         Gateway-to-gateway. This model protects communications between two specific networks,
          such as an organization’s main office network and a branch office network, or two business
          partners’ networks.

         Host-to-gateway. This model protects communications between one or more individual hosts
          and a specific network belonging to an organization. The host-to-gateway model is most often
          used to allow hosts on unsecured networks, such as traveling employees and telecommuters, to
          gain secure remote access to internal organizational services, such as the organization’s email,
          Web servers, and custom applications.

         Host-to-host. A host-to-host architecture protects communication between two specific
          computers. It is most often used when a small number of users need to use or administer a
          remote system that requires network layer security for some or all of its higher layer protocols.
          OSPFv3 is an example. IPv6 could offer increased opportunities to use this mode, because
          end-to-end connectivity without Network Address Translation (NAT) makes using IPsec
          easier.

IPsec consists of the following components:

         Security Associations (SA). Each instance of IPsec has a security association database
          (SAD) of IPsec connections, called security associations. SAs describe the endpoints of the
          secure connection, exact type of protection provided, cryptographic parameters and keys,
          expiration time, and label (Security Parameters Index or SPI) to identify packets protected
          with each SA.

         Two security protocols: Authentication Header (AH) and Encapsulating Security
          Payload (ESP). AH can provide integrity and replay protection for packet headers and data,
          but it cannot encrypt them. ESP can provide encryption, integrity, and replay protection for
          packets, but it cannot protect the outermost IP header, as AH can. This protection is not
          needed in most cases. Accordingly, ESP is used much more frequently than AH because of its
          encryption capabilities, as well as other operational advantages. The latest IPsec specification
          states that implementations MAY implement AH, and many choose not to. For a VPN, which
          requires confidential communications, ESP is the natural choice.

         Internet Key Exchange (IKEv1 or IKEv2) protocol. IPsec uses IKEv1 or IKEv2 to
          authenticate endpoints to each other; define the security parameters of IPsec-protected
          connections; negotiate and establish IPsec security associations; negotiate secret keys; and
          manage, update, and delete IPsec’s security associations.




38
     NIST SP 800-77, Guide to IPsec VPNs.


                                                    5-6
