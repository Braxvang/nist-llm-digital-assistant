                                          ESTABLISHING WIRELESS ROBUST SECURITY NETWORKS: A GUIDE TO IEEE 802.11I



Therefore, they can still support IEEE 802.11 RSN associations in the context of other methods that meet
the WLAN-required security claims, but these are the only circumstances in which they can be used
safely. The RFC 3748 methods are often referred to as legacy methods because more sophisticated EAP
methods have been developed since the publication of RFC 3748, but MD5-Challenge in particular
remains widely used, particularly in conjunction with other more secure authentication methods. These
methods are also used on wired networks, where the eavesdropping threat is believed to be much lower.

6.1.2.1 MD5-Challenge

The MD5-Challenge method is based on the Challenge-Handshake Authentication Protocol (CHAP)
defined in RFC 1994. 68 The EAP RFC, RFC 3748, requires implementations to support MD5-Challenge.
However, IEEE 802.11i requires the EAP method to support mutual authentication in order to avoid man-
in-the-middle attacks. It cites MD5-Challenge as an example of a method that does not meet this
requirement. 69

Like other challenge-response methods, the primary advantage of MD5-Challenge is that passwords are
never transmitted in clear text. Instead, the AS provides the STA with challenge text that the STA inputs
into the MD5 algorithm along with the password. The resulting MD5 hash value is sent back to the AS,
which performs the same operation as the STA. The MD5 algorithm ensures that the ASâ€™s hash value
will match the response only if the STA has the correct password.

Unfortunately, challenge-response methods are vulnerable to offline dictionary attacks and man-in-the-
middle attacks unless they are carefully designed, with sufficient entropy in the challenge, keys of the
appropriate length, a strong hash function, and secure protocol design. In the offline dictionary attack, the
attacker captures both the challenge and the response and then iteratively cycles through the entries in a
dictionary of likely passwords, inputting the challenge and each dictionary entry into the MD5 algorithm
to find a match with the response. If the attacker finds a match, the entry that produced the match is the
password. In the man-in-the-middle attack, the attacker impersonates the STA to the AS and the AS to
the STA. This configuration allows the attacker to get the correct response from the STA without the AS
ever knowing that it did not originate from an authorized entity.

To mitigate the risk of dictionary and man-in-the-middle attacks, challenge-response methods such as
MD5-Challenge can be tunneled within a method that encrypts the entire challenge-response sequence.
In this scenario, the clear text challenge is encrypted, and the encrypted response is encrypted a second
time. This approach is a common configuration for WLANs that rely on IEEE 802.1X port-based access
control and is designed to help prevent dictionary and man-in-the-middle attacks. Unfortunately, the
method used to establish the encrypted tunnel may itself be vulnerable to a man-in-the-middle attack,
unless the tunnel establishment employs a method based on mutual authentication. If such an attack is
successful, then the encrypted tunnel no longer hides information from the adversary because the
adversary established the tunnel in performing the attack and has the keys necessary to encrypt and
decrypt EAP traffic. Organizations should be aware that it is not possible to eliminate completely the risk
of successful dictionary or man-in-the-middle attacks for challenge-response methods.




68
     For more information on CHAP, see RFC 1994, PPP Challenge Handshake Authentication Protocol (CHAP) at
     http://www.ietf.org/rfc/rfc1994.txt.
69
     The Wi-Fi Alliance requires EAP-TLS to attain Wi-Fi certification. Therefore, most IEEE 802.11 implementations include
     support for EAP-TLS.


                                                            6-5
