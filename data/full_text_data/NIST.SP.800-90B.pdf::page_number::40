                                                                                             NIST SP 800-90B                                                   RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                       USED FOR RANDOM BIT GENERATION

                                                                                                                                                     −1,      if 𝑠𝑠𝑖𝑖 > 𝑠𝑠𝑖𝑖+1
                                                                                                                                         𝑠𝑠𝑖𝑖′ = �
                                                                                                                                                     +1,      if 𝑠𝑠𝑖𝑖 ≤ 𝑠𝑠𝑖𝑖+1

                                                                                                     for i =1, …, L-1.

                                                                                                2. The test statistic T is the length of the longest run in 𝑆𝑆 ′ .
                                                                                             Example 3: Let the input sequence be S = (2, 2, 2, 5, 7, 7, 9, 3, 1, 4, 4); then S ′ = (+1, +1, +1, +1,
                                                                                             +1, +1, −1, −1, +1, +1). There are three runs: (+1, +1, +1, +1, +1, +1), (−1, −1) and (+1, +1), so T
                                                                                             = 6.

                                                                                             Handling binary data: To test binary input data, first apply Conversion I to the input sequence.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                             5.1.4   Number of Increases and Decreases

                                                                                             This test statistic determines the maximum number of increases or decreases between consecutive
                                                                                             sample values. Given S = (s1,…, sL), the test statistic T is calculated as follows:

                                                                                                1. Construct the sequence 𝑆𝑆 ′ = (𝑠𝑠1′ , … , 𝑠𝑠𝐿𝐿−1
                                                                                                                                               ′
                                                                                                                                                    ), where
                                                                                                                                                     −1,      if 𝑠𝑠𝑖𝑖 > 𝑠𝑠𝑖𝑖+1
                                                                                                                                         𝑠𝑠𝑖𝑖′ = �
                                                                                                                                                     +1,      if 𝑠𝑠𝑖𝑖 ≤ 𝑠𝑠𝑖𝑖+1

                                                                                                     for i = 1, …, L-1.

                                                                                                2. Calculate the number of –1’s and +1’s in 𝑆𝑆 ′ ; the test statistic T is the maximum of these
                                                                                                   numbers, i.e., T = max (number of –1’s, number of +1’s).
                                                                                             Example 4: Let the input sequence be S = (2, 2, 2, 5, 7, 7, 9, 3, 1, 4, 4); then 𝑆𝑆 ′ = (+1, +1, +1, +1,
                                                                                             +1, +1, −1, −1, +1, +1). There are eight +1’s and two −1’s in S ′ , so T = max (number of +1s,
                                                                                             number of −1s) = max (8, 2) = 8.

                                                                                             Handling binary data: To test binary input data, first apply the Conversion I to the input sequence.

                                                                                             5.1.5   Number of Runs Based on the Median

                                                                                             This test statistic determines the number of runs that are constructed with respect to the median of
                                                                                             the input data. Given S = (s1, …, sL), the test statistic T is calculated as follows:

                                                                                                1. Find the median 𝑋𝑋� of S = (s1, …, sL).
                                                                                                 2. Construct the sequence 𝑆𝑆 ′ = (𝑠𝑠1′ , … , 𝑠𝑠𝐿𝐿′ ) where
                                                                                                                                                      −1,      if 𝑠𝑠𝑖𝑖 < 𝑋𝑋�
                                                                                                                                          𝑠𝑠𝑖𝑖′ = �
                                                                                                                                                      +1,      if 𝑠𝑠𝑖𝑖 ≥ 𝑋𝑋�

                                                                                                     for i =1, …, L.

                                                                                                 3. The test statistic T is the number of runs in 𝑆𝑆 ′ .



                                                                                                                                                      32
