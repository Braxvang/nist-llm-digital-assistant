                                                                                             NIST SP 800-90B                                                   RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                       USED FOR RANDOM BIT GENERATION

                                                                                                                                                     âˆ’1,      if ğ‘ ğ‘ ğ‘–ğ‘– > ğ‘ ğ‘ ğ‘–ğ‘–+1
                                                                                                                                         ğ‘ ğ‘ ğ‘–ğ‘–â€² = ï¿½
                                                                                                                                                     +1,      if ğ‘ ğ‘ ğ‘–ğ‘– â‰¤ ğ‘ ğ‘ ğ‘–ğ‘–+1

                                                                                                     for i =1, â€¦, L-1.

                                                                                                2. The test statistic T is the length of the longest run in ğ‘†ğ‘† â€² .
                                                                                             Example 3: Let the input sequence be S = (2, 2, 2, 5, 7, 7, 9, 3, 1, 4, 4); then S â€² = (+1, +1, +1, +1,
                                                                                             +1, +1, âˆ’1, âˆ’1, +1, +1). There are three runs: (+1, +1, +1, +1, +1, +1), (âˆ’1, âˆ’1) and (+1, +1), so T
                                                                                             = 6.

                                                                                             Handling binary data: To test binary input data, first apply Conversion I to the input sequence.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                             5.1.4   Number of Increases and Decreases

                                                                                             This test statistic determines the maximum number of increases or decreases between consecutive
                                                                                             sample values. Given S = (s1,â€¦, sL), the test statistic T is calculated as follows:

                                                                                                1. Construct the sequence ğ‘†ğ‘† â€² = (ğ‘ ğ‘ 1â€² , â€¦ , ğ‘ ğ‘ ğ¿ğ¿âˆ’1
                                                                                                                                               â€²
                                                                                                                                                    ), where
                                                                                                                                                     âˆ’1,      if ğ‘ ğ‘ ğ‘–ğ‘– > ğ‘ ğ‘ ğ‘–ğ‘–+1
                                                                                                                                         ğ‘ ğ‘ ğ‘–ğ‘–â€² = ï¿½
                                                                                                                                                     +1,      if ğ‘ ğ‘ ğ‘–ğ‘– â‰¤ ğ‘ ğ‘ ğ‘–ğ‘–+1

                                                                                                     for i = 1, â€¦, L-1.

                                                                                                2. Calculate the number of â€“1â€™s and +1â€™s in ğ‘†ğ‘† â€² ; the test statistic T is the maximum of these
                                                                                                   numbers, i.e., T = max (number of â€“1â€™s, number of +1â€™s).
                                                                                             Example 4: Let the input sequence be S = (2, 2, 2, 5, 7, 7, 9, 3, 1, 4, 4); then ğ‘†ğ‘† â€² = (+1, +1, +1, +1,
                                                                                             +1, +1, âˆ’1, âˆ’1, +1, +1). There are eight +1â€™s and two âˆ’1â€™s in S â€² , so T = max (number of +1s,
                                                                                             number of âˆ’1s) = max (8, 2) = 8.

                                                                                             Handling binary data: To test binary input data, first apply the Conversion I to the input sequence.

                                                                                             5.1.5   Number of Runs Based on the Median

                                                                                             This test statistic determines the number of runs that are constructed with respect to the median of
                                                                                             the input data. Given S = (s1, â€¦, sL), the test statistic T is calculated as follows:

                                                                                                1. Find the median ğ‘‹ğ‘‹ï¿½ of S = (s1, â€¦, sL).
                                                                                                 2. Construct the sequence ğ‘†ğ‘† â€² = (ğ‘ ğ‘ 1â€² , â€¦ , ğ‘ ğ‘ ğ¿ğ¿â€² ) where
                                                                                                                                                      âˆ’1,      if ğ‘ ğ‘ ğ‘–ğ‘– < ğ‘‹ğ‘‹ï¿½
                                                                                                                                          ğ‘ ğ‘ ğ‘–ğ‘–â€² = ï¿½
                                                                                                                                                      +1,      if ğ‘ ğ‘ ğ‘–ğ‘– â‰¥ ğ‘‹ğ‘‹ï¿½

                                                                                                     for i =1, â€¦, L.

                                                                                                 3. The test statistic T is the number of runs in ğ‘†ğ‘† â€² .



                                                                                                                                                      32
