NIST SP 800-85A-4                                         PIV CARD APPLICATION & MIDDLEWARE
                                                                   INTERFACE TEST GUIDELINES

                          •   (IN) cryptographicMechanism
                          •   (OUT) publicKey
                          •   (INOUT) KeyLength
 Expected Result(s)    Call returns with status_word of
                       PIV_INVALID_KEY_OR_KEYALG_COMBINATION.
 Postcondition(s)      1. The PIV Card Application remains in the state it had prior to the
                          pivGenerateKeyPair function call.
                       2. The precondition states are unaffected.


B.8.2.3         Identify and Handle an Invalid cryptographicMechanism
 Purpose                Ensure that the PIV Middleware identifies and handles unsupported
                        cryptographic mechanism identifiers.
 Target                pivGenerateKeyPair
 Reference(s)          1. SP 800-73-4 Part 3, Section 3.4.2
                       2. AS04.10
 Precondition(s)       1. The client application owns a connection to the PIV Card
                          Application accessible through cardHandle.
                       2. The client application has successfully selected the PIV Card
                          Application.
                       3. Mutual authentication with the client application using the PIV
                          Card Application Administration key has taken place.
 Test Steps            1. Set cardHandle := <<valid cardHandle>>
                       2. Set keyReference := <<a valid key reference>>
                       3. Set cryptographicMechanism := <<an unrecognized
                          cryptographic mechanism identifier>>
                       4. Create publicKey reference
                       5. Call pivGenerateKeyPair with
                          • (IN) cardHandle
                          • (IN) keyReference
                          • (IN) cryptographicMechanism
                          • (OUT) publicKey
                          • (INOUT) KeyLength
 Expected Result(s)    Call returns with status_word of
                       PIV_UNSUPPORTED_CRYPTOGRAPHIC_MECHANISM.
 Postcondition(s)      1. The PIV Card Application remains in the state it had prior to the
                          pivGenerateKeyPair function call.
                       2. The precondition states are unaffected.


B.8.2.4         Security Conditions are Enforced
 Purpose                Ensure that the PIV Middleware enforces the necessary security
                        conditions when called from client application.
 Target                pivGenerateKeyPair
 Reference(s)          1. SP 800-73-4 Part 3, Section 3.4.2


                                       B-23
