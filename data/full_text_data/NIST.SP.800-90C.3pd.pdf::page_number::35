      NIST SP 800-90C 3pd (Third Public Draft)                          Recommendation for RBG Constructions
      September 2022

961   for conditioning the output to obtain a bitstring with full entropy is needed. Since this conditioning
962   is performed outside an entropy source, the output is said to be externally conditioned.
963   When external conditioning is performed, the vetted conditioning function listed in [SP800-90B]
964   shall be used.

965   3.3.1. Conditioning Function Calls
966   The conditioning functions operate on bitstrings obtained from one or more calls to the entropy
967   source(s).
968   The following format is used in Section 3.3.2 for a conditioning-function call:
969                    conditioned_output = Conditioning_function(input_parameters),
970   where the input_parameters for the selected conditioning function are discussed in Sections 3.3.1.2
971   and 3.3.1.3, and conditioned_output is the output returned by the conditioning function.

972   3.3.1.1.        Keys Used in External Conditioning Functions
973   The HMAC, CMAC, and CBC-MAC vetted conditioning functions require the input of a Key of
974   a specific length (keylen). Unlike other cryptographic applications, keys used in these external
975   conditioning functions do not require secrecy to accomplish their purpose so may be hard-coded,
976   fixed, or all zeros.
977   For the CMAC and CBC-MAC conditioning functions, the length of the key shall be an
978   approved key length for the block cipher used (e.g., keylen = 128, 192, or 256 bits for AES).
979   For the HMAC conditioning function, the length of the key shall be equal to the length of the hash
980   functionâ€™s output block (i.e., output_len).
981                       Table 2. Key Lengths for the Hash-based Conditioning Functions

                                                            Length of the output block
                    Hash Function
                                                            (output_len) and key (keylen)
                    SHA-224, SHA-512/224, SHA3-224                          224
                    SHA-256, SHA-512/256, SHA3-256                          256
                    SHA-384, SHA3-384                                       384
                    SHA-512, SHA3-512                                       512
982   Using random keys may provide some additional security in case the input is more predictable
983   than expected. Thus, these keys should be chosen randomly in some way (e.g., by drawing bits
984   directly from the entropy source and inserting them into the key or by providing entropy-source
985   bits to a conditioning function with a fixed key to derive the new key). Note that any entropy used
986   to randomize the key shall not be used for any other purpose (e.g., as input to the conditioning
987   function).

988   3.3.1.2.        Hash Function-based Conditioning Functions
989   Conditioning functions may be based on approved hash functions.


                                                       22
