                                                                                               NIST SP 800-56C REV. 2                                RECOMMENDATION FOR KEY DERIVATION METHODS
                                                                                                                                                                  IN KEY ESTABLISHMENT SCHEMES


                                                                                                          OtherInput, serves as the HMAC key, and x (the input to H) is a bit string that serves
                                                                                                          as the HMAC “message” as specified in [FIPS 198].
                                                                                                Option 3: H(x) = KMAC#(salt, x, H_outputBits, S), where KMAC# is a particular
                                                                                                          implementation of either KMAC128 or KMAC256 (as defined in [SP 800-185]) that
                                                                                                          meets the selection requirements specified in Section 7. An implementation-
                                                                                                          dependent byte string, salt, whose (non-null) value may be optionally provided in
                                                                                                          OtherInput, serves as the KMAC# key, and x (the input to H) is a bit string that serves
                                                                                                          as the KMAC# “message” as specified in [SP 800-185]. The parameter H_outputBits
                                                                                                          determines the bit length chosen for the output of the KMAC variant employed. The
                                                                                                          “customization string” S shall be the byte string 01001011 || 01000100 || 01000110,
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Cr2




                                                                                                          which represents the sequence of characters “K”, “D,” and “F” in 8-bit ASCII. (This
                                                                                                          three-byte string is denoted by “KDF” in this document.)
                                                                                               Implementation-Dependent Parameters:
                                                                                                1. H_outputBits – A positive integer that indicates the length (in bits) of the output of the
                                                                                                   auxiliary function H that is used to derive blocks of secret keying material. If Option 1 or
                                                                                                   Option 2 is chosen, then H_outputBits corresponds to the bit-length of the output block of
                                                                                                   the particular hash function used in the implementation of H; therefore, H_outputBits is in
                                                                                                   the set {160, 224, 256, 384, 512} with the precise value determined by the choice for the
                                                                                                   hash function, hash (see Section 4.2 for details). If Option 3 is chosen, then H_outputBits
                                                                                                   shall either be set equal to the length (in bits) of the secret keying material to be derived (see
                                                                                                   input L below) or selected from the set {160, 224, 256, 384, 512}.
                                                                                                2. max_H_inputBits – A positive integer that indicates the maximum permitted length (in bits)
                                                                                                   of the bit string x that is used as input to the auxiliary function H. If Option 1 or Option 2 is
                                                                                                   chosen for the implementation of H, then the upper bound on max_H_inputBits shall not
                                                                                                   exceed the message limit imposed by the hash function, hash (see Section 4.2 for details);
                                                                                                   max_H_inputBits values smaller than a specification-imposed upper bound may be dictated
                                                                                                   by the particular use case. If the hash function, hash, is specified in [FIPS 202], or if Option
                                                                                                   3 is chosen for the implementation of H, then there is no specification-imposed upper bound
                                                                                                   on max_H_inputBits; the value assigned to max_H_inputBits may be determined by the
                                                                                                   needs of the relying applications/parties.
                                                                                                3. default_salt – A non-null (secret or non-secret) byte string that is needed only if either Option
                                                                                                   2 (HMAC-hash) or Option 3 (KMAC#) is chosen for the implementation of the auxiliary
                                                                                                   function H. This byte string is used as the value of salt if a (non-null) value is not included
                                                                                                   in OtherInput (see below).
                                                                                                   If H(x) = HMAC-hash(salt, x), then – in the absence of an agreed-upon alternative – the
                                                                                                   default_salt shall be an all-zero byte string whose bit length equals that specified as the bit
                                                                                                   length of an input block for the hash function, hash. (Input-block lengths for the approved
                                                                                                   hash functions that can be employed to implement HMAC-hash are listed in Table 1 of
                                                                                                   Section 4.2.)
                                                                                                   If H(x) = KMAC128(salt, x, H_outputBits, “KDF”), then – in the absence of an agreed-upon
                                                                                                   alternative – the default_salt shall be an all-zero string of 164 bytes (i.e., an all-zero string
                                                                                                   of 1312 bits).



                                                                                                                                                12
