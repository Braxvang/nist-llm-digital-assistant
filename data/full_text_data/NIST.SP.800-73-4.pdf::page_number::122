Special Publication 800-73-4                                       Interfaces for Personal Identity Verification – Part 2:
                                                                   PIV Card Application Card Command Interface

                   When the cardholder is acting as the initiator, the other party’s static public key is sent to
                   the PIV Card, and a static shared secret is returned in plaintext by the PIV Card. Note that
                   in this case, an ephemeral key pair is generated by the client application’s cryptographic
                   module, and the corresponding ephemeral private key is combined with the other party’s
                   static public key to produce a second shared secret.
                   When the cardholder is acting as the responder, two public keys are sent by the client
                   application to the PIV Card (the other party’s static and ephemeral public keys), and two
                   shared secrets are returned in plaintext (the static shared secret and the ephemeral shared
                   secret). Note that two GENERAL AUTHENTICATE commands are required to provide
                   the two shared secrets to the client application’s cryptographic module.
             +     C(1e, 1s) – The initiator generates only an ephemeral key pair, while the responder has
                   only a static key pair [SP800-56A, Section 6.2.2]
                   In this scheme, the PIV Card is only employed by the client application if the cardholder is
                   acting as the responder. In this case, the other party’s ephemeral public key is sent to the
                   PIV Card, and the shared secret is returned by the PIV Card in plaintext.
             +     C(0e, 2s) – Both the initiator and responder use only static key pairs [SP800-56A, Section
                   6.3]
                   In the C(0e, 2s) scheme, the information sent between the client application’s
                   cryptographic module and the PIV Card is the same when acting as the initiator or the
                   responder; the other party’s static public key is sent to the PIV Card, and the static shared
                   secret is returned in plaintext. Note that for this scheme, the client application’s
                   cryptographic module also generates a nonce when acting as the initiator of the scheme.
The C(2e, 0s) scheme does not involve the use of static keys and so the PIV Card would not be involved
in the implementation of this scheme.

A.6       Authentication of the PIV Cardholder Over the Virtual Contact Interface

If the PIV Card supports the virtual contact interface, then all non-card-management operations of the
PIV Card Application may be performed over the contactless interface. In order to perform an operation
that would otherwise be restricted to the contact interface, the key establishment protocol in Section 4.1
needs to be performed to establish session keys for secure messaging, and then the pairing code needs to
be submitted over secure messaging in order to establish a virtual contact interface. 25

This appendix shows an example of the establishment of a VCI and its use to perform cardholder
authentication using the PIV Authentication key. First, the GENERAL AUTHENTICATE command is
used to perform the key establishment protocol, and then the VERIFY command is used to submit the
pairing code and establish the VCI. At this point the GET DATA command is used to read the X.509
Certificate for PIV Authentication. Then the GENERAL AUTHENTICATE command is used to perform
a challenge/response with the PIV Authentication key after the PIN is submitted using the VERIFY
command.




25 As noted in Part 1, Section 5.5, the pairing code does not need to be submitted if the Bit 3 of the first byte of the PIN Usage

Policy is set to one.




                                                                 47
