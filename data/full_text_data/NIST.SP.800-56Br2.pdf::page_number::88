                                                                                               NIST SP 800-56B REV. 2                          RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                    USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                               8.2.3 KAS1 Key Confirmation
                                                                                               The KAS1-Party_V-confirmation scheme is based on the KAS1-basic scheme.

                                                                                               8.2.3.1 KAS1 Key-Confirmation Components
                                                                                               The components for KAS1 key agreement with key confirmation are the components listed in
                                                                                               Section 8.1, plus the following:
                                                                                                  MAC: A message authentication code algorithm with the following parameters (see Section
                                                                                                  5.2),
                                                                                                        a. MacKeyLen: the byte length of MacKey, and
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                                        b. MacTagLen: the byte length of MacTag. (MacTagBits, as used in Section 5.2, is equal
                                                                                                          to 8 × MacTagLen.)
                                                                                               MacKey shall be the first MacKeyLen bytes of the keying material and shall be used only for the
                                                                                               key-confirmation operation of a single transaction. For KAS1 key confirmation, the length of the
                                                                                               derived keying material shall be at least MacKeyLen bytes in length. The keying material is
                                                                                               usually longer than MacKeyLen bytes so that other keying material is available for subsequent
                                                                                               operations.

                                                                                               8.2.3.2 KAS1-Party_V-confirmation
                                                                                               Figure 7 depicts a typical flow for a KAS1 scheme with unilateral key confirmation from party V
                                                                                               to party U. In this scheme, party V and party U assume the roles of key-confirmation provider and
                                                                                               recipient, respectively. The successful completion of the key-confirmation process provides party
                                                                                               U with a) assurance that party V has derived the same secret Z value, and b) assurance that party
                                                                                               V has actively participated in the process.
                                                                                                                Party U                                                  Party V

                                                                                                                                                                   (PubKeyV, PrivKeyV)

                                                                                                Obtain party V’s public key-establishment   PubKeyV
                                                                                                                   key

                                                                                                (Z, C) = RSASVE.GENERATE(PubKeyV)               C          Z = RSASVE.RECOVER(PrivKeyV, C)

                                                                                                  Compute DerivedKeyingMaterial and            NV           Compute DerivedKeyingMaterial and
                                                                                                             Destroy Z                                                 Destroy Z

                                                                                                               MacTagV =?                                                MacTagV =
                                                                                                                                            MacTagV
                                                                                                  TMacTagBits[MAC(MacKey, MacDataV)]                        TMacTagBits[MAC(MacKey, MacDataV)]

                                                                                                        Figure 7: KAS1-Party-V-confirmation Scheme (From Party V to Party U)
                                                                                               Each party first performs the appropriate steps of the KAS1-basic scheme as described in Section
                                                                                               8.2.2.
                                                                                               To provide (and receive) key confirmation (as described in Section 5.6.1), both parties set
                                                                                               EphemDataV = NV, and EphemDataU = C:

                                                                                                                                              78
