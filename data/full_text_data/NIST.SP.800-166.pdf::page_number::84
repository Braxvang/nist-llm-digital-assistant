NIST SP 800-166                                                   DERIVED PIV APPLICATION AND
                                                                  DATA MODEL TEST GUIDELINES

                             • P2, key reference value, is set to '80'
                             • Data field of the command contains the PUK value
                               for key reference '80' concatenated with a new
                               password value that is less than 6 bytes padded
                               with 'FF' to complete 8 bytes
                      6. Send the VERIFY command with
                            • P2, key reference value, is set to '80'
                            • Data field of the command will contain the
                               correct Derived PIV Application Password, padded
                               with 'FF' (if necessary) to complete the total
                               length of the value to 8 bytes
 Expected Result(s)   1. From Step 1, the command returns the application property template
                         with the status word '90 00'.
                      2. From Step 2, the command returns status word '6A 80' (incorrect
                         parameter in command data field).
                      3. From Step 3, the command returns status word '6A 80' (incorrect
                         parameter in command data field).
                      4. From Step 4, the command returns status word '6A 80' (incorrect
                         parameter in command data field).
                      5. From Step 5, the command returns status word '6A 80' (incorrect
                         parameter in command data field).
                      6. From Step 6, the command returns status word '90 00'.
 Postcondition(s)     Current password is unchanged.

8.3.6.4 Reset Retry Counter with an Incorrect Format for the New Password

 Test Assertion       TA-08.03.06.04
 Purpose              Verifies that the Derived PIV Application does not set a new password
                      with the RESET RETRY COUNTER command when the format
                      requirements of the new password are not met.
 DTR(s)               •  DTR-06.02.02.09
                      •  DTR-06.03.01.01
                      •  DTR-06.03.07.04
                      •  DTR-06.03.07.05
                      •  DTR-06.03.07.06
                      • DTR-06.03.07.07
 Vendor               None.
 Documentation
 Precondition(s)      •   A token with the Derived PIV Application is inserted into an
                          appropriate token reader.
                      •   Suitable drivers have been loaded between the test system and an
                          instance of the reader.
                      •   The Derived PIV Application Password and the PUK are recorded.
                      •   The Derived PIV Application Password’s retry counter and the
                          PUK’s retry counter are not 0.


                                            77
