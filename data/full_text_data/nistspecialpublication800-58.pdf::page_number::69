NIST SP 800-58                                              Voice Over IP Security
_____________________________________________________________________________

      IP header and the new IPsec header are left in plain sight. So if an attacker were
      to intercept an IPsec packet in transport mode, they could not determine what it
      contained; but they could tell where it was headed, allowing rudimentary traffic
      analysis. On a network entirely devoted to VOIP, this would equate to logging
      which parties were calling each other, when, and for how long. Tunnel mode
      encrypts the entire IP datagram and places it in a new IP Packet. Both the
      payload and the IP header are encrypted. The IPsec header and the new IP
      Header for this encapsulating packet are the only information left in the clear.
      Usually each “tunnel” is between two network elements such as a router or a
      gateway. In some cases, such as for mobile users, the tunnel could be between a
      router/gateway on one end and a client on the other end. The IP addresses of
      these nodes are used as the unencrypted IP address at each hop. Hence, at no
      point is a plain IP header sent out containing both the source and destination IP.
      Thus if an attacker were to intercept such packets, they would be unable to
      discern the packet contents or the origin and destination. Note that some traffic
      analysis is possible even in tunnel mode, because gateway addresses are readable.
      If a gateway is used exclusively by a particular organization, an attacker can
      determine the identity of one or both communicating organizations from the
      gateway addresses. IPsec allows nodes in the network to negotiate not only a
      security policy, which defines the security protocol and transport mode as
      described previously, but also a security association defining the encryption
      algorithm and algorithm key to be used




                          Figure 11. IPsec Tunnel and Transport Modes




64
