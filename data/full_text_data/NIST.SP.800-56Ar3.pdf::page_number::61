                                                                                               NIST SP 800-56A Rev. 3                                     Recommendation for Pair-Wise Key Establishment
                                                                                                                                                                  Using Discrete Logarithm Cryptography

                                                                                               5.7.2 MQV Primitives

                                                                                               5.7.2.1      Finite Field Cryptography MQV (FFC MQV) Primitive
                                                                                               A shared secret Z is computed using the domain parameters (p, q, g{, SEED, pgenCounter}),
                                                                                               the other party’s public keys and one’s own public and private keys. Assume that the party
                                                                                               performing the computation is party A, and the other party is party B. Note that party A could
                                                                                               be either party U or party V.
                                                                                               Input:
                                                                                                  1. (p, q, g{, SEED, counter}): Domain parameters,
                                                                                                      2. xA : One’s own static private key,
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                                      3. yB : The other party’s static public key,
                                                                                                      4. rA : One’s own second private key,24
                                                                                                      5. tA : One’s own second public key, and
                                                                                                      6. tB : The other party’s second public key.
                                                                                               Process:
                                                                                                             1        
                                                                                                      1. w =  log 2 q  .
                                                                                                             2        

                                                                                                      2. TA = (t A mod 2 w ) + 2 w .

                                                                                                      3. S A = (rA + TA x A ) mod q .

                                                                                                      4. TB = (t B mod 2 w ) + 2 w .

                                                                                                      5. z = ((t B ( yBTB )) S A ) mod p .

                                                                                                      6. If ((z ≤ 1) OR (z = p – 1)), destroy all intermediate values (including TA, SA, and TB)
                                                                                                         used in the attempted computation of z, then output an error indicator, and exit this
                                                                                                         process without further processing.
                                                                                                      7. Else, convert z to Z using the integer-to-byte-string conversion routine defined in
                                                                                                         Appendix C.1.
                                                                                                      8. Destroy the results of all intermediate calculations used in the computation of Z
                                                                                                         (including TA, SA, TB, and z).
                                                                                                      9. Output Z.
                                                                                               Output: The shared secret Z or an error indicator.

                                                                                               24
                                                                                                    In the FFC MQV primitive, a second key may be either ephemeral or static, depending on which form of
                                                                                                    the primitive is being used; see Sections 5.7.2.1.1 and 5.7.2.1.2.

                                                                                                                                                     50
