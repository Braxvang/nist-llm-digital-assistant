Special Publication 800-85B                                   PIV Data Model Testing Specification


Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<CHUID (2.16.840.1.101.3.7.2.48.0)>>
                      3. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      4. Extract the version field contents from the asymmetric
                         signature of the CHUID
Expected              The value of the version field of the SignedData is 3.
Result(s)


10.1.1.3 Verify digest Algorithm in SignedData

Purpose               Confirm that the digestAlgorithms field of the SignedData content type is
                      in accordance with Table 3-3 of SP80078.
Reference(s)          1.      SP80078, Section 3.2.1
                      2.      AS06.01.04
Precondition          1.      A valid PIV card is inserted into the contact reader.
                      2.      A valid PC/SC connection exists between the test application and the
                              contact reader.
                      3.      The test application is currently connected to the card application
                              which is accessible through card handle.
                      4.      A valid CHUID is present on the PIV card.
Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<CHUID (2.16.840.1.101.3.7.2.48.0)>>
                      3. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      4. Extract the digestAlgorithms field contents from the
                         asymmetric digital signature of the CHUID
                      5. Extract the expiration date value from the CHUID (i.e.
                         Tag 0x35)
                      6. Extract the certificates field contents from the
                         asymmetric signature of the CHUID
                      7. From the certificate obtained, extract the
                         subjectPublicKeyInfo->subjectPublicKey
                      8. Compute the size of the signer’s public key
                      9. Match the digest algorithm with Table 3-3 of SP80078
                         based on the card expiration date, and the public key
                         algorithm and size used to sign the CHUID


Expected              The digestAlgorithms field value of the SignedData is in accordance with
Result(s)             Table 3-3 of SP80078.




                                                                                                     Page 73
