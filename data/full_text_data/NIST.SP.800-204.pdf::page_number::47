                                                                                             NIST SP 800-204                                                                                                      SECURITY STRATEGIES FOR
                                                                                                                                                                                                  MICROSERVICES-BASED APPLICATION SYSTEMS

                                                                                               Security Strategy                                                                                             Microservices Core Feature /
                                                                                                                                                    Security Strategy
                                                                                                  Identifier                                                                                                  Architectural Framework
                                                                                                  MS-SS-11         •   A run-time prevention strategy for credential abuse is preferable to an offline       Preventing credential abuse and
                                                                                                                       strategy. A threshold for a designated time interval from a given location (e.g.,             stuffing attacks
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-204




                                                                                                                       IP address) for the number of login attempts should be established; if the
                                                                                                                       threshold is exceeded, preventive measures must be triggered by the
                                                                                                                       authentication/authorization server. This feature must be present when a bearer
                                                                                                                       token is used, to detect its reuse and enforce prevention.
                                                                                                                   •   A credential-stuffing detection solution has the capability to check user logins
                                                                                                                       against the stolen credential database and warn legitimate users that their
                                                                                                                       credentials have been stolen.
                                                                                                                   •   Configure IDS and boundary devices to detect the following: (a) a denial of
                                                                                                                       service attack and raise an alert before the service is no longer accessible, and
                                                                                                                       (b) a distributed network probe.
                                                                                                                   •   Configure service hosts to scan file uploads and the contents of each
                                                                                                                       container's memory and file system for resident malware threats.

                                                                                                  MS-SS-12         •   Integrate the API gateway with an identity management application to provision          API gateway configuration
                                                                                                                       credentials before activating the API.
                                                                                                                   •   When identity management is invoked through the API gateway, connectors
                                                                                                                       should be provided for integrating with identity providers (IdPs).
                                                                                                                   •   The API gateway should have a connector to an artifact that can generate an
                                                                                                                       access token for the client request (e.g., OAuth 2.0 Authorization Server).
                                                                                                                   •   Securely channel all traffic information to a monitoring and/or analytics
                                                                                                                       application for detecting attacks (e.g., denial of service, malicious actions) and
                                                                                                                       unearthing explanations for degrading performance.
                                                                                                                   •   Distributed gateway deployments (or a combination of initial gateway (that
                                                                                                                       intercepts all client accesses) and microgateways (closer to microservices))
                                                                                                                       should have a token translation (exchange) service [18] between gateways. The
                                                                                                                       token presented to the initial gateway should have permissions with a broad
                                                                                                                       scope whereas the token presented to inside gateways (or microgateways)
                                                                                                                       should be more narrowly scoped with specific permissions or an entirely
                                                                                                                       different token type that is appropriate for the target microservice platform. This
                                                                                                                       helps to implement the least privilege paradigm.




                                                                                                                                                                   39
