                                                                                             NIST SP 800-90B                                             RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                 USED FOR RANDOM BIT GENERATION

                                                                                             If the samples are IID, permuting the dataset is not expected to change the value of the test statistics
                                                                                             significantly. In particular, the original dataset and permuted datasets are expected to be drawn
                                                                                             from the same distribution; therefore, their test statistics should be similar. Unusually high or low
                                                                                             test statistics are expected to occur infrequently. However, if the samples are not IID, then the
                                                                                             original and permuted test statistics may be significantly different. The counters Ci,0 and C i,1 are
                                                                                             used to find the ranking of the original test statistics among the permuted test statistics (i.e., where
                                                                                             a statistic for the original dataset fits within an ordered list of the permuted datasets). Extreme
                                                                                             values for the counters suggest that the data samples are not IID. If the sum of Ci,0 and C i,1 is less
                                                                                             than 5, it means that the original test statistic has a very high rank; conversely, if Ci,0 is greater than
                                                                                             9995, it means that the original test statistics has a very low rank. The cutoff values for C i,0 and
                                                                                             Ci,1 are calculated using a type I error probability of 0.001.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                             The tests described in the following subsections are intended to check the validity of the IID
                                                                                             assumption. Some of the tests (e.g., the compression test) are effective at detecting repeated
                                                                                             patterns of particular values (for example, strings of sample values that occur more often than
                                                                                             would be expected by chance if the samples were IID), whereas some of the other tests (e.g., the
                                                                                             number of directional runs test and the runs based on the median test) focus on the association
                                                                                             between the numeric values of the successive samples in order to find an indication of a trend or
                                                                                             some other relation, such as high sample values that are usually followed by low sample values.

                                                                                              Input: S = (s1,…, sL)

                                                                                              Output: Shuffled S = (s1,…, sL)

                                                                                              1.        for i from L downto 1 do
                                                                                                        a. Generate a random integer j such that 1≤ j ≤ i.
                                                                                                        b. Swap sj and si
                                                                                                                       Figure 5 Pseudo-code of the Fisher-Yates Shuffle

                                                                                             The tests are applicable to both binary and non-binary data, but for some of the tests, the number
                                                                                             of distinct sample values, denoted k (the size of the set A), significantly affects the distribution of
                                                                                             the test statistics, and thus the type I error. For such tests, one of the following conversions is
                                                                                             applied to the input data, when the input is binary, i.e., k = 2.

                                                                                                   •   Conversion I partitions the sequences into eight-bit non-overlapping blocks, and counts the
                                                                                                       number of ones in each block. Zeroes are appended when the last block has less than eight
                                                                                                       bits. For example, let the 20-bit input be (1,0,0,0,1,1,1,0,1,1,0,1,1,0,1,1,0,0,1,1). The first
                                                                                                       and the second eight-bit blocks include four and six ones, respectively. The last block,
                                                                                                       which is not complete, includes two ones. The output sequence is (4, 6, 2).
                                                                                                   •   Conversion II partitions the sequences into eight-bit non-overlapping blocks, and
                                                                                                       calculates the integer value of each block. For example, let the input message be
                                                                                                       (1,0,0,0,1,1,1,0,1,1,0,1,1,0,1,1,0,0,1,1). The integer values of the first two blocks are 142,
                                                                                                       and 219. Zeroes are appended when the last block has less than eight bits. Then, the last
                                                                                                       block becomes (0,0,1,1,0,0,0,0) with an integer value of 48. The output sequence is (142,
                                                                                                       219, 48).

                                                                                                                                                 30
