                                                                    GUIDELINES ON FIREWALLS AND FIREWALL POLICY


When an inbound application firewall or proxy is behind a perimeter firewall or in the firewall’s DMZ,
the perimeter firewall should be blocking based on IP addresses, as described earlier in this section, to
reduce the load on the application firewall or proxy. Doing this puts more of the address-specific policy in
a single place—the main firewall—and reduces the amount of traffic seen by the application firewall or
proxy, freeing more power to filter content. Of course, if the perimeter firewall is also the application
firewall and an internal application proxy is not used, no such rules are needed.

Outbound application proxies are useful for detecting systems that are making inappropriate or dangerous
connections from inside the protected network. By far the most common type of outbound proxy is for
HTTP. Outbound HTTP proxies allow an organization to filter dangerous content before it reaches the
requesting PC. They also help an organization better understand and log web traffic from its users, and to
detect activity that is being tunneled over HTTP. When an HTTP proxy filters content, it can alert the web
user that the site being visited sent the filtered content. The most prominent non-security benefit of HTTP
proxies is caching web pages for increased speed and decreased bandwidth use. Most organizations
should employ HTTP proxies.

4.3   Policies Based on User Identity

Traditional packet filtering does not see the identities of the users who are communicating in the traffic
traversing the firewall, so firewall technologies without more advanced capabilities cannot have policies
that allow or deny access based on those identities. However, many other firewall technologies can see
these identities and therefore enact policies based on user authentication. One of the most common ways
to enforce user identity policy at a firewall is by using a VPN. Both IPsec VPNs and SSL VPNs have
many ways to authenticate users, such as with secrets that are provisioned on a user-by-user basis, with
multi-factor authentication (e.g., time-based cryptographic tokens protected with PINs), or with digital
certificates controlled by each user. NAC has also become a popular method for firewalls to allow or deny
users access to particular network resources. In addition, application firewalls and proxies can allow or
deny access to users based on the user authentication within the applications themselves.

Firewalls that enforce policies based on user identity should be able to reflect these policies in their logs.
That is, it is probably not useful to only log the IP address from which a particular user connected if the
user was allowed in by a user-specific policy; it is also important to log the user’s identity as well.

4.4   Policies Based on Network Activity

Many firewalls allow the administrator to block established connections after a certain period of
inactivity. For example, if a user on the outside of a firewall has logged into a file server but has not made
any requests during the past 15 minutes, the policy might be to block any further traffic on that
connection. Time-based policies are useful in thwarting attacks caused by a logged-in user walking away
from a computer and someone else sitting down and using the established connections (and therefore the
logged-in user’s credentials). However, these policies can also be bothersome for users who make
connections but do not use them frequently. For instance, a user might connect to a file server to read a
file and then spend a long time editing the file. If the user does not save the file back to the file server
before the firewall-mandated timeout, the timeout could cause the changes to the file to be lost.

Some organizations have mandates about when firewalls should block connections that are considered to
be inactive, when applications should disconnect sessions if there is no activity, etc. A firewall used by
such an organization should be able to set policies that match the mandates while being specific enough to
match the security objective of the mandates.




                                                      4-6
