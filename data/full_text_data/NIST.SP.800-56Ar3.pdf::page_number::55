                                                                                               NIST SP 800-56A Rev. 3                              Recommendation for Pair-Wise Key Establishment
                                                                                                                                                           Using Discrete Logarithm Cryptography

                                                                                               5.6.2.3.2 FFC Partial Public-Key Validation Routine
                                                                                               FFC partial public-key validation refers to the process of performing only the first step of a
                                                                                               full public-key validation, omitting the check that determines whether the candidate FFC
                                                                                               public key is in the correct subgroup.
                                                                                               This routine shall only be used with ephemeral FFC public keys generated using the
                                                                                               approved safe-prime groups when assurance of the partial validity of such keys is to be
                                                                                               obtained as specified in Section 5.6.2.2.2.
                                                                                               Input:
                                                                                                  1. (p, q = (p –1)/2, g = 2) A valid set of "safe" FFC domain parameters corresponding
                                                                                                      to a safe-prime group (see Section 5.5.1.1), and
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                                  2. y: A candidate FFC public key.
                                                                                               Process:
                                                                                                  Verify that 2  y  p − 2.
                                                                                                      Success at this stage ensures that y has the expected representation for a nonzero field
                                                                                                      element (i.e., an integer in the interval [1, p – 1]) and that y is in the proper range for
                                                                                                      a properly generated public key.
                                                                                               Output: If the above verification fails, output an error indicator. Otherwise, output an
                                                                                               indication of successful validation.

                                                                                               5.6.2.3.3 ECC Full Public-Key Validation Routine
                                                                                               ECC full public-key validation refers to the process of checking all the arithmetic properties
                                                                                               of a candidate ECC public key to ensure that it has the expected representation for a non-
                                                                                               identity element of the correct subgroup of the appropriate elliptic-curve group, as specified
                                                                                               by the associated ECC domain parameters.
                                                                                               This routine shall be used when assurance of full public-key validity is required (or desired)
                                                                                               for a static or ephemeral ECC public key.
                                                                                               Input:
                                                                                                  1. (q, FR, a, b{, SEED}, G, n, h): A valid set of ECC domain parameters, and
                                                                                                  2. Q = (xQ, yQ ): A candidate ECC public key.
                                                                                               Process:
                                                                                                  1. Verify that Q is not the identity element Ø.
                                                                                                     Success at this stage ensures that Q is not the identity element of the elliptic-curve
                                                                                                     group (which would never be the value of a properly generated public key).
                                                                                                  2. Verify that xQ and yQ are integers in the interval [0, p − 1] in the case that q is an odd
                                                                                                     prime p, or that xQ and yQ are bit strings of length m bits in the case that q = 2m.
                                                                                                      Success at this stage ensures that each coordinate of the public key has the expected
                                                                                                      representation for an element in the underlying field, GF(q).
                                                                                                  3. Verify that Q is on the curve. In particular,
                                                                                                                                              44
