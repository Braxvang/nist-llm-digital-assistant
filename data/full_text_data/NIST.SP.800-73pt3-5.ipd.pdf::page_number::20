      NIST SP 800-73pt3-5 ipd (Initial Public Draft)             Interfaces for Personal Identity Verification: Part 3
      September 2023                                                                                 PIV Client API

471                    algorithmOutput                 Sequence of bytes output by the cryptographic
472                                                    operation
473                    outputLength                    As an input, length of the buffer allocated for
474                                                    algorithmOutput. As an output, length of the
475                                                    algorithm output.
476   Return Codes:             PIV_OK
477                             PIV_INVALID_CARD_HANDLE
478                             PIV_INVALID_KEYREF_OR_ALGORITHM
479                             PIV_SECURITY_CONDITIONS_NOT_SATISFIED
480                             PIV_INPUT_BYTES_MALFORMED
481                             PIV_CARD_READER_ERROR
482                             PIV_SM_FAILED
483                             PIV_INSUFFICIENT_BUFFER

484   The PIV_INPUT_BYTES_MALFORMED error condition indicates that some property of the data to be
485   processed, such as the length or padding, was inappropriate for the requested cryptographic
486   algorithm or key.
487   If the value of keyReference is '04' (PIV Secure Messaging key), then the PIV Middleware
488   SHALL return PIV_INVALID_KEYREF_OR_ALGORITHM.
489   If the length of the algorithm output is longer than the buffer allocated by the client application,
490   then the PIV Middleware SHALL return PIV_INSUFFICIENT_BUFFER but SHALL still set
491   outputLength to the length of the algorithm output.

492           Entry Points for Credential Initialization and Administration
493   The PIV Middleware SHALL NOT submit data provided to the pivPutData or
494   pivGenerateKeyPair function over the contactless interface. If the PIV Middleware is not
495   communicating with the PIV Card via the cardâ€™s contact interface, then the pivPutData or
496   pivGenerateKeyPair function SHALL return PIV_FUNCTION_NOT_SUPPORTED.

497   3.4.1. pivPutData
498   Purpose:         Replace the entire data content of the named data object with the provided data.
499   Prototype:       status_word pivPutData(
500                             IN handle                     cardHandle,
501                             IN string                     OID,
502                             IN LONG                       oidLength,
503                             IN sequence of byte           data,
504                             IN LONG                       dataLength
505                             );



                                                       12
