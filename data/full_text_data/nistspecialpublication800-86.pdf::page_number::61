                                                        GUIDE TO INTEGRATING FORENSIC TECHNIQUES INTO INCIDENT RESPONSE



6.       Using Data From Network Traffic

Analysts can use data from network traffic to reconstruct and analyze network-based attacks and
inappropriate network usage, as well as to troubleshoot various types of operational problems. The
content of communications carried over networks, such as e-mail messages or audio, might also be
collected in support of an investigation. The term network traffic refers to computer network
communications that are carried over wired or wireless networks between hosts.82 This section provides
an introduction to network traffic, including descriptions of major sources of network traffic data (e.g.,
intrusion detection software, firewalls). In addition, it discusses techniques for collecting data from these
sources and points out the potential legal and technical issues in such data collection. The remainder of
the section focuses on the techniques and tools for examining and analyzing data from network traffic.
The section begins with an overview of Transmission Control Protocol/Internet Protocol (TCP/IP)â€”a
basic knowledge of TCP/IP is necessary to understand the data, tools, and methodologies presented in this
section.

6.1      TCP/IP Basics

TCP/IP is widely used throughout the world to provide network communications. TCP/IP
communications are composed of four layers that work together. When a user wants to transfer data
across networks, the data is passed from the highest layer through intermediate layers to the lowest layer,
with each layer adding additional information. The lowest layer sends the accumulated data through the
physical network; the data is then passed up through the layers to its destination. Essentially, the data
produced by a layer is encapsulated in a larger container by the layer below it. The four TCP/IP layers,
from highest to lowest, are shown in Figure 6-1.


                      Application Layer. This layer sends and receives data for particular
                      applications, such as Domain Name System (DNS), Hypertext Transfer
                      Protocol (HTTP), and Simple Mail Transfer Protocol (SMTP).
                      Transport Layer. This layer provides connection-oriented or connectionless
                      services for transporting application layer services between networks. The
                      transport layer can optionally ensure the reliability of communications.
                      Transmission Control Protocol (TCP) and User Datagram Protocol (UDP) are
                      commonly used transport layer protocols.
                      Internet Protocol Layer (also known as Network Layer). This layer routes
                      packets across networks. IP is the fundamental network layer protocol for
                      TCP/IP. Other commonly used protocols at the network layer are Internet
                      Control Message Protocol (ICMP) and Internet Group Management Protocol
                      (IGMP).
                      Hardware Layer (also known as Data Link Layer). This layer handles
                      communications on the physical network components. The best known data
                      link layer protocol is Ethernet.

                                                  Figure 6-1. TCP/IP Layers


The four TCP/IP layers work together to transfer data between hosts. As shown in Figure 6-2, each layer
encapsulates the previous layers. Sections 6.1.1 through 6.1.4 describe these layers in greater detail and


82
      Because nearly all network traffic of interest to organizations uses the TCP/IP protocol suite, this section addresses only
      TCP/IP-based communications. However, most of the principles discussed in this section can be applied to other types of
      network traffic as well.


                                                                6-1
