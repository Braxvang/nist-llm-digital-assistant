                                                                                               NIST SP 800-56A Rev. 3                              Recommendation for Pair-Wise Key Establishment
                                                                                                                                                           Using Discrete Logarithm Cryptography

                                                                                                  Process:
                                                                                                      1. If the domain parameters are not approved, then return an ERROR indication as
                                                                                                         the status and (Invalid_d, Invalid_Q) as the key pair; then exit the process without
                                                                                                         performing the remaining steps.
                                                                                                      2. If s is not the maximum security strength that can be supported by the domain
                                                                                                         parameters, then return an ERROR indication as the status and (Invalid_d,
                                                                                                         Invalid_Q) as the key pair; then exit the process without performing the remaining
                                                                                                         steps.
                                                                                                      3. L = len(n).
                                                                                                      4. Obtain a string of L returned_bits using an RBG with a security strength of s bits
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                                         or more (see Section 5 in SP 800-133). If an ERROR indication is returned, then
                                                                                                         return an ERROR indication as the status and (Invalid_d, Invalid_Q) as the key
                                                                                                         pair; then exit the process without performing the remaining steps.
                                                                                                      5. Convert returned_bits to the (non-negative) integer c in the interval
                                                                                                         [0, 2L – 1] (see Appendix C.4).
                                                                                                      6. If (c > n – 2), then go to step 4.
                                                                                                      7. d = c + 1.
                                                                                                      8. Q = dG.
                                                                                                    9. Return SUCCESS as the status and (d, Q) as the key pair.
                                                                                                  Output: SUCCESS and (d, Q), or
                                                                                                      an ERROR indication and (Invalid_d, Invalid_Q).

                                                                                               5.6.2 Required Assurances
                                                                                               To explain the assurance requirements associated with key-establishment key pairs, some
                                                                                               terminology needs to be introduced. The owner of a static key pair is defined as the entity
                                                                                               that is authorized to use the private key that corresponds to the public key; this is independent
                                                                                               of whether or not the owner generated the key pair. The recipient of a static public key is
                                                                                               defined as the entity that is participating in a key-establishment transaction with the owner
                                                                                               and obtains the key before or during the current transaction. The owner of an ephemeral
                                                                                               public key is the entity that generated the key as part of a key-establishment transaction. The
                                                                                               recipient of an ephemeral public key is the entity that receives that public key during a key-
                                                                                               establishment transaction with its owner.
                                                                                               Secure key establishment depends upon the use of valid key-establishment keys. Prior to
                                                                                               obtaining the assurances described in this section, the owner of a key pair and the recipient
                                                                                               of the public key of that key pair shall obtain assurance of the validity of the associated
                                                                                               domain parameters (see Section 5.5.2).
                                                                                               The security of key-agreement schemes also depends on limiting knowledge of the private
                                                                                               keys to those who have been authorized to use them (i.e., their respective owners) and to a
                                                                                               trusted third party if that party generated them. In addition to preventing unauthorized entities


                                                                                                                                              32
