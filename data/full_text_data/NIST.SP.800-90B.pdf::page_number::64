                                                                                             NIST SP 800-90B                                                           RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                               USED FOR RANDOM BIT GENERATION

                                                                                                                            1. Let D[si-j-1, …, si-2] be added to the dictionary.
                                                                                                                            2. Let D[si-j-1, …, si-2][si-1] = 0.
                                                                                                                            3. dictionarySize = dictionarySize + 1
                                                                                                                 ii. If (si-j-1, … , si-2) is in D,
                                                                                                                            1. Let D[si-j-1, …, si-2][si-1] = D[si-j-1, … ,si-2][si-1] + 1.
                                                                                                       b. Use the dictionary to predict the next value, si. Let prediction = Null, and let
                                                                                                          maxcount = 0. For j = B down to 1:
                                                                                                                  i. Let prev = (si−j, … si−1).
                                                                                                                 ii. If prev is in the dictionary, find the y ϵ {x1, …,xk} that has the highest
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                                                     D[prev][y] value. In the event of a tie, let the y be the symbol with the higher
                                                                                                                     byte value. For example, if D[prev][1] and D[prev][5] both have the highest
                                                                                                                     value, then y = 5.
                                                                                                                iii. If D[prev][y] > maxcount:
                                                                                                                            1. prediction = y.
                                                                                                                            2. maxcount = D[prev][y].
                                                                                                       c. If (prediction = si), let correcti−B−1 = 1.
                                                                                                                                                                                      𝐶𝐶
                                                                                                4. Calculate the predictor’s global performance as 𝑃𝑃𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 = 𝑁𝑁 . The upper bound of the 99 %
                                                                                                                                                      ′
                                                                                                   confidence interval on 𝑃𝑃𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 , denoted 𝑃𝑃𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 is calculated as:
                                                                                                                                                                1
                                                                                                                                                1 − 0.01 𝑁𝑁 ,                               if 𝑃𝑃𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 = 0,
                                                                                                           ′
                                                                                                        𝑃𝑃𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 =�
                                                                                                                                                       𝑃𝑃            �1−𝑃𝑃            �
                                                                                                                         min(1, 𝑃𝑃𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 + 2.576� 𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 𝑁𝑁−1 𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 ),     otherwise

                                                                                                   where 2.576 corresponds to the 𝑍𝑍(1−0.005) value.
                                                                                                5. Calculate the predictor’s local performance, based on the longest run of correct predictions.
                                                                                                   Let r be one greater than the length of the longest run of ones in correct. Use a binary
                                                                                                   search to solve the following for 𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙 :
                                                                                                                                                       1 − 𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙 𝑥𝑥     1
                                                                                                                                         0.99 =                            × 𝑁𝑁+1 ,
                                                                                                                                                     (𝑟𝑟 + 1 − 𝑟𝑟𝑟𝑟)𝑞𝑞      𝑥𝑥

                                                                                                   where 𝑞𝑞 = 1 − 𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙 and x = x10, derived by iterating the recurrence relation
                                                                                                                                                                  𝑟𝑟           𝑟𝑟+1
                                                                                                                                                  𝑥𝑥𝑗𝑗 = 1 + 𝑞𝑞𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙 𝑥𝑥𝑗𝑗−1

                                                                                                   for j from 1 to 10, and x0 = 1. Note that solving for 𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙 using the logarithm of these
                                                                                                   equations is robust against overflows. Table 3 given in Appendix G.2 provides some pre-
                                                                                                   calculated values of 𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙 .

                                                                                                6. The min-entropy is the negative logarithm of the greater performance metric


                                                                                                                                                           56
