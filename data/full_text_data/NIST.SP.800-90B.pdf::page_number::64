                                                                                             NIST SP 800-90B                                                           RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                               USED FOR RANDOM BIT GENERATION

                                                                                                                            1. Let D[si-j-1, â€¦, si-2] be added to the dictionary.
                                                                                                                            2. Let D[si-j-1, â€¦, si-2][si-1] = 0.
                                                                                                                            3. dictionarySize = dictionarySize + 1
                                                                                                                 ii. If (si-j-1, â€¦ , si-2) is in D,
                                                                                                                            1. Let D[si-j-1, â€¦, si-2][si-1] = D[si-j-1, â€¦ ,si-2][si-1] + 1.
                                                                                                       b. Use the dictionary to predict the next value, si. Let prediction = Null, and let
                                                                                                          maxcount = 0. For j = B down to 1:
                                                                                                                  i. Let prev = (siâˆ’j, â€¦ siâˆ’1).
                                                                                                                 ii. If prev is in the dictionary, find the y Ïµ {x1, â€¦,xk} that has the highest
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                                                     D[prev][y] value. In the event of a tie, let the y be the symbol with the higher
                                                                                                                     byte value. For example, if D[prev][1] and D[prev][5] both have the highest
                                                                                                                     value, then y = 5.
                                                                                                                iii. If D[prev][y] > maxcount:
                                                                                                                            1. prediction = y.
                                                                                                                            2. maxcount = D[prev][y].
                                                                                                       c. If (prediction = si), let correctiâˆ’Bâˆ’1 = 1.
                                                                                                                                                                                      ğ¶ğ¶
                                                                                                4. Calculate the predictorâ€™s global performance as ğ‘ƒğ‘ƒğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” = ğ‘ğ‘ . The upper bound of the 99 %
                                                                                                                                                      â€²
                                                                                                   confidence interval on ğ‘ƒğ‘ƒğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” , denoted ğ‘ƒğ‘ƒğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” is calculated as:
                                                                                                                                                                1
                                                                                                                                                1 âˆ’ 0.01 ğ‘ğ‘ ,                               if ğ‘ƒğ‘ƒğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” = 0,
                                                                                                           â€²
                                                                                                        ğ‘ƒğ‘ƒğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” =ï¿½
                                                                                                                                                       ğ‘ƒğ‘ƒ            ï¿½1âˆ’ğ‘ƒğ‘ƒ            ï¿½
                                                                                                                         min(1, ğ‘ƒğ‘ƒğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” + 2.576ï¿½ ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” ğ‘ğ‘âˆ’1 ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” ),     otherwise

                                                                                                   where 2.576 corresponds to the ğ‘ğ‘(1âˆ’0.005) value.
                                                                                                5. Calculate the predictorâ€™s local performance, based on the longest run of correct predictions.
                                                                                                   Let r be one greater than the length of the longest run of ones in correct. Use a binary
                                                                                                   search to solve the following for ğ‘ƒğ‘ƒğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ :
                                                                                                                                                       1 âˆ’ ğ‘ƒğ‘ƒğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ ğ‘¥ğ‘¥     1
                                                                                                                                         0.99 =                            Ã— ğ‘ğ‘+1 ,
                                                                                                                                                     (ğ‘Ÿğ‘Ÿ + 1 âˆ’ ğ‘Ÿğ‘Ÿğ‘Ÿğ‘Ÿ)ğ‘ğ‘      ğ‘¥ğ‘¥

                                                                                                   where ğ‘ğ‘ = 1 âˆ’ ğ‘ƒğ‘ƒğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ and x = x10, derived by iterating the recurrence relation
                                                                                                                                                                  ğ‘Ÿğ‘Ÿ           ğ‘Ÿğ‘Ÿ+1
                                                                                                                                                  ğ‘¥ğ‘¥ğ‘—ğ‘— = 1 + ğ‘ğ‘ğ‘ƒğ‘ƒğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ ğ‘¥ğ‘¥ğ‘—ğ‘—âˆ’1

                                                                                                   for j from 1 to 10, and x0 = 1. Note that solving for ğ‘ƒğ‘ƒğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ using the logarithm of these
                                                                                                   equations is robust against overflows. Table 3 given in Appendix G.2 provides some pre-
                                                                                                   calculated values of ğ‘ƒğ‘ƒğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ .

                                                                                                6. The min-entropy is the negative logarithm of the greater performance metric


                                                                                                                                                           56
