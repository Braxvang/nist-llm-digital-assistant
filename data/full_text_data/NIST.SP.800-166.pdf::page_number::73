NIST SP 800-166                                                    DERIVED PIV APPLICATION AND
                                                                   DATA MODEL TEST GUIDELINES

                          3. Send the VERIFY command after the issuer specified
                             maximum number of password tries is exceeded with
                                • P2, key reference value, is set to '80'
                                • Data field of the command will contain the
                                   correct password value, padded with 'FF' (if
                                   necessary) to complete the total length of the
                                   value to 8 bytes
 Expected Result(s)       1. From Step 1, the command returns the application property
                             template with the status word '90 00'.
                          2. From Step 2, the command returns status word '63 CX' until the
                             maximum number of password tries is reached (X indicates the
                             number of further allowed retries). The command returns status
                             word '69 83' (authentication method blocked) when the
                             maximum number of password tries is exceeded.
                          3. From Step 3, the command returns status word '69 83'
                             (authentication method blocked).
 Postcondition(s)         The Derived PIV Application Password’s retry counter is 0.

8.3.5 CHANGE REFERENCE DATA Command

8.3.5.1 Change Reference Data with the Correct Derived PIV Application Password and
        with the Correct PUK

 Test Assertion       TA-08.03.05.01
 Purpose              Verifies that the Derived PIV Application can change the current
                      password with CHANGE REFERENCE DATA command.
 DTR(s)               • DTR-06.02.02.09
                      • DTR-06.03.01.01
                      • DTR-06.03.05.06
                      • DTR-06.03.06.01
                      • DTR-06.03.06.03
 Vendor               The vendor to provide in its documentation the reset retry value of the
 Documentation        Derived PIV Application Password
 Precondition(s)      •   A token with the Derived PIV Application is inserted into an
                          appropriate token reader.
                      •   Suitable drivers have been loaded between the test system and an
                          instance of the reader.
                      •   The Derived PIV Application Password and PUK are recorded.
                      •   The Derived PIV Application Password’s retry counter and the
                          PUK’s retry counter are not 0.
 Test Scenario        1. Send the SELECT command with
                            • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                      2. Send the CHANGE REFERENCE DATA command with
                            • P2, key reference value, is set to '80'
                            • Data field of the command will contain the
                               correct password value (password 1), concatenated
                               without delimitation with an arbitrary new valid


                                            66
