NIST SP 800-85A-4                                         PIV CARD APPLICATION & MIDDLEWARE
                                                                   INTERFACE TEST GUIDELINES

                                    •P2, key reference value is set to '98'
                                    •Data field of the command will contain the
                                     correct pairing code value (pairing code 1)
                                     concatenated without delimitation with an
                                     arbitrary new pairing code value (pairing code
                                     2)
                      6. Send CHANGE REFERENCE DATA card command with
                         • P2, key reference value, is set to a value other than
                            what is supported by the card
                         • Data field of the command will contain the correct PIV
                            Card Application PIN value (PIN 2) concatenated without
                            delimitation with an arbitrary new PIN value (PIN 8).
                            Both PINs are truncated or padded with 'FF' to complete
                            the total length of each value to 8 bytes
 Expected Result(s)   1. Command returns the application property template with the
                          status word '90 00' at the end
                      2. Command returns the same result as in C.2.1.1
                         2a:
                              1. The command returns '90 00' (also verify that the retry
                                  counter is set to reset retry value).
                              2. The command returns '90 00'.
                              3. The command returns '6A 80' (incorrect parameter in
                                  command data field) and the retry counter remains
                                  unchanged.
                               4. The command returns '6A 80' (incorrect parameter in
                                  command data field) and the retry counter remains
                                  unchanged.
                              5. The command returns '6A 80' (incorrect parameter in
                                  command data field) and the retry counter remains
                                  unchanged.
                              6. Each time, the command returns '6A 80' (incorrect
                                  parameter in command data field) and the retry counter
                                  remains unchanged.
                              7. Each time, either 1) the command returns '6A 80' and the
                                  retry counter remains unchanged or 2) the command
                                  returns '63 CX' (X indicates the number of further allowed
                                  retries) and the retry counter is decremented.
                              8. The command returns:
                                       • '63 CX' until the maximum number of tries are
                                           reached. (X indicates the number of further allowed
                                           retries).
                                       • '69 83' (reference data change operation blocked)
                                           when the maximum number of tries is exceeded.
                         2b:
                              1. The expected results in 2b are the same as in 2a.
                      3.


                                        C-22
