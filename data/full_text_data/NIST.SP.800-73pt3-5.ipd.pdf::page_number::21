      NIST SP 800-73pt3-5 ipd (Initial Public Draft)             Interfaces for Personal Identity Verification: Part 3
      September 2023                                                                                 PIV Client API

506   Parameters:               cardHandle             Opaque identifier of the card to be acted upon as
507                                                    returned by pivConnect
508                             OID                    Object identifier of the object whose data content is
509                                                    to be replaced coded as a string (e.g.,
510                                                    “2.16.840.1.101.3.7.2.96.80”). See SP 800-73-5
511                                                    Part1, Table 3.
512                             oidLength              Length of the object identifier
513                             data                   Data to be used to replace in its entirety the data
514                                                    content of the named data object
515                             dataLength             Length of the provided data
516   Return Codes:             PIV_OK
517                             PIV_INVALID_CARD_HANDLE PIV_INVALID_OID PIV_CARD_READER_ERROR
518                             PIV_INSUFFICIENT_CARD_RESOURCE
519                             PIV_SECURITY_CONDITIONS_NOT_SATISFIED
520                             PIV_FUNCTION_NOT_SUPPORTED


521   3.4.2. pivGenerateKeyPair
522   Purpose:         Generates an asymmetric key pair in the currently selected card application.
523                    If the provided key reference exists and the cryptographic mechanism associated
524                    with the reference data identified by this key reference is the same as the provided
525                    cryptographic mechanism, then the generated key pair replaces in entirety the key
526                    pair currently associated with the key reference.
527   Prototype:       status_word pivGenerateKeyPair(
528                    IN handle                              cardHandle,
529                    IN byte                                keyReference,
530                    IN byte                                cryptographicMechanism,
531                    OUT sequence of byte                   publicKey,
532                    INOUT LONG                             KeyLength
533                    );

534   Parameters: cardHandle                           Opaque identifier of the card to be acted upon as
535                                                    returned by pivConnect
536                    keyReference                    The key reference of the generated key pair
537                    cryptographicMechanism          The type of key pair to be generated. See SP 800-
538                                                    73-5 Part1, Table 7.
539                    publicKey                       BER-TLV data objects defining the public key of
540                                                    the generated key pair. See SP 800-73-5 Part2,
541                                                    Table 11.


                                                       13
