                                                            SECURE DOMAIN NAME SYSTEM (DNS) DEPLOYMENT GUIDE




Checklist item 40: Whenever Aggregate Caches are deployed, the forwarders must be configured to be
Validating Resolvers.


Stub resolvers do not have many configuration options. Often the only configuration necessary for an
administrator is to enter the IP addresses of one or more recursive resolvers that the stub would rely on to
service queries. It is a good idea for administrators to include at least two IP addresses of recursive
servers to increase the availability of the DNS service for end users. This can be done manually, or using
a protocol like DHCP.

There is a known class of malware that attempts to change the settings on a system’s stub resolver to
direct queries to another (usually malicious) recursive server. The server may then direct end users to a
malicious site where another attack takes place, or the server may simply direct users to a webpage that
serves ads or similar non-intended content. To combat this, administrators should make sure end user
systems have the latest anti-virus/malware software and should consider blocking all outbound DNS
traffic with the exception of known recursive servers.



Checklist item 41: Administrators should configure two or more recursive resolvers for each stub client
on the network.

Checklist item 42: Enterprise firewalls should consider restricting outbound DNS traffic to only the
enterprise’s designated recursive resolvers.



12.3 Setting up the Root Hints File

Every recursive server needs to know the IP address of one or more root servers. If the recursive server
cannot find the answer to a stub resolver’s query in its cache, it must perform a recursive lookup for the
correct information to respond to the client. It does this by first sending the query to one of the root zone
servers and following one or more referrals until it reaches one of the authoritative servers of the DNS
zone data. See Section 2.2 for a more detailed discussion of the DNS resolution process.

The IP addresses of the root servers are stored in a file often referred to as the root hints file. It is not
considered authoritative information, but only hints for the locations of the root zone servers. On startup
(and regular intervals), recursive servers send queries to each IP address in the root hints file for the full
list of root zone servers. It then maintains this information in its cache until it is time to refresh this data.

It is also necessary for a human administrator to also regularly check the contents of the root hints file for
any necessary updates. Missing any changes to the set of root zone servers may result in delays at startup
(while waiting for queries to time out) or security vulnerabilities (attackers using spoofed root zone IP
addresses). The list of public DNS root zone servers are maintained as part of the IANA functions 13 and
administrators can download the current root hints file as well as the DNSSEC public key of the root
zone.



13
     http://www.iana.org/domains/root/files


                                                      12-17
