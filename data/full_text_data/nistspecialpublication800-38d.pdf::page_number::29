                                  NIST Special Publication 800-38D


There are no requirements on the bits in the free field. For example, they may identify the
device, similar to the fixed field of the deterministic construction, except within the RBG-based
construction these identifiers are not required to be distinct for each device. For any IV length
that is associated to the RBG-construction, the free field is recommended to be empty, so that the
random field is the entire IV.

The instantiations of the RBGs in any two distinct devices shall be independent, so that the
distribution of direct random strings across all of the RBG instantiations is expected to be
uniform. For example, if the initialization of the RBG instantiations depends only on a secret
seed, then each instantiation shall be initialized with a distinct seed.

8.3       Constraints on the Number of Invocations

The following requirement applies to all implementations that use either 1) the deterministic
construction with IVs whose length is not 96, or 2) the RBG-based construction, for IVs of any
length. In other words, unless an implementation only uses 96-bit IVs that are generated by the
deterministic construction:

The total number of invocations of the authenticated encryption function shall not exceed
232, including all IV lengths and all instances of the authenticated encryption function with
the given key.

This is a “global” requirement that can be achieved by appropriate “local” limits on each
instance of the authenticated encryption function with a given key. For example, suppose an
implementation consists of 210 devices that only support 64-bit, 96-bit, and 128-bit IVs. One
way to satisfy the above requirement would be to limit each device to 220 invocations with 64-bit
IVs, 221 invocations with 96-bit IVs, and 220 invocations with 128-bit IVs.

For the RBG-based construction of IVs, the above requirement, in conjunction with the
requirement that r(i)≥96, is sufficient to ensure the uniqueness requirement in Sec. 8, as follows
from the discussion in Ref. [4].

For the deterministic construction, the lengths of the two fields imply two additional operational
constraints. These constraints apply to any supported IV length, including 96 bits:

      •    The bit length of the invocation field limits the number of invocations of the
           authenticated encryption function with any given fixed field and key. In particular, if s
           denotes the number of bits in the invocation field, then the authenticated encryption
           function cannot be invoked on more than 2s distinct input sets without violating the
           uniqueness requirement.

      •    Similarly, an s-bit fixed field implies a limit of 2s on the number of distinct
           devices/contexts that can implement the authenticated encryption function for the given
           key, with IVs of the given length.




                                                  21
