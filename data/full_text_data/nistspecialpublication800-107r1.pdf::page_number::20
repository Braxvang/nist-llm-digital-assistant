SP 800-56A and B specify single-step key derivation functions using HMAC in the
concatenation and ASN.1 forms.
The security strength that can be provided by a derived key depends on the security
strength of the asymmetric keys used to generate the shared secret, the preimage strength
of the hash function used in the HMAC construction in the KDF and the length of the
derived key. Note that in this case, the key used for HMAC is a salt, which can be a
publicly known value, a secret value, or a combination of both. Therefore, if a derived
key is intended to provide s bits of security strength, then each of the following shall be
equal to or greater than s:
   •      The security strength provided by the asymmetric keys,
   •      The preimage strength of the hash function used in the HMAC construction, and
   •      The length of the derived key in bits.
5.4.2.2    Using HMAC in the Two-Step Key Derivation Process
SP 800-56C specifies a two-step key derivation procedure, which is also known as an
“extraction-then-expansion” procedure. This procedure is included by reference in SPs
800-56A and B.
The extraction-then-expansion procedure in SP 800-56C is comprised of two separate
steps: randomness-extraction and key-expansion, both of which can be implemented
using an HMAC construction; when this construction is used, the same hash function is
used for the randomness extraction and key expansion steps.
The security strength that can be provided by a key derived using the two-step procedure
depends on the security strength of the asymmetric keys used to generate the shared
secret, the preimage strength of the hash function used in each HMAC construction and
the length of the derived key. In the randomness extraction step, the key used for HMAC
is a salt, which can be a publicly known value, a secret value, or a combination of both;
the result of this step is a key derivation key. In the key expansion step, the key used for
HMAC is the entire key derivation key that was output from the randomness extraction
step, e.g., if SHA-1 is used during the randomness extraction step, then the output is 160
bits in length, and is used as the key derivation key for the key expansion step.
When this two-step procedure is used, if a derived key is intended to provide s bits of
security strength, then each of the following shall be equal to or greater than s:
   •      The security strength provided by the asymmetric keys,
   •      The preimage strength of the hash function used in the HMAC construction of
          each step of the procedure, and
   •      The length of the derived key in bits.

5.4.3 Using HMAC for Key Derivation from a Pre-shared Key
This section discusses and provides security requirements for the KDFs in SP 800-108
that are used to derive keying material from a pre-shared (i.e., existing) key, called a key-


                                               17
