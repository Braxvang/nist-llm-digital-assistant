However, to be compliant with this Recommendation, IPsec ESP-protected traffic shall
always be integrity-protected, either through the use of an integrity-protection algorithm,
such as HMAC-SHA1-96, or through the use of a combined-mode algorithm, such as
AES-128 in Galois/Counter Mode. Therefore, encrypted ESP shall not be used with
NULL integrity-protection.

When IPsec-protected traffic is integrity-protected, an Integrity Check Value (ICV) is
stored in the Integrity Check Value field of the ESP payload [RFC 4303] or in the
Integrity Check Value field of the Authentication Header (AH) [RFC 4302]; this field is
referred to as the “Authentication Data” field in IPsec-v2 ([RFC 2406], [RFC 2402]).

When HMAC is used for integrity protection, the length of the ICV value is at most the
size of the output value of the hash function. For example, the ICV value for HMAC-
SHA1-96 and HMAC-SHA256-128 is 96 and 128 bits, respectively [RFC 4868].

Although the IETF still recommends supporting AES-XCBC-MAC ([RFC 3566], [RFC
4434], [RFC 7321]), it is not approved for use by the Federal Government. As such,
AES-XCBC-MAC shall not be used for integrity protection.

A new class of algorithms, called combined-mode algorithms, appears in the above table.
They can be negotiated by IKE and used within IPsec-v3 cipher suites. These algorithms
provide both encryption and integrity protection. Two combined-mode algorithms have
been approved for Federal Government use: AES in Galois/Counter Mode (GCM) [RFC
4106] and AES in counter mode with CBC-MAC (AES-CCM) [RFC 4309].

There is also a variant of AES-GCM, referred to as AES-GMAC [RFC 4543], that
provides integrity protection, but does not provide encryption. This mode may be used
within either the ESP or AH header.

The maximum size of the ICV for AES-CCM, AES-GCM and AES-GMAC is 16 bytes.
Implementations shall support an ICV size of 16 bytes for these three algorithms ([RFC
4309], [RFC 4106], [RFC 4543]).

AES-GCM, AES-CCM, AES-CTR, and AES-GMAC shall not be used with manually
distributed keys. If the counter value, in AES-CTR or AES-CCM, or the IV value, in
AES-GCM or AES-GMAC, is used for more than one packet with the same key, the
security of the algorithm’s confidentiality mechanism is compromised. Since manual
keying presents a major challenge to this limit, manually distributed keys shall not be
used with these algorithms. Automated keying using IKE establishes secret keys for the
two peers within each Security Association, with an extremely small probability of
duplicate keys.

In previous IETF guidance, single DES using the CBC mode [RFC 2405] was
mandatory-to-implement; however, this algorithm shall not be used to protect
information.



                                            28
