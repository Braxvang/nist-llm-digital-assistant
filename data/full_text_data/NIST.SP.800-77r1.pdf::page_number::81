                                                                                              NIST SP 800-77 REV. 1                                                                                  GUIDE TO IPSEC VPNS


                                                                                                                  encapsulation, TCP encapsulation is a recent addition that has not yet reached
                                                                                                                  universal support in IPsec devices.

                                                                                              7.2.1.2 Third-Party IPsec Client Software for Hosts

                                                                                              In IPsec host-to-host and remote access architectures, each host must have an IPsec-compliant
                                                                                              implementation installed and configured. Most operating systems on computers and mobile
                                                                                              devices have built-in support for IPsec and only require configuration or an enterprise
                                                                                              provisioning system that provides and installs the required configurations. However, some
                                                                                              mobile devices or embedded devices do not have a built-in IPsec implementation. Also, some
                                                                                              built-in clients might be lacking a feature required for a certain deployment or might not support
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              an enterprise provisioning system. In such cases, a third-party client might need to be deployed
                                                                                              instead. Third-party clients must be distributed and installed, then configured or provisioned. 50

                                                                                              Features that may be of interest when evaluating IPsec client software include support for the
                                                                                              following:
                                                                                                   •    IKEv2
                                                                                                   •    IKEv1 (if communicating to legacy equipment)
                                                                                                   •    IKEv2 fragmentation
                                                                                                   •    IKEv2 encapsulation (UDP, TCP, or TCP-TLS)
                                                                                                   •    IKEv2 PPK
                                                                                                   •    Particular encryption, integrity protection, and compression algorithms
                                                                                                   •    Particular authentication methods, such as EAP-TLS, RSA, and ECDSA
                                                                                                   •    Multiple simultaneous tunnels 51 . However, a host shall not have more than 1 tunnel at
                                                                                                        any given time.
                                                                                                   •    Authentication support for hardware tokens utilizing Open Authorization (OAuth), OTP,
                                                                                                        or Fast Identity Online (FIDO)
                                                                                                   •    Flexible X.509 certificates and optional IPsec Extended Key Usage (EKU) restrictions
                                                                                                   •    CRL and/or OCSP support
                                                                                                   •    Certificate uniform resource indicator (URI) and raw keys for embedded clients
                                                                                                   •    DNSSEC provisioning of enterprise trust anchors

                                                                                              Another important IPsec client feature is the ability to allow or prevent split tunneling. Split
                                                                                              tunneling occurs when an IPsec client on an external network is not configured to send all of its
                                                                                              traffic to the organization’s IPsec gateway. Requests with a destination on the organization’s

                                                                                              50   Organizations deploying third-party clients should pay particular attention to mobile devices and application stores. On
                                                                                                   some smartphone platforms, questionable VPN implementations have been made available where the goal of the VPN
                                                                                                   service is to monitor and/or modify the user’s traffic before it is protected by IPsec.
                                                                                              51   A host could perform two types of communications that each need different protective measures from IPsec.



                                                                                                                                                             64
