NIST SP 800-85A-4                                            PIV CARD APPLICATION & MIDDLEWARE
                                                                      INTERFACE TEST GUIDELINES

be able to recognize and process all mandatory and optional PIV data objects. PIV
Middleware that returns a versionString of “800-73-4 Client API” shall implement all PIV
Middleware functions listed in Table 1 except pivEstablishSecureMessaging and shall be able
to recognize and process all mandatory and optional PIV data objects. The
pivMiddlewareVersion’s purpose is to return the PIV Middleware version string. For SP 800-
73-4 Part 3 conformant PIV Middleware, the parameter returns “800-73-4 Client API” or
“800-73-4 Client API with SM” if optional secure messaging is supported.

Required Test Procedures

TE04.03B-R4.01: The tester shall validate that the PIV Middleware supports all functions listed in
Table 1 of SP 800-73-4 Part 3 and implements the pivMiddlewareVersion as per SP 800-73-4 Part 3
by returning the appropriate parameter string “800-73-4 Client API” parameter string or “800-73-4
Client API with SM” if optional secure messaging is supported.

A.4.2     Entry Points for Data Access

A.4.2.1    pivSelectCardApplication

AS04.04: The purpose of pivSelectCardApplication is to set the PIV Card Application as the
currently selected card application and establish the PIV Card Application’s security state.

Required Test Procedures

TE04.04.01: The tester shall validate that the PIV Middleware implements
pivSelectCardApplication as per SP 800-73-4, Part 3.

AS04.04A-R4: If the length of application properties is longer than the buffer allocated by the
PIV client application, then the PIV Middleware shall return PIV_INSUFFICIENT_BUFFER,
but shall still set APLength to the length of the application properties.

Required Test Procedures

TE04.04A-R4.01: The tester shall ensure that the PIV Middleware returns
PIV_INSUFFICIENT_BUFFER if the length of application properties is longer than the buffer
allocated by the client application.

A.4.2.2    pivLogIntoCardApplication

AS04.05: The purpose of pivLogIntoCardApplication is to set the security state within the
PIV Card Application.

Required Test Procedures

TE04.05.01: The tester shall validate that the PIV Middleware implements the
pivLogIntoCardApplication as per SP 800-73-4 Part 3.



                                         A-12
