       NIST SP 800-90C 3pd (Third Public Draft)                         Recommendation for RBG Constructions
       September 2022

1053   The Get_conditioned_full_entropy_ input function below obtains entropy from one or more
1054   entropy sources using the Get_ES_Bitstring function discussed in Section 3.1 and conditions it
1055   to provide an n-bit string with full entropy.
1056   Get_conditioned_full_entropy_input:
1057      Input: integer n.                           Comment: the requested number of full-entropy bits.
1058       Output: integer status, bitstring returned_bitstring.
1059   Process:
1060      1. temp = the Null string.
1061       2. ctr = 0.
1062       3. While ctr < n, do
1063           3.1    (status, entropy_bitstring) = Get_ES_Bitstring(output_len + 64).
1064           3.2   If (status ≠ SUCCESS), then return (status, invalid_bitstring).
1065           3.3   conditioned_output = Conditioning_function(input_parameters).
1066           3.4   temp = temp || conditioned_output.
1067           3.5   ctr = ctr + output_len.
1068       4. returned_bitstring = leftmost(temp, n).
1069       5. Return (SUCCESS, returned_bitstring).
1070   Steps 1 and 2 initialize the temporary bitstring (temp) for storing the full-entropy bitstring being
1071   assembled and the counter (ctr) that counts the number of full-entropy bits produced for each
1072   iteration of step 3.
1073   Step 3 obtains and processes the entropy for each iteration.
1074       •   Step 3.1 requests output_len + 64 bits from the validated entropy sources. When the output
1075           of multiple entropy sources is used, the entropy counted for fulfilling the request for outlen
1076           + 64 bits is determined using Method 1 or Method 2 as specified in Section 2.3 in the
1077           following situations:
1078           Method 1 shall be used when:
1079           Instantiating and reseeding an RBG2(P) construction containing a CTR_DRBG with no
1080           derivation function (see Section 5.2.1, item 1b, and Section 5.2.3),
1081           Instantiating and reseeding a CTR_DRBG with no derivation function that is used within
1082           an RBG3 construction (see Section 6.1, requirement 1), or
1083           Generating bits in an RBG3(XOR) construction (see Section 6.2.1.2, step 1).
1084           Method 2 shall be used when instantiating and reseeding an RBG2(NP) construction
1085           containing a CTR_DRBG with no derivation function (see Section 5.2.1, item 1b, and
1086           Section 5.2.3).




                                                        25
