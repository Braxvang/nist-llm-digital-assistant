                                                                                               NIST SP 800-56A Rev. 3                            Recommendation for Pair-Wise Key Establishment
                                                                                                                                                         Using Discrete Logarithm Cryptography

                                                                                               In this scheme, each party has different actions, which are presented separately below.
                                                                                               However, note that parties U and V must use identical orderings of the bit strings that are
                                                                                               input to the key-derivation method.

                                                                                               Party U shall execute the following actions to a) establish a shared secret value Z with party
                                                                                               V, and b) derive secret keying material from Z.
                                                                                               Actions: Party U generates a shared secret and derives secret keying material as follows:
                                                                                                  1. Generate an ephemeral key pair (de,U, Qe,U) from the domain parameters D as specified
                                                                                                     in Section 5.6.1.2. Send the public key Qe,U to V.
                                                                                                  2. Use the ECC CDH primitive in Section 5.7.1.2 to derive a shared secret Zs from the
                                                                                                     set of domain parameters D, party U’s static private key ds,U, and party V’s static
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                                     public key Qs,V. If the call to the ECC CDH primitive outputs an error indicator,
                                                                                                     destroy the ephemeral private key de,U, and destroy the results of all intermediate
                                                                                                     calculations used in the attempted computation of Zs; then output an error indicator,
                                                                                                     and exit this process without performing the remaining actions.
                                                                                                  3. Use the ECC CDH primitive to derive a shared secret Ze, from the set of domain
                                                                                                     parameters D, party U’s ephemeral private key de,U, and party V’s static public key
                                                                                                     Qs,V. If this call to the ECC CDH primitive outputs an error indicator, destroy Zs and
                                                                                                     the ephemeral private key de,U, and destroy the results of all intermediate calculations
                                                                                                     used in the attempted computation of Ze; then output an error indicator, and exit this
                                                                                                     process without performing the remaining actions.
                                                                                                  4. Compute the shared secret Z = Ze || Zs. Destroy Ze and Zs.
                                                                                                  5. Use the agreed-upon key-derivation method to derive secret keying material with the
                                                                                                     specified length from the shared secret value Z and other input (see Section 5.8). If
                                                                                                     the key-derivation method outputs an error indicator, destroy all copies of Z and the
                                                                                                     ephemeral private key de,U; then output an error indicator, and exit this process
                                                                                                     without performing the remaining actions.
                                                                                                  6. Destroy de,U and all copies of the shared secret Z.
                                                                                                  7. Output the derived keying material.
                                                                                               Output: The derived keying material or an error indicator.

                                                                                               Party V shall execute the following actions to a) establish a shared secret value Z with party
                                                                                               U, and b) derive secret keying material from Z.
                                                                                               Actions: Party V derives secret keying material as follows:
                                                                                                  1. Receive an ephemeral public key Qe,U (purportedly) from party U. If Qe,U is not
                                                                                                     received, then output an error indicator, and exit this process without performing the
                                                                                                     remaining actions.
                                                                                                  2. Verify that Qe,U is a valid ephemeral public key for the parameters D as specified in
                                                                                                     Section 5.6.2.3. If assurance of public key validity cannot be obtained, then output an
                                                                                                     error indicator, and exit this process without performing the remaining actions.

                                                                                                                                            86
