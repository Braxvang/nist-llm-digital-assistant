                                                                                              NIST SP 800-77 REV. 1                                                              GUIDE TO IPSEC VPNS


                                                                                              In IKEv1, a misconfiguration of the mode (transport or tunnel) or compression would lead to a
                                                                                              failure in establishing the IPsec SA. With IKEv2, transport mode and compression can only be
                                                                                              requested. If not confirmed, the IPsec SA must be established in tunnel mode or without
                                                                                              compression.

                                                                                              The best way to determine interoperability between vendors is to actually test them in a lab
                                                                                              environment. Another approach is to research issues with the products by using websites that
                                                                                              provide interoperability testing configuration and results, as well as the ability to perform real-
                                                                                              time testing.

                                                                                              7.3.2      Security of the Implementation
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              Another topic to keep in mind during testing is the security of the IPsec implementation itself.
                                                                                              IPsec was built with careful thought and consideration for security; however, no protocol or
                                                                                              software is completely bulletproof. Security concerns regarding IPsec include the following:

                                                                                                    •    Some IPsec implementations store PSKs in plaintext on the system. This can be accessed
                                                                                                         by legitimate users and anyone else who gains access to the system. The use of such
                                                                                                         implementations should be avoided if unauthorized physical access to the system is a
                                                                                                         concern. However, if it is necessary to use such a product, be sure to apply the
                                                                                                         appropriate system hardening measures and deploy host-based firewalls and intrusion
                                                                                                         detection software.
                                                                                                    •    IPsec allows some traffic to pass unprotected, such as broadcast, multicast, IKE, and
                                                                                                         Kerberos traffic. Attackers could potentially use this knowledge to their advantage to
                                                                                                         send unauthorized malicious traffic through the IPsec filters. Be sure to carefully monitor
                                                                                                         the traffic that is passing through the IPsec tunnel as well as the traffic that is bypassing
                                                                                                         it. For example, network-based intrusion detection system or intrusion prevention system
                                                                                                         devices can typically be configured to alert when non-tunneled traffic appears.
                                                                                                    •    Periodically, vulnerabilities are discovered in IPsec implementations. Organizations such
                                                                                                         as the United States Computer Emergency Readiness Team (US-CERT) notify vendors
                                                                                                         of new vulnerabilities and, at the appropriate time, notify the public of the issues and the
                                                                                                         recommended resolutions, such as installing vendor-supplied patches. Information on
                                                                                                         known vulnerabilities is provided by various online databases, including the National
                                                                                                         Vulnerability Database (NVD) 67 and the Common Vulnerabilities and Exposures (CVE)
                                                                                                         database. 68

                                                                                              7.4       Deploy the Solution

                                                                                              Once testing is complete and any issues have been resolved, the next phase of the IPsec planning
                                                                                              and implementation model involves deploying the solution. A prudent strategy is to gradually
                                                                                              migrate existing network infrastructure, applications, and users to the new IPsec solution. The
                                                                                              phased deployment provides administrators the opportunity to evaluate the impact of the IPsec


                                                                                              67    See https://nvd.nist.gov/.
                                                                                              68    See https://cve.mitre.org/.



                                                                                                                                                  82
