NIST SP 800-166                                                    DERIVED PIV APPLICATION AND
                                                                   DATA MODEL TEST GUIDELINES

                                  with 'FF' (if necessary) to complete the total
                                  length of the value to 8 bytes
 Expected Result(s)    1. From Step 1, the command returns the application property template
                          with the status word '90 00'.
                       2. From Step 2, the command returns an error status word and the
                          PUK’s retry counter remains unchanged.
 Postcondition(s)      Current password is unchanged.

8.3.6.3   Reset Retry Counter with an Incorrect Length and Padding for the New
          Password

 Test Assertion        TA-08.03.06.03
 Purpose               Verifies that the Derived PIV Application does not set a new password
                       with the RESET RETRY COUNTER command when the password
                       length and padding requirements are not met.
 DTR(s)                • DTR-06.02.02.09
                       • DTR-06.03.01.01
                       • DTR-06.03.07.04
 Vendor                None.
 Documentation
 Precondition(s)       •   A token with the Derived PIV Application is inserted into an
                           appropriate token reader.
                       •   Suitable drivers have been loaded between the test system and an
                           instance of the reader.
                       •   The Derived PIV Application Password and the PUK are recorded.
                       •   The Derived PIV Application Password’s retry counter and the
                           PUK’s retry counter are not 0.
 Test Scenario         1. Send the SELECT command with
                             • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                       2. Send the RESET RETRY COUNTER command with
                             • P2, key reference value, is set to '80'
                             • Data field of the command contains the PUK value
                                for key reference '80' concatenated with a new
                                password value that is less than 8 bytes in
                                length and is not padded with 'FF'
                       3. Send the RESET RETRY COUNTER command with
                             • P2, key reference value, is set to '80'
                             • Data field of the command contains the PUK value
                                for key reference '80' concatenated with a new
                                password value that is padded with 'FF' to
                                complete 10 bytes
                       4. Send the RESET RETRY COUNTER command with
                             • P2, key reference value, is set to '80'
                             • Data field of the command contains the PUK value
                                for key reference '80' concatenated with a new
                                password value that is 6 bytes but padded to 8
                                bytes with 'FF' in byte 7 and 'AA' in byte 8
                       5. Send the RESET RETRY COUNTER command with


                                             76
