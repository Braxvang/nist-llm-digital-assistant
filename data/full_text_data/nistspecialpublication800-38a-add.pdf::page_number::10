                        Addendum to NIST Special Publication 800-38A



5.        Let Pn*=Cn-1*    Z* .

6.        Return P1||P2||…||Pn-1||Pn*.

When Cn-1* is a complete block, CBC-CS1-Decrypt is equivalent to CBC decryption.

Diagram:

Figure 2 below illustrates the CBC-CS1-Decrypt algorithm for the case that Cn-1* is a
partial block, i.e., d<b. As in the previous diagram, the bolded rectangles contain the
inputs and outputs.


                                                       Cn-1*       Z**

                   C1                    C2                    Cn-1            Cn


                CIPH-1K              CIPH-1K                CIPH-1K       CIPH-1K
                                                 …
     IV            ⊕                     ⊕                     ⊕          Z*        Z**


                   P1                    P2                    Pn-1      ⊕

                                                                         Pn*

                                  Figure 2: CBC-CS1-Decrypt


3 Specification of CBC-CS2

Algorithm: CBC-CS2-Encrypt

Input:            plaintext P, such that len(P) is valid;
                  initialization vector IV;
                  key K.

Output:           ciphertext C, such that len(C) = len(P).

Steps:


                                                 4
