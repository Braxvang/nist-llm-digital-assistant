Special Publication 800-73-4                                 Interfaces for Personal Identity Verification – Part 2:
                                                             PIV Card Application Card Command Interface

Response Syntax

           SW1        SW2                                       Meaning
           '63'       'CX'     Reset failed, X indicates the number of further allowed resets
           '69'        '83'    Reset operation blocked
           '6A'        '80'    Incorrect parameter in command data field
           '6A'        '81'    Function not supported
           '6A'        '88'    Key reference not found
           '90'        '00'    Successful execution


  3.2.4    GENERAL AUTHENTICATE Card Command

The GENERAL AUTHENTICATE card command performs a cryptographic operation, such as an
authentication protocol, using the data provided in the data field of the command and returns the result of
the cryptographic operation in the response data field. 12

The GENERAL AUTHENTICATE command shall be used with the PIV authentication keys ('9A', '9B',
'9E') to authenticate the card or a card application to the client application (INTERNAL
AUTHENTICATE), to authenticate an entity to the card (EXTERNAL AUTHENTICATE), and to
perform a mutual authentication between the card and an entity external to the card (MUTUAL
AUTHENTICATE).

The GENERAL AUTHENTICATE command shall be used with the digital signature key ('9C') to realize
the signing functionality on the PIV client application programming interface. Data to be signed is
expected to be hashed off card. Appendix A.4 illustrates the use of the GENERAL AUTHENTICATE
command for signature generation.

The GENERAL AUTHENTICATE command shall be used with the key management key ('9D') and the
retired key management keys ('82' – '95') to realize key establishment schemes specified in SP 800-78
(ECDH and RSA). Appendix A.5 illustrates the use of the GENERAL AUTHENTICATE command for
key establishment schemes aided by the PIV Card Application.

The GENERAL AUTHENTICATE command shall be used with the PIV Secure Messaging key ('04')
and cryptographic algorithm identifier '27' or '2E' to establish session keys for secure messaging as
specified in Section 4. If key reference '04' is specified in P2, then algorithm identifiers in P1 other than
'27' and '2E' shall not be permitted and the PIV Card Application shall return the status word '6A 86'.

The GENERAL AUTHENTICATE command supports command chaining to permit the uninterrupted
transmission of long command data fields to the PIV Card Application. If a card command other than the
GENERAL AUTHENTICATE command is received by the PIV Card Application before the termination
of a GENERAL AUTHENTICATE chain, the PIV Card Application shall rollback to the state it was in
immediately prior to the reception of the first command in the interrupted chain. In other words, an
interrupted GENERAL AUTHENTICATE chain has no effect on the PIV Card Application.




12 For cryptographic operations with larger keys, e.g., RSA 2048, the GET RESPONSE command is used to return the complete

result of the cryptographic operation. The GET RESPONSE command is illustrated in Appendix A.4.1 (Command 3).




                                                           17
