NIST SP 800-90A Rev. 1                                             Recommendation for Random Number
                                                                    Generation Using Deterministic RBGs


In addition to testing the generate function before first use (see Section 11.3.1), known-answer
tests should be performed at reasonable intervals, as defined by the implementer.
11.3.4     Testing the Reseed Function

Known-answer testing of the reseed function shall use the security_strength in the internal state
of the (testing) instantiation to be reseeded. A representative value of the entropy_input and
additional_input (if supported) shall be used (see Sections 8.3 and 10). If prediction resistance
for the reseed function is supported, then the use of the prediction_resistance_request parameter
shall be tested.
If the values used during the test produce the expected results, then the reseed function may be
used during normal operation.
An implementation should provide a capability to test the reseed function on demand.

11.3.5     Testing the Uninstantiate Function

Testing of the uninstantiate function is not required during health testing.

11.4 Error Handling

The expected errors are indicated for each DRBG mechanism function (see Sections 9.1 through
9.4) and for the derivation functions in Section 10.3. The error handling routines should indicate
the type of error.

11.4.1     Errors Encountered During Normal Operation

Many errors that occur during normal operation may be caused by a consuming application’s
improper DRBG request or possibly the current unavailability of entropy; these errors are
indicated by “ERROR_FLAG” in the pseudocode. In these cases, the consuming application user
is responsible for correcting the request within the limits of the user’s organizational security
policy. For example, if a failure indicating an invalid requested security strength is returned, a
security strength higher than the DRBG or the DRBG instantiation can support has been
requested. The user may reduce the requested security strength if the organization’s security
policy allows the information to be protected using a lower security strength, or the user shall
use an appropriately instantiated DRBG.
Catastrophic errors (i.e., errors indicated by the CATASTROPHIC_ERROR_FLAG in the
pseudocode) detected during normal operation shall be treated in the same manner as an error
detected during health testing (see Section 11.4.2).

11.4.2     Errors Encountered During Health Testing

Errors detected during health testing shall be perceived as catastrophic DRBG failures.
When a DRBG fails a health test or a catastrophic error is detected during normal operation, the
DRBG shall enter an error state and output an error indicator. The DRBG shall not perform any
instantiate, generate or reseed operations while in the error state, and pseudorandom bits shall
not be output when an error state exists. When in an error state, user intervention (e.g., power


                                                 65
