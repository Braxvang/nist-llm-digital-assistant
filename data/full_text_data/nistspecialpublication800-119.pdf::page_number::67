                                                                GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6




                                                                            31
                                         Figure 4-1. SHIM6 Protocol Stack

    4.1.3   Security Ramifications for Multihoming

RFC 4218 presents an overview of security vulnerabilities inherent in multihoming. In summary, one
must be concerned about denial of service, re-routing packets to unintended destinations or black holes,
and multicast issues. It advises, in general, that connectionless transport protocols like UDP present more
security problems than connection-oriented transport protocols. Also, if identifiers and locators are split,
security should be tied to the identifiers to lessen the impact of attacks on the identifier-locator binding.
Securing other parts of the infrastructure such as the DNS and routing protocols helps minimize the
potential attacks on multihoming. Multihoming solutions also need to account for and work with ingress
filtering so that spoofed addresses can not be used to attack systems. (RFC 2827 and RFC 3704).

Networks need to ensure that they do not announce their prefixes in a way that generates asymmetric
traffic flows. Traffic following asymmetrical paths might get blocked by strict Reverse Path Forwarding
(RPF) checks or stateful packet filters. It may also make it impossible to implement IPsec at site border
routers.

The SHIM6 protocol contains several security measures:

    Hash-based addresses (RFC 5535) allow one to prove address ownership and to prevent redirection
     attacks.

    Reachability probes (RFC 5534) allow one to identify third party flooding attacks.

    Two-way communications are required before the responder creates any state. This means that a
     state-based DOS attack (trying to use up all available memory on the responder) at least reveals an
     IPv6 address that the attacker was using.

    Context establishment messages use nonces to prevent replay attacks and to prevent off-path attackers
     from interfering with the establishment.

    After context establishment, every SHIM6 control message contains the context tag assigned to the
     particular context. This implies that an attacker needs to discover a valid context tag before being
     able to spoof any SHIM6 control message. This also helps protect the SHIM6 protocol from off-path
     attackers.


                                                     4-4
