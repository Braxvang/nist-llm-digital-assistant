A STATISTICAL TEST SUITE FOR RANDOM AND PSEUDORANDOM NUMBER GENERATORS FOR CRYPTOGRAPHIC APPLICATIONS



2.2     Frequency Test within a Block

2.2.1 Test Purpose
The focus of the test is the proportion of ones within M-bit blocks. The purpose of this test is to determine
whether the frequency of ones in an M-bit block is approximately M/2, as would be expected under an
assumption of randomness. For block size M=1, this test degenerates to test 1, the Frequency (Monobit)
test.

2.2.2 Function Call
BlockFrequency(M,n), where:

         M       The length of each block.

         n       The length of the bit string.

Additional input used by the function, but supplied by the testing code:

         ε       The sequence of bits as generated by the RNG or PRNG being tested; this exists as a
                 global structure at the time of the function call; ε = ε1, ε2, … , εn.

2.2.3    Test Statistic and Reference Distribution
         χ 2 (obs):           A measure of how well the observed proportion of ones within a given M-bit
                              block match the expected proportion (1/2).

The reference distribution for the test statistic is a χ2 distribution.

2.2.4    Test Description
                                                  n
(1)      Partition the input sequence into N =       non-overlapping blocks. Discard any unused bits.
                                                  M 

         For example, if n = 10, M = 3 and ε = 0110011010, 3 blocks (N = 3) would be created,
         consisting of 011, 001 and 101. The final 0 would be discarded.

                                                                                                M
                                                                                                ∑ ε ( i−1 )M + j
                                                                                                j=1
(2)      Determine the proportion πi of ones in each M-bit block using the equation π i =                          ,
                                                                                                      M
         for 1 ≤ i ≤ N.

         For the example in this section, π1 = 2/3, π2 = 1/3, and π3 = 2/3.

                                                     N
                          2
(3)      Compute the χ statistic: χ2(obs) = 4 M     ∑ ( π - ½) .
                                                              i
                                                                  2

                                                     i =1


                                                                        2           2           2
                                                             
                                                                  (       ) (       ) (          )
         For the example in this section, χ2(obs) = 4 x 3 x  2 3 − 1 2 + 1 3 − 1 2 + 2 3 − 1 2  = 1 .
                                                                                                  




                                                            2-4
