NIST SP 800-186                                                  Discrete Logarithm-based Cryptography:
February 2023                                                          Elliptic Curve Domain Parameters

      2.2 Compute a square root y of w in GF(p) using the procedure of Appendix E.3. Output
          INVALID if that procedure outputs INVALID.
      2.3 If y = 0 and t = 1, output INVALID.
      2.4 If t ≠ y mod 2, set y = p−y.
      2.5 Output P = (x, y).
   3. Output INVALID.

D.2.2. Binary Curves in Short-Weierstrass Form
Point compression for binary curves in short-Weierstrass form is defined as follows:
Inputs:
   1. Weierstrass curve Ba,b defined over the binary field GF(2m)
   2. Point P on Ba,b

Output: Compressed point P

Process:

   1. If P is the point at infinity ∅, set P = P.
   2. If P = (x, y) and x=0, set P = (x, y), where y = 0.
   3. If P = (x, y) and x ≠ 0:
      3.1 Compute 𝑎𝑎 = y/x, where 𝑎𝑎 = 𝑎𝑎0 + 𝑎𝑎1 𝑧𝑧 + ⋯ + 𝑎𝑎𝑚𝑚−1 𝑧𝑧 𝑚𝑚−1 .
      3.2 Set P = (x, y), where y = 𝑎𝑎0 .
   4. Output P.

Consequently, for each affine point P = (x, y) on the Weierstrass curve Ba,b, the compressed
point P is an ordered pair (x, t), where x is an element of GF(2m), and t is an element of GF(2).
Point decompression of an object P with respect to this Weierstrass curve is defined as follows:
Inputs:

   1. Object P
   2. Weierstrass curve Ba,b defined over the binary field GF(2m), where m is an odd integer

Output: Point P on Ba,b or INVALID

Process:

   1. If P is the point at infinity ∅, output P = P.
   2. If P is the ordered pair (x, t), where x is an element of GF(2m) and t is an element of
      GF(2), perform the following:
      2.1 If x = 0, perform the following steps:
          2.1.1 If t = 1, output INVALID.
          2.1.2 Set y to the square root of b in GF(2m) using the algorithm of Appendix E.1.
      2.2 If x ≠ 0, perform the following steps:
          2.2.1 Compute w = (x3 + a x2 + b)/x2 = x + a + b/x2.


                                                 46
