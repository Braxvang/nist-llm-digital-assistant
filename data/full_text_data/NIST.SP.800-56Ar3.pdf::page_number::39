                                                                                               NIST SP 800-56A Rev. 3                                  Recommendation for Pair-Wise Key Establishment
                                                                                                                                                               Using Discrete Logarithm Cryptography

                                                                                               The following process or its equivalent may be used to generate an FFC key pair.
                                                                                                      Input:
                                                                                                         1. (p, q, g)     The FFC domain parameters used by this process. p, q and g shall
                                                                                                                          either be provided as integers during input, or shall be converted to
                                                                                                                          integers prior to use.
                                                                                                          2. N            The (maximum) bit length of the private key to be generated.
                                                                                                          3. s            The maximum security strength to be supported by the key pair.
                                                                                                      Output:
                                                                                                        1. status         The status returned from the key-pair generation process. The status
                                                                                                                          will indicate SUCCESS or an ERROR.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                                          2.   (x, y)     The generated private and public keys. If an error is encountered
                                                                                                                          during the generation process, invalid values for x and y should be
                                                                                                                          returned, as represented by Invalid_x and Invalid_y in the following
                                                                                                                          specification; for example, both Invalid_x and Invalid_y could be 0.
                                                                                                                          Otherwise, x and y are returned as integers. The generated private key
                                                                                                                          x is in the interval [1, min(2N − 1, q − 1)], and the public key y is in the
                                                                                                                          interval [2, p – 2].
                                                                                                      Process:
                                                                                                          1. If s is not the maximum security strength that can be supported by (p, q, g), then
                                                                                                             return an ERROR indication as the status and (Invalid_x, Invalid_y) as the key
                                                                                                             pair; then exit the process without performing the remaining steps.
                                                                                                          2. If ((N < 2s) or (N > len(q)), then return an ERROR indication as the status and
                                                                                                             (Invalid_x, Invalid_y) as the key pair; then exit the process without performing
                                                                                                             the remaining steps.
                                                                                                          3. Obtain a string of N + 64 returned_bits using an RBG with a security strength of
                                                                                                             s bits or more (see Section 5 in SP 800-13321). If an ERROR indication is
                                                                                                             returned, then return an ERROR indication as the status and (Invalid_x,
                                                                                                             Invalid_y) as the key pair; then exit the process without performing the remaining
                                                                                                             steps.
                                                                                                          4. Convert returned_bits to the (non-negative) integer c in the interval
                                                                                                             [0, 2(N + 64) – 1] (see Appendix C.4).
                                                                                                          5. Set M = min(2N, q), the minimum of 2N and q.
                                                                                                          6. Set x = (c mod (M – 1)) + 1.
                                                                                                          7. Set y = gx mod p.
                                                                                                          8. Return SUCCESS as the status and (x, y) as the key pair.
                                                                                                      Output: SUCCESS and (x, y), or


                                                                                               21
                                                                                                    SP 800-133, Recommendation for Cryptographic Key Generation.

                                                                                                                                                  28
