NIST SP 800-166                                                   DERIVED PIV APPLICATION AND
                                                                  DATA MODEL TEST GUIDELINES

 Expected Result(s)       1. From Step 1, the command returns the application property
                             template with the status word '90 00'.
                          2. From Step 2, the command returns one of the following:
                              • An X.509 Certificate for Key Management followed by
                                  status word '90 00';
                              • A zero-length data object followed by status word '90 00' –
                                  which indicates that a container for the X.509 certificate
                                  exists, but it has not been personalized; or
                              • Status word '6A 82' (data object not found) – which
                                  indicates the container for the X.509 certificate does not
                                  exist
                          3. From Step 3, all mandatory tags for the X.509 Certificate for
                             Key Management are present in the order indicated in Table 16
                             of [SP800-73], Part 1.

9.1.4 Discovery Object

9.1.4.1 BER-TLV of Discovery Object and Presence of Security Object

 Test Assertion           TA-09.01.04.01
 Purpose                  Verifies that the Discovery Object (if present) conforms to the
                          Derived PIV data model requirements.
 DTR(s)                   • DTR-07.01.01.01
                          • DTR-07.01.05.01
                          • DTR-07.01.05.02
                          • DTR-07.01.08.02
 Issuer Documentation     None.

 Precondition(s)          •   A token with the Derived PIV Application is inserted into an
                              appropriate token reader.
                          •   Suitable drivers have been loaded between the test system and
                              an instance of the reader.
 Test Scenario            1. Send the SELECT token command with
                                • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                          2. Send the GET DATA command with
                                • Data field of the command containing the tag
                                   ('7E') of the Discovery Object.
                          3. If the Discovery Object was retrieved in Step 2,
                             read and parse the byte array in accordance with
                             BER-TLV format.
                          4. If the Discovery Object was retrieved in Step 2,
                             verify that the Security Object is present within
                             the Derived PIV Application by sending a GET DATA
                             command to read the data object.
 Expected Result(s)       1. From Step 1, the command returns the application property
                             template with the status word '90 00'.
                          2. From Step 2, the command returns one of the following:


                                           91
