                                                                                              NIST SP 800-77 REV. 1                                                           GUIDE TO IPSEC VPNS


                                                                                              existing IPsec client software and IPsec gateway eliminates the need to purchase additional
                                                                                              hardware or software and greatly reduces design and implementation time.

                                                                                              Reusing the remote access VPN architecture to provide additional protection to the local WiFi
                                                                                              network requires less reliance on the WiFi hardware manufacturers and security protocols. The
                                                                                              WEP and WPA2 link layer security protocols have been cryptographically broken on a few
                                                                                              occasions, requiring protocol updates that are not always possible on older hardware models.
                                                                                              Using an IPsec solution provides confidence that the WiFi network cannot be abused or broken
                                                                                              into to gain access to the corporate network since the WiFi network is as untrusted as any other
                                                                                              host on the internet. Visitors to the office can be given guest internet access to the WiFi network
                                                                                              using the link layer credentials without endangering the corporate network because access to the
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              corporate network is not possible from the office WiFi network without using the IPsec remote
                                                                                              access VPN.

                                                                                              9.3     Remote Access to a Cloud Server Instance

                                                                                              An agency has outsourced some of its public-facing web pages to a cloud provider. A number of
                                                                                              virtual machines are used to provide the service from the cloud. This private cloud uses private
                                                                                              IP addresses. The agency has one public IP address that terminates at the cloud provider. The
                                                                                              cloud provider allows the agency to forward specific protocols and ports to one of its virtual
                                                                                              machines. The agency forwards TCP port 80 and TCP port 443 to one of the virtual machines
                                                                                              running the HAProxy software configured as a service that load balances these connections to a
                                                                                              number of virtual machine web servers. These web servers connect to another set of virtual
                                                                                              machines running a database server. During peak seasons for this agency, the number of database
                                                                                              and web servers can be increased to match demand. To update the database content on these
                                                                                              virtual machines from the agency internal network, a VPN connection is desired. This would
                                                                                              allow the database servers to be replicated from the agency’s network to the private cloud.

                                                                                              The virtual cloud is using the IPv4 private space IP network 10.0.2.0/24. The cloud provider runs
                                                                                              a virtual router on the IP address 10.0.2.254. Traffic for the cloud uses one of the cloud
                                                                                              provider’s public IP addresses, 192.1.2.78. This is the IP address for the agency’s cloud
                                                                                              webserver at cloud.example.gov. Web traffic using ports 80 and 443 to the IP address 192.1.2.78
                                                                                              uses NAT and is sent to the internal IP 10.0.2.2 running the HAProxy service. The agency itself
                                                                                              uses the private space IP network 192.168.0.0/16 but only wants select parts of its network to
                                                                                              have direct access to the private cloud, specifically 192.168.103.0/24 and 2001:db8:0:2::/64.
                                                                                              While the agency could get public IPv6 addresses for its virtual private cloud, it decides it would
                                                                                              be safer to use private space IPv6 addresses as well, similar to how it uses private space IPv6 at
                                                                                              the agency network for its database servers and workstation machines. The IPv6 private cloud
                                                                                              will use 2001:db8:0:1::/64.

                                                                                              9.3.1    Identifying Needs and Evaluating Options

                                                                                              As there is no dedicated link between the agency and the cloud provider, link-based VPNs
                                                                                              cannot be used. The agency also wants to keep the ability to move to another cloud provider, so
                                                                                              it does not want to use the cloud provider’s VPN solution. An additional advantage of using a
                                                                                              virtual VPN server inside the private cloud is that all traffic inside the cloud provider’s network



                                                                                                                                              111
