                                                                                               NIST SP 800-56A Rev. 3                              Recommendation for Pair-Wise Key Establishment
                                                                                                                                                           Using Discrete Logarithm Cryptography


                                                                                                                                   Party U                               Party V
                                                                                                                        3. Compute Z = Ze || Zs           3. Compute Z = Ze || Zs

                                                                                                                        1. Compute                        1. Compute
                                                                                                Derive secret              DerivedKeyingMaterial             DerivedKeyingMaterial
                                                                                                keying material
                                                                                                                        2. Destroy Z                      2. Destroy Z

                                                                                               6.2.1.3 MQV1, C(1e, 2s, FFC MQV) Scheme
                                                                                               This section describes the MQV1 scheme. Assurance of secure key establishment using this
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                               scheme can only be obtained when the assumptions in Section 6.2.1 are true. In particular, it
                                                                                               is assumed that party U has obtained the static public key yV of party V, and party V has
                                                                                               obtained the static public key yU of party U.
                                                                                               In this scheme, each party has different actions, which are presented separately below.
                                                                                               However, note that parties U and V must use identical orderings of the bit strings that are
                                                                                               input to the key-derivation method.
                                                                                               Party U shall execute the following actions in order to a) establish a shared secret value Z
                                                                                               with party V, and b) derive secret keying material from Z.
                                                                                               Actions: Party U generates a shared secret and derives secret keying material as follows:
                                                                                                  1. Generate an ephemeral key pair (rU, tU) from the domain parameters D as specified in
                                                                                                     Section 5.6.1.1. Send the public key tU to V.
                                                                                                  2. Use the MQV1 form of the FFC MQV primitive in Section 5.7.2.1.2 to derive a
                                                                                                     shared secret Z from the set of domain parameters D, party U’s static private key xU,
                                                                                                     party V’s static public key yV, party U’s ephemeral private key rU, party U’s
                                                                                                     ephemeral public key tU, and (for a second time) party V’s static public key yV. If the
                                                                                                     call to the FFC MQV primitive outputs an error indicator, destroy the ephemeral
                                                                                                     private key rU, and destroy the results of all intermediate calculations used in the
                                                                                                     attempted computation of Z; then output an error indicator, and exit this process
                                                                                                     without performing the remaining actions.
                                                                                                  3. Use the agreed-upon key-derivation method to derive secret keying material with the
                                                                                                     specified length from the shared secret value Z and other input (see Section 5.8). If
                                                                                                     the key-derivation method outputs an error indicator, destroy all copies of Z and the
                                                                                                     ephemeral private key rU; then output an error indicator, and exit this process without
                                                                                                     performing the remaining actions.
                                                                                                  4. Destroy rU and all copies of the shared secret Z.
                                                                                                  5. Output the derived keying material.
                                                                                               Output: The derived keying material or an error indicator.

                                                                                               Party V shall execute the following actions to a) establish a shared secret value Z with party
                                                                                               U, and b) derive secret keying material from Z.

                                                                                                                                              88
