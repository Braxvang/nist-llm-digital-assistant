                                                                                              NIST SP 800-77 REV. 1                                                         GUIDE TO IPSEC VPNS


                                                                                              3.2.2.2 Configuration Payloads

                                                                                              Optionally, during IKE_AUTH, the hosts can also exchange Configuration Payloads (CPs). The
                                                                                              initiator can request a number of configuration options, and the responder can respond with
                                                                                              appropriate values. The main CPs are:
                                                                                                 •    Internal IPv4 and IPv6 address and netmask
                                                                                                 •    Internal IPv4 and IPv6 DNS server to use as generic DNS resolver
                                                                                                 •    Internal IPv4 or IPv6 subnet
                                                                                                 •    Internal IPv4 or IPv6 Dynamic Host Configuration Protocol (DHCP) relay address
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                                 •    Internal DNS domains for domains that must be resolved via the VPN
                                                                                                 •    Internal DNSSEC trust anchors to use for internal DNSSEC-signed domains
                                                                                                 •    Application version

                                                                                              All these CPs enable the remote access VPN client to find and use resources on the remote
                                                                                              network. By obtaining an IP address on that remote network, other hosts on that network can
                                                                                              potentially reach the remote VPN clients as if they were present locally. CPs are not used and are
                                                                                              ignored on gateway-to-gateway and host-to-host IPsec deployments.

                                                                                              CPs are the successor to the IKEv1 non-standard Extended Authentication (XAUTH) and Mode
                                                                                              Configuration (ModeCFG) payloads.

                                                                                              3.2.3   The CREATE_CHILD_SA Exchange

                                                                                              The CREATE_CHILD_SA exchange is used for three separate tasks:
                                                                                                 •    Create an additional IPsec SA
                                                                                                 •    Rekey an IPsec SA, which replaces the IPsec SA with a new SA that has the same traffic
                                                                                                      selectors but new encryption keys
                                                                                                 •    Rekey the IKE SA, which replaces the IKE SA encryption keys with new encryption
                                                                                                      keys

                                                                                              Creating an additional IPsec SA uses similar IPsec payloads as those used to create the initial
                                                                                              IPsec SA in the IKE_AUTH exchange. Either endpoint can initiate a CREATE_CHILD_SA
                                                                                              exchange. Lifetimes for IKE and IPsec SAs are not negotiated. Each peer is responsible for
                                                                                              rekeying the relevant SAs before the lifetime of their local policy is exceeded.

                                                                                              Rekeying is the process of creating fresh cryptographic keys for an IKE SA or IPsec SA. IKE and
                                                                                              IPsec keys are ephemeral and only stored in volatile memory for the duration of the lifetime of
                                                                                              the SA. Once an SA is rekeyed, the old cryptographic keys are wiped from memory. In the event
                                                                                              that one of the IPsec hosts is compromised, only the current session keys are still in memory, and
                                                                                              previously recorded encrypted SA traffic cannot be decrypted. IKE SA and IPsec SA session
                                                                                              keys typically have a lifetime of one to eight hours. A rekey request can be for one of the IPsec



                                                                                                                                              25
