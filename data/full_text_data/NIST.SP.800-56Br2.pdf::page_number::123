                                                                                               NIST SP 800-56B REV. 2                             RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                       USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                                  1. The modulus n is the product of two prime factors p and q, with p > q.
                                                                                                  2. Both p and q are less than 2(nBits/2), where nBits ≥ 2048 is the bit length of n.
                                                                                                  3. The public exponent e is an odd integer between 216 and 2256.
                                                                                                  4. The private exponent d is a positive integer that is less than λ(n) = LCM(p – 1, q – 1).
                                                                                                  5. The exponents e and d satisfy de ≡ 1 (mod λ(n)).

                                                                                               Note: For more general applications of the process below, assumptions 2 and 3 above can be
                                                                                                     replaced by the more general assumption that the public exponent e is an odd integer
                                                                                                     satisfying 1 < e2 ≤ n /(p + q – 1). (See the discussion following Lemma 3 below.) That
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                                     condition will be satisfied, e.g., if e2 is greater than one, but no greater than one-half of the
                                                                                                     smallest prime factor of n, as is the case for any RSA key pair generated in conformance
                                                                                                     with this Recommendation.

                                                                                               Process:
                                                                                                  1. Let a = (de – 1) × GCD(n – 1, de – 1).
                                                                                                  2. Let m = a /n and r = a – m n, so that
                                                                                                          a = m n + r and 0 ≤ r < n.
                                                                                                  3. Let b = ( (n – r)/(m + 1) ) + 1; if b is not an integer or b2 ≤ 4n, then output an error indicator,
                                                                                                     and exit without further processing. (See Note 1 below.)
                                                                                                   4. Let ϒ be the positive square root of b2 – 4n; if ϒ is not an integer, then output an error
                                                                                                      indicator, and exit without further processing. (See Note 2 below.)
                                                                                                   5. Let p = (b + ϒ)/2 and let q = (b – ϒ)/2.
                                                                                                   6. Output (p, q) as the prime factors. (See Note 3 below.)

                                                                                               Notes:
                                                                                               1. b should be equal to p + q. If b is not an integer satisfying b2 > 4n, then one or more of the
                                                                                                  assumptions concerning n, e, d, p and q are incorrect and the corresponding RSA key pair does
                                                                                                  not conform to the requirements of this Recommendation.
                                                                                               2. ϒ should be equal to p – q. If ϒ is not an integer, then one or more of the assumptions
                                                                                                  concerning n, e, d, p and q are incorrect and the corresponding RSA key pair does not conform
                                                                                                  to the requirements of this Recommendation.
                                                                                               3. The labeling of the recovered prime factors (i.e., labeling the larger as p and the smaller as q)
                                                                                                  may be the reverse of the labeling that was used when those factors were originally generated.
                                                                                               4. All local copies of d, p, q, and and any other local/intermediate values used during the
                                                                                                  execution of the RecoverPrimeFactors function shall be destroyed prior to the early


                                                                                                                                                 113
