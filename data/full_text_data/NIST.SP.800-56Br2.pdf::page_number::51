                                                                                               NIST SP 800-56B REV. 2                                       RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                                 USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                               Note that key-pair validation, as specified in Section 6.4.1.2.2, can be performed after step 5 and
                                                                                               before step 6. If an error is detected during the validation process, output an indication of a key-
                                                                                               pair validation failure, and exit without further processing.
                                                                                               A routine that implements this generation function shall destroy any local copies of p, q, and d, as
                                                                                               well as any other locally stored values used or produced during the execution of the routine. The
                                                                                               destruction of these locally stored values shall occur prior to or during any exit from the routine
                                                                                               (whether exiting early, because of an error, or exiting normally, with the output of an RSA key
                                                                                               pair). Note that the requirement for destruction includes any locally stored portions of the output
                                                                                               key pair.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                               6.3.1.3 rsakpg1-crt
                                                                                               rsakpg1-crt is the generator in the RSAKPG1 family such that the private key is in the Chinese
                                                                                               Remainder Theorem format (n, e, d, p, q, dP, dQ, qInv).
                                                                                               Function call: rsakpg1-crt(s, nBits, e)
                                                                                               The inputs, outputs and errors are the same as in rsakpg1-basic (see Section 6.3.1.1) except that
                                                                                               the private key is in the Chinese Remainder Theorem format: (n, e, d, p, q, dP, dQ, qInv).
                                                                                               The steps are the same as in rsakpg1-basic except that processing steps 5 and 6 are replaced by the
                                                                                               following:
                                                                                                      5. Determine the components dP, dQ and qInv:
                                                                                                               a. dP = d mod (p – 1).
                                                                                                               b. dQ = d mod (q – 1).
                                                                                                               c. qInv = q–1 mod p.
                                                                                                      6. Perform a pair-wise consistency test 19 by verifying that m = (me)d mod n for some integer
                                                                                                         m satisfying 1 < m < (n − 1). If an inconsistency is found, output an indication of a pair-
                                                                                                         wise consistency failure, and exit without further processing.
                                                                                                      7. Output (n, e) as the public key, and (n, e, d, p, q, dP, dQ, qInv) as the private key.
                                                                                               Note that key-pair validation, as specified in Section 6.4.1.2.3, can be performed after step 6 and
                                                                                               before step 7. If an error is detected during the validation process, output an indication of a key-
                                                                                               pair validation failure, and exit without further processing.
                                                                                               A routine that implements this generation function shall destroy any local copies of p, q, dP, dQ,
                                                                                               qInv, and d, as well as any other locally stored values used or produced during the execution of the
                                                                                               routine. The destruction of these locally stored values shall occur prior to or during any exit from
                                                                                               the routine (whether exiting early because of an error or exiting normally with the output of an
                                                                                               RSA key pair). Note that the requirement for destruction includes any locally stored portions of
                                                                                               the output key pair.



                                                                                               19
                                                                                                    Although the previous steps should have theoretically produced a valid key pair, this step is required to ensure that
                                                                                                    implementation errors do not result in an invalid key pair.
                                                                                                                                                           41
