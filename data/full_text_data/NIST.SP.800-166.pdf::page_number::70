NIST SP 800-166                                                                 DERIVED PIV APPLICATION AND
                                                                                DATA MODEL TEST GUIDELINES

                                •    Suitable drivers have been loaded between the test system and
                                     an instance of the reader.
                                •    The Derived PIV Application Password is recorded. The
                                     password shall be 6 bytes in length.
                                •    The Derived PIV Application Password’s retry counter is greater
                                     than 1. 13
 Test Scenario                  1. Send the SELECT command with
                                      • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                                2. Send the VERIFY command with
                                      • P2, key reference value, is set to '80'
                                      • Data field of the command will contain the
                                         correct Derived PIV Application Password, NOT
                                         padded with 'FF', so that the total length of
                                         the value is less than 8 bytes
                                3. Send the VERIFY command with
                                      • P2, key reference value, is set to '80'
                                      • Data field of the command will contain the
                                         correct Derived PIV Application Password,
                                         padded with 'FF' to complete the total length
                                         of the value to 10 bytes
                                4. Send the VERIFY command with
                                      • P2, key reference value, is set to '80'
                                      • Data field of the command will contain the
                                         correct Derived PIV Application Password,
                                         padded to 8 bytes with 'FF' in byte 7 and 'AA'
                                         in byte 8
                                5. Send the VERIFY command with
                                      • P2, key reference value, is set to '80'
                                      • Data field of the command will contain an
                                         arbitrary Derived PIV Application Password
                                         which is only 5 bytes in length padded with
                                         'FF' to complete the total length of the value
                                         to 8 bytes
 Expected Result(s)             1. From Step 1, the command returns the application property
                                   template with the status word '90 00'.
                                2. From Step 2, the command returns status word '6A 80' (incorrect
                                   parameter in command data field) or '63 CX' (verification failed,
                                   with X indicating the number of further allowed retries) (verify
                                   the error code supplied matches what is described in vendor
                                   documentation).
                                3. From Step 3, the command returns status word '6A 80' (incorrect
                                   parameter command data field) or '63 CX' (verification failed,
                                   with X indicating the number of further allowed retries (verify
                                   the error code supplied matches what is described in vendor
                                   documentation).
                                4. From Step 4, the command returns status word '6A 80' (incorrect
                                   parameter in command data field) or '63 CX' (verification failed,

13
  It may be necessary to perform a successful VERIFY command while performing the test scenario in order to
keep the Derived PIV Application Password’s retry counter from dropping to 0.


                                                      63
