NIST SP 800-166                                                     DERIVED PIV APPLICATION AND
                                                                    DATA MODEL TEST GUIDELINES

 Precondition(s)          •   A token with the Derived PIV Application is inserted into an
                              appropriate token reader.
                          •   Suitable drivers have been loaded between the test system and
                              an instance of the reader.
                          •   A Security Object is present within the Derived PIV
                              Application.
 Test Scenario            1. Send the SELECT command with
                                • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                          2. Send the GET DATA command with
                                • Data field of the command containing the tag
                                   ('5FC106') of the Security Object
                          3. Extract and parse the certificates field contents
                             from the Security Object.
 Expected Result(s)       1. From Step 1, the command returns the application property
                             template with the status word '90 00'.
                          2. From Step 2, the command returns status word '90 00' along
                             with the Security Object.
                          3. From Step 3, the certificates field contains an X.509 certificate
                             which is the Derived PIV Credential Issuer’s (content signing)
                             certificate.

9.2.1.7 SignerInfo digestAlgorithm

 Test Assertion           TA-09.02.01.07
 Purpose                  Verifies that the digestAlgorithm field of the SignerInfo field is in
                          accordance with Table 3-2 of [SP800-78].
 DTR(s)                   • DTR-07.02.01.09
 Issuer Documentation     None.
 Precondition(s)          • A token with the Derived PIV Application is inserted into an
                             appropriate token reader.
                          • Suitable drivers have been loaded between the test system and
                             an instance of the reader.
                          • A Security Object is present within the Derived PIV
                             Application.
 Test Scenario            1. Send the SELECT command with
                                • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                          2. Send the GET DATA command with
                                • Data field of the command containing the tag
                                   ('5FC106') of the Security Object
                          3. Extract the SignerInfo->digestAlgorithm field from
                             the Security Object.
                          4. Extract the certificates field contents from the
                             Security Object.
                          5. From the certificate obtained, extract the
                             subjectPublicKeyInfo->subjectPublicKey.
                          6. Compute the type and size of the signer’s public
                             key.




                                            99
