NIST SP 800-85A-4                                           PIV CARD APPLICATION & MIDDLEWARE
                                                                     INTERFACE TEST GUIDELINES

 Precondition(s)         1. There exists a valid physical and exclusive connection between
                            an instance of the PIV Card and the client application.
                         2. The client application currently has a connection accessible
                            through cardHandle.
 Test Steps              1. Call pivDisconnect with arguments
                            • (IN) cardHandle
 Expected Result(s)      Call returns with status_word of PIV_OK.
 Postcondition(s)        The client application is no longer connected to the PIV Card
                         Application.


B.2.1.2          Disconnect a Shared Connection
 Purpose                Ensure that the PIV Middleware closes an open and shared PIV Card
                        Application connection without impacting other client application’s
                        connections to that same PIV Card Application.
 Target                  pivDisconnect
 Reference(s)            1. SP 800-73-4 Part 3, Section 3.1.3
                         2. AS04.03
 Precondition(s)         1. There exists a valid physical shared connection between an
                            instance of the PIV Card and the client application.
                         2. At least two distinct client applications (having two distinct
                            cardHandle references) are also connected to the PIV Card
                            Application.
 Test Steps              1. Call pivDisconnect with arguments
                            • (IN) cardHandle
 Expected Result(s)      Call returns with status_word of PIV_OK.
 Postcondition(s)        1. The client application is no longer connected to the PIV Card
                            Application.
                         2. All other client applications maintain their previously valid
                            connections.


B.2.2           Test Assertions for Error Cases

B.2.2.1          Attempt Disconnect with Invalid Card Handle
 Purpose               Ensure that the PIV Middleware detects an invalid cardHandle
                       argument.
 Target                  pivDisconnect
 Reference(s)            1. SP 800-73-4 Part 3, Section 3.1.3
                         2. AS04.03
 Precondition(s)         1. There exists a valid physical connection between an instance of
                            the PIV Card and the client application.
                         2. A client application currently has a connection accessible through
                            cardHandle.



                                          B-5
