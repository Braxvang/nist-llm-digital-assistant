                                                                                             NIST SP 800-90B                                                                    RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                                        USED FOR RANDOM BIT GENERATION

                                                                                                  Table 1 The narrowest internal width and output lengths of the vetted conditioning
                                                                                                                                     functions.

                                                                                                  Conditioning Function                       Narrowest Internal Width                               Output Length
                                                                                                                                                        (nw)                                             (nout)
                                                                                                  HMAC                                    hash-function output size                           hash-function output size
                                                                                                  CMAC                                    AES block size = 128                                AES block size = 128
                                                                                                  CBC-MAC                                 AES block size = 128                                AES block size = 128
                                                                                                  Hash Function                           hash-function output size                           hash-function output size
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                                  Hash_df                                 hash-function output size                           hash-function output size
                                                                                                  Block_Cipher_df                         AES key size                                        AES key size


                                                                                             For Hash_df and Block_cipher_df, the output length indicated in the table is used as the
                                                                                             no_of_bits_to_return input parameter for the invocation of Hash_df and Block_Cipher_df (see SP
                                                                                             800-90A).


                                                                                             3.1.5.1.2 Entropy Assessment using Vetted Conditioning Components

                                                                                             When using a conditioning component listed in Section 3.1.5.1.1 (given the assurance of correct
                                                                                             implementation by CAVP testing), the entropy of the output is estimated as

                                                                                                                                  ℎ𝑜𝑜𝑜𝑜𝑜𝑜 = Output_Entropy(𝑛𝑛𝑖𝑖𝑖𝑖 , 𝑛𝑛𝑜𝑜𝑜𝑜𝑜𝑜 , 𝑛𝑛𝑛𝑛, ℎ𝑖𝑖𝑖𝑖 )

                                                                                             where Output_Entropy(𝑛𝑛𝑖𝑖𝑖𝑖 , 𝑛𝑛𝑜𝑜𝑜𝑜𝑜𝑜 , 𝑛𝑛𝑛𝑛, ℎ𝑖𝑖𝑖𝑖 ) is described as follows 4:
                                                                                                                                                                (1−𝑃𝑃       )
                                                                                                      1.         Let 𝑃𝑃ℎ𝑖𝑖𝑖𝑖ℎ = 2−ℎ𝑖𝑖𝑖𝑖 and 𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙 = 𝑛𝑛𝑖𝑖𝑖𝑖ℎ𝑖𝑖𝑖𝑖ℎ .
                                                                                                                                                          2   −1
                                                                                                      2.         𝑛𝑛 = min( 𝑛𝑛𝑜𝑜𝑜𝑜𝑜𝑜 , 𝑛𝑛𝑛𝑛).
                                                                                                      3.         𝜓𝜓 = 2𝑛𝑛𝑖𝑖𝑖𝑖 −𝑛𝑛 𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙 + 𝑃𝑃ℎ𝑖𝑖𝑖𝑖ℎ
                                                                                                      4.         U = 2𝑛𝑛𝑖𝑖𝑖𝑖 −𝑛𝑛 + �2 𝑛𝑛(2𝑛𝑛𝑖𝑖𝑖𝑖 −𝑛𝑛 ) ln(2)
                                                                                                      5.         𝜔𝜔 = 𝑈𝑈 ×𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙
                                                                                                      6.         Return − log 2 (max(𝜓𝜓, 𝜔𝜔))


                                                                                             The entropy source will be assessed at the min-entropy per conditioned output, hout, computed
                                                                                             above. Vetted conditioning components are permitted to claim full entropy outputs.




                                                                                             4 The formula used to generate Output_Entropy() is adapted from the formula 𝑘𝑘                 𝑚𝑚        𝑚𝑚
                                                                                                                                                                                       𝛼𝛼 = 𝑛𝑛 + 𝛼𝛼�2 𝑛𝑛 ln 𝑛𝑛 provided in Theorem 1 of

                                                                                                 [RaSt98], such that m is equal to 2𝑛𝑛𝑖𝑖𝑖𝑖 , n is equal to 2𝑛𝑛 and 𝛼𝛼 is equal to 1.


                                                                                                                                                                  16
