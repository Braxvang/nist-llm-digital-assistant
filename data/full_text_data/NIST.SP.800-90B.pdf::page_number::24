                                                                                             NIST SP 800-90B                                                                    RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                                        USED FOR RANDOM BIT GENERATION

                                                                                                  Table 1 The narrowest internal width and output lengths of the vetted conditioning
                                                                                                                                     functions.

                                                                                                  Conditioning Function                       Narrowest Internal Width                               Output Length
                                                                                                                                                        (nw)                                             (nout)
                                                                                                  HMAC                                    hash-function output size                           hash-function output size
                                                                                                  CMAC                                    AES block size = 128                                AES block size = 128
                                                                                                  CBC-MAC                                 AES block size = 128                                AES block size = 128
                                                                                                  Hash Function                           hash-function output size                           hash-function output size
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                                  Hash_df                                 hash-function output size                           hash-function output size
                                                                                                  Block_Cipher_df                         AES key size                                        AES key size


                                                                                             For Hash_df and Block_cipher_df, the output length indicated in the table is used as the
                                                                                             no_of_bits_to_return input parameter for the invocation of Hash_df and Block_Cipher_df (see SP
                                                                                             800-90A).


                                                                                             3.1.5.1.2 Entropy Assessment using Vetted Conditioning Components

                                                                                             When using a conditioning component listed in Section 3.1.5.1.1 (given the assurance of correct
                                                                                             implementation by CAVP testing), the entropy of the output is estimated as

                                                                                                                                  â„ğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œ = Output_Entropy(ğ‘›ğ‘›ğ‘–ğ‘–ğ‘–ğ‘– , ğ‘›ğ‘›ğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œ , ğ‘›ğ‘›ğ‘›ğ‘›, â„ğ‘–ğ‘–ğ‘–ğ‘– )

                                                                                             where Output_Entropy(ğ‘›ğ‘›ğ‘–ğ‘–ğ‘–ğ‘– , ğ‘›ğ‘›ğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œ , ğ‘›ğ‘›ğ‘›ğ‘›, â„ğ‘–ğ‘–ğ‘–ğ‘– ) is described as follows 4:
                                                                                                                                                                (1âˆ’ğ‘ƒğ‘ƒ       )
                                                                                                      1.         Let ğ‘ƒğ‘ƒâ„ğ‘–ğ‘–ğ‘–ğ‘–â„ = 2âˆ’â„ğ‘–ğ‘–ğ‘–ğ‘– and ğ‘ƒğ‘ƒğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ = ğ‘›ğ‘›ğ‘–ğ‘–ğ‘–ğ‘–â„ğ‘–ğ‘–ğ‘–ğ‘–â„ .
                                                                                                                                                          2   âˆ’1
                                                                                                      2.         ğ‘›ğ‘› = min( ğ‘›ğ‘›ğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œ , ğ‘›ğ‘›ğ‘›ğ‘›).
                                                                                                      3.         ğœ“ğœ“ = 2ğ‘›ğ‘›ğ‘–ğ‘–ğ‘–ğ‘– âˆ’ğ‘›ğ‘› ğ‘ƒğ‘ƒğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ + ğ‘ƒğ‘ƒâ„ğ‘–ğ‘–ğ‘–ğ‘–â„
                                                                                                      4.         U = 2ğ‘›ğ‘›ğ‘–ğ‘–ğ‘–ğ‘– âˆ’ğ‘›ğ‘› + ï¿½2 ğ‘›ğ‘›(2ğ‘›ğ‘›ğ‘–ğ‘–ğ‘–ğ‘– âˆ’ğ‘›ğ‘› ) ln(2)
                                                                                                      5.         ğœ”ğœ” = ğ‘ˆğ‘ˆ Ã—ğ‘ƒğ‘ƒğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
                                                                                                      6.         Return âˆ’ log 2 (max(ğœ“ğœ“, ğœ”ğœ”))


                                                                                             The entropy source will be assessed at the min-entropy per conditioned output, hout, computed
                                                                                             above. Vetted conditioning components are permitted to claim full entropy outputs.




                                                                                             4 The formula used to generate Output_Entropy() is adapted from the formula ğ‘˜ğ‘˜                 ğ‘šğ‘š        ğ‘šğ‘š
                                                                                                                                                                                       ğ›¼ğ›¼ = ğ‘›ğ‘› + ğ›¼ğ›¼ï¿½2 ğ‘›ğ‘› ln ğ‘›ğ‘› provided in Theorem 1 of

                                                                                                 [RaSt98], such that m is equal to 2ğ‘›ğ‘›ğ‘–ğ‘–ğ‘–ğ‘– , n is equal to 2ğ‘›ğ‘› and ğ›¼ğ›¼ is equal to 1.


                                                                                                                                                                  16
