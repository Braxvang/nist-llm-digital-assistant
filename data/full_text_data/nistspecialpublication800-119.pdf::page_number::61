                                                                 GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


records for 6to4 addresses and for other address formats with specific prefixes and embedded IPv4
addresses.

For additional details about adding DNS records for new services, handling time-to-live values in caches,
obtaining a list of DNS servers when DHCPv6 is not used, updating forward (AAAA) and reverse (PTR)
entries, handling dynamic DNS, and renumbering, see RFC 4472.

  3.7.3   Security Impact and Recommendations

    3.7.3.1 General DNS Security Recommendations

All of the general accounts of threats against DNS (RFC 3833) and advice for securing DNS, independent
of IPv6, apply. This begins with host security and software security for DNS servers. It includes keeping
up with new software releases, vulnerability alerts, and patches. The security of DNS servers can be
improved with isolation, redundancy, geographic diversity, network path diversity, and potentially
platform diversity. Administrative access should be controlled and secured. Tools for checking that a
zone file is well formed or that other configuration variables are correctly set should be used. DNS servers
should be included in any penetration testing exercises.

It is good practice to implement certain well-known security best practices, which rely on not divulging
more information than necessary. The IP address of a hidden master server should not be advertised, nor
should the DNS software version number, lest an attacker easily exploit bugs known to be in a certain
release. Common implementations of DNS support access control lists based on IP addresses, and at least
some of these support access control lists based on both IPv4 and IPv6 addresses. Address-based security
is regarded as a rather weak form of authentication, particularly for important actions like DNS dynamic
update, but nevertheless it is an efficient way to provide some protection if it is used together with ingress
and egress address filtering. The widely-used technique of ―split DNS,‖ whereby an enterprise’s DNS
servers provide different answers to internal and external queries, can be used the same way with either A
records or AAAA records.

Based on recent experiences, two attack scenarios are particularly likely. One is denial of service. Excess
capacity and diversity help. Firewalls and intrusion detection systems can help protect a server located in
a ―demilitarized zone.‖ Administrators should be prepared to contact the appropriate emergency response
teams and law enforcement agencies. RFC 5358 contains advice for configuring DNS servers to make
using them as amplifiers in a denial-of-service attack against a third party more difficult.

The second scenario is so-called cache poisoning—inserting false information into a server’s cache, so
that, for example, users may be misdirected to a bogus web site. This is an old idea, but a much more
effective method for accomplishing it became well known in 2008. With or without cryptographic
protection, the recommended remedy is to force the attacker to guess two randomly chosen 16-bit values
simultaneously instead of just one (RFC 5452).

    3.7.3.2 Cryptographic Protection of DNS

Two standard cryptographic protocols are available for securing DNS. They can be used equally with
IPv4, IPv6, and combined IPv4-IPv6 implementations. DNSSEC, the DNS security extensions, is
defined in three RFCs (RFC 4033, 4034, 4035), and TSIG, the Secret Key Transaction Authentication
protocol is described in a fourth RFC (RFC 2845).

The TSIG protocol provides data origin authentication and message integrity for DNS transactions by
adding message authentication codes based on shared secrets. Originally, only the HMAC-MD5



                                                    3-39
