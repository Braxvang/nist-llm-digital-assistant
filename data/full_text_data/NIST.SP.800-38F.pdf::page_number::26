                                NIST Special Publication 800-38F



Algorithm 10: TKW-AD(C)

Prerequisites:
KEK, K, for TDEA;
inverse of the designated cipher function, CIPH-1K;
definition of valid ciphertext lengths.

Input:
purported ciphertext, C, with valid length.

Output:
plaintext P or indication of inauthenticity, FAIL.

Steps:
    1. Let n be the number of semiblocks in C.
    2. Let ICV3 = 0xA6A6A6A6.
    3. Let S = TW-1(C).
    4. If MSB32(S) â‰ ICV3, then return FAIL and stop.
    5. Return P = LSB32(n-1)(S).

8 Conformance
An implementation may claim conformance to one or more of the following six functions: KW-
AE, KW-AD, KWP-AE, KWP-AD, TKW-AE, and TKW-AD. TKW-AE and TKW-AD are
approved to support legacy systems but should not be used for new applications.

The associated wrapping and unwrapping functions, W, W-1, TW, and TW-1, are not approved
for use independently of these six functions.

Implementations of the authenticated-encryption and authenticated-decryption functions may
further restrict the lengths of the plaintext and ciphertext given in Table 1, as discussed in Sec.
5.3.2, as long as at least one length is supported. Such restrictions may affect interoperability.

For every algorithm that is specified in this Recommendation, a conforming implementation may
replace the given set of steps with any mathematically equivalent set of steps. In other words,
different procedures that produce the correct output for any input are permitted.




                                                 18
