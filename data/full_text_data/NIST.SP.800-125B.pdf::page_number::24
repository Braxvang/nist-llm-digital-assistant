NIST SP 800-125B                                                     SECURE VIRTUAL NETWORK CONFIGURATION
                                                                                        FOR VM PROTECTION


4.2.1      Advantages

There are two notable advantages to subnet-level virtual firewalls:

      •    They avoid the need to route virtual network traffic from the virtualized host to the physical
           network and back.
      •    The effort required to deploy one is as low as deploying any other VM.

4.2.2      Disadvantages

Significant disadvantages to subnet-level virtual firewalls include the following:

      •    The speed of packet processing is dependent on several factors, such as number of CPU cores
           allocated to the VM hosting the firewall appliance, the TCP/IP stack of the OS running the
           appliance, and the switching speed of hypervisor switches.
      •    In virtualized hosts containing VMs running I/O intensive applications, there could be heavy
           hypervisor overhead. Even in other cases, since the firewall functions in a VM, it takes away
           some resources that could otherwise be used for running production applications.
      •    Since the virtual firewall is itself a VM, the integrity of its operation depends upon its relationship
           to application VMs. Uncoordinated migration of VMs in the hypervisor could alter this
           relationship and affect the integrity of the firewall’s operation.
      •    Traffic flowing into and out of all port groups and switches connected with the zones associated
           with the firewall are redirected to the VM hosting the firewall, resulting in unnecessary traffic (a
           phenomenon called traffic trombones).
      •    Firewall rules and states associated with a VM do not migrate automatically when a VM is live-
           migrated to another virtualized host. This may cause the VM to lose the protection provided by
           the firewall unless the same rules are reconfigured in the environment of the target virtualized
           host.

4.3       Kernel-Based Virtual Firewalls

Kernel-based virtual firewalls were designed to overcome the limitations of subnet-level virtual firewalls.
A kernel-based virtual firewall is packaged as a Loadable Kernel Module (LKM), which means it is
installed and run in the hypervisor kernel. Because an LKM must be tightly coupled with the hypervisor
executable module, it may not be available on all hypervisor platforms.

4.3.1      Advantages

Kernel-based virtual firewalls have some significant advantages:

      •    They offer much higher performance than subnet-level virtual firewalls because their packet
           processing is done using the hardware resources available to the hypervisor kernel instead of the
           VM-assigned resources (virtual CPUs & virtual memory).
      •    Since they run as hypervisor kernel modules, their functionality cannot be monitored or altered by
           a rogue VM with access to the virtual network inside the hypervisor host.
      •    They have the greatest visibility into the state of the VM, including virtual hardware, memory,
           storage, and applications, besides the VM’s incoming and outgoing network traffic.

                                                        17
