NIST SP 800-85A-4                        PIV CARD APPLICATION & MIDDLEWARE
                                                  INTERFACE TEST GUIDELINES

                    2. Send VERIFY card command with
                       • P2, key reference value is set to '80'
                       • Data field of the command will contain the new
                          PIN value (PIN 2 from previous step), padded
                          with 'FF' to complete the total length of the
                          value to 8 bytes
                    3. Send CHANGE REFERENCE DATA card command with
                       • P2, key reference value is set to '80'
                       • Data field of the command will contain the
                          correct PIN value (PIN 2) concatenated without
                          delimitation with an arbitrary new PIN value
                          (PIN 3) that is padded to less than 8 bytes
                    4. Send CHANGE REFERENCE DATA card command with
                       • P2, key reference value is set to '80'
                       • Data field of the command will contain the
                          correct PIN value (PIN 2) concatenated without
                          delimitation with an arbitrary new PIN value
                          (PIN 4) that is less than 6 bytes but padded
                          to 8 bytes with 'FF'
                    5. Send CHANGE REFERENCE DATA card command with
                       • P2, key reference value is set to '80'
                       • Data field of the command will contain the
                          correct PIN value (PIN 2) concatenated without
                          delimitation with an arbitrary new PIN value
                          (PIN 5) that is 6 bytes but padded to 8 bytes
                          with 'FF' in byte 7 and 'AA' in byte 8
                    6. Send CHANGE REFERENCE DATA card command with
                       • P2, key reference value is set to '80'
                       • Data field of the command will contain the
                          correct PIN value (PIN 2), concatenated
                          without delimitation with an arbitrary new PIN
                          value that contains 0x5A in the first byte
                          position, all other non-padded bytes contain
                          values limited to 0x30 – 0x39 (PIN 6). Both
                          PINs should be padded with 'FF' to complete
                          the total length of each value to 8 bytes
                          (repeat test five times with byte positions 2,
                          3, 4, 5, and 6 containing the 0x5A byte,
                          respectively)
                    7. Send CHANGE REFERENCE DATA card command with
                       • P2, key reference value is set to '80'
                       • Data field of the command will contain an
                          arbitrary PIN value that contains 0x5A in the
                          first byte position, all other non-padded
                          bytes contain values limited to 0x30 – 0x39
                          (PIN 7), concatenated without delimitation
                          with a properly formatted new PIN value where
                          all non-padded bytes contain values limited to
                          0x30 – 0x39 (PIN 8). Both PINs should be
                          padded with 'FF' to complete the total length
                          of each value to 8 bytes. (repeat test five
                          times with byte positions 2, 3, 4, 5, and 6
                          containing the 0x5A byte, respectively)




                         C-20
