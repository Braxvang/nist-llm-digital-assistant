NIST SP 800-85A-4                                               PIV CARD APPLICATION & MIDDLEWARE
                                                                         INTERFACE TEST GUIDELINES

                Card Command Interface Test Assertions

This appendix specifies the tests that shall be performed on PIV Card Applications. Unless
otherwise specified:
   •   Tests within a subsection titled “Contact Interface” shall be performed over the contact
       interface of the PIV Card without the use of secure messaging. These tests shall be
       performed for all PIV Card Applications being tested.
   •   Tests within a subsection titled “Contactless Interface” shall be performed over the
       contactless interface of the PIV Card without the use of secure messaging. These tests
       shall be performed for all PIV Card Applications being tested.
   •   Tests within a subsection titled “Secure Messaging Interface” shall be performed over the
       contactless interface of the PIV Card with secure messaging. These tests shall be
       performed for all PIV Card Applications that support secure messaging. If the Discovery
       Object is present and Bit 4 of the first byte of the PIN Usage Policy is set to one
       (indicating that the PIV Card Application has implemented the optional VCI), then Bit 3
       of the first byte of the PIN Usage Policy shall be set to zero for these tests (to indicate
       that the pairing code is required to establish the VCI).
   •   Tests within a subsection titled “Virtual Contact Interface” shall be performed over the
       contactless interface of the PIV Card with secure messaging. These tests shall be
       performed for all PIV Card Applications that support the VCI. For these tests, the
       Discovery Object shall be present and Bit 4 of the first byte of the PIN Usage Policy shall
       be set to one. The tests shall be run with Bit 3 of the first byte of the PIN Usage Policy set
       to zero and with the pairing code having been submitted to the PIV Card Application. If
       the PIV Card Application also supports setting Bit 3 of the first byte of the PIN Usage
       Policy to one, then these tests shall additionally be performed in that configuration with
       the security status indicator of the pairing code set to FALSE.
Test Assertion Template
 Purpose             A quick description of the test and why it is being run.
 Reference(s)        1. References to SP 800-73-4 or other relevant publications.
                     2. References to DTRs.
 Precondition(s)     Anything that must be done or known prior to executing the
                     scenario.
 Test Scenario       Sequence of APDU calls.
 Expected Result(s) What the expected execution path yields in terms of progress and
                     values.
 Postcondition(s)    A description of the card application state once the test scenario
                     completes.

Note: The status words returned in all SM and VCI interface tests refer to the BER-TLV status
words associated with the card commands, not the secure messaging SW protocol status words.




                                            C-1
