                                GUIDE TO MALWARE INCIDENT PREVENTION AND HANDLING FOR DESKTOPS AND LAPTOPS


In situations in which the typical sources of evidence do not contain the necessary information,
organizations might need to turn to secondary sources, such as the following:

     DNS Server Logs. DNS server logs often contain records of infected hosts attempting to get the
      IP address for an external malicious site that they are trying to interact with (e.g., send data to,
      receive commands from). Some organizations deploy passive DNS collection systems, which
      keep track of all DNS resolutions occurring within the enterprise; these are often more helpful
      than DNS server logs in identifying malicious activity because malware might use DNS services
      other than the organization’s. Analysts should be cautious of blocking hosts based only on
      resolved IP addresses because many current attacks use fast flux DNS, which means that each
      domain resolves to several different IP addresses (in a round robin arrangement), and these
      addresses often change in a matter of hours. The newer the DNS resolution, the more likely the IP
      addresses are to be the correct ones to block in the short term.
     Other Application Server Logs. Applications commonly used as malware transmission
      mechanisms, such as email and HTTP, might record information in their logs that indicates which
      hosts were infected. From end to end, information regarding a single email message might be
      recorded in several places: the sender’s host, each email server that handles the message, and the
      recipient’s host, as well as antivirus and content filtering servers. Similarly, hosts running web
      browsers can provide a rich resource for information on malicious web activity, including a
      history of websites visited and the dates and times that they were visited, and cached web data
      files.
     Network Forensic Tools. Software programs that capture and record packets, such as network
      forensic analysis tools and packet sniffers, might have highly detailed information on malware
      activity. However, because these tools record so much information about most or all network
      activity, it can be very time-intensive to extract just the needed information. More efficient means
      of identifying infected hosts are often available.
     Network Device Logs. Firewalls, routers, and other filtering devices that record connection
      activity, as well as network monitoring tools, might be helpful in identifying network connection
      activity (e.g., specific port number combinations, unusual protocols) consistent with certain
      malware.
Using forensic data for identifying infected hosts can be advantageous over other methods because the
data has already been collected—the pertinent data just needs to be extracted from the total data set.
Unfortunately, for some data sources, extracting the data can take a considerable amount of time. Also,
event information can become outdated quickly, causing uninfected hosts to undergo containment
unnecessarily and allowing infected hosts to avoid containment measures. If an accurate, comprehensive,
and reasonably current source of forensic data is available, it might provide the most effective way of
identifying infected hosts.

4.2.2.2 Active Identification

Active identification methods are used to identify which hosts are currently infected. Immediately after
identifying an infection, some active approaches can be used to perform containment and eradication
measures for the host, such as running a disinfection utility, deploying patches or antivirus updates, or
moving the host to a VLAN for infected hosts. Active identification can be performed through several
methods, including the following:

     Security Automation. Security automation technologies, particularly those used for continuous
      monitoring (e.g., network access control technologies), can be used to check host characteristics


                                                    22
