NIST SP 800-125B                                                  SECURE VIRTUAL NETWORK CONFIGURATION
                                                                                     FOR VM PROTECTION


    •   They have direct access to all virtual switches and all the network interfaces of those switches. So
        the scope of their packet monitoring and filtering functionality not only includes inter-VM traffic
        but also traffic from the VM to the physical network through the pNICs of the hypervisor host.
    •   Since these firewalls are hypervisor kernel modules, packet filtering functions operate between
        the vNICs of each VM and the hypervisor switch. The firewall rules and states are logically
        attached to the VM interface, so they move with the VM when it migrates to another virtualized
        host, thus providing continuity of security protection for the migrated VM.

4.3.2   Disadvantages

A notable disadvantage of kernel-based virtual firewalls is that there can be problems integrating them
with some virtualization management tools having access to only VMs or virtual networks. Because this
class of firewalls runs as a managed kernel process, it is neither a VM-resident program nor a component
of the virtual network (such as a virtual switch or a vNIC) of the virtualized host.

4.4 Security Recommendations for Firewall Deployment Architecture

Based on the analysis of the three classes of firewalls (Sections 4.1, 4.2, and 4.3), the following security
recommendations for firewall deployment are provided. Each recommendation has a unique identifier of
format VM-FW-Rx, where VM stands for virtual machine, FW for firewall, and Rx for the
recommendation sequence.

VM-FW-R1: In virtualized environments with VMs running delay-sensitive applications, virtual
firewalls should be deployed for traffic flow control instead of physical firewalls, because in the latter
case, there is latency involved in routing the virtual network traffic outside the virtualized host and back
into the virtual network.

VM-FW-R2: In virtualized environments with VMs running I/O intensive applications, kernel-based
virtual firewalls should be deployed instead of subnet-level virtual firewalls, since kernel-based virtual
firewalls perform packet processing in the kernel of the hypervisor at native hardware speeds.

VM-FW-R3: For both subnet-level and kernel-based virtual firewalls, it is preferable if the firewall is
integrated with a virtualization management platform rather than being accessible only through a
standalone console. The former will enable easier provisioning of uniform firewall rules to multiple
firewall instances, thus reducing the chances of configuration errors.

VM-FW-R4: For both subnet-level and kernel-based virtual firewalls, it is preferable that the firewall
supports rules using higher-level components or abstractions (e.g., security group) in addition to the basic
5-tuple (source/destination IP address, source/destination ports, protocol).




                                                     18
