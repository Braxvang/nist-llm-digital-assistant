                                                                                             NIST SP 800-208                                                                             RECOMMENDATION FOR STATEFUL
                                                                                                                                                                                        HASH-BASED SIGNATURE SCHEMES

                                                                                             scheme. This address is then hashed along with a unique identifier (SEED) for the long-term
                                                                                             public key to create the prefix.

                                                                                             Unlike LMS, XMSS also uses bitmasks. Similar to the generation of the prefix, a slightly
                                                                                             different address is hashed along with the SEED to create a bitmask, which is exclusive-ORed
                                                                                             with the value to be hashed (the input). The prefix and masked input value are concatenated as
                                                                                             specified in [1] to form the input to the hash function. 4 Figure 6 illustrates an example of this
                                                                                             computation when the input is a Winternitz chaining value. In [1], the hash function is referred to
                                                                                             as H, H_msg, F, or PRF, depending on where it is being used. However, in each case, it is the
                                                                                             same function, just with a different prefix prepended in order to ensure separation between the
                                                                                             uses.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-208




                                                                                                                3 || SEED || ADDR                                     H

                                                                                                                                                                0 || prefix || bitmasked input               H             output



                                                                                                   input
                                                                                                                3 || SEED || ADDR'                        H             bitmask
                                                                                                                                                                                          âŠ•
                                                                                                                            Figure 6: XMSS hash computation with prefix and bitmask




                                                                                             4   When hashing values within a Merkle tree, two bitmasks are created, one for the left input and one for the right input, and the
                                                                                                 two bitmasked values are concatenated along with the prefix.


                                                                                                                                                              11
