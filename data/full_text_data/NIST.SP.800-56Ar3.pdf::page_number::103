                                                                                               NIST SP 800-56A Rev. 3                              Recommendation for Pair-Wise Key Establishment
                                                                                                                                                           Using Discrete Logarithm Cryptography


                                                                                                                                  Party U                                Party V

                                                                                                                        1. Compute                        1. Compute
                                                                                                Derive secret              DerivedKeyingMaterial             DerivedKeyingMaterial
                                                                                                Keying material
                                                                                                                        2. Destroy Z                      2. Destroy Z

                                                                                               6.2.1.5 Incorporating Key Confirmation into a C(1e, 2s) Scheme
                                                                                               The subsections that follow illustrate how to incorporate key confirmation (as described in
                                                                                               Section 5.9) into the C(1e, 2s) key-agreement schemes described above. Note that party V
                                                                                               cannot act as a key-confirmation recipient unless a nonce (NonceV) is provided by party V to
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                               party U and is used (in addition to the shared secret Z) as input to the key-derivation method
                                                                                               employed by the scheme. This would be accomplished by including (a copy of) NonceV in
                                                                                               the OtherInput provided to the KDM, as part of the FixedInfo (see Section 5.8), in addition
                                                                                               to using (a copy of) NonceV as the EphemDataV employed in the MacTag computations for
                                                                                               key confirmation.
                                                                                               The flow depictions separate the key-establishment flow from the key-confirmation flow.
                                                                                               The depictions and accompanying discussions presume that the assumptions of the scheme
                                                                                               have been satisfied, that the key-agreement transaction has proceeded successfully through
                                                                                               key derivation, and that the received MacTags are successfully verified as specified in
                                                                                               Section 5.2.2.

                                                                                               6.2.1.5.1 C(1e, 2s) Scheme with Unilateral Key Confirmation Provided by Party U to
                                                                                                         Party V
                                                                                               Figure_9 depicts a typical flow for a C(1e, 2s) scheme with unilateral key confirmation from
                                                                                               party U to party V. In this situation, party U and party V assume the roles of key-confirmation
                                                                                               provider and recipient, respectively. Since party V does not contribute an ephemeral public
                                                                                               key during the key-agreement process, a nonce (NonceV) shall be provided by party V to
                                                                                               party U and used (in addition to the shared secret Z) as input to the key-derivation method
                                                                                               employed by the scheme. NonceV is also used as EphemDataV during MacTag computations.
                                                                                               The successful completion of the key-confirmation process provides party V with assurance
                                                                                               that party U has derived the same secret Z value. If NonceV is a random nonce, then party V
                                                                                               also obtains assurance that party U has actively participated in the process; see Section 5.4
                                                                                               for a discussion of the length and security strength required for the nonce.




                                                                                                                                             92
