                                                           SECURE DOMAIN NAME SYSTEM (DNS) DEPLOYMENT GUIDE



8.2.1   Key Generation

To enable zone transfer (requests and responses) through authenticated messages, it is necessary to
generate a key for every pair of name servers. The key also can be used for securing other transactions,
such as dynamic updates, DNS queries, and responses. The binary key string that is generated by most
key generation utilities used with DNSSEC is base 64 encoded. The program that generates the key in
BIND 9.x is dnssec-keygen. An example of a command that generates a secret key (as opposed to other
types of keys, such as public keys, which this program also can generate) by invoking the dnssec-keygen
program is as follows:

        dnssec-keygen -a HMAC-SHA256 –b 112 -n HOST ns1-ns2.example.com.

where the various command options (parameters) denote the following:

        -a option: the name of the hashing algorithm that will use the key (HMAC-SHA256 is preferred,
        but may not be available in older implementations. Use of HMAC-SHA1 is allowed, but
        migration to HMAC-SHA256 should be done when available)

        -b option: the length of the key (here – a minimum of 112 bits)

        -n option: the type of key (in this case, the HOST)

        last parameter: the name of the key (ns1-ns2.example.com)

The dnssec-keygen program generates the following files, each containing the key string:

        Kns1-ns2.example.com.+157+34567.key
        Kns1-ns2.example.com.+157.34567.private

When the program is generating a pair of keys (one public and the other private), the file with the
extension key will contain the public key string and the file with extension private will contain the private
key. Because in this case only the secret key is being generated, the key strings in both files will be the
same for the TSIG implementation. The key string from any of these files is then copied to a file called
the key file. This file is then referenced using an include statement within the key statement.

8.2.2   Defining the Keys in the Communicating Name Servers

The key generated by using the dnssec-keygen utility has to be defined within the named.conf
configuration file of the two communicating servers (generally one primary name server and one
secondary name server). This is accomplished by using the key statement of BIND:

        key “ns1-ns2.example.com.” {
             algorithm hmac-sha256;
             include “/var/named/keys/secretkey.conf”;
        };

where the file secretkey.conf will contain the keyword secret and the actual key string (in this example):

        secret “MhZQKc4TwAPkURM==“;




                                                    8-13
