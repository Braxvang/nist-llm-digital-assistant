Special Publication 800-85B                                   PIV Data Model Testing Specification


                      5. Extract the SignerInfo->digestAlgorithm field contents
                         from the asymmetric digital signature of the CHUID
                      6. Using the digest Algorithm obtained in the previous
                         step, calculate the hash of the concatenated contents of
                         the CHUID, excluding the asymmetric digital signature
                         field
Expected              The value of the hash obtained from the message digest attribute of the
Result(s)             signedAttrs of the SignerInfo is identical to that obtained after hashing the
                      concatenated contents of the CHUID, excluding the asymmetric digital
                      signature field.


10.1.1.10 Verify PIV signer distinguished name

Purpose               Confirms that the signedAttrs of the SignerInfo includes the pivSigner-
                      DN attribute containing the subject name that appears in the X.509
                      certificate for the entity that signed the CHUID.
Reference(s)          1.      FIPS201, Section 4.2.2
                      2.      AS06.01.13
Precondition          1.      A valid PIV card is inserted into the contact reader.
                      2.      A valid PC/SC connection exists between the test application and the
                              contact reader.
                      3.      The test application is currently connected to the card application
                              which is accessible through card handle.
                      4.      A valid CHUID is present on the PIV card.
Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<CHUID (2.16.840.1.101.3.7.2.48.0)>>
                      3. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      4. Parse the SignerInfo-> signedAttrs field contents from
                         the asymmetric signature field of the CHUID to locate
                         the pivSigner-DN attribute (OID=2.16.840.1.101.3.6.5)
                      5. Extract the certificates field contents from the
                         asymmetric signature of the CHUID.
                      6. Extract the subject DN from the certificate obtained in
                         the previous step
Expected              The value of the subject DN obtained from the certificate in the
Result(s)             certificates field in the SignedData is identical to that obtained from the
                      pivSigner-DN attribute of the signedAttrs of the SignerInfo.


10.1.1.11 Verify signature algorithm in SignerInfo

Purpose               Confirms that the signatureAlgorithm field specified in the SignerInfo
                      field is in accordance with Table 3-4 of SP80078 and based on the PIV card
                      expiration date in accordance with Table 3-3 of SP80078.


                                                                                                     Page 78
