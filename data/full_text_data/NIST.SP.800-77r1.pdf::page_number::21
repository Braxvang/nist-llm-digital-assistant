                                                                                              NIST SP 800-77 REV. 1                                                           GUIDE TO IPSEC VPNS


                                                                                              Security controls exist for network communications at each layer of the IP model. As previously
                                                                                              explained, data is passed from the highest to the lowest layer, with each layer adding more
                                                                                              information. Therefore, a security control at a higher layer cannot provide full protection for
                                                                                              lower layers because the lower layers perform functions of which the higher layers are not aware.
                                                                                              The following items discuss the security controls that are available at each layer:

                                                                                                 •   Application Layer. Separate controls must be established for each application. For
                                                                                                     example, if an application needs to protect sensitive data sent across networks, the
                                                                                                     application may need to be modified to provide this protection. While this allows for a
                                                                                                     high degree of control and flexibility over the application’s security, it may require a
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                                     large resource investment to properly add and configure controls for each application.

                                                                                                     Designing a cryptographically sound application protocol is very difficult, and
                                                                                                     implementing it properly is even more challenging, so creating new application layer
                                                                                                     security controls is likely to create vulnerabilities. Also, some applications, particularly
                                                                                                     commercial off-the-shelf (COTS) software, may not be capable of providing such
                                                                                                     protection.

                                                                                                     While application layer controls can protect application data, they cannot protect
                                                                                                     communication metadata, such as source and destination IP addresses, because this
                                                                                                     information exists at a lower layer. Whenever possible, application layer controls for
                                                                                                     protecting network communications should be standards-based solutions that have been
                                                                                                     in use for some time. One example is Secure/Multipurpose Internet Mail Extensions
                                                                                                     (S/MIME) [19], which is commonly used to encrypt email messages. Another example is
                                                                                                     the Secure Shell (SSH) [20] protocol, which encrypts remote login sessions.

                                                                                                 •   Transport Layer. Controls at this layer can be used to protect the data in a single
                                                                                                     communication session between two hosts, often called a netflow. Because IP
                                                                                                     information is added at the network layer, transport layer controls cannot protect it. In the
                                                                                                     past, there have been many protocols that protect different netflows, but the current best
                                                                                                     practice is to use Transport Layer Security (TLS) [21] to protect TCP streams and
                                                                                                     Datagram Transport Layer Security (DTLS) [22] to protect UDP datagrams.

                                                                                                     The use of TLS or DTLS typically requires each application to support TLS or DTLS;
                                                                                                     however, unlike application layer controls (which typically involve extensive
                                                                                                     customization of the application), transport layer controls such as TLS and DTLS are less
                                                                                                     intrusive because they simply protect network communications and do not need to
                                                                                                     understand the application’s functions or characteristics. Although using TLS or DTLS
                                                                                                     may require modifying some applications, these protocols are well-tested and are a
                                                                                                     relatively low-risk option compared to adding protection at the application layer instead.

                                                                                                     Alternatively, an application could use a TLS proxy instead of building native support for
                                                                                                     TLS or DTLS. The transport layer can only provide transport security, not data origin
                                                                                                     security. For example, a TLS-based connection between two email servers protects the
                                                                                                     transport from eavesdroppers but does not protect the message content transmitted within
                                                                                                     that TLS connection from manipulation by one of the two email servers. TLS and DTLS


                                                                                                                                               4
