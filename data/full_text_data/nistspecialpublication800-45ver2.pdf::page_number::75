                                                                       GUIDELINES ON ELECTRONIC MAIL SECURITY



The only “pure” network layer firewalls available today are small office/home office (SOHO) firewall
appliances and personal firewalls [Wack02a] that may only perform basic packet-level filtering.

Stateful inspection firewalls are transport layer devices that incorporate “awareness” of the state of a TCP
connection. Stateful inspection firewalls maintain internal information such as the state of the
connections passing through and the contents of some of the data streams. This allows better and more
accurate rule sets and filtering to be specified. Stateful inspection firewalls add the capability to enforce
rules based on connection state to the capabilities of a filtering router.

Application layer firewalls (sometimes called application-proxy gateway firewalls) are advanced firewalls
that combine network and transport layer access control with application layer functionality. Application
layer firewalls permit no traffic directly between the Internet and the internal network, or between two
networks. They can usually perform extensive logging and access control.

Application layer firewalls are considered the most secure type of firewall and have numerous advantages
over packet filtering routers and stateful inspection firewalls, including the following areas:

 Logging capabilities
 Filtering capabilities (can filter specific types of email content and specific SMTP, POP, and IMAP
  commands)
 Ease of configuration
 User authentication capabilities.
The primary disadvantages that application layer firewalls have when compared to packet filtering routers
and stateful inspection firewalls are as follows:

 Speed of throughput.
 Cost (if high end hardware is required to operate effectively)
 Support for less popular and new protocols.
Although not strictly a limitation, application layer firewalls are sometimes implemented on hosts running
general-purpose operating systems (e.g., Windows, Linux, Unix). This arrangement introduces an added
layer of complexity because that general-purpose operating system must also be secured in addition to the
firewall software itself. Application layer firewalls are increasingly being deployed as appliance-based
devices, which may use specialized operating systems. Routers and stateful inspection firewalls also
typically run on specialized operating systems.

To successfully protect a mail server using a firewall, ensure that the firewall is patched to the latest or
most secure level (application and underlying operating system) and is both capable of and configured to
support the following items:

 Control all traffic between the Internet and the mail server
 Block all inbound traffic to the mail server except that traffic which is required, such as TCP port 25
  (SMTP).
 Block (in conjunction with the intrusion detection or prevention system [see Section 7.2.2]) IP
  addresses or subnets that the IDS or IPS reports are attacking the organizational network


                                                     7-7
