NIST SP 800-125B                                                     SECURE VIRTUAL NETWORK CONFIGURATION
                                                                                        FOR VM PROTECTION


5.      VM Traffic Monitoring

Firewalls only ensure that inter-VM traffic conforms to organizational information flow and security
rules. However, to identify any malicious or harmful traffic coming into or flowing out of VMs and to
generate alerts or take preventive action, it is necessary to set up traffic monitoring capabilities to monitor
all incoming/outgoing traffic of a VM. This requires functionality to send copies of those packets to a
network monitoring application (also called an analyzer application). This functionality is called port
mirroring. The purpose of a network monitoring application is to perform security analysis, network
diagnostics, and network performance metrics generation. Configuration options are available in
hypervisors to turn on port mirroring functionality. Depending upon the hypervisor offering, this
configuration option may exist as either a VM-configuration feature or a virtual switch port configuration
feature.

5.1     Enabling VM Traffic Monitoring Using VM Network Adapter Configuration

In some hypervisor offerings, the network monitoring application runs as a VM-based application. This
VM and its vNIC become the destination VM/vNIC (the analyzer VM) to which traffic must be sent for
analysis. The VM to have its traffic monitored (the monitored VM) becomes the source VM/vNIC. Thus
the values “Source” and “Destination” are assigned to the “mirroring mode” configuration parameters of
the vNICs of the monitored VM and analyzer VM, respectively.

5.2     Enabling VM Traffic Monitoring Using Virtual Switch Port Configuration

There are two ways that a virtual switch can be configured to enable network monitoring tool visibility
into traffic flowing into and out of a particular VM:

•     In the earlier versions of a virtual switch, the only configuration option available was to set a
      particular VM port group into promiscuous mode. This will allow any VMs connected to that port
      group to have visibility into the traffic going into or coming out of all VMs connected to that port
      group.
•     In the latter versions of a virtual switch, the traffic flowing into and out of the port of a virtual switch
      (to which the monitored VM is connected) can be forwarded to another specific port. The target or
      destination port can be another virtual port or an uplink port. This provides flexibility because the
      network monitoring application can be located either in a VM or in the physical network outside the
      virtualized host.

5.3     Security Recommendations for VM Traffic Monitoring

Based on the available configuration options in various hypervisor platforms, the following are the
recommendations for VM Traffic Monitoring options. Each recommendation has a unique identifier of
format VM-TM-Rx, where VM stands for virtual machine, TM stands for traffic monitoring, and Rx for
the recommendation sequence.

VM-TM-R1: VM traffic monitoring should be performed for both incoming and outgoing traffic.

VM-TM-R2: If traffic visibility is accomplished by setting the promiscuous mode feature, care should be
taken to see that this is activated only for the required VM port group and not for the entire virtual switch.




                                                         19
