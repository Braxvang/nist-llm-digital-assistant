NIST SP 800-166                                                DERIVED PIV APPLICATION AND
                                                               DATA MODEL TEST GUIDELINES

                   • DTR-06.03.06.06
                   • DTR-06.03.06.08
 Vendor            None.
 Documentation
 Precondition(s)   •   A token with the Derived PIV Application is inserted into an
                       appropriate token reader.
                   •   Suitable drivers have been loaded between the test system and an
                       instance of the reader.
                   •   The Derived PIV Application Password and PUK are recorded.
                   •   The Derived PIV Application Password’s retry counter and the
                       PUK’s retry counter are not 0.
 Test Scenario     1. Send the SELECT command with
                         • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                   2. Send the CHANGE REFERENCE DATA command with
                         • P2, key reference value, is set to '80'
                         • Data field of the command will contain the
                            correct password value (password 1) padded to 8
                            bytes with 'FF' (if necessary) concatenated
                            without delimitation with an arbitrary new
                            password value (password 2) that is padded to
                            less than 8 bytes
                   3. Send the CHANGE REFERENCE DATA command with
                         • P2, key reference value, is set to '80'
                         • Data field of the command will contain the
                            correct password value (password 1) padded to 8
                            bytes with 'FF' (if necessary) concatenated
                            without delimitation with an arbitrary new
                            password value (password 2) that is 6 bytes but
                            padded to 8 bytes with 'FF' in byte 7 and 'AA' in
                            byte 8
                   4. Send the CHANGE REFERENCE DATA command with
                         • P2, key reference value, is set to '80'
                         • Data field of the command will contain the
                            correct password (password 1) padded to 8 bytes
                            with 'FF' (if needed) concatenated without
                            delimitation with an arbitrary new password
                            (password 2) that is less than 6 bytes but padded
                            to 8 bytes with 'FF'
                   5. Send the CHANGE REFERENCE DATA command with
                         • P2, key reference value, is set to '80'
                         • Data field of the command will contain the
                            correct password (password 1) padded to 8 bytes
                            with 'FF'(if necessary) concatenated without
                            delimitation with an arbitrary new password
                            (password 2) that is greater than 8 bytes in
                            length
                   Perform Steps 6 and 7 only if the Derived PIV Application
                   supports changing the PUK with the CHANGE REFERENCE DATA
                   command.
                   6. Send the CHANGE REFERENCE DATA command with
                         • P2, key reference value, is set to ‘81’



                                         69
