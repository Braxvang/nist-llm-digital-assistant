NIST SP 800-90A Rev. 1                                            Recommendation for Random Number
                                                                   Generation Using Deterministic RBGs



10.2 DRBG Mechanism Based on Block Ciphers

A block cipher DRBG is based on a block cipher algorithm. The block cipher DRBG mechanism
specified in this Recommendation has been designed to use any approved block cipher
algorithm and may be used by consuming
applications requiring various security strengths,
providing that the appropriate block cipher
algorithm and key length are used, and sufficient
entropy is obtained for the seed.
The maximum security strength that can be
supported by the DRBG depends on the block
cipher and key size used; the security strengths that
can be supported by the block ciphers and key sizes
are provided in [SP 800-57].
10.2.1     CTR_DRBG

CTR_DRBG uses an approved block cipher
algorithm in the counter mode as specified in [SP
800-38A], but allows the counter field to be a
subset of the input block, as specified in [SP 800-
38D]. Note that for TDEA, the input and output
block lengths are 64 bits, and for AES, the lengths
are 128 bits.
The same block cipher algorithm and key length
shall be used for all block cipher operations of this   Figure 11: CTR_DRBG Update Function
DRBG. The block cipher algorithm and key length
shall meet or exceed the security requirements of the consuming application.
CTR_DRBG is specified using an internal function (CTR_DRBG_Update). Figure 11 depicts
the CTR_DRBG_Update function. This function is called by the instantiate, generate and
reseed algorithms to adjust the internal state when new entropy or additional input is provided, as
well as to update the internal state after pseudorandom bits are generated. Figure 12 depicts the
CTR_DRBG in three stages. The operations in the top portion of the figure are only performed
if the additional input is not null.
Table 3 specifies the values that shall be used for the function envelopes and CTR_DRBG
mechanism.




                                                48
