Special Publication 800-85B                                         PIV Data Model Testing Specification




10.   Signed Data Elements Test Assertions

10.1 Card Holder Unique Identifier (CHUID)

10.1.1 Signature Block Contents

10.1.1.1 Verify presence of CMS SignedData asymmetric digital signature

Purpose               Confirms that the CHUID buffer contains an asymmetric digital signature
                      implemented as a SignedData type in accordance with the Cryptographic
                      Message Syntax as defined in RFC 3852.
Reference(s)          1.      FIPS201, Section 4.2.2
                      2.      AS06.01.01
                      3.      AS06.01.02
Precondition          1.      A valid PIV card is inserted into the contact reader.
                      2.      A valid PC/SC connection exists between the test application and the
                              contact reader.
                      3.      The test application is currently connected to the card application
                              which is accessible through card handle.
                      4.      A valid CHUID is present on the PIV card.
Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<CHUID (2.16.840.1.101.3.7.2.48.0)>>
                      3. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      4. Parse the obtained CHUID and extract the contents from
                         the asymmetric digital signature field (i.e. Tag 0x3E)
                      5. Process the contents of the digital signature
Expected              The CHUID buffer contains an asymmetric digital signature that is
Result(s)             implemented as a SignedData type and is encoded as a CMS external
                      signature according to RFC 3852.


10.1.1.2 Verify version in SignedData

Purpose               Confirms that the version of the SignedData content type is 3.
Reference(s)          1.      FIPS201, Section 4.2.2
                      2.      AS06.01.03
Precondition          1.      A valid PIV card is inserted into the contact reader.
                      2.      A valid PC/SC connection exists between the test application and the
                              contact reader.
                      3.      The test application is currently connected to the card application
                              which is accessible through card handle.
                      4.      A valid CHUID is present on the PIV card.


                                                                                                 Page 72
