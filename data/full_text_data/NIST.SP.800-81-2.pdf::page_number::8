SECURE DOMAIN NAME SYSTEM (DNS) DEPLOYMENT GUIDE



7.   Guidelines for Securing DNS Hosting Environment .................................................... 7-1
      7.1    Securing DNS Host Platform ..................................................................................7-1
      7.2    Securing DNS Software ..........................................................................................7-1
             7.2.1 Running the Latest Version of Name Server Software ............................... 7-1
             7.2.2 Turning off the Version Query .................................................................... 7-2
             7.2.3 Running Name Server Software with Restricted Privileges ........................ 7-3
             7.2.4 Isolating the Name Server Software ........................................................... 7-3
             7.2.5 Dedicated Name Server Instance for Each Function .................................. 7-3
             7.2.6 Removing Name Server Software from Nondesignated Hosts ................... 7-4
             7.2.7 Network and Geographic Dispersion of Authoritative Name Servers .......... 7-4
             7.2.8 Limiting Information Exposure through Partitioning of Zone files ................ 7-5
             7.2.9 Limiting Information Exposure Through Separate Name Servers for Different
             Clients 7-6
      7.3    Content Control of Zone File ...................................................................................7-6
      7.4    Recommendations Summary .................................................................................7-6
8.   Guidelines for Securing DNS Transactions.................................................................. 8-1
      8.1    Restricting Transaction Entities Based on IP Address ............................................8-1
             8.1.1 Restricting DNS Query/Response Transaction Entities .............................. 8-3
             8.1.2 Restricting Zone Transfer Transaction Entities ........................................... 8-7
             8.1.3 Restricting Zone Transfer in NSD............................................................... 8-8
             8.1.4 Restricting Zone Transfer in Windows Server ............................................ 8-8
             8.1.5 Restricting Dynamic Update Transaction Entities ....................................... 8-8
             8.1.6 Restricting BIND DNS NOTIFY Transaction Entities .................................. 8-9
             8.1.7 Restricting NSD DNS NOTIFY Transaction Entities ................................. 8-10
      8.2    Transaction Protection Through Hash-Based Message Authentication Codes (TSIG)8-10
             8.2.1 Key Generation ........................................................................................ 8-13
             8.2.2 Defining the Keys in the Communicating Name Servers .......................... 8-13
             8.2.3 Defining the Keys in a NSD Configuration File ......................................... 8-14
             8.2.4 Instructing Name Servers to Use Keys in All Transactions ....................... 8-14
             8.2.5 Checklists for Key File Creation and Key Configuration Process .............. 8-14
             8.2.6 Securing Zone Transfers using TSIG ....................................................... 8-15
             8.2.7 Securing Dynamic Updates Using TSIG or SIG(0) ................................... 8-15
             8.2.8 Configuring Dynamic Update Forwarding Restrictions Using TSIG Keys . 8-16
             8.2.9 Configuring Fine-Grained Dynamic Update Restrictions Using TSIG/SIG(0)
             Keys 8-16
      8.3    Recommendations Summary ...............................................................................8-18
9.   Guidelines for Securing DNS Query/Response ........................................................... 9-1
      9.1  Enabling DNSSEC processing in BIND & NSD .......................................................9-1
      9.2  DNSSEC Mechanisms and Operations ..................................................................9-1
           9.2.1 Sign and Serve .......................................................................................... 9-1
           9.2.2 Verify Signature ......................................................................................... 9-2
      9.3 Generation of Public Key-Private Key Pair (DNSSEC-OP1) ...................................9-3
           9.3.1 Key Pair Generation—Illustrative Example ................................................. 9-6
      9.4 Secure Storage of Private Keys (DNSSEC-OP2) ...................................................9-8
      9.5 Publishing the Public Key (DNSSEC-OP3) and Setting Up Trust Anchors (DNSSEC-
      OP7) 9-9
      9.6 Zone Signing (DNSSEC-OP4) ..............................................................................9-10
           9.6.1 Zone Signing—Illustrative Example.......................................................... 9-10



                                                             vi
