                                                                                             NIST SP 800-90B                                            RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                USED FOR RANDOM BIT GENERATION

                                                                                             6.4     Reducing the Symbol Space

                                                                                             It is often the case that the data requirements for a test on noise source samples depends on the
                                                                                             number of possible different symbols from the noise source (i.e., the size of the alphabet A, denoted
                                                                                             k). For example, consider two different noise sources. The first source outputs 4-bit samples, and
                                                                                             thus has a possible total of 24 = 16 different symbols, and the second source outputs 32-bit samples,
                                                                                             for a possible total of 232 different symbols.

                                                                                             In many cases, the variability in the output that contributes to the entropy in a sample may be
                                                                                             concentrated among some portion of the bits in the sample. For example, consider a noise source
                                                                                             that outputs 32-bit high-precision clock samples that represent the time it takes to perform some
                                                                                             system process. Suppose that the bits in a sample are ordered in the conventional way, so that the
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                             lower-order bits of the sample correspond to the higher resolution measurements of the clock. It is
                                                                                             easy to imagine that in this case, the low-order bits would contain most of the variability. In fact,
                                                                                             it would seem likely that some of the high-order bits may be constantly 0. For this example, it
                                                                                             would be reasonable to truncate the 32-bit sample to a 4-bit string by taking the lower 4 bits, and
                                                                                             perform the tests on the 4-bit strings. Of course, it must be noted that in this case, only a maximum
                                                                                             of 4 bits of min-entropy per sample could be credited to the noise source.

                                                                                             The algorithm given below provides an example of a method for mapping the n-bit samples,
                                                                                             collected as specified in Section 3.1.1, to m-bit samples, where n ≥ m. The resulting strings can be
                                                                                             used as input to tests that may have infeasible data requirements if the mapping were not
                                                                                             performed. Note that after the mapping is performed, the maximum amount of entropy possible
                                                                                             per n-bit sample is m bits.

                                                                                             Given a noise source that produces n-bit samples, where n exceeds the bit-length that can be
                                                                                             handled by the test, the submitter may provide the tester with an ordered ranking of the bits in the
                                                                                             n-bit samples (see Section 3.2.2). The rank of ‘1’ corresponds to the bit assumed to be contributing
                                                                                             the most entropy to the sample, and the rank of n corresponds to the bit contributing the least
                                                                                             amount. If multiple bits contribute the same amount of entropy, the ranks can be assigned
                                                                                             arbitrarily among those bits. The following algorithm, or its equivalent, is used to assign ranks.

                                                                                             Input: A noise source and corresponding statistical model with samples of the form X = a1a2…an,
                                                                                             where each ai is a bit.

                                                                                             Output: An ordered ranking of the bits a1 through an, based on the amount of entropy that each
                                                                                             bit is assumed to contribute to the noise source outputs.

                                                                                                   1. Set M = {a1, a2, …, an}.
                                                                                                 2. For i = 1 to n:
                                                                                                         a. Choose an output bit a from M such that no other bit in M is assumed to
                                                                                                             contribute more entropy to the noise source samples than a.
                                                                                                         b. Set the ranking of a to i.
                                                                                                         c. Remove a from M.
                                                                                             Given the ranking, n-bit samples are mapped to m-bit samples by simply taking the m-bits of
                                                                                             greatest rank in order (i.e., bit 1 of the m-bit string is the bit from an n-bit sample with rank 1, bit


                                                                                                                                               58
