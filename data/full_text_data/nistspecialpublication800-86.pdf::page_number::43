                                                         GUIDE TO INTEGRATING FORENSIC TECHNIQUES INTO INCIDENT RESPONSE



that the data being examined is not modified and that it will provide consistent results on successive runs.
As noted in Section 4.2.2, write-blockers can be used during this process to prevent writes from occurring
to the restored image. After restoring the backup (if needed), the analyst begins to examine the collected
data and performs an assessment of the relevant files and data by locating all files, including deleted files,
remnants of files in slack and free space, and hidden files. Next, the analyst may need to extract the data
from some or all of the files, which may be complicated by such measures as encryption and password
protection. This section describes the processes involved in examining files and data, as well as
techniques that can expedite examination.

4.3.1     Locating the Files

The first step in the examination is to locate the files. A disk image can capture many gigabytes of slack
space and free space, which could contain thousands of files and file fragments. Manually extracting data
from unused space can be a time-consuming and difficult process, because it requires knowledge of the
underlying filesystem format. Fortunately, several tools are available that can automate the process of
extracting data from unused space and saving it to data files, as well as recovering deleted files and files
within a recycling bin. Analysts can also display the contents of slack space with hex editors or special
slack recovery tools.

4.3.2     Extracting the Data

The rest of the examination process involves extracting data from some or all of the files. To make sense
of the contents of a file, an analyst needs to know what type of data the file contains. The intended
purpose of file extensions is to denote the nature of the file’s contents; for example, a jpg extension
indicates a graphic file, and an mp3 extension indicates a music file. However, users can assign any file
extension to any type of file, such as naming a text file mysong.mp3 or omitting a file extension. In
addition, some file extensions might be hidden or unsupported on other OSs. Therefore, analysts should
not assume that file extensions are accurate.

Analysts can more accurately identify the type of data stored in many files by looking at their file headers.
A file header contains identifying information about a file and possibly metadata that provides
information about the file’s contents. As shown in Figure 4-1, the file header contains a file signature that
identifies the type of data that particular file contains.50 The example in Figure 4-1 has a file header of FF
D8, which indicates that this is a JPEG file. A file header could be located in a file separate from the
actual file data. Another effective technique for identifying the type of data in a file is a simple histogram
showing the distribution of ASCII values as a percentage of total characters in a file. For example, a
spike in the ‘space’, ‘a’, and ‘e’ lines generally indicates a text file, while consistency across the
histogram indicates a compressed file. Other patterns are indicative of files that are encrypted or that
were modified through steganography.




50
     File headers can also indicate whether a file is encrypted. Attackers can alter file headers using a hex editor to conceal the
     actual file type, and then alter the file header back to use the file. In some cases, a file can be used even when its header is
     altered.


                                                                4-11
