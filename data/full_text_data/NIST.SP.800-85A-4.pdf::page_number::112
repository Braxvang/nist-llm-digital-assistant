NIST SP 800-85A-4                               PIV CARD APPLICATION & MIDDLEWARE
                                                         INTERFACE TEST GUIDELINES

                           5. Send GET DATA command with
                              • Data field of the command containing the tag
                                 of the Cardholder Fingerprints data object
                           6. Send VERIFY card command with
                              • P2, key reference value is set to '00'
                              • Data field of the command will contain the
                                 correct Global PIN value, NOT padded with 'FF'
                                 so that the total length of the field is less
                                 than 8 bytes
                           7. Send VERIFY card command with
                              • P2, key reference value is set to '00'
                              • Data field of the command will contain the
                                 correct Global PIN, padded with 'FF' to
                                 complete the total length of the value to 10
                                 bytes
                           8. Send VERIFY card command with
                              • P2, key reference value is set to '00'
                              • Data field of the command will contain the
                                 correct Global PIN value, padded to 8 bytes
                                 with 'FF' in byte 7 and 'AA' in byte 8
                           9. Send VERIFY card command with
                              • P2, key reference value is set to '00'
                              • Data field of the command will contain an
                                 arbitrary 6-digit Global PIN value where the
                                 first byte is 0x5A and all other non-padded
                                 bytes contain values limited to 0x30 – 0x39,
                                 padded with 'FF' to complete the total length
                                 of the value to 8 bytes
                           9a. Repeat step 9 five times with byte positions 2,
                               3, 4, 5, and 6 containing the 0x5A byte,
                               respectively.
                                   Note: It may be necessary send the VERIFY
                                   command with a correct Global PIN in order
                                   to prevent the retry counter from
                                   decrementing to zero.
                           10. Send VERIFY card command repeatedly until after
                               the issuer specified maximum number of PIN tries
                               is exceeded with
                              • P2, key reference value is set to '00'
                              • Data field of the command will contain an
                                 arbitrary, but correctly formatted, PIN value
                                 other than what is obtained from the vendor,
                                 padded with 'FF' to complete the total length
                                 of the value to 8 bytes
                    2c.   Test case for implementations that support OCC ('96'
                          and '97') for PIV data access and command execution.
                           1. Send VERIFY card command with
                              • P2, key reference value is set to '96'
                              • Data field of the command will contain a value
                                 that matches the Primary Finger OCC value
                           2. Send GET DATA command with
                              • Data field of the command containing the tag
                                 of the Printed Information data object




                                C-11
