NIST SP 800-58                                              Voice Over IP Security
_____________________________________________________________________________

         −   TLS
         −   HTTP Digest
         −   IPsec with IKE
         −   manually keyed IPsec without IKE
         −   S/MIME


 5.2.6.5 End-to-Middle, Middle-to-Middle, Middle-to-End Security

         Currently there are two drafts being discussed within the IETF dealing with end-
         to-middle, middle-to-middle and middle-to- end security: “End-to-middle
         Security in the Session Initiation Protocol (SIP)” [30] and “A Mechanism to
         Secure SIP information inserted by Intermediaries” [31]. The motivation for the
         End to Middle Security draft [30] stems from the need to enable intermediaries to
         use some of the SIP message header and body when end-to-end security is
         applied. Examples include logging services for enterprise use, firewall traversal,
         and transcoding (tailoring web pages for varying devices such as PDAs or cell
         phones). Intermediaries may not be able to trace the SIP message body for certain
         information (e.g., port numbers to be opened) if the body is encrypted. This draft
         is related to [31]. There is still a discussion about this draft within the SIPPING
         group.

         The second draft [31] aims at a mechanism to secure information inserted by
         intermediaries. This document came about to provide a more robust security
         solution for History-Info header, however, the intention is to provide an overall
         more robust security solution for SIP. Proxies sometimes have the need to read
         and/or modify a message body or header in a request. However, this is explicitly
         precluded by the SIP specification and is further complicated when a message
         body is protected with S/MIME. RFC 3261 is designed so that a proxy does not
         break integrity of the body.

         The security requirements between both approaches are slightly different, since
         information is added by intermediaries and used by intermediaries. Nevertheless,
         SIP End to Middle Security [30] and SIP Intermediate Security [31] share the
         same fundamental problems to be solved in SIP. It is anticipated that there will be
         further discussion on this item, as certain scenarios exist where this functionality
         is needed.


 5.2.7    SIP Security Issues

         The text encoding of SIP makes it easier to analyze using standard parsing tools
         such as Perl or lex and yacc. Still, some new requirements are placed on the
         firewall in a SIP-based VOIP network. First, firewalls must be stateful and
         monitor SIP traffic to determine which RTP ports are to be opened and made
         available to which addresses. This responsibility is similar to the task firewalls on



44
