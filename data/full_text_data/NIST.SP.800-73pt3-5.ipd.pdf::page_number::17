      NIST SP 800-73pt3-5 ipd (Initial Public Draft)                     Interfaces for Personal Identity Verification: Part 3
      September 2023                                                                                         PIV Client API

373   Prototype:       status_word pivLogIntoCardApplication(
374                             IN handle         cardHandle,
375                             IN sequence of byte               authenticators,
376                             IN LONG           AuthLength
377                            );
378   Parameters: cardHandle                                      Opaque identifier of the card to be acted upon as
379                                                               returned by pivConnect
380                    authenticators                             A sequence of zero or more BER-TLV-encoded
381                                                               authenticators to be used to authenticate and set
382                                                               the security state/status in the PIV Card
383                                                               Application context.
384                                                               The authenticator BER-TLV used on the PIV
385                                                               client API SHALL have the structure described
386                                                               in Table 3.
387                    AuthLength                                 Length of the authenticator template.
388                            Table 3. Data objects in an authenticator template (Tag '67')

                   Description              Tag        M/O                              Comment
               Reference data        '81'          M             Value of the PIV Card Application PIN, Global PIN, or
                                                                 pairing code, as described in Section 2.4.3 of SP 800-
                                                                 73-5 Part2, or OCC data, as described in Section 5.5.2
                                                                 of [SP800-76]
               Key reference         '83'          M             See Table 4 of SP 800-73-5 Part1 for PIV Card
                                                                 Application PIN, Global PIN, pairing code, and OCC
                                                                 key reference values

389   Return Codes:             PIV_OK
390                             PIV_INVALID_CARD_HANDLE
391                             PIV_AUTHENTICATOR_MALFORMED
392                             PIV_AUTHENTICATION_FAILURE
393                             PIV_SECURITY_CONDITIONS_NOT_SATISFIED
394                             PIV_CARD_READER_ERROR
395                             PIV_SM_FAILED

396   The PIV Middleware SHALL NOT submit authenticators to the PIV Card over a contactless
397   interface without secure messaging. If secure messaging has not been established, then the
398   pivLogIntoCardApplication function SHALL return
399   PIV_SECURITY_CONDITIONS_NOT_SATISFIED.


400   3.2.3.1.         pivGetData
401   Purpose:         Return the entire data content of the named data object.
402   Prototype:       status_word pivGetData(


                                                             9
