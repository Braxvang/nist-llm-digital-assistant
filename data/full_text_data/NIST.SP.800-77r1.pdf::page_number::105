                                                                                              NIST SP 800-77 REV. 1                                                                            GUIDE TO IPSEC VPNS


                                                                                              virtual network technologies, such as Virtual eXtensible LAN (VXLAN) and Generic Network
                                                                                              Virtualization Encapsulation (GENEVE).

                                                                                              MACsec can protect two machines via a switch even if the switch itself does not support
                                                                                              MACsec. However, if the switch supports MACsec, each individual Ethernet port of the switch
                                                                                              can become a node in the MACsec network for devices connected to those ports that do not
                                                                                              support MACsec natively. In that case, all traffic between this device and the LAN is encrypted,
                                                                                              except from the Ethernet port to the actual device.

                                                                                              The Ethernet packet change to support MACsec is similar to the change of an IP packet to
                                                                                              support IPsec. The Ethernet header is extended with the SecTAG header, which contains the
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              equivalent to the ESP SPI number and Sequence Number. This is followed by the (now
                                                                                              encrypted) original payload, followed by the ICV. 72 To a switch that does not support MACsec,
                                                                                              the SecTAG and ICV look like just part of the regular Ethernet frame payload.

                                                                                              Similar to IPsec, MACsec can be configured to use manual keying. It suffers from all of the
                                                                                              same problems as IPsec manual keying: no PFS and no protection from reusing the same
                                                                                              counters as nonces for AES-GCM.

                                                                                              8.2     Transport Layer VPN Protocols (SSL VPNs)

                                                                                              Transport layer VPNs are what people usually think of when describing a VPN. The host obtains
                                                                                              a new virtual interface configured with one or more IP addresses. Packets to and from this virtual
                                                                                              interface use a transport protocol to encapsulate the packets securely to the remote endpoint of
                                                                                              the VPN. The packets are then further routed, just like packets that arrived on a physical network
                                                                                              interface. The most common IPsec alternative is the SSL VPN. Although these are still called
                                                                                              SSL VPNs, they now use the TLS protocol rather than the older SSL protocol. This can be TLS
                                                                                              [21] based on TCP or DTLS [70] based on UDP. The advantage is that the SSL VPNâ€™s traffic is
                                                                                              much harder to block as it can run on any (preconfigured) port number. Usually, it is run over
                                                                                              port 443 (HTTPS) since most networks pass on this traffic without attempting any kind of deep
                                                                                              packet inspection. When using TCP, it can suffer from severe performance degradation due to
                                                                                              dueling TCP layers when there is congestion or packet loss; DTLS does not have this problem.
                                                                                              SSL VPNs are usually implemented as an application, resulting in significantly lower
                                                                                              performance compared to kernel-based VPNs, such as IPsec or WireGuard.

                                                                                              NIST provides specific guidance for SSL VPN deployments in NIST SP 800-113, Guide to SSL
                                                                                              VPNs [71].

                                                                                              8.2.1     Secure Socket Tunneling Protocol (SSTP)

                                                                                              Secure Socket Tunneling Protocol (SSTP) is the Microsoft version of an SSL VPN. It uses
                                                                                              SSL/TLS over port 443 and can use TCP or UDP as the underlying protocol. It uses the SSTP
                                                                                              protocol to run a Point-to-Point Protocol (PPP) session that handles the IP assignment and IP


                                                                                              72    In ESP, the ICV is only used for non-AEAD protocols. For AEAD protocols, such as AES-GCM, the ICV is implicit and
                                                                                                    generated from the IKE session and is not transmitted.



                                                                                                                                                          88
