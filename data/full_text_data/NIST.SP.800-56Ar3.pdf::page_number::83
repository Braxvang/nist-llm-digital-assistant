                                                                                               NIST SP 800-56A Rev. 3                              Recommendation for Pair-Wise Key Establishment
                                                                                                                                                           Using Discrete Logarithm Cryptography

                                                                                               performed by party V may be obtained by systematically replacing the letter “U” by “V”
                                                                                               (and vice versa) in the actions listed below. Note, however, that parties U and V must use
                                                                                               identical orderings of the bit strings that are input to the key-derivation method.
                                                                                               Party U shall execute the following actions to a) establish a shared secret value Z with party
                                                                                               V, and b) derive secret keying material from Z.
                                                                                               Actions: Party U generates a shared secret and derives secret keying material as follows:
                                                                                                  1. Generate an ephemeral key pair (rU, tU) from the domain parameters D as specified in
                                                                                                     Section 5.6.1.1. Send the public key tU to party V. Receive an ephemeral public key
                                                                                                     tV (purportedly) from party V. If tV is not received, destroy the ephemeral private key
                                                                                                     rU; then output an error indicator, and exit this process without performing the
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                                     remaining actions.
                                                                                                  2. Verify that tV is a valid ephemeral public key for the parameters D as specified in
                                                                                                     Section 5.6.2.3. If assurance of public key validity cannot be obtained, destroy the
                                                                                                     ephemeral private key rU; then output an error indicator, and exit this process without
                                                                                                     performing the remaining actions.
                                                                                                  3. Use the MQV2 form of the FFC MQV primitive in Section 5.7.2.1 to derive a shared
                                                                                                     secret Z from the set of domain parameters D, party U’s static private key xU, party
                                                                                                     V’s static public key yV, party U’s ephemeral private key rU, party U’s ephemeral
                                                                                                     public key tU, and party V’s ephemeral public key tV. If the call to the FFC MQV
                                                                                                     primitive outputs an error indicator, destroy the ephemeral private key rU, and destroy
                                                                                                     the results of all intermediate calculations used in the attempted computation of Z;
                                                                                                     then output an error indicator, and exit this process without performing the remaining
                                                                                                     actions.
                                                                                                  4. Use the agreed-upon key-derivation method to derive secret keying material with the
                                                                                                     specified length from the shared secret value Z and other input (see Section 5.8). If
                                                                                                     the key-derivation method outputs an error indicator, destroy all copies of Z and the
                                                                                                     ephemeral private key rU; then output an error indicator, and exit this process without
                                                                                                     performing the remaining actions.
                                                                                                  5. Destroy rU and all copies of the shared secret Z.
                                                                                                  6. Output the derived keying material.
                                                                                               Output: The derived keying material or an error indicator.
                                                                                               Note: Key confirmation can be incorporated into this scheme. See Section 6.1.1.5 for details.
                                                                                               MQV2 is summarized in Table 11.
                                                                                                                   Table 11: MQV2 key-agreement scheme summary

                                                                                                                                    Party U                               Party V

                                                                                                  Domain                D = (p, q, g{, SEED, counter})     D = (p, q, g{, SEED, counter})
                                                                                                  parameters


                                                                                                                                              72
