NIST SP 800-85A-4                                         PIV CARD APPLICATION & MIDDLEWARE
                                                                   INTERFACE TEST GUIDELINES

                                     value, and padded with 'FF' to complete the
                                     total length of the value to 8 bytes
                         2d. Test case for implementations that support the
                             pairing code ('98') as indicated by the Discovery
                             Object’s PIN Usage Policy
                               1. Send VERIFY card command with
                                  • P2, key reference value is set to '98'
                                  • Data field of the command will contain an 8
                                     byte random, but correctly formatted, pairing
                                     code value
                               2. Send GET DATA command with
                                  • Data field of the command containing the tag
                                     of the Card Capability Container
                               3. Send VERIFY card command with
                                  • P2, key reference value is set to '98'
                                  • Data field of the command will contain a short
                                     6-byte random pairing code value
                               4. Send GET DATA command with
                                  • Data field of the command containing the tag
                                     of the Card Capability Container
                               5. Send VERIFY command with
                                  • P2, key reference value is set to '98'
                                  • Data field of the command will contain an
                                     arbitrary pairing code with length of 10 bytes
                               6. Send GET DATA command with
                                  • Data field of the command containing the tag
                                     of the Card Capability Container
                               7. Send VERIFY card command with
                                  • P2, key reference value is set to '98'
                                  • Data field of the command will contain the
                                     correct 8 byte pairing code
                               8. Send GET DATA command with
                                  • Data field of the command containing the tag
                                     of the Card Capability Container
                               9. Reset the security status of the '98' key
                                  reference by sending the VERIFY command with
                                  • P2, key reference value is set to '98'
                                  • P1 parameter is 'FF' and both L c and the data
                                     field are absent
                               10. Send GET DATA command with
                                  • Data field of the command containing the tag
                                     of the Card Capability Container
 Expected Result(s)   1. The command returns either 1) the Discovery Object with the
                          status words '90 00' at the end or 2) '6A 82' (data object not found)
                          (verify that the return PIN Usage Policy matches that described
                          in vendor documentation.
                         2a:
                              1. The command returns an error status word.
                         2b:
                              1. The command returns an error status word.
                         2c:


                                      C-17
