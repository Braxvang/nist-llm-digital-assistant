                                NIST Special Publication 800-38D


8.1   Key Establishment

The following requirement, which is the norm for secret key cryptographic algorithms in general,
takes on explicit importance for GCM to support the uniqueness requirement in Sec. 8:

Any GCM key that is established among its intended users shall, with high probability, be
fresh.

In practice, the requirements in Sec. 5.1 should ensure that a key is fresh when it is generated, if
the generation mechanism is resistant to tampering. Achieving such resistance usually imposes
requirements on the management of the key generation mechanism.

In particular, if the key generation mechanism is deterministic, then the management of the
mechanism shall provide strong assurance that no outside entity can induce the repetition of a
previous set of inputs to the mechanism, or otherwise cause the repetition of a previous output.
For example, GCM keys may be established using the key derivation functions of the following
protocols as allowed in [9]: Transport Layer Security, Internet Key Exchange v1 and v2, and
Secure Shell.

Similarly, if a new key must be transported to its intended recipient(s), the method of
transport/distribution shall provide strong assurance against “replay,” so that no party can induce
the substitution of a previous key for the intended key.

GCM keys should be established within the framework of an approved key management
structure to assure their freshness, as well as their confidentiality and authenticity; the details of
such structures are outside the scope of this Recommendation.

8.2   IV Constructions

This Recommendation provides two frameworks for constructing IVs. The first construction,
described in Sec. 8.2.1, relies on deterministic elements to achieve the uniqueness requirement in
Sec. 8; the second construction, described in Sec. 8.2.2, relies on a sufficiently long output string
from an approved RBG with a sufficient security strength.

For any supported IV length that is strictly less than 96 bits, the construction in Sec. 8.2.1, shall
be used, across all instances of the authenticated encryption function with the given key.

For any supported IV length that is 96 bits or greater, exactly one of the constructions, but not
both, shall be used, across all instances of the authenticated encryption function with the given
key.

For example, suppose that an implementation supports IV lengths of 64 bits, 96 bits, 128 bits,
and 160 bits. For 64-bit IVs the only choice is the construction in Sec. 8.2.1. For the other three
IV lengths, one possible combination of choices is the construction in Sec. 8.2.1 for 96-bit IVs
and the construction in Sec. 8.2.2 for 128-bit and 160-bit IVs.




                                                 19
