                                                                                               NIST SP 800-56B REV. 2                            RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                      USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                                          used during the transaction, that same identifier shall be used as IDP or IDR,
                                                                                                          respectively, in the MacDataP used during key confirmation. For example, if party U
                                                                                                          is the key-confirmation recipient, and IDU has been used to label party U in the
                                                                                                          FixedInfo employed by the key-derivation method of a key-agreement scheme used
                                                                                                          during the transaction, then the MacDataP used during key confirmation shall have IDR
                                                                                                          = IDU.
                                                                                                  2. When a KAS1 or KAS2 key-agreement scheme is used: After computing the shared secret
                                                                                                     Z and applying the key-derivation function to obtain the derived keying material,
                                                                                                     DerivedKeyingMaterial (see Section 5.5), the KC provider uses agreed-upon bit lengths to
                                                                                                     parse DerivedKeyingMaterial into two parts, MacKey and KeyData:
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                                                         DerivedKeyingMaterial = MacKey || KeyData.
                                                                                                      When the KTS-OAEP key-transport scheme is used: The KC provider parses the
                                                                                                      TransportedKeyingMaterial into MacKey and KeyData:
                                                                                                                        TransportedKeyingMaterial = MacKey || KeyData.
                                                                                                   3. Using an agreed-upon bit length MacTagBits, the KC provider computes MacTagP (see
                                                                                                      Sections 5.2.1 and 5.6.3):
                                                                                                                        MacTagP = TMacTagBits[MAC (MacKey, MacDataP)],
                                                                                                      and sends it to the KC recipient.
                                                                                                   4. The KC recipient forms MacDataP, determines MacKey, computes MacTagP in the same
                                                                                                      manner as the KC provider, and then compares its computed MacTagP to the value received
                                                                                                      from the provider. If the received value is equal to the computed value, then the recipient
                                                                                                      is assured that the provider has used the same value for MacKey and that the provider shares
                                                                                                      the recipient’s value of MacTagP.
                                                                                               Each participant shall destroy all copies of the MacKey that was employed for key-confirmation
                                                                                               purposes during a particular pair-wise key-establishment transaction when MacKey is no longer
                                                                                               needed to provide or obtain key confirmation as part of that transaction.
                                                                                               If MacTagP cannot be verified by the KC recipient during a particular key-establishment
                                                                                               transaction, then key confirmation has failed, and both participants shall destroy all of their copies
                                                                                               of MacKey and KeyData. In particular, MacKey and KeyData shall not be revealed by either
                                                                                               participant to any other party (not even to the other participant), and the keying material shall not
                                                                                               be used for any further purpose. In the case of a key-confirmation failure, the key-establishment
                                                                                               transaction shall be terminated.
                                                                                                  Note: The key-confirmation routines employed by the KC provider and KC recipient shall
                                                                                                  destroy all local copies of MacKey, MacData, destroyable copies of KeyData and any other
                                                                                                  locally stored values used or produced during the execution of those routines. The destruction
                                                                                                  of those locally stored values shall occur prior to or during any exit from those routines –
                                                                                                  whether exiting normally or exiting early, because of an error.
                                                                                               Unilateral key confirmation, as specified in this Recommendation, can be incorporated into any
                                                                                               key-establishment scheme in which the key-confirmation provider is required to own a key-

                                                                                                                                                32
