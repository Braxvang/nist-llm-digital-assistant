                                                                                              NIST SP 800-77 REV. 1                                                                                 GUIDE TO IPSEC VPNS


                                                                                              size can have a significant impact on performance. In general, use larger key sizes for IPsec if
                                                                                              performance is not an issue. For ESP, the choice of algorithms for confidentiality and integrity
                                                                                              protection should also take performance into account. Using an AEAD algorithm that can
                                                                                              provide both confidentiality and integrity protection in a single operation, such as AES-GCM,
                                                                                              will give better performance than using non-AEAD algorithms that require separate operations
                                                                                              (e.g., AES-CBC for encryption and HMAC for integrity protection). It is important to estimate
                                                                                              the processing resources that the cryptographic computations will require during peak usage.

                                                                                              It is uncommon to use 192-bit AES keys, and this key length is optional in [25]. It is worth
                                                                                              mentioning as well that in the future, an adversary with a quantum computer may be able to
                                                                                              reduce the key strength of an AES key by a factor of two, in which case a 256-bit AES key may
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              effectively provide around 128 bits of security in the quantum computer world.

                                                                                              AES-GCM (an AEAD algorithm) is often offloaded to hardware, making it significantly faster
                                                                                              than AES-CBC (a non-AEAD algorithm) in combination with an HMAC. The CPU is typically
                                                                                              the hardware component most affected by cryptographic operations. In some cases, a hardware-
                                                                                              based cryptographic engine with a customized CPU (also known as a cryptographic accelerator)
                                                                                              may be needed for greater throughput, but this may limit the algorithm options. Another potential
                                                                                              issue is export restrictions involving the use of encryption algorithms in certain countries. 57 In
                                                                                              addition, some IPsec components may not provide support for a particular algorithm or key size.

                                                                                              For integrity checking of non-AEAD algorithms, most IPsec implementations offer HMAC-
                                                                                              SHA-1 or HMAC-SHA-2. Even though HMAC-SHA-1 is still a NIST-approved option, the
                                                                                              HMAC-SHA-2 algorithms are recommended because they have stronger security than HMAC-
                                                                                              SHA-1. HMAC-MD5 has never been a NIST-approved algorithm and shall not be used.

                                                                                              In some implementations of IPsec, the cryptographic policy settings are not immediately
                                                                                              apparent to administrators. The default settings for encryption and integrity protection, as well as
                                                                                              the details of each setting, are hidden in separate menus that are harder to access or are split
                                                                                              among multiple locations. It is also challenging with some implementations to alter the settings
                                                                                              once they have been located. For example, by having portions of the settings in multiple
                                                                                              locations, administrators may need to go back and forth between different configuration screens
                                                                                              to ensure that the settings are correct and consistent.

                                                                                              7.2.4    High Speed and Large Server Considerations

                                                                                              While network devices such as routers and firewalls will already be optimized for network
                                                                                              performance, generic operating systems will require tuning for optimized network performance.
                                                                                              Enough RAM should be made available to the network stack. CPU power saving and throttling
                                                                                              should be disabled, and on non-uniform memory access (NUMA) systems, further optimizations
                                                                                              might be possible. Consult the hardware vendor for specific instructions.




                                                                                              57   More information on export restrictions is available from the Bureau of Industry and Security, U.S. Department of
                                                                                                   Commerce, at https://www.bis.doc.gov/index.php/policy-guidance/encryption.



                                                                                                                                                            70
