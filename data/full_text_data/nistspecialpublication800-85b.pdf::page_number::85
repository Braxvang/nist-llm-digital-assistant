Special Publication 800-85B                                   PIV Data Model Testing Specification


Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<CHUID (2.16.840.1.101.3.7.2.48.0)>>
                      3. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      4. Extract the SignerInfo->digestAlgorithm field contents
                          from the asymmetric digital signature of the CHUID
                      5. Extract the expiration date value from the CHUID (i.e.
                          Tag 0x35)
                      6. Extract the certificates field contents from the
                          asymmetric signature of the CHUID
                      7. From the certificate obtained, extract the
                          subjectPublicKeyInfo->subjectPublicKey
                      8. Compute the size of the signer’s public key
                      9. Match the digest algorithm with the Table 3-3 of SP80078
                          based on the card expiration date, and the public key
                          algorithm and size used to sign the CHUID
                      10. Extract the digestAlgorithms field contents from the
                          asymmetric digital signature of the CHUID i.e.
                          SignedData
Expected              The digestAlgorithm field value of the SignerInfo is in accordance with
Result(s)             Table 3-3 of SP80078 and it matches the value present in the
                      digestAlgorithms field of the SignedData.


10.1.1.9 Verify message digest signed attribute in SignerInfo

Purpose               Confirms that the signedAttrs of the SignerInfo includes a message digest
                      attribute containing the hash computed over the concatenated contents of
                      the CHUID, excluding the asymmetric signature field.
Reference(s)          1.      FIPS201, Section 4.2.2
                      2.      AS06.01.12
Precondition          1.      A valid PIV card is inserted into the contact reader.
                      2.      A valid PC/SC connection exists between the test application and the
                              contact reader.
                      3.      The test application is currently connected to the card application
                              which is accessible through card handle.
                      4.      A valid CHUID is present on the PIV card.
Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<CHUID (2.16.840.1.101.3.7.2.48.0)>>
                      3. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      4. Parse the SignerInfo-> signedAttrs field contents from
                         the asymmetric signature field of the CHUID to locate
                         the message digest attribute (OID=1.2.840.113549.1.9.4)
                         and its corresponding attribute value


                                                                                                     Page 77
