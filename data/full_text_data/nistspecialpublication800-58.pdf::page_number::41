NIST SP 800-58                                              Voice Over IP Security
_____________________________________________________________________________

         endpoint) are performed using the gatekeeper for address resolution. Since
         endpoints do not possess a shared secret from scratch, a Kerberos-like approach is
         taken to establish a shared secret between the communicating endpoints. This is
         done using the admission phase from the calling endpoint and the call signaling
         between the calling and the called endpoint. The gatekeeper serves in this
         scenario also as the key distribution center (KDC), issuing two “tickets” (tokens),
         one containing the key material secured with the caller’s encryption key and the
         other one secured with the called party encryption key. The encryption keys are
         derived from the shared secret between the caller and the gatekeeper using a
         pseudo random function (PRF), which is also defined by H.235 Annex I. The PRF
         is basically the same as used in TLS

         The gatekeeper also generates a session key, which is applicable for the
         communication between the two endpoints involved in the call, and encrypts this
         key material using the previously derived encryption keys. The encrypted session
         keys are then transmitted back to the caller. The caller uses the encrypted session
         key destined to him, the other one is sent to the called party as part of the SETUP
         message.

         The messages exchanged between the gatekeeper and the calling endpoint
         carrying the tickets are secured with either the H.235 Annex D (section 4.2.1.1) or
         with H.235 Annex F (4.2.1.4). The shared secret established via the “ticket”
         (token) exchange between caller and callee may be used in subsequent direct
         messages to provide an integrity protection according to H.235 Annex D.

 4.2.3    H.323 Annex J

         H.323 Annex J describes security for simple endpoint types, which are defined by
         H.323 Annex F. This profile relies on the Baseline Security Profile described in
         section 4.2.1.1.


 4.2.4    H.323 Security Issues

         Firewalls pose particularly difficult problems for VOIP networks using H.323.
         With the exception of the “Q.931-like” H.225, all H.323 traffic is routed through
         dynamic ports. For H.323 Fast Start and H.245 tunneling just one channel (H.225
         Call Signaling) is used. Usually the call signaling is performed via port 1720. If
         additionally H.225 RAS communication is done with the gatekeeper (UDP), this
         is done via port 1719. That is, each successive channel in the protocol is routed
         through a port dynamically determined by its predecessor. This ad-hoc method of
         securing channels does not lend itself well to a static firewall configuration. This
         is particularly true in the case of stateless firewalls that cannot comprehend H.323
         traffic. These simple packet filters cannot correlate UDP transmissions and
         replies. This necessitates punching holes in the firewall to allow H.323 traffic to
         traverse the security bridge on any of the ephemeral ports it might use. This
         practice would introduce serious security weaknesses because such an


36
