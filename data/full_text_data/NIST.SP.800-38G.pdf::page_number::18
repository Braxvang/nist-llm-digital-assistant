NIST SP 800-38G                                           METHODS FOR FORMAT-PRESERVING ENCRYPTION



Algorithm 4: REV(X )

Input:
Numeral string, X.

Output:
Numeral string, Y.

Steps:
1.    For i from 1 to LEN(X), let Y [i] = X [LEN(X) + 1 – i].
2.    Return Y [1 .. LEN(X)].


Algorithm 5: REVB(X)

Input:
Byte string, X, represented in bits.

Output:
Byte string, Y, represented in bits.

Steps:
1.    For i from 0 to BYTELEN(X) – 1 and j from 1 to 8, let Y [8i + j] = X [8 ⋅ (BYTELEN(X) – 1– i) + j].
2.    Return Y [1 .. 8 ⋅ BYTELEN(X)].


Algorithm 6: PRF(X)

Prerequisites:
Designated cipher function, CIPH, of an approved 128-bit block cipher;
Key, K, for the block cipher.

Input:
Block string, X.

Output:
Block, Y.

Steps:
1.    Let m = LEN(X)/128.
2.    Let X1, …, Xm be the blocks for which X = X1 || … || Xm.
3.    Let Y0 = 0128, and for j from 1 to m let Yj = CIPHK (Yj–1 ⊕ Xj).
4.    Return Ym.




                                                   13
