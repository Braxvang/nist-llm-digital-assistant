                                                                              GUIDE TO SECURE WEB SERVICES



A.5 Denial of Service Attacks

A direct attack on availability, a DoS attack prevents the service provider from receiving or responding to
messages from a requester. Because Web service interfaces are heterogeneous, it takes knowledge about
the underlying Web service applications to protect them against DoS attacks. For example, a Web service
that provides simple query responses might be able to handle 1,000 requests per second, while a financial
system made up of a series or collection of services that collaboratively perform complex financial
transactions might only be able to handle five requests per hour because of the complexity of the series of
calculations involved. While sending ten requests per hour to the query application would not degrade its
performance at all, intentionally sending ten requests per hour to a financial system that is known or
suspected to be incapable of handling such a load would constitute a DoS attack.

DoS attacks such as these would not be detected by a firewall or an intrusion detection system (IDS),
mainly because these countermeasures do not provide the granularity necessary to control DoS on a per-
transaction/operation basis, and also because these countermeasures tend to be either entry-point or per-
host specific. Without sophisticated collection, correlation, and analysis tools, they will not be able to
detect DoS attacks specifically launched against a series of services. Only an understanding of real-world
usage can prepare the administrator to compile profile information on each Web service so that
countermeasures can be correctly selected and configured to protect each service from DoS attacks.

Two competing standards to support reliable Web service messaging are available. The OASIS WS-
Reliability standard was released in November 2004, while the BEA, IBM, Microsoft, and TIBCO WS-
ReliableMessaging standard was released in February 2005. Both standards provide a mechanism to
guarantee that messages are sent and received in a SOA. What is lacking are standards that define how
Web services should react to DoS and how QoS should be handled within a SOA. There are standards for
QoS and techniques for handling DoS in lower layer protocols like IP, but SOAP messages can be
transmitted in multiple IP packets, requiring standards and techniques specifically for Web services.
Increasingly, XML gateways are being used to augment widely accepted techniques because they are
capable of detecting and preventing XML-based DoS.

A.5.1     Flooding Attacks

Flooding attacks most often involve copying valid service requests and resending them to a provider. The
attacker may issue repetitive SOAP/XML messages in an attempt to overload the Web service. This type
of activity may not be detected as an intrusion because the source IP address will be valid, the network
packet behavior will be valid, and the SOAP/XML message will be well-formed. The business behavior
will not be legitimate and constitutes a DoS attack.

Techniques for detecting and handling DoS can be applied against flooding attacks. In some ways,
flooding attacks against Web services are easier to detect than those against Web applications, because
Web service payload information is more readily available. With the right tools, message traffic patterns
indicating possible DoS attacks can be detected even when the same or similar payload is being sent via
multiple communications protocols (e.g., HTTP, HTTPS, SMTP, or across different physical or logical
interfaces).

A.5.2     Recursive Payloads Sent to XML Parsers

One of the strengths of XML is its ability to nest elements within a document to address the need for
complex relationships among elements. XML is valuable for forms that have a form name or purpose that
contains many different value elements, such as a purchase order that incorporates shipping and billing
addresses as well as various items and quantities ordered. We can intuitively acknowledge the value of



                                                   A-8
