                               NIST SP 800-135, Revision 1




K1 = HASH (K || H || X || session_id), where session_id 7 is a unique identifier for a
     SSH connection.
K2 = HASH (K || H || K1)
K3 = HASH (K || H || K1 || K2)
………………
KN = HASH (K || H || K1 || K2 ||…|| K(N-1))

KEY = the L left most bits of (K1 || K2 ||…. KN)



Figure 4 below shows the accumulative and feedback operation of the KDF.



                                       K || H || X || session_id             K1




                                               K || H || K1
                                                                               K2




                                            K || H || K1|| K2
                                       .
                                       .                                            K(N‐1)
                                       .                ...


                                       K || H || K1|| K2||…|K(N‐1)                   KN


                             KEY = L left most bits of (K1 || K2 ||…K(N-1)|| KN)


                                      Figure 4: SSH KDF


Each box in Figure 4 represents a hash function computation. The variables in the box
are input to the hash function. The arrow (  ) indicates an output from the hash
function.

7
 session_id is actually H from the first key exchange and remains unchanged for the whole
connection. However, K and H will be changed when a key re-exchange is performed, see Section 9 of
RFC 4253.


                                                   14
