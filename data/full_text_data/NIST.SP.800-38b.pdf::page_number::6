                                                                                             NIST SP 800-38B                                                               BLOCK CIPHER MODES:
                                                                                                                                                                   CMAC MODE FOR AUTHENTICATION



                                                                                             1   Purpose

                                                                                             This publication is the second Part in a series of Recommendations regarding modes of operation
                                                                                             of symmetric key block ciphers.

                                                                                             2   Conformance Testing


                                                                                             Conformance testing for implementations of the mode of operation that is specified in this Part of
                                                                                             the Recommendation will be conducted within the framework of the Cryptographic Module
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-38B




                                                                                             Validation Program (CMVP), a joint effort of NIST and the Communications Security
                                                                                             Establishment of the Government of Canada. An implementation of a mode of operation must
                                                                                             adhere to the requirements in this Recommendation in order to be validated under the CMVP. The
                                                                                             requirements of this Recommendation are indicated by the word “shall.”

                                                                                             3   Introduction

                                                                                             This Recommendation specifies a message authentication code (MAC) algorithm that is based on
                                                                                             a symmetric key block cipher. This cipher-based MAC is abbreviated CMAC, analogous to the
                                                                                             abbreviation for the hash function-based MAC, HMAC, that is standardized in FIPS Pub. 198 [4].
                                                                                             CMAC may be appropriate for information systems in which an approved block cipher is more
                                                                                             readily available than an approved hash function.

                                                                                             The basic Cipher Block Chaining MAC algorithm (CBC-MAC) has security deficiencies [9]. The
                                                                                             core of the CMAC algorithm is a variation of CBC-MAC that Black and Rogaway proposed and
                                                                                             analyzed under the name XCBC in Ref. [2] and submitted to NIST in Ref. [1]. The XCBC
                                                                                             algorithm efficiently addresses the security deficiencies of CBC-MAC. Iwata and Kurosawa
                                                                                             proposed an improvement of XCBC and named the resulting algorithm One-Key CBC-MAC
                                                                                             (OMAC) in Ref. [6] and in Ref. [5], their initial submission to NIST; they later submitted OMAC1
                                                                                             [7], a refinement of OMAC, and additional security analysis [8]. The OMAC1 variation efficiently
                                                                                             reduces the key size of XCBC. CMAC is equivalent to OMAC1.

                                                                                             Because CMAC is based on an approved symmetric key block cipher, such as the Advanced
                                                                                             Encryption Standard (AES) algorithm that is specified in Federal Information Processing Standard
                                                                                             (FIPS) Pub. 197 [3], CMAC can be considered a mode of operation of the block cipher. CMAC
                                                                                             is also an approved mode of the Triple Data Encryption Algorithm (TDEA) [10]; however, as
                                                                                             discussed in Appendix B, the recommended default message span for TDEA is much more
                                                                                             restrictive than for the AES algorithm, due to the smaller block size of TDEA.

                                                                                             CMAC, like any well-designed MAC algorithm, provides stronger assurance of data integrity than
                                                                                             a checksum or an error detecting code. The verification of a checksum or an error detecting code
                                                                                             is designed to detect only accidental modifications of the data, while CMAC is designed to detect
                                                                                             intentional, unauthorized modifications of the data, as well as accidental modifications.



                                                                                                                                             1
