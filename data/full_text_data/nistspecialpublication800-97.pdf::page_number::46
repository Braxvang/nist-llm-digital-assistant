ESTABLISHING WIRELESS ROBUST SECURITY NETWORKS: A GUIDE TO IEEE 802.11I



destination. The TKIP encapsulation process also involves encrypting the MIC using WEP, which helps
to hide information about the 64-bit MIC key.

4.3.1.2 TKIP Decapsulation and Countermeasures

Decapsulation is the process to recover the content of protected frames—that is, to decrypt a received
ciphertext packet. During decapsulation, various checks are performed on the frames. For example, if the
TSC indicates a violation of proper frame sequencing (it should be monotonically increasing), the frame
is discarded. Also, the MIC is recomputed and compared with the MIC in the packet; if they do not
match, the frame is discarded and TKIP countermeasures are invoked, which serve as a TKIP safety net.

Although the Michael MIC offers increased message integrity protection in comparison with the legacy
WEP and its use of an encrypted CRC, Michael is much weaker than what is usually required. Its
objective is to provide reasonable levels of integrity assurance on pre-RSNA-compliant devices without
requiring hardware upgrades. Michael is subject to a 229 differential cryptanalysis attack, meaning an
attacker could expect to create a forgery in about 228 messages on average. Since the Michael MIC has
known vulnerabilities, any failure of the message integrity check in TKIP represents a probable active
attack. Therefore, TKIP employs additional countermeasures to help thwart these attacks. These
countermeasures accomplish the following security goals: 42

      Logging security events. MIC failures during decapsulation at the STA or AP likely mean an
       active attack. These are to be logged, and a system or security administrator should investigate.
      Limiting MIC failures. A receiving STA or AP that detects two failures within a 60-second
       period disables reception for 60 seconds, not allowing any new associations for STAs using
       TKIP. This suspense mechanism thwarts an adversary’s attempts at numerous attacks in a short
       period, limiting what an active attacker can learn about any Michael key. The countermeasures
       effectively limit the adversary to random guessing attacks.
      Changing the PTK and GTK. Temporal keys are erased and must be re-initialized.
      Blocking the IEEE 802.1X ports. If IEEE 802.1X authentication is used, the state machine is
       initialized, thereby blocking the controlled ports.
4.3.2     Counter Mode with Cipher Block Chaining MAC Protocol (CCMP)

CCMP is the second data confidentiality and integrity protocol that may be negotiated as a cipher suite for
the protection of user traffic in an RSNA. Like TKIP, CCMP was developed to address all known
inadequacies of WEP; however, CCMP was developed without the constraint of requiring the use of
existing hardware. CCMP is considered the long-term solution for the creation of RSNs for WLANs. It
is mandatory for RSN compliance.

CCMP is based on CCM, a generic authenticated encryption block cipher mode of AES. 43 CCM is a
mode of operation defined for any block cipher with a 128-bit block size. CCM combines two well-
known and proven cryptographic techniques to achieve robust security. First, CCM uses CTR for
confidentiality and Cipher Block Chaining MAC (CBC-MAC) for both authentication and integrity
protection. CCMP protects the integrity of both the packet data and portions of the IEEE 802.11 header.
CCM for IEEE 802.11 employs a single 128-bit session key (TK) to protect the duplex data channel. The

42
     The existence of the countermeasures, which include temporary termination of service, enables an attacker to perform a
     denial of service attack by generating MIC errors. In this case, TKIP preserves integrity at the expense of availability.
43
     CCM is defined by RFC 3610, Counter with CBC-MAC (CCM) (http://www.ietf.org/rfc/rfc3610.txt). AES is defined by
     FIPS PUB 197 (http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf).


                                                              4-10
