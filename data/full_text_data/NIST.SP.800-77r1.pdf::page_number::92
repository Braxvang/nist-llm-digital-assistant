                                                                                              NIST SP 800-77 REV. 1                                                         GUIDE TO IPSEC VPNS


                                                                                              ICMP error messages are often generated by an intermediate host such as a router, not by a
                                                                                              tunnel endpoint; because the source IP address of the error message is the intermediate host’s
                                                                                              address, these ICMP packets do not have confidentiality or integrity protection, and the receiving
                                                                                              host cannot make security policy decisions based on unprotected packets. Packet filters should be
                                                                                              configured to not apply IPsec protection to types of traffic that are incompatible with IPsec;
                                                                                              rather, they should let the traffic pass through unprotected if that does not compromise security.
                                                                                              If the IPsec gateway cannot block broadcasts and other traffic that should not be passed through
                                                                                              it, it may also be effective to configure firewalls or routers near the IPsec gateway to block that
                                                                                              particular type of traffic.

                                                                                              7.2.6   Other Design Considerations
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              A particularly important consideration in design decisions is the identification and
                                                                                              implementation of other security controls. Organizations should have other security controls in
                                                                                              place that support and complement the IPsec implementation. For example, organizations should
                                                                                              configure packet filtering devices (e.g., firewalls, routers) to restrict direct access to IPsec
                                                                                              gateways. Organizations should have policies in place regarding the acceptable use of IPsec
                                                                                              connections and software. Organizations may also set minimum security standards for IPsec
                                                                                              endpoints, such as mandatory host hardening measures and patch levels, and specify security
                                                                                              controls that must be employed by every endpoint.

                                                                                              For endpoints outside of the organization’s control—such as systems belonging to business
                                                                                              partners, users’ home computers, and public internet access networks—organizations should
                                                                                              recognize that some of the endpoints might violate the organization’s minimum security
                                                                                              standards. For example, some of these external endpoints might be compromised by malware
                                                                                              and other threats; malicious activity could then enter the organization’s networks from the
                                                                                              endpoints through their IPsec connections. To minimize risk, organizations should restrict the
                                                                                              access provided to external endpoints as much as possible and also ensure that policies,
                                                                                              processes, and technologies are in place to detect and respond to suspicious activity.
                                                                                              Organizations should be prepared to identify users or endpoint devices of interest and disable
                                                                                              their IPsec access rapidly as needed.

                                                                                              IPsec packet filters can be helpful in limiting external IPsec endpoints’ access to the
                                                                                              organization. Using packet filters to limit acceptable traffic to the minimum necessary for
                                                                                              untrusted hosts, in addition to other network security measures (e.g., firewall rulesets, router
                                                                                              access control lists), should be effective in preventing certain types of malicious activity from
                                                                                              reaching their targets. Administrators may also need to temporarily suspend access for infected
                                                                                              hosts until appropriate host security measures (e.g., antivirus software update, patch deployment)
                                                                                              have resolved any infection-related issues. Another option in some environments is to
                                                                                              automatically quarantine each remote host that establishes an IPsec connection, checking its host
                                                                                              security control settings and then deciding if it should be permitted to use the organization’s
                                                                                              networks and resources. It is advisable to perform these checks, not only for hosts connecting to
                                                                                              the organization’s VPN from external locations but also for mobile systems connecting to the
                                                                                              organization’s internal network that are also sometimes connected to external networks.




                                                                                                                                              75
