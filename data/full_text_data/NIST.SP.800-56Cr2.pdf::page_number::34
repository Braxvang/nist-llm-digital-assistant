                                                                                               NIST SP 800-56C REV. 2                                 RECOMMENDATION FOR KEY DERIVATION METHODS
                                                                                                                                                                   IN KEY ESTABLISHMENT SCHEMES


                                                                                               7       Selecting Hash Functions and MAC Algorithms

                                                                                               The key-derivation methods specified in this Recommendation, as well as those enumerated in [SP
                                                                                               800-135], use hash functions and/or message authentication code (MAC) algorithms as auxiliary
                                                                                               functions. In particular:
                                                                                                   •    The one-step key-derivation functions that are specified in Section 4.1 of this
                                                                                                        Recommendation employ an appropriate choice of hash function (hash), an HMAC
                                                                                                        algorithm based on an appropriate choice of hash function (HMAC-hash), or one of two
                                                                                                        KMAC variants (KMAC128 or KMAC256) to implement the auxiliary function H.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Cr2




                                                                                                   •    The extraction-then-expansion key-derivation procedure specified in Section 5.1 employs
                                                                                                        either an HMAC algorithm based on an appropriate choice of hash function (HMAC-hash)
                                                                                                        for both randomness extraction and key expansion or an appropriate variant of the AES-
                                                                                                        CMAC algorithm (i.e., AES-N-CMAC for N = 128, 192, or 256) for randomness extraction
                                                                                                        together with AES-128-CMAC for key expansion.

                                                                                               Unless explicitly stated to the contrary (e.g., in [SP 800-135]), the following requirements apply to
                                                                                               the hash functions and MAC algorithms employed for key derivation:
                                                                                                   •   Whenever a hash function is employed (including as the primitive used by HMAC), an
                                                                                                       approved hash function shall be used. [FIPS 180] and [FIPS 202] specify approved hash
                                                                                                       functions.
                                                                                                   •   Whenever an HMAC algorithm is employed, the HMAC implementation shall conform to
                                                                                                       the specifications found in [FIPS 198].
                                                                                                   •   Whenever a KMAC variant (KMAC128 or KMAC256) is employed, the KMAC
                                                                                                       implementation shall conform to the specifications found in [SP 800-185].
                                                                                                   •   Whenever an AES-CMAC algorithm is employed, the implementation of AES shall
                                                                                                       conform to [FIPS 197], and the AES-CMAC implementation shall conform to [SP 800-
                                                                                                       38B].

                                                                                               As specified in [SP 800-56A] and [SP 800-56B], an approved key-establishment scheme can be
                                                                                               implemented with parameters of various types and sizes that will impact the estimated maximum
                                                                                               security strength that can be supported by the resulting scheme. When a key-establishment scheme
                                                                                               employs a choice of parameters that are associated with a targeted security strength of s bits, the
                                                                                               selection of a hash function, HMAC, KMAC, or AES-CMAC employed during the implementation
                                                                                               of its key-derivation method shall conform to the following restrictions:
                                                                                                   •   An approved hash function shall be employed (whether alone or as the primitive used by
                                                                                                       HMAC) in the implementation of a one-step or two-step key-derivation method only if its
                                                                                                       output block length (in bits) is greater than or equal to s.
                                                                                                   •   For the purposes of implementing one-step key derivation only: KMAC128 shall be
                                                                                                       employed only in instances where s is 128 bits or less. KMAC256 shall be employed only
                                                                                                       in instances where s is 256 bits or less. (However, see the note below.)



                                                                                                                                                26
