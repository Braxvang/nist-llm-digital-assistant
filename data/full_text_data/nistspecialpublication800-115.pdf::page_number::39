                                                          TECHNICAL GUIDE TO INFORMATION SECURITY TESTING AND ASSESSMENT



      Insufficient Input Validation. Many applications fail to fully validate the input they receive
       from users. An example is a Web application that embeds a value from a user in a database
       query. If the user enters SQL commands instead of or in addition to the requested value, and the
       Web application does not filter the SQL commands, the query may be run with malicious changes
       that the user requested—causing what is known as a SQL injection attack.
      Symbolic Links. A symbolic link (symlink) is a file that points to another file. Operating
       systems include programs that can change the permissions granted to a file. If these programs run
       with privileged permissions, a user could strategically create symlinks to trick these programs
       into modifying or listing critical system files.
      File Descriptor Attacks. File descriptors are numbers used by the system to keep track of files
       in lieu of filenames. Specific types of file descriptors have implied uses. When a privileged
       program assigns an inappropriate file descriptor, it exposes that file to compromise.
      Race Conditions. Race conditions can occur during the time a program or process has entered
       into a privileged mode. A user can time an attack to take advantage of elevated privileges while
       the program or process is still in the privileged mode.
      Incorrect File and Directory Permissions. File and directory permissions control the access
       assigned to users and processes. Poor permissions could allow many types of attacks, including
       the reading or writing of password files or additions to the list of trusted remote hosts.
The reporting phase occurs simultaneously with the other three phases of the penetration test (see Figure
5-1). In the planning phase, the assessment plan—or ROE—is developed. In the discovery and attack
phases, written logs are usually kept and periodic reports are made to system administrators and/or
management. At the conclusion of the test, a report is generally developed to describe identified
vulnerabilities, present a risk rating, and give guidance on how to mitigate the discovered weaknesses.
Section 8 discusses post-testing activities such as reporting in more detail.

5.2.2     Penetration Testing Logistics

Penetration test scenarios should focus on locating and targeting exploitable defects in the design and
implementation of an application, system, or network. Tests should reproduce both the most likely and
most damaging attack patterns—including worst-case scenarios such as malicious actions by
administrators. Since a penetration test scenario can be designed to simulate an inside attack, an outside
attack, or both, external and internal security testing methods are considered. If both internal and external
testing is to be performed, the external testing usually occurs first.

Outsider scenarios simulate the outsider-attacker who has little or no specific knowledge of the target and
who works entirely from assumptions. To simulate an external attack, testers are provided with no real
information about the target environment other than targeted IP addresses or address ranges, 20 and
perform open source research by collecting information on the targets from public Web pages,
newsgroups, and similar sites. Port scanners and vulnerability scanners are then used to identify target
hosts. Since the testers’ traffic usually goes through a firewall, the amount of information obtained from
scanning is far less than if the test were undertaken from an insider perspective. After identifying hosts
on the network that can be reached from outside, testers attempt to compromise one of the hosts. If
successful, this access may then be used to compromise other hosts that are not generally accessible from


20
     If given a list of authorized IP addresses to use as targets, assessors should verify that all public addresses (i.e., not private,
     unroutable addresses) are under the organization’s purview before testing begins. Web sites that provide domain name
     registration information (e.g., WHOIS) can be used to determine owners of address spaces.


                                                                  5-5
