                                                                    GUIDELINES ON SECURING PUBLIC WEB SERVERS



 Installing Web content on a different hard drive or logical partition than the OS and Web server
  application.

 Placing a limit on the amount of hard drive space that is dedicated for uploads, if uploads to the Web
  server are allowed. Ideally, uploads should be placed on a separate partition to provide stronger
  assurance that the hard drive limit cannot be exceeded.

 If uploads are allowed to the Web server, ensuring that these files are not readable by the Web server
  until after some automated or manual review process is used to screen them. This measure prevents
  the Web server from being used to propagate malware or traffic pirated software, attack tools,
  pornography, etc. It is also possible to limit the size of each uploaded file, which could limit the
  potential effects of a DoS attack involving uploading many large files.

 Ensuring that log files are stored in a location that is sized appropriately. Ideally, log files should be
  stored on a separate partition. If an attack causes the size of the log files to increase beyond
  acceptable limits, a physical partition helps ensure the Web server has enough resources to handle the
  situation appropriately.

 Configuring the maximum number of Web server processes and/or network connections that the Web
  server should allow.

To some degree, these actions protect against attacks that attempt to fill the file system on the Web server
host OS with extraneous and incorrect information that may cause the system to crash. Logging
information generated by the Web server host OS may help in recognizing such attacks. As discussed in
Section 9.1, administrators should store Web server logs on centralized logging servers whenever possible
and also store logs locally if feasible. If an attack causes the Web server to be compromised, the attacker
could modify or erase locally stored logs to conceal information on the attack. Maintaining a copy of the
logs on a centralized logging server gives administrators more information to use when investigating such
a compromise.

In addition to the controls mentioned above, it is often necessary to configure timeouts and other controls
to further reduce the impact of certain DoS attacks. One type of DoS attack takes advantage of the
practical limits on simultaneous network connections by quickly establishing connections up to the
maximum permitted, such that no new legitimate users can gain access. By setting network connection
timeouts (the time after which an inactive connection is dropped) to a minimum acceptable time limit,
established connections will time out as quickly as possible, opening up new connections to legitimate
users. This measure only mitigates the effects; it does not defeat the attack.

If the maximum number of open connections (or connections that are half-openâ€”that is, the first part of
the TCP handshake was successful) is set to a low number, an attacker can easily consume the available
connections with illegitimate requests (often called a SYN flood). Setting the maximum to a much higher
number may mitigate the effect of such an attack, but at the expense of consuming additional resources.
Note that this is only an issue for Web servers that are not protected by a firewall that stops SYN flood
attacks. Most enterprise-level firewalls protect Web servers from SYN floods by intercepting them
before they reach the Web servers.

5.2.2   Configuring Secure Web Content Directory

Do not use links, aliases, or shortcuts in the public Web content file directory tree that point to directories
or files elsewhere on the server host or the network file system. If possible, disable the ability of the Web




                                                      5-4
