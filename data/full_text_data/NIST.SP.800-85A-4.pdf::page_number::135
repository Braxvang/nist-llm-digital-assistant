NIST SP 800-85A-4                                                                 PIV CARD APPLICATION & MIDDLEWARE
                                                                                           INTERFACE TEST GUIDELINES

                                     •  P1, algorithm reference, is set to '27' or '2E', as
                                        indicated by the 0xAC tag obtained from the application
                                        property template in step 1
                                      • P2, key reference, is set to '04' indicating the PIV
                                        Secure Messaging key
 Expected Result(s)             1. Command returns the application property template with the
                                    status word '90 00' at the end.
                                2. The command returns '90 00'
                                3. The command returns the signed challenge with '90 00' at the
                                    end. Verify the signed challenge.
                                4. The command returns the encrypted challenge with '90 00' at the
                                    end. Decrypt the encrypted challenge and compare it to the one
                                    sent to the card.
                                5a. The PIV Card Application returns with the encryption of a
                                    challenge followed by '90 00'.
                                5b. The PIV Card Application verifies the witness and then responds
                                    with encryption of the challenge sent by Test Toolkit Application
                                    followed by '90 00'. Decrypt the encrypted challenge and compare
                                    it to the one sent to the card.
                                6a. The PIV Card Application returns a challenge followed by '90 00'.
                                6b. The Test Toolkit Application responds with encryption of the
                                    challenge sent by PIV Card Application and the card returns '90
                                    00'.
                                7a. The command returns the signed data with '90 00' at the end.
                                    Verify the signature using the public key from the digital
                                    signature certificate and the hash sent to the card.
                                7b. The command returns '69 82' (security status not satisfied).
                                8. For algorithm reference '07' as P1 value, the command returns the
                                    transported key with '90 00' at the end. Compare the plaintext key
                                    to the one received in the response from the card. For algorithm
                                    reference '11' or '14' as P1 value, the command returns the shared
                                    secret Z 10 with '90 00' at the end. Compare the shared secret
                                    computed by the card with the shared secret computed off card.
                                9. The command returns the signed challenge with '90 00' at the
                                    end. Verify the signed challenge.
                                10. The GET DATA commands return the requested data along with
                                    '90 00'. Each GENERAL AUTHENTICATE command returns
                                    either 1) the transported key with '90 00' at the end or 2) the
                                    shared secret Z with '90 00' at the end.
                                    • For key transport (as indicated by algorithm reference '06' or
                                         '07' as P1 value), the command returns the transported key


10
     Z is the X coordinate of point P as defined in SP 800-56A, Section 5.7.1.2


                                                      C-34
