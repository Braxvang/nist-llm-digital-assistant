NIST SP 800-166                                                      DERIVED PIV APPLICATION AND
                                                                     DATA MODEL TEST GUIDELINES

8.3.3.6 Internal Authenticate with the Digital Signature Key (with Invalid Algorithm
        Reference and Data Length)

 Test Assertion        TA-08.03.03.06
 Purpose               Verifies that the Derived PIV Application responds to the GENERAL
                       AUTHENTICATE command appropriately when signing using the
                       digital signature key with an invalid algorithm reference or data length.
 DTR(s)                • DTR-06.02.02.09
                       • DTR-06.03.01.01
                       • DTR-06.03.01.02
                       • DTR-06.03.04.02
                       • DTR-06.03.04.05
 Vendor                None.
 Documentation
 Precondition(s)       •   A token with the Derived PIV Application is inserted into an
                           appropriate token reader.
                       •   Suitable drivers have been loaded between the test system and an
                           instance of the reader.
                       •   The Derived PIV Application Password is recorded.
                       •   The Derived PIV Application Password’s retry counter is not 0.
 Test Scenario         1. Send the SELECT command with
                             • AID == ‘A0 00 00 03 08 00 00 20 00 01 00’
                       2. Send the VERIFY command with
                             • P2, key reference value, is set to '80'
                             • Data field of the command will contain the
                                correct Derived PIV Application Password, padded
                                with 'FF' (if necessary) to complete the total
                                length of the value to 8 bytes
                       3. Send the GENERAL AUTHENTICATE command
                             • CLA is set to:
                                 1. '00' if command chaining is not needed or
                                 2. '10' if command chaining is used. (The last
                                    chain of the command sets CLA to '00')
                             • P1, algorithm reference, is set to something
                                other than '07', '11' or '14' (indicating an
                                invalid algorithm reference)
                             • P2, key reference, is set to '9C' indicating the
                                digital signature key
                             • Data field in the command is to include '81'
                                specifying a challenge, followed by a randomly
                                generated challenge, and '82 00' in order to
                                request a response
                       4. Send the VERIFY command with
                             • P2, key reference value, is set to '80'
                             • Data field of the command will contain the
                                correct Derived PIV Application Password, padded
                                with 'FF' (if necessary) to complete the total
                                length of the value to 8 bytes
                       5. Send the GENERAL AUTHENTICATE command



                                              54
