NIST SP 800-85A-4                                          PIV CARD APPLICATION & MIDDLEWARE
                                                                    INTERFACE TEST GUIDELINES

 Test Steps            1. Set cardHandle := <<invalid cardHandle>>
                       2. Set applicationID := <<AID of PIV Card Application>>
                       3. Create applicationProperties reference
                       4. Call pivSelectCardApplication with
                          • (IN) cardHandle
                          • (IN) applicationAID
                          • (IN) aidLength
                          • (OUT) applicationProperties
                          • (INOUT) APLength
 Expected Result(s)    Call returns with status_word of PIV_INVALID_CARD_HANDLE and does
                       not initialize applicationProperties reference.
 Postcondition(s)      The client application remains in the state it had prior to calling
                       pivSelectCardApplication.



B.3.2.2         Detect and Handle an Invalid applicationAID
 Purpose                Ensure that the PIV Middleware detects and gracefully exits when
                        passed an invalid applicationAID.
 Target                pivSelectCardApplication
 Reference(s)          1. SP 800-73-4 Part 3, Section 3.2.1
                       2. AS04.04
 Precondition(s)       1. The client application owns a connection to the PIV Card
                          Application accessible through cardHandle.
 Test Steps            1. Set cardHandle := <<valid cardHandle>>
                       2. Set applicationID := <<invalid applicationID>>
                       3. Create applicationProperties reference
                       4. Call pivSelectCardApplication with
                          • (IN) cardHandle
                          • (IN) applicationAID
                          • (IN) aidLength
                          • (OUT) applicationProperties
                          • (INOUT) APLength
 Expected Result(s)    Call returns with status_word of PIV_CARD_APPLICATION_NOT_FOUND
                       and does not set the applicationProperties reference.
 Postcondition(s)      The client application remains in the state it had prior to calling
                       pivSelectCardApplication.



B.3.2.3         Identify and Handle an Insufficient Buffer
 Purpose                Ensure that the PIV Middleware identifies and handles an
                        insufficient allocated buffer for the application property template.
 Target                pivSelectCardApplication
 Reference(s)          1. SP 800-73-4 Part 3, Section 3.2.1
                       2. AS04.04A-R4
 Precondition(s)       1. The client application owns a connection accessible through
                          cardHandle.



                                        B-8
