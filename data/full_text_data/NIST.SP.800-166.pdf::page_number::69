NIST SP 800-166                                                  DERIVED PIV APPLICATION AND
                                                                 DATA MODEL TEST GUIDELINES

 Test Scenario           1. Send the SELECT command with
                               • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                         2. Send the VERIFY command with
                               • P2, key reference value, is set to '80'
                               • Data field of the command will contain the
                                  correct Derived PIV Application Password,
                                  padded with 'FF' (if necessary) to complete
                                  the total length of the value to 8 bytes
                         3. Reset the security status of the '80' key reference
                            by sending the VERIFY command with
                               • P2, key reference value, is set to '80'
                               • P1 parameter is 'FF' and both L c and the data
                                  field are absent
                         4. Send the GENERAL AUTHENTICATE command
                               • CLA is set to:
                                   1. '00' if command chaining is not needed or
                                   2. '10' if command chaining is used. (The
                                      last chain of the command sets CLA to
                                      '00')
                               • P1, algorithm reference, is set to '07' or
                                  '11'.
                                  P2, key reference, is set to '9A' indicating
                                  the Derived PIV Authentication key
                               • Data field in the command is to include '81'
                                  specifying a challenge, followed by a randomly
                                  generated challenge, and '82 00' in order to
                                  request a response
 Expected Result(s)      1. From Step 1, the command returns the application property
                            template with the status word '90 00'.
                         2. From Step 2, the command returns status word '90 00'.
                         3. From Step 3, the command returns status word '90 00'.
                         4. From Step 4, the command returns status word '69 82' (security
                            status not satisfied).
 Postcondition(s)        N/A

8.3.4.3 Verify with an Incorrect Length and Padding for the Current Password

 Test Assertion          TA-08.03.04.04
 Purpose                 Verifies that the Derived PIV Application responds correctly to the
                         VERIFY command when the password length and padding
                         requirements are not met.
 DTR(s)                  • DTR-06.02.02.09
                         • DTR-06.02.02.14
                         • DTR-06.03.01.01
 Vendor Documentation    The vendor to provide in its documentation the status word returned
                         by the Derived PIV Application when the password length or
                         padding requirements are not met.
 Precondition(s)         • A token with the Derived PIV Application is inserted into an
                             appropriate token reader.


                                           62
