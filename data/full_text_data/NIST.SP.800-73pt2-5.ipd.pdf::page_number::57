       NIST SP 800-73pt2-5 ipd (Initial Public Draft)                 Interfaces for Personal Identity Verification: Part 2
       September 2023                                                    PIV Card Application Card Command Interface

1221   Response:
                              '7C' – L1 {'82' L2 {shared secret Z}}, where
                                   • Z is the X coordinate of point P, as defined in [SP800-56A,
         Data Field
                                        Section 5.7.1.2]
                                   • L2 is 32 bytes.
         SW1-SW2              '90 00' (Status word)


1222   A.5.2.2.         PIV KMK-Specific ECDH Key Agreement Schemes
1223   SP 800-56A describes five different ECDH key agreement schemes that a client application
1224   cryptographic module MAY implement. These schemes differ in the number of keys (i.e., 1 or 2)
1225   and the type of keys (i.e., ephemeral or static) used by each party. Since the PIV Card only
1226   computes the ECC CDH primitive using its static private key, the client application
1227   cryptographic module only employs the PIV Card to implement an ECDH key agreement
1228   scheme when the scheme involves the use of the cardholder’s static key pair. The ECDH key
1229   agreement schemes that involve the use of at least one party’s static key pair and, thus, MAY
1230   involve the use of the PIV Card are:
1231       •   C(2e, 2s) — Each party has a static key pair and generates an ephemeral key pair [SP800-
1232           56A, Section 6.1.1].
1233           In this scheme, the information sent between the client application and the PIV Card is
1234           the same when acting as the initiator or the responder. The other party’s static public key
1235           is sent to the PIV Card, and a static shared secret is returned by the PIV Card in plaintext.
1236           Note that an ephemeral key pair is generated by the client application, and the private key
1237           of that key pair is combined with the other party’s ephemeral public key to produce an
1238           ephemeral shared secret.
1239       •   C(1e, 2s) — The initiator has a static key pair and generates an ephemeral key pair, while
1240           the responder has a static key pair [SP800-56A, Section 6.2.1].
1241           When the cardholder is acting as the initiator, the other party’s static public key is sent to
1242           the PIV Card, and a static shared secret is returned in plaintext by the PIV Card. Note
1243           that, in this case, an ephemeral key pair is generated by the client application’s
1244           cryptographic module, and the corresponding ephemeral private key is combined with the
1245           other party’s static public key to produce a second shared secret.
1246           When the cardholder is acting as the responder, two public keys are sent by the client
1247           application to the PIV Card (i.e., the other party’s static and ephemeral public keys), and
1248           two shared secrets are returned in plaintext (i.e., the static shared secret and the
1249           ephemeral shared secret). Note that two GENERAL AUTHENTICATE commands are
1250           required to provide the two shared secrets to the client application’s cryptographic
1251           module.
1252       •   C(1e, 1s) — The initiator only generates an ephemeral key pair, while the responder only
1253           has a static key pair [SP800-56A, Section 6.2.2].
1254           In this scheme, the PIV Card is only employed by the client application if the cardholder
1255           is acting as the responder. In this case, the other party’s ephemeral public key is sent to
1256           the PIV Card, and the shared secret is returned by the PIV Card in plaintext.


                                                             47
