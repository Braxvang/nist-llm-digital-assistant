Special Publication 800-85B                                    PIV Data Model Testing Specification


Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<Card Holder Fingerprints
                         (2.16.840.1.101.3.7.2.96.16)>>
                      3. Extract the certificates field contents from the
                         CBEFF_SIGNATURE_BLOCK. If this field is omitted then
                         extract the certificate from the CHUID signature
                      4. Set OID := <<CHUID (2.16.840.1.101.3.7.2.48.0)>>
                      5. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      6. Extract the digital signature string from
                         CBEFF_SIGNATURE_BLOCK.
                      7. Using the certificate extracted either from the
                         CBEFF_SIGNATURE_BLOCK or the CHUID asymmetric signature,
                         verify the signature on the biometric
Expected              The certificates field in the SignedData contains a single certificate that
Result(s)             can be used to verify the digital signature in the SignerInfo. If the
                      certificates field is omitted, then the certificates field of the SignedData
                      for the CHUID contains the certificate that can be used to verify the
                      digital signature.


10.2.2 Embedded Certificate

10.2.2.1 Verify extended key usage extension

Purpose                 Confirms that the digital signature certificate used to sign the fingerprint
                        biometric asserts id-PIV-content-signing in the extendedKeyUsage
                        extension.
Reference(s)            1.     FIPS201, Section 4.2.2
                        2.     AS06.02.17
Precondition            1.     A valid PIV card is inserted into the contact reader.
                        2.     A valid PC/SC connection exists between the test application and
                               the contact reader.
                        3.     The test application is currently connected to the card application
                               which is accessible through card handle.
                        4.     A valid card holder fingerprint I is present on the PIV card.
Test Steps              1. Set cardHandle := <<valid card handle>>
                        2. Set OID := <<Card Holder Fingerprints
                           (2.16.840.1.101.3.7.2.96.16)>>
                        3. Call pivGetData w/
                           • (IN) cardHandle
                           • (IN) OID
                           • (OUT) data
                        4. Extract the certificates field contents from the
                           CBEFF_SIGNATURE_BLOCK. If the certificate field is
                           omitted, then stop execution of this test assertion.
                        5. Extract all KeyPurposeId fields from the extended key
                           usage extension from the certificate obtained


                                                                                                      Page 92
