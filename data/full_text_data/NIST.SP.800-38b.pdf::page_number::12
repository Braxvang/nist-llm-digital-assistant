                                                                                             NIST SP 800-38B                                                                              BLOCK CIPHER MODES:
                                                                                                                                                                                  CMAC MODE FOR AUTHENTICATION


                                                                                             Subkey generation, MAC generation, and MAC verification are specified in Sections 6.1, 6.2,
                                                                                             and 6.3 below. The specifications include the inputs, the outputs, a suggested notation for the
                                                                                             function, the steps, and a summary; for MAC generation, a diagram is also given. The inputs
                                                                                             that are typically fixed across many invocations of CMAC are called the prerequisites. The
                                                                                             prerequisites and the other inputs shall meet the requirements in Sec. 5. The suggested notation
                                                                                             does not include the block cipher.

                                                                                             6.1    Subkey Generation

                                                                                             The following is a specification of the subkey generation process of CMAC:
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-38B




                                                                                                      Prerequisites:
                                                                                                      block cipher CIPH with block size b;
                                                                                                      key K.

                                                                                                      Output:
                                                                                                      subkeys K1, K2.

                                                                                                      Suggested Notation:
                                                                                                      SUBK(K).

                                                                                                      Steps:
                                                                                                      1.     Let L = CIPHK(0b).
                                                                                                      2.     If MSB1(L) = 0, then K1 = L << 1;
                                                                                                             Else K1 = (L << 1) ⊕ Rb; see Sec. 5.3 for the definition of Rb.
                                                                                                      3.     If MSB1(K1) = 0, then K2 = K1 << 1;
                                                                                                             Else K2 = (K1 << 1) ⊕ Rb.
                                                                                                      4.     Return K1, K2.

                                                                                             In Step 1, the block cipher is applied to the block that consists entirely of ‘0’ bits. In Step 2, the
                                                                                             first subkey is derived from the resulting string by a left shift of one bit, and, conditionally, by
                                                                                             XORing a constant that depends on the block size. In Step 3, the second subkey is derived in the
                                                                                             same manner from the first subkey. 1 As discussed in Sec. 5.3, any intermediate value in the
                                                                                             computation of the subkey, in particular, CIPHK(0b), shall be secret.

                                                                                             6.2    MAC Generation

                                                                                             The following is a specification of the MAC generation process of CMAC:

                                                                                                      Prerequisites:
                                                                                                      block cipher CIPH with block size b;
                                                                                                      key K;
                                                                                                      MAC length parameter Tlen.

                                                                                             1
                                                                                               As detailed in Ref. [5], the generation of K1 and K2 is essentially equivalent to multiplication by u and u2,
                                                                                             respectively, within the Galois field that is determined by the irreducible polynomial that is represented by Rb, which
                                                                                             is discussed in Sec. 5.3.

                                                                                                                                                       7
