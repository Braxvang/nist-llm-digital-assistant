                                                                                              NIST SP 800-77 REV. 1                                                                                 GUIDE TO IPSEC VPNS


                                                                                                   •   Protection. Each traffic flow should be protected in accordance with the information
                                                                                                       gathered during the Identify Needs phase. This should be verified by monitoring network
                                                                                                       traffic and checking IPsec endpoint logs to confirm that the packet filter rules are
                                                                                                       ensuring that the proper protection is provided for each type of traffic.
                                                                                                   •   Authentication. Performing robust testing of IKE authentication is important because if
                                                                                                       authentication services are lost, IPsec services may be lost as well. Authentication
                                                                                                       solutions, such as using digital signatures, may be complex and could fail in various
                                                                                                       ways. See Section 7.2.2 for more information on IKE authentication.
                                                                                                   •   Application Compatibility. The solution should not break or interfere with the use of
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                                       existing software applications. This includes network communications between
                                                                                                       application components, as well as IPsec client software issues (e.g., a conflict with host-
                                                                                                       based firewall or intrusion detection software).
                                                                                                   •   Management. Administrators should be able to configure and manage the solution
                                                                                                       effectively and securely. This includes all components, including gateways, management
                                                                                                       servers, and client software. For remote access architectures, it is particularly important
                                                                                                       to evaluate the ease of deployment and configuration. For example, most
                                                                                                       implementations do not have fully automated client configuration; in many cases,
                                                                                                       administrators need to manually configure each client. Another concern is the ability of
                                                                                                       users to alter IPsec settings, causing connections to fail and requiring administrators to
                                                                                                       manually reconfigure the client or causing a security breach.
                                                                                                   •   Logging. The logging and data management features should function properly in
                                                                                                       accordance with the organization’s policies and strategies.
                                                                                                   •   Performance. The solution should be able to provide adequate performance during
                                                                                                       normal and peak usage. Performance issues are among the most common IPsec-related
                                                                                                       problems. It is important to consider not only the performance of the primary IPsec
                                                                                                       components but also that of intermediate devices, such as routers and firewalls.
                                                                                                       Encrypted traffic often consumes more processing power than unencrypted traffic, so it
                                                                                                       may cause bottlenecks. 64 Because IPsec headers and tunneling increase the packet length,
                                                                                                       intermediate network devices might also need to fragment the packets, possibly slowing
                                                                                                       network activity. 65 In many cases, the best way to test the performance of a prototype
                                                                                                       implementation under fully loaded conditions is to use simulated traffic generators on a
                                                                                                       live test network to mimic the actual characteristics of the expected traffic as closely as
                                                                                                       possible. Testing should incorporate a variety of applications that will be used with IPsec,
                                                                                                       especially those that are most likely to be affected by network throughput or latency
                                                                                                       issues, such as VoIP. 66 Addressing performance problems generally involves upgrading
                                                                                                       or replacing hardware, offloading cryptographic calculations from software-based


                                                                                              64   The additional resources necessitated by IPsec vary widely based on several factors, including the IPsec mode (tunnel or
                                                                                                   transport), the encryption algorithm, and the use of IPComp, UDP encapsulation, or optional padding.
                                                                                              65   Similar problems can occur when tunnels are within other tunnels so that packets are encapsulated multiple times. Typically,
                                                                                                   the solution for these types of problems is to reduce the size of the MTU value on the host originating the network traffic.
                                                                                                   The MTU is the maximum allowable packet size. The MTU can be lowered so that the IPsec-encapsulated packets are not
                                                                                                   large enough to require fragmentation.
                                                                                              66   For more information on VoIP, see [68].



                                                                                                                                                             79
