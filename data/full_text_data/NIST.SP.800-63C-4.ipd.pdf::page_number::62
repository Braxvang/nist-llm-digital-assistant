       NIST SP 800-63C-4 ipd                                              Digital Identity Guidelines
       December 2022                                                      Federation and Assertions


1625   In this model, the RP directly requests the assertion from the IdP, minimizing chances of
1626   interception and manipulation by a third party (including the subscriber themselves).
1627   This method also facilitates the RP querying the IdP for additional attributes about the
1628   subscriber not included in the assertion itself, since back-channel communication can
1629   continue to occur after the initial authentication transaction has been completed without
1630   sending the user back to the IdP. This query occurs using an identity API, as described in
1631   Sec. 6.3.
1632   More network transactions are required in the back-channel method, but the information
1633   is limited to only those parties that need it. Since an RP is expecting to get an assertion
1634   only from the IdP directly, the attack surface is reduced. Consequently, it is more difficult
1635   to inject assertions directly into the RP and this presentation method is recommended for
1636   FAL2 and above.
1637   The RP SHALL protect itself against injection of manufactured or captured assertion
1638   references by use of cross-site scripting protection or other accepted techniques.
1639   Conveyance of the assertion reference from the IdP to the subscriber, as well as from
1640   the subscriber to the RP, SHALL be made over an authenticated protected channel.
1641   Conveyance of the assertion reference from the RP to the IdP, as well as the assertion
1642   from the IdP to the RP, SHALL be made over an authenticated protected channel.
1643   When assertion references are presented, the IdP SHALL verify that the party presenting
1644   the assertion reference is the same party that requested the authentication. The IdP can
1645   do this by requiring the RP to authenticate itself when presenting the assertion reference
1646   to the IdP or through other similar means (see [RFC7636] for one protocolâ€™s method of
1647   dynamic RP verification).
1648   Note that in a federation proxy described in Sec. 5.1.3, the IdP audience restricts the
1649   assertion reference and assertion to the proxy, and the proxy restricts any newly-created
1650   assertion references or assertions to the downstream RP.




                                                    50
