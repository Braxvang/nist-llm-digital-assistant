                                                                                               NIST SP 800-56A Rev. 3                                   Recommendation for Pair-Wise Key Establishment
                                                                                                                                                                Using Discrete Logarithm Cryptography

                                                                                                    sections, with the recipient of the ephemeral public key serving as a key-confirmation
                                                                                                    recipient:
                                                                                                     •    dhHybrid1 (see Section 6.1.1.1 and Section 6.1.1.5) or
                                                                                                     •    (Cofactor) Full Unified Model (see Section 6.1.1.2 and Section 6.1.1.5).
                                                                                               Note: If key confirmation is provided in both directions in a key-agreement transaction
                                                                                               employing one of the schemes above, then each party can obtain assurance of the other
                                                                                               party’s possession of their ephemeral private key.

                                                                                               5.6.2.3 Public Key Validation Routines
                                                                                               Public-key validation refers to the process of checking the arithmetic properties of a
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                               candidate public key. Both full and partial validation routines are provided for public keys
                                                                                               that are associated with either FFC or ECC domain parameters. Public-key validation does
                                                                                               not require knowledge of the associated private key and so may be done at any time by
                                                                                               anyone. However, these routines assume a prior validation of the domain parameters

                                                                                               5.6.2.3.1 FFC Full Public-Key Validation Routine
                                                                                               FFC full public-key validation refers to the process of checking the arithmetic properties of
                                                                                               a candidate FFC public key to ensure that it has the expected representation and is in the
                                                                                               correct subgroup of the multiplicative group of the finite field specified by the associated
                                                                                               FFC domain parameters.
                                                                                               This routine shall be used when assurance of full public-key validity is required (or desired)
                                                                                               for a static or ephemeral FFC public key.
                                                                                               Input:
                                                                                                  1. (p, q, g{, SEED, counter}): A valid set of FFC domain parameters, and
                                                                                                    2. y: A candidate FFC public key.
                                                                                               Process:
                                                                                                    1. Verify that 2  y  p − 2.
                                                                                                         Success at this stage ensures that y has the expected representation for a nonzero field
                                                                                                         element (i.e., an integer in the interval [1, p – 1]) and that y is in the proper range for
                                                                                                         a properly generated public key.
                                                                                                    2. Verify22 that 1 = yq mod p.
                                                                                                         Success at this stage ensures that y has the correct order and thus, is a non-identity
                                                                                                         element in the correct subgroup of GF(p)*.
                                                                                               Output: If any of the above verifications fail, immediately output an error indicator and exit
                                                                                               without further processing. Otherwise, output an indication of successful validation.


                                                                                               22
                                                                                                 When the FFC domain parameters correspond to a safe-prime group, 1 = yq mod p if and only if y is a
                                                                                               (nonzero) quadratic residue modulo p, which can be verified by computing the value of the Legendre symbol
                                                                                               of y with respect to p.

                                                                                                                                                  43
