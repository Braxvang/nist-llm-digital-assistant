      NIST SP 800-63B-4 ipd                                             Digital Identity Guidelines
      December 2022                                      Authentication and Lifecycle Management


953   phones. These devices have an embedded secret that is used as the seed for generation of
954   OTPs and does not require activation through a second factor. The OTP is displayed on
955   the device and manually input for transmission to the verifier, thereby proving possession
956   and control of the device. An OTP device may, for example, display 6 characters at a time.
957   A single-factor OTP device is something you have.
958   Single-factor OTP devices are similar to look-up secret authenticators with the exception
959   that the secrets are cryptographically and independently generated by the authenticator
960   and verifier and compared by the verifier. The secret is computed based on a nonce that
961   may be time-based or from a counter on the authenticator and verifier.

962   5.1.4.1. Single-Factor OTP Authenticators
963   Single-factor OTP authenticators contain two persistent values. The first is a symmetric
964   key that persists for the device’s lifetime. The second is a nonce that is either changed
965   each time the authenticator is used or is based on a real-time clock.
966   The secret key and its algorithm SHALL provide at least the minimum security
967   strength specified in the latest revision of [SP800-131A] (112 bits as of the date of this
968   publication). The nonce SHALL be of sufficient length to ensure that it is unique for each
969   operation of the device over its lifetime. If a subscriber needs to change the device used
970   for a software-based OTP authenticator, they SHOULD bind the authenticator application
971   on the new device to their subscriber account as described in Sec. 6.1.2.1 and invalidate
972   the authenticator application that will no longer be used.
973   The authenticator output is obtained by using an approved block cipher or hash function
974   to combine the key and nonce in a secure manner. The authenticator output MAY be
975   truncated to as few as 6 decimal digits (approximately 20 bits of entropy).
976   If the nonce used to generate the authenticator output is based on a real-time clock, the
977   nonce SHALL be changed at least once every 2 minutes.

978   5.1.4.2. Single-Factor OTP Veriﬁers
979   Single-factor OTP verifiers effectively duplicate the process of generating the OTP used
980   by the authenticator. As such, the symmetric keys used by authenticators are also present
981   in the verifier, and SHALL be strongly protected against unauthorized disclosure by the
982   use of access controls that limit access to the keys to only those software components on
983   the device requiring access.
984   When a single-factor OTP authenticator is being associated with a subscriber account,
985   the verifier or associated CSP SHALL use approved cryptography to either generate and
986   exchange or to obtain the secrets required to duplicate the authenticator output.
987   The verifier SHALL use approved encryption and an authenticated protected channel
988   when collecting the OTP in order to provide resistance to eavesdropping and AitM attacks.

                                                  24
