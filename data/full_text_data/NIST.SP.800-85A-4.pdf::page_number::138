NIST SP 800-85A-4                                                  PIV CARD APPLICATION & MIDDLEWARE
                                                                            INTERFACE TEST GUIDELINES

                                   returns the signed challenge with '90 00' at the end. Verify the
                                   signed challenge.
                               17. The command returns:
                                   • For referenced step 4, the command returns the encrypted
                                       challenge with '90 00' at the end. Decrypt the encrypted
                                       challenge and compare it to the one sent to the card.
                                   • Referenced step 6a: The PIV Card Application returns a
                                       challenge followed by '90 00'.
                                   • Referenced step 6b. The Test Toolkit Application responds
                                       with encryption of the challenge sent by PIV Card application
                                       and the card returns '90 00'
                                   • For referenced step 10, the GET DATA commands return '90
                                       00' and the requested data objects. The GENERAL
                                       AUTHENTICATE commands return '69 82' (security status
                                       not satisfied)
                               NOTE: On Steps 3, 7a, 9, 14, 15, and 16: If ECDSA with algorithm '11'
                               (in case of '9A', '9C', or '9E') or '14' (in case of '9C') is used, the
                               response data field contains r and s. 16
                               18. The command returns '6A 86' (incorrect parameter in P1 or P2).
                               19. The commands return '6A 86' (incorrect parameter in P1 or P2).
                               20. The command returns '6A 86' (incorrect parameter in P1 or P2).
                               21. The command returns '90 00' – secure messaging session keys are
                                   established. Use the information returned by the PIV Card
                                   Application to derive the session keys and verify the key
                                   confirmation AuthCryptogram ICC .
 Postcondition(s)              N/A

C.2.4.2       Contactless Interface
 Purpose             Validates internal authentication and mutual authentication of the
                     PIV Card and the Test Toolkit to ensure that the private keys in use
                     are accessible only through the appropriate interface.
 Reference(s)        1. SP 800-73-4 Part 2, Table 2
                     2. AS05.03
 Precondition(s)     1. The IUT is placed within the reading range of the contactless
                         reader.
                     2. There exists a valid PC/SC connection between the test system
                         and the contactless reader.
                     3. No other contactless card is within the proximity of the reader.

16
     r and s are DER encoded with the following ASN.1 structure:
        Ecdsa-Sig-Value ::= SEQUENCE {
              r INTEGER,
              s INTEGER }




                                                    C-37
