                                                                                              NIST SP 800-77 REV. 1                                                                               GUIDE TO IPSEC VPNS


                                                                                              SAs or for the IKE SA. A new IPsec SA is negotiated and installed as a new IPsec SA without
                                                                                              yet removing the old IPsec SA. The outbound IPsec SA is used immediately. Once traffic is
                                                                                              received on the new inbound IPsec SA, the old IPsec SA is completely deleted. This ensures that
                                                                                              rekeying does not lead to any traffic flow interruptions or leaking of unencrypted packets.

                                                                                              Once an IKE SA rekey is complete, the associated IPsec SAs of the old IKE SA are transferred
                                                                                              to the new IKE SA. The old IKE SA is then deleted.

                                                                                              3.2.4    The INFORMATIONAL Exchange

                                                                                              The purpose of the IKE INFORMATIONAL exchange is to provide the endpoints with a way to
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              send each other status and error messages. Some commonly used informational messages are:
                                                                                                   •   Delete one or more IPsec SAs
                                                                                                   •   Delete this IKE SA
                                                                                                   •   Liveness probe (aka Dead Peer Detection [DPD])
                                                                                                   •   Mobility IP address updates for Mobile IKE (MOBIKE)

                                                                                              Either endpoint can initiate an informational exchange. The other endpoint is obliged to return an
                                                                                              answer to prevent the initiator (of the informational exchange) from retransmitting. A delete
                                                                                              message denotes that the SPI of the IPsec SAs or the IKE SA is to be deleted. Deleting the IKE
                                                                                              SA will also cause all of its IPsec SAs to be terminated and deleted.

                                                                                              An endpoint that has not received any IPsec traffic in a while might want to verify that the
                                                                                              remote endpoint is still alive. To do so, it can send an informational exchange message (i.e., a
                                                                                              probe message) containing zero payloads. 27 An endpoint receiving such an informational
                                                                                              message must respond with an empty informational message. If these probes are not answered
                                                                                              for a configured time period, the IKE SA and IPsec SA are terminated.

                                                                                              A mobile device that is switching its connection (e.g., from LTE/5G to WiFi) needs to send an
                                                                                              informational message with a notification to its remote endpoint. The remote endpoint uses both
                                                                                              the content of the informational message, as well as the IP addresses observed from the IKE
                                                                                              packet itself, as an indication of which IP address to use as the updated IP address for the mobile
                                                                                              endpoint. Successful decryption of the packet (with properly incremented Message ID to prevent
                                                                                              replays) verifies the new IP address to use. This process is called Mobile IKE (MOBIKE) and is
                                                                                              specified in [38].




                                                                                              27   There will be one encrypted payload containing zero payloads. These probes are sometimes combined with other features, in
                                                                                                   which case other payloads may be present within the encrypted payload.



                                                                                                                                                           26
