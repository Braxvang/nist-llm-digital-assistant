Special Publication 800-73-4      Interfaces for Personal Identity Verification – Part 1: PIV
                               Card Application Namespace, Data Model and Representation

As a final step, the discovered X.509 algorithm OID and key size are mapped to the PIV algorithm
identifiers as defined in Table 6-2 of SP 800-78. The relying party then proceeds to issue the
GENERAL AUTHENTICATE command to the card.

C.2       PIV Algorithm Identifier Discovery for Symmetric Cryptographic Authentication

In the absence of an X.509 certificate, as is the case with symmetric cryptography, the PIV algorithm
identifier discovery mechanism has to rely on a lookup table residing at the local system. The table
maps a unique card identifier and key reference (inputs) to an associated PIV algorithm identifier
(output). The unique identifier supplied by the card may be the Agency Code || System Code ||
Credential Number of the FASC-N or the Card UUID.

The symmetric Card Authentication key is optional to implement and a relying party has no prior
knowledge of the key’s existence. The following routine discovers the Card Authentication key’s
native implementation:

      +   Read the CHUID and either extract the Card UUID or extract the Agency Code || System
          code || Credential Number from the CHUID’s FASC-N.

      +   Retrieve the PIV algorithm identifier from the local lookup table. If no algorithm identifier is
          returned, authentication cannot be performed using the optional symmetric Card
          Authentication key either because the PIV Card does not implement the key or the local
          system cannot authenticate the response from the card.

C.3       PIV Algorithm Identifier Discovery for Secure Messaging

The Application Property Template, which is included in the response to the SELECT command,
optionally includes a tag 0xAC, which indicates what cryptographic algorithms the PIV Card
Application supports. The presence of algorithm identifier '27' or '2E' indicates that the corresponding
cipher suite is supported by the PIV Card Application for secure messaging and that the PIV Card
Application possesses a PIV Secure Messaging key of the appropriate size for the specified cipher
suite.




                                                       49
