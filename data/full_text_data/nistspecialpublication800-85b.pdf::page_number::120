Special Publication 800-85B                                    PIV Data Model Testing Specification


10.4.2.7 Verify signature algorithm in SignerInfo

Purpose               Confirms that the signatureAlgorithm field specified in the SignerInfo
                      field is in accordance with Table 3-4 of SP80078 and based on the PIV card
                      expiration date in accordance with Table 3-3 of SP80078.
Reference(s)          1.      SP80078, Section 3.2.1
                      2.      AS06.04.10
Precondition          1.      A valid PIV card is inserted into the contact reader.
                      2.      A valid PC/SC connection exists between the test application and the
                              contact reader.
                      3.      The test application is currently connected to the card application
                              which is accessible through card handle.
                      4.      A valid security object is present on the PIV card.
                      5.      A valid CHUID is present on the PIV card.
Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<CHUID (2.16.840.1.101.3.7.2.48.0)>>
                      3. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      4. Extract the expiration date value from the CHUID (i.e.
                         Tag 0x35)
                      5. Set OID := <<Security Object
                         (2.16.840.1.101.3.7.2.144.0)>>
                      6. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      7. From the signature block (TAG 0xBB), match the
                         SignerInfo->signatureAlgorithm field contents with Table
                         3-4 of SP80078 based on the card expiration date
Expected              The signatureAlgorithm value in the SignerInfo field is in accordance
Result(s)             with Table 3-4 of SP80078 and is based on the PIV card expiration date in
                      accordance with Table 3-3 of SP80078.


10.4.2.8 Verify digital signature

Purpose               Confirms that the signature in the SignerInfo corresponds to the signed
                      security object and that it is it signed with the certificate that is used to
                      sign the CHUID.
Reference(s)          1.      SP80073, Section 1.8.5
                      2.      AS06.04.11
                      3.      AS06.04.12




                                                                                                 Page 112
