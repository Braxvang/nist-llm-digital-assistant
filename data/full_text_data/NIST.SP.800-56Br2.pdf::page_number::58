                                                                                               NIST SP 800-56B REV. 2                             RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                       USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                                          b. If len(npub) ≠ nBits, output an indication of an invalid key pair, and exit without
                                                                                                             further processing.
                                                                                                          c. If nBits is not a positive even integer, output an indication of an invalid key pair,
                                                                                                             and exit without further processing.
                                                                                                  4. Prime-factor recovery:
                                                                                                              a. Recover the prime factors p and q from the modulus npub, the public exponent
                                                                                                                 epub and the private exponent d (using one of the methods in Appendix C):
                                                                                                                      (p, q) = RecoverPrimeFactors (npub, epub, d).
                                                                                                              b. If RecoverPrimeFactors outputs an indication that the prime factors were not
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                                                 found, output an indication that the request is invalid, and exit without further
                                                                                                                 processing.
                                                                                                              c. If npub ≠ p × q, then output an indication that the request is invalid, and exit
                                                                                                                 without further processing.
                                                                                                  5. Check the prime factors:
                                                                                                          a. If (p < ( 2)(2nBits/2−1)) or (p > 2nBits/2 – 1), output an indication of an invalid key
                                                                                                             pair, and exit without further processing.
                                                                                                          b. If (q < ( 2)(2nBits/2−1)) or (q > 2nBits/2 – 1), output an indication of an invalid key
                                                                                                             pair, and exit without further processing.
                                                                                                          c. If |p – q| ≤ 2(nBits/2−100), output an indication of an invalid key pair, and exit without
                                                                                                             further processing.
                                                                                                          d. If GCD (p – 1, epub) ≠ 1, output an indication of an invalid key pair, and exit without
                                                                                                             further processing.
                                                                                                          e. If GCD (q – 1, epub) ≠ 1, output an indication of an invalid key pair, and exit without
                                                                                                             further processing.
                                                                                                          f. Apply an approved primality test* to the factor p (see FIPS 186, Appendices C.3
                                                                                                             and E). If the primality test indicates that p is not prime, output an indication of an
                                                                                                             invalid key pair, and exit without further processing.
                                                                                                          g. Apply an approved primality test* to the factor q (see FIPS 186, Appendices C.3
                                                                                                             and E). If the primality test indicates that q is not prime, output an indication of an
                                                                                                             invalid key pair, and exit without further processing.
                                                                                                      *   Relying parties (and/or agents trusted to act on their behalf) shall determine which of
                                                                                                          the approved primality tests in FIPS 186 meet their security requirements. The
                                                                                                          probability that p or q may be incorrectly classified as prime by the test used in step 5
                                                                                                          shall be less than or equal to 2–ES(nBits).
                                                                                                  6. Check that the private exponent d satisfies
                                                                                                          a. 2nBits/2 < d < LCM (p – 1, q – 1).


                                                                                                                                                  48
