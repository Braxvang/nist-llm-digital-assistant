GUIDELINES ON ELECTRONIC MAIL SECURITY



well as the new messages when accessing a mailbox from another host, or have to set up a retention
period after which messages are automatically deleted from the server.

2.4.2   Internet Message Access Protocol

To address the above-mentioned issues with POP, IMAP was developed in 1988. The IMAP protocol
was developed as a functional superset of the POP version 2 protocol. At the most basic level, IMAP was
designed so user mailboxes could be centrally located and accessed from multiple mail clients or MUAs.

Initially, IMAP offered very little functionality beyond that of POP, but since 1988, it has evolved into a
robust mailbox access protocol. The current edition of the IMAP standard is RFC 3501: Internet Message
Access Protocol – Version 4, Revision 1 (4rev1). Because IMAP 4rev1 supports many different features,
it has a much wider command set than that of POP. Figure 2.6 provides a list of IMAP 4rev1 commands.
Additionally, with the CAPABILITY command, the IMAP server can be queried to determine if other
IMAP extensions are supported.


               NOOP                                   Perform no operation
               STARTTLS                               Establish confidentiality and integrity protection
               AUTHENTICATE <type>                    Choose authentication method
               LOGIN <user> <passwd>                  Login with username and password
               LOGOUT                                 Logout the current user
               SELECT <mailbox>                       Select the desired mailbox to access
               EXAMINE <mailbox>                      Same as SELECT except opens mailbox for read-only
               CREATE <mailbox>                       Create a mailbox with the name <mailbox>
               DELETE <mailbox>                       Delete selected mailbox
               RENAME <mailbox> <newmailbox>          Rename mailbox
               SUBSCRIBE <mailbox>                    Subscribe to selected mailbox
               UNSUBSCRIBE <mailbox>                  Unsubscribe from selected mailbox
               LIST <reference> [pattern]             List contents of current reference based on an optional
                                                      pattern
               LSUB <reference> [pattern]             List a set of mailboxes matching the pattern
               STATUS <mailbox> <item>                Show the status of specific items in the selected mailbox
               APPEND <mailbox> [flags] <msg>         Append a message to the selected mailbox
               CHECK                                  Perform a checkpoint on the currently selected mailbox
               CLOSE                                  Close the currently selected mailbox
               EXPUNGE                                Expunge deleted messages from the mailbox
               SEARCH <criteria>                      Search the mailbox based on certain criteria
               FETCH <message> <item>                 Fetch the specified item from the selected message
               STORE <message> <item> <newvalue>      Update the selected item in a message
               COPY <message> <mailbox>               Copy a message to the provided mailbox
               UID <command> [args]                   Perform an operation on a message based on its UID
               CAPABILITY                             Query the server for its capabilities



                                     Figure 2.6: IMAP 4 Revision 1 Commands

Table 2.2 lists the associated RFCs for the noted IMAP extensions. IMAP has been extended with a
challenge/response mechanism comparable to APOP, which is called the Challenge-Response
Authentication Mechanism (CRAM). CRAM requires the client to make note of the challenge data sent
by the server and respond with a string consisting of the user’s name, a space, and a digest computed by
applying a keyed hash algorithm 6 against the timestamp sent with the challenge, using a shared secret as
the key.



6
    Most implementations use a popular one-way hash function called MD5. Developed by Ronald Rivest to create a message
    digest for digital signatures, MD5 is faster than SHA-1, but is considered less secure. MD5 is not approved for use in
    securing information for Federal agencies; see Section 3 for more information on this.

                                                            2-8
