NIST SP 800-166                                                   DERIVED PIV APPLICATION AND
                                                                  DATA MODEL TEST GUIDELINES

 Purpose              Verifies that the Derived PIV Application responds to the GENERAL
                      AUTHENTICATE command appropriately when externally
                      authenticating to the test toolkit application using the Derived PIV
                      Token Management Key (if supported).
 DTR(s)               • DTR-06.02.02.09
                      • DTR-06.03.01.01
                      • DTR-06.03.04.01
                      • DTR-06.03.04.05
 Vendor               The vendor to provide in its documentation whether the Derived PIV
 Documentation        Token Management Key is supported and if yes, the value of the key.
 Precondition(s)      •   A token with the Derived PIV Application is inserted into an
                          appropriate token reader.
                      •   Suitable drivers have been loaded between the test system and an
                          instance of the reader.
 Test Scenario        1. Send the SELECT command with
                            • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                      2. Send the GENERAL AUTHENTICATE command
                             • CLA is set to '00'
                             • P1, algorithm reference, is set to '00', '03',
                                '08', '0A', or '0C'
                             • P2, key reference, is set to '9B'
                             • Data field in the command is to include '81'
                                followed by '00' indicating it is a request for
                                challenge
                      3. Send the GENERAL AUTHENTICATE command
                             • CLA is set to '00'
                             • P1, algorithm reference, is set to the same
                                value as in Step 2
                             • P2, key reference, is set to '9B'
                             • Data field in the command is to include '82'
                                followed by an encrypted challenge
 Expected Result(s)   1. From Step 1, the command returns the application property template
                         with the status word '90 00'.
                      2. From Step 2, the command returns a challenge followed by status
                         word '90 00'.
                      3. From Step 3, the Test Toolkit Application responds with encryption
                         of the challenge sent by Derived PIV Application. The token returns
                         status word '90 00'.
 Postcondition(s)     N/A

8.3.3.5 General Authenticate with the Digital Signature Key

 Test Assertion       TA-08.03.03.05
 Purpose              Verifies that the Derived PIV Application responds to the GENERAL
                      AUTHENTICATE command appropriately when signing using the
                      digital signature key.


                                            52
