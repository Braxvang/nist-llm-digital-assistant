    A STATISTICAL TEST SUITE FOR RANDOM AND PSEUDORANDOM NUMBER GENERATORS FOR CRYPTOGRAPHIC APPLICATIONS




    Let ξ(x) be the number of visits to x, x ≠ 0, during one 0-excursion. Its distribution is derived in Revesz
    [2] and Baron and Rukhin [1]:

                                                                     1
                                               P (ξ (x) = 0) = 1−                                        (13)
                                                                    2x

    and for k = 1, 2, …

                                  €                                       k−1
                                                          1    1 
                                         P (ξ (x) = k ) = 2 1−                                         (14)
                                                         4x  2 x 

    This means that ξ(x) = 0 with probability 1 - 1/2|x|; otherwise (with probability 1/2|x|), ξ(x) coincides with
    a geometric random variable with the parameter 1/2|x|.
                             €
    It is easy to see that
                                                      Eξ (x) = 1,

    and
                                                 Var(ξ (x)) = 4 x − 2 .
                                          €
    A useful formula is:
                                                                            a
                                                                  1    1 
                       P (ξ (x) ≥ a + €
                                      1) = 2xP (ξ (x) = a + 1) =    1−    ,a = 0,1,2,…                 (15)
                                                                 2x  2x

    The above results are used for randomness testing in the following way. For a “representative” collection
    of x-values (say, 1 ≤ x ≤ 7 or -7 ≤ x ≤ -1: -4 ≤ x ≤ 4 is used in the test suite code), evaluate the observed
          € νk(x) of the number k of visits to the state x during J excursions which occur in the string. So
    frequencies
                 J
    ν k (x) = ∑ ν kj (x) with ν kj (x) = 1 if the number of visits to x during the jth excursion (j = 1, …, J) is
                 j=1

    exactly equal to k, and ν kj (x) = 0 otherwise. Pool the values of ξ(x) into classes, say, k = 0, 1, …, 4 with
    an additional class k ≥ 5. The theoretical probabilities for these classes are:
                       €                                                  1
€                                             π 0 = P(ξ (x) = 0) = 1−       ;
                                                                         2x
                 €                                                  k−1
                                                        1      1 
                                 π k = P(ξ (x) = k) = 2 1−        ,k = 1,…,4 ;
                                                      4x  2 x 
                                 €                                         4
                                                              1       1 
                                        π 5 = P(ξ (x) ≥ 5) =    1−       .
                                                             2x  2x
                       €
    These probabilities have the form

                             €




                                                         3-23
