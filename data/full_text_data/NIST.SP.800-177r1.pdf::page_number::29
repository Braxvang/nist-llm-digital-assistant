                                                                                               NIST SP 800-177 REV. 1                                                         TRUSTWORTHY EMAIL




                                                                                                  •    Malware present on an employee’s laptop may be sending out email without the
                                                                                                       employee’s knowledge.
                                                                                                  •    An employee (or intruder) may conﬁgure and operate a mail server without authorization.
                                                                                                  •    A device such as a photocopier or an embedded system may contain a mail sender that is
                                                                                                       attempting to send mail without anyone’s knowledge.

                                                                                               One way to mitigate the risk of unauthorized senders is for the enterprise to block outbound port
                                                                                               25 (used by SMTP) for all hosts except those authorized to send mail. In addition, domains can
                                                                                               deploy the sender authentication mechanism described in Section 4.3 (Sender Policy Framework
                                                                                               (SPF)), using which senders can assert the IP addresses of the authorized MTAs for their domain
                                                                                               using a DNS Resource Record.

                                                                                               Security Recommendation 3-1: To mitigate the risk of unauthorized sender, an enterprise
                                                                                               administrator should block outbound port 25 (except for authorized mail senders) and look to
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-177r1




                                                                                               deploy ﬁrewall or intrusion detection systems (IDS) that can alert the administrator when an
                                                                                               unauthorized host is sending mail via SMTP to the Internet.



                                                                                               �e proliferation of virtualization greatly increases the risk that an unauthorized virtual server
                                                                                               running on a virtual machine (VM) within a particular enterprise might send email. �is is
                                                                                               because VMs may be conﬁgured (by default or otherwise) to run email servers (MTAs), and
                                                                                               many VM hypervisors use network address translation (NAT) to share a single IP address
                                                                                               between multiple VMs. �us, a VM that is unauthorized to send email may share an IP address
                                                                                               with a legitimate email sender. To prevent such a situation, ensure that VMs that are authorized
                                                                                               mail senders and those VMs that are not authorized, do not share the same set of outbound IP
                                                                                               addresses. An easy way to do this is assigning these VMs to diﬀerent NAT instances.
                                                                                               Alternatively, internal ﬁrewall rules can be used to block outbound port 25 for VMs that are not
                                                                                               authorized to send outbound email.

                                                                                               Security Recommendation 3-2: Systems that are not involved in the organization’s email
                                                                                               infrastructure should be conﬁgured to not run Mail Transfer Agents (MTAs). Internal systems
                                                                                               that need to send mail should be conﬁgured to use a trusted internal MSA.

                                                                                               3.1.2   Unauthorized Email Receiver within an Organization’s IP Address Block

                                                                                               Unauthorized mail receivers are a risk to the enterprise IT security posture because they may be
                                                                                               an entry point for malicious email. If the enterprise email administrator does not know of the
                                                                                               unauthorized email receiver, they cannot guarantee the server is secure and provide the
                                                                                               appropriate mail handling rules for the enterprise such as scanning for malicious links/code,
                                                                                               ﬁltering spam, etc. �is could allow malware to bypass the enterprise perimeter defenses and
                                                                                               enter the local network undetected.

                                                                                               Security Recommendation 3-3: To mitigate the risk of unauthorized receivers, an enterprise
                                                                                               administrator should block inbound port 25 and look to deploy ﬁrewall or intrusion detection



                                                                                                                                               16
