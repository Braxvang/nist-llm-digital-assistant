                                                                                             NIST SP 800-90B                                              RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                  USED FOR RANDOM BIT GENERATION

                                                                                             5.2.2   Testing Goodness-of-fit for Non-Binary Data

                                                                                             The test checks whether the distribution of samples is identical for different parts of the input.
                                                                                             Given the input S = (s1, …, sL), where si ϵ A = {x1, …, xk}, perform the following steps to calculate
                                                                                             the number of bins nbin for the test.

                                                                                             1. Let 𝑐𝑐𝑖𝑖 be the number of occurrences of xi in the entire dataset S, and let 𝑒𝑒𝑖𝑖 = 𝑐𝑐𝑖𝑖 /10, for 1 ≤ i
                                                                                                ≤ k. Note that ci is divided by ten because S will be partitioned into ten data subsets.
                                                                                             2. Let List[i] be the sample value with the ith smallest 𝑒𝑒𝑖𝑖 (e.g., List[1] has the smallest value for
                                                                                                𝑒𝑒𝑖𝑖 ; 𝐿𝐿𝐿𝐿𝐿𝐿𝐿𝐿[2] has the next smallest value, etc.)
                                                                                             3. Starting from List[1], allocate the sample values into bins. Assign consecutive List[i] values to
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                                a bin until the sum of the 𝑒𝑒𝑖𝑖 for those binned items is at least five, then begin assigning the
                                                                                                following List[i] value(s) to the next bin. If the expected value of the last bin is less than five,
                                                                                                merge the last two bins. Let nbin be the number of bins constructed after this procedure.
                                                                                             4. Let Ei be the expected number of sample values in Bin i; Ei is the sum of the ei for the listed
                                                                                                items in that bin. For example, if Bin 1 contains (x1, x10 and x50), then E1 = e1 + e10 + e50.
                                                                                             Example 12: Let the number of distinct sample values k be 4; and let c1 = 43, c2 = 55, c3 = 52 and
                                                                                             c4=10. After partitioning the entire input sequence into 10 parts, the expected value of each sample
                                                                                             becomes e1 = 4.3, e2 = 5.5, e3 = 5.2 and e4 = 1. The sample list starting with the smallest expected
                                                                                             value is formed as List = [4, 1, 3, 2]. The first bin contains sample 4 and 1, and the expected value
                                                                                             of Bin 1 becomes 5.3 (= e4+e1). The second bin contains sample 3, and the last bin contains sample
                                                                                             2. Since the expected value of the last bin is greater than five, no additional merging is necessary.
                                                                                             Given nbin, Ei and list of samples for each bin, the chi-square goodness-of-fit test is executed as
                                                                                             follows:
                                                                                                                                                                                   𝐿𝐿
                                                                                             1. Partition S into ten non-overlapping sequences of length �10�, where 𝑆𝑆𝑑𝑑 =
                                                                                                (𝑠𝑠𝑑𝑑⌊𝐿𝐿/10⌋+1 , … , 𝑠𝑠(𝑑𝑑+1)⌊𝐿𝐿/10⌋ ) for d = 0,…, 9. If L is not a multiple of 10, the remaining samples
                                                                                                are not used.
                                                                                             2. T = 0.
                                                                                             3. For d = 0 to 9
                                                                                                 3.1. For i = 1 to nbin
                                                                                                     3.1.1. Let oi be the total number of times the samples in Bin i appear in 𝑆𝑆𝑑𝑑 .
                                                                                                                          (𝑜𝑜𝑖𝑖− 𝐸𝐸𝑖𝑖 )2
                                                                                                     3.1.2. T = T +                        .
                                                                                                                              𝐸𝐸𝑖𝑖

                                                                                             The test fails if the test statistic T is greater than the critical value of chi-square with 9(nbin -1)
                                                                                             degrees of freedom when the type I error is chosen as 0.001.

                                                                                             5.2.3   Testing Independence for Binary Data

                                                                                             This test checks the independence assumption for binary data. A chi-square test for independence
                                                                                             between adjacent bits could be used, but its power is limited, due to the small output space (i.e.,
                                                                                             the use of binary inputs). A more powerful check can be achieved by comparing the frequencies

                                                                                                                                                  37
