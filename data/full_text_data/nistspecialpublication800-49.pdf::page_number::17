                              Federal S/MIME V3 Client Profile



2.3.4 Receiving Signed and Encrypted Messages
    • S/MIME implementations MUST be able to receive and process messages that are signed
      and then encrypted. Implementations SHOULD be able to receive and process messages
      that are signed, encrypted, and then signed again. (Triple wrapping as defined in
      [RFC2634].) Implementations that can process arbitrary layers of wrapping are
      preferable.

2.3.5 Processing Return Receipts
    • S/MIME implementations MUST be able to process return signed receipts as specified in
      [RFC2634] for messages that the implementation generated and are still retained on the
      client system. Receipts for messages generated by a third party are out of scope for this
      profile, and thus claims to conformance will not be tested.
    • S/MIME implementations MUST be able to match receipts to messages automatically.
    • When S/MIME implementations process return signed receipt messages, the
      requirements for receiving signed messages as in Clause 2.3.2 above MUST be satisfied.


2.4 Certificate Processing
S/MIME is a PKI-enabled secure application. Specifically, S/MIME V3 implementations MUST
obtain and validate X.509 public key certificates to validate the signature on a message or
exchange symmetric key material. If critical PKI features are not present or are weak, the
security of S/MIME implementations will be adversely affected. PKI features are described in
detail in [RFC3280], "Internet X.509 Public Key Infrastructure Certificate and Certificate
Revocation List (CRL) Profile."

The PKI features may be divided into four basic categories. These categories are explained in
detail below.

2.4.1 X.509 Certificate Processing
      S/MIME implementations MUST be able to process all critical or optionally critical
      certificate extensions in the Federal Certificate and CRL Profile [CERTCRL]. S/MIME
      implementations MUST not reject certificates with unrecognized non-critical extensions.
      S/MIME agents MUST have the capability to support distinct certificates for digital
      signature and key management security services for both message origination and
      reception.

2.4.2 X.509 CRL Processing
      S/MIME implementations MUST be able to process all critical or optionally critical CRL
      extensions in the Federal Certificate and CRL Profile [CERTCRL]. S/MIME
      implementations MUST not reject CRLs with unrecognized non-critical extensions.

2.4.3   Path Validation
        S/MIME implementations MUST be able to validate a certification path according to
        [RFC3280], Section 6. S/MIME implementations MUST be able to use X.509 CRLs to




                                           9
