                                                                                               NIST SP 800-56B REV. 2                               RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                         USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                               5       Cryptographic Elements
                                                                                               This section describes the basic cryptographic elements that support the development of the key-
                                                                                               establishment schemes specified in this Recommendation. The schemes described herein are based
                                                                                               upon the correct implementation of these elements.

                                                                                               5.1      Cryptographic Hash Functions
                                                                                               In this Recommendation, cryptographic hash functions may be used for mask generation during
                                                                                               RSA-OAEP encryption/decryption, in key derivation, and/or in MAC-tag computation during key
                                                                                               confirmation. An approved hash function shall be used when a hash function is required (see FIPS
                                                                                               180 10 and FIPS 202 11).
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                               5.2      Message Authentication Code (MAC) Algorithms
                                                                                               A Message Authentication Code (MAC) algorithm defines a family of one-way (MAC) functions
                                                                                               that is parameterized by a symmetric key. The input to a MAC function includes a symmetric key,
                                                                                               called MacKey, and a binary data string, called MacData. A MAC function is represented as
                                                                                               MAC(MacKey, MacData {, ...}) 12. In this Recommendation, a MAC function is used in key
                                                                                               confirmation (see Section 5.6) and may be used for key derivation (see Section 5.5 and SP 800-
                                                                                               56C).
                                                                                               It must be computationally infeasible to determine the MAC of a (newly formed) MacData value
                                                                                               without knowledge of the MacKey value (even if one has seen the MACs corresponding to other
                                                                                               MacData values that were computed using that same MacKey value).
                                                                                               Key confirmation requires the use of one of the following approved MAC algorithms: HMAC,
                                                                                               AES-CMAC or KMAC. HMAC is specified in FIPS 198 and requires the use of an approved hash
                                                                                               function. AES-CMAC is specified in SP 800-38B 13 for the AES block cipher algorithm specified
                                                                                               in FIPS 197. KMAC is specified in SP 800-185. 14
                                                                                               When used for key confirmation, the key-confirmation provider is required to compute a "MAC
                                                                                               tag" on received or derived data using the agreed-upon MAC function. A symmetric key derived
                                                                                               from a shared secret (during a key-agreement transaction) or extracted from transported keying
                                                                                               material (during a key-transport transaction) is used as MacKey. The resulting MAC tag is sent to
                                                                                               the key-confirmation recipient, who can obtain assurance (via MAC-tag verification) that the
                                                                                               shared secret and derived keying material were correctly computed (in the case of key agreement)
                                                                                               or that the transported keying material was successfully received (in the case of key transport).
                                                                                               MAC-tag computation and verification are defined in Sections 5.2.1 and 5.2.2.




                                                                                               10
                                                                                                  FIPS 180, Secure Hash Standard (SHS).
                                                                                               11
                                                                                                  FIPS 202, Permutation-Based Hash and Extendable-Output Functions.
                                                                                               12
                                                                                                  Some MAC algorithms (e.g., KMAC) have additional parameters other than MacKey and MacData.
                                                                                               13
                                                                                                  SP 800-38B, Recommendation for Block Cipher Modes of Operation: the CMAC Mode for Authentication.
                                                                                               14
                                                                                                  SP 800-185, SHA-3 Derived Funcions: cSHAKE, KMAC, TupleHash and ParallelHash.
                                                                                                                                                   22
