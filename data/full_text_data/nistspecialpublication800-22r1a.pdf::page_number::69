    A STATISTICAL TEST SUITE FOR RANDOM AND PSEUDORANDOM NUMBER GENERATORS FOR CRYPTOGRAPHIC APPLICATIONS


                                                   n
                                          f j = ∑ x k exp(2π i ( k −1) j /n ) ,
                                               k=1


    where exp(2πikj /n ) = cos(2πkj /n ) + isin(2πkj /n ), j = 0,…,n −1, and i ≡ −1 . Because of the
    symmetry of the real to complex-value transform, only the values from 0 to (n/2 - 1) are considered. Let
                              €
    modj be the modulus of the complex number fj. Under the assumption of the randomness of the series xi, a
    confidence interval can be placed on the values of modj. More specifically, 95 percent of the values of
€                                                                  €
                                           1 
    modj should be less than h = log          n . A P-value based on this threshold comes from the binomial
                                        0.05 
    distribution. Let N1 be the number of peaks less than h. Only the first n/2 peaks are considered. Let N0 =
    .95N/2 and d = ( N1 − N 0 ) / n (0.95)(0.05) /4 . The P-value is
                  €
                                                                 d 
                                               (          )
                                             2 1− φ ( d ) = erfc 
                                                                 2
    €
    where φ(x) is the cumulative probability function of the standard normal distribution.

    Other P-values based on the series
                                    € fj or modj that are sensitive to departures from randomness are
    possible. However, the primary value of the transform comes from a plot of the series modj. In the
    accompanying figure, the top plot shows the series of modj for 4096 bits generated from a satisfactory
    generator. The line through the plot is the 95% confidence boundary. The P-value for this series is
    0.8077. The bottom plot shows a corresponding plot for a generator that produces bits that are
    statistically dependent in a periodic pattern. In the bottom plot, significantly greater than 5% of the
    magnitudes are beyond the confidence boundary. In addition, there is a clear structure in the magnitudes
    that is not present in the top plot. The P-value for this series is 0.0001.

                                               References for Test

    [1]     R. N. Bracewell, The Fourier Transform and Its Applications. New York: McGraw-Hill, 1986.
    [2]     W. Killman, J. Schüth, W. Thumser, and I. Uludag, A Note Concerning the DFT Test in NIST
            Special Publication 800-22, T-Systems, Systems Integration, July 2004.
    [3]     S. Kim, K, Umeno, and A. Hasegawa, Corrections of the NIST Statistical Test Suite for
            Randomness, Cryptology ePrint Archive, Report 2004/018, 2004.




                                                          3-7
