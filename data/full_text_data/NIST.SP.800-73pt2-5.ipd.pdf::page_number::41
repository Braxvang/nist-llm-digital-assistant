      NIST SP 800-73pt2-5 ipd (Initial Public Draft)                 Interfaces for Personal Identity Verification: Part 2
      September 2023                                                    PIV Card Application Card Command Interface




887
888                                           Fig. 1. PIV data confidentiality

889   Initialization Vector (IV). The IV for the AES CBC encryption of command data SHALL be
890   generated by applying the AES block cipher to a 16-byte encryption counter. The initial value of
891   the encryption counter upon successful completion of the key establishment protocol SHALL be
892   '00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01'. The encryption counter SHALL be
893   incremented by one after each APDU sent over secure messaging (except for the GET
894   RESPONSE command and APDUs with a CLA of '1C'), and it SHALL be reset to its initial
895   value after each successful completion of the key establishment protocol. The 16-byte IV
896   SHALL be created by encrypting the encryption counter with SK ENC using AES in the electronic
897   codebook (ECB) mode of operation.
898   The IV for the AES CBC encryption of response data SHALL also be generated by encrypting
899   an encryption counter with SK ENC using AES in the ECB mode of operation. The encryption
900   counter value used to generate the IV to encrypt the response data SHALL be the same as the
901   encryption counter value used to generate the IV to encrypt the corresponding request data, with
902   the exception that the most significant byte of the 16-byte counter SHALL be set to '80' (i.e., the
903   IV used to encrypt the first response after successful completion of the key establishment
904   protocol SHALL be generated by encrypting '80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01'
905   with SK ENC ).




                                                            31
