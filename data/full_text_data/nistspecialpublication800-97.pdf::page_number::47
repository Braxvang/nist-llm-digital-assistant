                                          ESTABLISHING WIRELESS ROBUST SECURITY NETWORKS: A GUIDE TO IEEE 802.11I



CCMP key space has size 2128 and uses a 48-bit packet number (PN) to construct a nonce to prevent
replay attacks. The construction of the nonce allows the key to be used for both integrity and
confidentiality without compromising either. 44

As the long-term IEEE 802.11 WLAN solution for confidentiality and integrity, CCMP uses CCM, which
was specifically designed to possess the following characteristics:

      A single cryptographic key for confidentiality and integrity to minimize complexity and
       maximize performance (minimize key scheduling time) 45
      Integrity protection of the packet header and packet payload, in addition to providing
       confidentiality of the payload
      Computation of some cryptographic parameters prior to the receipt of packets to enable fast
       comparisons when they arrive, which reduces latency
      Small footprint (hardware or software implementation size) to minimize costs
      Small security-related packet overhead (minimal data expansion due to cryptographic padding
       and integrity field, for instance)
      No encumbrance by any existing or pending patents.
Sections 4.3.2.1 and 4.3.2.2 briefly describe the CCMP encapsulation and decapsulation procedures.

4.3.2.1 CCMP Encapsulation

CCMP encapsulation is the process of generating the cryptographic payload (ciphertext) from the
plaintext data. The plaintext data comprises user traffic and a MAC header. The primary steps of CCMP
encapsulation are the following:

      The packet number (PN) maintained for the session is incremented.
      The PN and other portions of the address field are combined to form the nonce.
      The identifier for the Temporal Key, or KeyID, and the PN are combined to form the CCMP
       header.
      The frame header is used to construct the Additional Authentication Data (AAD). The AAD is a
       22-byte or 28-byte parameter comprising several fields, including several addresses and the
       quality-of-service control field, that are used as additional input into the CCM authentication
       process.
      The AAD, nonce, and plaintext data are provided as inputs to CCM along with the Temporal Key
       to encrypt the data.
      The packet header, the CCM header, and the ciphertext data are concatenated to form the
       ciphertext (or encapsulated) packet




44
     See Jakob Jonssonâ€™s paper (http://csrc.nist.gov/CryptoToolkit/modes/proposedmodes/ccm/ccm-ad1.pdf) for the proof of
     security in the standard model.
45
     The design goal was to minimize state on constrained systems


                                                           4-11
