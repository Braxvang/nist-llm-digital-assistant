       NIST SP 800-90C 3pd (Third Public Draft)                            Recommendation for RBG Constructions
       September 2022

2684       •    The length of the input string is always a fixed length.
2685       •    The length of the input_string is an integer multiple of 128 bits. Let m be the number of
2686            128-bit blocks in the input_string.
2687   This derivation function is specified as follows:
2688   CBC-MAC_df:
2689   Input: bitstring input_string, integer number_of_bits_to_return.
2690   Output: bitstring Z.
2691   Process:
2692       1. Let C1, C2, C3 be 128-bit blocks defined as 000000...0, 101010...10, 010101...01,
2693          respectively.
2694       2. Get df_Key.        Comment: See Appendix C.3.1.
2695       3. Z = the Null string.
2696       4. Let input_string = S1 || S2 || ... || Sm, where the Si are contiguous 128-bit blocks.
2697       5. For j = 1 to B:
2698            5.1   S0 = Cj.
2699            5.2   V = 128-bit block of all zeroes.
2700            5.3 For i = 0 to m:
2701                  V = Encrypt(df_Key, V ⊕ Si).              Comment: Perform the cipher operation
2702                                                            specified in [FIPS197].
2703            5.4   Z = Z || V.
2704       6.   Z = leftmost(Z, number_of_bit_to_return).
2705       7. Return(Z).




                                                           81
