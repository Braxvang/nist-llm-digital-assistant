       NIST SP 800-73pt2-5 ipd (Initial Public Draft)                                       Interfaces for Personal Identity Verification: Part 2
       September 2023                                                                          PIV Card Application Card Command Interface

1281   A.6.1. Authentication of the PIV Cardholder Using SM-AUTH
1282   PIV Cards that implement VCI or OCC use the key establishment protocol described Section 4.1
1283   to establish a secure messaging key and subsequently protect communication between the PIV
1284   Card and the host. During the key establishment protocol, the PIV Card and the Cardholder are
1285   authenticated. Departments and agencies CAN use these authentication steps as a stand-alone
1286   authentication mechanism known as SM-AUTH.
1287   The SM-AUTH authentication mechanism is performed with the GENERAL AUTHENTICATE
1288   command as follows:
1289                              Table 26: PIV Cardholder Authentication using Secure Messaging Key

                        Command                                             Response                       Comment
            00 87 27 04 50 7C 4E 81 4A 00 00                                                The GENERAL AUTHENTICATE
            00 00 00 00 00 00 00 04 X Y 82 00                                               command is used to perform the
            00                                                                              key establishment protocol, as
                                                                                            specified in Section 4.1.8, where
                                                                                            cipher suite CS2 is being used, ID sH
                                                                                            is all zeros, and X and Y are the
                                                                                            coordinates of Q eH . X and Y are 32
                                                                                            bytes each.
                                                      7C L1 82 L2 00 N ICC                  The response for the key
                                                      AuthCryptogram ICC C ICC              establishment protocol, as specified
                                                                                            in Section 4.1.8, where N ICC and
                                                                                            AuthCryptogram ICC are 16 bytes
                                                                                            each, and C ICC is as specified in
                                                                                            Section 4.1.5
            After the client application verifies C ICC and the authentication cryptogram and validates the certificate(s) needed
            to verify the signature on C ICC , the PIV Card has been authenticated, and session keys for secure messaging have
            been established (SK ENC , SK MAC , and SK RMAC ). The session keys are zeroized since they are not used 31 in
            subsequent communication.
1290
1291




       31
            Bits b3 and b4 of the CLA byte are set to zero to indicate that further communication with the card will not be encrypted.



                                                                                 51
