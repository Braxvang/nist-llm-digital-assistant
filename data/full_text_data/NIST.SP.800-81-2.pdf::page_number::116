SECURE DOMAIN NAME SYSTEM (DNS) DEPLOYMENT GUIDE




Checklist item 43 : Each recursive server must have a root hints file containing the IP address of one or
more DNS root servers. The information in the root hints file should be periodically checked for
correctness.

Checklist item 44 : The root hints file should be owned by the account under which the name server
software is run. The permission bits should be set so that the root hints file can be read or modified only
by the account that runs the name server software.



12.4 Securing the Stub Resolver

Stub resolvers do not have many configuration options. Often the only configuration necessary for an
administrator is to enter the IP addresses of one or more recursive resolvers that the stub would rely on to
service queries. It is a good idea for administrators to include at least two IP addresses of recursive
servers to increase the availability of the DNS service for end users. This can be done manually, or using
a protocol like DHCP.

There is a known class of malware that attempts to change the settings on a system’s stub resolver to
direct queries to another (usually malicious) recursive server. The server may then directs end users to a
malicious site where another attack takes place, or the server may simply direct users to a webpage that
serves ads or similar non-intended content. To combat this, administrators should make sure end user
systems have the latest anti-virus/malware software and should consider blocking all outbound DNS
traffic with the exception of known recursive servers.


Checklist item 45: Administrators should configure two or more recursive resolvers for each stub
resolver on the network.

Checklist item 46: Enterprise firewalls should consider restricting outbound DNS traffic from stub
resolvers to only the enterprise’s designated recursive resolvers.



12.5 Recommendations Summary

    •   Checklist item 37: Recursive servers/resolvers should be placed behind an organization’s
        firewall and configured to only accept queries from internal hosts (e.g., Stub Resolver host).

Checklist Item 38: Whenever Aggregate Caches are deployed, the forwarders must be configured to be
Validating Resolvers.

    •   Checklist item 39 : Each recursive server must have a root hints file containing the IP address of
        one or more DNS root servers. The information in the root hints file should be periodically
        checked for correctness.

    •   Checklist item 40 : The root hints file should be owned by the account under which the name
        server software is run. The permission bits should be set so that the root hints file can be read or
        modified only by the account that runs the name server software.


                                                   12-18
