                                                                                             NIST SP 800-190                                                           APPLICATION CONTAINER SECURITY GUIDE


                                                                                             A final recommendation for image configuration is that SSH and other remote administration
                                                                                             tools designed to provide remote shells to hosts should never be enabled within containers.
                                                                                             Containers should be run in an immutable manner to derive the greatest security benefit from
                                                                                             their use. Enabling remote access to them via these tools implies a degree of change that violates
                                                                                             this principle and exposes them to greater risk of network-based attack. Instead, all remote
                                                                                             management of containers should be done through the container runtime APIs, which may be
                                                                                             accessed via orchestration tools, or by creating remote shell sessions to the host on which the
                                                                                             container is running.

                                                                                             4.1.3   Embedded malware

                                                                                             Organizations should continuously monitor all images for embedded malware. The monitoring
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-190




                                                                                             processes should include the use of malware signature sets and behavioral detection heuristics
                                                                                             based largely on actual “in the wild” attacks.

                                                                                             4.1.4   Embedded clear text secrets

                                                                                             Secrets should be stored outside of images and provided dynamically at runtime as needed. Most
                                                                                             orchestrators, such as Docker Swarm and Kubernetes, include native management of secrets.
                                                                                             These orchestrators not only provide secure storage of secrets and ‘just in time’ injection to
                                                                                             containers, but also make it much simpler to integrate secret management into the build and
                                                                                             deployment processes. For example, an organization could use these tools to securely provision
                                                                                             the database connection string into a web application container. The orchestrator can ensure that
                                                                                             only the web application container had access to this secret, that it is not persisted to disk, and
                                                                                             that anytime the web app is deployed, the secret is provisioned into it.

                                                                                             Organizations may also integrate their container deployments with existing enterprise secret
                                                                                             management systems that are already in use for storing secrets in non-container environments.
                                                                                             These tools typically provide APIs to retrieve secrets securely as containers are deployed, which
                                                                                             eliminates the need to persist them within images.

                                                                                             Regardless of the tool chosen, organizations should ensure that secrets are only provided to the
                                                                                             specific containers that require them, based on a pre-defined and administrator-controlled setting,
                                                                                             and that secrets are always encrypted at rest and in transit using Federal Information Processing
                                                                                             Standard (FIPS) 140 approved cryptographic algorithms 5 contained in validated cryptographic
                                                                                             modules.

                                                                                             4.1.5   Use of untrusted images

                                                                                             Organizations should maintain a set of trusted images and registries and ensure that only images
                                                                                             from this set are allowed to run in their environment, thus mitigating the risk of untrusted or
                                                                                             malicious components being deployed.

                                                                                             To mitigate these risks, organizations should take a multilayered approach that includes:


                                                                                             5   For more information on NIST-validated cryptographic implementations, see the Cryptographic Module Validation Program
                                                                                                 (CMVP) page at https://csrc.nist.gov/groups/STM/cmvp/.

                                                                                                                                                       20
