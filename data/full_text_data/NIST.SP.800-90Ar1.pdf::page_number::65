NIST SP 800-90A Rev. 1                                                  Recommendation for Random Number
                                                                         Generation Using Deterministic RBGs


   CTR_DRBG_Generate_algorithm (working_state, requested_number_of_bits,
     additional_input):
       1. working_state: The current values for V, Key, and reseed_counter (see Section
          10.2.1.1).
       2. requested_number_of_bits: The number of pseudorandom bits to be returned to the
          generate function.
       3. additional_input: The additional input string received from the consuming
          application. Note that the length of the additional_input string may be zero.
   Output:
       1. status: The status returned from the function. The status will indicate SUCCESS, or
          indicate that a reseed is required before the requested pseudorandom bits can be
          generated.
       2. returned_bits: The pseudorandom bits returned to the generate function.
       3. working_state: The new values for V, Key, and reseed_counter.


   CTR_DRBG Generate Process:
       1. If reseed_counter > reseed_interval, then return an indication that a reseed is
          required.
       2. If (additional_input â‰  Null), then
                                                  Comment: Ensure that the length of the
                                                  additional_input is exactly seedlen bits. The
                                                  maximum length was checked in Section 9.3.3,
                                                  processing step 4, using Table 3 to define the
                                                  maximum length. If the length of the additional
                                                  input is < seedlen, pad with zero bits.
                 2.1   temp = len (additional_input).
                 2.2   If (temp < seedlen), then
                       additional_input = additional_input || 0seedlen - temp.
                 2.3 (Key, V) = CTR_DRBG_Update (additional_input, Key, V).
            Else additional_input = 0seedlen.
       3. temp = Null.
       4. While (len (temp) < requested_number_of_bits) do:
           4.1    If ctr_len < blocklen
                       4.1.1 inc = (rightmost (V, ctr_len) + 1) mod 2ctr_len.
                       4.1.2 V = leftmost (V, blocklen-ctr_len) || inc.
                  Else V = (V+1) mod 2blocklen.



                                                     56
