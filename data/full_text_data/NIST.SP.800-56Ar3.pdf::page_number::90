                                                                                               NIST SP 800-56A Rev. 3                             Recommendation for Pair-Wise Key Establishment
                                                                                                                                                          Using Discrete Logarithm Cryptography

                                                                                                  2. The parties have agreed upon an approved key-derivation method, as well as an
                                                                                                     approved algorithm to be used with that method (e.g., a hash function) and other
                                                                                                     associated parameters to be used (see Section 5.8).
                                                                                                  3. When an identifier is used to label a party during the key-agreement process, it has
                                                                                                     been selected/assigned in accordance with the requirements of the protocol relying
                                                                                                     upon the use of the key-agreement scheme, and its value is known to both parties.

                                                                                               6.1.2.1 dhEphem, C(2e, 0s, FFC DH) Scheme
                                                                                               This section describes the dhEphem scheme. Assurance of secure key establishment using
                                                                                               this scheme can only be obtained when the assumptions in Section 6.1.2 are true.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                               With the exception of key derivation, the dhEphem scheme is “symmetric” in the actions of
                                                                                               parties U and V. Only the actions performed by party U are specified here; a specification of
                                                                                               the actions performed by party V may be obtained by systematically replacing the letter “U”
                                                                                               by “V” (and vice versa) in the actions listed below. Note, however, that parties U and V must
                                                                                               use identical orderings of the bit strings that are input to the key-derivation method.
                                                                                               Party U shall execute the following actions to a) establish a shared secret value Z with party
                                                                                               V, and b) derive secret keying material from Z.
                                                                                               Actions: Party U generates a shared secret and derives secret keying material as follows:
                                                                                                  1. Generate an ephemeral key pair (rU, tU) from the domain parameters D as specified in
                                                                                                     Section 5.6.1.1. Send the public key tU to party V. Receive an ephemeral public key
                                                                                                     tV (purportedly) from party V. If tV is not received, destroy the ephemeral private key
                                                                                                     rU; then output an error indicator, and exit this process without performing the
                                                                                                     remaining actions.
                                                                                                  2. Verify that tV is a valid ephemeral public key for the parameters D as specified in
                                                                                                     Section 5.6.2.3. If assurance of public key validity cannot be obtained, destroy the
                                                                                                     ephemeral key rU; then output an error indicator, and exit this process without
                                                                                                     performing the remaining actions.
                                                                                                  3. Use the FFC DH primitive in Section 5.7.1.1 to derive a shared secret Z from the set
                                                                                                     of domain parameters D, party U’s ephemeral private key rU, and party V’s ephemeral
                                                                                                     public key tV. Then destroy the ephemeral private key rU. If the call to the FFC DH
                                                                                                     primitive outputs an error indicator, destroy the results of all intermediate calculations
                                                                                                     used in the attempted computation of Z; then output an error indicator, and exit this
                                                                                                     process without performing the remaining actions.
                                                                                                  4. Use the agreed-upon key-derivation method to derive secret keying material with the
                                                                                                     specified length from the shared secret value Z and other input (see Section 5.8). If
                                                                                                     the key-derivation method outputs an error indicator, destroy all copies of Z; then
                                                                                                     output an error indicator, and exit this process without performing the remaining
                                                                                                     action.
                                                                                                  5. Destroy all copies of the shared secret Z and output the derived keying material.
                                                                                               Output: The derived keying material or an error indicator.


                                                                                                                                             79
