                                                                                               NIST SP 800-56A Rev. 3                                     Recommendation for Pair-Wise Key Establishment
                                                                                                                                                                  Using Discrete Logarithm Cryptography

                                                                                               Output: avf(Q), the associate value of Q.

                                                                                               5.7.2.3 Elliptic Curve Cryptography MQV (ECC MQV) Primitive
                                                                                               The ECC MQV primitive is computed using the domain parameters (q, FR, a, b{, SEED},
                                                                                               G, n, h), the other party’s public keys, and one’s own public and private keys. Assume that
                                                                                               the party performing the computation is party A, and the other party is party B. Note that
                                                                                               party A could be either party U or party V.
                                                                                               Input:
                                                                                                  1. (q, FR, a, b{, SEED}, G, n, h): Domain parameters,
                                                                                                  2. ds,A : One’s own static private key,
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                                      3. Qs,B : The other party’s static public key,
                                                                                                      4. de,A : One’s own second private key,26
                                                                                                      5. Qe,A : One’s own second public key, and
                                                                                                      6. Qe,B : The other party’s second public key.
                                                                                               Process:
                                                                                                  1. implicitsigA = (de,A + avf(Qe,A)ds,A ) mod n.
                                                                                                      2. P = h(implicitsigA)(Qe,B + avf(Qe,B)Qs,B).
                                                                                                      3. If P = Ø, destroy all intermediate values used in the attempted computation of P, then
                                                                                                         output an error indicator, and exit this process without further processing.
                                                                                                      4. Else, set z = xP, where xP is the x-coordinate of P, and convert z to Z, using the field-
                                                                                                         element-to-byte string conversion routine defined in Appendix C.2.
                                                                                                      5. Destroy the results of all intermediate calculations used in the computation of Z
                                                                                                         (including P and z).
                                                                                                      6. Output Z.
                                                                                               Output: The shared secret Z or an error indicator.

                                                                                               5.7.2.3.1 Full MQV Form of the ECC MQV Primitive
                                                                                               This form of invoking the ECC MQV primitive is used in Section 6.1.1.4 by the Full MQV
                                                                                               scheme. In this form, each party has both a static key pair and an ephemeral key pair. Assume
                                                                                               that the party performing the computation is party A, and the other party is party B. Note that
                                                                                               party A could be either party U or party V.
                                                                                               In this form, one’s own second private and public keys (item 4 and 5 of the input list in
                                                                                               Section 5.7.2.3) are one’s own ephemeral private and public keys (de,A and Qe,A), and the other
                                                                                               party’s second public key (item 6 of the input list in Section 5.7.2.3) is the other party’s
                                                                                               ephemeral public key (Qe,B).
                                                                                               26
                                                                                                    In the ECC MQV primitive, a second key may be either ephemeral or static, depending on which form of
                                                                                                    the primitive is being used; see Sections 5.7.2.3.1 and 5.7.2.3.2.

                                                                                                                                                    52
