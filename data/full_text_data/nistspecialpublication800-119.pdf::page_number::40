                                                                GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6




                                  Figure 3-7. Example IPv6 Packet Header


3.4     IPv6 Extension Headers

Extension headers provide major services and functions for the IPv6 protocol. As discussed, the IPv6
header is much simpler with its eight fields and 40-byte header allowing faster processing. Moreover,
IPv6 has a new way to deal with options that has substantially improved processing: it handles options in
additional headers called extension headers.4 Extension headers are inserted into a packet only if the
options are needed.

Within the IPv6 packet header and its eight fields, the first extension header is identified in the NH field.
In IPv6, optional Internet-layer information is encoded in separate headers that may be placed between
the IPv6 header and the upper-layer header in a packet (RFC 2460). There are a small number of such
extension headers, each identified by a distinct NH value (see Table 3-4, IPv6 Extension Headers and
Upper Layer Protocols). An IPv6 packet may carry zero, one, or more extension headers, each identified
by the NH field of the preceding header and thus forming a chain illustrated below in Figure 3-8. The NH
fields indicate the Routing extension header; next, the Fragment extension header; the ESP extension
header; and, finally, the TCP header.


                           Routing          Fragmentation        Security Header       TCP Header
    IPv6 Header             Header             Header                (ESP)               + Data
   Next Header =         Next Header =      Next Header =         Next Header =
     Routing              Fragment          Security (ESP)             TCP




                       Figure 3-8. Next Header Fields in IPv6 and Extension Headers

Except for Hop-by-Hop Options, extension headers are examined or processed only by the node identified
in the Destination address field of the IPv6 header (or a set of nodes, in the case of multicast) 4 and must
be processed strictly in the order in which they appear in the packet. The Hop-by-Hop Option Header is
indicated by the value zero (0) in the NH field and requires that information within the packet be
examined and processed by every node along the path of the packet.




                                                    3-18
