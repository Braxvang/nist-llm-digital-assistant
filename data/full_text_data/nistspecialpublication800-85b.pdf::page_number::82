Special Publication 800-85B                                   PIV Data Model Testing Specification


10.1.1.4 Verify contents of encapContentInfo

Purpose                Confirms that the eContentType of the encapContentInfo is id-PIV-
                       CHUIDSecurityObject and the eContent field of the encapContentInfo is
                       omitted.
Reference(s)          1.      FIPS201, Section 4.2.2
                      2.      AS06.01.05
                      3.      AS06.01.06
Precondition          1.      A valid PIV card is inserted into the contact reader.
                      2.      A valid PC/SC connection exists between the test application and the
                              contact reader.
                      3.      The test application is currently connected to the card application
                              which is accessible through card handle.
                      4.      A valid CHUID is present on the PIV card.
Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<CHUID (2.16.840.1.101.3.7.2.48.0)>>
                      3. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      4. Extract and parse the encapContentInfo field contents
                         from the asymmetric digital signature of the CHUID
Expected              The eContent field has been omitted and the eContentType asserts id-piv-
Result(s)             CHUIDSecurityObject in encapContentInfo.


10.1.1.5 Verify crls field omission

Purpose               Confirm that the crls field from the SignedData content type is omitted.
Reference(s)          1.      FIPS201, Section 4.2.2
                      2.      AS06.01.08
Precondition          1.      A valid PIV card is inserted into the contact reader.
                      2.      A valid PC/SC connection exists between the test application and the
                              contact reader.
                      3.      The test application is currently connected to the card application
                              which is accessible through card handle.
                      4.      A valid CHUID is present on the PIV card.
Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<CHUID (2.16.840.1.101.3.7.2.48.0)>>
                      3. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      4. Extract the crls field contents from the asymmetric
                         digital signature of the CHUID




                                                                                                     Page 74
