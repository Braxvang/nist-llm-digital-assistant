                                                                                               NIST SP 800-177 REV. 1                                                                                TRUSTWORTHY EMAIL




                                                                                               5.3.1    S/MIME and SMIMEA

                                                                                               S/MIME is a protocol that allows email users to authenticate messages by digitally signing with
                                                                                               a private key and including the public key in an attached certiﬁcate. �e recipient of the message
                                                                                               performs a PKIX validation on the certiﬁcate, authenticating the message’s originator. On the
                                                                                               encryption side, the S/MIME sender typically encrypts the message text using a generated
                                                                                               symmetric key, which is encrypted in turn with the public key of the recipient, which was
                                                                                               previously distributed using some other, out of band, method. Within an organization it is
                                                                                               common to obtain a correspondent’s S/MIME certiﬁcate from an LDAP directory server.
                                                                                               Another way to obtain a S/MIME certiﬁcate is by exchanging digitally signed messages.

                                                                                               S/MIME had the advantage of being based on X.509 certiﬁcates, allowing existing software and
                                                                                               procedures developed for the PKI to be used for email. Hence, where the domain-owning
                                                                                               enterprise has an interest in securing the message content, S/MIME is preferred.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-177r1




                                                                                               �e Secure/Multipurpose Internet Mail Extensions (S/MIME) [RFC5751] describes a protocol
                                                                                               that will sign, encrypt or compress some, or all, of the body contents of a message. Signing is
                                                                                               done using the sender’s private key, while key encipherment is done with the recipient’s known
                                                                                               public key. Message encryption using the data encryption key, signing and compression can be
                                                                                               done in any order and any combination. �e operation is applied to the body, not the RFC 5322
                                                                                               headings of the message. In the signing case, the certiﬁcate containing the sender’s public key is
                                                                                               also attached to the message.

                                                                                               �e receiver uses the associated public key to authenticate the digital signature over the message,
                                                                                               demonstrating proof of origin and non-repudiation. �e usual case is for the receiver to
                                                                                               authenticate the supplied certiﬁcate using PKIX back to the Certiﬁcate Authority. Users who
                                                                                               want more assurance that the key supplied is bound to the sender’s domain can deploy the
                                                                                               SMIMEA mechanism [RFC8162] in which the certiﬁcate and key can be independently retrieved
                                                                                               from the DNS and authenticated per the DANE mechanism, similar to that described in Sub-
                                                                                               section 5.2.5, above. �e user who wants to encrypt a message retrieves the receiver’s public
                                                                                               key: which may have been sent on a prior signed message 23. If no prior signed message is at
                                                                                               hand, or if the user seeks more authentication than PKIX, then the key can be retrieved from the
                                                                                               DNS in an SMIMEA record. �e receiver decrypts the data encryption key using the
                                                                                               corresponding private key, decrypts the message using the newly decrypted key and reads or
                                                                                               stores the message as appropriate.




                                                                                               23 The use of one key pair for both digital signatures and data encryption is not recommended, but very common.




                                                                                                                                                             71
