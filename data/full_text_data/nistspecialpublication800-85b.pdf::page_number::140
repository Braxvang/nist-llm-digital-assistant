Special Publication 800-85B                                  PIV Data Model Testing Specification


Test Steps              1. Set cardHandle := <<valid card handle>>
                        2. Set OID := <<Key Management Certificate
                           (2.16.840.1.101.3.7.2.1.2)>>
                        3. Call pivGetData w/
                           • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                        4. Extract the value of the keyUsage extension field from
                           the certificate
                        5. Extract subjectPublicKeyInfo->algorithm->algorithm
                           field value
                        6. Match the algorithm value to Table 3-5 of SP80078
Expected Result(s)      If the public key algorithm is RSA, then the keyUsage extension shall
                        only assert the keyEncipherment bit. If the algorithm is Elliptic Curve
                        key, then the keyUsage extension shall only assert the keyAgreement
                        bit.


11.3.2.2 Verify asymmetric key pair

Purpose                 Confirms that the public key that exists in the certificate corresponds to
                        the private key on the card.
Reference(s)            1.    FIPS201, Section 5
                        2.    AS07.03.08
Precondition            1.    A valid PIV card is inserted into the contact reader.
                        2.    A valid PC/SC connection exists between the test application and
                              the contact reader.
                        3.    The test application is currently connected to the card application
                              which is accessible through card handle.
                        4.    A key management key and corresponding certificate are present on
                              the PIV card.




                                                                                               Page 132
