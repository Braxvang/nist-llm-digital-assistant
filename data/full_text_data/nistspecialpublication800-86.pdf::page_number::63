                                                      GUIDE TO INTEGRATING FORENSIC TECHNIQUES INTO INCIDENT RESPONSE



at port 80), many server applications can be run from any port number, so it is unwise to assume that
network traffic contains data from a certain application solely on the basis of server port number.

When loss of some application data is not a concern (e.g., streaming audio, video), the User Datagram
Protocol (UDP) is typically used. UDP involves less overhead and latency than TCP because UDP is
connectionless; one host simply sends data to another host without any preliminary negotiations. UDP is
also used for applications that are willing to take responsibility for ensuring reliable delivery of data, such
as DNS, and applications that are intended for use only on local area networks, such as Dynamic Host
Configuration Protocol (DHCP) and SNMP. As is the case with TCP, each UDP packet contains a source
port and a destination port. Although UDP and TCP ports are very similar, they are distinct from each
other and are not interchangeable. Some applications (such as DNS) can use both TCP and UDP ports;
although such applications typically use the same number for the TCP port and the UDP port, this is not
required.

6.1.3    IP Layer

The IP layer can also be called the network layer, because it is responsible for handling the addressing
and routing of data that it receives from the transport layer. The IP header contains a field called IP
Version, which indicates which version of IP is in use. Typically this is set to 4 for IPv4; but the use of
IPv6 is increasing, so this field may be set to 6 instead.84 Other significant IP header fields are as follows:

     ! Source and Destination IP Addresses. These are the “from” and “to” addresses that are
       intended to indicate the endpoints of the communication.85 Examples of IP addresses are
       10.3.1.70 (IPv4) and 1000:0:0:2F:8A:400:0427:9BD1 (IPv6).
     ! IP Protocol Number. This indicates which transport layer protocol the IP payload contains.86
       Commonly used IP numbers include 1 (Internet Control Message Protocol [ICMP]), 6 (TCP), 17
       (UDP), and 50 (Encapsulating Security Payload [ESP]).
The IP layer is also responsible for providing error and status information involving the addressing and
routing of data; it does this with ICMP. ICMP is a connectionless protocol that makes no attempt to
guarantee that its error and status messages are delivered. Because it is designed to transfer limited
information, not application data, ICMP does not have ports; instead, it has message types, which indicate
the purpose of each ICMP message.87 Some message types also have message codes, which can be
thought of as subtypes. For example, the ICMP message type Destination Unreachable has several
possible message codes that indicate what is unreachable (e.g., network, host, protocol). Most ICMP
messages are not intended to elicit a response.88

IP addresses are often used through a layer of indirection. When people need to access a resource on a
network, such as a Web server or e-mail server, they typically enter the server’s name, such as
www.nist.gov, rather than the server’s IP address. The name, also known as a domain name, is mapped

84
     There are other possible IP version numbers as well, although none are commonly used. The official list of valid IP Version
     field values is available at http://www.iana.org/assignments/version-numbers. This document assumes the use of IPv4, but
     the techniques described can easily be adapted for use with IPv6 (assuming that comparable tools are available that support
     IPv6).
85
     IP addresses are often inaccurate or misleading for identifying the actual endpoints of communication. Section 6.3 discusses
     this topic in more detail.
86
     The official list of valid IP Protocol Number values is available at http://www.iana.org/assignments/protocol-numbers.
87
     The current list of valid ICMP types is available at http://www.iana.org/assignments/icmp-parameters.
88
     ICMP is designed to limit responses, particularly to error messages. If ICMP had not been designed in this way, message
     loops could occur. For example, if Host A received an ICMP error message from Host B and responded with an error
     message, and Host B responded to that error message with an error message, the two hosts could continue sending error
     messages regarding the error messages.


                                                              6-3
