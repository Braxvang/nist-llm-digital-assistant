                                                                                             NIST SP 800-204                                                           SECURITY STRATEGIES FOR
                                                                                                                                                       MICROSERVICES-BASED APPLICATION SYSTEMS

                                                                                             policy implementation among APIs will have security implications for the entire microservices-
                                                                                             based application, although this applies only to coarse grained policies since fine grained policies
                                                                                             can only be specified closer to the microservice or in the microservice itself. Further, the
                                                                                             footprint for implementing access control in each microservices node can result in performance
                                                                                             issues in some nodes. Since multiple microservices nodes collaborate to perform a transaction,
                                                                                             performance problems associated with any node can quickly cascade across multiple services.
                                                                                             Taking into consideration these requirements, the strategies for secure identity and access
                                                                                             management to microservices are outlined below.

                                                                                             Security strategies for authentication (MS-SS-1):

                                                                                                •   Authentication to microservices APIs that have access to sensitive data should not be
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-204




                                                                                                    done simply by using API keys. Access to such APIs should require authentication tokens
                                                                                                    that have either been digitally signed (e.g., client credentials grant) or is verified with an
                                                                                                    authoritative source. Additionally, some services may require either single-use tokens or
                                                                                                    short-lived tokens (tokens that expire after a short time period) to limit the damage a
                                                                                                    compromised token can cause.
                                                                                                •   Authentication tokens should be handle-based (where initially a token reference is sent to
                                                                                                    Relying party (RP)), cryptographically signed, or protected by an Hash-based Method
                                                                                                    Authentication Code (HMAC) scheme.

                                                                                                •   Every API Key that is used in the application should have restrictions specified both for
                                                                                                    the applications (e.g., mobile app, IP address) and the set of APIs where they can be used.

                                                                                                •   The restriction scope for functionality of every API Key should be commensurate with
                                                                                                    the level of assurance provided during identity proofing, whether it be machine or human
                                                                                                    driven identity proofing.

                                                                                                •   When stateless authentication tokens (e.g., JSON Web Tokens (JWT)) are used by
                                                                                                    implementing shared libraries associated with a microservice, the following security
                                                                                                    precautions must be observed: (a) the token expiry times should be as short as possible
                                                                                                    since they determine the duration of the session and an active session cannot be revoked,
                                                                                                    and (b) the token secret key must not be a part of the library code; it must be a dynamic
                                                                                                    variable represented by an environmental variable or specified in an environment data file.
                                                                                                    The key value should be stored in a data vault solution.

                                                                                                •   If standards-based techniques such as OAuth or OpenID connect are implemented, they
                                                                                                    must be deployed securely [19].

                                                                                             Security strategies for access management (MS-SS-2):

                                                                                                •   Access policies to all APIs and their resources should be defined and provisioned to an
                                                                                                    access server. Access policies at a coarse level of granularity say “Permit to Call for a
                                                                                                    given set of addressable functionalities” should be defined and enforced at the initial API
                                                                                                    gateway while authorizations at the finer level of granularity (e.g., related to domain of
                                                                                                    the particular microservices’ business logic) should be defined and enforced closer to the
                                                                                                                                             18
