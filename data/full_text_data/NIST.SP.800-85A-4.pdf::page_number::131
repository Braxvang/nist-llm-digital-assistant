NIST SP 800-85A-4                                        PIV CARD APPLICATION & MIDDLEWARE
                                                                  INTERFACE TEST GUIDELINES

                      4. There exists a valid VCI connection to the card.
                      5. The value of the counter reference data (PUK) is recorded.
 Test Scenario        1. Repeat step 1 of test C.2.3.1 without secure messaging.
                      2. Repeat steps 2 and 5 of test C.2.3.1 using the '0C' CLA
                         byte
 Expected Result(s)   1. Step 1 referenced above returns the application property template
                         with the status word '90 00' at the end.
                      2. Steps 2 and 5 referenced above return an error status word.
 Postcondition(s)     Reference data associated with key reference is not changed. Retry
                      counter value associated with the key reference is not reset. The reset
                      counter value is unchanged.


C.2.4        GENERAL AUTHENTICATE card command

C.2.4.1        Contact Interface
 Purpose              Validates the GENERAL AUTHENTICATE command to:
                      1. Authenticate the PIV Card Application to the Test Toolkit
                          Application (INTERNAL AUTHENTICATE).
                      2. Authenticate the client application (EXTERNAL
                          AUTHENTICATE).
                      3. Two-way authentication of PIV Card Application and Test
                          Toolkit Application (MUTUAL AUTHENTICATE).
                      4. Sign with the '9C' digital signature private key.
                      5. Enable key-establishment functionality with the '9D' key
                          management private key.
                      6. Enable key history mechanism functionality with retired key
                          management private keys.
                      7. Ensure neither the PIV Secure Messaging key nor the associated
                          key-establishment protocol is used inappropriately.
 Reference(s)         1. SP 800-73-4 Part 2, Section 3.2.4
                      2. AS05.01, AS03.06, AS05.25, AS05.34 through AS05.36B
 Precondition(s)      1. The IUT is inserted into the contact reader.
                      2. There exists a valid PC/SC connection between the test system
                          and the contact reader.
                      3. The security status indicator is set to FALSE for all
                          authenticators.
 Test Scenario        1. Send  SELECT card command with
                         • AID == 'A0 00 00 03 08 00 00 10 00 01 00'
                      2. Perform step 2) of 2a in C.2.1.1 to verify cardholder’s
                         PIV Card Application PIN.
                      3. (Internal Authenticate using an asymmetric key) Send
                         GENERAL AUTHENTICATE card command
                         • CLA is set to:
                             • '00' if command chaining is not needed or



                                      C-30
