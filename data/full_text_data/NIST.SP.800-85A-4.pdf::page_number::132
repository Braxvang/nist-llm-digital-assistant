NIST SP 800-85A-4                                 PIV CARD APPLICATION & MIDDLEWARE
                                                           INTERFACE TEST GUIDELINES

                          •   '10' if command chaining is used. (The last chain
                              of the command sets CLA to '00')
                       • P1, algorithm reference, is set to '07' or '11'
                       • P2, key reference, is set to '9A' indicating the PIV
                          Authentication key
                       • Data field in the command is to include '81' specifying
                          a challenge, followed by a randomly generated
                          challenge, and '82 00' in order to request a response
                    NOTE: The following test invocation (step 4) is to be
                    performed only if the PIV Card Application supports the
                    symmetric Card Authentication key.
                    4. (Internal Authenticate using a symmetric key) Send GENERAL
                       AUTHENTICATE card command
                       • CLA is set to '00'
                       • P1, algorithm reference, is set to '00', '03','08',
                          '0A', or '0C'
                       • P2, key reference, is set to '9E' indicating the Card
                          Authentication key
                       • Data field in the command is to include '81' specifying
                          a challenge, followed by a randomly generated
                          challenge, and '82 00' in order to request a response
                    NOTE: The following four test invocations (5a, 5b, 6a, and
                    6b) are to be performed only if the PIV Card Application
                    supports the use of the '9B' key.
                    5. (Mutual Authenticate using a symmetric key)
                       5a. Send GENERAL AUTHENTICATE card command
                            • CLA is set to '00'
                            • P1, algorithm reference, is set to '00', '03',
                               '08', '0A', or '0C'
                            • P2, key reference, is set to '9B'
                            • Data field in the command is to include '80'
                               requesting a witness from the PIV Card Application
                       5b. Send GENERAL AUTHENTICATE card command
                            • CLA is set to '00'
                            • P1, algorithm reference is set to the same value
                               as specified in step 5a
                            • P2, key reference is set to '9B'
                           • Data field in the command is to include '80'
                               followed by decryption of the encrypted challenge
                               sent by the card application and '81' followed by
                               another challenge and then '82 00'
                    6. (External Authenticate using a symmetric key)
                       6a. Send GENERAL AUTHENTICATE card command
                           • CLA is set to '00'
                           • P1, algorithm reference, is set to '00', '03',
                               '08', '0A', or '0C'
                           • P2, key reference, is set to '9B'
                           • Data field in the command is to include '81'
                               followed by '00' indicating it is a request for
                               challenge
                       6b. Send GENERAL AUTHENTICATE card command
                            • CLA is set to '00'




                                  C-31
