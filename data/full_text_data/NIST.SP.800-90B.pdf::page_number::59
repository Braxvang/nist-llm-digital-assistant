                                                                                             NIST SP 800-90B                                                           RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                               USED FOR RANDOM BIT GENERATION

                                                                                             After all of the predictions are made, correct = (0, 0, 0, 1, 0, 1, 0, 0, 1). Then, ğ‘ƒğ‘ƒğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” = 0.3333,
                                                                                                â€²
                                                                                             ğ‘ƒğ‘ƒğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” = 0.7627, ğ‘ƒğ‘ƒğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ = 0.036, and the resulting min-entropy estimate is 0.3908.

                                                                                             6.3.8   The Lag Prediction Estimate

                                                                                             The lag predictor contains several subpredictors, each of which predicts the next output, based on
                                                                                             a specified lag. The lag predictor keeps a scoreboard that records the number of times that each
                                                                                             subpredictor was correct, and uses the subpredictor with the most correct predictions to predict the
                                                                                             next value.

                                                                                             Given the input S = (s1, â€¦, sL), where si Ïµ A = {x1, â€¦, xk},
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                                 1. Let D = 128, and N = L âˆ’1. Let lag be a list of D values, each initialized to Null. Let correct
                                                                                                    be a list of N Boolean values, each initialized to 0.
                                                                                                 2. Let scoreboard be a list of D counters, each initialized to 0. Let winner = 1.
                                                                                                 3. For i = 2 to L:
                                                                                                         a. For d = 1 to D:
                                                                                                                    i. If (d < i), lagd = siâˆ’d,
                                                                                                                   ii. Else lagd = Null.
                                                                                                         b. Let prediction = lagwinner.
                                                                                                         c. If (prediction = si,) let correcti-1 = 1.
                                                                                                         d. Update the scoreboard. For d = 1 to D:
                                                                                                                    i. If (lagd = si)
                                                                                                                              1. Let scoreboardd = scoreboardd +1.
                                                                                                                              2. If scoreboardd â‰¥ scoreboardwinner, let winner = d.
                                                                                                 4. Let C be the number of ones in correct.
                                                                                                                                                                                      ğ¶ğ¶
                                                                                                 5. Calculate the predictorâ€™s global performance as ğ‘ƒğ‘ƒğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” = ğ‘ğ‘ . The upper bound of the 99 %
                                                                                                                                                       â€²
                                                                                                    confidence interval on ğ‘ƒğ‘ƒğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” , denoted ğ‘ƒğ‘ƒğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” is calculated as:
                                                                                                                                                                 1
                                                                                                                                                  1 âˆ’ 0.01 ğ‘ğ‘ ,                               if ğ‘ƒğ‘ƒğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” = 0,
                                                                                                             â€²
                                                                                                          ğ‘ƒğ‘ƒğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” =ï¿½
                                                                                                                                                         ğ‘ƒğ‘ƒ            ï¿½1âˆ’ğ‘ƒğ‘ƒ            ï¿½
                                                                                                                           min(1, ğ‘ƒğ‘ƒğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” + 2.576ï¿½ ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” ğ‘ğ‘âˆ’1 ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” ),     otherwise

                                                                                                     where 2.576 corresponds to the ğ‘ğ‘(1âˆ’0.005) value.
                                                                                                 6. Calculate the predictorâ€™s local performance, based on the longest run of correct predictions.
                                                                                                    Let r be one greater than the length of the longest run of ones in correct. Use a binary
                                                                                                    search to solve the following for ğ‘ƒğ‘ƒğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ :
                                                                                                                                                          1 âˆ’ ğ‘ƒğ‘ƒğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ ğ‘¥ğ‘¥     1
                                                                                                                                           0.99 =                             Ã— ğ‘ğ‘+1 ,
                                                                                                                                                        (ğ‘Ÿğ‘Ÿ + 1 âˆ’ ğ‘Ÿğ‘Ÿğ‘Ÿğ‘Ÿ)ğ‘ğ‘      ğ‘¥ğ‘¥

                                                                                                                                                            51
