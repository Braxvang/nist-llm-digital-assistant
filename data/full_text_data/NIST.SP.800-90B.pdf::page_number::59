                                                                                             NIST SP 800-90B                                                           RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                               USED FOR RANDOM BIT GENERATION

                                                                                             After all of the predictions are made, correct = (0, 0, 0, 1, 0, 1, 0, 0, 1). Then, 𝑃𝑃𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 = 0.3333,
                                                                                                ′
                                                                                             𝑃𝑃𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 = 0.7627, 𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙 = 0.036, and the resulting min-entropy estimate is 0.3908.

                                                                                             6.3.8   The Lag Prediction Estimate

                                                                                             The lag predictor contains several subpredictors, each of which predicts the next output, based on
                                                                                             a specified lag. The lag predictor keeps a scoreboard that records the number of times that each
                                                                                             subpredictor was correct, and uses the subpredictor with the most correct predictions to predict the
                                                                                             next value.

                                                                                             Given the input S = (s1, …, sL), where si ϵ A = {x1, …, xk},
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                                 1. Let D = 128, and N = L −1. Let lag be a list of D values, each initialized to Null. Let correct
                                                                                                    be a list of N Boolean values, each initialized to 0.
                                                                                                 2. Let scoreboard be a list of D counters, each initialized to 0. Let winner = 1.
                                                                                                 3. For i = 2 to L:
                                                                                                         a. For d = 1 to D:
                                                                                                                    i. If (d < i), lagd = si−d,
                                                                                                                   ii. Else lagd = Null.
                                                                                                         b. Let prediction = lagwinner.
                                                                                                         c. If (prediction = si,) let correcti-1 = 1.
                                                                                                         d. Update the scoreboard. For d = 1 to D:
                                                                                                                    i. If (lagd = si)
                                                                                                                              1. Let scoreboardd = scoreboardd +1.
                                                                                                                              2. If scoreboardd ≥ scoreboardwinner, let winner = d.
                                                                                                 4. Let C be the number of ones in correct.
                                                                                                                                                                                      𝐶𝐶
                                                                                                 5. Calculate the predictor’s global performance as 𝑃𝑃𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 = 𝑁𝑁 . The upper bound of the 99 %
                                                                                                                                                       ′
                                                                                                    confidence interval on 𝑃𝑃𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 , denoted 𝑃𝑃𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 is calculated as:
                                                                                                                                                                 1
                                                                                                                                                  1 − 0.01 𝑁𝑁 ,                               if 𝑃𝑃𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 = 0,
                                                                                                             ′
                                                                                                          𝑃𝑃𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 =�
                                                                                                                                                         𝑃𝑃            �1−𝑃𝑃            �
                                                                                                                           min(1, 𝑃𝑃𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 + 2.576� 𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 𝑁𝑁−1 𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 ),     otherwise

                                                                                                     where 2.576 corresponds to the 𝑍𝑍(1−0.005) value.
                                                                                                 6. Calculate the predictor’s local performance, based on the longest run of correct predictions.
                                                                                                    Let r be one greater than the length of the longest run of ones in correct. Use a binary
                                                                                                    search to solve the following for 𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙 :
                                                                                                                                                          1 − 𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙 𝑥𝑥     1
                                                                                                                                           0.99 =                             × 𝑁𝑁+1 ,
                                                                                                                                                        (𝑟𝑟 + 1 − 𝑟𝑟𝑟𝑟)𝑞𝑞      𝑥𝑥

                                                                                                                                                            51
