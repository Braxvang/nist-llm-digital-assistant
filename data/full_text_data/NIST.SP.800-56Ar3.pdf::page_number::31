                                                                                               NIST SP 800-56A Rev. 3                            Recommendation for Pair-Wise Key Establishment
                                                                                                                                                         Using Discrete Logarithm Cryptography

                                                                                               5.     Cryptographic Elements
                                                                                               This section describes the basic computations that are performed and the assurances that need
                                                                                               to be obtained when performing DLC-based key establishment. The schemes described in
                                                                                               Section 6 are based upon the correct implementation of these computations and assurances.

                                                                                               5.1    Cryptographic Hash Functions
                                                                                               In this Recommendation, cryptographic hash functions may be used in key derivation and in
                                                                                               MAC-tag computation during key confirmation. An approved hash function shall be used
                                                                                               when a hash function is required. FIPS 180 and FIPS 202 specify approved hash functions.

                                                                                               5.2    Message Authentication Code (MAC) Algorithm
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                               A Message Authentication Code (MAC) algorithm defines a family of cryptographic
                                                                                               functions that is parameterized by a symmetric key. It is computationally infeasible to
                                                                                               determine the MAC of a (newly formed) MacData value without knowledge of the MacKey
                                                                                               value (even if one has seen the MACs corresponding to other MacData values that were
                                                                                               computed using that same MacKey value).
                                                                                               The input to a MAC algorithm includes a symmetric key, called MacKey and a binary data
                                                                                               string called MacData that serves as the “message.” That is, a MAC computation is
                                                                                               represented as MAC(MacKey, MacData). In this Recommendation, a MAC algorithm is used
                                                                                               if key confirmation is performed during key establishment (see Section 5.9); a (possibly
                                                                                               different) MAC algorithm may be used for the required key-derivation process (see Section
                                                                                               5.8 and SP 800-56C).
                                                                                               Key confirmation requires the use of an approved MAC algorithm, i.e., HMAC, AES-
                                                                                               CMAC or KMAC. HMAC is specified in FIPS 198 and requires the use of an approved hash
                                                                                               function. AES-CMAC is specified in SP 800-38B for the AES block cipher algorithm
                                                                                               specified in FIPS 197. KMAC is specified in SP 800-185.
                                                                                               When used for key confirmation, an entity is required to compute a MAC tag on received or
                                                                                               derived data using a MAC algorithm with a MacKey that is derived from a shared secret. The
                                                                                               MAC tag is sent to the other entity participating in the key-establishment scheme in order to
                                                                                               provide assurance that the shared secret or derived keying material was correctly computed.
                                                                                               MAC-tag computation and verification are defined in Sections 5.2.1 and 5.2.2.
                                                                                               If a MAC algorithm is employed in key derivation, an approved MAC algorithm shall be
                                                                                               selected and used in accordance with SP 800-56C.

                                                                                               5.2.1 MAC Tag Computation for Key Confirmation
                                                                                               Key confirmation can be performed as part of a key-agreement scheme.
                                                                                               The computation of a MAC tag (denoted MacTag) is represented as follows:
                                                                                                                        MacTag = TMacTagBits[MAC(MacKey, MacData)].
                                                                                               To compute a MacTag:



                                                                                                                                            20
