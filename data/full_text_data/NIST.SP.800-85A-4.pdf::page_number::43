NIST SP 800-85A-4                                                        PIV CARD APPLICATION & MIDDLEWARE
                                                                                  INTERFACE TEST GUIDELINES

AS04.08: The purpose of pivCrypt is to perform a cryptographic operation such as encryption
or signing on a sequence of bytes. 7

Required Test Procedures

TE04.08.01: The tester shall validate that the PIV Middleware implements the pivCrypt as per SP
800-73-4 Part 3.

AS04.08A-R4: If the value of keyReference is '04' (PIV Secure Messaging key) then the PIV
Middleware shall return PIV_INVALID_KEYREF_OR_ALGORITHM.

Note: This assertion is tested as part of AS04.08.

AS04.08B-R4: If the length of the algorithm output is longer than the buffer allocated by the
client application, then the PIV Middleware shall return PIV_INSUFFICIENT_BUFFER, but
shall still set outputLength to the length of the algorithm output.

Required Test Procedures

TE04.08B-R4.01: The tester shall ensure that the PIV Middleware returns
PIV_INSUFFICIENT_BUFFER if the length of the algorithm output is longer than the buffer
allocated by the client application.

A.4.4         Entry Points for Credential Initialization and Administration

A.4.4.1       pivPutData

AS04.09: The purpose of pivPutData is to replace the entire data content of the named data
object with the provided data.

Required Test Procedures

TE04.09.01: The tester shall validate that the PIV Middleware implements the pivPutData as per
SP 800-73-4 Part 3.

AS04.09A-R4: The PIV Middleware shall not submit data provided to the pivPutData
function over the contactless interface. If the PIV Middleware is not communicating with the
PIV Card via the cardâ€™s contact interface then the pivPutData function shall return
PIV_FUNCTION_NOT_SUPPORTED.

Required Vendor Information



7
  The pivCrypt function does not perform any cryptographic operations itself. It provides the interface to the GENERAL
AUTHENTICATE command to perform cryptographic operations on card. All cryptographic operations, except SM on
the client side, are performed outside the PIV Middleware.


                                                 A-15
