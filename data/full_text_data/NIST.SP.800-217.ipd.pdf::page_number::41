       NIST SP 800-217 ipd                          Guidelines for PIV Federation (Initial Public Draft)
       January 2023


1080   which IdP is to be used to access accounts for a given agency under the rules of the
1081   federation agreement.
1082   RPs X and Y wish to allow logins from agencies A, B, and C, and the RPs declare their
1083   intent and a list of required attributes to the federation authority. The federation authority
1084   assesses both RP requests and adds them to the multilateral federation. This allows both
1085   RPs to register at each of the three separate IdPs as needed for each agency.
1086   Both RPs interface directly with each of the three IdPs and not through a federation proxy.
1087   When a new IdP or RP is added to the multilateral federation agreement, the existing IdPs
1088   and RPs are notified of the new component and its parameters.
1089   The IdPs and RPs establish a shared signaling channel under the auspices of the
1090   federation authority. This allows any IdP and any RP to report suspicious or malicious
1091   behavior that involves a specific account to the rest of the members under the federation
1092   authority.

1093   A.3. Enterprise Application
1094   The home IdP establishes a pairwise agreement with an RP to provide an enterprise-
1095   class service to the subjects of the agencyâ€™s PIV identity accounts. As part of this trust
1096   agreement, the home IdP allows access to a provisioning API for the RP. The provisioning
1097   API pushes a set of federated identifiers and associated attributes to the RP that allow the
1098   RP to pre-provision RP subscriber accounts for every PIV identity account at the IdP.
1099   The existence of these RP subscriber accounts allows the RP to offer things like access
1100   rights, sharing, and messaging to all accounts on the system, whether or not the specific
1101   account has logged in to the RP yet.
1102   Under the terms of the trust agreement, the RP is placed on an allowlist. Consequently,
1103   subscribers are not prompted for consent at runtime because the agency consented to
1104   use the service on behalf of all accounts at the time the RP was onboarded. This gives
1105   subscribers a seamless single sign-on experience, even though a federation protocol is
1106   being used across security domain boundaries.
1107   The RP subscriber accounts are synchronized using the provisioning API. When a new
1108   PIV identity account is created, modified, or deleted at the IdP, the IdP updates the status
1109   of the RP subscriber account using the provisioning API. This allows the RP to always
1110   have an up-to-date status for each PIV identity account. For example, when the RP
1111   subscriber account is terminated at the IdP, the provisioning API signals to the RP that
1112   the RP subscriber account is to be terminated immediately. The RP removes all locally
1113   cached attributes for the account in question, except for the identifiers and references in
1114   audit and access logs.




                                                    31
