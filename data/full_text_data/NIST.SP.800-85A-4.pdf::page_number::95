NIST SP 800-85A-4                                        PIV CARD APPLICATION & MIDDLEWARE
                                                                  INTERFACE TEST GUIDELINES

 Precondition(s)       1. The client application owns a connection to the PIV Card
                          Application accessible through cardHandle.
                       2. The client is logged into the PIV Card Application.
 Test Steps            1. Set cardHandle := <<a valid cardHandle>>
                       2. Set keyReference := <<'04'>>
                       3. Set algorithmIdentifier := <<'27' or '2E'>>
                       4. Set algorithmInput := <<byte sequence compatible with the
                          type of authentication (see Section 4.1.8 of SP 800-73-4,
                          Part 2) encoded according to the format in the Dynamic
                          Authentication Template – Table 7 of SP 800-73-4 Part 2>>
                       5. Create algorithmOutput reference
                       6. Call pivCrypt with
                          • (IN) cardHandle
                          • (IN) algorithmIdentifier
                          • (IN) keyReference
                          • (IN) algorithmInput
                          • (IN) inputLength
                          • (OUT) algorithmOutput
                          • (INOUT) outputLength
 Expected Result(s)    Call returns with status_word of PIV_INVALID_KEYREF_OR_ALGORITHM.
 Postcondition(s)      The precondition states are unaffected.


B.9.2.4         Identify and Handle an Invalid Input Data
 Purpose                Ensure that the PIV Middleware identifies and handles input data
                        (algorithmInput) that is not compatible with the requested
                        algorithm/key combination.
 Target                pivCrypt
 Reference(s)          1. SP 800-73-4 Part 3, Section 3.3.1
                       2. AS04.08
 Precondition(s)       1. The client application owns a connection to the PIV Card
                          Application accessible through cardHandle.
                       2. The client is logged into the PIV Card Application.
 Test Steps            1. Set cardHandle := <<a valid cardHandle>>
                       2. Set keyReference := <<a key reference compatible with the
                          algorithmIdentifier input value>>
                       3. Set algorithmIdentifier := <<a recognized Algorithm
                          Identifier>>
                       4. Set algorithmInput := <<byte sequence not compatible with
                          the type of authentication and not encoded according to
                          the format in the Dynamic Authentication Template – Table
                          7 of SP 800-73-4 Part 2>>
                       5. Create algorithmOutput reference
                       6. Call pivCrypt with
                          • (IN) cardHandle
                          • (IN) algorithmIdentifier
                          • (IN) keyReference
                          • (IN) algorithmInput
                          • ((IN) inputLength



                                       B-29
