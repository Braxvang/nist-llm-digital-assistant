Special Publication 800-85B                                  PIV Data Model Testing Specification


Test Steps              1. Set cardHandle := <<valid card handle>>
                        2. Set OID := <<Card Authentication Certificate
                           (2.16.840.1.101.3.7.2.5.0)>>
                        3. Call pivGetData w/
                           • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                        4. Extract the piv-interim extension in the certificate
Expected Result(s)      The piv-interim extension is present and contains the interim_indicator
                        field which is of type BOOLEAN.


11.4.2.6 Verify asymmetric key pair

Purpose                 Confirms that the public key that exists in the certificate corresponds to
                        the private key on the card.
Reference(s)            1.    FIPS201, Section 5
                        2.    AS07.04.12
Precondition            1.    A valid PIV card is inserted into the contact reader.
                        2.    A valid PC/SC connection exists between the test application and
                              the contact reader.
                        3.    The test application is currently connected to the card application
                              which is accessible through card handle.
                        4.    A card authentication key and corresponding certificate are present
                              on the PIV card.
Test Steps              1.  Take an arbitrary stream of data
                        2.  Hash the data using a hash algorithm
                        3.  Set cardHandle := <<valid card handle>>
                        4.  Set authenticators := <<valid authenticator>>
                        5.  Call pivLogIntoCardApplication
                            • (IN) cardHandle
                            • (IN) authenticators
                        6. Set keyReference := <<key reference for card
                            Authentication Key i.e. 9E>>
                        7. Set algorithmIdentifier := <<identifier of the
                            algorithm to be used for the cryptographic operation>>
                        8. Set algorithmInput := <<hashed data from Step 2>>
                        9. Call pivCrypt with the following parameters
                            • (IN) keyReference
                            • (IN) algorithmIdentifier
                            • (IN) algorithmInput
                            • (OUT) algorithmOutput
                        10. Set OID := <<Card Authentication Certificate
                            (2.16.840.1.101.3.7.2.5.0)>>
                        11. Call pivGetData with the following parameters
                            • (IN) cardHandle
                            • (IN) OID
                            • (OUT) data
                        12. Verify the signature with subjectPublicKeyInfo-
                            >subjectPublicKey from the certificate
Expected Result(s)      The private key corresponds to the public key contained in the
                        certificate as the signature verification succeeds.


                                                                                                    Page 140
