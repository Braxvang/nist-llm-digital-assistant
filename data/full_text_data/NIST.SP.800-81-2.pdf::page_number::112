SECURE DOMAIN NAME SYSTEM (DNS) DEPLOYMENT GUIDE



12.   Guidelines on Securing Recursive Servers (Resolver) & Stub Resolvers

12.1 Setting up the Recursive Service

As discussed earlier in this document, the DNS consists of two basic components: Authoritative name
servers that publish DNS data, and DNS resolvers that issue queries for DNS data. Resolvers can be
further broken down into two general categories: Stub resolvers (often found on individual hosts) that
issue queries, but cannot follow DNS referrals, and recursive resolvers/servers that can follow referrals.
The typical set up within an enterprise is to have one or two recursive resolvers/servers providing DNS
resolution for all the stub resolvers on the network.

The security threats to an enterprise’s recursive resolver/server infrastructure differ slightly from the
security threats to its authoritative name servers. Likewise, the measures taken to secure a recursive
server differ from an authoritative name server.

12.1.1 Threats to Recursive Servers/Resolvers

Recursive and stub resolvers share a set of threats with authoritative name servers. These threats include
the general threats to the host platform (see Section 5.1) and threats to software used to perform DNS
transactions (see Section 5.2). However, since recursive (and stub) resolvers do not have zone files
(except the root hints file used by recursive resolvers) the administrator only needs to focus on
configuration files. The differences would be:

The threats to DNS data contents (Section 5.3) do not directly apply to recursive and stub resolvers as
they do not have control over the DNS information published; they only consume it.


12.1.2 Securing the Host Platform for Recursive Servers/Resolvers

Section 7 gives the basic steps in securing the host platform of any DNS component such as running the
latest version of software, isolating it on a dedicated server, being aware of known vulnerabilities.
Administrators should refer to the relevant Checklist Items from Section 7 with the knowledge that
recursive servers do not have zone files (except the root hints file) so there is no need to partition the file
as described in Section 7.2.8.

There are additional steps an administrator can take when setting up a recursive server for an enterprise.
Since it is unwise to allow queries from the outside Internet to the recursive server, the recursive server
can be placed behind a firewall that blocks inbound connections from UDP and TCP port 53 (used by
DNS).

Recursive servers should be configured to only accept queries from internal hosts. This is done using the
allow-query sub-statement as described in Section 8.1.1.


Checklist item 37: Recursive servers/resolvers should be placed behind an organization’s firewall and
configured to only accept queries from internal hosts (e.g., Stub Resolver host).


Stub resolvers do not have many configuration options. Often the only configuration necessary for an
administrator is to enter the IP addresses of one or more recursive resolvers that the stub would rely on to
service queries. It is a good idea for administrators to include at least two IP addresses of recursive


                                                     12-14
