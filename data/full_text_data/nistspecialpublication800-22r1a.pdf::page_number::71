     A STATISTICAL TEST SUITE FOR RANDOM AND PSEUDORANDOM NUMBER GENERATORS FOR CRYPTOGRAPHIC APPLICATIONS




     3.7 Non-Overlapping Template Matching Test
     This test rejects sequences exhibiting too many or too few occurrences of a given aperiodic pattern.

              (         )
     Let B = ε10 ,…,εm0 be a given word (template or pattern, i.e., a fixed sequence of zeros and ones) of
     length m. This pattern is to be chosen as if it were a parameter of the test. We consider a test based on
     patterns for fixed length m. A table of selected aperiodic words out of such patterns for m = 2, …, 8 is
     provided at the end of this section.
€
     The set of periods of B

                                   Β = { j,1 ≤ j ≤ m −1,ε 0j +k = εk0 ,k = 1,…,m − j} ,

     plays an important role. For example, when B corresponds to a run of m ones, Β = {1,…,m −1} . For the
     B above, Β = ∅, and B is an aperiodic pattern (i.e., it cannot be written as CC…CC′ for a pattern C
     shorter than B with€C' denoting a prefix of C). In this situation, occurrences of B in the string are non-
     overlapping.
                                                                           €
    €In general, let W = W (m, M) be the number of occurrences of €    the given pattern B in the string. Note
     that the statistic W is defined also for patterns B with Β = ∅. The best way to calculate W is as the sum,
                                               n−m +1

         €                               W = ∑ I (εi+k−1 = εk0 ,k = 1,…,m) .
                                             €
                                             i=1



                               (                        )
     The random variables I εi+k−1 = εk0 ,k = 1,…,m are m-dependent, so that the Central Limit Theorem
     holds for W. The mean and
                           € variance of the approximating normal distribution have the following form,
                                                            n − m +1
                  €                                 µ=               ,
                                                               2m

                                                        1 2m −1
                                                σ 2 = n m − 2m .
                                                       2    2 
                                        €
     For the test suite code, M and N are chosen so that n = MN and N = 8. Partition the original string into N
     blocks of length M. Let W j = W j (m, M) be the number of occurrences of the pattern B in the block j, for
     j = 1, …, N.                   €

     Let µ = EW j = (M − m + 1)2−m . Then, for large M, Wj has a normal distribution with mean µ and
                   €
     variance σ2, so that the statistic

                                                                            2

€                                            Χ 2 (obs) = ∑
                                                            N
                                                                  (W − µ)
                                                                    j
                                                                                                      (4)
                                                            j=1
                                                                    σ2



                                   €                         3-9
