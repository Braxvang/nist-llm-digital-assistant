NIST SP 800-219r1                                                       Automated Secure Configuration
July 2023                                                                    Guidance from the mSCP

3.4.3. macOS Security Compliance Tool
The {baseline}_compliance.sh script runs interactively by default. It can evaluate a system’s
conformance to a baseline or remediate any incorrectly configured settings. Alternatively, the
script can autonomously assess a system with the –check argument or automatically remediate
baseline settings with –fix.
The lines below provide an example of the results of running the script:
Thu Jan 21 15:09:41 UTC 2021 auth_pam_login_smartcard_enforce passed (Result:
2, Expected: {integer: 2})
Thu Jan 21 15:09:41 UTC 2021 auth_smartcard_allow passed (Result: 1,
Expected: {integer: 1})
Thu Jan 21 15:09:41 UTC 2021 auth_pam_sudo_smartcard_enforce passed (Result:
2, Expected: {integer: 2})
Thu Jan 21 15:09:41 UTC 2021
auth_smartcard_certificate_trust_enforce_moderate passed (Result: 2,
Expected: {integer: 2})
Thu Jan 21 15:09:41 UTC 2021 auth_smartcard_enforce has an exemption (Reason:
Broken Reader)

                             Fig. 3. Compliance Script Sample Output.

For more information on the macOS Security Compliance Tool script, see the wiki.

3.4.4. SCAP Generation Script
The SCAP generation script, generate_scap.py can generate an SCAP 1.3 document, XCCDF
document, or OVAL file. The script builds content from available tags within the YAML files
and does not need to be pointed to a baseline file.
For more information, see the wiki.

3.4.5. Generate Mapping Script
The generate_mapping.py script allows for the quick creation of custom rules and baselines for
a compliance framework not published by the mSCP. The script requires a user-created comma-
separated values (CSV) file containing control identifiers that maps to a new framework (CSV
column 1) from another already defined by the project (CSV column 2). By default, the script is
designed to map a framework to the NIST SP 800-53, Revision 5 [4] set of controls. Adding the
-f argument allows for mapping to another supported framework. See the wiki for more
information on the generate_mapping.py script.

       Customization
Organizations should make the risk-based decision on what controls and rules to use and how to
apply them, as stated by NIST SP 800-53, Revision 5 controls PL-10 and PL-11. Customization
allows organizations to generate their own customized content outside of that provided by the
project. Additionally, it allows them to add content for internal-only controls, which are not
suitable for inclusion in a global baseline. Customization primarily takes place within the custom
folder. Here are examples of customizations supported by mSCP:



                                                11
