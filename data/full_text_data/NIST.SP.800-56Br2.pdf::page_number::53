                                                                                               NIST SP 800-56B REV. 2                                       RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                                 USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                                          In the event that no such d exists, or in the very rare event that d ≤ 2nBits/2, discard the results
                                                                                                          of all computations and repeat the process, starting at step 2.
                                                                                                      5. Determine the modulus n as n = p × q, the product of p and q.
                                                                                                      6. Perform a pair-wise consistency test 20 by verifying that m is the same as (me)d mod n for
                                                                                                         some integer m satisfying 1 < m < (n − 1). If an inconsistency is found, output an indication
                                                                                                         of a pair-wise consistency failure, and exit without further processing.
                                                                                                      7. Output (n, e) as the public key and (n, d) as the private key.
                                                                                               Output:
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                                      1. (n, e): the RSA public key; and
                                                                                                      2. (n, d): the RSA private key in the basic format.
                                                                                               Errors: Indications of the following:
                                                                                                      1. The targeted security strength is not acceptable,
                                                                                                      2. The intended modulus bit length is not adequate for the targeted security strength,
                                                                                                      3. The intended exponent bit length is out of range, or
                                                                                                      4. Pair-wise consistency failure.
                                                                                               Note that key-pair validation, as specified in Section 6.4.1.3.1, can be performed after step 6 and
                                                                                               before step 7 of the process above. If an error is detected during the validation process, output an
                                                                                               indication of a key-pair validation failure, and exit without further processing.
                                                                                               A routine that implements this generation function shall destroy any local copies of p, q, and d, as
                                                                                               well as any other locally stored values used or produced during the execution of the routine. The
                                                                                               destruction of these locally stored values shall occur prior to or during any exit from the routine
                                                                                               (whether exiting early, because of an error, or exiting normally, with the output of an RSA key
                                                                                               pair). Note that the requirement for destruction includes any locally stored portions of the output
                                                                                               key pair.

                                                                                               6.3.2.2 rsakpg2-prime-factor
                                                                                               rsakpg2-prime-factor is the generator in the RSAKPG2 family such that the private key is in the
                                                                                               prime-factor format (p, q, d).
                                                                                               Function call: rsakpg2-prime-factor(s, nBits, eBits)
                                                                                               The inputs, outputs and errors are the same as in rsakpg2-basic (see Section 6.3.2.1) except that
                                                                                               the private key is in the prime-factor format: (p, q, d).
                                                                                               The steps are the same as in rsakpg2-basic except that processing Step 7 is replaced by the
                                                                                               following:
                                                                                                      7. Output (n, e) as the public key, and (p, q, d) as the private key.

                                                                                               20
                                                                                                    Although the previous steps should have theoretically produced a valid key pair, this step is required to ensure that
                                                                                                    implementation errors do not result in an invalid key pair.
                                                                                                                                                           43
