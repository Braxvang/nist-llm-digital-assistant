                                                                                               NIST SP 800-56A Rev. 3                              Recommendation for Pair-Wise Key Establishment
                                                                                                                                                           Using Discrete Logarithm Cryptography


                                                                                                                        1. Compute                        1. Compute
                                                                                                Derive Secret              DerivedKeyingMaterial             DerivedKeyingMaterial
                                                                                                Keying Material
                                                                                                                        2. Destroy Z                      2. Destroy Z

                                                                                               6.1.1.2 (Cofactor) Full Unified Model, C(2e, 2s, ECC CDH) Scheme
                                                                                               This section describes the Full Unified Model scheme. Assurance of secure key
                                                                                               establishment using this scheme can only be obtained when the assumptions in Section 6.1.1
                                                                                               are true. In particular, it is assumed that party U has obtained the static public key Qs,V of
                                                                                               party V, and party V has obtained the static public key Qs,U of party U.
                                                                                               With the exception of key derivation, the Full Unified Model scheme is “symmetric” in the
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                               actions of parties U and V. Only the actions performed by party U are specified here; a
                                                                                               specification of the actions performed by party V may be obtained by systematically
                                                                                               replacing the letter “U” by “V” (and vice versa) in the actions listed below. Note, however,
                                                                                               that parties U and V must use identical orderings of the bit strings that are input to the key-
                                                                                               derivation method.
                                                                                               Party U shall execute the following actions to a) establish a shared secret value Z with party
                                                                                               V, and b) derive secret keying material from Z.
                                                                                               Actions: Party U generates a shared secret and derives secret keying material as follows:
                                                                                                  1. Generate an ephemeral key pair (de,U, Qe,U) from the domain parameters D as specified
                                                                                                     in Section 5.6.1.2. Send the public key Qe,U to party V. Receive an ephemeral public
                                                                                                     key Qe,V (purportedly) from party V. If Qe,V is not received, destroy the ephemeral
                                                                                                     private key de,U; then output an error indicator, and exit this process without
                                                                                                     performing the remaining actions.
                                                                                                  2. Verify that Qe,V is a valid ephemeral public key for the parameters D as specified in
                                                                                                     Section 5.6.2.3. If assurance of public key validity cannot be obtained, destroy the
                                                                                                     ephemeral private key de,U, then output an error indicator, and exit this process
                                                                                                     without performing the remaining actions.
                                                                                                  3. Use the ECC CDH primitive in Section 5.7.1.2 to derive a shared secret Zs from the
                                                                                                     set of domain parameters D, party U’s static private key ds,U, and party V’s static
                                                                                                     public key Qs,V. If the call to the ECC CDH primitive outputs an error indicator,
                                                                                                     destroy the ephemeral private key de,U, and destroy the results of all intermediate
                                                                                                     calculations used in the attempted computation of Zs; then output an error indicator,
                                                                                                     and exit this process without performing the remaining actions.
                                                                                                  4. Use the ECC CDH primitive to derive a shared secret Ze from the set of domain
                                                                                                     parameters D, party U’s ephemeral private key de,U, and party V’s ephemeral public
                                                                                                     key Qe,V. If this call to the ECC CDH primitive outputs an error indicator, destroy Zs
                                                                                                     and the ephemeral private key de,U, and destroy the results of all intermediate
                                                                                                     calculations used in the attempted computation of Ze; then output an error indicator,
                                                                                                     and exit this process without performing the remaining actions.
                                                                                                  5. Compute the shared secret Z = Ze || Zs. Destroy Ze and Zs.

                                                                                                                                             70
