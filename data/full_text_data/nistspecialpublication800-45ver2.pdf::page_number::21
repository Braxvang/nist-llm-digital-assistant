                                                                                    GUIDELINES ON ELECTRONIC MAIL SECURITY



 New SMTP commands (RFC 1425)
 Registry for SMTP service extensions (RFC 1651)
 Additional parameters for SMTP MAIL FROM and RCPT TO commands (RFC 1869).
To be compatible with older SMTP servers, there needed to be a method to allow the mail client
application to determine whether the server supported extensions. This was accomplished through the
“enhanced hello” (EHLO) command. When connecting to a server, a mail client could issue the EHLO
command. If the server supported SMTP extensions, it would give a successful response and list the
extensions that were supported. If the server did not support SMTP extensions, it would issue a command
failure response prompting the MUA to respond with the standard HELO command. Servers that support
SMTP extensions, also known as Extended SMTP (ESMTP), typically respond with ESMTP in their
banner. 4 Figure 2.4 is an excerpt from an ESMTP server transaction involving the EHLO command.


                           telnet mail.nowhere.com 25
                           Connected to mail.nowhere.com.
                           Escape character is '^]'.
                           220 test.mail.com ESMTP Service (Sample Mail Server String)
                           EHLO
                           250 test.mail.com says hello
                           250-HELP
                           250-EXPN
                           250 SIZE 20971520
                           …


                                        Figure 2.4: Sample ESMTP Conversation




As depicted in Figure 2.4, the sample server supports only one extension – SIZE. Numerous extensions
are supported by a variety of SMTP servers. Table 2.1 lists some of the more common SMTP extensions
and their associated RFCs. In particular, RFC 2554 specifies a new command and protocol for
identifying and authenticating a user. The default configuration of most mail servers typically does not
have authenticated relay enabled.




4
    Many application services (e.g., email, Web, File Transfer Protocol) that operate on a server respond to a client request with
    a banner. This banner is a text message that contains information on the server such as application and operating system
    type and version. This information can be useful to attackers and should be changed as discussed later in the document.
    Most mail clients do not display this banner to the end user.

                                                              2-5
