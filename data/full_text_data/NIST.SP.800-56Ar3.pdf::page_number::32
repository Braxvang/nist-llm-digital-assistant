                                                                                               NIST SP 800-56A Rev. 3                                 Recommendation for Pair-Wise Key Establishment
                                                                                                                                                              Using Discrete Logarithm Cryptography

                                                                                                     1. The agreed-upon MAC algorithm (see Section 5.2) is used with MacKey to compute
                                                                                                        the MAC of MacData, where MacKey is a symmetric key, and MacData represents
                                                                                                        the input “message” data. The minimum length of MacKey is specified in Table 5 of
                                                                                                        Section 5.9.3.
                                                                                                         MacKey is obtained from the DerivedKeyingMaterial (when a key-agreement scheme
                                                                                                         employs key confirmation), as specified in Section 5.9.1.
                                                                                                         The output of the MAC algorithm is a bit string whose length (in bits) is
                                                                                                         MacOutputBits.
                                                                                                     2. Those bits are input to the truncation function TMacTagBits, which returns the leftmost
                                                                                                        (i.e., initial) bits of MacTagBits to be used as the value of MacTag. MacTagBits shall
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                                        be less than or equal to MacOutputBits. (When MacTagBits equals MacOutputBits,
                                                                                                        TMacTagBits acts as the identity function.) The minimum value for MacTagBits is 64, as
                                                                                                        specified in Section 5.9.3.

                                                                                               5.2.2 MAC Tag Verification for Key Confirmation
                                                                                               To verify a received MacTag (i.e., received during key confirmation), a new MAC tag,
                                                                                               MacTag is computed using the values of MacKey, MacTagBits, and MacData possessed by
                                                                                               the recipient (as specified in Section 5.2.1). MacTag is compared with the received MacTag.
                                                                                               If their values are equal, then it may be inferred that the same MacKey, MacTagBits, and
                                                                                               MacData values were used in the two MAC tag computations.

                                                                                               5.3       Random Number Generation
                                                                                               Whenever this Recommendation requires the use of a randomly generated value (for
                                                                                               example, for obtaining keys or nonces), the values shall be generated using an approved
                                                                                               random bit generator that supports the targeted security strength (see the SP 800-9013 series
                                                                                               of publications).

                                                                                               5.4       Nonce
                                                                                               A nonce is a time-varying value that has an acceptably small chance of repeating (where the
                                                                                               meaning of “acceptably small” may be application specific). In certain schemes specified in
                                                                                               this Recommendation, a party may be required to provide a (public) nonce that is used for
                                                                                               key-agreement and/or key-confirmation purposes. This circumstance arises when a scheme
                                                                                               does not require that a party provide an ephemeral public key to the other party as part of the
                                                                                               key-establishment process.
                                                                                               This Recommendation requires the use of a nonce (supplied by Party U) in the C(0e, 2s) key-
                                                                                               agreement schemes specified in Section 6.3. A nonce (supplied by party V) is also required
                                                                                               by the C(1e, 2s) and C(0e, 2s) schemes when party V obtains key confirmation from party U



                                                                                               13
                                                                                                    SP 800-90A, Recommendation for Random Number Generation Using Deterministic Random Bit
                                                                                                    Generators; SP800-90B, Recommendation for the Entropy Sources Used for Random Bit Generation; SP
                                                                                                    800-90C, Recommendation for Random Bit Generator (RBG) Constructions.

                                                                                                                                                 21
