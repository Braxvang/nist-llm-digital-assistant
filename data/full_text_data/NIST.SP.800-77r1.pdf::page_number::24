                                                                                              NIST SP 800-77 REV. 1                                                          GUIDE TO IPSEC VPNS


                                                                                                 •   Replay Protection. The same data will not be accepted multiple times, and data is not
                                                                                                     accepted grossly out of order. This prevents attackers from copying and retransmitting
                                                                                                     valid IPsec encrypted data for malicious purposes. IPsec (like UDP) does not ensure that
                                                                                                     data is delivered in the exact order in which it was sent. The receiver has a Replay
                                                                                                     Window where it will store out-of-order received messages before decrypting and
                                                                                                     delivering these messages to the operating system in the right order.
                                                                                                 •   Traffic Analysis Protection. When IPsec’s tunnel mode is used (see Section 4.1.1), a
                                                                                                     person monitoring network traffic does not know which parties are communicating, how
                                                                                                     often communications are occurring, or how much data is being exchanged. While the
                                                                                                     number and size of the encrypted packets being exchanged can be counted, the traffic
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                                     flow confidentiality (TFC) capabilities of ESP can pad all packets to a single length
                                                                                                     (usually the maximum transmission unit [MTU]), and dummy packets can be sent to
                                                                                                     further obfuscate the timing of the actual communication.
                                                                                                 •   Access Control. IPsec endpoints can perform filtering to ensure that only authorized
                                                                                                     IPsec users can access particular network resources. IPsec endpoints can also allow or
                                                                                                     block certain types of network traffic, such as allowing web server access but denying
                                                                                                     file sharing. This is called policy-based IPsec. Routing-based IPsec accepts all traffic at
                                                                                                     the IPsec policy layer, but both endpoints filter valid traffic by setting routes into a
                                                                                                     specific IPsec interface. In other words, the routing table acts as the policy filter.
                                                                                                     Policy-based IPsec is more secure than routing-based IPsec, as the security of the policy
                                                                                                     works independently from the security of the remote endpoint. Policy-based IPsec is not
                                                                                                     vulnerable to accidental or malicious routing table changes, and it prevents leaking
                                                                                                     packets to the local network, since local packets do not use the routing table. IPsec-based
                                                                                                     access control works independently from other access control mechanisms, such as
                                                                                                     firewall services or other mandatory access control mechanisms.
                                                                                                 •   Perfect Forward Secrecy (PFS). IPsec endpoints create session keys that are changed
                                                                                                     frequently, typically once an hour. Afterwards, the endpoints wipe the old session keys
                                                                                                     from volatile memory, and no entities are left with a copy of these private decryption
                                                                                                     keys. Since expired keys are not saved, any encrypted traffic monitored and stored cannot
                                                                                                     be decrypted at a later time by compromising an IPsec endpoint and obtaining the
                                                                                                     encryption/decryption keys belonging to past IPsec sessions.
                                                                                                     Normally, new keys are generated based on the generated shared secret of the original
                                                                                                     key exchange using a key derivation function (KDF). To guarantee that new key material
                                                                                                     has no relationship to the old key exchange, fresh session keys can, optionally, be
                                                                                                     generated by performing a new Diffie-Hellman (DH) key exchange instead of reusing the
                                                                                                     old key exchange’s generated shared secret to generate new session keys. This method of
                                                                                                     using a fresh key exchange provides perfect forward secrecy (PFS). When resources
                                                                                                     allow, PFS should be used.
                                                                                                 •   Mobility. The outer IP address of an endpoint can change without causing an interruption
                                                                                                     to the encrypted data flow. Since the application is communicating using the inner
                                                                                                     (encrypted) IP address, it does not matter that the outer IP address changes. This allows a
                                                                                                     device to switch from WiFi to Ethernet to mobile data without application interruption.



                                                                                                                                               7
