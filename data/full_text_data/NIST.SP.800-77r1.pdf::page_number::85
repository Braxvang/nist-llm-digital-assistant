                                                                                              NIST SP 800-77 REV. 1                                                                                GUIDE TO IPSEC VPNS


                                                                                              VPN configurations do not allow a single user to log onto multiple devices simultaneously, so it
                                                                                              is always better to generate a certificate per device rather than per user.

                                                                                              Two IPsec endpoints will trust the validity of the presented peer certificate if a CA that they both
                                                                                              trust has signed their certificates. 54 The certificates must be securely stored in the local certificate
                                                                                              store on the IPsec hosts and gateways or on a secure hardware token. Using a certificate-based
                                                                                              method allows much of the key administration to be offloaded to a central certificate server but
                                                                                              still requires IPsec administrators to perform some key management activities, such as
                                                                                              provisioning hosts with credentials, either through IPsec vendor-provided features or IPsec
                                                                                              administrator-created capabilities. Many organizations implement a public key infrastructure
                                                                                              (PKI) for managing certificates for IPsec VPNs and other applications, such as secure email and
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              web access. 55 Certificates can be issued to limit their use using EKU attributes. Some IPsec hosts
                                                                                              insist on IPsec-specific EKUs, while others accept the TLS-based EKUs (serverAuth or
                                                                                              clientAuth) and some ignore all EKUs. The IETF PKI standard for IKE EKUs is specified in
                                                                                              RFC 4945 [60]. A certificate issued for secure email might not be usable for IPsec on some of
                                                                                              the VPN gateways deployed in an organization. Issuing certificates per device instead of per user
                                                                                              avoids this issue and has the additional advantage that if a device is lost or stolen, not all of the
                                                                                              userâ€™s VPN access will need to be revoked.

                                                                                              Although the certificate authentication method scales well to large implementations and provides
                                                                                              a much stronger security solution than PSKs, it does have some disadvantages. While certificates
                                                                                              can be revoked and transmitted to the VPN servers via CRLs [61] in bulk or on demand via
                                                                                              OCSP [62], these mechanisms typically provide no option for temporarily disabling a certificate.
                                                                                              Additional complications can occur when the connection to the OCSP server itself is down or,
                                                                                              worse, requires an IPsec tunnel to be negotiated that needs to use that OCSP server. Non-
                                                                                              standard solutions using a AAA server or a pluggable authentication module (PAM
                                                                                              authentication) are usually added for such use cases.

                                                                                              Another potential problem with the certificate authentication method involves packet
                                                                                              fragmentation. Packets in an IKE negotiation are typically relatively small and do not need to be
                                                                                              fragmented. By adding certificates to the negotiation, packets may become so large that they
                                                                                              need to be fragmented, which is not supported by some IPsec implementations.

                                                                                              7.2.2.3 Raw public key digital signatures

                                                                                              Raw public key digital signatures work the same way as certificate-based digital signatures,
                                                                                              except that instead of trusting a certificate (directly or indirectly via a CA), the trust is placed in
                                                                                              the public key itself. Keys are usually represented in base64 format or using just the SPKI part of
                                                                                              a certificate.




                                                                                              54   This describes the most common CA model; other models, such as the Federal Bridge CA, function somewhat differently.
                                                                                              55   PKI implementations require a considerable investment in time and resources. It is outside of the scope of this document to
                                                                                                   discuss a PKI in detail. See NIST SP 800-32, Introduction to Public Key Technology and the Federal PKI Infrastructure, for
                                                                                                   more information [59].



                                                                                                                                                            68
