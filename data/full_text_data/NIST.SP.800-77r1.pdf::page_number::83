                                                                                              NIST SP 800-77 REV. 1                                                          GUIDE TO IPSEC VPNS


                                                                                              control IPsec configuration settings, the administrators might need to manually configure each
                                                                                              IPsec client or rely on users to follow instructions and configure the clients themselves. The
                                                                                              latter approach is often challenging for non-technical users.

                                                                                              7.2.1.3 Host Address Space Management

                                                                                              In remote access VPN architectures where the hosts are outside of the organization (e.g., mobile
                                                                                              devices, remote workers), the VPN client will receive an additional IP address from the
                                                                                              organization’s address space assigned as a virtual IP address to each external IPsec host. The
                                                                                              client will then establish an IPsec connection that uses its real IP address in the external packet
                                                                                              headers (so that the IPsec-encapsulated packets can be routed across public networks) and its
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              virtual IP address in the internal packet headers (so that the packets can be routed across the
                                                                                              organization’s internal networks and treated as internally generated).

                                                                                              Virtual addresses can be assigned from an address pool that resides on the VPN server. The VPN
                                                                                              server can also use the DHCP relay protocol or a AAA service, such as RADIUS or Diameter, to
                                                                                              obtain an IP address. A local pool can provide an easier indication that the IP address accessing a
                                                                                              local resource is originating from a VPN client or is a client connecting from a certain region.

                                                                                              It is important to ensure that any addresses managed by the IPsec gateway are excluded from the
                                                                                              ranges that other internal DHCP servers can assign to avoid address conflicts. Some vendors
                                                                                              provide internal address assignment and authentication using proprietary functionality. This may
                                                                                              present compatibility issues depending on the products being used.

                                                                                              When deploying a remote access VPN in a data center or cloud where the only service offered is
                                                                                              the VPN server without any other local resources, non-routable IP addresses, such as those
                                                                                              defined in RFC 1918 [41], can be used for the address pool of virtual IPs for the VPN clients.
                                                                                              The VPN server then uses NAT to translate these IP addresses to its own public IP address. One
                                                                                              potential issue with such a deployment is that some websites limit the number of users or
                                                                                              connections coming from a single IP address. If dozens or hundreds of website users appear to
                                                                                              all come from one VPN server public IP address, the website might block the IP address because
                                                                                              it assumes that it is a malicious entity that obtained the credentials of many users. Using multiple
                                                                                              public IP addresses on such a VPN server deployment could mitigate this problem.

                                                                                              7.2.2   IKE Authentication

                                                                                              The endpoints of a host-to-host and gateway-to-gateway IPsec architecture typically use the
                                                                                              same authentication method to validate each other. Validation for remote access VPNs tend to
                                                                                              use different mechanisms to authenticate each other, such as when the server is authenticated
                                                                                              using a machine certificate, and clients are authenticated using EAP-TLS. IPsec implementations
                                                                                              typically support a number of authentication methods. The most common methods are
                                                                                              certificate-based digital signatures or raw public keys, EAP, and PSK. When using IKEv1, a
                                                                                              group PSK combined with a username and password is also common. This section discusses the
                                                                                              primary advantages and disadvantages of these methods.

                                                                                              PSKs should only be used for gateway-to-gateway scenarios that cross an administrative domain
                                                                                              and only when based on generating strong and sufficiently long random PSKs with at least 112


                                                                                                                                               66
