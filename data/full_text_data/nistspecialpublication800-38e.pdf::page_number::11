                                NIST Special Publication 800-38E


only data units that are sequences of complete blocks. In this case, the ciphertext stealing
components in the implementations of the XTS-AES-Enc and the XTS-AES-Dec procedures
would be unnecessary, and these procedures essentially would be reduced to the XTS-AES-
blockEnc and the XTS-AES-blockDec procedures, as specified in Ref. [2].

Similarly, an implementation may restrict its support to either the 256-bit key size (for XTS-
AES-128) or the 512-bit key size (for XTS-AES-256).

Restrictions on the supported lengths of the key or the data units may affect interoperability with
other implementations.

Conformance testing for implementations of XTS-AES is conducted within the framework of the
Cryptographic Module Validation Program (CMVP), a joint effort of NIST and the
Communications Security Establishment Canada.

5 Ordering Convention for the Ciphertext Stealing Case

If the length of the data units for an instance of XTS-AES is not an integral multiple of the block
size, then the specification in Ref. [2] denotes the unencrypted form of a data unit, i.e., the
plaintext, as a sequence of complete blocks, P0, P1, …Pm-1, followed by a single, non-empty
partial block Pm, where m is a positive integer determined by the length of the data unit.

In this case, the encrypted form of the data unit, i.e., the ciphertext, has the same structure: a
sequence of complete blocks, denoted C0, C1, …Cm-1, followed by a single, non-empty partial
block Cm, whose length is the same as the length of Pm.

For some implementations, an alternative ordering convention, in which the positions of Cm-1 and
Cm are swapped, may be desirable for the physical storage of the bits, because that ordering
corresponds more closely with the generation of the ciphertext. In particular, Cm is the truncation
of a block that is derived from Pm-1, and Cm-1 is derived from Pm, concatenated with the discarded
bits from the truncation.

Subclause 5.1 of [2] indicates that an implementation of XTS-AES should include a mapping
between the pairs of indices that define the blocks (and possibly a single partial block) of a data
unit and their physical location in the storage device, but that the mapping itself is outside the
scope of the standard.

Thus, if every external interface to the data retrieves the data in a manner that is consistent with
the ordering specified in Ref [2], then the last block and the partial block may be stored in any
convenient locations in the storage device. In other words, if necessary, a mechanism for
swapping the last complete block and the partial block could be built into the interface.




                                                 3
