                                                                                               NIST SP 800-56A Rev. 3                                       Recommendation for Pair-Wise Key Establishment
                                                                                                                                                                    Using Discrete Logarithm Cryptography

                                                                                                          •    If q is an odd prime p, verify that (yQ)2 = ((xQ)3 + axQ + b) mod p.
                                                                                                          •    If q = 2m, verify that (yQ)2 + xQ yQ = (xQ)3 + a(xQ)2 + b in GF(2m), where the
                                                                                                               arithmetic is performed as dictated by the field representation parameter FR.
                                                                                                          Success at this stage ensures that the public key is a point on the correct elliptic curve.
                                                                                                      4. Compute nQ (using elliptic curve arithmetic), and verify that nQ = Ø.
                                                                                                          Success at this stage ensures that the public key has the correct order. Along with the
                                                                                                          successful verifications in the previous steps, this step ensures that the public key is
                                                                                                          in the correct elliptic-curve subgroup and is not the identity element.
                                                                                               Output: If any of the above verifications fail, immediately output an error indicator and
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                               exit without further processing. Otherwise, output an indication of successful validation.

                                                                                               5.6.2.3.4 ECC Partial Public-Key Validation Routine
                                                                                               ECC partial public-key validation refers to the process of checking some (but not all) of the
                                                                                               arithmetic properties of a candidate ECC public key to ensure that it has the expected
                                                                                               representation for a non-identity element of the correct elliptic-curve group, as specified by
                                                                                               the associated ECC domain parameters. ECC partial public-key validation omits the
                                                                                               validation of subgroup membership23, and therefore, is usually faster than ECC full public-
                                                                                               key validation.
                                                                                               This routine shall only be used when assurance of partial public-key validity is acceptable
                                                                                               for an ephemeral ECC public key.
                                                                                               Input:
                                                                                                  1. (q, FR, a, b{, SEED}, G, n, h): A valid set of ECC domain parameters, and
                                                                                                  2. Q = (xQ, yQ): A candidate ECC public key.
                                                                                               Process:
                                                                                                  1. Verify that Q is not the identity element Ø.
                                                                                                          Success at this stage ensures that Q is not the identity element of the elliptic-curve
                                                                                                          group (which would never be the value of a properly generated public key).
                                                                                                      2. Verify that xQ and yQ are integers in the interval [0, p − 1] in the case that q is an odd
                                                                                                         prime p, or that xQ and yQ are bit strings of length m bits in the case that q = 2m.
                                                                                                          Success at this stage ensures that each coordinate of the public key has the expected
                                                                                                          representation for an element in the underlying field, GF(q).
                                                                                                      3. Verify that Q is on the curve. In particular,
                                                                                                          •    If q is an odd prime p, verify that (yQ) 2 = ((xQ)3 + axQ + b) mod p.



                                                                                               23
                                                                                                    In this Recommendation, co-factor multiplication is included in the ECC primitives for Diffie-Hellman and
                                                                                                    MQV, which forces the computed group element into the appropriate subgroup.

                                                                                                                                                      45
