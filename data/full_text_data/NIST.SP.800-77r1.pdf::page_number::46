                                                                                              NIST SP 800-77 REV. 1                                                                                GUIDE TO IPSEC VPNS


                                                                                              PSKs are often derived from dictionary words and are less than 32 characters long. Such insecure
                                                                                              deployments are vulnerable to offline dictionary attacks. 30 PSKs must have a high entropy value.
                                                                                              A good PSK is pseudorandomly created and has at least 128 bits of entropy.

                                                                                              3.3.5     NULL Authentication

                                                                                              NULL authentication is a special kind of authentication. It really means that no authentication is
                                                                                              required. There are two common use cases for this.

                                                                                              The first use case is to deploy IPsec to a large number of nodes (i.e., hosts) where the goal is to
                                                                                              only protect against passive attacks. It does not protect against attackers that can perform a man-
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              in-the-middle attack. An advantage is that no authentication system (e.g., certificates, EAP, or
                                                                                              DNSSEC) needs to be deployed. For small-scale deployments, this method should never be used,
                                                                                              and strong PSKs should be used instead. Sometimes a NULL authentication deployment is
                                                                                              gradually upgraded to an authenticated deployment.

                                                                                              The second use case only uses NULL authentication for the initiator client. The responder (i.e.,
                                                                                              the server) still authenticates itself to the initiator using another authentication method, such as a
                                                                                              machine certificate. This creates a situation that is similar to HTTPS-based websites: the client
                                                                                              remains anonymous, but the server is authenticated. This is the method used for internet-based
                                                                                              opportunistic IPsec, where two IPsec hosts attempt to establish an IPsec connection without a
                                                                                              preexisting configuration or knowledge of each other. This usually involves authentication based
                                                                                              on DNSSEC or a widely acknowledged CA such as Let’s Encrypt. 31 The advantage of this type
                                                                                              of deployment is that only the servers need to have an identity for authentication. The clients
                                                                                              (usually laptops and phones) do not need to have any kind of identity and can remain
                                                                                              anonymousat least at the network layer. Similar to HTTPS, the application layer might require
                                                                                              the client to authenticate before it is allowed to access a particular resource.

                                                                                              NIST does not approve the use of NULL authentication-based IPsec. Any deployment of NULL
                                                                                              authenticated IPsec shall be categorized as being identical to plaintext unprotected network
                                                                                              traffic.

                                                                                              3.4     Network Address Translation (NAT)

                                                                                              During the IKE_SA_INIT exchange, both endpoints exchange information about what they
                                                                                              believe their IP address is. 32 The other end of the communication will confirm whether the
                                                                                              information matches the source address of the packet it received. If the endpoints detect that a
                                                                                              NAT is present, they will move further IKE communication from port 500 to port 4500.
                                                                                              Changing the UDP port was originally done to prevent bad interactions with NAT devices that



                                                                                              30    Technically, the attacker needs to man-in-the-middle the VPN client for one IKE_INIT and IKE_AUTH exchange; then the
                                                                                                    attacker can go offline for the dictionary attack.
                                                                                              31    Let’s Encrypt is a non-profit CA that has automated the deployment of free SSL/TLS certificates used to secure website
                                                                                                    communication, but their certificates can be used for IKE/IPsec as well. See https://www.letsencrypt.org.
                                                                                              32    Technically, they exchange SHA-1 hashes of their IP addresses so as to add some level of privacy regarding the pre-NAT IP
                                                                                                    addresses used.



                                                                                                                                                            29
