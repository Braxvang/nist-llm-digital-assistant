NIST SP 800-166                                                                        DERIVED PIV APPLICATION AND
                                                                                       DATA MODEL TEST GUIDELINES

                                   2. From Step 2, the command returns the requested data object
                                      along with the status word '90 00'.
                                   3. From Step 4, the exponent of the RSA asymmetric key for
                                      digital signature is equal to 65 537.

9.3.3 X.509 Certificate for Key Management 20

9.3.3.1 Signature Algorithm

 Test Assertion                      TA-09.09.03.01
 Purpose                             Verifies that the proper signature algorithm has been used to sign
                                     the key management certificate as specified in Table 3-3 of
                                     [SP800-78].
 DTR(s)                              • DTR-07.03.03.01
                                     • DTR-07.03.03.02
 Issuer Documentation                None.
 Precondition(s)                     • A token with the Derived PIV Application is inserted into an
                                         appropriate token reader.
                                     • Suitable drivers have been loaded between the test system and
                                         an instance of the reader.
                                     • A key management certificate is present within the Derived
                                         PIV Application.
 Test Scenario                       1. Send the SELECT command with
                                           • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                                     2. Send the GET DATA command with
                                           • Data field of the command containing the tag
                                              ('5FC10B') of the X.509 Certificate for Key
                                              Management data object
                                     3. Extract signature->algorithm field value from the
                                        certificate.
 Expected Result(s)                  1. From Step 1, the command returns the application property
                                        template with the status word '90 00'.
                                     2. From Step 2, the command returns the requested data object
                                        along with the status word '90 00'.
                                     3. From Step 3, the algorithm value is in accordance with Table 3-
                                        3 of [SP800-78]. If the algorithm value is id-RSASSA-PSS,
                                        then the hashAlgorithm field in signature->parameters field is
                                        populated with SHA-256 (OID = 2.16.840.1.101.3.4.2.1). For
                                        RSA with PKCS #1 v1.5 padding, the parameters field is
                                        populated with NULL. For ECDSA, the parameters field is
                                        absent.




20
  The key management key and certificate may be tested outside of the Derived PIV Application. Specific test
assertions can be developed by test entities to test this key and certificate based on the environment (e.g., email
application) in which the key pair is being used. See Appendix A for example of testing approaches.


                                                          117
