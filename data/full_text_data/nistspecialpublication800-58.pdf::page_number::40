NIST SP 800-58                                             Voice Over IP Security
    _________________________________________________________________________

       − Profile 3 describes Profile 2 for multiple intermediate gatekeepers.
      The basic concept of all profiles is the protected transmission of the key
      management data as self-contained container.

 4.2.2.3 Draft H.235v3 Annex H – RAS Key Management

      The basic idea formulated in H.235 Annex H is key management negotiation
      during the RAS gatekeeper discovery phase. During gatekeeper discovery a
      shared secret is established between the endpoint and the gatekeeper. The
      negotiation of the shared secret may be protected using PINs or passwords during
      the initial phase of the protocol.

      The draft references two protocols for Encrypted Key Exchange using a shared
      secret to "obscure" a Diffie-Hellman key exchange. The first one is the Encrypted
      Key Exchange (EKE), where the shared secret is used to encrypt the Diffie-
      Hellman public keys under a symmetric algorithm. The second one is the Simple
      Password-authenticated Exponential Key Exchange (SPEKE) method [20], where
      the shared secret builds a generator for the Diffie-Hellman group. The usage of
      these protocols leads to a strong Diffie-Hellman key exchange with use of the
      shared secret. A potential disadvantage of these protocols is that they are typically
      subject to patent protection.

      The draft discusses the use of the PIN or password for the protection of the
      exchange of the public parameter of public key system (Diffie Hellman, elliptic
      curves) by encryption using a symmetric algorithm in CBC mode. To be more
      specific, the password or PIN is used to derive the initialization vectors for the
      encryption algorithms. The negotiated keys and algorithms may then be applied
      later on to protect the further RAS and call signaling phase.

      One option to protect the call signaling phase is TLS, which is discussed further
      in the draft Annex H. Here, the RAS negotiation replaces the initial TLS
      handshake protocol. This is obviously only useful if the call signaling is
      gatekeeper routed. The approach is especially useful for inter-gatekeeper
      authentication and signaling using the LRQ/LCF exchange. In this case, there is
      no third RAS message by which the calling gatekeeper can authenticate itself to
      the called gatekeeper using the negotiated key material, but the caller can be
      implicitly authenticated by its ability to establish the call signaling channel with
      the correct TLS session parameters. TLS can then be deployed without the costly
      handshake phase using only the recode layer of TLS together with the negotiated
      key material and algorithms from the RAS phase.

 4.2.2.4 H.235v3 Annex I – H.235 Annex D for Direct Routed Scenarios

      Both Annex D and Annex F are to be used in gatekeeper routed environments.
      Annex I of H.235 enhances the Baseline Security Profile (Annex D, section
      4.2.1.1) as well as the Hybrid Security Profile (Annex F, section 4.2.1.3) with the
      option to be applied in an environment were direct routed calls (endpoint to


                                                                                           35
