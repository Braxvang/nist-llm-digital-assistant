                                                  GUIDE TO INTRUSION DETECTION AND PREVENTION SYSTEMS (IDPS)



6.2.3.2 Detection Accuracy

Because NBA sensors work primarily by detecting significant deviations from normal behavior, they are
most accurate at detecting attacks that generate large amounts of network activity in a short period of time
(e.g., DDoS attacks) and attacks that have unusual flow patterns (e.g., worms spreading among hosts).
NBA sensors are less accurate at detecting small-scale attacks, particularly if they are conducted slowly
and if they do not violate the administrator-set policies (e.g., the attack uses common ports and protocols).

Detection accuracy also varies over time. Because NBA technologies use primarily anomaly-based
detection methods, they cannot detect many attacks until they reach a point where their activity is
significantly different from what is expected. If a DoS attack starts slowly and increases in volume over
time, it is likely to be detected by NBA sensors, but the point during the attack at which the NBA
software detects it may vary considerably among NBA products. By configuring sensors to be more
sensitive to anomalous activity, alerts will be generated more quickly when attacks occur, but more false
positives are also likely to be triggered. Conversely, if sensors are configured to be less sensitive to
anomalous activity, there will be fewer false positives, but alerts will be generated more slowly, allowing
attacks to occur for longer periods of time.

False positives can also be caused by benign changes in the environment. For example, if a new service
is added to a host and a few hosts start using it, an NBA sensor is likely to detect this as anomalous.
However, typically this would be a low-priority alert, and not reported as an attack, so it is debatable
whether this can truly be considered a false positive. If a major service is moved from one host to another
and a thousand hosts start using it one day, that might inadvertently trigger an alert.

6.2.3.3 Tuning and Customization

NBA technologies rely primarily on observing network traffic and developing baselines of expected flows
and inventories of host characteristics. NBA products automatically update their baselines on an ongoing
basis. As a result, typically there is not much tuning or customization to be done, other than updating
firewall ruleset-like policies that are offered by most products. Also, administrators might adjust
thresholds periodically (e.g., how much additional bandwidth usage should trigger an alert) to take into
account changes to the environment. Thresholds can often be set on a per-host basis or for administrator-
defined groups of hosts. Most NBA products also offer whitelist and blacklist capabilities for hosts and
services. Another common feature of NBA products is customization of each alert (e.g., specifying which
prevention option it should trigger). Unlike network-based IDPSs, code editing features are generally not
applicable to NBA products.

A few NBA products offer limited signature-based detection capabilities. The supported signatures tend
to be very simple, and primarily look for particular values in certain IP, TCP, UDP, or ICMP header
fields. This capability is most helpful for inline NBA sensors because they can use the signatures to find
and block attacks that a firewall or router might not be capable of blocking. For example, suppose that
there is a DDoS attack that uses a flood of specially crafted HTTP traffic against a Web server. A
firewall or router might not be able to block the attack without blocking all HTTP activity to the Web
server, but an inline NBA sensor could be configured with a customized signature to block just the attack
activity if it has a unique set of characteristics. On the other hand, an inline NBA sensor might be able to
block the attack anyway because of its flow patterns.

Besides reviewing tuning and customizations periodically to ensure that they are still accurate,
administrators should also ensure that significant changes to hosts, such as new hosts and new services,
are reflected in NBA settings. Although it might not feasible to automatically link NBA systems with




                                                    6-5
