NIST SP 800-85A-4                                                PIV CARD APPLICATION & MIDDLEWARE
                                                                          INTERFACE TEST GUIDELINES

Required Test Procedures

TE05.32.01: The tester shall validate that if the PIV Card Application returns '63 CX', then the
retry counter associated with the PIN is not reset, the security status of the PIN’s key reference is set
to FALSE, and the PUK’s retry counter is decremented by one.

AS05.33: If the reset retry counter authentication data (PUK) in the command data field of
the command does not match reference data associated with the PUK, then the PIV Card
Application shall return the status word '63 CX'. If the new reference data (PIN) in the
command data field of the command does not satisfy the criteria in Section 2.4.3 of Part 2 of
SP 800-73-4, then the PIV Card Application shall return the status word '6A 80'. If the reset
retry counter authentication data (PUK) in the command data field of the command does not
match reference data associated with the PUK and the new reference data (PIN) in the
command data field of the command does not satisfy the criteria in Section 2.4.3 of Part 2 of
SP 800-73-4, then the PIV Card Application shall return either status word '6A 80' or '63 CX'.
If the PIV Card Application returns status word '6A 80', then the retry counter associated
with the PIN shall not be reset, the security status of the PIN’s key reference shall remain
unchanged, and the PUK’s retry counter shall remain unchanged.

Required Vendor Information

VE05.33.01: The vendor shall state in its documentation that the card supports the assertion made in
AS05.33.

Required Test Procedures

TE05.33.01: The tester shall review and validate that the vendor’s documentation includes the
information required in VE05.33.01 and the tester shall also validate that card inplements the
RESET RETRY COUNTER card command in a manner consistent with AS05.33 by ensuring the
following conditions:

   (a) If the new reference data (PIN) in the command data field of the command satisfies the
       criteria in Section 2.4.3 of Part 2 of SP 800-73-4, but the reset retry counter authentication
       data (PUK) in the command data field of the command does not match reference data
       associated with the PUK, then the PIV Card Application returns the status word '63 CX'.
   (b) If the reset retry counter authentication data (PUK) in the command data field of the
       command matches reference data associated with the PUK, but the new reference data (PIN)
       in the command data field of the command does not satisfy the criteria in Section 2.4.3 of
       Part 2 of SP 800-73-4, then the PIV Card Application returns the status word '6A 80'.
   (c) If the reset retry counter authentication data (PUK) in the command data field of the
       command does not match reference data associated with the PUK and the new reference data
       (PIN) in the command data field of the command does not satisfy the criteria in Section 2.4.3
       of Part 2 of SP 800-73-4, then the PIV Card Application returns either status word '6A 80' or
       '63 CX'.




                                            A-32
