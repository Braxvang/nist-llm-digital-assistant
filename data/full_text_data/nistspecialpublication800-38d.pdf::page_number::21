                                        NIST Special Publication 800-38D



                                   X1                      X2          ...         Xm


                                                           ⊕                        ⊕

                                   •H                      •H                      •H



                                   Y1                      Y2                      Ym

                                  Figure 1: GHASHH (X1 || X2 || ... || Xm) = Ym.

6.5      GCTR Function

Algorithm 3 below specifies the GCTR function. The suggested notation does not indicate the
choice of the underlying block cipher.

           Algorithm 3: GCTRK (ICB, X)

           Prerequisites:
           approved block cipher CIPH with a 128-bit block size;
           key K.

           Input:
           initial counter block ICB;
           bit string X, of arbitrary length.

           Output:
           bit string Y of bit length len(X).

           Steps:
           1. If X is the empty string, then return the empty string as Y.
           2. Let n = ⎡len( X ) 128⎤ .
           3. Let X1, X2, ... , Xn-1, Xn* denote the unique sequence of bit strings such that
                           X = X 1 || X 2 || ... || X n −1 || X n∗ ;
                           X1, X2,..., Xn-1 are complete blocks. 2
           4. Let CB1 = ICB .
           5. For i = 2 to n, let CBi = inc32(CBi-1).
           6. For i = 1 to n − 1, let Yi = X i ⊕ CIPH K (CBi ) .
           7. Let Yn∗ = X ∗n ⊕ MSB len (X ∗ )(CIPH K (CBn )) .
                                             n




2
    Consequently, Xn* is either a complete block or a nonempty partial block, and if 1 ≤ len(X) ≤128, then X = X1*.




                                                           13
