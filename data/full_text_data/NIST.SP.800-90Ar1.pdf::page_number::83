NIST SP 800-90A Rev. 1                                             Recommendation for Random Number
                                                                    Generation Using Deterministic RBGs


        1. If ((state_handle < 0) or (state_handle > 9) or (internal_state (state_handle) = {Null,
           Null, 0, 0, 0})), then Return (“State not available for the state_handle”).
                                               Comment: Get the internal state values needed to
                                               determine the new internal state.
        2. Get the appropriate internal_state values.
                         V = internal_state (state_handle).V.
                         security_strength = internal_state(state_handle).security_strength.
                                               Check the length of the additional_input.
        3. If (len (additional_input) > 512), then Return (“additional_input too long”).
                                               Comment: Get the entropy_input.
        4. (status, entropy_input) = Get_entropy_input (security_strength, 1000,
           prediction_resistance_request).
        5. If (status ≠ “Success”), then Return (status).
                                               Comment: The reseed algorithm is provided in steps
                                               6 to 10.
        6. seed_material = 0x01 || V || entropy_input || additional_input.
        7. seed = Hash_df (seed_material, 440).
        8. V = seed.
        9. C = Hash_df ((0x00 || V), 440).
        10. reseed_counter = 1.
                                               Comment: Update the working_state portion of the
                                               internal state.
        11. Update the appropriate state values.
           11.1 internal_state (state_handle).V = V.
           11.2 internal_ state (state_handle).C = C.
           11.3 internal_ state (state_handle).reseed_counter = reseed_counter.
        12. Return (“Success”).
B.1.3      Generating Pseudorandom Bits Using Hash_DRBG

The implementation returns a Null string as the pseudorandom bits if an error has been detected.
Prediction resistance is requested when prediction_resistance_request = 1.
In this implementation, prediction resistance is requested by supplying
prediction_resistance_request = 1 when the Hash_DRBG function is invoked.
Hash_DRBG_Generate_function:




                                                   74
