                                                                                             NIST SP 800-90B                                                          RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                              USED FOR RANDOM BIT GENERATION

                                                                                             Example: If the dataset is S = (0, 1, 1, 2, 0, 1, 2, 2, 0, 1, 0, 1, 1, 0, 2, 2, 1, 0, 2, 1), with L = 20, the
                                                                                             most common value is 1, with ùëùùëùÃÇ = 0.4. ùëùùëùùë¢ùë¢ = 0.4 + 2.576‚àö0.012 = 0.6895. The min-entropy
                                                                                             estimate is ‚àílog2 (0.6822) = 0.5363.

                                                                                             6.3.2    The Collision Estimate

                                                                                             The collision estimate, proposed by Hagerty and Draper [HD12], measures the mean number of
                                                                                             samples to the first collision in a dataset, where a collision is any repeated value. The goal of the
                                                                                             method is to estimate the probability of the most-likely output value, based on the collision times.
                                                                                             The method will produce a low entropy estimate for noise sources that have considerable bias
                                                                                             toward a particular output or value (i.e., the mean time until a collision is relatively short), while
                                                                                             producing a higher entropy estimate for a longer mean time to collision.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                             This entropy estimation method is only applied to binary inputs.

                                                                                             Given the input S = (s1, ‚Ä¶, sL), where si œµ A = {0,1},

                                                                                                 1. Set v = 0, index =1.
                                                                                                 2. Beginning with sindex, step through the input until any observed value is repeated; i.e., find
                                                                                                    the smallest j such that si = sj, for some i with index ‚â§ ùëñùëñ < ùëóùëó.
                                                                                                 3. Set v = v + 1, tv = j ‚Äì index + 1 and index = j + 1.
                                                                                                 4. Repeat steps 2-3 until the end of the dataset is reached.
                                                                                                 5. Calculate the sample mean ùëãùëãÔøΩ, and the sample standard deviation ùúéùúéÔøΩ, of ti as
                                                                                                                                     1
                                                                                                                               ùëãùëãÔøΩ = ùë£ùë£ ‚àëùë£ùë£ùëñùëñ=1 ùë°ùë°ùëñùëñ , ùúéùúéÔøΩ = ÔøΩùë£ùë£‚àí1
                                                                                                                                                                1
                                                                                                                                                                   ‚àëùë£ùë£ùëñùëñ=1(ùë°ùë°ùëñùëñ ‚àí ùëãùëãÔøΩ)2 .


                                                                                                 6. Compute the lower-bound of the confidence interval for the mean, based on a normal
                                                                                                    distribution with a confidence level of 99 %,

                                                                                                                                               ÔøΩ = ùëãùëãÔøΩ ‚àí 2.576 ùúéùúéÔøΩ .
                                                                                                                                              ùëãùëã‚Ä≤
                                                                                                                                                              ‚àöùë£ùë£
                                                                                                 7.   Using a binary search, solve for the parameter p, such that

                                                                                                                 ÔøΩ = ùëùùëùùëûùëû ‚àí2 ÔøΩ1 + 1 (ùëùùëù‚àí1 ‚àí ùëûùëû ‚àí1 )ÔøΩ ùêπùêπ(ùëûùëû) ‚àí ùëùùëùùëûùëû ‚àí1 1 (ùëùùëù‚àí1 ‚àí ùëûùëû ‚àí1 ).
                                                                                                                ùëãùëã‚Ä≤
                                                                                                                                  2                                   2

                                                                                                      where

                                                                                                                                                   ùëûùëû = 1 ‚àí ùëùùëù,

                                                                                                                                                      ùëùùëù ‚â• ùëûùëû,

                                                                                                                                        ùêπùêπ(1‚ÅÑùëßùëß) = Œì(3, ùëßùëß)ùëßùëß ‚àí3 ùëíùëí ùëßùëß ,



                                                                                                                                                          42
