                                                                                              NIST SP 800-77 REV. 1                                                                             GUIDE TO IPSEC VPNS


                                                                                              non-IP protocols. (As the name implies, IPsec is designed to provide security for IP traffic only.)
                                                                                              Protection at the link layer means that the security added is limited to the devices that share this
                                                                                              link layer, such as an Ethernet-based LAN or WiFi network. However, various virtual link layers
                                                                                              now exist to facilitate network virtualization, allowing a link layer VPN protocol to secure nodes
                                                                                              in different physical (and virtual) locations. Since confidentiality and integrity happen at the link
                                                                                              layer, deploying a link layer VPN protocol requires no specific support in the application.
                                                                                              However, this also means that the application is generally not aware of the link layer protection
                                                                                              and cannot make decisions based on whether the communication is secure or not.

                                                                                              8.1.1    WiFi Data Link Protection
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              All devices that support WiFi technology support a number of link layer protocols that provide
                                                                                              confidentiality and integrity protection. Wireless connections broadcast their data, so from the
                                                                                              start, there has been a push to send data using confidentiality and integrity protection. The initial
                                                                                              security protocol was Wired Equivalent Privacy (WEP), which was deprecated in 2004 in favor
                                                                                              of Wi-Fi Protected Access (WPA). WEP uses 40-bit or 128-bit RC4 PSKs and is easily broken,
                                                                                              whereas WPA2 70 uses AES-CCM. The Enterprise versions of WPA use IEEE 802.1X for
                                                                                              authentication instead of a PSK. WPA supports a number of EAP extensions, such as EAP-TLS,
                                                                                              EAP-MSCHAPv2, and EAP-Subscriber Identity Module (EAP-SIM). In WPA3, the PSK is
                                                                                              replaced by Password Authenticated Key Exchange (PAKE), which offers more protection
                                                                                              against the use of weak passwords. WPA3 also offers PFS. 71

                                                                                              The strength of the link layer protection for WiFi depends strongly on the configuration and the
                                                                                              implementation of the various 802.11 standards. WiFi encryption only protects the data from the
                                                                                              wireless device to the wireless access point. It is good practice to consider WiFi encryption to be
                                                                                              insufficient and to not trust the access point. Devices on a WiFi network should use a remote
                                                                                              access VPN like IPsec to communicate with resources on the wired network. This is especially
                                                                                              true for WiFi access points belonging to third parties, such as restaurants and hotels.

                                                                                              8.1.2    Media Access Control Security (MACsec)

                                                                                              Media Access Control Security (MACsec) is an industry standard defined in IEEE 802.1AE. It
                                                                                              creates point-to-point security associations within an Ethernet network. MACsec is the Ethernet
                                                                                              version of WiFi WPA security. It uses AES-GCM with 128-bit keys for confidentiality and
                                                                                              integrity. It protects regular IP traffic, as well as ARP, IPv6 Neighbor Discovery (ND), and
                                                                                              DHCP. For key exchange and mutual authentication, MACsec uses the IEEE 802.1X extension
                                                                                              MACsec Key Agreement (MKA) protocol. New devices have to authenticate themselves to the
                                                                                              authentication server before being able to join the network, and communication with other hosts
                                                                                              on the network is encrypted between each pair of hosts. This allows MACsec to be used with




                                                                                              70   WPA version 1 was designed as a compromise between security and being able to run on old hardware that implemented
                                                                                                   WEP. It uses the Temporal Key Integrity Protocol (TKIP), which was a stopgap replacement for the broken WEP protocol,
                                                                                                   but TKIP is no longer considered secure. WPA2 mandated the support for the Counter Mode with Cipher Block Chaining
                                                                                                   Message Authentication Code Protocol (CCMP), which uses AES-CCM.
                                                                                              71   See also NIST SP 800-153, Guidelines for Securing Wireless Local Area Networks (WLANs) [69].



                                                                                                                                                          87
