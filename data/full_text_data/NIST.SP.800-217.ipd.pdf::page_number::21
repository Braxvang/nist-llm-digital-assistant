      NIST SP 800-217 ipd                           Guidelines for PIV Federation (Initial Public Draft)
      January 2023


511   3.   Trust Agreements
512   This section is normative.
513   The federation process defined in [SP800-63C] requires the establishment of a trust
514   agreement between the RP and the IdP for the purpose of federated login, wherein the
515   RP agrees to accept assertions from the IdP, and the IdP agrees to provide assertions and
516   attributes to the RP.
517   In any PIV federation, the RP SHALL establish a specific IdP as the PIV IdP for a
518   population of PIV identity accounts, as described in Sec. 2.2.2. The RP SHALL trust
519   this IdP to provide valid assertions for accounts within that population. In many cases,
520   the population is defined by the issuing agency of the PIV identity accounts, and the trust
521   agreement defines a single PIV IdP for each issuing agency’s accounts. It is possible—
522   though uncommon—for an RP to have a distinct trust agreement established with an IdP
523   for a single PIV identity account.
524   An RP in a PIV federation SHALL accept assertions only from PIV IdPs identified by
525   its trust agreements. An RP SHALL accept assertions only within the bounds of its
526   established trust agreements. An RP SHALL reject assertions that do not comply with
527   these trust agreements.
528   Trust agreements in PIV federation SHALL consist of the following:
529        • A population of PIV identity accounts under consideration, including agency
530          identifiers;
531        • A list of PIV IdPs and the PIV identity accounts they represent;
532        • A list of RPs capable of receiving assertions from the PIV IdPs;
533        • The authorized party, as defined in [SP800-63C]; and
534        • The interoperable technical profile of the federation protocol in use.
535   When establishing a trust agreement, the RP SHALL disclose to the PIV IdP or federation
536   authority:
537        • The list of attributes requested and the purpose of use for each attribute;
538        • The possible range of IAL, AAL, and FAL required to access the RP; and
539        • The means for mapping any relevant PIV identity account to a specific PIV IdP.
540   When establishing a trust agreement, the IdP SHALL disclose to the RP or federation
541   authority:
542        • The list of attributes provided;
543        • The possible range of IAL, AAL, and FAL supported by the IdP;


                                                    11
