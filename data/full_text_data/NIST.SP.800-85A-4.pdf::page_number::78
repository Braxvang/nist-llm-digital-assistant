NIST SP 800-85A-4                                        PIV CARD APPLICATION & MIDDLEWARE
                                                                  INTERFACE TEST GUIDELINES

 Test Steps             1. Set cardHandle := <<a valid cardHandle>>
                        2. Call pivLogoutOfCardApplication with
                           • (IN) cardHandle
                        3. Set OID := <<valid OID for each of the following objects:
                           Fingerprints, Facial Image, Printed Information, Iris
                           Images, Pairing Code Reference Data Container>>
                        4. Create data reference
                        5. Call pivGetData with (each data object identified in step
                           3)
                           • (IN) cardHandle
                           • (IN) OID
                           • (IN) oidLength
                           • (OUT) data
                           • (INOUT) DataLength
 Expected Result(s)     Step 2: Call returns with status_word of PIV_OK and the client
                        application is logged off of the PIV Card Application.
                        Step 5: Call returns with status_word:=
                        PIV_SECURITY_CONDITION_NOT_SATISFIED and does not set data
                        reference.
 Postcondition(s)       1. The cardHandle remains valid.
                        2. The connection remains open.

B.5.1.2          Attempt Log Out Without Logging In
 Purpose               Verify that the PIV Middleware does not return an error when client
                       application requests a logout without first logging in.
 Target                 pivLogoutOfCardApplication
 Reference(s)           1. SP 800-73-4 Part 3, Section 3.2.5
                        2. AS04.07
 Precondition(s)        1. The client application owns a connection to the PIV Card
                           Application accessible through cardHandle.
                        2. The client has successfully executed the
                           pivSelectCardApplication command.
                        3. The client is not logged into the PIV Card Application.
 Test Steps             1. Set cardHandle := <<a valid cardHandle>>
                        2. Call pivLogoutOfCardApplication with
                           • (IN) cardHandle
 Expected Result(s)     Call returns with status_word of PIV_OK.
 Postcondition(s)       The precondition states remain unchanged (only “free read” data
                        can be read).


B.5.2           Test Assertions for Error Conditions

B.5.2.1          Attempt Log Out with Invalid cardHandle
 Purpose               Ensure the PIV Middleware detects and handles an invalid
                       cardHandle.



                                         B-12
