NIST SP 800-38G                                               METHODS FOR FORMAT-PRESERVING ENCRYPTION


Given a numeral [bit] string X and an index i such that 1 ≤ i ≤ LEN(X), the i th numeral [bit] of X is
denoted by X[i]. For a pair of indices (i,j), with 1 ≤ i ≤ j ≤ LEN(X), the substring of numerals [bits]
from X[i] to X[j] is denoted by X[i..j]. For example, in base ten, if X = 798137, then X[2] = 9,
and X [3 .. 5] = 813.

Given a base, radix, and a length, m, there are radixm distinct numeral strings. Given an integer x
                                                                            m
such that 0 ≤ x < radixm, the integer-to-string function, denoted by STR radix (x), is the numeral
string of length m in base radix that represents x, when the numerals are in decreasing order of
                                4
significance. For example, STR 12 (559) is the string of four numerals in base 12 that represents
                                                         m
559, namely, 0 3 10 7. An algorithm for computing STR radix (x) is given in Sec. 4.6.

A separate notation is given for the conversion of integers to byte strings, in particular,
[x]s = STR 8s2 (x). For example, [1]1 = 00000001.

Given a (non-empty) numeral string X in base radix of length m, the string-to-integer function,
                                                                          m
denoted by NUM radix (X), is the integer x that X represents, so that STR radix (x) = X. For example,
NUM5 (00011010) = 755. An algorithm for computing NUM radix (X) is given in Sec. 4.6.

Similar notation is given for the function that converts bit strings to integers. In particular, given
a byte string X, NUM(X) is the integer x that X represents, so that [NUM(X)]BYTELEN(X) = X. For
example, NUM(10000000) = 128. An algorithm for computing NUM(X) is given in Sec. 4.6.

Given a numeral string, X, the string REV(X) is the sequence of numerals of X in reverse order.
For example, in base ten, REV(13579) = 97531.

Given a byte string, X, the string REVB(X) is the sequence of bytes of X in reverse order. For
example, REVB([1] || [2] || [3]) = [3] || [2] || [1].

4.3    Underlying Block Cipher and Key

The encryption and decryption functions of FF1 and FF3 feature a block cipher as the main
component; thus, each of these FPE mechanisms is a mode of operation (mode, for short) of the
block cipher.

For any given key, K, the underlying block cipher of the mode is a permutation, i.e., an invertible
transformation on bit strings of a fixed length; the fixed-length bit strings are called blocks, and
the length of a block is called the block size. For an FPE mode, as part of the choice of the
underlying block cipher with the key, either the forward transformation or the inverse
transformation2 is specified as the designated cipher function, denoted by CIPHK. The inverse of
CIPHK is not needed for the modes that are specified in this publication.

For both of the modes, the underlying block cipher shall be approved, and the block size shall be
128 bits. Currently, the AES block cipher [10], with key lengths of 128, 192, or 256 bits, is the

2
 The forward transformation and the inverse transformations are sometimes referred to as the “encrypt” and
“decrypt” functions, respectively, of the block cipher; however, in this publication, those terms are reserved for
functions of the FPE modes.

                                                        8
