                                                                                               NIST SP 800-56B REV. 2                               RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                         USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                                               and
                                                                                                           b. 1 = (d × epub) mod LCM (p – 1, q – 1).
                                                                                                       If either check fails, output an indication of an invalid key pair, and exit without further
                                                                                                           processing.
                                                                                                   7. Output an indication that the key pair is valid.
                                                                                               Output:
                                                                                                   1. status: An indication that the key pair is valid or an indication of an error.
                                                                                               Errors: Indications of the following:
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                                   1. The targeted security strength is not acceptable,
                                                                                                   2. The modulus length is not adequate for the targeted security strength,
                                                                                                   3. The fixed public exponent is out of range, or
                                                                                                   4. The key pair is invalid.
                                                                                               A routine that implements this validation function shall destroy any local copies of p, q and d, as
                                                                                               well as any other locally stored values used or produced during the execution of the routine. The
                                                                                               destruction of these locally stored values shall occur prior to or during any exit from the routine
                                                                                               (whether exiting early because of an error, or exiting normally).

                                                                                               6.4.1.2.2   rsakpv1-prime-factor
                                                                                               rsakpv1-prime-factor is the key-pair validation method corresponding to rsakpg1-prime-factor
                                                                                               (see Section 6.3.1.2).
                                                                                               Function call: rsakpv1-prime-factor (s, nBits, efixed, (npub, epub), (p, q, d))
                                                                                               The inputs, outputs and errors are the same as in rsakpv1-basic (see Section 6.4.1.2.1) except that
                                                                                               the private key is in the prime-factor format: (p, q, d).
                                                                                               The steps are the same as in rsakpv1-basic except that in processing:
                                                                                                   A. Step 3 is replaced by the following:
                                                                                                       3. Check the modulus:
                                                                                                           a. If npub ≠ p × q, output an indication of an invalid key pair, and exit without further
                                                                                                              processing.
                                                                                                           b. If len(npub) ≠ nBits, output an indication of an invalid key pair, and exit without
                                                                                                              further processing.
                                                                                                           c. If nBits is not a positive even integer, output an indication of an invalid key pair,
                                                                                                              and exit without further processing.
                                                                                                   B. Step 4 (prime-factor recovery) is omitted (i.e., not used).
                                                                                               A routine that implements this validation function shall destroy any local copies of p, q, and d, as
                                                                                               well as any other locally stored values used or produced during the execution of the routine. The

                                                                                                                                                   49
