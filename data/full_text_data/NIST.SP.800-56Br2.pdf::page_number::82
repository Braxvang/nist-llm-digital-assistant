                                                                                               NIST SP 800-56B REV. 2                            RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                      USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                                           e. Apply the mask-generation function specified in Section 7.2.2.2 to compute:
                                                                                                                          dbMask′= MGF(mgfSeed′, nLen – HLen – 1).
                                                                                                           f. Let DB′ = maskedDB′ ⊕ dbMask′.
                                                                                                           g. Separate DB′ into a byte string HA′ of HLen bytes and a byte string X of nLen –
                                                                                                              2HLen – 1 bytes as follows:
                                                                                                                                         DB′ = HA′ || X.
                                                                                                  5. Check for RSA-OAEP decryption errors:
                                                                                                           a.   DecryptErrorFlag = False.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                                           b. If Y is not the 00 byte (i.e., the bit string 00000000), then DecryptErrorFlag = True.
                                                                                                           c. If HA′ does not equal HA, then DecryptErrorFlag = True.
                                                                                                           d. If X does not have the form PS || 00000001 || K, where PS consists of zero or more
                                                                                                              consecutive 00 bytes, then DecryptErrorFlag = True.
                                                                                                        The     type(s)    of     any     error(s)  found        shall     not     be     reported.
                                                                                                        (See the notes below for more information.)
                                                                                                  6. Output of the decryption process:
                                                                                                           a. If DecryptErrorFlag = True, then output an indication of an (unspecified)
                                                                                                              decryption error, and exit without further processing. (See the notes below for more
                                                                                                              information.)
                                                                                                           b. Otherwise, output K, the portion of the byte string X that follows the leading 01
                                                                                                              byte.
                                                                                               Output:
                                                                                                  K: the recovered keying material (a byte string of at most nLen – 2HLen − 2 bytes), or an error
                                                                                                  indicator.
                                                                                               A routine that implements this operation shall destroy any local copies of sensitive input values
                                                                                               (including the private key and any sensitive portions of A), any locally stored portions of K, and
                                                                                               any other potentially sensitive locally stored values used or produced during the execution of the
                                                                                               routine (including DecryptErrorFlag, em, EM, HA, Y, maskedMGFSeed ′, maskedDB′,
                                                                                               mgfSeedMask ′, mfgSeed ′, dbMask ′, DB′, HA′, and X). The destruction of these locally stored
                                                                                               values shall occur prior to or during any exit from the routine – whether exiting because of an
                                                                                               error, or exiting normally with the output of K. Note that the requirement for destruction includes
                                                                                               any locally stored portions of the recovered keying material.


                                                                                               Notes:
                                                                                                  1. Care should be taken to ensure that the different error conditions that may be detected in
                                                                                                     step 5 above cannot be distinguished from one another by an opponent, whether by an error
                                                                                                     message or by process timing. Otherwise, an opponent may be able to obtain useful

                                                                                                                                                72
