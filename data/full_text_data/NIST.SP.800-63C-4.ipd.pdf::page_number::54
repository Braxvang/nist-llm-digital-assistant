       NIST SP 800-63C-4 ipd                                              Digital Identity Guidelines
       December 2022                                                      Federation and Assertions


1402   The RP SHALL notify the subscriber through an out-of-band mechanism, and SHOULD
1403   notify the IdP using a shared signaling system (see Sec. 5.7), if any of the following
1404   events occur:
1405       • A new authenticator is bound to the RP subscriber account.
1406       • An existing bound authenticator is unbound from the RP subscriber account.
1407   For example, a subscriber could have a single factor cryptographic device as an
1408   authenticator. This authenticator uses name-based phishing resistance so the IdP and RP
1409   would see different keys when used in each location. The RP can use a binding ceremony
1410   as described here to allow the subscriber to use this device as a bound authenticator
1411   at FAL3. The RP will prompt the subscriber for this authenticator whenever it sees an
1412   assertion for this subscriber at FAL3 from the IdP.

1413   6.1.2.3. Processing Bound Authenticators
1414   When the RP receives an assertion associated with a bound authenticator, the
1415   subscriber proves possession of the bound authenticator directly to the RP. The primary
1416   authentication at the IdP and the federated authentication at the RP are processed
1417   separately. While the subscriber could use the same authenticator during the primary
1418   authentication at the IdP and as the bound authenticator at the RP, there is no assumption
1419   that these will be the same.
1420   The following requirements apply to all assertions associated with a bound authenticator:
1421      1. The subscriber SHALL prove possession of the bound authenticator to the RP, in
1422         addition to presentation of the assertion itself.
1423      2. If the authenticator is managed at the IdP, reference to a given authenticator found
1424         within an assertion SHALL be trusted at the same level as all other information
1425         within the assertion.
1426      3. If the authenticator is managed at the IdP, the assertion SHALL NOT include an
1427         unencrypted private or symmetric key to be used as an authenticator with the
1428         presentation.
1429      4. The RP SHALL process and validate the assertion in addition to the bound
1430         authenticator.
1431      5. Failure to authenticate with the bound authenticator SHALL result in an error at the
1432         RP.

1433   6.2. Assertion Protection
1434   Independent of the binding mechanism (discussed in Sec. 6.1) or the federation model
1435   used to obtain them (described in Sec. 5.1), assertions SHALL include a set of protections
1436   to prevent attackers from manufacturing valid assertions or reusing captured assertions at
1437   disparate RPs. The protections required are dependent on the details of the use case being
1438   considered, and specific protections are listed here.

                                                   42
