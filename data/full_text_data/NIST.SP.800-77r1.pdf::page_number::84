                                                                                              NIST SP 800-77 REV. 1                                                                               GUIDE TO IPSEC VPNS


                                                                                              bits of entropy. Using a public-key key pair (with or without certificates) based on RSA, DSA, or
                                                                                              ECDSA is preferred over using PSKs, but if the implementations that need to interoperate do not
                                                                                              share the same public key-based authentication method, PSKs are an appropriate alternative.
                                                                                              Within an administrative domain, PSKs should not be used. For remote access VPN scenarios,
                                                                                              EAP-TLS or machine certificate authentication should be used.

                                                                                              7.2.2.1 PSKs

                                                                                              To use PSKs, the IPsec administrator needs to create a strong random secret key or password
                                                                                              string that is then configured in both IPsec devices (the endpoints) of an IPsec connection. 52
                                                                                              PSKs are the simplest authentication method to implement but are also, by far, the least secure.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              Administrators need to find IPsec products that provide key management capabilities for PSKs
                                                                                              or implement their own key management mechanisms, such as generating, storing, deploying,
                                                                                              auditing, and destroying keys. Proper key management can be quite resource intensive. Although
                                                                                              it is easiest to create a single key that all endpoints share, this causes problems when a host
                                                                                              should no longer have access; the key then needs to be changed on all other hosts. PSKs should
                                                                                              also be updated periodically to reduce the potential impact of a compromised key. Another issue
                                                                                              is that the key must be kept secret and transferred over secure channels. Individuals with access
                                                                                              to an endpoint are almost always able to gain access to the PSK. 53 Depending on the key type,
                                                                                              this could grant access from one, some, or all IP addresses. Using the same key for a group of
                                                                                              endpoints also reduces accountability since anyone within the group can impersonate another
                                                                                              member of the group. Therefore, NIST discourages the use of a PSK for more than two entities.

                                                                                              Because of scalability and security concerns, PSK authentication is generally an acceptable
                                                                                              solution only for small-scale implementations with known IP addresses or small IP address
                                                                                              ranges. The use of a single PSK for a group of hosts is strongly discouraged for all but the most
                                                                                              highly controlled environments, such as a group of secure routers. PSKs are generally not
                                                                                              recommended for remote access clients that have dynamic IP addresses because the keys cannot
                                                                                              be restricted to a particular IP address or small range of IP addresses. PSKs are also frequently
                                                                                              used during initial IPsec testing and implementation because of their simplicity. After the IPsec
                                                                                              implementation is operating properly, the authentication method can be changed.

                                                                                              7.2.2.2 Certificate-based digital signatures

                                                                                              Certificates for IPsec are typically used in “machine certificate” and EAP-TLS-based
                                                                                              authentication. The certificate owner produces a digital signature of the IKE exchange that
                                                                                              proves its possession of the certificate’s private key and authenticates the IKE session.

                                                                                              A certificate identifies each device, and each device is configured to use certificates. User-
                                                                                              specific certificates may be used instead of device-specific certificates, but some remote access


                                                                                              52   Because PSKs are often long strings of random characters, manually typing them in to the endpoints can cause problems
                                                                                                   from typos.
                                                                                              53   Some vendors protect stored PSKs using obfuscation, but since unattended access to these secrets is needed when booting
                                                                                                   up the system, this obfuscation is usually trivially broken.




                                                                                                                                                            67
