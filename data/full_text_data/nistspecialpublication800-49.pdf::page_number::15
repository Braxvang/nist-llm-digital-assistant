                              Federal S/MIME V3 Client Profile


   • When the sender supports more than one method for key management, the
     implementation SHOULD automatically select an appropriate method based on the
     contents of each recipient’s key management certificates (usually obtained from
     previously received messages).
   • When the sender supports more than one method for symmetric encryption, the
     implementation SHOULD automatically select the appropriate encryption method based
     on each recipient’s SMIMECapabilities attributes from previously received messages.
   • S/MIME implementations MUST be able to construct a certification path for the
     receiver’s key management certificate, including CRLs, using the Lightweight Directory
     Access Protocol (LDAP). This includes:
    • the ability to build the path.
    • the ability to fetch the recipient’s certificate using LDAP.
    • the ability to fetch CRLs using LDAP.
    • the ability to fetch issuer certificates using LDAP.
   • S/MIME implementations MUST validate the certification path where the end certificate
     is the receiver’s key management certificate or reject the certificate.

2.2.3 Sending Signed and Encrypted Messages
    • S/MIME implementations MUST be able to satisfy the requirements for sending signed
      messages as in Clause 2.2.1 above and MUST be able to satisfy the requirements for
      sending encrypted messages as in Clause 2.2.2 above.
    • S/MIME implementations MUST be able to generate signed and then encrypted
      messages. This includes generating a symmetric key and encrypting the message.
    • S/MIME implementations SHOULD be able to use the application/pkcs7-mime type to
      generate signed then encrypted messages.

2.2.4 Building MIME Header
    • S/MIME implementations MUST be able to create properly formatted MIME headers as
      per [RFC2633] for each of the message types above.
    • S/MIME implementations MUST be able to create the intermediate MIME wrappers.


2.3 S/MIME Message Reception and Processing
S/MIME implementations MUST be able to receive and process S/MIME messages that are
correctly formatted. Recipients MUST be able to verify the signature or decrypt the data using
the information provided by the sender. Where necessary, the recipient MUST be able to
augment sender-provided information with certificates, CRLs, or other status information. (For
example, the recipient may use LDAP for retrievals of CRLs.)

2.3.1 Parsing MIME Header
    • S/MIME implementations MUST be able to process properly formatted MIME headers.

2.3.2 Receiving Signed Messages
    • S/MIME implementations MUST be able to process SignerInfo including signed
      attributes.



                                           7
