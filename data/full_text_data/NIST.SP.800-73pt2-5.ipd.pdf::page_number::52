       NIST SP 800-73pt2-5 ipd (Initial Public Draft)                                   Interfaces for Personal Identity Verification: Part 2
       September 2023                                                                      PIV Card Application Card Command Interface

1145   Authentication includes a 2048-bit 26 RSA public key. It is assumed that the cardholder PIN or
1146   OCC data has been successfully verified prior to sending the GENERAL AUTHENTICATE
1147   command.
1148                  Table 24. Validation of the PIV Card Application using GENERAL AUTHENTICATE

                      Command                                           Response                                      Comment
        '10 87 07 9A FF 7C 82 01 06 82 00                                                               The client application sends a
        81 82 01 00 00 01 FF FF FF FF ...                                                               challenge to the PIV Card
        FF FF FF FF FF 00 9D F4 6E 09                                                                   Application indicating that the
        E7 D6 19 18 53 1E 6E 1C 66 87 C4                                                                reference data associated with key
        3E CF FF 7D 53 47 BD 2E 93 19'                                                                  reference '9A' is to be used with
        ("..." represents 208 bytes of                                                                  algorithm '07' [SP800-78, Tables 9
        challenge data)                                                                                 and 10]. The challenge data, which
                                                                                                        in this example is encoded as
                                                                                                        specified for TLS version 1.3 client
                                                                                                        authentication, is '00 01 FF ... 18
                                                                                                        BC A7'. Bit 5 of the CLA byte is set
                                                                                                        to one to indicate that command
                                                                                                        chaining is needed. L e is absent to
                                                                                                        indicate that no data is expected.
                                                        ‘90 00’                                         The PIV Card Application indicates
                                                                                                        that it received the command
                                                                                                        successfully.
        '00 87 07 9A 0B 94 53 76 FE A7 91                                                               The client application sends the
        72 14 18 BC A7 00'                                                                              remaining data with the second and
                                                                                                        last command of the chain. L e is
                                                                                                        ‘00’ to indicate that the expected
                                                                                                        length of the response data field is
                                                                                                        256 bytes.
                                                        ‘7C 82 01 04 82 82 01 00 29 69 44               The PIV Card Application returns
                                                        3B 49 AC 5B 70 63 51 A1 5B B5                   the result of signing the challenge
                                                        … AD F7 0B 7D A6 4C 6C AA 62                    using the indicated key reference
                                                        40 C5 FA A8 7E A2 2B DC 92 18                   data and algorithm ('29 69 44 3B 49
                                                        56 8B CE F4 69 14 D9 83 61’08“                  AC…'). The last 2 bytes '61 08'
                                                        ("”.." represents 208 bytes of                  indicate that 8 more bytes are
                                                        response data)                                  available to read from the card.
        '00 C0 00 00 08'                                                                                The GET RESPONSE command is
                                                                                                        used to request the remaining 8
                                                                                                        bytes.
                                                        '30 1B 11 06 AE E2 F1 2E 90 00'                 The PIV Card Application sends the
                                                                                                        remaining 8 bytes.


1149   A.4.       Signature Generation With the Digital Signature Key
1150   The GENERAL AUTHENTICATE command CAN be used to generate signatures. The pre-
1151   signature hash and padding (if applicable) are computed off-card. The PIV Card Application
1152   receives the hashed value of the original message, applies the private signature key (key
1153   reference '9C'), and returns the resulting signature to the client application.



       26
          Higher strength keys are recommended starting in 2031, per SP 800-56 Part 1. See SP 800-78-5 Tables 9 and 10, which reflect support for
       higher strength keys for PIV cards and supporting systems, where applicable.



                                                                             42
