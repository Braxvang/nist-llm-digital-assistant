                                                                         GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


6.5.10.1      Using Carrier-Grade NAT and Dual-Stack Lite

Dual-stack lite59 stretches the supply of routable IPv4 addresses by letting a service provider share them
among customers. The customer is provided an IPv6 prefix and uses IPv4 over IPv6 tunnels as described
in RFC 2473 with Next Protocol 4 in the outer header to reach the IPv4 Internet. The service provider’s
carrier-grade NAT performs encapsulation and decapsulation of tunneled traffic and network address
translation. It shares its routable IPv4 addresses among multiple customers, and it uses the IPv6 source
address, inner IPv4 address, and port numbers of tunneled traffic to maintain a NAT mapping table and to
keep track of which customer is using which TCP and UDP ports.

From the service provider’s viewpoint, sharing these IPv4 addresses is an advantage. From the customer’s
viewpoint, only one NAT operation is performed. Transition is facilitated, because standard, native IPv6
is provided to the customer. On the other hand, IPv4 applications that require specific port assignments or
specific port mapping from the NAT operation likely will not work. As user experience grows and the
specifications for dual-stack lite evolve, several challenges remain:

         Keeping peer-to-peer applications, which often use only one or only a few port numbers,
          working.

         Providing application layer gateways for applications needing special handling.

         Defining a scheme whereby most ports are maintained by the carrier-grade NAT, but some are
          dedicated to and controlled by individual customers.

         Ensuring sufficient non-routable IPv4 address space is available for large service providers.
          The proposal asks IANA to assign new address space for this purpose.

         Handling MTU efficiently.

         Providing IPv4 multicast service.

6.5.10.2      Security Considerations for Carrier-Grade NAT and Dual-Stack Lite

Using NAT for IPv4 is likely not new, so general NAT security issues are not repeated here. (See, for
example, RFC 2663 and RFC 2993.)

Some of the security issues with carrier-grade NAT result directly from the sharing of the routable IPv4
address. Addresses and timestamps are often used to identify a particular user, but with shared addresses,
more information (i.e., protocol and port numbers) is needed. This impacts software used for logging and
tracing spam, denial of service attacks, and other abuses.

Devices on the customer’s side may try to carry out general attacks against systems on the global Internet
or against other customers by using inappropriate IPv4 source addresses inside tunneled traffic. The
carrier-grade NAT needs to protect against such abuse.

One customer may try to carry out a denial of service attack against other customers by monopolizing the
available port numbers. The carrier-grade NAT needs to ensure equitable access. At a more sophisticated
level, a customer may try to attack specific ports used by other customers. This may be more difficult to


59
     See the current version of the IETF Internet Draft, Dual-Stack Lite Broadband Deployments Following IPv4 Exhaustion,
     Work in Progress.


                                                           6-31
