NIST SP 800-166                                                   DERIVED PIV APPLICATION AND
                                                                  DATA MODEL TEST GUIDELINES

 DTR(s)               • DTR-06.02.02.09
                      • DTR-06.03.01.01
                      • DTR-06.03.06.02
 Vendor               None.
 Documentation
 Precondition(s)      •   A token with the Derived PIV Application is inserted into an
                          appropriate token reader.
                      •   Suitable drivers have been loaded between the test system and an
                          instance of the reader.
                      •   The Derived PIV Application Password is recorded.
                      •   The Derived PIV Application Password’s retry counter is not 0.
 Test Scenario        1. Send the SELECT command with
                            • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                      2. Send the CHANGE REFERENCE DATA command with
                            • P2, key reference value, is set to something that
                               is not '80' or '81'
                            • Data field of the command will contain the
                               correct password value (password 1), concatenated
                               without delimitation with an arbitrary new valid
                               password value (password 2). Both passwords are
                               padded with 'FF' (if necessary) to complete the
                               total length of each value to 8 bytes
                      3. Send the VERIFY command with
                            • P2, key reference value, is set to '80'
                            • Data field of the command will contain the
                               password value (password 1), padded with 'FF' (if
                               necessary) to complete the total length of the
                               value to 8 bytes
 Expected Result(s)   1. From Step 1, the command returns the application property template
                         with the status word '90 00'.
                      2. From Step 2, the command returns an error status word.
                      3. From Step 3, the command returns status word '90 00'.
 Postcondition(s)     The original password ('80') is still in effect.

8.3.5.3 Change Reference Data with an Incorrect Length and Padding for the New
        Password or with an Incorrect Length of New PUK

 Test Assertion       TA-08.03.05.03
 Purpose              Verifies that the Derived PIV Application responds appropriately to the
                      CHANGE REFERENCE DATA command when the length and
                      padding requirements of the new password are not met or when the
                      length of the new PUK is incorrect.
 DTR(s)               •   DTR-06.02.02.09
                      •   DTR-06.02.02.14
                      •   DTR-06.03.01.01
                      •   DTR-06.03.06.05


                                            68
