                                                                  GUIDELINES ON SECURING PUBLIC WEB SERVERS



 Restore the system.

     Either install a clean version of the OS, applications, necessary patches, and Web content; or
        restore the system from backups (this option can be more risky because the backups may have
        been made after the compromise, and restoring from a compromised backup may still allow the
        attacker access to the system).

     Disable unnecessary services.

     Apply all patches.

     Change all passwords (including on uncompromised hosts, if their passwords are believed to have
        been seen by the compromised host, or if the same passwords are used on other hosts).

     Reconfigure network security elements (e.g., firewall, router, IDPS) to provide additional
        protection and notification.

 Test system to ensure security.

 Reconnect system to network.

 Monitor system and network for signs that the attacker is attempting to access the system or network
  again.

 Document lessons learned.

Based on the organization’s policy and procedures, system administrators should decide whether to
reinstall the OS of a compromised system or restore it from a backup. Factors that are often considered
include the following:

 Level of access that the attacker gained (e.g., root, user, guest, system)

 Type of attacker (internal or external)

 Purpose of compromise (e.g., Web page defacement, illegal software repository, platform for other
  attacks)

 Method used for the system compromise

 Actions of the attacker during and after the compromise (e.g., log files, intrusion detection reports)

 Duration of the compromise

 Extent of the compromise on the network (e.g., the number of hosts compromised)

 Results of consultation with management and legal counsel.

The lower the level of access gained by the intruder and the more the Web server administrator
understands about the attacker’s actions, the less risk there is in restoring from a backup and patching the
vulnerability. For incidents in which there is less known about the attacker’s actions and/or in which the
attacker gains high-level access, it is recommended that the OS and applications be reinstalled from the



                                                    9-10
