                                                                                             NIST SP 800-90B                                               RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                   USED FOR RANDOM BIT GENERATION

                                                                                                                                                 − log 2 α 
                                                                                                                                         C = 1+ 
                                                                                                                                                 H 
                                                                                                                                                              .

                                                                                             This value of C is the smallest integer satisfying the inequality α ≥2−H (C−1), which ensures that the
                                                                                             probability of obtaining a sequence of identical values from C consecutive noise source samples
                                                                                             is at most α. For example, for α = 2−20, an entropy source with H = 2.0 bits per sample would have
                                                                                             a repetition count test cutoff value of 1+20/2.0 = 11.
                                                                                             Let next() yield the next sample from the noise source. Given a continuous sequence of noise
                                                                                             source samples, and the cutoff value C, the repetition count test is performed as follows:
                                                                                                1.  A=next()
                                                                                                2.  B =1
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                                3.  X=next()
                                                                                                4.  If (X = A),
                                                                                                         B=B+1
                                                                                                         If (B ≥ C), signal a failure.
                                                                                                    else:
                                                                                                         A=X
                                                                                                         B=1
                                                                                                 5. Repeat Step 3.

                                                                                             This test's cutoff value can be applied to any entropy estimate, H, including very small and very
                                                                                             large estimates. However, it is important to note that this test is not very powerful – it is able to
                                                                                             detect only catastrophic failures of a noise source. For example, a noise source evaluated at eight
                                                                                             bits of min-entropy per sample has a cutoff value of six repetitions to ensure a false-positive rate
                                                                                             of approximately once per 1012 samples generated. If that noise source somehow failed to the point
                                                                                             that each sample had a 1/16 probability of being the same as the previous sample, so that it was
                                                                                             providing only four bits of min-entropy per sample, it would still be expected to take about one
                                                                                             million samples before the repetition count test would notice the problem.
                                                                                             4.4.2   Adaptive Proportion Test

                                                                                             The Adaptive Proportion Test is designed to detect a large loss of entropy that might occur as a
                                                                                             result of some physical failure or environmental change affecting the noise source. The test
                                                                                             continuously measures the local frequency of occurrence of a sample value in a sequence of noise
                                                                                             source samples to determine if the sample occurs too frequently. Thus, the test is able to detect
                                                                                             when some value begins to occur much more frequently than expected, given the source's assessed
                                                                                             entropy per sample. Note that this test is intended to detect more subtle failures of the noise source,
                                                                                             rather than the kind of total failure detected by the Repetition Count Test.
                                                                                             The test takes a sample from the noise source, and then counts the number of times that the same
                                                                                             value occurs within the next W-1 samples. If that count reaches the cutoff value C, the test declares
                                                                                             an error. The window size W is selected based on the alphabet size, and shall be assigned to 1024
                                                                                             if the noise source is binary (that is, the noise source produces only two distinct values) and 512 if
                                                                                             the noise source is not binary (that is, the noise source produces more than two distinct values).




                                                                                                                                                    26
