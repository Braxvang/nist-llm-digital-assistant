NIST SP 800-85A-4                                            PIV CARD APPLICATION & MIDDLEWARE
                                                                      INTERFACE TEST GUIDELINES

                         2. All other calls return with status_word of
                              PIV_SECURITY_CONDITIONS_NOT_SATISFIED.
 Postcondition(s)        1.   The PIV Card Application returns to the state it had prior to the
                              pivCrypt function call.
                         2.   The precondition states are unaffected.


B.9.2.6          Identify and Handle an Insufficient Buffer
 Purpose                 Ensure that the PIV Middleware can identify and handle when it has
                         been provided an insufficient length for the algorithm output for the
                         pivCrypt.
 Target                  pivCrypt
 Reference(s)            1. SP 800-73-4 Part 3, Section 3.3.1
                         2. AS04.08B-R4
 Precondition(s)         1. The client application owns a connection to the PIV Card
                            Application accessible through cardHandle.
                         2. The client application has successfully selected the PIV Card
                            Application.
                         3. Length of the buffer allocated for data by the client application is
                            only 1 byte.
 Test Steps              1. Set cardHandle := <<valid cardHandle>>
                         2. Set keyReference := <<'9E'>>
                         3. Set algorithmIdentifier := <<'07' or '11'>>
                         4. Set algorithmInput := <<byte sequence compatible with the
                            chosen algorithm identifier and keyReference>>
                         5. Create algorithmOutput reference set to 1
                         6. Call pivCrypt with
                            • (IN) cardHandle
                            • (IN) algorithmIdentifier
                            • (IN) keyReference
                            • (IN) algorithmInput
                            • (IN) inputLength
                            • (OUT) algorithmOutput
                            • (INOUT) outputLength
 Expected Result(s)      Call returns with status_word of PIV_INSUFFICIENT_BUFFER and sets
                         the outputLength to the length of the algorithm output.
 Postcondition(s)        The precondition states are unaffected.


B.10          pivMiddlewareVersion

B.10.1          Valid Test Assertions

B.10.1.1         Retrieve the Supported PIV MiddlwareVersion
 Purpose                Ensure the PIV Middleware provides its version number to the client
                        application.


                                          B-31
