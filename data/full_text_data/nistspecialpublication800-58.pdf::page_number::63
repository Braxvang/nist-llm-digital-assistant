NIST SP 800-58                                              Voice Over IP Security
_____________________________________________________________________________

       dynamically of which ports media is flowing across and between which terminals.
       For this reason, only stateful firewalls that can process H.323 and SIP should be
       incorporated into the network to open and close ports. Many new firewalls come
       equipped with such functionality, although sometimes they support only one
       protocol (H.323 or SIP) [see 27 for a partial list]. If such firewalls are not
       available/feasible there are additional hardware solutions available, or VPNs can
       be used to tunnel through the firewall (chapter 8)

       NATs also introduce major design complications into media traffic control in
       VOIP. First of all, the standard NAT practice of assigning new port numbers at
       random breaks the pair relationship of RTP and RTCP port numbers [7]. The
       translation of IP Addresses and ports by NAT is also problematic for the reception
       of VOIP packets. If the NAT router does not properly process the traffic, the new
       addresses/ports will not correspond to those negotiated in the call setup process.
       In this scenario, the VOIP gateway may not properly deliver the RTP packets.
       The problem is exacerbated if both call participants are behind NATs. Several
       solutions are available for users with administrative control of their network
       security and the money to upgrade their firewall/NAT hardware (see 7.1-7.2). For
       users without control of their network architecture, there is a proposed solution
       [25], which is detailed in section 9.6. However, this solution breaks down when
       both users are behind NATs and it has not been implemented successfully to date.

       The use of NATs adds another possible complication to VOIP call signaling due
       to the finite nature of NAT bindings. At a NAT, a public IP address is bound to a
       private one for a certain period of time (t). This entry gets deleted if no traffic was
       observed at the NAT for t seconds or the connection was torn down explicitly. A
       SIP INVITE message, which triggers the binding of the private address to the
       public one, establishes “state” information when it passes through NATs or
       firewalls. This state eventually must be cleared. When TCP is used, closure of the
       TCP connection is usually a good indicator of the termination of the
       application. However, when SIP runs over UDP such a clear indication is
       missing. Furthermore, as a silence period during a conversation might be longer
       than t seconds, not receiving traffic for t seconds might not suffice as an
       indication of session termination. As a result, it is possible that some state
       information is destroyed before the transaction and/or the call actually completes.


 7.4   Call Setup Considerations with NATs and Firewalls

       VOIP users will not tolerate excessive latency in the call setup process, which
       corresponds to lifting the receiver and dialing in a traditional system. Users may
       be annoyed with a setup process that requires more than a few seconds [12].
       Many factors influence the setup time of a VOIP call. At the network level, these
       include the topology of the network and the location of both endpoints as well as
       the presence of a firewall or NAT. At the application level, the degree or lack of
       authentication and other data security measures, as well as the choice of protocol



58
