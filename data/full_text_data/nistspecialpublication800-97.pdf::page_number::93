                                        ESTABLISHING WIRELESS ROBUST SECURITY NETWORKS: A GUIDE TO IEEE 802.11I



In a typical IEEE 802.11 RSN configuration, communication flows through the four layers as shown in
Figure 6-5. Messages traveling between layers within a device are transported logically within the
device’s EAP software implementation. Flows between devices occur over a network using lower-layer
protocols. Communication flows occur in both directions, as shown by the arrows in the figure. For
example, when the EAP method on the AS generates a request, the EAP method on the STA responds to
that request. When the AS receives the response, it replies with either a success or failure message,
accompanied by key material in the case of success. The Peer/Authenticator layer on each device
determines whether to pass the message through (in the case of an AP) or forward it to the appropriate
EAP method (in the case of the STA and AS). The EAP layer packages the messages for the lower layer
protocols, which are typically IEEE 802.11 or RADIUS.




                                                                        AP
     Model Layer                    STA                                                               AS

     Method Layer               EAP Method                                                       EAP Method
                                                                EAP Authenticator
                                   EAP                                                               EAP
Peer/Authenticator
                                   Peer/                                                             Peer/
      Layer
                               Authenticator                                                     Authenticator

      EAP Layer                  EAP Layer                          EAP Layer                     EAP Layer
                                           IEEE 802.11                              Wired network protocols
     Lower Layer


                                 Figure 6-5. EAP Traffic Flow in IEEE 802.11 RSN



EAP implementations differ considerably for the method and lower layers, but are very similar for the
middle two layers. Organizations need to determine how to implement the method and lower layers in
their environments, which involves selecting one or more EAP methods (discussed previously in Section
6.2) and establishing the protocols that the AS will use to transport authentication messages. Typical
support requirements and configurations for each of the key WLAN components are discussed in Table
6-6. The AP does not need to support EAP methods, but it must support the lower layer communications
protocols of both the STA and AS.

An important concept at the lower layer is EAP encapsulation, which describes how EAP packets are
transferred between peer and authenticator. The encapsulation method can differ depending on the
network environment. The most common form of EAP encapsulation in IP networks is EAP over
RADIUS. 91 In a typical WLAN configuration, the AS either hosts the AAA database or acts as a “front
end to the real user database, which might be Active Directory, LDAP, Kerberos, or numerous other
alternatives; the AS uses RADIUS to communicate with STAs and other devices. For this reason, the AS
is often called the RADIUS or AAA server.




91
      For more information on EAP over RADIUS, see RFC 3579, RADIUS Support for EAP, at
      http://www.ietf.org/rfc/rfc3579.txt.


                                                         6-17
