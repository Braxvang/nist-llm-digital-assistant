                                                              GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


Packet Too Big or, in some situations, Destination Unreachable) with the corresponding state records for
existing connections (TCP, UDP, or SCTP streams), such stateful firewalls can limit even allowed types
to those that could legitimately be part of permitted traffic flows.

Table 3-7 gives recommended ICMPv6 firewall settings for various possible traffic types. The
―Maintenance of Communications‖ and ―Error Messages‖ sections of the table assume the more
sophisticated connection-association capabilities mentioned above; less-sophisticated firewalls would
have to allow these messages whenever a corresponding connection could occur, based on other rules
(e.g., allowed source and destination addresses).


The recommendations for ICMPv6 firewall filtering in Table 3-7 are based on RFC 4890,
Recommendation for Filtering ICMPv6 Messages in Firewalls. These recommendations allow
propagation of ICMPv6 messages needed to maintain functionality of the network but drop messages
posing potential security risks. Many ICMPv6 messages should only be used in a link-local context,
rather than end-to-end, and filters need to be concerned with the types of addresses in ICMPv6 packets as
well as the specific source address, destination addresses, and ICMPv6 Type. RFC 4890 classifies
ICMPv6 messages according to whether they are designed for end-to-end communications (traffic to
transit a firewall) or local communications within a link (local traffic addressed to an interface on a
firewall). All experimental and undefined ICMPv6 messages should be dropped. ACLs should permit
only those ICMPv6 messages that are required, based on specific local needs and policies; all others
should be dropped.




                                                  3-32
