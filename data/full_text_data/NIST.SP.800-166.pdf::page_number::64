NIST SP 800-166                                                                    DERIVED PIV APPLICATION AND
                                                                                   DATA MODEL TEST GUIDELINES

                                     test toolkit application’s copy of the plaintext key to the one
                                     received in the response from the token. For algorithm reference '11'
                                     or '14' as P1 value, the command returns the shared secret Z 11 with
                                     status word '90 00'. Compare the shared secret computed by the
                                     token with the shared secret computed off token.
                                  5. From Step 5, the command returns status word '6A 86' (incorrect
                                     parameter in P1 or P2).
                                  6. From Step 6, the command returns status word '6A 80' (incorrect
                                     parameter in command data field).
 Postcondition(s)                 N/A

8.3.3.8 General Authenticate with the Retired Key Management Keys

 Test Assertion                   TA-08.03.03.08
 Purpose                          Verifies that the Derived PIV Application responds to the GENERAL
                                  AUTHENTICATE command appropriately when using the retired key
                                  management keys.
 DTR(s)                           • DTR-06.02.02.03
                                  • DTR-06.03.01.01
                                  • DTR-06.03.04.03
                                  • DTR-06.03.04.05
 Vendor                           None.
 Documentation
 Precondition(s)                  •    A token with the Derived PIV Application is inserted into an
                                       appropriate token reader.
                                  •    Suitable drivers have been loaded between the test system and an
                                       instance of the reader.
                                  •    The Derived PIV Application Password is recorded.
                                  •    The Derived PIV Application Password’s retry counter is not 0.
 Test Scenario                    1. Send the SELECT command with
                                        • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                                  2. Send the VERIFY command with
                                        • P2, key reference value, is set to '80'
                                        • Data field of the command will contain the
                                           correct Derived PIV Application Password value,
                                           padded with 'FF' (if necessary) to complete the
                                           total length of the value to 8 bytes
                                  3. Send the GET DATA command with
                                        • Data field of the command containing the tag of
                                           the Key History Object data object ('5FC10C').
                                           Retrieve the key history’s data elements:
                                        • If keysWithOnCardCerts = 0 and
                                           keysWithOffCardCerts > 0



11
     Z is the X coordinate of point P as defined in [SP800-56A], Section 5.7.1.2




                                                                57
