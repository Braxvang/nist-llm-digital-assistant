NIST SP 800-166                                                   DERIVED PIV APPLICATION AND
                                                                  DATA MODEL TEST GUIDELINES

                                indicates the container for the retired X.509 certificate does
                                not exist)
                         3. From Step 3, all mandatory tags in each of the available Retired
                            X.509 Certificates for Key Management are present in the
                            order indicated in Table 20 to Table 39 of [SP800-73], Part 1.

9.1.7 Security Object

9.1.7.1 BER-TLV of Security Object and Presence of Unsigned Data Objects

 Test Assertion          TA-09.01.07.01
 Purpose                 Verifies that the Security Object conforms to the Derived PIV data
                         model requirements and unsigned data objects are included within
                         the Security Object on the Derived PIV Application.
 DTR(s)                  • DTR-07.01.01.01
                         • DTR-07.01.08.01
                         • DTR-07.01.08.03
 Issuer Documentation    None.

 Precondition(s)         •   A token with the Derived PIV Application is inserted into an
                             appropriate token reader.
                         •   Suitable drivers have been loaded between the test system and
                             an instance of the reader.
                         •   A Security Object is present within the Derived PIV
                             Application.
 Test Scenario           1. Send the SELECT command with
                               • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                         2. Send the GET DATA command with
                               • Data field of the command containing the tag
                                  ('5FC106') for the Security Object
                         3. Read and parse the byte array in accordance with
                            BER-TLV format.
                         4. Parse the tag 0xBA to extract the Data Groups to
                            Container ID mapping instances.
                         5. Verify that all unsigned data objects (the
                            Discovery and/or Key History object) are included
                            in the Security Object.
                         6. Verify that the unsigned data objects exist within
                            the Derived PIV Application by reading the data
                            object from each container.
 Expected Result(s)      1. From Step 1, the command returns the application property
                            template with the status word '90 00'.
                         2. From Step 2, the command returns the Security Object
                            followed by status word '90 00'.
                         3. From Step 3, all mandatory tags for the Security Object are
                            present in the order indicated in Table 12 of [SP800-73], Part 1.




                                           94
