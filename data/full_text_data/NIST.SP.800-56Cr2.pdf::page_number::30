                                                                                               NIST SP 800-56C REV. 2                                 RECOMMENDATION FOR KEY DERIVATION METHODS
                                                                                                                                                                   IN KEY ESTABLISHMENT SCHEMES


                                                                                               a single instance of randomness extraction followed by m instances of key expansion for some
                                                                                               (implementation-dependent) integer m ≥ 2.

                                                                                                                                               L1, {IV1,} FixedInfo1


                                                                                                                                                       Key
                                                                                                                                                     Expansion           DerivedKeyingMaterial1


                                                                                                                                  KDK
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Cr2




                                                                                                                   Z                           L2, {IV2,} FixedInfo2


                                                                                                              Randomness          KDK                  Key
                                                                                                   salt        Extraction                            Expansion           DerivedKeyingMaterial2

                                                                                                                                                         •
                                                                                                                                                         •
                                                                                                                                                         •
                                                                                                                                  KDK
                                                                                                                                              Lm, {IVm,} FixedInfom


                                                                                                                                                       Key
                                                                                                                                                     Expansion           DerivedKeyingMaterialm

                                                                                                                 Figure 2: Randomness Extraction followed by Multiple Key Expansions

                                                                                               For conformance with this Recommendation, the following restrictions apply:

                                                                                               •    The auxiliary MAC algorithm employed for randomness extraction shall be either an
                                                                                                    implementation of HMAC as defined in [FIPS 198], based on an approved hash function, hash
                                                                                                    (i.e., HMAC-hash), or an implementation of AES-CMAC as defined in [SP 800-38B] (i.e.,
                                                                                                    AES-N-CMAC for N = 128, 192, or 256). In either case, the (untruncated) output of the MAC
                                                                                                    algorithm shall be used as the key-derivation key for subsequent key expansion. Tables 4 and
                                                                                                    5 in Section 5.2 describe the possibilities for the auxiliary MAC algorithm, which shall be
                                                                                                    chosen in accordance with the selection requirements specified in Section 7.
                                                                                               •    One of the general-purpose, PRF-based key-derivation functions defined in [SP 800-108] shall be
                                                                                                    used for key expansion. The same KDF shall be used to implement all m expansion operations.
                                                                                                    In particular, the same key-derivation mode (counter mode, feedback mode, or double-pipeline
                                                                                                    iteration mode) and the same PRF shall be employed by the KDF in each of the m key-
                                                                                                    expansion operations.
                                                                                               •    The PRF used by the KDF in key expansion is determined by the MAC algorithm that is used
                                                                                                    for randomness extraction. Specifically:
                                                                                                     a. If HMAC-hash is used for randomness extraction, then the same HMAC-hash (i.e., using


                                                                                                                                                22
