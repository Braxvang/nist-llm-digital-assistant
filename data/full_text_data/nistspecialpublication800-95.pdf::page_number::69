                                                                                            GUIDE TO SECURE WEB SERVICES



following subsections explain how auditing can be performed in SOAs. Section 3.7.2 explains the
relevance of non-repudiation in a Web services environment and the means by which it can be enforced.

3.7.1    Audit in the SOA Environment

Most COTS Web servers include an audit or security event logging service that provides the application
with the mechanism it needs to log security events to multiple destination logs. Configurable property-
driven parameters allow the administrator to modify the semantics of the application’s log data capture
without needing to rewrite the application code. For example, Java’s standard logging API provides an
extensible event logging service for many Java applications. Logging and audit entries captured may be
routed to the local operating system audit trail, or to audit middleware, using pluggable logging modules.

As noted, the audit/security event log data must be stored securely to prevent unauthorized tampering or
disclosure of the log data. This secure storage may be implemented by channeling the log data via a
secure connection to an external audit system, such as a central audit collection server, audit middleware,
or the operating system audit trail. The audit/security event logs should be secured, either by transmitting
the log data via an encrypted API, socket, or network connection, or by encrypting the log data before
transferring them via an unencrypted or encrypted channel. In the case of a COTS audit server or audit
middleware, the secure interface will ideally be provided as a standard feature of that product. If it is not,
the application could provide it using a secure protocol or tunnel common to both it and the external audit
system. Many organizations provide a logging core service within their SOA that other Web services can
dynamically bind to securely submit logging data for storage in a central location. In addition to storing
audit information on a remote system, it may be beneficial for Web services to store audit information
locally in the event the central logging service fails or is temporarily inaccessible. NIST SP 800-92 50
provides guidance on managing security logs throughout an organization. While this guidance is not
specific to SOA, many of the concepts introduced in the guide can be applied to Web services.

3.7.2    Non-Repudiation of Web Service Transactions

WS-Security provides non-repudiation services through its use of the XML Signature standard. Digital
signatures can provide the necessary level of assurance required for non-repudiation. Through
asymmetric encryption, each Web service has a unique key that can be used to sign SOAP elements. This
signature can be verified by any subsequent Web service to verify which Web service performed the
signature—and verify whether or not the signed element has changed, as a digital signature is only valid if
the signed data remains unchanged.

WS-Security can provide non-repudiation of both the SOAP message itself and its contents. WS-Security
supports signing the SOAP header, to ensure that the recipient and sender of the SOAP message have not
changed since the message was sent. The SOAP message can be logged so that an audit can reveal that
the SOAP message was valid. Additionally, sensitive information can be signed by another Web service
for inclusion in the SOAP message. This allows a Web service to include signed data in different SOAP
messages while maintaining that the original Web service signed the data—allowing the message sender
to sign the SOAP header for a message that was originally sent by a different Web service. This can be
particularly useful in Web service choreographies and orchestrations as the data may pass between a
number of Web services before reaching its intended destination.




50
     NIST SP 800-92, Guide to Computer Security Log Management, is available at http://csrc.nist.gov/publications/nistpubs/.


                                                            3-34
