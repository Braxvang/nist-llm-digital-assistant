B lock C i p h e r M ode s of O pe rat ion
     The engine for many of the techniques in NIST’s              CONTACT:
cryptographic toolkit is a block cipher algorithm, such as        Dr. Morris Dworkin
the Advanced Encryption Standard (AES) algorithm or the           (301) 975-2354
Triple Data Encryption Algorithm (TDEA). A block cipher           morris.dworkin@nist.gov
transforms some fixed-length binary data (i.e., a “block”)
into seemingly random data of the same length. The
transformation is determined by the choice of some secret
                                                                  Key Management
                                                                      NIST’s CSD continues to provide guidelines on
data called the “key.” The same key is used to reverse the
                                                                  cryptographic key management for the Federal Government,
transformation and recover the original block of data. A
                                                                  and to coordinate with other national and international
cryptographic technique that is constructed from a block
                                                                  organizations, industry, and academia.
cipher is called a mode of operation.
                                                                       SP 800-56B, Recommendation for Pair-Wise Key
     NIST’s CSD is developing AES modes of operation for
format-preserving encryption (FPE), based on proposals
                                                                  Establishment Schemes Using Integer Factorization
that were submitted from the private sector. A format
                                                                  Cryptography, was first published in August 2009. This
                                                                  publication specifies approved methods for automated
can be a sequence of decimal digits, such as a credit card
                                                                  key establishment using Rivest, Shamir, Adleman (RSA)
number or a social security number (SSN); formats can
                                                                  key-transport and key-agreement schemes. In an RSA key-
also be defined for other sets of characters besides decimal
                                                                  transport scheme, one party (called the sender) generates
digits. FPE produces ciphertext with the same format as the
                                                                  a key to be used in subsequent communications and sends
corresponding plaintext, so that, for example, an encrypted
                                                                  it to another party (called the receiver), encrypted using
SSN still looks like a valid SSN. FPE is expected to facilitate
                                                                  the receiver’s public key. In a key-agreement scheme, two
the retrofitting of encryption to existing applications. For
                                                                  parties contribute information that is used by each party
example, FPE could be applied to database systems, so that
                                                                  to compute a shared secret, which is then used to derive
the sensitive data could be targeted for encryption without
                                                                  a key that is known by both parties. The 2009 version
disrupting the underlying data fields/pathways.
                                                                  approved the use of 1024- and 2048-bit keys for both key-
    Draft SP 800-38G, Recommendation for Block Cipher             transport and key-agreement schemes, and in the case
Modes of Operation: Methods for Format-Preserving                 of the key-agreement schemes, specified two approved
Encryption, which was released for public comment in July         methods for key derivation, both using an approved hash
2013, included three methods for FPE called FF1, FF2, and         function. SP 800-56B has been revised to remove the use
FF3. These methods are modes of operation of the AES that         of 1024-bit keys because they no longer provide adequate
are intended to support a security strength of 128 bits or        protection for federal information, and to approve the use
more.                                                             of 3072-bit keys. This revision also includes the approval of
     As part of the public review of Draft SP 800-38G and         additional key-derivation methods specified in SP 800-56C,
as part of its routine consultation with other agencies, NIST     Recommendation for Key Derivation through Extraction-
was advised by the National Security Agency that the FF2          then-Expansion, and SP 800-135, Recommendation for
mode in the draft could not support 128 bits of security          Existing Application-Specific Key Derivation Functions,
strength for some use cases. NIST independently confirmed         and the use of Hash-based Message Authentication Code
this assessment, and in June 2014, NIST’s CSD announced its       (HMAC), as well as a hash function, during the key-derivation
intention to remove FF2 from the document.                        process. HMAC is specified in FIPS 198-1, The Keyed-Hash
                                                                  Message Authentication Code (HMAC). The revision of SP
    The FF2 mode was designed for the payment card
                                                                  800-56B was published in September 2014.
industry and submitted for NIST’s consideration in 2011 by
VeriFone Systems, Inc. NIST’s analysis does not imply any              SP 800-57, Recommendation for Key Management,
practical vulnerability for the implementations of FF2 in         Part 3: Application-Specific Key Management Guidance,
the payment card industry. Nevertheless, in order for FF2         was first published in 2009. This document addresses the
to meet NIST’s security requirements for other potential          key-management issues of currently available cryptographic
applications, VeriFone Systems, Inc. has indicated that it will   mechanisms, including the use of Public Key Infrastructures
submit a revised proposal for NIST CSD to review. Meanwhile,      (PKI) and several commonly used security protocols. A
CSD expects to finalize SP 800-38G with FF1 and FF3 in FY         revision of this document was provided for public comment
2015.                                                             in May 2014 that updated the guidance provided in the 2009
                                                                  version, included an additional section on the Secure Shell

34
COMPUTER SECURITY DIVISION ANNUAL REPORT | 2014
