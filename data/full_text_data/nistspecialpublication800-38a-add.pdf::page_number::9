                      Addendum to NIST Special Publication 800-38A




                                Figure 1: CBC-CS1-Encrypt

Algorithm: CBC-CS1-Decrypt

Input:          ciphertext C, such that len(C) is valid;
                initialization vector IV;
                key K.

Output:         plaintext P, such that len(P) = len(C).

Steps:

1.       Let n be the smallest integer such that n⋅b≥len(C), let d=len(C)-(n-1)⋅b, and let C1,
         C2, … , Cn-2, Cn-1*, Cn be the unique sequence of bit strings such that
                a) C=C1||C2||…||Cn-2 ||Cn-1*||Cn;
                b) Cn is a complete block; and
                c) if n>2, then C1,…,Cn-2, are complete blocks.
         Consequently, len(Cn-1*)=d, and 1≤d≤b, so that Cn-1* is either a complete block or
         a nonempty partial block.

2.       Let Z*=MSBd(CIPH-1K(Cn)), and Z**=LSBb-d(CIPH-1K(Cn)).

3.       Let Cn-1=Cn-1*||Z**. Note that if Cn-1* is a complete block, then Z** is the empty
         string, and Cn-1=Cn-1*.
4.       Apply CBC decryption to (C1, C2, …, Cn-1) with initialization vector IV and key K
         to produce (P1, P2, … Pn-1).

                                              3
