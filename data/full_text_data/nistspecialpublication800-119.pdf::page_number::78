                                                             GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


    – Mobile Prefix Advertisement
   Two new types of Destination Options Extension Header called the Home Address Option and
    Alternate Care-of-Address Option

   A new Routing Header, Type 2.
To get an idea of how these are used, consider the following examples:

    A. A MN announces a new CoA:

            –   A Binding Update (BU) and Binding Update Acknowledgement (BUA) are exchanged
                between the MN and its HA and between the MN and each of its CNs.

            –   The BU uses a Binding Update (Type 5) IPv6 Mobility Header and the Home Address
                Option. The BUA uses a Binding Update Acknowledgment (Type 6) IPv6 Mobility
                Header and a Type 2 Routing Header.
    B. A MN finds a HA:

            –   The MN initiates the Dynamic Home Agent Address Discovery (DHAAD) protocol.

            –   To do this, the MN sends an ICMPv6 Home Agent Address Discovery Request to the
                Mobile IPv6 Home-Agent’s anycast address (with which the MN was previously
                configured) for its home subnet prefix. A HA returns an ICMPv6 Home Agent Address
                Discovery Reply.
    C. A MN learns about home link renumbering:

            –   A MN receives an unsolicited ICMPv6 Mobile Prefix Advertisement (MPA) indicating
                that renumbering is occurring.
    D. A MN uses route-optimized communications between it and a CN:

            –   The MN sends normal traffic with a Home Address Option.

            –   The CN sends normal traffic with an IPv6 Type 2 Routing Header.
    E. A MN receives a Binding Refresh request from a CN:

            –   The CN sends a Binding Refresh Request (Type 0) Mobility Header to the MN’s HoA.

            –   The MN checks that the CN is in its Binding Update List and starts Return Routability
                and a new BU.
    F. A CN sends a Binding Error to a MN:

            –   A CN receives an unrecognized HoA and sends the MN a Binding Error with a Binding
                Error (Type 7) MH, error status 1 for ―unknown binding,‖ and the HoA it received in
                error.

            –   The MN checks that the CN is in its Binding Update List; if it has indication that
                communications with the CN are working, it ignores the message; otherwise it deletes the
                binding and sends subsequent communications with the CN through the HA or
                alternatively starts Return Routability and a new BU.



                                                  4-15
