                                                    ESTABLISHING WIRELESS ROBUST SECURITY NETWORKS: A GUIDE TO IEEE 802.11I




     Field 1       Field 2       Field 3                   Field 4                                                  Field 5

       Element                                                                     Group Key Cipher                      Pairwise Cipher
                     Length                  Version
          ID                                                                            Suite                             Suite Count

         1 octet     1 octet                 2 octets                                  4 octets                               2 octets



     Field 6                                               Field 7                       Field 8
                                                              Authentication and                           Authentication and
                          Pairwise Cipher
                                                              Key Management                               Key Management
                             Suite List
                                                                 Suite Count                                   Suite List

                             4-m octets                                2 octets                                 4-n octets



     Field 9                      Field 10                 Field 11
                                                                                                      m denotes the Pairwise Key Cipher Suite
                                                                                                      Count.
         RSN Capabilities                  Key ID Count              Key ID List
                                                                                                      n denotes the Authentication and Key
                                                                                                      Management Suite Count.
               2 octets                       2 octets               16-
                                                                     16-s octets
                                                                                                      s denotes the KeyID Count.



                                           Figure 5-6. Fields of the RSN Information Element



5.3.2      Discovery Phase Frame Flows

Figure 5-7 depicts the flow of the three Request-Response pairs that comprise the discovery phase. In this
scenario, the STA sends a Probe Request frame to locate an AP in the area. The AP responds with its
capabilities in the RSNIE field of the Probe Response frame; this includes all of its enabled encryption
and authentication capabilities. When the STA receives the Probe Response frame, it performs open
system authentication—null authentication—with the AP. The purpose of this frame sequence, which
provides no security, is simply to maintain backward compatibility with the IEEE 802.11 state machine, 54
as implemented in existing IEEE 802.11 hardware.

Following the authentication frame exchange, the STA then sends an Association Request frame to the
AP. In this frame, the STA specifies one set of matching capabilities (one authentication and key
management suite, one pairwise cipher suite, and one group key cipher suite) from among those
advertised by the AP. If there is no match in capabilities between the AP and the STA, the AP refuses the
Associate Request. The STA blocks it too, in case it has associated with a rogue AP or someone is
inserting frames illicitly on its channel. As shown in the figure, the IEEE 802.1X controlled ports are
blocked, and no user traffic goes beyond the AP. This process of mutually advertising and agreeing on
the security capabilities is referred to as security policy negotiation.




54
      The term state machine refers to a structured software algorithm that performs a particular function in electronic equipment.
      In this case, the algorithm is that which performs IEEE 802.11 communications.


                                                                        5-9
