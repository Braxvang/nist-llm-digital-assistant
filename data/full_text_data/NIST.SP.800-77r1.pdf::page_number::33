                                                                                              NIST SP 800-77 REV. 1                                                                                   GUIDE TO IPSEC VPNS


                                                                                              As shown in Figure 4, the host-to-host VPN (indicated by the solid line) provides protection for
                                                                                              data throughout its transit. This can be a problem because network-based firewalls, intrusion
                                                                                              detection systems, and other network devices cannot be deployed to inspect the traffic in transit,
                                                                                              which effectively circumvents certain layers of security. 13 The host-to-host VPN is most often
                                                                                              used when a small number of trusted users or administrators need to access a system from remote
                                                                                              locations using insecure protocols (e.g., a legacy system) as long as the system can be updated to
                                                                                              provide VPN services.

                                                                                              Host-to-host VPNs can be resource-intensive to implement and maintain in terms of
                                                                                              configuration management. Host-to-host VPNs are not transparent to users because they must
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              authenticate the user before using the VPN. Also, all end user systems and servers that will
                                                                                              participate in VPNs need to have VPN software installed and/or configured. However, the host-
                                                                                              to-host architecture can be deployed in a more automated way that requires no end user
                                                                                              interaction to establish a VPN.

                                                                                              A special case of host-to-host VPNs is a large-scale host-to-host IPsec deployment. This is
                                                                                              typically used when one wants to encrypt all connections within a network, cloud, or datacenter.
                                                                                              Whenever one host in such a network wishes to communicate with another host in the network, it
                                                                                              first establishes an IPsec connection. This is also called mesh encryption. Usually, these IPsec
                                                                                              connections are packet triggered. An application in one host sends a packet to another host
                                                                                              remote to it. The kernel of the host on which the application runs receives the packet from the
                                                                                              application and determines that it does not have an IPsec connection to that remote host, so it
                                                                                              triggers the setup of an IPsec connection. Once the IPsec connection is established, the packet is
                                                                                              encrypted and sent to the remote host. This way, no unencrypted packet is ever sent over the
                                                                                              network. Hosts authenticate each other using X.509 certificates or Domain Name System
                                                                                              Security Extensions (DNSSEC) 14. These types of authentication are based on a shared trust
                                                                                              anchor: an X.509 certificate authority (CA) or a DNSSEC zone key. This allows hosts to be
                                                                                              added to a network without the need to reconfigure all other hosts to learn about the newly
                                                                                              deployed host.

                                                                                              One advantage of this type of IPsec architecture is that every host is responsible for its own
                                                                                              protection; no large expensive IPsec gateways are required, which also means there is no single
                                                                                              point of failure added to the network architecture. Hosts in a network can be configured to insist
                                                                                              on IPsec or to attempt IPsec but allow cleartext communication if that fails. This architecture can
                                                                                              be combined with the gateway-to-gateway architecture, where hosts within one network can
                                                                                              initiate IPsec to hosts in another network, extending the network mesh encryption to both
                                                                                              networks. The two networks are connected by a gateway-to-gateway architecture so that the
                                                                                              internet can still be used to connect these two networks at the cost of packets being encrypted



                                                                                              13   Device placement can also be an issue in remote access and gateway-to-gateway architectures, but in those architectures, it
                                                                                                   is usually possible to move devices or deploy additional devices to inspect decrypted data. This is not possible with a host-
                                                                                                   to-host architecture.
                                                                                              14   DNSSEC is a system of digital signatures to authenticate DNS content. The DNSSEC core specifications are defined in
                                                                                                   IETF RFCs 4033, 4034, and 4035.




                                                                                                                                                              16
