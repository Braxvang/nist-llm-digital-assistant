                                                                                              NIST SP 800-77 REV. 1                                                           GUIDE TO IPSEC VPNS


                                                                                              5.1.1   The Security Association Database (SAD)

                                                                                              The kernel maintains a state for each IPsec SA. An IPsec connection between two hosts consists
                                                                                              of a pair of IPsec SAs—one for inbound and one for outbound traffic. These IPsec states are
                                                                                              contained in the SAD. Figure 12 shows an example of an IPsec SA using an AEAD algorithm.

                                                                                              src 198.51.100.1 dst 203.0.113.1
                                                                                                  proto esp spi 0xba293cd3(3123264723) reqid 1(0x01) mode tunnel
                                                                                                  replay-window 32 seq 0x00000000 flag af-unspec (0x00100000)
                                                                                                  aead rfc4106(gcm(aes)) 0x2ee20e32be3017c1878b9ae514081ba1d[…] 128
                                                                                                  anti-replay context: seq 0x148a3, oseq 0x0, bitmap 0xffffffff
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                                  lifetime config:
                                                                                                    limit: soft (INF)(bytes), hard (INF)(bytes)
                                                                                                    limit: soft (INF)(packets), hard (INF)(packets)
                                                                                                    expire add: soft 0(sec), hard 0(sec)
                                                                                                    expire use: soft 0(sec), hard 0(sec)
                                                                                                  lifetime current:
                                                                                                    102600783(bytes), 84090(packets)
                                                                                                    add 2019-01-06 21:57:45 use 2019-01-06 21:57:50
                                                                                                  stats:
                                                                                                    replay-window 0 replay 0 failed 0

                                                                                              src 203.0.113.1 dst 198.51.100.1
                                                                                                  proto esp spi 0x6273ec0a(1651764234) reqid 1(0x01) mode tunnel
                                                                                                  replay-window 32 seq 0x00000000 flag af-unspec (0x00100000)
                                                                                                  aead rfc4106(gcm(aes)) 0x0afaf19501d6d94174bb3036b84d59d78e[…] 128
                                                                                                  anti-replay context: seq 0x0, oseq 0x7829, bitmap 0x00000000
                                                                                                  lifetime config:
                                                                                                    limit: soft (INF)(bytes), hard (INF)(bytes)
                                                                                                    limit: soft (INF)(packets), hard (INF)(packets)
                                                                                                    expire add: soft 0(sec), hard 0(sec)
                                                                                                    expire use: soft 0(sec), hard 0(sec)
                                                                                                  lifetime current:
                                                                                                    2422796(bytes), 30761(packets)
                                                                                                    add 2019-01-06 21:57:45 use 2019-01-06 21:57:50
                                                                                                  stats:
                                                                                                     replay-window 0 replay 0 failed 0
                                                                                                  Figure 12: Example of an ESP IPsec SA (Inbound and Outbound) Using an AEAD Algorithm on Linux

                                                                                              If a non-AEAD algorithm is used, such as AES-CBC with HMAC-SHA-1, the SA will contain
                                                                                              the encryption and integrity keys separately. Figure 13 illustrates this. Note that this example
                                                                                              uses FreeBSD, which calls the AES algorithm by its original candidate name, Rijndael.




                                                                                                                                               48
