                                                                                               NIST SP 800-56B REV. 2                             RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                       USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                               The method is the same as the rsapkv1-basic method in Section 6.4.1.2.1 except that:
                                                                                                   A. A value for efixed is not available as an input parameter.
                                                                                                   B. Step 1.c is replaced by:
                                                                                                       If epub is not an odd integer such that 65,537 ≤ epub < 2256, output an indication that the
                                                                                                           exponent is out of range, and exit without further processing.
                                                                                                   C. Step 2 is omitted (i.e., not used).
                                                                                               A routine that implements this validation function shall destroy any local copies of p, q, and d, as
                                                                                               well as any other locally stored values used or produced during the execution of the routine. The
                                                                                               destruction of these locally stored values shall occur prior to or during any exit from the routine
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                               (whether exiting early because of an error or exiting normally).

                                                                                               6.4.1.4.2   prime-factor-pkv
                                                                                               In this format, the private key is represented as (p, q, d).
                                                                                               Function call: prime-factor_pkv (s, nBits, (npub, epub), (p, q, d))
                                                                                               The inputs, outputs and errors are the same as in rsakpv1-basic (see Section 6.4.1.2.1) except that
                                                                                               the private key is in the prime factor format: (p, q, d).
                                                                                               The steps are the same as in rsakpv1-basic (see Section 6.4.1.2.1) except that:
                                                                                                   A. A value for efixed is not available as an input parameter.
                                                                                                   B. Step 1.c is replaced by:
                                                                                                       If epub is not an odd integer such that 65,537 ≤ epub < 2256, output an indication that the
                                                                                                           exponent is out of range, and exit without further processing.
                                                                                                   C. Step 2 is omitted (i.e., not used).
                                                                                                   D. Step 3 is replaced by the following:
                                                                                                           3. Check the modulus:
                                                                                                                   a. If npub ≠ p × q, output an indication of an invalid key pair, and exit without
                                                                                                                      further processing.
                                                                                                                   b. If len(npub) ≠ nBits, output an indication of an invalid key pair, and exit
                                                                                                                      without further processing.
                                                                                                                   c. If nBits is not a positive even integer, output an indication of an invalid key
                                                                                                                      pair, and exit without further processing.
                                                                                                   E. Step 4 (prime-factor recovery) is omitted (i.e., not used).
                                                                                               A routine that implements this validation function shall destroy any local copies of p, q, and d, as
                                                                                               well as any other locally stored values used or produced during its the execution of the routine.
                                                                                               Their destruction of these values shall occur prior to or during any exit from the routine (whether
                                                                                               exiting early because of an error, or exiting normally).


                                                                                                                                                 54
