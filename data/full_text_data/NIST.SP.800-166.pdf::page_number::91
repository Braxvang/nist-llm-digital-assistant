NIST SP 800-166                                                  DERIVED PIV APPLICATION AND
                                                                 DATA MODEL TEST GUIDELINES

8.3.8 GENERATE ASYMMETRIC KEY PAIR Command

8.3.8.1 Generate Asymmetric Key Pair for the Various Keys

 Test Assertion      TA-08.03.08.01
 Purpose             Verifies that the Derived PIV Application responds appropriately to the
                     GENERATE ASYMMETRIC KEY PAIR command.
 DTR(s)              •  DTR-06.02.02.09
                     •  DTR-06.03.01.01
                     •  DTR-06.03.04.05
                     •  DTR-06.03.09.01
                     • DTR-06.03.09.02
 Vendor              The vendor to provide documentation specifying the cryptographic
 Documentation       mechanism identifiers (from Table 5 of [SP800-73], Part 1) that have
                     been implemented.
 Precondition(s)     • A token with the Derived PIV Application is inserted into an
                        appropriate token reader.
                     • Suitable drivers have been loaded between the test system and an
                        instance of the reader.
                     • The Derived PIV Application Token Management Key is recorded.
                     • The mutual authentication of the Derived PIV Application and the
                        Test Toolkit Application has not been performed.
                     • The Derived PIV Application Password is recorded.
                     • The Derived PIV Application Password’s retry counter is not 0.
 Test Scenario       1. Send the SELECT command with
                           • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                     2. Send the GENERATE ASYMMETRIC KEY PAIR command with
                           • P2 is set to value '9A'
                           • Data field in the command is to include either
                              '07' or '11' as the cryptographic mechanism
                              identifier
                     3. If the X.509 Certificate for Digital Signature is
                        supported, send the GENERATE ASYMMETRIC KEY PAIR
                        command with
                           • P2 is set to value '9C'
                           • Data field in the command is to include either
                              '07', '11', '14' as the cryptographic mechanism
                              identifier
                     4. If the X.509 Certificate for Key Management and the on-
                        token generation of the key management key is
                        supported, send the GENERATE ASYMMETRIC KEY PAIR
                        command with
                           • P2 is set to value '9D'
                           • Data field in the command is to include either
                              '07', '11', '14' as the cryptographic mechanism
                              identifier




                                           84
