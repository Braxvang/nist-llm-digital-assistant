NIST SP 800-58                                              Voice Over IP Security
_____________________________________________________________________________

         that the application intelligence is extracted to can be an “in-path” system such as
         an H.323 gatekeeper or a SIP Proxy that sits in the control path of the session and
         is considered to be a “trusted system” [28] that parses VOIP traffic and instructs
         the firewall to open or close ports based on the needs of the VOIP signaling via a
         midcom protocol (see Figure 10). The midcom protocol has not been finalized
         yet by the IETF. Abstracting stateful inspection and manipulation of signaling
         packets from the NATs and firewalls (middleboxes) will improve scalability and
         in the long run, reduce the cost of updating the network[10] by not having to
         replace the firewall every time the protocols change. There is also a performance
         improvement that comes from abstracting two highly processor intensive tasks
         (VOIP parsing and packet filtering) into two separate spheres of influence. This
         strategy is currently being pursued by the IETF in the Middlebox
         Communications (Midcom) Working Group.




                             Figure 10. Middlebox Communications Scenario



         There are some drawbacks to this approach. First, the firewall must be configured
         for control by the application-aware device, which incurs an initial setup cost.
         Also, the middlebox itself requires protection from attackers. A compromised
         midcom agent is disastrous for the network at large because the firewall takes
         control cues from the “trusted” device running the midcom agent. Thus an
         intruder taking control of the midcom agent could open any ports in the firewall
         and then gain access to the private network. So if the application aware device
         (like a SIP Proxy) is placed outside the firewall, a second firewall would have to
         be used to protect that device.

 7.4.3    Session Border Controllers

         While application level gateways may carry scalability concerns, middlebox
         solutions have not found their way out of standards bodies and into commercial
         products as fast as might have been hoped. In the absence of a universally
         accepted solution to the issues associated with firewall/NAT traversal, product
         developers have brought to market a solution that has come to be known as a


60
