                                                                                             NIST SP 800-189                                              RESILIENT INTERDOMAIN TRAFFIC EXCHANGE:
                                                                                                                                                                  BGP SECURITY & DDOS MITIGATION

                                                                                             wishes to drop. Table 2 shows the information that can be included in BGP Flowspec [RFC5575]
                                                                                             [RFC5575bis].
                                                                                                                                  Table 2: BGP Flowspec types

                                                                                                                          Type 1       Destination Prefix
                                                                                                                          Type 2       Source Prefix
                                                                                                                          Type 3       IP Protocol
                                                                                                                          Type 4       Source or Destination Port
                                                                                                                          Type 5       Destination Port
                                                                                                                          Type 6       Source Port
                                                                                                                          Type 7       ICMP Type
                                                                                                                          Type 8       ICMP Code
                                                                                                                          Type 9       TCP flags
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-189




                                                                                                                          Type 10      Packet length
                                                                                                                          Type 11      DSCP
                                                                                                                          Type 12      Fragment Encoding


                                                                                             Table 3 shows the extended community values that are defined to specify various types of
                                                                                             actions [RFC5575] [RFC5575bis] requested at the upstream AS.
                                                                                                    Table 3: Extended community values defined in Flowspec to specify various types of actions

                                                                                                   Type          Extended Community                                Encoding
                                                                                                   0x8006        Traffic-rate (set to 0 to drop all traffic)       2-byte as#, 4-byte float
                                                                                                   0x8007        Traffic-action (sampling)                         Bitmask
                                                                                                   0x8008        Redirect to VRF (route target)                    6-byte route target
                                                                                                   0x8009        Traffic-marking                                   DSCP value

                                                                                             In the table above, VRF stands for “virtual routing and forwarding,” and DSCP stands for
                                                                                             “differentiated services code point”. Flowspec facilitates flexible specification and
                                                                                             communication (by downstream AS) of rules and actions for DDoS mitigation to be executed at
                                                                                             edge routers in the upstream AS.

                                                                                                  Security Recommendation 60: Edge routers should be equipped to perform
                                                                                                  destination-based remotely triggered black hole (D/RTBH) filtering and source-based
                                                                                                  remotely triggered black hole (S/RTBH) filtering.

                                                                                                  Security Recommendation 61: Edge routers should be equipped to make use of BGP
                                                                                                  flow specification (Flowspec) to facilitate DoS/DDoS mitigation (in coordination between
                                                                                                  upstream and downstream autonomous systems).

                                                                                                  Security Recommendation 62: Edge routers in an AS providing RTBH filtering
                                                                                                  should have an ingress policy towards RTBH customers to accept routes more specific than
                                                                                                  /24 in IPv4 and /48 in IPv6. Additionally, the edge routers should accept a more specific
                                                                                                  route (in case of D/RTBH) only if it is subsumed by a less-specific route that the customer
                                                                                                  is authorized to announce as standard policy (i.e., the less-specific route has a registered

                                                                                                                                               39
