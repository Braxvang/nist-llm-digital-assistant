                                 NIST Special Publication 800-38F



Appendix A: Some Security Considerations

A.1    Equality of Plaintexts
Each key-wrap algorithm in this Recommendation is deterministic: for a given designated cipher
function and KEK, any invocation of the authenticated-encryption function on a given plaintext
produces the same ciphertext. It follows that any pair of ciphertexts reveals whether the
corresponding plaintexts are equal.

Therefore, ideally, for a given designated cipher function and KEK, the authenticated-encryption
function should be invoked only once on each plaintext. If multiple invocations are necessary on
the same data for a system, then one method for ensuring that the ciphertexts are different would
be to prepend the data with a fixed-length nonce before invoking the authenticated-encryption
function. Upon authenticated decryption, the nonce would be discarded.

A.2    Implied Strength of Protected Keys
The disclosure of a KEK potentially compromises any data (i.e., any key) that the KEK protects.
Therefore, the cryptographic strength of the protected key is limited implicitly by the resistance
of the KEK to brute force search, and this resistance is limited by the length of the KEK. To
maintain the expected level of assurance, the generation and management of the KEK should be
at least as strong cryptographically as any key that it protects.

A.3    Authentication Assurance
The expansion of the plaintext within the authenticated-encryption function provides the
mechanism whereby assurance of the authenticity of the data can be obtained when the
authenticated-decryption function is invoked. The nature of this assurance depends on the output
of the authenticated-decryption function:

      • If the output is a plaintext, i.e., not FAIL, then the design of the mode provides strong,
      but not absolute, assurance of the authenticity of the data, i.e., that the ciphertext was
      generated by an invocation of the authenticated-encryption function on the plaintext. The
      authenticity implies the integrity of the ciphertext and resulting plaintext, i.e., that they
      were not altered, intentionally or unintentionally, after the generation of the ciphertext.

      • If the output is FAIL, then it is certain that the ciphertext is not authentic.

In the first case, the assurance is not absolute because forgeries are possible, in principle. In other
words, an adversary, without access to the key or to an implementation of the authenticated-
encryption function, may be able to produce a genuine ciphertext, for example, by a lucky guess.

In particular, if the adversary chooses a string at random with a valid ciphertext length, the
probability that the string will be a genuine ciphertext is exactly 1 in 264 for KW, and
approximately 1 in 264 for KWP. The probability that a randomly chosen ciphertext will appear
to be genuine for TKW is greater, 1 in 232, so TKW is significantly more vulnerable to forgeries.




                                                   19
