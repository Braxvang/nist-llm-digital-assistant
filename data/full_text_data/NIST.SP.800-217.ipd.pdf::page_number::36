      NIST SP 800-217 ipd                         Guidelines for PIV Federation (Initial Public Draft)
      January 2023


939       • AAL for the latest successful authentication event for the subscriber’s current
940         session at the IdP
941       • Timestamp of the latest successful authentication event for the subscriber’s current
942         session at the IdP
943       • Flag indicating whether the PIV Card or a derived PIV credential was used at the
944         authentication event for the subscriber’s current session at the IdP
945       • Intended FAL for the current transaction
946   For FAL3 assertions in PIV federation, the assertion SHALL contain either:
947       • A reference to an IdP-managed bound authenticator to be verified by the RP (such
948         as the Subject Distinguished Name of the PIV Card authentication certificate), or
949       • A flag indicating that an RP-managed bound authenticator is required at the RP.
950   The mapping of these required attributes to specific fields within a given federation
951   protocol is out of scope for this specification.

952   6.2.1. Federated Identiﬁer
953   The assertion created by a PIV IdP includes a federated identifier for the PIV identity
954   account, as defined in [SP800-63C]. The federated identifier consists of the logical
955   combination of both a local subject identifier for the PIV identity account and a global
956   issuer identifier for the IdP.
957   The subject identifier SHALL be unique to the PIV identity account at the IdP such that
958   no identifier is the same for any two PIV identity accounts at an IdP. The subject identifier
959    MAY be generated by the IdP in a pairwise fashion for a specific RP, as discussed in
960   [SP800-63C]. If such a pairwise identifier is used, it SHALL be used consistently with a
961   given RP and SHALL NOT be used for multiple RPs except as allowed by [SP800-63C].
962   The issuer identifier SHALL be globally unique for the IdP. This identifier is usually the
963   URL of the IdP, but it can be a unique key identifier or other globally unique value that
964   can be verified by the RP as part of the assertion.
965   The federated identifier SHALL NOT include any personally identifiable or private
966   information, such as username, identifier, the distinguished name of the PIV
967   authentication certificate, email addresses, or UUIDs for the PIV Card or cardholder.
968   The RP SHALL use this federated identifier to uniquely associate the PIV identity
969   account with the RP subscriber account, as defined in [SP800-63C]. The RP SHALL NOT
970   use other attributes alone for this purpose, including email addresses, certificate subject
971   names, or PIV cardholder UUIDs.




                                                   26
