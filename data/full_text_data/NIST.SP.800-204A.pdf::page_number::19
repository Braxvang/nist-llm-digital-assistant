                                                                                              NIST SP 800-204A                                BUILDING SECURE MICROSERVICES-BASED APPLICATIONS
                                                                                                                                                              USING SERVICE-MESH ARCHITECTURE


                                                                                              4     Service Mesh Deployment Recommendations

                                                                                              This chapter considers the deployment options in Service Mesh and provides recommendations
                                                                                              for secure microservices-based application for various application scenarios. Since the primary
                                                                                              runtime functions are performed by proxies, the first deployment recommendations are in the
                                                                                              context of configuring the various aspects of proxy functions. Each of the deployment
                                                                                              recommendations are identified through the symbol SM-DRx, where SM stands for Service
                                                                                              Mesh, DR stands for deployment recommendation, and x is the number in the sequence.

                                                                                              4.1   Communication Configuration for Service Proxies
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-204A




                                                                                              Recommendation for Allowed Traffic into Service Proxies (SM-DR1): There should be a feature
                                                                                              to specify the set of protocols and ports into which a service proxy can accept traffic for its
                                                                                              associated service. By default, a service proxy should not allow traffic except as specified by this
                                                                                              configuration.

                                                                                              Recommendation for Reachability of Service Proxies (SM-DR2): The set of services that a
                                                                                              service proxy can reach must be limited. There should be features to limit access based on
                                                                                              namespace, a specific named service within a given namespace, or the serviceâ€™s runtime identity.
                                                                                              Access to the control plane of the Service Mesh must always be provided to relay discovery,
                                                                                              different policies, and telemetry data.

                                                                                              Recommendation for Protocol Translation Capabilities (SM-DR3): The service proxy should
                                                                                              have built-in capabilities to support clients communicating with different protocols than the
                                                                                              target microservice (e.g., convert REST/HTTP requests to gRPC requests or upgrade HTTP/1.1
                                                                                              to HTTP/2). This is required to avoid the need for building a separate server per client protocol,
                                                                                              which increases the attack surface.

                                                                                              Recommendation for User Extensibility (SM-DR4): The service proxy should have features for
                                                                                              defining custom logic in addition to built-in logic for handling network functions. This is
                                                                                              required to ensure that the service proxy can be extended to implement use case specific policies
                                                                                              (e.g., preexisting or home-grown policy engines). The implementation should provide means to
                                                                                              control the risks of extensibility, such as sandboxing, restricting the APIs/runtimes of languages
                                                                                              used, or performing pre-analysis that ensures safety (e.g. WASM or eBPF).

                                                                                              Recommendation for Dynamic Configuration Features for Proxies (SM-DR5): There should be
                                                                                              options to configure proxies dynamically (e.g., event-driven configuration updates) in addition to
                                                                                              static configuration. In other words, there should be discovery services for those entities that are
                                                                                              expected to be dynamic rather than known at the time of deployment. Further, the proxy should
                                                                                              atomically swap to the new dynamic configuration at runtime while efficiently handling (i.e.,
                                                                                              completing or terminating) outstanding requests under the previous configuration. This is
                                                                                              required for timely enforcement of policy changes at runtime without any degradation of user
                                                                                              traffic or downtime (i.e., without restarting the service proxy).

                                                                                              Recommendation for configuring communication between application service to its proxy (SM-
                                                                                              DR6): The application service and its associated proxy should only communicate through a
                                                                                                                                              11
