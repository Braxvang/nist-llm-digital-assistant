                                              GUIDE TO INTEGRATING FORENSIC TECHNIQUES INTO INCIDENT RESPONSE



         the image for the malware and the e-mail. For example, temporary files from the Web browser
         may contain a copy of the e-mail’s contents.
      ! Spoofed. If the IP address was fabricated—for example, if it is not a valid address within the
        organization’s networks—the incident handler should rely on other data sources to identify the
        host that actually sent the e-mail message.
The organization’s e-mail servers are another likely source of information. Each of the server IP
addresses listed in the e-mail header should contain some record of the e-mail, including the message ID
value, which should facilitate quick identification of pertinent records. As mentioned previously, the final
e-mail server in the list may contain a copy of the e-mail. Backups of that server may contain a copy of
the e-mail, but only if it was held there for delivery for several hours or more. Other services associated
with e-mail, such as antivirus software and spam filters, may also contain basic records of e-mail activity,
but are unlikely to contain many details. Another possible source of information is authentication
records. Although few e-mail servers require users to authenticate to send e-mail, they typically do
require authentication to deliver e-mail to users. Because users often send and receive e-mail during a
single session, authentication logs may contain records for receiving e-mail that can be helpful in
determining who may have sent a particular e-mail.

Another possible source of information is a record of the network traffic generated by sending or
receiving the e-mail. Packet sniffers or network forensic analysis tools that were monitoring network
activity might have captured the activity, including the actual IP addresses of the sending or receiving
hosts, the contents and header of the e-mail, and any associated authentication activity.

Ultimately, the incident handler should identify the hosts that were used to send and receive the e-mail, as
well as all intermediate hosts that transferred the e-mail from sender to receiver. The incident handler
should collect copies of the e-mail and supporting information from each relevant host and, using the
timestamps in records, should re-create the sequence of events from a cyber perspective. For example, a
possible sequence might be as follows:

         A user logged on to a particular desktop computer at 8:37 a.m. At 10:02 a.m., the
         threatening e-mail was sent from that computer using its built-in e-mail client. The e-
         mail passed through three of the organization’s e-mail servers and was stored on
         Server 4 to await retrieval by the intended recipient. The recipient user logged onto a
         particular laptop computer at 11:20 a.m. and downloaded e-mail, including the
         threatening e-mail, at 11:23 a.m. The contents of the e-mail on the recipient’s
         computer, as well as user-provided header fields (e.g., From, To, Subject), were
         identical to a copy saved in the Sent folder on the first user’s desktop computer.

This information can be used as a basis for further investigation; although it documents cyber activities, it
does not tell the whole story. For example, it cannot determine which person actually sent the e-mail
from the desktop computer, only which user account was in use at the time. The incident handler could
analyze the desktop computer in question to verify its integrity, such as comparing its security settings
and controls to the organization’s baseline settings, checking its clock settings, and checking the system
for signs of compromise and other breaches of security.

8.3     Recommendations

The key recommendations presented in this section for using data from multiple sources are as follows:

      ! Analysts can handle many situations most effectively by analyzing several individual data
        sources and then correlating events among them. The techniques and processes for collecting,


                                                     8-5
