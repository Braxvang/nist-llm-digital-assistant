                    Addendum to NIST Special Publication 800-38A




1 Introduction

A limitation to Cipher Block Chaining (CBC) mode, as specified in NIST SP 800-38A,
Ref. [1], is that the plaintext input must consist of a sequence of blocks. (In the rest of
this publication, a block is called a “complete block” to emphasize the contrast with a
“partial block” whose bit length is smaller than the block size.) Although Appendix A of
Ref. [1] describes how padding methods can be used to meet this requirement, in such
cases, the length of the resulting ciphertext expands over the length of the unpadded
plaintext by the number of padding bits.

This addendum to Ref. [1] specifies three variants of CBC mode that accept any plaintext
input whose bit length is greater than or equal to the block size, whether or not the length
is a multiple of the block size. Unlike the padding methods discussed in Ref. [1], these
variants avoid ciphertext expansion.

These variants are denoted CBC-CS1, CBC-CS2, and CBC-CS3, where “CS” indicates
“ciphertext stealing,” because when padding bits are needed in these variants, they are
taken from the penultimate ciphertext block. The variants differ only in the ordering of
the ciphertext bits. CBC-CS1 was specified as a suggestion on the NIST Computer
Security Resource Center web site. CBC-CS2 is specified, for example, in Ref. [3].
CBC-CS3 is the variant specified for Kerberos 5 in Ref. [2].

Below are the specifications for encryption and decryption using CBC-CS1, CBC-CS2,
and CBC-CS3, building on the specification of the CBC encryption and decryption in
Ref. [1]. Diagrams are given for CBC-CS1 encryption and decryption. Each variant
inherits the relevant requirements of Ref. [1], e.g., on the underlying block cipher, the
key, and the initialization vector.

The following notational conventions apply to the specifications below:

   •   Bit strings are denoted with upper case letters; integers with lower case letters.
   •   The block size of the underlying block cipher is denoted b.
   •   For a bit string X, the bit length of X is denoted len(X).
   •   For a bit string X and a positive integer r that does not exceed len(X), the string
       consisting of the leftmost r bits of X is denoted MSBr(X), and the string consisting
       of the rightmost r bits of X is denoted LSBr(X).
   •   For an input block B and key K, the output block of the cipher function
       (“encryption”) is denoted CIPHK(B), and the output block of the inverse cipher
       function (“decryption”) is denoted CIPH-1K(B).

In principle, the input strings to encryption and decryption for each of the variants may be
any string whose length is not less than b bits, but typically an implementation is
designed to accept a restricted set of lengths. For example, the set of lengths may be



                                             1
