                                                                                             NIST SP 800-189                                                RESILIENT INTERDOMAIN TRAFFIC EXCHANGE:
                                                                                                                                                                    BGP SECURITY & DDOS MITIGATION

                                                                                             5.1.3   SAV Using Feasible-Path Unicast Reverse Path Forwarding

                                                                                             The feasible-path uRPF helps partially overcome the problem identified with the strict uRPF in
                                                                                             the multi-homing case. The feasible-path uRPF is similar to the strict uRPF, but in addition to
                                                                                             inserting the best-path prefix, additional prefixes from alternative announced routes (on the
                                                                                             interface under consideration) are also included in the RPF list (see definition at the top of
                                                                                             Section 5.1). This method relies on either (a) announcements for the same prefixes (albeit some
                                                                                             may be prepended to affect lower preference) propagating to all transit providers performing
                                                                                             feasible-path uRPF checks or (b) announcement of an aggregate less-specific prefix to all transit
                                                                                             providers while announcing more-specific prefixes (covered by the less-specific prefix) to
                                                                                             different transit providers as needed for traffic engineering. As an example, in the multi-homing
                                                                                             scenario (see Figure 10, Scenario 2), if the customer AS announces routes for both prefixes (P1,
                                                                                             P2) to both transit providers (with suitable prepends if needed for traffic engineering), then the
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-189




                                                                                             feasible-path uRPF method works. The feasible-path uRPF only works in this scenario if
                                                                                             customer routes are preferred at AS2 and AS3 over a shorter non-customer route.




                                                                                                                 Figure 10: Scenario 2 for illustration of efficacy of uRPF schemes

                                                                                             However, the feasible-path uRPF method has limitations as well. One form of limitation
                                                                                             naturally occurs when the recommendation of propagating the same prefixes (or combined
                                                                                             address space) to all routers is not heeded. Another form of limitation can be described as
                                                                                             follows: in Scenario 2 (illustrated in Figure 10), it is possible that the second transit provider
                                                                                             AS3 (ISP-b) does not propagate the prepended route (i.e., P1 [AS1 AS1 AS1]) to the first transit
                                                                                             provider AS2 (ISP-a). This is because ISP-b's decision policy permits giving priority to a shorter
                                                                                             route to prefix P1 via ISP-a over a longer route learned directly from the customer (AS1). In such
                                                                                             a scenario, AS3 (ISP-b) would not send any route announcement for prefix P1 to AS2 (ISP-a).
                                                                                             Then, a data packet originated from AS1 with a source address in prefix P1 that traverses via


                                                                                                                                                29
