                                                                                              NIST SP 800-77 REV. 1                                                         GUIDE TO IPSEC VPNS


                                                                                                         }
                                                                                                     }

                                                                                                     The EAP-TLS configuration is configured in strongswan.conf by editing the libtls{} and
                                                                                                     plugins{} section:
                                                                                                     # /usr/local/etc/strongswan.conf

                                                                                                             plugins {
                                                                                                                  eap-radius {
                                                                                                                     secret = XXXXXXXXX
                                                                                                                     server = 10.10.10.10
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                                                }
                                                                                                             }

                                                                                                     libtls {
                                                                                                          suites = TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,
                                                                                                                        TLS_DHE_RSA_WITH_AES_256_GCM_SHA384
                                                                                                     }

                                                                                                 5. Ensure that the VPN service is started. To ensure that the strongSwan IKE daemon is
                                                                                                    started when booting the system, the file /etc/rc.conf is updated and the server is
                                                                                                    rebooted as a test.

                                                                                                 6. Create provisioning profiles for those IKEv2 clients that support it. Using
                                                                                                    provisioning profiles can save a significant amount of time for the administrator and
                                                                                                    make it easier on the users to configure their systems for IPsec. Unfortunately, not all
                                                                                                    common IKEv2 clients support this. The administrator uses the vendor enterprise tools
                                                                                                    from Apple, Microsoft, and others to generate profiles for easy installation.

                                                                                                 7. Update the firewall settings. The firewall settings need to be updated to allow the IKE,
                                                                                                    IPsec, and decrypted traffic to be inspected and then forwarded to the correct interfaces.
                                                                                                    The /etc/rc.conf file is updated to set firewall_enable=”YES”, and the file
                                                                                                    /etc/rc.firewall is updated to allow protocol 50, UDP port 500, and UDP and
                                                                                                    TCP port 4500.

                                                                                              9.2.3.2 Configuring the Clients

                                                                                              After completing the VPN gateway configuration, the administrator configures an externally
                                                                                              located test system to be an IPsec client. The steps performed to achieve this are as follows:

                                                                                                 1. If required, install IKEv2 software on the device. On most phones and laptops, an
                                                                                                    IKEv2-based IPsec client comes pre-installed. Because some people inside the company
                                                                                                    use Android-based phones, and they do not have native support for IKEv2, the
                                                                                                    strongSwan IKEv2 client is installed on them.

                                                                                                 2. Configure the IPsec clients. Each vendor’s IPsec client has its own type of
                                                                                                    configuration. Clients that support provisioning can usually install a profile configuration


                                                                                                                                             109
