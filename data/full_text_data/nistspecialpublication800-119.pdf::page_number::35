                                                                    GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


RFC 3531 proposes a method to manage the assignment of bits of an IPv6 address block or range. First,
the scheme defines parts of the IP address as p1, p2, p3, ….pN in order, so that an IP address is composed
of these parts contiguously. Boundaries between each part are based on the prefix assigned by the next
level authority. Part (p1) is the leftmost part probably assigned to a registry, Part (p2) can be allocated to
a large ISP or national registry. Part (p3) can be allocated to a large customer or a smaller provider, etc.
Each part can be of different length.

                        p1          p2            p3           p4         ….            pN
                                                 IPv6 addresses                        

The algorithm for allocating addresses is as follows: (p1) for the left-most part, assign addresses using the
leftmost bits first; (pN) for the rightmost part, assign addresses using the rightmost bits first; and for all
other parts (center parts), predefine an arbitrary boundary (prefix) and then assign addresses using center
bits of the part being assigned first.

This algorithm increases the assigned bits in such way that it keeps unassigned bits near the boundaries
between the parts. This means that the boundary between any two parts can be changed forward or
backward, later on, up to the assigned bits. See Table 3-3 for the assignment of leftmost, centermost, and
rightmost bits.




                    Table 3-3. Assignment of Leftmost, Centermost, and Rightmost Bits


         –       Leftmost                     –        Centermost                       –    Rightmost

Binary            Hex                Binary               Hex                  Binary           Hex

0000 0000         00                 0000 0000            00                   0000 0000        00

1000 0000         80                 0000 1000            08                   0000 0001        01

0100 0000         40                 0001 0000            10                   0000 0010        02

1100 0000         C0                 0001 1000            18                   0000 0011        03

0010 0000         20                 0000 0100            04                   0000 0100        04

1010 0000         A0                 0000 1100            0C                   0000 0101        05

0110 0000         60                 0001 0100            14                   0000 0110        06

1110 0000         E0                 0001 1100            1C                   0000 0111        07

0001 0000         10                 0010 0000            20                   0000 1000        08


A brief example based on RFC 3531 uses a provider called P1. This provider has been assigned the
3ffe:0b00/24 prefix and wants to assign prefixes to its connected networks. It expects in the foreseeable
future a maximum of 256 customers consuming 8 bits. One of these customers, named C2, expects a
maximum of 1024 customers’ assignments under it, consuming 10 other bits (see RFC 3531 for greater
detail). The assignment will be as follows, not showing the first 24 leftmost bits (3ffe:0b00/24 or 0011
1111 1111 1110 0000 1011):


                                                       3-13
