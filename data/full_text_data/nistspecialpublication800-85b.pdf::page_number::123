Special Publication 800-85B                                  PIV Data Model Testing Specification


11.1.1.2 Verify subject public key algorithm

Purpose                 Confirms that the public key algorithm used for generating the keys is
                        as specified in Table 3-5 of SP80078.
Reference(s)            1.    SP80078, Section 3.2.1
                        2.    AS07.01.03
                        3.    AS07.01.04
Precondition            1.    A valid PIV card is inserted into the contact reader.
                        2.    A valid PC/SC connection exists between the test application and
                              the contact reader.
                        3.    The test application is currently connected to the card application
                              which is accessible through card handle.
                        4.    A PIV authentication key and corresponding certificate are present
                              on the PIV card.
Test Steps              1. Set cardHandle := <<valid card handle>>
                        2. Set OID := <<PIV Authentication Certificate
                           (2.16.840.1.101.3.7.2.1.1)>>
                        3. Call pivGetData w/
                           • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                        4. Extract subjectPublicKeyInfo->algorithm->algorithm
                           field value
                        5. Match the algorithm value to the Table 3-5 of SP80078
                        6. If the algorithm is Elliptic Curve, ensure that one of
                           the approved curves is used and the OID is populated
                           in the subjectPublicKeyInfo->algorithm->parameters-
                           >namedCurve field from Table 3-6 of SP80078. The
                           parameters field may contain NULL to indicate that
                           parameters are inherited.

                        Note: - If the RSA algorithm is used, the
                        subjectPublicKeyInfo->algorithm->parameters field shall be
                        NULL

Expected Result(s)      The PIV authentication key is generated using the allowed asymmetric
                        key algorithm.


11.1.1.3 Verify public key size

Purpose                 Verifies that the key size requirements are adhered to based on the
                        expiration date of certificate.
Reference(s)            1.    SP80078, Section 3.1
                        2.    AS07.01.10




                                                                                               Page 115
