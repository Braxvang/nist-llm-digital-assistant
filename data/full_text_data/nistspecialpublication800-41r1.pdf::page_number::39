                                                                  GUIDELINES ON FIREWALLS AND FIREWALL POLICY


Most firewalls allow each rule in a ruleset to have a comment. Filling in such a comment is important for
others to determine why a rule was made. Comments are also quite useful to people auditing rulesets.
Although commenting rules may seem trivial, it can be quite valuable later and takes little effort. The rule
changes and the associated comments should be copied to the appropriate configuration management log.

At minimum, the following rules should be defined:

 Port filtering should be enabled at the outer edge of the network, and probably at places inside the
  network as well.
 Content filtering should be done as close to the content receiver as possible.
Many ways exist to define rules, and each organization will have its own needs and specific sets of
personnel who should be involved in ruleset configuration.

If multiple firewalls need to have the same rules or a common subset of rules, those rules should be
synchronized across the firewalls. This is usually done in a vendor-specific fashion. Note that it is likely
that some of the firewalls might have somewhat different policies, depending on their location in the
organization's network. For example, an organization might want to have just one of its firewalls acting as
the VPN gateway, although all the firewalls might have the same filtering rules for non-VPN traffic.
Therefore, it is important to only synchronize the rules that are common across the firewalls.

5.2.3   Logging and Alerts Configuration

The next step in the configuration process is to set up logging and alerts. Logging is a critical step in
preventing and recovering from failures as well as ensuring that proper security configurations are set on
the firewall. Proper logging can also provide vital information for responding to security incidents.
Whenever possible, the firewall should be configured both to store logs locally and to send them to a
centralized log management infrastructure. Resource constraints, firewall logging capabilities, and other
situations may impair the ability to store logs both locally and centrally.

Deciding what to log, and how long to keep logs, should be done on a case-by-case basis. For example,
some network administrators want to log all incoming accepted connections so that they can make sure
that they are not accepting unwanted traffic. Other administrators would not want to log accepted
incoming connections because they are so numerous or because the logging would consume too many
resources. Similarly, some administrators would not want to log all incoming traffic denied by the
firewall because the number of scans and probes by potentially malicious parties is very high and there is
no action to be taken in response to them; however, other administrators would want to know about scans
and probes in case they can detect a pattern that alerts them to a potential attack that can then be
prevented.

If the firewall supports having administrator accounts with different capabilities, create one or more
administrative user accounts with just read access to the logs, if possible. Use these credentials when
performing read-only tasks such as auditing and periodic inspection of the logs.

In addition to configuring logging, real-time alerts should also be set up to notify administrators when
important events occur on the firewall. Notifications may include the following:

 Any modifications or disabling of the firewall rules
 System reboots, disk shortages, and other operational events




                                                    5-5
