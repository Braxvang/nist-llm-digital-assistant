                                                             1. User-Client Interface
                          AS                                 2. Request for Ticket Granting Ticket
                        Realm1                               3. Ticket Granting Ticket for TGS1
                                                             4. Request for Ticket Granting Ticket
                                            TGS1
                              3                              5. Ticket Granting Ticket for TGS2
                    2                      Realm1            6. Request for Target Server Ticket
                                   4                         7. Target Server Ticket for TS
                                            5                8. Request for Service

                                            6        TGS2
                         Client                     Realm2
                        Realm1
                                                7
                1

                                                  TS
                                       8
                                                Realm2

              User




                                  Figure 6-2: Cross-Realm Authentication

In an alternative Kerberos protocol between the client and the AS (as specified in [RFC
4556]), either both the user and the AS have key-establishment public key pairs with
corresponding certificates, or the user has a key-establishment key pair and associated
certificate, and the AS has a digital signature key pair and digital signature certificate.
The user symmetric key can then be established between the client and the KDC in one of
two ways:
       1. Using key agreement (e.g., Diffie-Hellman) between the AS and the client26, or
       2. Using key transport (e.g., RSA), where the AS generates the user symmetric key,
          and sends the key to the client27.
Once the user symmetric key is established, the remainder of the protocol proceeds as
previously described. In this case, the need for user symmetric keys generated from
passwords can thus be avoided.

Kerberos implementations may provide an additional authentication capability that is
called pre-authentication, as described in [RFC 6113]. TLS may also be implemented to
protect all communication between the clients and KDCs as described in [RFC 6251].



26
     In this case, both the user and the AS have key-establishment key pairs.
27
     In this case, the user has a key-establishment key pair, and the AS has a digital-signature key pair.

                                                             38
