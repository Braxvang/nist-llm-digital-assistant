NIST SP 800-85A-4                                                                 PIV CARD APPLICATION & MIDDLEWARE
                                                                                           INTERFACE TEST GUIDELINES

                                       with '90 00' at the end. Compare the plaintext key to the one
                                       received in the response from the card.
                                    • For ECDH, (as indicated by algorithm reference '11' or '14' as
                                       P1 value), the command returns the shared secret Z 11 with '90
                                       00' at the end. Compare the shared secret computed by the
                                       card with the shared secret computed off card.
                                11. The command returns '6A 86' (incorrect parameter in P1 or P2).
                                12. The command returns '6A 80' (incorrect parameter in command
                                    data field).
                                13. The security state is reset.
                                14.
                                    • Repeated step 3: The command returns the signed challenge
                                       with '90 00' at the end. Verify the signed challenge.
                                    • Repeated step 7a: The command returns the signed data with
                                       '90 00' at the end. Verify the signature using the public key
                                       from the digital signature certificate and the hash sent to the
                                       card.
                                    • Repeated step 7b: The command returns '69 82' (security
                                       status not satisfied).
                                    • Repeated step 8: For algorithm reference '07' as P1 value, the
                                       command returns the transported key with '90 00' at the end.
                                       Compare the plaintext key to the one received in the response
                                       from the card. For algorithm reference '11' or '14' as P1 value,
                                       the command returns the shared secret Z 12 with '90 00' at the
                                       end. Compare the shared secret computed by the card with
                                       the shared secret computed off card.
                                    • Repeated step 9: The command returns the signed challenge
                                       with '90 00' at the end. Verify the signed challenge.
                                    • Repeated step 10: The GET DATA commands return the
                                       requested data along with '90 00'. Each GENERAL
                                       AUTHENTICATE command returns either 1) the transported
                                       key with '90 00' at the end or 2) the shared secret Z with '90 00'
                                       at the end.
                                            o For key transport (as indicated by algorithm reference
                                               '06' or '07' as P1 value), the command returns the
                                               transported key with '90 00' at the end. Compare the
                                               plaintext key to the one received in the response from
                                               the card.
                                            o For ECDH, (as indicated by algorithm reference '11' or
                                               '14' as P1 value), the command returns the shared


11
     Z is the X coordinate of point P as defined in SP 800-56A, Section 5.7.1.2
12
     Z is the X coordinate of point P as defined in SP 800-56A, Section 5.7.1.2


                                                      C-35
