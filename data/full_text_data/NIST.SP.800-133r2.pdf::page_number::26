                                                                                               NIST SP 800-133 REV. 2                                                                      RECOMMENDATION FOR
                                                                                                                                                                                   CRYPTOGRAPHIC KEY GENERATION

                                                                                                             b. Key expansion to derive keying material from 1) the key-derivation key produced
                                                                                                                during randomness extraction and 2) other information, as specified in SP 800-
                                                                                                                56C 24 and SP 800-108.

                                                                                               6.2.1 Symmetric Keys Generated Using Key-Agreement Schemes
                                                                                               When an approved key-agreement scheme is available within an entity’s key-generating module,
                                                                                               a symmetric key may be established with another entity that has the same capability. This process
                                                                                               results in a symmetric key that is shared between the two entities participating in the key-
                                                                                               agreement transaction.
                                                                                               SP 800-56A and SP 800-56B provide several methods for pairwise key agreement. Asymmetric
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-133r2




                                                                                               key-agreement keys are used with a key-agreement primitive algorithm to generate a shared secret.
                                                                                               The shared secret is provided to a key-derivation method to derive keying material. SP 800-56C
                                                                                               specifies approved key-derivation methods for the key-agreement schemes in SP 800-56A and
                                                                                               SP 800-56B.
                                                                                               The maximum security strength that can be supported by a key derived in this manner is dependent
                                                                                               on: 1) the security strength supported by the asymmetric key pairs (as used during key
                                                                                               establishment), 2) the key-derivation method used, 3) the length of the derived key, and 4) the
                                                                                               algorithm with which the derived key will be used. See SP 800-57, Part 1.

                                                                                               6.2.2 Symmetric Keys Derived from a Pre-existing Key
                                                                                               Symmetric keys are often derived using a key-derivation function (KDF) and a preexisting key
                                                                                               known as a key-derivation key. For example, the preexisting key may have been:
                                                                                                    •    Generated from an approved RBG (see Section 4) and distributed as specified in Section
                                                                                                         6.4;
                                                                                                    •    Agreed upon using a key-agreement scheme (see Section 6.2.1);
                                                                                                    •    Derived using a KDF and a (different) preexisting key as specified in SP 800-108; or
                                                                                                    •    An approved function of multiple cryptographic keys (and, perhaps, other data) as
                                                                                                         described in Section 6.3.
                                                                                               Approved methods for key derivation are provided in SP 800-108, which specifies approved
                                                                                               KDFs for deriving keys from a pre-shared (i.e., preexisting) key-derivation key. The KDFs are
                                                                                               based on HMAC (as specified in FIPS 198) and CMAC (as specified in SP 800-38B).
                                                                                               If the derived keys need to be distributed to other entities, this may be accomplished as discussed
                                                                                               in Section 6.4.
                                                                                               In addition to the symmetric-key algorithm with which a derived key will be used, the security
                                                                                               strength that can be supported by the derived key depends on the security strength supported by
                                                                                               the key-derivation key and the KDF used (see SP 800-57, Part 1 for the maximum security strength



                                                                                               24 When the two-step key-derivation method is used by a key-establishment scheme.




                                                                                                                                                           20
