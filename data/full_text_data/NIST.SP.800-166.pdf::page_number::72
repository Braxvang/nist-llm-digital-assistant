NIST SP 800-166                                                   DERIVED PIV APPLICATION AND
                                                                  DATA MODEL TEST GUIDELINES

                         order to prevent the retry counter from decrementing to
                         zero.
 Expected Result(s)      1. From Step 1, the command returns the application property
                            template with the status word '90 00'.
                         2. From Step 2, the command returns status word '6A 80' (incorrect
                            parameter in command data field) or '63 CX' (verification failed,
                            with X indicating the number of further allowed retries). Verify
                            the error code supplied matches what is described in the
                            vendor’s documentation.
                         3. From Step 3, all commands return status word '6A 80' (incorrect
                            parameter command data field) or '63 CX' (verification failed,
                            with X indicating the number of further allowed retries). Verify
                            the error code supplied matches what is described in the
                            vendor’s documentation.
 Postcondition(s)        N/A

8.3.4.5 Verify with an Incorrect Password/Blocking the Derived PIV Application

 Test Assertion          TA-08.03.04.06
 Purpose                 Verifies that the Derived PIV Application is blocked based on the
                         retry counter when a correctly formatted, but incorrect password is
                         sent repeatedly using the VERIFY command.
 DTR(s)                  • DTR-06.02.02.09
                         • DTR-06.03.01.01
                         • DTR-06.03.05.02
                         • DTR-06.03.05.03
                         • DTR-06.03.05.04
 Vendor Documentation    None.
 Precondition(s)         • A token with the Derived PIV Application is inserted into an
                             appropriate token reader.
                         • Suitable drivers have been loaded between the test system and
                             an instance of the reader.
                         • The Derived PIV Application Password is recorded.
                         • The Derived PIV Application Password’s retry counter is not 0.
 Test Scenario           1. Send the SELECT command with
                               • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                         2. Send the VERIFY command repeatedly, until after the
                            issuer specified maximum number of password tries is
                            exceeded with
                               • P2, key reference value, is set to '80'
                               • Data field of the command will contain an
                                  arbitrary, but correctly formatted, password
                                  value other than what is obtained from the
                                  vendor, padded with 'FF' (if necessary) to
                                  complete the total length of the value to 8
                                  bytes




                                           65
