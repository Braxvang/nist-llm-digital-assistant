Appendix A: Example of a Formatting and Counter Generation Function

In this appendix, a formatting function for the input data and a counter generation function are
specified that together satisfy the requirements of Section 5.4. With these functions, this
specification of CCM is essentially equivalent to the specification of CCM in the draft
amendment [4] to the IEEE Standard 802.11 for wireless local area networks [5].

The requirements that this particular formatting function imposes on the lengths of the variables
in CCM are given in Section A.1; the formatting of the input data is specified in Section A.2; the
counter generation function is specified in Section A.3.

A.1    Length Requirements

The bit length of each input string, i.e., N, A, and P, shall be a multiple of 8 bits, i.e., each input
string shall be an octet string. The octet lengths of these strings are denoted n, a, and p; thus, n, a
and p are integers. Similarly, the parameter t denotes the octet length of T. The octet length of P
(i.e., the integer p) is represented within the first block of the formatted data as an octet string
denoted Q. The octet length of Q, denoted q, is a parameter of the formatting function. Thus, Q is
equivalent to [p]8q, the binary representation of p in q octets. For example, if q = 3 and P is a
string that consists of 4096 bits, i.e., p = 512, then Q is the string 00000000 00000010 00000000.

The formatting in this appendix imposes the following length conditions:

       •   t is an element of {4, 6, 8, 10, 12, 14, 16};
       •   q is an element of {2, 3, 4, 5, 6, 7, 8};
       •   n is an element of {7, 8, 9, 10, 11, 12, 13}
       •   n+q=15;
       •   a<264.

The parameter q determines the maximum length of the payload: by definition, p<28q, so P
consists of fewer than 28q octets, i.e., fewer than 28q-4 128-bit blocks. The fourth condition
implies that a choice for q determines the value of n, namely, n=15-q. (Equivalently, the nonce
length, n, may be considered as the parameter of the formatting function that determines the
value of q.) The value of n, in turn, determines the maximum number of distinct nonces, namely,
28n. Thus, the fourth condition amounts to a tradeoff between the maximum number of
invocations of CCM under a given key and the maximum payload length for those invocations.


A.2    Formatting of the Input Data

The formatting of the input data (N, A, P) into a sequence of blocks B0, B1, …, Br is presented in
                                                                          B   B       B




the following three sections: in Section A.2.1, the formatting of the nonce and control
information such as length indicators is specified; in Section A.2.2, the formatting of A is
specified; in Section A.2.3, the formatting of P is specified.




                                                  12
