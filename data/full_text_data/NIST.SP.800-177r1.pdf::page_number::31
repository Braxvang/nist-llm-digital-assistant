                                                                                               NIST SP 800-177 REV. 1                                                           TRUSTWORTHY EMAIL




                                                                                               3.1.5   DNS Cache Poisoning

                                                                                               Email systems rely on DNS for many functions. Some of them are:

                                                                                                  •    �e sending MTA uses the DNS to ﬁnd the IP address of the next-hop email server
                                                                                                       (assuming the To: address is not a local mailbox).
                                                                                                  •    �e recipient email server (if domain-based email authentication is supported) uses the
                                                                                                       DNS to look for appropriate records in the sending DNS domain either to authenticate the
                                                                                                       sending email server (using SPF) or to authenticate an email message for its origin
                                                                                                       domain (using DKIM). See Section 5 for domain-based authentication mechanisms.

                                                                                               �ere are risks to using the DNS as a publication mechanism for authenticating email. First,
                                                                                               those highly motivated to conduct phishing/spam campaigns, may attempt to spoof a given
                                                                                               domain’s DNS-based email authentication mechanisms in order to continue to deliver spoofed
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-177r1




                                                                                               email masquerading as the domain in question. �e second risk is that an attacker would spoof a
                                                                                               domain’s DNS-based authentication mechanisms in order to disrupt legitimate email from the
                                                                                               source domain. For example, maliciously spooﬁng the SPF record of authorized mail relays, to
                                                                                               exclude the domains legitimate MTAs, could result in all legitimate email from the target domain
                                                                                               being dropped by other MTAs. Lastly, a resolver whose cache has been poisoned can potentially
                                                                                               return the IP address desired by an attacker, rather than the legitimate IP address of a queried
                                                                                               domain name. In theory, this allows email messages to be redirected or intercepted.

                                                                                               Another impact of a DNS server with a poisoned cache as well as a compromised web server is
                                                                                               that the users are redirected to a malicious server/address when attempting to visit a legitimate
                                                                                               web site. Although the visit to an illegitimate web site can occur by clicking on a link in a
                                                                                               received email, this use case has no direct relevance to integrity of an email service and hence is
                                                                                               outside the scope of this document.

                                                                                               As far as DNS cache poisoning is concerned, DNSSEC security extension [RFC4033]
                                                                                               [RFC4034] [RFC4035] can provide protection from these kinds of attacks since it ensures the
                                                                                               integrity of DNS resolution through an authentication chain from the root to the target domain of
                                                                                               the original DNS query. However, even the presence of a single non-DNSSEC aware server in
                                                                                               the chain can lead to a risk of compromise of the integrity of the DNS resolution.

                                                                                               3.1.6   Phishing and Spear Phishing

                                                                                               Phishing is the process of using a spoofed email to collect private information, distribute
                                                                                               malware, or commit fraud. �is is done with the intention of committing identity theft, gaining
                                                                                               access to credit cards and bank accounts of the victim etc. Adversaries use a variety of tactics to
                                                                                               make the recipient of the email believe that they have received the phishing email from a
                                                                                               legitimate user or a legitimate domain, including:

                                                                                                  •    Using a message-From: address that looks very close to one of the legitimate addresses
                                                                                                       the user is familiar with or from someone claiming to be an authority (IT administrator,
                                                                                                       manager, etc.). Or altering the display name (also known as the friendly name).


                                                                                                                                                18
