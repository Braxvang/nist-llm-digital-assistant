NIST SP 800-58                                              Voice Over IP Security
_____________________________________________________________________________

 6.1.2    System Architecture

         Within MGCP the MGC server or “call agent” is mandatory and manages calls
         and conferences, and supports the services provided (see Figure 7). The MG
         endpoint is unaware of the calls and conferences and does not maintain call states.
         MGs are expected to execute commands sent by the MGC call agents. MGCP
         assumes that call agents will synchronize with each other sending coherent
         commands to MGs under their control. MGCP does not define a mechanism for
         synchronizing call agents. MGCP is a master/slave protocol with a tight coupling
         between the MG (endpoint) and MGC (server).
                                        Media Gateway Controller
                                           MGC (Call Agent)


                                                             H.323 / SIP
                                                                                     LAN

                                                                                           Client

                                                MGCP
                                                                            RTP

                       Media                                               Media
                       Gateway                                             Gateway
                                       IP                          IP


                                                       PSTN


                                    Figure 7: General Scenario for MGCP Usage


         RTP data is exchanged directly between the involved media gateways. The Call
         Agent uses MGCP to provide the gateways with the description of connection
         parameters such as IP addresses, UDP port and RTP profiles. These descriptions
         follow the conventions delineated in the Session Description Protocol (SDP) from
         RFC 2327. SDP is a session description protocol for multimedia sessions, which
         runs also on UDP connections.

 6.1.3    Security Considerations

         There are no security mechanisms designed into the MGCP protocol itself. The
         informational RFC 2705 refers to the use of IPsec (either AH or ESP) to protect
         MGCP messages. Without this protection a potential attacker could set up
         unauthorized calls or interfere with ongoing authorized calls. Beside the use of
         IPsec, MGCP allows the call agent to provide gateways with session keys that can
         be used to encrypt the audio messages, protecting against eavesdropping. The
         session key will be used later on in RTP encryption. The RTP encryption,
         described in RFC 1889, may be applied. Session keys may be transferred between
         the call agent and the gateway by using the SDP (cf. RFC 2327).




48
