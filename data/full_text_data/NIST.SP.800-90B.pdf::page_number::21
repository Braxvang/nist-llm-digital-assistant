                                                                                             NIST SP 800-90B                                          RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                              USED FOR RANDOM BIT GENERATION

                                                                                                -   The knowledge of other restart sequences does not offer additional advantage in predicting
                                                                                                    the next restart sequence.

                                                                                             3.1.4.1 Constructing Restart Data

                                                                                             To construct restart data, the entropy source shall be restarted r = 1000 times; for each restart, c =
                                                                                             1000 consecutive samples shall be collected directly from the noise source. The collection of the
                                                                                             data shall be done as soon as the entropy source is ready to produce outputs for real-world use
                                                                                             (e.g., after start-up tests). Note that an entropy source, in its real-world use and during restart
                                                                                             testing, may inhibit outputs for a time immediately after restarting in order to allow any transient
                                                                                             weak behavior to pass. The output samples are stored in an r by c matrix M, where M[i][j]
                                                                                             represents the jth sample from the ith restart.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                             Two datasets are constructed using the matrix M:

                                                                                                -   The row dataset is constructed by concatenating the rows of the matrix M, i.e., the row
                                                                                                    dataset is M[1][1] ||…|| M[1][c] || M[2][1] ||…|| M[2][c] || … || M[r][1] ||…|| M[r][c].
                                                                                                -   The column dataset is constructed by concatenating the columns of the matrix M, i.e., the
                                                                                                    column dataset is M[1][1] ||…|| M[r][1] || M[1][2] ||…|| M[r][2] || …|| M[1][c] ||…|| M[r][c].

                                                                                             3.1.4.2 Validation Testing

                                                                                             The restart tests check the relations between noise source samples generated after restarting the
                                                                                             entropy source, and compare the results to the initial entropy estimate, HI (see Section 3.1.3).

                                                                                             First, the sanity check described in Section 3.1.4.3 is performed on the matrix M. If the test fails,
                                                                                             the validation fails and no entropy estimate is awarded.
                                                                                             If the noise source does not fail the sanity check, then the entropy estimation methods described
                                                                                             in Section 6.1 (for the IID track) or Section 6.2 (for the non-IID track) are performed on the row
                                                                                             and the column datasets, based on the track of the entropy source. Let Hr and Hc be the resulting
                                                                                             entropy estimates of the row and the column datasets, respectively. The entropy estimates from
                                                                                             the row and the column datasets are expected to be close to the initial entropy estimate HI. If the
                                                                                             minimum of Hr and Hc is less than half of HI, the validation fails, and no entropy estimate is
                                                                                             awarded. Otherwise, the entropy assessment of the noise source is taken as the minimum of the
                                                                                             row, the column and the initial estimates, i.e., min(Hr, Hc, HI).
                                                                                             If the noise source does not fail the restart tests, and the entropy source does not include a
                                                                                             conditioning component, the entropy source will be validated at H=min(Hr, Hc, HI). If the entropy
                                                                                             source includes a conditioning component, the entropy assessment of the entropy source is updated
                                                                                             as described in Section 3.1.5.

                                                                                             3.1.4.3 Sanity Check - Most Common Value in the Rows and Columns

                                                                                             This test checks the frequency of the most common value in the rows and the columns of the matrix
                                                                                             M. If this frequency is significantly greater than the expected value, given the initial entropy
                                                                                             estimate HI calculated in Section 3.1.3, the restart test fails. In this case, the validation fails no
                                                                                             entropy estimate is awarded.


                                                                                                                                              13
