NIST SP 800-85A-4                                             PIV CARD APPLICATION & MIDDLEWARE
                                                                       INTERFACE TEST GUIDELINES

   (d) If the PIV Card Application returns status word '6A 80', then the retry counter associated
       with the PIN is not reset, the security status of the PIN’s key reference remains unchanged,
       and the PUK’s retry counter remains unchanged.

AS05.33A: Moved requirement into AS05.29.

A.5.2.4     GENERAL AUTHENTICATE Card Command

AS05.34: The GENERAL AUTHENTICATE card command performs a cryptographic
operation, such as an authentication protocol, using the data provided in the data field of the
command and returns the result of the cryptographic operation in the response data field.
   1) The GENERAL AUTHENTICATE command shall be used with the PIV
      authentication keys ('9A', '9B', '9E') to authenticate the card or a card application to
      the client application (INTERNAL AUTHENTICATE), to authenticate an entity to the
      card (EXTERNAL AUTHENTICATE), and to perform a mutual authentication
      between the card and an entity external to the card (MUTUAL AUTHENTICATE).
   2) The GENERAL AUTHENTICATE command shall be used with the digital signature
      key ('9C') to realize the signing functionality on the PIV client application
      programming interface. Data to be signed is expected to be hashed off card.
   3) The GENERAL AUTHENTICATE command shall be used with the key management
      key ('9D') and the retired key management keys ('82' – '95') to realize key
      establishment primitives specified in SP 800-78-4 (ECDH and RSA).
   4) The GENERAL AUTHENTICATE command shall be used with the PIV Secure
      Messaging key ('04') and cryptographic algorithm identifier '27' or '2E' to establish
      session keys for secure messaging as specified in Section 4 of SP 800-73-4, Part 2. If key
      reference '04' is specified in P2 then algorithm identifiers in P1 other than '27' and '2E'
      shall not be permitted and the PIV Card Application shall return the status word '6A
      86'.
Required Vendor Information

VE05.34.01: The vendor shall specify in its documentation the types of cryptographic operations
(authentication, key establishment primitives, signing primitives, and secure messaging) supported
by the card.

Required Test Procedures

TE05.34.01: The tester shall validate that the GENERAL AUTHENTICATE command is
implemented to authenticate the card to the client application (Pertains to AS05.34-(1)).

TE05.34.02: The tester shall validate that the GENERAL AUTHENTICATE command is
implemented to authenticate the client application to the card (Pertains to AS05.34-(1)).




                                          A-33
