NIST SP 800-85A-4                                 PIV CARD APPLICATION & MIDDLEWARE
                                                           INTERFACE TEST GUIDELINES

                         •   If keysWithOnCardCerts > 0 and keyWithOffCardCerts >
                             0
                                 o  For each key reference value in the range
                                    0x82 through (0x82 + keysWithOnCardCerts – 1)
                                    and in the range (0x95 – keysWithOffCardCerts
                                    + 1) through 0x95, verify that the provided
                                    URL file includes that key reference, issue a
                                    challenge for that key reference, and verify
                                    the response using the public key from the
                                    corresponding certificate from the provided
                                    URL file
                    11. Repeat step 3 with an invalid value of algorithm
                        reference (P1) and/or key reference (P2)
                    12. Repeat step 3 with an invalid value in data field
                        (improper challenge length for the chosen algorithm)
                    13. Reset the security status indicator of the PIV Card
                        Application PIN by performing VERIFY with a wrong PIN
                    14. If the application property template obtained in step 1
                        indicates that the Global PIN satisfies the PIV ACRs for
                        command execution and data access, then perform step 2)
                        of 2b in C.2.1.1 to verify cardholder’s Global PIN and
                        repeat steps 3, 7-10, and 13 (but performing the VERIFY
                        using the Global PIN in steps 7a and 13).
                    15. If the application property template obtained in step 1
                        indicates that OCC satisfies the PIV ACRs for command
                        execution and data access, then
                       • Perform step 1) of 2c in C.2.1.1 to verify cardholder’s
                          OCC and repeat steps 3, 7-10, and 13 (but performing
                          the VERIFY using key reference '96' in steps 7a and
                          13).
                       • Perform step 4) of 2c in C.2.1.1 to verify cardholder’s
                          OCC and repeat steps 3, 7-10, and 13 (but performing
                          the VERIFY using key reference '97' in steps 7a and
                          13).
                    16. Repeat steps 3, 7b, 8, and 9
                    17. Repeat steps 4, 6, and 10, if the key types specified in
                        the tests are supported
                    18. Send GENERAL AUTHENTICATE card command
                       • P1, algorithm reference, is set to '27' or '2E', as
                          indicated by the 0xAC tag obtained from the application
                          property template in step 1
                       • P2, key reference, is set to '9A' indicating the PIV
                          Authentication key
                    19. Repeat step 18 with P2, key reference, values of '00',
                        '80', '81', '98', '9B', '9C', '9D', '9E', and all retired
                        key management keys
                    20. Send GENERAL AUTHENTICATE card command
                       • P1, algorithm reference, is set to '11' or '14'
                       • P2, key reference, is set to '04' indicating the PIV
                          Secure Messaging key
                    NOTE: The following test invocation (step 21) is only
                          performed if the PIV Card Application supports the use
                          of the '04' key
                    21. Send GENERAL AUTHENTICATE card command




                                  C-33
