  NIST SP 800-58                                             Voice Over IP Security
      _________________________________________________________________________


Bob                                 TCP connection established                           Alice
                                              Call SETUP
                                              ALERTING                                         Q.931
                                CONNECT H.245 address/port specified




                                  TCP connection established
                                           H.245 messages
                           Open logical channel (RTCP addr/port specified)

                      Open logical channel ACK(RTCP & RTP addr/port)                           H.245
                         Open logical channel (RTCP addr/port specified)

                       Open logical channel ACK(RTCP & RTP addr/port)



                                           RTP Stream

                                           RTP Stream                                          RTP
                                          RTCP Instructions



                                  Figure 4. H.323 Call Setup Process


        Generally, there are different types of H.323 calls defined in the H.323 standard:
        − Gatekeeper routed call with gatekeeper routed H.245 signaling
        − Gatekeeper routed call with direct H.245 signaling
        − Direct routed call with gatekeeper
        − Direct routed call without gatekeeper

        An H.323 VOIP session is initiated (depending on the call model used) by either a
        TCP or a UDP (if RAS is the starting point) connection with an H.225 signal. In
        the case of UDP this signal contains the Registration Admission Status (RAS)
        protocol that negotiates with the gatekeeper and obtains the address of the
        endpoint it is attempting to contact. Then a “Q.931-like” protocol (still within the
        realm of H.225) is used to establish the call itself and negotiate the addressing
        information for the H.245 signal. (This is done via TCP; Q.931 actually
        encapsulates the H.225 Call Signaling messages.) This “setup next” procedure is


                                                                                          27
