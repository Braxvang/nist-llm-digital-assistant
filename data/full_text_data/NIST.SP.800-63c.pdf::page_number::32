                                                                                             NIST SP 800-63C                                                            DIGITAL IDENTITY GUIDELINES:
                                                                                                                                                                          FEDERATION & ASSERTIONS

                                                                                             across these RPs. Such multi-RP use is not recommended. Instead, RPs are encouraged to fetch
                                                                                             their own individual assertions.

                                                                                             The RP SHALL protect itself against injection of manufactured or captured assertions by use of
                                                                                             cross-site scripting protection or other accepted techniques.

                                                                                             Elements within the assertion SHALL be validated by the RP including:

                                                                                                   •    Issuer verification: ensuring the assertion was issued by the expected IdP.
                                                                                                   •    Signature validation: ensuring the signature of the assertion corresponds to the key
                                                                                                        related to the IdP making the assertion.
                                                                                                   •    Time validation: ensuring the expiration and issue times are within acceptable limits of
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-63c




                                                                                                        the current timestamp.
                                                                                                   •    Audience restriction: ensuring this RP is the intended recipient of the assertion.

                                                                                             Conveyance of the assertion from the IdP to the subscriber, as well as from the subscriber to the
                                                                                             RP, SHALL be made over an authenticated protected channel.

                                                                                             Note that in a federation proxy described in Section 5.1.4, the IdP audience restricts the assertion
                                                                                             to the proxy, and the proxy restricts any newly-created assertions to the downstream RP.

                                                                                             7.3       Protecting Information

                                                                                             Communications between the IdP and the RP SHALL be protected in transit using an
                                                                                             authenticated protected channel. Communications between the subscriber and either the IdP or
                                                                                             the RP (usually through a browser) SHALL be made using an authenticated protected channel.

                                                                                             Note that the IdP may have access to information that may be useful to the RP in enforcing
                                                                                             security policies, such as device identity, location, system health checks, and configuration
                                                                                             management. If so, it may be a good idea to pass this information along to the RP within the
                                                                                             bounds of the subscriber’s privacy preferences described in Section 9.2.

                                                                                             Additional attributes about the user MAY be included outside of the assertion itself as part of a
                                                                                             separate authorized request from the RP to the IdP. The authorization for access to these
                                                                                             attributes MAY be issued alongside the assertion itself. Splitting user information in this manner
                                                                                             can aid in protecting user privacy and allow for limited disclosure of identifying attributes on top
                                                                                             of the essential information in the authentication assertion itself.

                                                                                             The RP SHALL, where feasible, request attribute references rather than full attribute values as
                                                                                             described in Section 9.3. The IdP SHALL support attribute references.




                                                                                                                                                23
