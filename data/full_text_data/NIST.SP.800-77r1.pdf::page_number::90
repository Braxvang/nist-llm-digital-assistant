                                                                                              NIST SP 800-77 REV. 1                                                          GUIDE TO IPSEC VPNS


                                                                                              clients on unreliable networks not receiving the DPD probes. The server will disconnect the IKE
                                                                                              client when a response to the probe is not returned. That client will experience packet loss and
                                                                                              declare the IPsec connection dead. This will lead to the creation of another new IKE session and
                                                                                              an increased load on the VPN server. In general, keeping a few IKE and IPsec states alive for
                                                                                              vanished VPN clients takes very little memory and no CPU resources. A reasonable DPD
                                                                                              timeout value is in the range of 10 to 60 minutes.

                                                                                              The IKE SA and IPsec SA lifetimes are not negotiated. Each endpoint decides when it wants to
                                                                                              rekey or expire an existing SA. Using longer IKE SA and IPsec SA lifetimes can reduce the
                                                                                              amount of IKE rekeying required. IKE rekeying and IPsec rekeying with PFS require a new DH
                                                                                              calculation as well, so extending the IKE and IPsec lifetimes can help reduce the server load.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                              Increased lifetimes must not result in keys encrypting too much data. The upper limit on the
                                                                                              amount of data that can be safely encrypted depends on the specific encryption algorithm used.

                                                                                              Another option on busy servers with many remote access users is to support IKE session
                                                                                              resumption [66]. A mobile device that is going to sleep can send the server a sleep notification to
                                                                                              prevent DPD-based disconnections. The server and client keep the cryptographic state of the IKE
                                                                                              session. When the device wakes up, it can send an encrypted session resumption request. This
                                                                                              avoids the need for a new IKE session with the expensive DH calculation to establish a new
                                                                                              connection; the server is triggered via a DPD timeout to delete the IKE and IPsec SA if the sleep
                                                                                              period exceeds the timeout period.

                                                                                              If a provisioning system is used to generate and install configurations for the IKE clients,
                                                                                              optimized settings could be pushed automatically to all IKE clients to ensure optimal
                                                                                              performance. This would avoid manual configurations that, when performed by inexperienced
                                                                                              users, could result in less optimized settings because the user did not enable or disable certain
                                                                                              features.

                                                                                              Enabling IKE debugging can cause a lot of data to be logged. That in itself can cause a
                                                                                              significant performance impact on the system. Always check to see if debugging has accidentally
                                                                                              been left enabled on systems experiencing a high workload.

                                                                                              7.2.4.3 IKE DDoS attack considerations

                                                                                              DDoS attacks are a separate issue of concern. Such attacks also put an additional load on the
                                                                                              server, but the characteristics are different from a legitimate user load.

                                                                                              An attack from an authenticated user with valid credentials is assumed to be a readily solvable
                                                                                              problem—simply revoke the user’s access to the VPN infrastructure. One exception to this is
                                                                                              when anonymous IPsec is in use because in that case, the connection cannot be terminated or
                                                                                              prevented based on the user credentials. Vendors of IPsec equipment supporting anonymous
                                                                                              IPsec connections should take countermeasures by, for example, limiting the number of IPsec
                                                                                              SA requests that are accepted or by limiting the number of rekeys or anonymous connections
                                                                                              allowed based on an IP address.




                                                                                                                                              73
