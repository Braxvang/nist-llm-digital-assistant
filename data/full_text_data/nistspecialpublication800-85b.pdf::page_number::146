Special Publication 800-85B                                   PIV Data Model Testing Specification

11.4.2.2 Verify id-fpki-common-cardAuth OID

Purpose                 Confirms that the card authentication certificate asserts the id-fpki-
                        common-cardAuth OID.
Reference(s)            1.    AS07.04.06
Precondition            1.    A valid PIV card is inserted into the contact reader.
                        2.    A valid PC/SC connection exists between the test application and
                              the contact reader.
                        3.    The test application is currently connected to the card application
                              which is accessible through card handle.
                        4.    A PIV authentication key and corresponding certificate are present
                              on the PIV card.
Test Steps              1. Set cardHandle := <<valid card handle>>
                        2. Set OID := <<Card Authentication Certificate
                           (2.16.840.1.101.3.7.2.5.0)>>
                        3. Call pivGetData w/
                           • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data

                        4.    Extract certificatePolicies->policyIdentifier
                              extension field values from the certificate
Expected Result(s)      A policyIdentifier field in the certificatePolicies extension asserts id-
                        fpki-common-cardAuth.


11.4.2.3 Verify extended key usage extension

Purpose                 Confirms that the card authentication certificate asserts the appropriate
                        purpose of the key in the extended key usage extension.
Reference(s)            1.    FIPS201, Section 5.4.2.1
                        2.    AS07.04.07
Precondition            1.    A valid PIV card is inserted into the contact reader.
                        2.    A valid PC/SC connection exists between the test application and
                              the contact reader.
                        3.    The test application is currently connected to the card application
                              which is accessible through card handle.
                        4.    A card authentication key and corresponding certificate are present
                              on the PIV card.
Test Steps              1. Set cardHandle := <<valid card handle>>
                        2. Set OID := <<Card Authentication Certificate
                           (2.16.840.1.101.3.7.2.5.0)>>
                        3. Call pivGetData w/
                           • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data

                        4.    Extract all KeyPurposeId fields from the extended key
                              usage extension from the certificate



                                                                                                     Page 138
