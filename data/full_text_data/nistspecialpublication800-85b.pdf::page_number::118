Special Publication 800-85B                                   PIV Data Model Testing Specification


Reference(s)          1.      AS06.04.06
                      2.      AS06.04.07
Precondition          1.      A valid PIV card is inserted into the contact reader.
                      2.      A valid PC/SC connection exists between the test application and the
                              contact reader.
                      3.      The test application is currently connected to the card application
                              which is accessible through card handle.
                      4.      A valid security object is present on the PIV card.
Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<Security Object
                         (2.16.840.1.101.3.7.2.144.0)>>
                      3. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      4. Extract and parse the encapContentInfo field contents
                         from the security object
Expected              The eContent field contains a correctly formatted ldsSecurityobject and
Result(s)             the eContentType asserts id-icao-ldsSecurityObject in encapContentInfo.


10.4.2.5 Verify certificates field omission

Purpose               Confirm that the certificates field from the SignedData content type is
                      omitted.
Reference(s)          1.      AS06.04.08
Precondition          1.      A valid PIV card is inserted into the contact reader.
                      2.      A valid PC/SC connection exists between the test application and the
                              contact reader.
                      3.      The test application is currently connected to the card application
                              which is accessible through card handle.
                      4.      A valid security object is present on the PIV card..
Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<Security Object
                         (2.16.840.1.101.3.7.2.144.0)>>
                      3. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      4. Extract the certificates field contents from the
                         security object
Expected              The certificates field is omitted from the SignedData.
Result(s)




                                                                                                Page 110
