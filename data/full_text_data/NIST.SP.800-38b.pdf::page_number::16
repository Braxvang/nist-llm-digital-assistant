                                                                                             NIST SP 800-38B                                                                 BLOCK CIPHER MODES:
                                                                                                                                                                     CMAC MODE FOR AUTHENTICATION



                                                                                             Appendix A: Length of the MAC

                                                                                             The length, Tlen, of the MAC is an important security parameter. The role of this parameter in
                                                                                             resisting guessing attacks is outlined in Sec. A.1, and guidance in the selection of Tlen is given in
                                                                                             Sec. A.2.

                                                                                             A.1       Assurance Against Guessing Attacks

                                                                                             The verification process determines whether the purported MAC on a message is the valid output
                                                                                             of the MAC generation process applied to the message. The output of the MAC verification
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-38B




                                                                                             determines the assurance that the receiver of the message obtains:

                                                                                                   •   If the output is INVALID, then the message is definitely not authentic, i.e., it did not
                                                                                                       originate from a source that executed the generation process on the message to produce the
                                                                                                       purported MAC.

                                                                                                   •   If the output is VALID, then the design of the mode provides assurance that the message
                                                                                                       is authentic and, hence, was not corrupted in transit; however, this assurance, as for any
                                                                                                       MAC algorithm, is not absolute.

                                                                                             In the second case, an attacker, i.e., a party without access to the key or to the MAC generation
                                                                                             process, may have simply guessed the correct MAC for the message. In particular, if the attacker
                                                                                             selects a MAC at random from the set of strings of length Tlen bits, then the probability is 1 in
                                                                                             2Tlen that the MAC will be valid. Consequently, larger values of Tlen provide greater protection
                                                                                             against such an event. Of course, an attacker may attempt to systematically guess many different
                                                                                             MACs for a message, or for different messages, and thereby increase the probability that one (or
                                                                                             more) of them will be accepted as valid. For this reason, a system should limit the number of
                                                                                             unsuccessful verification attempts for each key.

                                                                                             A.2       Selection of the MAC Length

                                                                                             Larger values of Tlen provide greater assurance against guessing attacks. The performance
                                                                                             tradeoff is that larger values of Tlen require more bandwidth/storage for the MAC.

                                                                                             For most applications, a value for Tlen that is at least 64 should provide sufficient protection
                                                                                             against guessing attacks. A value of Tlen that is less than 64 shall only be used in conjunction
                                                                                             with a careful analysis of the risks of accepting an inauthentic message as authentic.

                                                                                             In particular, a value of Tlen smaller than 64 should not be used unless the controlling protocol or
                                                                                             system sufficiently restricts the number of times that the verification process can return INVALID,
                                                                                             across all implementations with any given key. For example, the short duration of a session or,
                                                                                             more generally, the low bandwidth of the communication channel may preclude many repeated
                                                                                             trials.




                                                                                                                                               11
