                                                                   GUIDELINES ON FIREWALLS AND FIREWALL POLICY


4.1.2   IPv6

IPv6 is a new version of IP that is increasingly being deployed. Although IPv6’s internal format and
address length differ from those of IPv4, many other features remain the same—and some of these are
relevant to firewalls. For the features that are the same between IPv4 and IPv6, firewalls should work the
same. For example, blocking all inbound and outbound traffic that has not been expressly permitted by
the firewall policy should be done regardless of whether or not the traffic has an IPv4 or IPv6 address.

As of this writing, some firewalls cannot handle IPv6 traffic at all; others are able to handle it but have
limited abilities to filter IPv6 traffic; and still others can filter IPv6 traffic to approximately the same
extent as IPv4 traffic. Every organization, whether or not it allows IPv6 traffic to enter its internal
network, needs a firewall that is capable of filtering this traffic. These firewalls should have the following
capabilities:

 The firewall should be able to use IPv6 addresses in all filtering rules that use IPv4 addresses.
 The administrative interface should allow administrators to clone IPv4 rules to IPv6 addresses to
  make administration easier.
 The firewall needs to be able to filter ICMPv6, as specified in RFC 4890, Recommendations for
  Filtering ICMPv6 Messages in Firewalls.
 The firewall should be able to block IPv6-related protocols such as 6-to-4 and 4-to-6 tunneling,
  Teredo, and Intra-site Automatic Tunnel Addressing Protocol (ISATAP) if they are not required.
 Many sites tunnel IPv6 packets in IPv4 packets. This is particularly common for sites experimenting
  with IPv6, because it is currently easier to obtain IPv6 transit from a tunnel broker through a v6-to-v4
  tunnel than to get native IPv6 transit from an Internet service provider (ISP). A number of ways exist
  to do this, and standards for tunneling are still evolving. If the firewall is able to inspect the contents
  of IPv4 packets, it needs to know how to inspect traffic for any tunneling method used by the
  organization. A corollary to this is that if an organization is using a firewall to prohibit IPv6 coming
  into or going out of its network, that firewall needs to recognize and block all forms of v6-to-v4
  tunneling.
Note that the above list is short and not all the rules are security-specific. Because IPv6 deployment is still
in its early stages, there is not yet widespread agreement in the IPv6 operations community about what an
IPv6 firewall should do that is different from IPv4 firewalls.

For firewalls that permit IPv6 use, traffic with invalid source or destination IPv6 addresses should always
be blocked—this is similar to blocking traffic with invalid IPv4 addresses. Since much more effort has
been spent on making lists of invalid IPv4 addresses than on IPv6 addresses, finding lists of invalid IPv6
addresses can be difficult. Also, IPv6 allows network administrators to allocate addresses in their assigned
ranges in different ways. This means that in a particular address range assigned to an organization, there
can literally be trillions of invalid IPv6 addresses and only a few that are valid. By necessity, listing which
IPv6 addresses are invalid will have to be less fine-grained than listing invalid IPv4 addresses, and the
firewall rules that use these lists will be less effective than their IPv4 counterparts.

Organizations that do not yet use IPv6 should block all native and tunneled IPv6 traffic at their firewalls.
Note that such blocking limits testing and evaluation of IPv6 and IPv6 tunneling technologies for future
deployment. To permit such use, the firewall administrator can selectively unblock IPv6 or the specific
tunneling technologies of interest for use by the authorized testers.




                                                     4-3
