                                                                                             NIST SP 800-90B                                                                RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                                    USED FOR RANDOM BIT GENERATION

                                                                                                                                   2. If scoreboardj â‰¥ scoreboardwinner, let winner =j
                                                                                                   4. Let C be the number of ones in correct.
                                                                                                                                                                                           ğ¶ğ¶
                                                                                                   5. Calculate the predictorâ€™s global performance as ğ‘ƒğ‘ƒğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” = ğ‘ğ‘ . The upper bound of the 99 %
                                                                                                                                                         â€²
                                                                                                      confidence interval on ğ‘ƒğ‘ƒğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” , denoted ğ‘ƒğ‘ƒğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” is calculated as:
                                                                                                                                                                     1
                                                                                                                                                      1 âˆ’ 0.01 ğ‘ğ‘ ,                                  if ğ‘ƒğ‘ƒğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” = 0,
                                                                                                                â€²
                                                                                                             ğ‘ƒğ‘ƒğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” =ï¿½
                                                                                                                                                                     ğ‘ƒğ‘ƒ      ï¿½1âˆ’ğ‘ƒğ‘ƒ         ï¿½
                                                                                                                             min(1, ğ‘ƒğ‘ƒğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” + 2.576ï¿½ ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘™ğ‘™ ğ‘ğ‘âˆ’1 ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” ),            otherwise

                                                                                                      where 2.576 corresponds to the ğ‘ğ‘(1âˆ’0.005) value.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                                   6. Calculate the predictorâ€™s local performance, based on the longest run of correct predictions.
                                                                                                      Let r be one greater than the length of the longest run of ones in correct. Use a binary
                                                                                                      search to solve the following for ğ‘ƒğ‘ƒğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ :
                                                                                                                                                            1 âˆ’ ğ‘ƒğ‘ƒğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ ğ‘¥ğ‘¥     1
                                                                                                                                                0.99 =                          Ã— ğ‘ğ‘+1 ,
                                                                                                                                                          (ğ‘Ÿğ‘Ÿ + 1 âˆ’ ğ‘Ÿğ‘Ÿğ‘Ÿğ‘Ÿ)ğ‘ğ‘      ğ‘¥ğ‘¥

                                                                                                      where ğ‘ğ‘ = 1 âˆ’ ğ‘ƒğ‘ƒğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ and x = x10, derived by iterating the recurrence relation
                                                                                                                                                                       ğ‘Ÿğ‘Ÿ           ğ‘Ÿğ‘Ÿ+1
                                                                                                                                                       ğ‘¥ğ‘¥ğ‘—ğ‘— = 1 + ğ‘ğ‘ğ‘ƒğ‘ƒğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ ğ‘¥ğ‘¥ğ‘—ğ‘—âˆ’1

                                                                                                      for j from 1 to 10, and x0 = 1. Note that solving for ğ‘ƒğ‘ƒğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ using the logarithm of these
                                                                                                      equations is robust against overflows. Table 3 given in Appendix G.2 provides some pre-
                                                                                                      calculated values of ğ‘ƒğ‘ƒğ‘™ğ‘™ğ‘œğ‘œğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ .

                                                                                                   7. The min-entropy is the negative logarithm of the greater performance metric
                                                                                                                                                                 â€²                                   1
                                                                                                                                    min-entropy = âˆ’log 2 (max(ğ‘ƒğ‘ƒğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘”ğ‘” , ğ‘ƒğ‘ƒğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ , ğ‘˜ğ‘˜)).

                                                                                             Example: Suppose that S = (1, 2, 1, 0, 2, 1, 1, 2, 2, 0, 0, 0), so that L = 12. For the purpose of this
                                                                                             example, suppose that w1 = 3, w2 = 5, w3 = 7, w4 = 9 (instead of w1 = 63, w2 = 255, w3 = 1023, w4
                                                                                             = 4095). Then N = 9. In step 3, the values are as follows:

                                                                                               i       frequent              scoreboard                   Winner             prediction         si       correcti-w1          scoreboard
                                                                                                                              (step 3b)                  (step 3b)                                                             (step 3d)
                                                                                               4     (1, --, --, --)             (0, 0, 0, 0)                  1                   1            0              0              (0, 0, 0, 0)
                                                                                               5     (0, --, --, --)             (0, 0, 0, 0)                  1                   0            2              0              (0, 0, 0, 0)
                                                                                               6     (2, 2, --, --)              (0, 0, 0, 0)                  1                   2            1              0              (0, 0, 0, 0)
                                                                                               7      (1, 1, --, --)             (0, 0, 0, 0)                  1                   1            1              1              (1, 1, 0, 0)
                                                                                               8      (1, 1, 1, --)              (1, 1, 0, 0)                  2                   1            2              0              (1, 1, 0, 0)
                                                                                               9      (1, 2, 2, --)              (1, 1, 0, 0)                  2                   2            2              1              (1, 2, 1, 0)
                                                                                              10      (2, 2, 2, 2)               (1, 2, 1, 0)                  2                   2            0              0              (1, 2, 1, 0)
                                                                                              11       (2, 2, 2,2)               (1, 2, 1, 0)                  2                   2            0              0              (1, 2, 1, 0)
                                                                                              12      (0, 0, 2, 0)               (1, 2, 1, 0)                  2                   0            0              1              (2, 3, 1, 1)



                                                                                                                                                                50
