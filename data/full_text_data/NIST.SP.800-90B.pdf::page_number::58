                                                                                             NIST SP 800-90B                                                                RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                                    USED FOR RANDOM BIT GENERATION

                                                                                                                                   2. If scoreboardj ≥ scoreboardwinner, let winner =j
                                                                                                   4. Let C be the number of ones in correct.
                                                                                                                                                                                           𝐶𝐶
                                                                                                   5. Calculate the predictor’s global performance as 𝑃𝑃𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 = 𝑁𝑁 . The upper bound of the 99 %
                                                                                                                                                         ′
                                                                                                      confidence interval on 𝑃𝑃𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 , denoted 𝑃𝑃𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 is calculated as:
                                                                                                                                                                     1
                                                                                                                                                      1 − 0.01 𝑁𝑁 ,                                  if 𝑃𝑃𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 = 0,
                                                                                                                ′
                                                                                                             𝑃𝑃𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 =�
                                                                                                                                                                     𝑃𝑃      �1−𝑃𝑃         �
                                                                                                                             min(1, 𝑃𝑃𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 + 2.576� 𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑙𝑙 𝑁𝑁−1 𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 ),            otherwise

                                                                                                      where 2.576 corresponds to the 𝑍𝑍(1−0.005) value.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                                   6. Calculate the predictor’s local performance, based on the longest run of correct predictions.
                                                                                                      Let r be one greater than the length of the longest run of ones in correct. Use a binary
                                                                                                      search to solve the following for 𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙 :
                                                                                                                                                            1 − 𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙 𝑥𝑥     1
                                                                                                                                                0.99 =                          × 𝑁𝑁+1 ,
                                                                                                                                                          (𝑟𝑟 + 1 − 𝑟𝑟𝑟𝑟)𝑞𝑞      𝑥𝑥

                                                                                                      where 𝑞𝑞 = 1 − 𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙 and x = x10, derived by iterating the recurrence relation
                                                                                                                                                                       𝑟𝑟           𝑟𝑟+1
                                                                                                                                                       𝑥𝑥𝑗𝑗 = 1 + 𝑞𝑞𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙 𝑥𝑥𝑗𝑗−1

                                                                                                      for j from 1 to 10, and x0 = 1. Note that solving for 𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙 using the logarithm of these
                                                                                                      equations is robust against overflows. Table 3 given in Appendix G.2 provides some pre-
                                                                                                      calculated values of 𝑃𝑃𝑙𝑙𝑜𝑜𝑐𝑐𝑐𝑐𝑐𝑐 .

                                                                                                   7. The min-entropy is the negative logarithm of the greater performance metric
                                                                                                                                                                 ′                                   1
                                                                                                                                    min-entropy = −log 2 (max(𝑃𝑃𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔𝑔 , 𝑃𝑃𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙𝑙 , 𝑘𝑘)).

                                                                                             Example: Suppose that S = (1, 2, 1, 0, 2, 1, 1, 2, 2, 0, 0, 0), so that L = 12. For the purpose of this
                                                                                             example, suppose that w1 = 3, w2 = 5, w3 = 7, w4 = 9 (instead of w1 = 63, w2 = 255, w3 = 1023, w4
                                                                                             = 4095). Then N = 9. In step 3, the values are as follows:

                                                                                               i       frequent              scoreboard                   Winner             prediction         si       correcti-w1          scoreboard
                                                                                                                              (step 3b)                  (step 3b)                                                             (step 3d)
                                                                                               4     (1, --, --, --)             (0, 0, 0, 0)                  1                   1            0              0              (0, 0, 0, 0)
                                                                                               5     (0, --, --, --)             (0, 0, 0, 0)                  1                   0            2              0              (0, 0, 0, 0)
                                                                                               6     (2, 2, --, --)              (0, 0, 0, 0)                  1                   2            1              0              (0, 0, 0, 0)
                                                                                               7      (1, 1, --, --)             (0, 0, 0, 0)                  1                   1            1              1              (1, 1, 0, 0)
                                                                                               8      (1, 1, 1, --)              (1, 1, 0, 0)                  2                   1            2              0              (1, 1, 0, 0)
                                                                                               9      (1, 2, 2, --)              (1, 1, 0, 0)                  2                   2            2              1              (1, 2, 1, 0)
                                                                                              10      (2, 2, 2, 2)               (1, 2, 1, 0)                  2                   2            0              0              (1, 2, 1, 0)
                                                                                              11       (2, 2, 2,2)               (1, 2, 1, 0)                  2                   2            0              0              (1, 2, 1, 0)
                                                                                              12      (0, 0, 2, 0)               (1, 2, 1, 0)                  2                   0            0              1              (2, 3, 1, 1)



                                                                                                                                                                50
