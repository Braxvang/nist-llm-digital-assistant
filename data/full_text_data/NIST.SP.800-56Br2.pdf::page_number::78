                                                                                               NIST SP 800-56B REV. 2                            RECOMMENDATION FOR PAIR-WISE KEY ESTABLISHMENT
                                                                                                                                                      USING INTEGER FACTORIZATION CRYPTOGRAPHY


                                                                                               Output:
                                                                                                  The byte string mask (of maskLen bytes), or an error indicator.
                                                                                               A routine that implements this function shall destroy any local copies of the input mgfSeed, any
                                                                                               locally stored portions of mask (e.g., any portion of T), and any other potentially sensitive locally
                                                                                               stored values used or produced during the execution of the routine. The destruction of these locally
                                                                                               stored values shall occur prior to or during any exit from the routine (whether exiting early because
                                                                                               of an error or exiting normally with the output of mask). Note that the requirement for destruction
                                                                                               includes any locally stored portions of the output.

                                                                                               7.2.2.3 RSA-OAEP Encryption Operation (RSA-OAEP.ENCRYPT)
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Br2




                                                                                               The RSA-OAEP.ENCRYPT operation produces ciphertext from keying material and additional
                                                                                               input using an RSA public key, as shown in Figure 4. See Section 9.1 for more information on the
                                                                                               additional input. Let HLen be the byte length of the output of hash function H.
                                                                                               Function call: RSA-OAEP.ENCRYPT((n, e), K, A)
                                                                                               Input:
                                                                                                  1. (n, e): the receiver’s RSA public key.
                                                                                                  2. K: the keying material; a byte string of at most nLen – 2HLen – 2 bytes, where nlen is the
                                                                                                     byte length of n.
                                                                                                  3. A: additional input; a byte string (which may be the Null string) to be cryptographically
                                                                                                     bound to the keying material (see Section 9.1).
                                                                                               Assumptions: The RSA public key is valid.
                                                                                               Process:
                                                                                                  1. nLen = len(n)/8, the byte length of n.
                                                                                                  2. Length checking:
                                                                                                          a. KLen = len(K)/8, the byte length of K.
                                                                                                          b. If KLen > nLen – 2HLen – 2, then output an indication that the keying material is
                                                                                                             too long, and exit without further processing.
                                                                                                  3. OAEP encoding:
                                                                                                          a. Apply the selected hash function to compute:
                                                                                                                                           HA = H(A).
                                                                                                              HA is a byte string of HLen bytes. If A is an empty string, then HA is the hash value
                                                                                                              for the empty string.
                                                                                                          b. Construct a byte string PS consisting of nLen – KLen – 2HLen – 2 zero bytes. The
                                                                                                             length of PS may be zero.
                                                                                                          c. Concatenate HA, PS, a single byte with a hexadecimal value of 01, and the keying
                                                                                                             material K to form data DB of nLen – HLen – 1 bytes as follows:

                                                                                                                                                68
