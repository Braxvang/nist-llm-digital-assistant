                                                             GUIDE TO INTRUSION DETECTION AND PREVENTION SYSTEMS (IDPS)



     –    System call monitoring. The agent knows which applications and processes should be calling
          which other applications and processes or performing certain actions. For example, an agent
          could recognize a process attempting to intercept keystrokes, such as a keylogger. Another
          example is an agent that restricts component object model (COM) object loading, such as
          permitting a PDA application, but not other applications, to access an e-mail client’s address
          book. Agents can also restrict which drivers can be loaded, which can prevent the installation of
          rootkits and other attacks.

     –    Application and library lists. An agent might monitor each application and library (e.g.,
          dynamic link library [DLL]) that a user or process attempts to load and compare that information
          to lists of authorized and unauthorized applications and libraries. This can be used not only to
          restrict which applications and libraries can be used, but which versions of them can be used.
 Network Traffic Analysis. This is often similar to what a network-based IDPS does; some products
  can analyze both wired and wireless network traffic. In addition to network, transport, and
  application layer protocol analysis, agents may include special processing for common applications,
  such as popular e-mail clients. Traffic analysis also allows the agent to extract files sent by
  applications such as e-mail, Web, and peer-to-peer file sharing, which can then be checked for
  malware.
 Network Traffic Filtering. Agents often include a host-based firewall that can restrict incoming and
  outgoing traffic for each application on the system, preventing unauthorized access and acceptable
  use policy violations (e.g., use of inappropriate external services). Some of these firewalls can
  generate and use a list of the hosts with which this host should be communicating, particularly within
  the organization.
 Filesystem Monitoring. Filesystem monitoring can be performed using several different techniques,
  including the ones listed below. Administrators should be aware that some products base their
  monitoring on filenames, so if users or attackers alter filenames, filesystem monitoring techniques
  might be made ineffective.

     –    File integrity checking. This involves periodically generating message digests or other
          cryptographic checksums for critical files, comparing them to reference values, and identifying
          differences. File integrity checking can only determine after-the-fact that a file has already been
          changed, such as a system binary being replaced by a Trojan horse or a rootkit.

     –    File attribute checking. This is periodically checking the attributes of important files, such as
          ownership and permissions, for changes. Like file integrity checking, it can only determine after-
          the-fact that a change has occurred.

     –    File access attempts. An agent with a filesystem shim can monitor all attempts to access critical
          files, such as system binaries, and stop attempts that are suspicious. The agent has a set of
          policies regarding file access, so the agent compares those policies to the characteristics of the
          current attempt, including which user or application is trying to access each file, and what type of
          access has been requested (read, write, execute). 43 This could be used to prevent some forms of
          malware from being installed, such as rootkits and Trojan horses, as well as preventing many
          other types of malicious activity involving file access, modification, replacement, or deletion.




43
     On Windows systems, many configuration settings reside in a set of special files known as the registry. Some agents have
     special registry shims that restrict access to critical portions of the registry, especially those frequently used by malware.


                                                                7-5
