Special Publication 800-85B                                    PIV Data Model Testing Specification


Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<CHUID (2.16.840.1.101.3.7.2.48.0)>>
                      3. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      4. Extract the certificates field contents from the
                         asymmetric signature of the CHUID.
                      5. Extract the asymmetric signature contents from the CHUID
                      6. Using the certificate extracted, verify the SignedData
                         located in the asymmetric signature field of the CHUID.
Expected              The certificates field in the SignedData contains a single certificate that
Result(s)             can be used to verify the digital signature in the SignerInfo.


10.1.2 Embedded Certificate

10.1.2.1 Verify extended key usage extension

Purpose                 Confirms that the digital signature certificate used to sign the CHUID
                        asserts id-PIV-content-signing in the extendedKeyUsage extension.
Reference(s)            1.     FIPS201, Section 4.2.2
                        2.     AS06.01.16
Precondition            1.     A valid PIV card is inserted into the contact reader.
                        2.     A valid PC/SC connection exists between the test application and
                               the contact reader.
                        3.     The test application is currently connected to the card application
                               which is accessible through card handle.
                        4.     A valid CHUID is present on the PIV card.
Test Steps              1. Set cardHandle := <<valid card handle>>
                        2. Set OID := <<CHUID (2.16.840.1.101.3.7.2.48.0)>>
                        3. Call pivGetData w/
                           • (IN) cardHandle
                               • (IN) OID
                               • (OUT) data

                        4.     Extract the certificates field contents from the
                               asymmetric signature of the CHUID
                        5.     Extract all KeyPurposeId fields from the extended key
                               usage extension from the certificate obtained
Expected Result(s)      A KeyPurposeId asserting id-PIV-content-signing exists in the extended
                        key usage extension.




                                                                                                      Page 80
