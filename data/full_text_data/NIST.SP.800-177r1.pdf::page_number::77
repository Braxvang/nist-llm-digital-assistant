                                                                                               NIST SP 800-177 REV. 1                                                                                  TRUSTWORTHY EMAIL




                                                                                               If the client wants to ensure an encrypted channel, there is a new proposal to allow for signaling
                                                                                               the required use of TLS via the REQUIRETLS SMTP option20. �is option is set by senders to
                                                                                               indicate that they wish TLS to be used for each hop and not deliver to the next hop if TLS is not
                                                                                               available. If the server wishes to indicate that an encrypted channel is available and should be
                                                                                               used by senders, this can be indicated through an advertisement using DANE. If the end user
                                                                                               wants security over the message content, then the message should be encrypted using S/MIME
                                                                                               or OpenPGP, as discussed in Section 5.3.

                                                                                               In this long transition period towards “TLS everywhere,” there will be security gaps where some
                                                                                               MTA to MTA hop oﬀers TCP only. In these cases, the receiving MTA suggestion of
                                                                                               STARTTLS can be downgraded by the above MITM attack. In such cases, a channel thought
                                                                                               secure by the end user can be compromised. A mitigating consolation is that opportunistic
                                                                                               security (i.e., use encryption when available) is better than no security. �e more mail
                                                                                               administrators who actively deploy TLS, the fewer opportunities for eﬀective MITM attacks. In
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-177r1




                                                                                               this way global email security improves incrementally.

                                                                                               5.2.3.1 Recommendations

                                                                                               Security Recommendation 5-2: TLS-capable servers should prompt clients to invoke the
                                                                                               STARTTLS command. TLS clients should attempt to use STARTTLS for SMTP, either initially,
                                                                                               or issuing the command when oﬀered.

                                                                                               5.2.4     SMTP Security via Opportunistic DNS-based Authentication of Named Entities
                                                                                                         (DANE) Transport Layer Security (TLS)

                                                                                               For years, TLS has solved the problem of distributing public keys by using a certiﬁcate, signed
                                                                                               by some well-known Certiﬁcation Authority (CA). Every browser developer and operating
                                                                                               system supplier maintain a list of CA root certiﬁcates as trust-anchors. �ese are called the
                                                                                               software’s root certiﬁcates and are stored in the root certiﬁcate store. �e PKIX procedure
                                                                                               allows the certiﬁcate recipient to trace a certiﬁcate back to the root. So long as the root certiﬁcate
                                                                                               remains trustworthy, and the authentication concludes successfully, the client can proceed with
                                                                                               the connection.

                                                                                               Currently, there are hundreds of organizations acting as CAs on the Internet. If one CA
                                                                                               infrastructure or vetting procedure is compromised, the attacker can obtain the CA’s private key,
                                                                                               or get issued certiﬁcates under a false name. �ere is no limitation of scope for the global PKI,
                                                                                               and a compromise of a single CA damages the integrity of the entire PKI system.

                                                                                               Aside from a CA compromise, some CAs have engaged in poor security practices. For example,
                                                                                               some CAs have issued wildcard certiﬁcates that allow the holder to issue sub-certiﬁcates for any
                                                                                               domain or entity, anywhere in the world. 21


                                                                                               20 J. Fenton SMTP Require TLS Option. Work in Progress https://datatracker.ietf.org/doc/draft-ietf-uta-smtp-require-tls/


                                                                                               21 For examples of poor CA issuing practices involving sub-certificates, see “Bug 724929—Remove Trustwave Certificate(s)




                                                                                                                                                              64
