                                                        GUIDE TO INTRUSION DETECTION AND PREVENTION SYSTEMS (IDPS)



6.      Network Behavior Analysis (NBA) System

A network behavior analysis (NBA) system examines network traffic or statistics on network traffic to
identify unusual traffic flows, such as distributed denial of service (DDoS) attacks, certain forms of
malware (e.g., worms, backdoors), and policy violations (e.g., a client system providing network services
to other systems). 39 This section provides a detailed discussion of NBA technologies. First, it covers the
major components of the NBA technologies and explains the architectures typically used for deploying
the components. It also examines the security capabilities of the technologies in depth, including the
methodologies they use to identify suspicious activity. The rest of the section discusses the management
capabilities of the technologies, including recommendations for implementation and operation.

6.1     Components and Architecture

This section describes the major components of typical NBA solutions and illustrates the most common
network architectures for these components. It also provides recommendations for the placement of
certain components.

6.1.1     Typical Components

NBA solutions usually have sensors and consoles, with some products also offering management servers
(which are sometimes called analyzers). NBA sensors are usually available only as appliances. Some
sensors are similar to network-based IDPS sensors in that they sniff packets to monitor network activity
on one or a few network segments. Other NBA sensors do not monitor the networks directly, but instead
rely on network flow information provided by routers and other networking devices. Flow refers to a
particular communication session occurring between hosts. There are many standards for flow data
formats, including NetFlow 40 and sFlow. 41 Typical flow data particularly relevant to intrusion detection
and prevention includes the following:

 Source and destination IP addresses
 Source and destination TCP or UDP ports or ICMP types and codes
 Number of packets and number of bytes transmitted in the session
 Timestamps for the start and end of the session.
6.1.2     Network Architectures

As with a network-based IDPS, a separate management network or the organizationâ€™s standard networks
can be used for NBA component communications. If sensors that collect network flow data from other
devices are used, the entire NBA solution can be logically separated from the standard networks. Figure
6-1 shows an example of an NBA network architecture.




39
      Some vendors refer to NBA technology as network behavior anomaly detection (NBAD) software, network behavior
      analysis and response software, or network anomaly detection software.
40
      More information on NetFlow is available from RFC 3954, Cisco Systems NetFlow Services Export Version 9
      (http://www.ietf.org/rfc/rfc3954.txt) and from the Cisco Web site at
      http://www.cisco.com/en/US/products/ps6645/products_ios_protocol_option_home.html.
41
      More information on sFlow is available at http://www.sflow.org/.


                                                           6-1
