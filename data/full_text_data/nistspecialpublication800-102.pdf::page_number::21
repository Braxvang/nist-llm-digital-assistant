               if it is known or can be determined by entity B.
           •   Any portion of TTA_supplied_info1 that is present in TSP1 may be omitted
               if it is already known or can be determined by entity B.
           •   Any portion of TTA_supplied_info2 may be omitted if it is already known
               or can be determined by entity B.
       However, any such information omitted from the transmitted data shall be
       included in the appropriate timestamped_data field (timestamped_data1 and/or
       timestamped_data2) used in the generation / verification of the quantities:
               timestamp_signatureTTA1 = SIGTTA1 (timestamped_data1),
               SIGA(M, TSP1), and
               timestamp_signatureTTA2 = SIGTTA2 (timestamped_data2).
   6. Upon receiving D, entity B does the following:
           •   If the scheme in Section 4.3.2 was used, entity B computes H′ = Hash(M).
               If H was received by entity B in D as part of the transmitted TSP1, entity B
               verifies that H = H′; otherwise, entity B sets H = H′ in the
               user_supplied_info1 when verifying timestamp_signatureTTA1 and
               SIGA(M, TSP1).
           •   Verifies timestamp_signatureTTA1 using TTA1’s public signature
               verification key,
           •   Verifies SIGA(M, TSP1) using entity A’s public signature verification key,
               and
           •   Verifies timestamp_signatureTTA2 using TTA2’s public signature
               verification key.
       Note that the order of performing these verifications is irrelevant; it is only
       important that all verifications are successful.
Because of the verifications performed in step 6, entity B knows (and/or has assurance
of) the following in addition to what is known in the appropriate scheme from Section
4.3:
   a. SIGA(M, TSP1) was generated between the times indicated in timestamp1 and
      timestamp2, and was included in the timestamped_data2 signed by TTA2.
   b. D was assembled after the time indicated by timestamp2.

4.4.2 Entity B Requests the Second Timestamp
Entity B may request a second timestamp after receiving D from entity A and verifying
the associated signatures (see step 4 of the schemes in Sections 4.3.1 - 4.3.3). The TTA
that provides the first timestamp (TTA1) must be trusted by both entity A and entity B,
but the TTA that provides the second timestamp (TTA2) may need to be trusted only by
entity B. In general, any party that relies on the accuracy of the bounds on the generation


                                             21
