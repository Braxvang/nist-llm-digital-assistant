                                                               GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


4.4.3.2     Securing Other MN to HA Traffic

Once an IPsec SA is established between a MN and its HA for BUs and BUAs, it can be used for other
protocol elements:

   ICMPv6 between the HA and MN for MPS and MPA prefix discovery and for DHAAD

   The return routability messages Home Test Init and Home Test (see Section 4.4.3.3)

   User traffic (everything else)
At this point, the security associations at the MN include four sets of ESP SPD and SAD entries to and
from the HA. All must use the ESP data authentication (integrity) service. Confidentiality may be used if
needed. The four sets of entries are:

   Transport mode for Mobility Headers for BU and BUA with the HA

   Transport mode for ICMPv6 for home network prefix discovery

   Tunnel mode for Mobility Headers for return routability messages to and from a CN

   Optionally, tunnel mode for all other traffic
4.4.3.3     Securing MN to CN Communications

A MN needs to exchange a BU and BUA with a CN to establish route optimization. The major threats
are that a CN gets a forged BU, or a CN processes a forged Home Address Option. The original drafts
recommended using IPsec, but it was decided that sufficient infrastructure for IPsec authentication did not
exist to make this widely deployable, and a new security protocol called return routability was invented
to authenticate and share a key (called Kbm) between a MN and CN. The idea was to make sure the MN
can receive messages both directly from the CN over its optimized route and indirectly over its IPsec
connection with its HA. Return routability works as follows: the MN sends the CN Care-of Test Init and
Home Test Init over these two paths, respectively. These paths are illustrated in Figure 4-5.




                                                    4-21
