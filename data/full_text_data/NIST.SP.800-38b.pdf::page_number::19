                                                                                             NIST SP 800-38B                                                                BLOCK CIPHER MODES:
                                                                                                                                                                    CMAC MODE FOR AUTHENTICATION


                                                                                             Appendix C: Protection Against Replay of Messages

                                                                                             As described in Appendix A, the successful verification of a MAC for a message gives assurance
                                                                                             that the source of the message executed the MAC generation algorithm to create the MAC;
                                                                                             however, the party that presented the message and MAC for verification may not be the original
                                                                                             source of the message. Therefore, the CMAC algorithm does not inherently prevent an attacker
                                                                                             from intercepting a legitimate message and its MAC and “replaying” them for verification at a
                                                                                             later time, for example, in an attempt to impersonate a party that has access to the key. In some
                                                                                             protocols an attacker may even be able to present to a verifier a message-MAC pair that the verifier
                                                                                             itself generated earlier in the protocol.
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-38B




                                                                                             The controlling protocol or application may protect against such an event by incorporating certain
                                                                                             identifying information into the initial bits of every message. Examples of such information
                                                                                             include a sequential message number, a timestamp, or a nonce. Upon successful verification of
                                                                                             the message, this information may provide a means for the detection of replayed messages, out-
                                                                                             of-sequence messages, or missing messages.




                                                                                                                                             14
