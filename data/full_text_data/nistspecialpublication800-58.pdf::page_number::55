NIST SP 800-58                                              Voice Over IP Security
_____________________________________________________________________________

         protocol models are quite different. MEGACO specifies a media gateway
         connection model that has two entities: Terminations (source or sink for (one or
         more) media streams), and context (grouping of terminations connected in a call).
         In contrast, MGCP uses the following two entities: Endpoints (source or sink of
         data), and Connection: (association between two endpoints).

         Taking a multipoint conference as an example, MEGACO simplifies the
         connection setup by adding terminations to a context, whereas MGCP has to
         establish several connections to the conference server. The context in this scenario
         may cover multiple media streams for enhanced multimedia services.

         With MEGACO/H.248, the primary mechanism for extension is by means of
         packages. In general, MEGACO/H.248 Packages include more detail than MGCP
         Packages. They define additional properties and statistics along with event and
         signal information that may occur on terminations.


                                      Media Gateway Controller
                                         MGC (Call Agent)


                                                           H.323 / SIP
                                                                                   LAN

                                                                                          Client

                                          MEGACO / H.248
                                                                          RTP

                       Media                                             Media
                       Gateway                                           Gateway
                                     IP                          IP


                                                     PSTN



                          Figure 8: General Scenario for MEGACO/H.248 Usage


 6.2.3    Security Considerations

         Megaco (RFC 3525) recommends security mechanisms that may be in underlying
         transport mechanisms, such as IPsec. H.248 goes a step further by requiring that
         implementations of the H.248 protocol implement IPsec if the underlying
         operating system and the transport network support IPsec. Implementations of the
         protocol using IPv4 are required to implement the interim AH scheme. H.248
         states that implementations employing the AH header shall provide a minimum
         set of algorithms for integrity checking using manual keys (compliant to RFC
         2402).

         The interim AH scheme is the use of an optional AH header, which is defined in
         the H.248 protocol header. The header fields are exactly those of the SPI,


50
