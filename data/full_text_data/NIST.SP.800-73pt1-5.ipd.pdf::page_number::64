       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1298   As a final step, the discovered X.509 algorithm OID and key size are mapped to the PIV
1299   algorithm identifiers, as defined in Table 9 of SP 800-78. The relying party then proceeds to
1300   issue the GENERAL AUTHENTICATE command to the card.

1301   C.2. PIV Algorithm Identifier Discovery for Symmetric Cryptographic
1302      Authentication
1303   In the absence of an X.509 certificate, as is the case with symmetric cryptography, the PIV
1304   algorithm identifier discovery mechanism has to rely on a lookup table that resides on the local
1305   system. The table maps a unique card identifier and key reference (inputs) to an associated PIV
1306   algorithm identifier (output). The unique identifier supplied by the card MAY be the Agency
1307   Code || System Code || Credential Number of the FASC-N or the Card UUID.
1308   The symmetric Card Authentication key is optional to implement, and a relying party has no
1309   prior knowledge of the key’s existence. The following routine discovers the Card Authentication
1310   key’s native implementation:
1311       •   Read the CHUID, and extract either the Card UUID or the Agency Code || System code ||
1312           Credential Number from the CHUID’s FASC-N.
1313       •   Retrieve the PIV algorithm identifier from the local lookup table. If no algorithm
1314           identifier is returned, authentication CANNOT be performed using the optional
1315           symmetric Card Authentication key, either because the PIV Card does not implement the
1316           key or the local system CANNOT authenticate the response from the card.

1317   C.3.    PIV Algorithm Identifier Discovery for Secure Messaging
1318   The Application Property Template included in the response to the SELECT command
1319   optionally includes a tag 0xAC, which indicates what cryptographic algorithms the PIV Card
1320   Application supports. The presence of algorithm identifier '27' or '2E' indicates that the
1321   corresponding cipher suite is supported by the PIV Card Application for secure messaging and
1322   that the PIV Card Application possesses a PIV Secure Messaging key of the appropriate size for
1323   the specified cipher suite.
1324




                                                             52
