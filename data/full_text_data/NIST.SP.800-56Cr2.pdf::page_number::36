                                                                                               NIST SP 800-56C REV. 2                                  RECOMMENDATION FOR KEY DERIVATION METHODS
                                                                                                                                                                    IN KEY ESTABLISHMENT SCHEMES


                                                                                               8         Further Discussion

                                                                                               In this section, the following issues are discussed:

                                                                                               8.1       Using a Truncated Hash Function

                                                                                               SHA-224, SHA-512/224, SHA-512/256, and SHA-384 are among the approved hash functions
                                                                                               specified in [FIPS 180]. SHA-224 is a truncated version of SHA-256, while SHA-512/224, SHA-
                                                                                               512/256, and SHA-384 are truncated versions of SHA-512. (Each of these truncated versions uses
                                                                                               a specific initial chaining value, which is different from the initial chaining value used by the
                                                                                               untruncated version.) In applications that require a relatively long bit string of derived keying
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Cr2




                                                                                               material, implementing the key-derivation methods specified in this Recommendation with a
                                                                                               truncated version of a hash function may be less efficient than using the corresponding untruncated
                                                                                               version (i.e., SHA-256 or SHA-512).

                                                                                               8.2       The Choice of a Salt Value

                                                                                               In this Recommendation, the MAC algorithms employed either in a one-step key-derivation
                                                                                               method or in the randomness-extraction step of a two-step key-derivation method use a salt value
                                                                                               as a MAC key (see Sections 4 and 5). This Recommendation does not require the use of a randomly
                                                                                               selected salt value. In particular, if there are no means to select a salt value and share it with all of
                                                                                               the participants during a key-establishment transaction, then this Recommendation specifies that
                                                                                               a predetermined default (e.g., all-zero) byte string be used as the salt value. The benefits of using
                                                                                               “random” salt values when possible are discussed (briefly) in Section 3.1 (“To salt or not to salt”)
                                                                                               of [RFC 5869] and in greater detail in [LNCS 6223].

                                                                                               8.3       MAC Algorithms used for Extraction and Expansion

                                                                                               Provided that the targeted security strength can be supported (see Tables 4 and 5 in Section 5.2),
                                                                                               this Recommendation permits either HMAC-hash (i.e., HMAC implemented with an appropriately
                                                                                               chosen approved hash function, hash) or AES-CMAC (i.e., the CMAC mode of AES-128, AES-
                                                                                               192, or AES-256) to be selected as the MAC algorithm used in the randomness-extraction step of
                                                                                               the key-derivation procedure specified in Section 5.1.
                                                                                               The PRF-based KDF used in the key-expansion step of the procedure also requires an appropriate
                                                                                               MAC (to serve as the PRF). While it may be technically feasible (in some cases) to employ
                                                                                               completely different MAC algorithms in the two steps of the specified key-derivation procedure,
                                                                                               this Recommendation does not permit such flexibility. Instead, the following restrictions have been
                                                                                               placed on MAC selection (see Sections 5 and 7):
                                                                                                     •    When HMAC-hash is chosen for use in the randomness-extraction step, the same MAC
                                                                                                          algorithm (i.e., HMAC-hash with the same approved hash function, hash) shall be
                                                                                                          employed to implement the PRF-based KDF used in the key-expansion step.
                                                                                                     •    When AES-128-CMAC, AES-192-CMAC, or AES-256-CMAC is chosen for use in the
                                                                                                          randomness-extraction step, the MAC algorithm employed by the PRF-based KDF used in
                                                                                                          the key-expansion step shall be AES-128-CMAC, the CMAC mode of AES-128. (AES-



                                                                                                                                                  28
