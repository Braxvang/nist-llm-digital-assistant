                                        GUIDE TO MALWARE INCIDENT PREVENTION AND HANDLING FOR DESKTOPS AND LAPTOPS


participation in containment and eradication activities. Providing instructions and software updates to
users works in some cases, but other users might need assistance. Having formal or informal walk-up help
desk areas at major facilities can also be effective and is more efficient and convenient than having IT
staff locate and interrupt each affected user. During major incidents, additional IT staff members can be
relieved of other duties temporarily to assist in eradication efforts. For locations without IT staff, it is
often helpful to have a few people trained in basic eradication actions so that they can take care of their
own hosts. Organizations should be prepared to perform a few different types of eradication efforts
simultaneously if needed.

For many malware incidents, simple disinfection is not feasible, so it is necessary to rebuild all infected
hosts as part of eradication efforts. Rebuilding includes the reinstallation and securing of the OS and
applications (or restoration of known good OS and application backups, including the use of built-in OS
rollback capabilities), and the restoration of data from known good backups. Some types of malware are
extremely difficult to remove from hosts; even if they can be removed, each host’s OS may be damaged,
possibly to the point where the hosts cannot boot. Rebuilding is also the best eradication option when the
actions performed on an infected host are unknown. If a host has multiple infections; has been infected for
an extended or unknown period of time; or has had backdoors, rootkits, or other damaging attacker tools
installed, other malicious actions besides the malware infections may have been performed against the
host. In such cases, rebuilding the host would be the most reliable way of restoring its integrity. Also, in
some cases it is faster to rebuild a host than to perform all of the analysis necessary to determine exactly
what the malware has done and remove all traces of it from the host. This is particularly true in managed
environments where hosts are built based on standard OS images, baselines, etc. Organizations should be
prepared to rebuild hosts quickly, as needed, when malware incidents occur.

In general, organizations should rebuild any host that has any of the following incident characteristics,
instead of performing typical eradication actions (disinfection):

      One or more attackers gained administrator-level access to the host.
      Unauthorized administrator-level access to the host was available to anyone through a backdoor,
       an unprotected share created by a worm, or other means.
      System files were replaced by a Trojan horse, backdoor, rootkit, attacker tools, or other means.
      The host is unstable or does not function properly after the malware has been eradicated by
       antivirus software or other programs or techniques. This indicates that either the malware has not
       been eradicated completely or that it has caused damage to important system or application files
       or settings.
      There is doubt about the nature of and extent of the infection or any unauthorized access gained
       because of the infection.
If a malware incident does not have any of these characteristics, then it is typically sufficient to eradicate
the malware from the host instead of rebuilding the host.

Eradication can be frustrating because of the number of hosts to clean up and the tendency to have
additional infections and reinfections occurring for days, weeks, or months. 20 Incident handlers should
periodically perform identification activities to identify hosts that are still infected and estimate the

20
     Instances of a particular type of malware might reside within an organization indefinitely, regardless of eradication efforts.
     For example, malware might be captured in host backups; restoration of a backup could also restore the malware. Also,
     malware might infect removable media that then sits unused for an extended period of time. Years after the initial infection,
     the removable media could be accessed, and the malware could attempt to infect the host.


                                                                30
