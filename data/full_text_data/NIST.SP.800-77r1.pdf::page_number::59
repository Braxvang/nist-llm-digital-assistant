                                                                                              NIST SP 800-77 REV. 1                                                         GUIDE TO IPSEC VPNS
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                                           Figure 10: ESP Packet Capture Using Wireshark, Showing Sequence Number 1

                                                                                              Although it is difficult to tell from Figure 10, the ESP header fields are not encrypted. Figure 11
                                                                                              shows a network traffic capture made with the tcpdump tool of encrypted traffic generated by the
                                                                                              ping command, followed by an IKE session which is followed by another ping that is now
                                                                                              protected by ESP. Each direction uses its own negotiated SPI value for its packets, which
                                                                                              corresponds to an ESP connection being composed of two one-way connections, each with its
                                                                                              own SPI. Both hosts initially set the sequence number to 1, and both incremented the number to
                                                                                              2 for their second packets. The tcpdump tool labels IKE packets as “isakmp”—a legacy name
                                                                                              from the IKEv1 protocol.




                                                                                                                                              42
