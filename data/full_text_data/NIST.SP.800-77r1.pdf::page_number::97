                                                                                              NIST SP 800-77 REV. 1                                                           GUIDE TO IPSEC VPNS


                                                                                                      cryptographic modules to hardware-based cryptographic modules, or reducing processing
                                                                                                      needs (e.g., using a more efficient encryption algorithm or only encrypting sensitive
                                                                                                      traffic).
                                                                                                 •    Security of the Implementation. The IPsec implementation itself may contain
                                                                                                      vulnerabilities and weaknesses that attackers could exploit. Organizations with high
                                                                                                      security needs may want to perform extensive vulnerability assessments against the IPsec
                                                                                                      components. At a minimum, the testers should update all components with the latest
                                                                                                      patches and configure the components following sound security practices. Section 7.3.2
                                                                                                      presents some common IPsec security concerns.
                                                                                                      Component Interoperability. The components of the IPsec solution must function
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-77r1




                                                                                                 •
                                                                                                      together properly. This is of greatest concern when a variety of components from
                                                                                                      different vendors may be used. Section 7.3.1 contains more information on
                                                                                                      interoperability concerns.
                                                                                                 •    Default Settings. In addition to the IPsec settings described in Section 7.2, IPsec
                                                                                                      implementations may have other configuration settings. IPsec implementers should
                                                                                                      carefully review the default values for each setting and alter the settings as necessary to
                                                                                                      support their design goals. They should also ensure that the implementation does not
                                                                                                      unexpectedly “drop back” to default settings for interoperability or other reasons.

                                                                                              7.3.1   Component Interoperability

                                                                                              Another facet of testing to consider is the compatibility and interoperability of the IPsec
                                                                                              components. Although there have been improvements in the industry, especially with IKEv2-
                                                                                              based IPsec implementations, some vendors make it difficult to interoperate with or manage
                                                                                              other IPsec devices. Because many vendors offer IPsec clients and gateways, implementation
                                                                                              differences among products and the inclusion of proprietary solutions can lead to interoperability
                                                                                              problems. Although IPsec vendors use the term “IPsec compliant” to state that they meet the
                                                                                              current IETF IPsec standards, they may implement the standards differently, which can cause
                                                                                              subtle problems that are difficult to diagnose. Some products also provide support for
                                                                                              components (e.g., encryption algorithms) that are not part of the IPsec standards; this is done for
                                                                                              various reasons, including enhancing ease-of-use, providing additional functionality, and
                                                                                              addressing weak or missing parts of the standards. Examples of compatibility issues include:

                                                                                                 •    The endpoints support different encryption algorithms, compression algorithms, or
                                                                                                      authentication methods.
                                                                                                 •    One endpoint requires the usage of a proprietary feature for proper operation.
                                                                                                 •    The endpoints may encode or interpret certain digital certificate fields or data differently.
                                                                                                 •    The endpoints default to different parameters, such as DH group 14 versus DH group 19.
                                                                                                 •    The endpoints implement different interpretations of ambiguous or vaguely worded
                                                                                                      standards, such as performing SA rekeying in different ways.




                                                                                                                                               80
