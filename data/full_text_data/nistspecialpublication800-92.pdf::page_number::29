                                                                                GUIDE TO COMPUTER SECURITY LOG MANAGEMENT



3.2      Functions

Log management infrastructures typically perform several functions that assist in the storage, analysis,
and disposal of log data. These functions are normally performed in such a way that they do not alter the
original logs.23 The following items describe common log management infrastructure functions:

       General

           –    Log parsing is extracting data from a log so that the parsed values can be used as input for
                another logging process. A simple example of parsing is reading a text-based log file that
                contains 10 comma-separated values per line and extracting the 10 values from each line.
                Parsing is performed as part of many other logging functions, such as log conversion and log
                viewing.

           –    Event filtering is the suppression of log entries from analysis, reporting, or long-term storage
                because their characteristics indicate that they are unlikely to contain information of interest.
                For example, duplicate entries and standard informational entries might be filtered because
                they do not provide useful information to log analysts. Typically, filtering does not affect the
                generation or short-term storage of events because it does not alter the original log files.

           –    In event aggregation, similar entries are consolidated into a single entry containing a count of
                the number of occurrences of the event. For example, a thousand entries that each record part
                of a scan could be aggregated into a single entry that indicates how many hosts were scanned.
                Aggregation is often performed as logs are originally generated (the generator counts similar
                related events and periodically writes a log entry containing the count), and it can also be
                performed as part of log reduction or event correlation processes, which are described below.
       Storage

           –    Log rotation is closing a log file and opening a new log file when the first file is considered to
                be complete. Log rotation is typically performed according to a schedule (e.g., hourly, daily,
                weekly) or when a log file reaches a certain size. The primary benefits of log rotation are
                preserving log entries and keeping the size of log files manageable. When a log file is
                rotated, the preserved log file can be compressed to save space. Also, during log rotation,
                scripts are often run that act on the archived log. For example, a script might analyze the old
                log to identify malicious activity, or might perform filtering that causes only log entries
                meeting certain characteristics to be preserved. Many log generators offer log rotation
                capabilities; many log files can also be rotated through simple scripts or third-party utilities,
                which in some cases offer features not provided by the log generators.

           –    Log archival is retaining logs for an extended period of time, typically on removable media, a
                storage area network (SAN), or a specialized log archival appliance or server. Logs often
                need to be preserved to meet legal or regulatory requirements. Section 4.2 provides
                additional information on log archival. There are two types of log archival: retention and
                preservation. Log retention is archiving logs on a regular basis as part of standard operational
                activities. Log preservation is keeping logs that normally would be discarded, because they
                contain records of activity of particular interest. Log preservation is typically performed in
                support of incident handling or investigations.




23
      Ensuring that the original logs are not altered supports their use for evidentiary purposes.


                                                                 3-3
