GUIDE TO COMPUTER SECURITY LOG MANAGEMENT



       Severity. Each log message has a severity value assigned, from 0 (emergency) to 7 (debug).28
Syslog uses message priorities to determine which messages should be handled more quickly, such as
forwarding higher-priority messages more quickly than lower-priority ones. However, the priority does
not affect which actions are performed on each message. Syslog can be configured to handle log entries
differently based on each messageâ€™s facility and severity. For example, it could forward severity 0 kernel
messages to a centralized server for further review, and simply record all severity 7 messages without
forwarding them. However, syslog does not offer any more granularity than that in message handling; it
cannot make decisions based on the source or content of a message.

Syslog is intended to be very simple, and each syslog message has only three parts. The first part
specifies the facility and severity as numerical values. The second part of the message contains a
timestamp and the hostname or IP address of the source of the log. The third part is the actual log
message content. No standard fields are defined within the message content; it is intended to be human-
readable, and not easily machine-parseable. This provides very high flexibility for log generators, which
can place whatever information they deem important within the content field, but it makes automated
analysis of the log data very challenging. A single source may use many different formats for its log
message content, so an analysis program would need to be familiar with each format and be able to
extract the meaning of the data within the fields of each format. This problem becomes much more
challenging when log messages are generated by many sources. It might not be feasible to understand the
meaning of all log messages, so analysis might be limited to keyword and pattern searches. Some
organizations design their syslog infrastructures so that similar types of messages are grouped together or
assigned similar codes, which can make log analysis automation easier to perform. Figure 3-1 shows
several examples of syslog messages.



Mar 1 06:25:43 server1 sshd[23170]: Accepted publickey for server2 from
172.30.128.115 port 21011 ssh2

Mar 1 07:16:42 server1 sshd[9326]: Accepted password for murugiah from 10.20.30.108
port 1070 ssh2

Mar 1 07:16:53 server1 sshd[22938]: reverse mapping checking getaddrinfo for
ip10.165.nist.gov failed - POSSIBLE BREAKIN ATTEMPT!

Mar 1 07:26:28 server1 sshd[22572]: Accepted publickey for server2 from
172.30.128.115 port 30606 ssh2

Mar     1 07:28:33 server1 su: BAD SU kkent to root on /dev/ttyp2

Mar     1 07:28:41 server1 su: kkent to root on /dev/ttyp2


                                         Figure 3-1. Examples of Syslog Messages




28
      In practice, some log generators do not use the severity value as originally intended. For example, they could assign
      severity values to denote certain classes of log messages, without any relationship to event severity. The log analysis
      process can be significantly more complex if a syslog server receives messages that have different ways of assigning
      severity values.


                                                                3-6
