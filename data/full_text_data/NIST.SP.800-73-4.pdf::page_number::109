Special Publication 800-73-4                                  Interfaces for Personal Identity Verification â€“ Part 2:
                                                              PIV Card Application Card Command Interface




                                      Figure 2. PIV Data Integrity of Command


  4.2.4     Command with PIV Secure Messaging

For secure messaging, the secure messaging data field shall be constructed as the concatenation of the
following: the BER-TLV encoded encrypted PIV data; 20 the 3-btye BER-TLV encoded L e , as described
in Section 4.2.3, if L e would have been included in a message sent without secure messaging; the 10-byte
BER-TLV encoded C-MAC of the command, as described in Section 4.2.3; and a new L e field, which
shall be one byte and have shall have a value of '00'. 21

The APDU for secure messaging is shown in Figure 3 for the case in which command chaining is not
required. The APDU consists of the CLA byte ('0C'), INS, P1, P2, the length of the secure messaging data
field (L c '), the secure messaging data field, and the new L e field ('00').




20 The data field may be absent in the case of the VERIFY command.
21 Note that the new L field is always included in the command, even if L would have been absent if the command were sent
                      e                                                   e
without secure messaging, since a response is always expected, even if the expected response only consists of the BER-TLV
encoded status word and response MAC (R-MAC).




                                                            34
