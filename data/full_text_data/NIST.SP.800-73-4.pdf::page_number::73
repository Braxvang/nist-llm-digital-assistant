Special Publication 800-73-4                                                             Interfaces for Personal Identity Verification – Part 2:
                                                                                         PIV Card Application Card Command Interface

                                                                 Table of Contents

1.       INTRODUCTION ............................................................................................................................................. 1
     1.1        PURPOSE ..................................................................................................................................................... 1
     1.2        SCOPE ......................................................................................................................................................... 1
     1.3        AUDIENCE AND ASSUMPTIONS .................................................................................................................... 1
     1.4        CONTENT AND ORGANIZATION ................................................................................................................... 2
2.       OVERVIEW: CONCEPTS AND CONSTRUCTS ........................................................................................ 3
        2.1.1 Platform Requirements .......................................................................................................................... 3
     2.2     NAMESPACES OF THE PIV CARD APPLICATION ........................................................................................... 3
     2.3     CARD APPLICATIONS .................................................................................................................................. 4
        2.3.1 Default Selected Card Application......................................................................................................... 4
     2.4     SECURITY ARCHITECTURE .......................................................................................................................... 4
        2.4.1 Access Control Rule ............................................................................................................................... 4
        2.4.2 Security Status........................................................................................................................................ 4
        2.4.3 Authentication of an Individual.............................................................................................................. 5
     2.5     CURRENT STATE OF THE PIV CARD APPLICATION ...................................................................................... 6
3.       PIV CARD APPLICATION CARD COMMAND INTERFACE................................................................. 7
     3.1     PIV CARD APPLICATION CARD COMMANDS FOR DATA ACCESS ................................................................ 8
        3.1.1 SELECT Card Command ....................................................................................................................... 8
        3.1.2 GET DATA Card Command ................................................................................................................ 10
     3.2     PIV CARD APPLICATION CARD COMMANDS FOR AUTHENTICATION ........................................................ 11
        3.2.1 VERIFY Card Command ...................................................................................................................... 11
        3.2.2 CHANGE REFERENCE DATA Card Command ................................................................................. 14
        3.2.3 RESET RETRY COUNTER Card Command ........................................................................................ 15
        3.2.4 GENERAL AUTHENTICATE Card Command .................................................................................... 17
     3.3     PIV CARD APPLICATION CARD COMMANDS FOR CREDENTIAL INITIALIZATION AND ADMINISTRATION .. 19
        3.3.1 PUT DATA Card Command ................................................................................................................ 19
        3.3.2 GENERATE ASYMMETRIC KEY PAIR Card Command .................................................................... 20
4.       SECURE MESSAGING ................................................................................................................................. 22
     4.1     THE KEY ESTABLISHMENT PROTOCOL ...................................................................................................... 22
        4.1.1 Client Application Steps ....................................................................................................................... 23
        4.1.2 PIV Card Application Protocol Steps .................................................................................................. 24
        4.1.3 Notations .............................................................................................................................................. 26
        4.1.4 Cipher Suite ......................................................................................................................................... 26
        4.1.5 Card Verifiable Certificates ................................................................................................................. 27
        4.1.6 Key Derivation ..................................................................................................................................... 29
        4.1.7 Key Confirmation ................................................................................................................................. 29
        4.1.8 Command Interface .............................................................................................................................. 30
     4.2     SECURE MESSAGING ................................................................................................................................. 30
        4.2.1 Secure Messaging Data Objects .......................................................................................................... 31
        4.2.2 Command and Response Data Confidentiality .................................................................................... 31
        4.2.3 Command Integrity .............................................................................................................................. 33
        4.2.4 Command with PIV Secure Messaging ................................................................................................ 34
        4.2.5 Response Integrity ................................................................................................................................ 35
        4.2.6 Response with PIV Secure Messaging ................................................................................................. 36
        4.2.7 Error Handling .................................................................................................................................... 37
     4.3     SESSION KEY DESTRUCTION ..................................................................................................................... 37

APPENDIX A— EXAMPLES OF THE USE OF THE GENERAL AUTHENTICATE COMMAND........... 39
     A.1        AUTHENTICATION OF THE PIV CARD APPLICATION ADMINISTRATOR ...................................................... 39
     A.2        MUTUAL AUTHENTICATION OF CLIENT APPLICATION AND CARD APPLICATION ...................................... 39
     A.3        AUTHENTICATION OF PIV CARDHOLDER .................................................................................................. 40
                                                                                       iv
