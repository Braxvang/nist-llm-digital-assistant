Special Publication 800-85B                                   PIV Data Model Testing Specification


Test Steps              1. Set cardHandle := <<valid card handle>>
                        2. Set OID := <<PIV Digital Signature certificate
                           (2.16.840.1.101.3.7.2.1.0)>>
                        3. Call pivGetData w/
                           • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                        4. Extract validity->notAfter->utcTime field value from
                           the certificate
                        5. Set OID := << CHUID (2.16.840.1.103.3.7.2.48.0)>>
                        6. Call pivGetData with the following parameters
                           • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                        7. Parse the CHUID and extract the expiration date
Expected Result(s)      The expiration date of the digital signature certificate is not beyond the
                        expiration date of the CHUID i.e. the PIV card.


11.2.2.4 Verify RSA exponent

Purpose                 For RSA keys, confirms that the exponent of the RSA asymmetric key
                        for digital signature is greater than or equal to 65,537.
Reference(s)            1.    SP80078, Section 3.1
                        2.    AS07.02.09
Precondition            1.    A valid PIV card is inserted into the contact reader.
                        2.    A valid PC/SC connection exists between the test application and
                              the contact reader.
                        3.    The test application is currently connected to the card application
                              which is accessible through card handle.
                        4.    A digital signature key and corresponding certificate are present on
                              the PIV card.
Test Steps              1. Set cardHandle := <<valid card handle>>
                        2. Set OID := <<Digital Signature Certificate
                           (2.16.840.1.101.3.7.2.1.0)>>
                        3. Call pivGetData w/
                           • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                        4. Extract the subjectPublicKeyInfo->subjectPublicKey
                           from the certificate.
                        5. Parse the exponent from the extracted public key
Expected Result(s)      The exponent of the RSA asymmetric key for digital signature is greater
                        than or equal to 65,537.




                                                                                                Page 128
