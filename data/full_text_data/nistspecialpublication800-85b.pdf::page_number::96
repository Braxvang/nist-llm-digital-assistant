Special Publication 800-85B                                   PIV Data Model Testing Specification


Result(s)             digestAlgorithms field of the SignedData.


10.2.1.9 Verify message digest signed attribute in SignerInfo

Purpose               Confirms that the signedAttrs of the SignerInfo includes a message digest
                      attribute containing the hash computed over the concatenated
                      CBEFF_HEADER and the STD_BIOMETRIC_RECORD
Reference(s)          1.      FIPS201, Section 4.2.2
                      2.      AS06.02.12
Precondition          1.      A valid PIV card is inserted into the contact reader.
                      2.      A valid PC/SC connection exists between the test application and the
                              contact reader.
                      3.      The test application is currently connected to the card application
                              which is accessible through card handle.
                      4.      A valid card holder fingerprint object is present on the PIV card.
Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<Card Holder Fingerprints
                         (2.16.840.1.101.3.7.2.96.16)>>
                      3. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      4. Parse the SignerInfo-> signedAttrs field contents from
                         the CBEFF_SIGNATURE_BLOCK to locate the message digest
                         attribute (OID=1.2.840.113549.1.9.4) and its
                         corresponding attribute value
                      5. Extract the SignerInfo->digestAlgorithm field contents
                         from the CBEFF_SIGNATURE_BLOCK
                      6. Using the digest Algorithm obtained in the previous
                         step, compute the hash over the concatenated
                         CBEFF_HEADER and the STD_BIOMETRIC_RECORD
Expected              The value of the hash obtained from the message digest attribute of the
Result(s)             signedAttrs of the SignerInfo is identical to that obtained after hashing the
                      concatenated contents of the Fingerprint Object buffer, excluding the
                      CBEFF_SIGNATURE_BLOCK.


10.2.1.10 Verify PIV signer distinguished name

Purpose               Confirms that the signedAttrs of the SignerInfo includes the pivSigner-
                      DN attribute containing the subject name that appears in the X.509
                      certificate for the entity that signed the biometrics.
Reference(s)          1.      FIPS201, Section 4.2.2
                      2.      AS06.02.13




                                                                                                     Page 88
