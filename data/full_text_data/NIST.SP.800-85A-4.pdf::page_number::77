NIST SP 800-85A-4                                           PIV CARD APPLICATION & MIDDLEWARE
                                                                     INTERFACE TEST GUIDELINES

                              •   (IN) cardHandle
                              •   (IN) authenticators
                              •   (IN) AuthLength
 Expected Result(s)      Call returns with status_word of PIV_AUTHENTICATOR_MALFORMED.
 Postcondition(s)        The client application is not logged into the PIV Card Application
                         and was not able to update the application security status of the PIV
                         Card Application.

B.4.2.3          Attempt Logon with Invalid Authenticator
 Purpose               Ensure PIV Middleware detects and processes an authenticator that
                       has the correct format but does not result in a valid security
                       permission/context.
 Target                  pivLogIntoCardApplication
 Reference(s)            1.   SP 800-73-4 Part 3, Section 3.2.3
                         2.   AS04.05
 Precondition(s)         1.   The card has established a connection to the client.
                         2.   The cardHandle was properly initialized by pivConnect.
                         3.   The client application has successfully executed the
                              pivSelectCardApplication command.
 Test Steps              1. Set cardHandle := <<a valid cardHandle>>
                         2. Set authenticators := <<a well formed authenticators byte
                            sequence containing an invalid PIN and/or Key Reference
                            value>>
                         3. Call pivLogIntoCardApplication with
                            • (IN) cardHandle
                            • (IN) authenticators
                            • (IN) AuthLength
 Expected Result(s)      Call returns with status_word of PIV_AUTHENTICATION_FAILURE.
 Postcondition(s)        The client application is not logged into the PIV Card Application
                         and was not able to update the application security status of the PIV
                         Card Application.


B.5           pivLogoutOfCardApplication

B.5.1           Valid Test Assertions

B.5.1.1       Log out of the Card Application
 Purpose             Reset security context of the PIV Card Application.
 Target              pivLogoutOfCardApplication
 Reference(s)        1. SP 800-73-4 Part 3, Section 3.2.5
                     2. AS04.01, AS04.02A-R4, AS04.07
 Precondition(s)     1. The client application owns a connection to the PIV Card
                          Application accessible through cardHandle.
                     2. The client is logged into the card application.


                                          B-11
