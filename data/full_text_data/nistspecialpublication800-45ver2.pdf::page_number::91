                                                                                  GUIDELINES ON ELECTRONIC MAIL SECURITY



9.1.2    Log File Review and Retention

Reviewing log files is a tedious and time-consuming task which informs administrators of events that
have already occurred. Accordingly, they are often useful for corroborating other evidence, such as a
CPU utilization spike or anomalous network traffic reported by an IPS. When a log is used to corroborate
other evidence, a focused review is in order. For example, if an IPS reported an inbound connection to
the mail server at 8:17 a.m. that attempted to use the VRFY command, then a review of the logs generated
just before 8:17 a.m. is appropriate. Mail server logs should also be reviewed for indications of attacks or
spamming. The frequency of the reviews depends on the following factors:

 Amount of traffic the server receives
 General threat level (certain sites receive many more attacks than other sites and thus should review
  their logs more frequently)
 Specific threats (at certain times specific threats arise that may require more frequent log file analysis)
 Vulnerability of the mail server
 Value of data and services provided by the mail server.
Reviews should take place regularly (e.g., daily) and when a suspicious activity has been noted or a threat
warning has been issued. Obviously, the task could quickly become burdensome to a mail administrator.
To reduce this burden, automated log analysis tools have been developed (see Section 9.1.3).

In addition, a long-term and more in-depth analysis of the logs is needed. Because a typical mail server
attack can involve hundreds of unique requests, an attacker may attempt to disguise a mail attack by
increasing the interval between requests. In this case, reviewing a single day’s or week’s logs may not
show recognizable trends. However, when trends are analyzed over a week, month, or quarter, multiple
attacks from the same host or subnet can be more easily recognized.

Log files should be protected to ensure that if an attacker does compromise a mail server, the log files
cannot be altered to cover the attack. Although encryption can be useful in protecting log files, the best
solution is to store log files on a host separate from the mail server. This is often called a centralized
logging server. Centralized logging is often performed using syslog, which is a standard logging
protocol. 57 Alternately, some organizations use security information and event management (SIEM)
software that uses centralized servers to perform log analysis, database servers to store logs, and agents
installed on each host to parse particular types of logs, such as mail server logs, and transfer their data to
the centralized servers. 58

Log files should be backed up and archived regularly. Archiving log files for a period of time is
important for several reasons, including supporting certain legal actions and troubleshooting problems
with the mail server. The retention period for archived log files depends on a number of factors,
including:

 Legal requirements
 Organizational requirements


57
     Syslog is defined in IETF RFC 3164, The BSD Syslog Protocol, which is available at http://www.ietf.org/rfc/rfc3164.txt.
58
     More information on syslog and SIEM implementations is provided in NIST SP 800-92, Guide to Computer Security Log
     Management, which is available at http://csrc.nist.gov/publications/nistpubs/

                                                             9-3
