NIST SP 800-166                                                                       DERIVED PIV APPLICATION AND
                                                                                      DATA MODEL TEST GUIDELINES

                                       •    Data field in the command is to include one of
                                            the following:
                                             1. If P1 = '07', the template '81' contains a
                                                key encrypted using the key management public
                                                key returned in Step 6.
                                             2. If P1 = '11' or '14', the template '85'
                                                contain the other party’s public key. 15
 Expected Result(s)           1. From Step 1, the command returns the application property template
                                  with the status word '90 00'.
                              2. From Step 2, 3, and 4, the command returns status word '69 82'
                                  (security status not satisfied).
                              3. From Step 5, the test results are consistent with those expected as
                                  part of TA-08.03.03.03:
                                      a. From Step 1 of TA-08.03.03.03, the command returns the
                                           application property template with the status word '90 00'.
                                      b. From Step 2 of TA-08.03.03.03, the command returns with
                                           the witness followed by status word '90 00'.
                                      c. From Step 3 of TA-08.03.03.03, the Derived PIV
                                           Application verifies the decrypted witness and then responds
                                           with encryption of the challenge sent by Test Toolkit
                                           Application followed by status word '90 00'. Decrypt the
                                           encrypted challenge and compare it to the one sent to the
                                           token.
                              4. From Step 6, the commands return status word '90 00' and the data
                                  field contains the '7F49' template with the generated public key,
                                  which consists of either a modulus and public exponent (RSA) or a
                                  point (elliptic curve cryptography).
                              5. From Step 7, the command returns status word '6A 80' (incorrect
                                  parameter command data field).
                              6. From Step 8, the command returns status word '6A 86' (incorrect
                                  parameter P2).
                              7. From Step 9, the command returns status word '90 00'.
                              8. From Step 10, the command returns the signed challenge with status
                                  word '90 00'. Verify the signed challenge using the Derived PIV
                                  Authentication public key that was returned in Step 6.
                              9. From Step 11, the command returns the signed challenge with status
                                  word '90 00'. Verify the signed challenge using the digital signature
                                  public key that was returned in Step 6.
                              10. From Step 12, for algorithm reference '07' as P1 value, the command
                                  returns the transported key with status word '90 00'. Compare the
                                  test toolkit application’s copy of the plaintext key to the one
                                  received in the response from the token. For algorithm reference '11'
                                  or '14' as P1 value, the command returns the shared secret Z 16 with

15
   Template '85' contains the other party’s public key, a point on Curve P-256 or P-384, encoded as '04' || X || Y,
without the use of point compression, as described in Section 2.3.3 of [SEC1].
16
   Z is the X coordinate of point P as defined in [SP800-56A], Section 5.7.1.2




                                                          86
