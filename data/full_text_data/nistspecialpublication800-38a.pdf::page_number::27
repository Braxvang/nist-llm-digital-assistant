Appendix C: Generation of Initialization Vectors

The CBC, CFB, and OFB modes require an initialization vector as input, in addition to the
plaintext. An IV must be generated for each execution of the encryption operation, and the same
IV is necessary for the corresponding execution of the decryption operation. Therefore, the IV, or
information that is sufficient to calculate the IV, must be available to each party to the
communication.

The IV need not be secret, so the IV, or information sufficient to determine the IV, may be
transmitted with the ciphertext.

For the CBC and CFB modes, the IVs must be unpredictable. In particular, for any given
plaintext, it must not be possible to predict the IV that will be associated to the plaintext in
advance of the generation of the IV.

There are two recommended methods for generating unpredictable IVs. The first method is to
apply the forward cipher function, under the same key that is used for the encryption of the
plaintext, to a nonce. The nonce must be a data block that is unique to each execution of the
encryption operation. For example, the nonce may be a counter, as described in Appendix B, or
a message number. The second method is to generate a random data block using a FIPS-
approved random number generator.

For the OFB mode, the IV need not be unpredictable, but it must be a nonce that is unique to
each execution of the encryption operation. For example, the nonce may be a counter, as
described in Appendix B, or a message number.

If, contrary to this requirement, the same IV is used for the OFB encryption of more than one
message, then the confidentiality of those messages may be compromised. In particular, if a
plaintext block of any of these messages is known, say, the jth plaintext block, then the jth output
of the forward cipher function can be determined easily from the jth ciphertext block of the
message. This information allows the jth plaintext block of any other message that is encrypted
using the same IV to be easily recovered from the jth ciphertext block of that message.

Confidentiality may similarly be compromised if any of the input blocks to the forward cipher
function for the OFB encryption of a message is designated as the IV for the encryption of
another message under the given key. One consequence of this observation is that IVs for the
OFB mode should not be generated by invoking the block cipher on another IV.

Validation that an implementation of the CBC, CFB, or OFB mode conforms to this
recommendation will typically include an examination of the procedures for assuring the
unpredictability or uniqueness of the IV.




                                                20
