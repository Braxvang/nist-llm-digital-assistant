NIST SP 800-58                                             Voice Over IP Security
    _________________________________________________________________________

       Encryption/decryption latency is a problem for any cryptographic protocol,
       because much of it results from the computation time required by the underlying
       encryption. With VOIP’s use of small packets at a fast rate and intolerance for
       packet loss, maximizing throughput is critical. However
       , this comes with a price, because although DES is the fastest of these encryption
       algorithms, it is also the easiest to crack. Current rules prohibit the use of DES for
       protection of US Government information. Thus, designers are once again forced
       to toe the line between security and voice quality. Two solutions to this problem
       are using faster encryption algorithms (9.3) and incorporating QoS into the
       crypto-engine (9.4). Latency is less of a problem for management and/or
       signaling data than for voice channel traffic.


 8.6   Scheduling and the Lack of QoS in the Crypto-Engine

       The crypto-engine is a severe bottleneck in the VOIP network. As just noted, the
       encryption process has a debilitating effect on QoS, but this is not the highest
       degree factor in the slowdown. Instead, the driving force behind the latency
       associated with the crypto-engine is the scheduling algorithm for packets that
       entered the encryption/decryption process. While routers and firewalls take
       advantage of QoS to determine priorities for packets, crypto-engines provide no
       support for manual manipulation of the scheduling criteria. In ordinary data
       traffic this is less of an issue because inordinately more packets pass through the
       router than the crypto-engine, and time is not as essential. But in VOIP, a
       voluminous number of small packets must pass through both the crypto engine
       and the router. Considering the time urgency issues of VOIP, the standard FIFO
       scheduling algorithm employed in today’s crypto-engines creates a severe QoS
       issue.

       Barbieri et al. found that the throughput of the crypto scheduling algorithm
       actually increased with larger packet sizes. They concluded that scheduling a
       greater number of packets had a more degrading effect on performance than
       encrypting/decrypting fewer (but larger) packets. So with the numerous small
       packets VOIP uses, the crypto engine soon reaches the saturation point, and
       throughput is compromised. This accounts for the asymptotic behavior of the
       throughput for encrypted traffic against plain traffic’s continuous rise and the
       increased delay of encrypted traffic that Barbieri et al. observed.

       These QoS violations derived from the crypto-engine are exacerbated by the
       presence of actual data traffic on a VOIP network. Since one of the primary
       motivations for the development of VOIP is the ability of voice and data to share
       the same network, this scenario is to be expected. Barbieri et al.’s experiments
       showed that such a combination of traffic has disastrous effects on VOIPsec. This
       is especially true if the heterogeneous data needs to be encrypted and decrypted.
       Since the crypto-engine has no functionality for changing its own priority schema
       based on the type of traffic it is presented with, the VOIP packets are at the mercy
       of the FIFO scheduling algorithm, and are often left waiting behind larger


                                                                                           67
