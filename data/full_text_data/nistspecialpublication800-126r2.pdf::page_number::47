               The Technical Specification for the Security Content Automation Protocol (SCAP): SCAP Version 1.2



The <dsig:Signature> element MUST follow the recommendations in [TMSAD] and these
additional requirements:
    1. A <dsig:SignatureProperties> element MUST be included in the
       <dsig:Signature> element. At least one <dsig:SignatureProperty> element
       MUST be populated with <dt:signature-info> as specified in [TMSAD].
    2. The first <dsig:Reference> element in a <dsig:Signature> element MUST be to the
       <arf:asset-report-collection> element. The element MUST be referenced in the
       @URI attribute using the empty string convention “”.
    3. Two XPath Filter 2 transforms MUST exist on the first <dsig:Reference> element in a
       <dsig:Signature> element. Both MUST specify a filter type of “subtract”. The first
       transform MUST specify the XPath “/arf:asset-report-collection/arf:extended-
       infos[count(arf:extended-info[dsig:Signature]) = count(*)]”. The second transform MUST specify
       the XPath “/arf:asset-report-collection/arf:extended-infos/arf:extended-info[dsig:Signature]”. In
       both cases, the namespace prefix “arf” MUST map to the ARF namespace specified in this
       document.
    4. The second <dsig:Reference> element MUST be to the
       <dsig:SignatureProperties> element captured in a <dsig:Object> element with
       the <dsig:Signature> element. The <dsig:SignatureProperties> element MUST
       be referenced in the @URI attribute using “#” + @Id of the
       <dsig:SignatureProperties> element.
    5. Key information SHOULD be provided on the <dsig:Signature> element.
In situations where it is desirable to countersign a result data stream (e.g., when a content consumer
automatically signs a result data stream and then a person also wants to sign the results), the following
requirements apply.
    1. The <arf:extended-info> element containing the original signature SHALL be removed
       from the resulting document.
    2. The original signature SHALL be captured as a <dsig:Object> element on the new
       <dsig:Signature> element.
    3. The first <dsig:Reference> element on the new <dsig:Signature> element SHALL
       reference the <dsig:Object> element containing the original signature. The
       <dsig:Object> element MUST be referenced in the @URI attribute using “#” + @Id of the
       <dsig:Object> element.
    4. The second <dsig:Reference> element MUST be to the
       <dsig:SignatureProperties> element captured in a <dsig:Object> element with
       the <dsig:Signature> element. The <dsig:SignatureProperties> element MUST
       be referenced in the @URI attribute using “#” + @Id of the
       <dsig:SignatureProperties> element.
    5. A <dsig:SignatureProperties> element MUST be included in the
       <dsig:Signature> element. At least one <dsig:SignatureProperty> element
       MUST be populated with <dt:signature-info> as specified in [TMSAD].
    6. Key information SHOULD be provided on the <dsig:Signature> element in accordance
       with [TMSAD].



                                                      40
