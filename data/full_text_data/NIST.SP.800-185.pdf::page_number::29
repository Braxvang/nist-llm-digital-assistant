                                                                                             NIST SP 800-185                                              SHA-3 DERIVED FUNCTIONS: CSHAKE,
                                                                                                                                                         KMAC, TUPLEHASH, AND PARALLELHASH

                                                                                             TupleHash256(X, L, S):
                                                                                             Validity Conditions: 0 ≤ L < 22040 and len(S) < 22040

                                                                                             1. z = "".
                                                                                             2. n = the number of input strings in the tuple X.
                                                                                             3. for i = 1 to n:
                                                                                                    z = z || encode_string(X[i]).
                                                                                             4. newX = z || right_encode(L).
                                                                                             5. T = bytepad(encode_string(“TupleHash”) || encode_string(S), 136).
                                                                                             6. return KECCAK[512](T || newX || 00, L).

                                                                                             TupleHashXOF128(X, L, S):
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-185




                                                                                             Validity Conditions: 0 ≤ L and len(S) < 22040

                                                                                             1. z = "".
                                                                                             2. n = the number of input strings in the tuple X.
                                                                                             3. for i = 1 to n:
                                                                                                    z = z || encode_string(X[i]).
                                                                                             4. newX = z || right_encode(0).
                                                                                             5. T = bytepad(encode_string(“TupleHash”) || encode_string(S), 168).
                                                                                             6. return KECCAK[256](T || newX || 00, L).

                                                                                             TupleHashXOF256(X, L, S):
                                                                                             Validity Conditions: 0 ≤ L and len(S) < 22040

                                                                                             1. z = "".
                                                                                             2. n = the number of input strings in the tuple X.
                                                                                             3. for i = 1 to n:
                                                                                                    z = z || encode_string(X[i]).
                                                                                             4. newX = z || right_encode(0).
                                                                                             5. T = bytepad(encode_string(“TupleHash”) || encode_string(S), 136).
                                                                                             6. return KECCAK[512](T || newX || 00, L).

                                                                                             ParallelHash128(X, B, L, S):
                                                                                             Validity Conditions: 0 < B < 22040 and ⌈ len(X)/B ⌉ < 22040 and
                                                                                                                  0 ≤ L < 22040 and len(S) < 22040

                                                                                             1. n = ⌈ (len(X)/8) / B ⌉.
                                                                                             2. z = left_encode(B).
                                                                                             3. for i = 0 to n−1:
                                                                                                    z = z || KECCAK[256]( substring(X, i*B*8, (i+1)*B*8) || 1111, 256).
                                                                                             4. z = z || right_encode(n) || right_encode(L).
                                                                                             5. newX = z.
                                                                                             6. T = bytepad(encode_string(“ParallelHash”) || encode_string(S), 168).
                                                                                             7. return KECCAK[256](T || newX || 00, L).

                                                                                             ParallelHash256(X, B, L, S):

                                                                                                                                             23
