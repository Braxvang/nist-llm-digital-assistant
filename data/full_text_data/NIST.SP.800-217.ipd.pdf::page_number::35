      NIST SP 800-217 ipd                          Guidelines for PIV Federation (Initial Public Draft)
      January 2023


903       • Certificate Subject Distinguished Name Field: The Subject Distinguished Name
904         field of the subscriber’s current PIV authentication certificate
905   Any given RP does not necessarily have access to all attributes made available by
906   an IdP. The subject identifier (and therefore the federated identifier), issuing agency,
907   organizational affiliations, and last updated timestamp SHALL be disclosed as part of all
908   trust agreements in PIV federations. All other subscriber account attributes are subject to
909   the trust agreement in place between the IdP and RP, including disclosures of use between
910   the parties.
911   Except as otherwise stated in Sec. 6.2, the IdP SHOULD disclose attributes through an
912   identity API rather than through the assertion itself. For example, in OpenID Connect,
913   while it is possible to include subscriber attributes such as name and email within the ID
914   token (the assertion), it is preferable to make such attributes available from the UserInfo
915   Endpoint (an identity API). When attributes are available for a given account through
916   more than one method at an IdP, the attribute values SHALL match.
917   A PIV IdP SHOULD allow for selective disclosure of attributes to different RPs, as
918   determined by the authorized party listed in the trust agreement.

919   6.2. Assertion Contents
920   As specified in [SP800-63C], the successful validation of a federated assertion is required
921   to begin an authenticated session at the RP. The assertion contains a combination of
922   attributes about the subscriber as well as attributes about the authentication event that
923   the assertion represents.
924   At minimum, the assertion in PIV federation SHALL contain the following attributes of
925   the PIV identity account:
926       • Flag indicating that this assertion represents a PIV federation transaction
927       • Last updated timestamp for the PIV identity account
928       • Identifier for the issuing agency of the PIV identity account
929       • IAL for the PIV identity account (which is IAL3)
930       • Federated identifier for the PIV identity account at this IdP, as defined in Sec. 6.2.1
931   As an assertion is a short-lived message from the IdP to the RP, the assertion itself
932    SHOULD contain only the minimum attributes required for its processing. To preserve
933   privacy and minimize the information sent with each request, the assertion SHOULD NOT
934   contain non-required or stable attributes from the PIV identity account, such as email
935   address or display name. Additional attributes SHOULD be available to the RP through a
936   standard identity API.
937   At minimum, the assertion in PIV federation SHALL contain the following attributes of
938   the authentication event:

                                                   25
