                                                                                                NIST SP 800-175B REV. 1                        GUIDELINE FOR USING CRYPTO STANDARDS IN THE
                                                                                                                                                            FED. GOV'T.: CRYPTO MECHANISMS
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-175Br1




                                                                                                                          Figure 6: Key Agreement Example
                                                                                                Figure 6 provides an example of a key-agreement scheme where the responder uses a static
                                                                                                key pair during the scheme, and the initiator uses an ephemeral key pair. Note that other
                                                                                                key-agreement schemes may use other arrangements of key pairs (e.g., each party could
                                                                                                use a static key pair, or each party could use an ephemeral key pair). In the example
                                                                                                provided in the figure above, the responder's private key is retained by the responder (who
                                                                                                is the owner of the key pair), but the responder's public key may be provided to anyone. In
                                                                                                this example, the public key is provided to the initiator.
                                                                                                  1. The initiator obtains the responder's public key (e.g., from a CA or directly from the
                                                                                                     responder); for this scheme, this public key is the responder’s contribution to the
                                                                                                     key-agreement process.
                                                                                                  2. The initiator then generates a short-term key pair (i.e., an ephemeral key pair) and
                                                                                                     sends the ephemeral public key to the responder, retaining the ephemeral private key
                                                                                                     for himself. The ephemeral public key is the initiator’s contribution to the key-
                                                                                                     agreement process for this scheme.
                                                                                                  3. Both parties use their own key pair and the other party's public key to generate a
                                                                                                     shared secret.
                                                                                                  4. Both parties then use their copy of the shared secret to derive one or more keys that
                                                                                                     are (hopefully) identical.
                                                                                                Key confirmation is an optional but highly recommended step that provides assurance that
                                                                                                both parties now have the same (identical) key(s) and is shown in Figure 6 for the case that
                                                                                                the initiator receives key confirmation from the responder. See SP 800-56A and SP 800-
                                                                                                56B for further information.
                                                                                                SP 800-56A specifies Diffie−Hellman (DH) and MQV key-agreement schemes using finite
                                                                                                field or elliptic curve mathematics and asymmetric key pairs to generate the shared secret
                                                                                                (see Section 3.3.2.1 above), and SP 800-56B specifies two RSA key-agreement schemes


                                                                                                                                            53
