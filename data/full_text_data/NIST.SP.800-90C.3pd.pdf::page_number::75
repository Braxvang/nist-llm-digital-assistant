       NIST SP 800-90C 3pd (Third Public Draft)                       Recommendation for RBG Constructions
       September 2022

2104   reseeding for RBG3 operations use RBG3 function calls (see Sections 6.2 and 6.3), while
2105   generation and reseeding for direct DRBG access use RBG2 function calls (see Section 5.2) with
2106   the RBG3_state_handle. Using the same instantiation for both RBG3 operation and direct access
2107   to the DRBG requires additional reseeding processes in the case of an RBG3(RS) construction
2108   (see Section 6.3.2).
2109   In the rightmost example in Figure 19, different internal states are used by the RBG3 construction
2110   and a directly accessible DRBG. The DRBG implementation is instantiated twice – once for RBG3
2111   operations and a second time for direct access to the DRBG. A different state handle needs to be
2112   obtained for each instantiation (e.g., RBG3_state_handle and DRBG_state_handle). Generation
2113   and reseeding for RBG3 operations use RBG3 function calls and RBG3_state_handle (see Sections
2114   6.2 and 6.3), while generation and reseeding for direct DRBG access use RBG2 function calls and
2115   DRBG_state_handle (see Section 5.2).
2116   Multiple directly accessible DRBGs may also be incorporated into an implementation by creating
2117   multiple instantiations. However, no more than one directly accessible DRBG should share the
2118   same internal state with the RBG3 construction (i.e., if n directly accessible DRBGs are required,
2119   either n or n− 1 separate instantiations are required).
2120   The directly accessed DRBG instantiations are in the same security boundary as the RBG3
2121   construction. When accessed directly (rather than operating as part of the RBG3 construction), the
2122   DRBG instantiations are considered to be operating as RBG2(P) constructions as discussed in
2123   Section 5.

2124   B.2.    Example of an RBG1 Construction
2125   An RBG1 construction has access to a randomness source only during instantiation when it is
2126   seeded (see Section 4). For this example (see Figure 20), the DRBG used by the RBG1 construction
2127   and the randomness source reside in two different cryptographic modules with a secure channel
2128   connecting them during the instantiation process. Following DRBG instantiation, the secure
2129   channel is not available. For this example, the randomness source is an RBG2(P) construction (see
2130   Section 5) with a state handle of RBG2_state_handle.
2131   The targeted security strength for the RBG1 construction is 256 bits, so a DRBG from [SP800-
2132   90A] that is able to support this security strength must be used (HMAC_DRBG using SHA-256 is
2133   used in this example). A personalization_string is provided during instantiation, as recommended
2134   in Section 2.4.1.
2135   As discussed in Section 4, the randomness source (i.e., the RBG2(P) construction for this example)
2136   is not available during normal operation, so reseeding and prediction resistance cannot be
2137   provided.
2138   This example provides an RBG that is instantiated at a security strength of 256 bits.




                                                       62
