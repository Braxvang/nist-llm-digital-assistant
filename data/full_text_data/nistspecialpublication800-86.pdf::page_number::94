GUIDE TO INTEGRATING FORENSIC TECHNIQUES INTO INCIDENT RESPONSE



records of the e-mail. This information will be helpful to investigators in determining who sent the e-
mail. Because e-mail can be forged easily, it is important to use all available data sources to reconstruct
the sequence of events for creating, sending, and receiving the e-mail. Also, the incident handler needs to
perform all work using forensically sound tools, techniques, and procedures, and to document all actions
performed.

The threatening e-mail is key to the investigation, and its header contains the most important information
to the incident handler. It should contain the domain name and the IP address of the host that sent the e-
mail, the type of e-mail client used to send the e-mail, the e-mail’s message ID, and the date and time the
e-mail was sent. The e-mail header should also list each e-mail server (domain name and IP address) that
the message passed through and the date and time each server processed the e-mail.127 Because the e-mail
was supposedly sent using the organization’s e-mail system, the e-mail header should only list systems
within the organization. Assuming that this is the case, the incident handler can check each system on the
list for correlating information.

Because of the importance of the threatening e-mail, the incident handler should focus first on collecting a
copy of the e-mail, including its header. Depending on the type of e-mail client used by the recipient and
its configuration, the e-mail may have been downloaded to the recipient’s workstation, or it may remain
on the e-mail server. It is also possible that the e-mail is still stored in both locations. The incident
handler should collect copies of the e-mail from multiple sources, if possible, to confirm that the content
of the e-mail has been unchanged in transit or by the recipient.

After reviewing the header, the incident handler should next gather more information about the sending of
the e-mail. The header should list the IP address and the e-mail client used by the sender; the incident
handler should determine which host was using that IP address at the time the e-mail was sent. There are
three possibilities for the IP address:

      ! Local E-mail Client. In this case, the incident handler should be able to use network records,
        such as DHCP logs, to identify the desktop, laptop, PDA, or other device used to send the e-mail.
        The incident handler can then create images of the identified device and examine an image copy
        to look for malware and for records related to the e-mail. For example, the e-mail client might be
        configured to keep a copy of each e-mail that it sends, or the user might have saved drafts of the
        e-mail message. If the message cannot be found intact on the system, collecting data from the
        device’s memory and filesystems, including deleted and temporary files, might lead to the
        identification of fragments of the e-mail. In addition, security controls on the device, such as
        spam filtering and antivirus software, might have scanned the outgoing e-mail and logged a
        record of it. It is also possible, but unlikely, that a copy of the e-mail is stored on an e-mail
        server. In addition to looking for records of the e-mail on the local host, the incident handler
        should analyze the authentication records on the host to determine which user account was in use
        when the e-mail was sent.
      ! Server-Based E-mail Client. If the organization offers a server-based client, such as a Web-
        based e-mail interface, then the IP address may correspond to that server. Typically, the use of
        such a server requires users to authenticate themselves, so there may be authentication records
        that indicate when the alleged sender logged on to the server and what IP address the user’s
        system was using. The incident handler can then determine which system was assigned that IP
        address at the time, perform bit stream imaging for the identified system, and examine a copy of


127
      Within the e-mail header, these records are stored in reverse order, so the most recent record occurs first and the least recent
      record occurs last. If an e-mail has been forged, the false records are the least recent, so they should appear last in the
      header.


                                                                 8-4
