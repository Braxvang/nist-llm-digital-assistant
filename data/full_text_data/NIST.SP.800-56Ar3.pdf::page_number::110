                                                                                               NIST SP 800-56A Rev. 3                                Recommendation for Pair-Wise Key Establishment
                                                                                                                                                             Using Discrete Logarithm Cryptography

                                                                                               Note: Key confirmation can be incorporated into this scheme. See Section 6.2.2.3 for
                                                                                               details.
                                                                                               dhOneFlow is summarized in Table 19.
                                                                                                                Table 19: dhOneFlow key-agreement scheme summary

                                                                                                                                    Party U                                Party V

                                                                                                Domain                  (p, q, g{, SEED, counter})          (p, q, g{, SEED, counter})
                                                                                                parameters

                                                                                                                        N/A                                 Static private key xV
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-56Ar3




                                                                                                Static data
                                                                                                                                                            Static public key yV

                                                                                                                        Ephemeral private key rU            N/A
                                                                                                Ephemeral data
                                                                                                                        Ephemeral public key tU

                                                                                                                        Compute Z by calling FFC DH Compute Z by calling FFC DH using
                                                                                                Computation
                                                                                                                        using rU and yV             xV and tU

                                                                                                                        1. Compute                          1. Compute
                                                                                                Derive secret              DerivedKeyingMaterial               DerivedKeyingMaterial
                                                                                                material
                                                                                                                        2. Destroy Z                        2. Destroy Z

                                                                                               6.2.2.2 (Cofactor) One-Pass Diffie-Hellman, C(1e, 1s, ECC CDH) Scheme
                                                                                               This section describes the One-Pass Diffie-Hellman scheme. Assurance of secure key
                                                                                               establishment using this scheme can only be obtained when the assumptions in Section 6.2.2
                                                                                               are true. In particular, it is assumed that party U has obtained the static public key Qs,V of
                                                                                               party V.
                                                                                               In this scheme, each party has different actions, which are presented separately below.
                                                                                               However, note that parties U and V must use identical orderings of the bit strings that are
                                                                                               input to the key-derivation method.
                                                                                               Party U shall execute the following actions to a) establish a shared secret value Z with party
                                                                                               V, and b) derive secret keying material from Z.
                                                                                               Actions: Party U generates a shared secret and derives secret keying material as follows:
                                                                                                  1. Generate an ephemeral key pair (de,U, Qe,U) from the domain parameters D as specified
                                                                                                     in Section 5.6.1.2. Send the public key Qe,U to party V.
                                                                                                  2. Use the ECC CDH primitive in Section 5.7.1.2 to derive a shared secret Z from the
                                                                                                     set of domain parameters D, party U’s ephemeral private key de,U, and party V’s static
                                                                                                     public key Qs,V. If this call to the ECC CDH primitive outputs an error indicator,
                                                                                                     destroy the ephemeral private key de,U, and destroy the results of all intermediate


                                                                                                                                               99
