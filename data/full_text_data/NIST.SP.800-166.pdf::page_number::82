NIST SP 800-166                                                   DERIVED PIV APPLICATION AND
                                                                  DATA MODEL TEST GUIDELINES

                      4. Obtain number of remaining retries of the '80' key
                         reference by sending the VERIFY command with
                            • P2, key reference value, is set to '80'
                            • P1 parameter is '00' and both L c and the data
                               field are absent
                      5. Send the VERIFY command with
                            • P2, key reference value, is set to '80'
                            • Data field of the command contains the new
                               password value, padded with 'FF' (if necessary)
                               to complete the total length of the value to 8
                               bytes
 Expected Result(s)   1. From Step 1, the command returns the application property template
                         with the status word '90 00'.
                      2. From Step 2, the command returns status word '63 CX' (where 'X' is
                         the number of retries remaining). The retry counter is decremented
                         by 1.
                      3. From Step 3, the command returns status word '90 00'.
                      4. From Step 4, the command returns status word '63 CX' (where 'X' is
                         the number of retries remaining). Verify that 'X' from this step is
                         greater than 'X' from Step 2 and is equal to the reset retry value.
                      5. From Step 5, the command returns status word '90 00'.
 Postcondition(s)     The Derived PIV Application Password has been changed.

8.3.6.2 Reset Retry Counter with an Invalid Key Reference

 Test Assertion       TA-08.03.06.02
 Purpose              Verifies that the Derived PIV Application responds appropriately to the
                      RESET RETRY COUNTER command for an invalid key reference.
 DTR(s)               • DTR-06.02.02.09
                      • DTR-06.03.01.01
                      • DTR-06.03.07.01
 Vendor               None.
 Documentation
 Precondition(s)      •   A token with the Derived PIV Application is inserted into an
                          appropriate token reader.
                      •   Suitable drivers have been loaded between the test system and an
                          instance of the reader.
                      •   The PUK is recorded.
 Test Scenario        1. Send the SELECT command with
                            • AID == 'A0 00 00 03 08 00 00 20 00 01 00'
                      2. Send the RESET RETRY COUNTER command with
                            • P2, key reference value, is set to a value other
                               than '80'
                            • Data field of the command contains the PUK value
                               for key reference '80', concatenated without
                               delimitation with a valid new password padded




                                            75
