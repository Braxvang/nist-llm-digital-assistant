          This publication is available free of charge from http://dx.doi.org/10.6028/NIST.SP.800-147B

                                                                       BIOS PROTECTION GUIDELINES FOR SERVERS
In this example, to initiate a BIOS update, system management software on the host can interact with the
SP to send a BIOS update image to be stored in the SP environment for later access by BIOS.
Alternatively, the candidate BIOS update image can arrive at the SP through out of band communication
via the SP Ethernet.

The RTU, implemented as part of the system BIOS, gets control of the host side at system reset. All SPI
flash sectors are unlocked at system reset. Within the system flash, the RTU is not separated from the
remainder of the system BIOS. The system BIOS, prior to executing untrusted code (e.g., Option ROMs)
is the RTU. It communicates with the SP to check for a candidate BIOS update image. If one exists, it is
read from the SP into host memory (which is only writable by the system BIOS during RTU execution)
and performs verification. If the BIOS update image is authentic, the system BIOS performs the update of
the system flash via interaction with the SPI flash controller. At completion of the BIOS update, the
system BIOS forces a system reset and restarts execution from the new image.

If the SP indicated that no candidate BIOS update image existed, or if the candidate BIOS update image
failed verification, BIOS locks the BIOS flash memory via SPI controller interaction to “lock until reset”
the sectors containing the BIOS image. When the lock is set, the access to this SPI sector lock register
becomes read-only so that the “lock until reset” setting itself cannot be modified. This sector lock is done
prior to exiting the RTU portion of the BIOS.




                                                     C-2
