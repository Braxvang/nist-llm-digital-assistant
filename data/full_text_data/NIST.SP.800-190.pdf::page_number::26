                                                                                             NIST SP 800-190                                               APPLICATION CONTAINER SECURITY GUIDE


                                                                                             3.1.3    Embedded malware

                                                                                             Because images are just collections of files packaged together, malicious files could be included
                                                                                             intentionally or inadvertently within them. Such malware would have the same capabilities as
                                                                                             any other component within the image and thus could be used to attack other containers or hosts
                                                                                             within the environment. A possible source of embedded malware is the use of base layers and
                                                                                             other images provided by third parties of which the full provenance is not known.

                                                                                             3.1.4    Embedded clear text secrets

                                                                                             Many apps require secrets to enable secure communication between components. For example, a
                                                                                             web app may need a username and password to connect to a backend database. Other examples
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-190




                                                                                             of embedded secrets include connection strings, SSH private keys, and X.509 private keys.
                                                                                             When an app is packaged into an image, these secrets can be embedded directly into the image
                                                                                             file system. However, this practice creates a security risk because anyone with access to the
                                                                                             image can easily parse it to learn these secrets.

                                                                                             3.1.5    Use of untrusted images

                                                                                             One of the most common high-risk scenarios in any environment is the execution of untrusted
                                                                                             software. The portability and ease of reuse of containers increase the temptation for teams to run
                                                                                             images from external sources that may not be well validated or trustworthy. For example, when
                                                                                             troubleshooting a problem with a web app, a user may find another version of that app available
                                                                                             in an image provided by a third party. Using this externally provided image results in the same
                                                                                             types of risks that external software traditionally has, such as introducing malware, leaking data,
                                                                                             or including components with vulnerabilities.

                                                                                             3.2     Registry Risks

                                                                                             3.2.1    Insecure connections to registries

                                                                                             Images often contain sensitive components like an organizationâ€™s proprietary software and
                                                                                             embedded secrets. If connections to registries are performed over insecure channels, the contents
                                                                                             of images are subject to the same confidentiality risks as any other data transmitted in the clear.
                                                                                             There is also an increased risk of man-in-the-middle attacks that could intercept network traffic
                                                                                             intended for registries and steal developer or administrator credentials within that traffic, provide
                                                                                             fraudulent or outdated images to orchestrators, etc.

                                                                                             3.2.2    Stale images in registries

                                                                                             Because registries are typically the source location for all the images an organization deploys,
                                                                                             over time the set of images they store can include many vulnerable, out-of-date versions. While
                                                                                             these vulnerable images do not directly pose a threat simply by being stored in the registry, they
                                                                                             increase the likelihood of accidental deployment of a known-vulnerable version.

                                                                                             3.2.3    Insufficient authentication and authorization restrictions

                                                                                             Because registries may contain images used to run sensitive or proprietary apps and to access
                                                                                             sensitive data, insufficient authentication and authorization requirements can lead to intellectual

                                                                                                                                              14
