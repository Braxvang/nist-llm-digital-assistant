                                                            GUIDE TO INTRUSION DETECTION AND PREVENTION SYSTEMS (IDPS)



     methodology. 56 Typically it takes a combination of carefully selected tools and custom-written attack
     scripts to build a reasonable test suite. Each tool and script should be reviewed and tested to ensure
     that it performs the tests properly.
 Lab Environment Resources. Organizations performing IDPS testing in lab environments typically
  need to expend considerable resources in setting up the lab environments. Attacker and victim
  systems need to be set up and configured. The victim systems need to run the OSs, services, and
  applications targeted by the attacks. Depending on the methodologies used by the IDPSs, the victim
  systems may need to have all the vulnerabilities exploited by the attacks. Some IDPSs might alert
  only on attacks that they think will be successful; also, some attacks will stop executing if they do not
  detect exploitable vulnerabilities. Evaluators also need to be aware of the capabilities of the IDPSs;
  for example, an IDPS might see a few attacks from a single attacker system and automatically
  perform prevention actions to stop all future attacks from that system.
 Product Equivalence. Most IDPS products need to be tuned and customized to meet the
  requirements of the organization. Each product is configured somewhat differently by default, so
  organizations performing IDPS testing should attempt to tune and customize the products so that they
  are as similar as possible. For example, thresholds such as the number of failed login attempts
  permitted in a certain time period should be set to the same values. Also, each detection feature
  should be enabled or disabled consistently on all the IDPSs. This is often very difficult to
  accomplish—for example, a product performing signature-based detection tends to have settings
  based on specific exploits being performed, while a product performing stateful protocol analysis
  detection often has settings based on specific vulnerabilities being exploited. Evaluators would need
  to map the exploits and vulnerabilities to determine the equivalent settings on different IDPSs.
9.6.2     Recommendations for Performing IDPS Evaluations

The challenges in performing in-depth hands-on IDPS testing often make it infeasible; however,
performing some amount of IDPS testing is generally quite helpful in evaluating how well IDPSs meet an
organization’s requirements for security capabilities, performance, and operation and maintenance. IDPS
testing is also helpful in setting realistic expectations for the capabilities of the products and the amount
of labor required to maintain and monitor them in the organization’s environment. Accordingly,
organizations should consider using a combination of several data sources, such as limited product
testing, vendor-provided information, third-party product reviews, and individuals’ previous IDPS
experience, when performing IDPS product evaluations. For example, organizations could use data
sources other than product testing to narrow the product selection to only a few choices, and then perform
limited testing of those choices only. In some cases, omitting product testing and performing a paper-
only evaluation of a product is necessary because of time and resource constraints, but generally an
evaluation will produce better results if it incorporates at least some product testing.

When using data from other parties, organizations should consider the fidelity of the data. Data is often
presented without a detailed explanation of how it was created, such as maximum capacities or detection
accuracy rates. Because there are no standard methodologies for compiling such data, organizations
should be cautious when comparing data from different sources, because the measurements may have
been performed using fundamentally different methods.

When performing hands-on IDPS testing, organizations should focus on those testing methods that are
most likely to be valuable. Testers should also avoid disrupting the organization’s operations. The
following provides guidance on performing testing for each class of IDPS product. After testing has been

56
     Another complicating factor is that it is often not apparent which methodologies particular products use, so it might be
     difficult to determine which types of tests are needed.


                                                              9-15
