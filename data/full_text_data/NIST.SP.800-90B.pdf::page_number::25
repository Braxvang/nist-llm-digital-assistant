                                                                                             NIST SP 800-90B                                                     RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                         USED FOR RANDOM BIT GENERATION

                                                                                             Note that it is acceptable to truncate the outputs from a vetted conditioning component. If this is
                                                                                             done, the entropy estimate is reduced to a proportion of the output (e.g., if there are six bits of
                                                                                             entropy in an eight-bit output and the output is truncated to six bits, then the entropy is reduced to
                                                                                             3/4 x 6 = 4.5 bits).

                                                                                             When additional noise sources are available, the length of the input (𝑛𝑛𝑖𝑖𝑖𝑖 ) shall only include the
                                                                                             inputs from the primary noise source.

                                                                                             3.1.5.2 Using Non-vetted Conditioning Components

                                                                                             For non-vetted conditioning components, the entropy in the output depends on the entropy and
                                                                                             size of the input (hin and nin), the size of the output (nout), and the size of the narrowest internal
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                             width (nw) and the entropy of the conditioned sequential dataset (as described in item 2 of Section
                                                                                             3.1.1), which shall be computed using the methods described in either Section 6.1 (for IID data)
                                                                                             or Section 6.2 (for non-IID data). Let the obtained entropy estimate per bit be h'.

                                                                                             The output of the conditioning component (nout) shall be treated as a binary string, for purposes of
                                                                                             the entropy estimation.

                                                                                             The entropy of the conditioned output is estimated as

                                                                                                          ℎ𝑜𝑜𝑜𝑜𝑜𝑜 = min(Output_Entropy(𝑛𝑛𝑖𝑖𝑖𝑖 , 𝑛𝑛𝑜𝑜𝑜𝑜𝑜𝑜 , 𝑛𝑛𝑛𝑛, ℎ𝑖𝑖𝑖𝑖 ), 0.999n𝑜𝑜𝑜𝑜𝑜𝑜 , ℎ′ ×𝑛𝑛𝑜𝑜𝑜𝑜𝑜𝑜 ).

                                                                                             The description of Output_Entropy is given in Section 3.1.5.1.2. To avoid approving an entropy
                                                                                             source having a non-vetted conditioning component with full entropy, 𝑛𝑛𝑜𝑜𝑜𝑜𝑜𝑜 is multiplied by the
                                                                                             constant 0.999. The entropy source will be validated at the min-entropy per conditioned output,
                                                                                             hout, computed above.

                                                                                             Note that truncating subsequent to the use of a non-vetted conditioning component shall not be
                                                                                             performed before providing output from the entropy source.

                                                                                             3.1.6   Additional Noise Sources

                                                                                             In this Recommendation, it is assumed that the entropy sources have a unique primary noise source
                                                                                             that is responsible to generate randomness. It should be noted that multiple copies of the same
                                                                                             physical noise source are considered as a single noise source (e.g., a source with eight ring
                                                                                             oscillators, where the sampled bits are concatenated to get an eight-bit output, or where the samples
                                                                                             bits are XORed together).

                                                                                             In addition to the primary noise source outputs, outputs of other noise sources may be available to
                                                                                             the entropy source, and their outputs may be used to increase security. However, the joint entropy
                                                                                             of these outputs may be hard to estimate, especially when there are dependencies between the
                                                                                             sources (e.g., packet arrival times in a communication network and hard drive access times).

                                                                                             This Recommendation allows one to concatenate the outputs of the additional noise sources to the
                                                                                             primary noise source to generate input to the conditioning component. In such cases, vetted
                                                                                             conditioning components shall be used. No entropy is credited from the outputs of the additional
                                                                                             noise sources.

                                                                                                                                                       17
