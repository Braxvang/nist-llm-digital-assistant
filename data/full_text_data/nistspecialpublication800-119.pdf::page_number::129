                                                                GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


addresses could trigger a change in the FISMA system boundaries.

  6.2.3   Problems with EUI-64 Addresses

One of the more common ways to number interfaces is to use EUI-64 addresses. Using EUI-64
addressing can be a security risk. Autoconfiguration is one method that uses EUI-64 to generate an
interface identifier (IID). Any machine that is trying to autoconfigure its own IP address will combine the
network identifier with the EUI-64 address to create a unique address.

The physical address of the interface (MAC address) is an input to the algorithm that generates EUI-64
addresses. RFC 4291 documents the methods for extracting the MAC address from the IPv6 address.
Using a EUI-64 address could potentially reveal the make and model of a remote machine. An attacker
could use that information to target attacks.

The use of the MAC address in EUI-64 addresses may make it easier for an attacker to scan a network.
The MAC address is theoretically 48 bits in length, which yields a large number of host addresses (248).
Address spaces of this size are difficult to scan. However, several factors reduce the effective size of this
space. The first 24 bits of a MAC address are the Organizationally Unique Identifier (OUI), which
identifies the hardware manufacturer. Two of these bits are reserved (for locally/globally administered
addresses and unicast/multicast addresses), which still theoretically leaves 222 possibilities. However, as
of this date (December 2010), fewer than 15,000 OUIs have been assigned; of these, most current devices
will only use a few hundred. Often manufacturers allocate a limited range for the second 24 bits to
specific models of equipment. Evaluating specific OUI codes and bit ranges greatly reduces the number
of EUI-64 addresses. Scanning a network based on the 24 unknown address bits is equivalent to scanning
an IPv4 /8 network, which takes only a few seconds.

There are several strategies to mitigate the risk. The preferred mitigation strategy is to block scanning
activity at the network perimeter and to limit inbound connections to only those hosts and protocols
providing services beyond the gateway. Other methods include generating addresses using a
cryptographic (i.e., non-predictable) algorithm or assigning addresses with DHCPv6.


  6.2.4   Address Management

Address management for IPv6 has security implications. Various mechanisms are available for address
management:

        Managed addresses
        Autoconfiguration
        Manual.
DHCP is widely used in IPv4 networks to allocate managed addresses. IPv4 administrators understand its
configuration and use. IPv6 provides a similar mechanism called DHCPv6. DHCPv6 RFC 3315 is not
the same protocol as DHCP, but it does provide similar functionality. DHCPv6 is still susceptible to the
same security vulnerabilities affecting DHCPv4. Using DHCPv6 has the following security advantages:

        DHCPv6 can limit smaller ranges of valid IPv6 addresses. A smaller range allows
         administrators to implement better access control rules.



                                                     6-7
