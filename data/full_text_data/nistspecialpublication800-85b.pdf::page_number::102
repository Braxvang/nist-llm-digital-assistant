Special Publication 800-85B                                         PIV Data Model Testing Specification


10.3 Facial Image Biometric

10.3.1 Signature Block Contents

10.3.1.1 Verify presence of CMS SignedData asymmetric digital signature

Purpose               Confirms that the CBEFF_SIGNATURE_BLOCK is implemented as a
                      SignedData type and is encoded as a Cryptographic Message Syntax
                      external digital signature as defined in RFC 3852
Reference(s)          1.      FIPS201, Section 4.4.2
                      2.      AS06.03.01
                      3.      AS06.03.02
Precondition          1.      A valid PIV card is inserted into the contact reader.
                      2.      A valid PC/SC connection exists between the test application and the
                              contact reader.
                      3.      The test application is currently connected to the card application
                              which is accessible through card handle.
                      4.      A valid card holder facial image is present on the PIV card.
Test Steps            1. Set cardHandle := <<valid card handle>>
                      2. Set OID := <<Card Holder Facial Image
                         (2.16.840.1.101.3.7.2.96.48)>>
                      3. Call pivGetData w/
                         • (IN) cardHandle
                              • (IN) OID
                              • (OUT) data
                      4. Parse the obtained biometric and extract the contents
                         from the asymmetric digital signature field (i.e. from
                         the CBEFF_SIGNATURE_BLOCK)
                      5. Process the contents of the digital signature
Expected              The CBEFF_SIGNATURE_BLOCK is present in the biometric CBEFF
Result(s)             structure containing an asymmetric digital signature that is implemented
                      as a SignedData type according to RFC 3852.


10.3.1.2 Verify version in SignedData

Purpose               Confirms that the version of the SignedData content type is v1 or v3.
Reference(s)          1.      FIPS201, Section 4.4.2
                      2.      AS06.03.03
Precondition          1.      A valid PIV card is inserted into the contact reader.
                      2.      A valid PC/SC connection exists between the test application and the
                              contact reader.
                      3.      The test application is currently connected to the card application
                              which is accessible through card handle.
                      4.      A valid card holder facial image is present on the PIV card.




                                                                                                 Page 94
