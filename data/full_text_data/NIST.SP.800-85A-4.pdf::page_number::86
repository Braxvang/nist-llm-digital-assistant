NIST SP 800-85A-4                                          PIV CARD APPLICATION & MIDDLEWARE
                                                                    INTERFACE TEST GUIDELINES

 Precondition(s)       1. The client application owns a connection to the PIV Card
                          Application accessible through cardHandle.
                       2. The client application has successfully selected the PIV Card
                          Application.
                       3. Mutual authentication with the client application using the PIV
                          Card Application Administration key has taken place.
 Test Steps            1. Set cardHandle := <<valid cardHandle>>
                       2. Set OID := <<invalid OID>> (Improper syntax or not found
                          in Table 3 of SP 800-73-4 Part 1)
                       3. Set data := <<a correctly formatted byte sequence>
                       4. Call pivPutData with
                          • (IN) cardHandle
                          • (IN) OID
                          • (IN) oidLength
                          • (IN) data
                          • (IN) dataLength
 Expected Result(s)    Call returns with status_word of PIV_INVALID_OID.
 Postcondition(s)      1. The PIV Card Application remains in the state it had prior to the
                          pivPutData function call.
                       2. The precondition states remain unchanged.


B.7.2.3         Security Conditions are Enforced for Writing Data to the On-card Data
                Containers
 Purpose                Ensure that security conditions are enforced for writing data to the
                        PIV Card Application.
 Target                pivPutData
 Reference(s)          1. SP 800-73-4 Part 3, Section 3.4.1
                       2. AS04.09
 Precondition(s)       1. The client application owns a connection to the PIV Card
                          Application accessible through cardHandle.
                       2. The client application has successfully selected the PIV Card
                          Application.
                       3. The PIV Card Application has not authenticated the PIV Card
                          Application Administrator.
 Test Steps            1. Set cardHandle := <<valid cardHandle>>
                       2. Set OID := <<valid OID>>
                       3. Create data reference
                       4. Call pivPutData with (for all data objects)
                          • (IN) cardHandle
                          • (IN) OID
                          • (IN) oidLength
                          • (IN) data
                          • (IN) dataLength




                                        B-20
