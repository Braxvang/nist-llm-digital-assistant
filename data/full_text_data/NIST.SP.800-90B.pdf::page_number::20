                                                                                             NIST SP 800-90B                                            RECOMMENDATION FOR THE ENTROPY SOURCES
                                                                                                                                                                USED FOR RANDOM BIT GENERATION

                                                                                                4. If a conditioning component that is not listed in Section 3.1.5.1.1 is used, the conditioned
                                                                                                   sequential dataset (described in item 2 of Section 3.1.1) is tested using the statistical tests
                                                                                                   described in Section 5 to verify the IID assumption, and the IID assumption is verified.
                                                                                             If any of these conditions are not met, the estimation process shall follow the non-IID track.

                                                                                             3.1.3   Initial Entropy Estimate

                                                                                             The submitter shall provide an entropy estimate for the noise source outputs, which is based on
                                                                                             the submitter’s analysis of the noise source (see Requirement 3 in Section 3.2.2). This estimate is
                                                                                             denoted as Hsubmitter.

                                                                                             After determining the entropy estimation track, a min-entropy estimate per sample, denoted as
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-90B




                                                                                             Horiginal, for the sequential dataset is calculated using the methods described in Section 6.1 (for the
                                                                                             IID track) or Section 6.2 (for the non-IID track). If the alphabet size is greater than 256, it shall be
                                                                                             reduced to at most 256 symbols (see Section 6.4).

                                                                                             If the sequential dataset is not binary, an additional entropy estimation (per bit), denoted Hbitstring,
                                                                                             is estimated. First, the sequential dataset that contains L samples (each having n bits) is considered
                                                                                             as a bitstring of size nL. The bits after the first 1 000 000 bits may be ignored. Then, the estimation
                                                                                             is done based on the entropy estimation track, as specified in the previous paragraph, and Hbitstring
                                                                                             is calculated. Then, the entropy per sample is estimated to be n×Hbitstring.

                                                                                             The initial entropy estimate of the noise source is calculated as HI = min (Horiginal, n×Hbitstring,
                                                                                             Hsubmitter) for non-binary sources and as HI = min (Horiginal, Hsubmitter) for binary sources.

                                                                                             3.1.4   Restart Tests

                                                                                             The entropy estimate of a noise source, calculated from a single, long-output sequence, might
                                                                                             provide an overestimate if the noise source generates correlated sequences after restarts. Hence,
                                                                                             an attacker with access to multiple noise source output sequences after restarts may be able to
                                                                                             predict the next output sequence with much better success than the entropy estimate suggests.

                                                                                             The process of restarting a noise source may be different for different noise sources (e.g., powering
                                                                                             off, cooling off, delaying ten seconds before extracting output from the noise source, etc.). The
                                                                                             submitter shall define the restart process suitable for the submission. This process shall simulate
                                                                                             the restart process expected in real-world use (e.g., the outputs are not generated until after the
                                                                                             start-up tests are complete; see Section 4.2). All restarts are expected to be done in normal
                                                                                             operating conditions.

                                                                                             The restart tests described in this section re-evaluate the entropy estimate for the noise source using
                                                                                             different outputs from many restarts of the noise source. These tests are designed to ensure that:

                                                                                                -    The noise source outputs generated after a restart are drawn from the same distribution as
                                                                                                     every other output.

                                                                                                -    The distribution of samples in a restart sequence is independent of its position in the restart
                                                                                                     sequence.


                                                                                                                                               12
