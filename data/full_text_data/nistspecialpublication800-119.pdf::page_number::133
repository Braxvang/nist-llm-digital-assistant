                                                                    GUIDELINES FOR THE SECURE DEPLOYMENT OF IPV6


     6.4.3   Security Implications of a Dual Stack Environment

A dual stack strategy is useful in making a transition between protocols, but the approach exposes every
dual stack node to the vulnerabilities of both protocols, plus any new vulnerabilities resulting from
unintended interactions between them.

RFC 4852, IPv6 Enterprise Network Analysis - IP Layer 3 Focus, contains sound general advice on
securing dual stack systems. RFC 4942, IPv6 Transition/Coexistence Security Considerations, includes
many specific details:

          Organizations need to implement a consistent security policy for both IPv4 and IPv6
           (including firewalls and packet filters).
          Organizations should account for new IPv6 functionality. This functionality may include
           mobility, stateless address autoconfiguration, neighbor discovery, privacy addresses, and end-
           to-end encryption with IPsec.
          Because both protocols are running, unexpected tunneling between the hosts may occur. The
           result may violate security policies.
          Organizations must upgrade intrusion detection or intrusion prevention systems, firewalls,
           monitoring, logging, and auditing to provide IPv6 protection equivalent to what was available
           for IPv4. If tunneled packets are allowed to enter the network, the firewall or IDS/IPS system
           must be able to perform deep packet inspection.
          The performance of security systems may degrade when handling IPv6 (when using the same
           resources compared to IPv4).
Good security practice dictates disabling unneeded services. Network administrators deploying IPv6 dual
stack should configure nodes (hosts, servers, routers, etc.) to treat the IPv6 protocol as preferred and
phase out remaining instances of the IPv4 protocol in a timely manner. When a given IPv4/IPv6 node no
longer needs IPv4 services, administrators should disable the IPv4 protocol. Employing both protocols is
useful during the early phases of IPv6 deployment, but the practice becomes a security risk because of
increased complexity.

Administrators also need to watch for an unintended dual stack transition due to IPv6 being enabled
prematurely. Security organizations should monitor for IPv6 traffic. Organizations should also audit
router and neighbor solicitations to detect the insertion of rogue routers and devices on the network.
Security and network administrators should have an incident response plan53 in place for responding to
violations of the configuration and security policies.

6.5      Tunneling

Tunneling is the encapsulation of one protocol inside of another. The tunneling protocol carries the
tunneled protocol. The tunneled protocol is unaware of the tunnel and will not incur hop counts while in
transit. This section provides an overview of tunneling either IPv6-over-IPv4 or IPv4-over-IPv6 packets.

Tunneling is a flexible transition mechanism and supports several scenarios including:

          As part of a dual stack IPv4/IPv6 transition strategy


53
      NIST SP 800-61, Computer Security Incident Handling Guide,.


                                                           6-11
