NIST SP 800-85A-4                                          PIV CARD APPLICATION & MIDDLEWARE
                                                                    INTERFACE TEST GUIDELINES

                            •   (INOUT) APLength
 Expected Result(s)     Call returns with status_word of PIV_OK and initialized
                        applicationProperties reference.
 Postcondition(s)       The “currently selected application” of the PIV Card is the PIV Card
                        Application. The PIV Card Application’s security state is established.


B.3.1.2          Use a Right Truncated AID to Select a Card Application
 Purpose                Ensure that the PIV Middleware is able to locate and select a valid
                        PIV Card Application that is identified by a right truncated AID,
                        store its properties, and return a reference via the
                        applicationProperties function parameter.
 Target                 pivSelectCardApplication
 Reference(s)           1. SP 800-73-4 Part 3, Section 3.2.1
                        2. AS04.04
 Precondition(s)        1. The client application owns a connection accessible through
                           cardHandle.
 Test Steps             1. Set cardHandle := <<valid cardHandle>>
                        2. Set applicationID := <<right truncated AID of PIV Card
                           Application>>
                        3. Create applicationProperties reference
                        4. Call pivSelectCardApplication with
                           • (IN) cardHandle
                           • (IN) applicationAID
                           • (IN) aidLength
                           • (OUT) applicationProperties
                           • (INOUT) APLength
 Expected Result(s)     Call returns with status_word of PIV_OK and sets the
                        applicationProperties reference.
 Postcondition(s)       The “currently selected application” of the PIV Card is the PIV Card
                        Application. The PIV Card Application’s security state is established.


B.3.2           Test Assertions for Error Conditions

B.3.2.1          Detect and Handle an Invalid cardHandle Reference
 Purpose                 Ensure that the PIV Middleware detects and gracefully exits when
                         passed an invalid cardHandle.
 Target                 pivSelectCardApplication
 Reference(s)           1. SP 800-73-4 Part 3, Section 3.2.1
                        2. AS04.04
 Precondition(s)        1. There exists a valid physical connection between an instance of
                           the PIV Card and the client application.
                        2. A client application currently has a connection accessible through
                           cardHandle.



                                         B-7
