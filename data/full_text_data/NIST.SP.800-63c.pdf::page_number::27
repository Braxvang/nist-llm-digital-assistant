                                                                                             NIST SP 800-63C                                                         DIGITAL IDENTITY GUIDELINES:
                                                                                                                                                                       FEDERATION & ASSERTIONS

                                                                                             6.2.2    Signed Assertion

                                                                                             Assertions SHALL be cryptographically signed by the issuer (IdP). The RP SHALL validate the
                                                                                             digital signature or MAC of each such assertion based on the issuer’s key. This signature
                                                                                             SHALL cover the entire assertion, including its identifier, issuer, audience, subject, and
                                                                                             expiration.

                                                                                             The assertion signature SHALL either be a digital signature using asymmetric keys or a MAC
                                                                                             using a symmetric key shared between the RP and issuer. Shared symmetric keys used for this
                                                                                             purpose by the IdP SHALL be independent for each RP to which they send assertions, and are
                                                                                             normally established during registration of the RP. Public keys for verifying digital signatures
                                                                                             MAY be fetched by the RP in a secure fashion at runtime, such as through an HTTPS URL
This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.800-63c




                                                                                             hosted by the IdP. Approved cryptography SHALL be used.

                                                                                             6.2.3    Encrypted Assertion

                                                                                             When encrypting assertions, the IdP SHALL encrypt the contents of the assertion using either
                                                                                             the RP’s public key or a shared symmetric key. Shared symmetric keys used for this purpose by
                                                                                             the IdP SHALL be independent for each RP to which they send assertions, and are normally
                                                                                             established during registration of the RP. Public keys for encryption MAY be fetched by the IdP
                                                                                             in a secure fashion at runtime, such as through an HTTPS URL hosted by the RP.

                                                                                             All encryption of assertions SHALL use approved cryptography.

                                                                                             When assertions are passed through third parties, such as a browser, the actual assertion SHALL
                                                                                             be encrypted. For example, a SAML assertion can be encrypted using XML-Encryption, or an
                                                                                             OpenID Connect ID Token can be encrypted using JSON Web Encryption (JWE). For assertions
                                                                                             that are passed directly between IdP and RP, the actual assertion MAY be encrypted. If it is not,
                                                                                             the assertion SHALL be sent over an authenticated protected channel.

                                                                                                      Note: Assertion encryption is required at FAL2 and FAL3.

                                                                                             6.2.4    Audience Restriction

                                                                                             Assertions SHALL use audience restriction techniques to allow an RP to recognize whether or
                                                                                             not it is the intended target of an issued assertion. All RPs SHALL check that the audience of an
                                                                                             assertion contains an identifier for their RP to prevent the injection and replay of an assertion
                                                                                             generated for one RP at another RP.

                                                                                             6.3     Pairwise Pseudonymous Identifiers

                                                                                             In some circumstances, it is desirable to prevent the subscriber’s account at the IdP from being
                                                                                             easily linked at multiple RPs through use of a common identifier.

                                                                                             6.3.1    General Requirements

                                                                                             When using pairwise pseudonymous subject identifiers within the assertions generated by the
                                                                                             IdP for the RP, the IdP SHALL generate a different identifier for each RP as described in Section
                                                                                             6.3.2 below.

                                                                                                                                             18
