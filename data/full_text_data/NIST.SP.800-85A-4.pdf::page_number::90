NIST SP 800-85A-4                                         PIV CARD APPLICATION & MIDDLEWARE
                                                                   INTERFACE TEST GUIDELINES

                       2. AS04.10
 Precondition(s)       1. The client application owns a connection to the PIV Card
                          Application accessible through cardHandle.
                       2. The client application has successfully selected the PIV Card
                          Application.
                       3. The PIV Card Application has not authenticated the PIV Card
                          Application Administrator.
 Test Steps            1. Set cardHandle := <<valid cardHandle>>
                       2. Set cryptographicMechanism := <<a recognized cryptographic
                          mechanism identifier>>
                       3. Set keyReference := <<a reference to a valid key that is
                          associated with the selected cryptographicMechanism >>
                       4. Create publicKey reference
                       5. Call pivGenerateKeyPair with
                          • (IN) cardHandle
                          • (IN) keyReference
                          • (IN) cryptographicMechanism
                          • (OUT) publicKey
                          • (INOUT) KeyLength
 Expected Result(s)    Call returns with status_word of
                       PIV_SECURITY_CONDITIONS_NOT_SATISFIED.
 Postcondition(s)      1. The Card Application remains in the state it had prior to the
                          pivGenerateKeyPair function call.
                       2. The precondition states are unaffected.


B.8.2.5         Identify and Handle an Insufficient Buffer
 Purpose                Ensure that the PIV Middleware identifies and handles an
                        insufficient buffer.
 Target                pivGenerateKeyPair
 Reference(s)          1. SP 800-73-4 Part 3, Section 3.4.2
                       2. AS04.10A-R4
 Precondition(s)       1. The client application owns a connection to the Card Application
                          accessible through cardHandle.
                       2. The client application has successfully selected the PIV Card
                          Application.
                       3. Mutual authentication with the client application using the PIV
                          Card Application Administration key has taken place.
                       4. Length of the buffer allocated for data by the client application is
                          only 1 byte.
 Test Steps            1. Set cardHandle := <<valid cardHandle>>
                       2. Set keyReference := <<an existing key reference suitable
                          for use with the specified cryptographicMechanism>>
                       3. Set cryptographicMechanism := <<a recognized cryptographic
                          mechanism identifier>>
                       4. Set KeyLength := <<1>>
                       5. Create publicKey reference



                                       B-24
