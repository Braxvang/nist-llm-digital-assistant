                                NIST Special Publication 800-38F


The KEK shall be secret, i.e., disclosed only to parties that are authorized to know the protected
information. Compliance with this requirement is the responsibility of the entities using,
implementing, installing, or configuring applications that incorporate this Recommendation. The
management of KEKs is outside the scope of this publication.

5.2   The Authenticated-Encryption and Authenticated-Decryption Functions
For a given KEK and block cipher, KW, KWP, and TKW each comprise two related functions:
authenticated encryption and authenticated decryption. The authenticated-encryption function
takes an input string, called the plaintext, denoted P, and returns a longer output string, called the
ciphertext, denoted C. The authenticated-encryption function expands the data so that only a
small fraction of all possible strings of any given length can be ciphertexts.

The authenticated-decryption function takes an input string, called the purported ciphertext, and
returns either 1) an output string or 2) a special symbol, denoted FAIL. In the first case, the
output string is the unique plaintext that corresponds to the purported ciphertext, so the
ciphertext should be regarded as authentic; the nature of the resulting assurance is described in
Appendix A.3.

For KW, the authenticated-encryption function and the authenticated-decryption function are
denoted KW-AE and KW-AD; for KWP, the functions are denoted KWP-AE and KWP-AD; for
TKW, the functions are denoted TKW-AE and TKW-AD.

Note that, although the KEK, K, is a parameter for each of these six functions, in the
specifications of these functions in this Recommendation, the KEK is considered to be a
prerequisite, i.e., an input that has been established prior to the invocation of the function, and is
omitted from the notation. Similarly, the choice of the block cipher for the KW and the KWP
functions and the designation of CIPHK are prerequisites that are omitted from the notation.

The authenticated-encryption and authenticated-decryption functions of KW and KWP are based
on a keyed transformation, called the wrapping function, denoted W, and its inverse, called the
unwrapping function, denoted W-1. The analogous keyed transformations for TKW are denoted
TW and TW-1.

Within the authenticated-encryption function, the wrapping function is applied to an enlarged
plaintext string to produce the ciphertext. Each key-wrap variant enlarges the plaintext by
prepending a fixed string called the integrity check value (ICV); for KWP-AE, the enlarged
plaintext also includes a 32-bit encoding of the octet length of the plaintext and possibly some
“zero” octets as padding.

In each key-wrap variant, the authenticated-decryption function applies the unwrapping function
to the purported ciphertext and then verifies whether the output string is the result of properly
enlarging a plaintext string.

A useful unit of length for describing these functions is half the block size, i.e., 64 bits for KW
and KWP, and 32 bits for TKW. A bit string of this length is called a semiblock, and, for a non-




                                                  9
