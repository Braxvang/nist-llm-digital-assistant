NIST SP 800-166                                                   DERIVED PIV APPLICATION AND
                                                                  DATA MODEL TEST GUIDELINES

                             • Data field in the command is to include the data
                               object that will be placed the Security Object
                               container
                      7. If the Key History Object is supported, repeat Step 2
                         with
                            • Data field in the command is to include the tag
                               of the Key History object ('5FC10C')
                            • Data field in the command is to include the data
                               object that will placed in the Key History Object
                               container
                      8. If the Key History Object is supported, repeat Step 2
                         for each implemented retired X.509 Certificate for Key
                         Management with
                            • Data field in the command is to include the tag
                               of one of the 20 retired X.509 Certificates for
                               Key Management ('5FC10D'-'5FC120')
                            • Data field in the command is to include the data
                               object that will be placed the retired X.509
                               Certificate for Key Management container

                      NOTE: The following tests are to be performed only if the
                      Derived PIV Application supports the use of the '9B' key
                      (Derived PIV Token Management Key)
                      9. Perform mutual authentication of Derived PIV
                          Application and the Test Toolkit Application using
                          Test Assertion TA-08.03.03.03 (GENERAL AUTHENTICATE).
                      10. Repeat Steps 2-8. Following the PUT DATA commands,
                          perform the GET DATA commands (see TA-08.03.03.02.01)
                          to verify that the same data that was personalized
                          with the PUT DATA commands are returned by the GET
                          DATA commands.
 Expected Result(s)   1. From Step 1, the command returns the application property template
                         with the status word '90 00'.
                      2. From Step 2 through Step 8, the commands return status word '69
                         82' (security status not satisfied).
                      3. From Step 9, the test results are consistent with those expected as
                         part of TA-08.03.03.03:
                             a. From Step 1 of TA-08.03.03.03, the command returns the
                                 application property template with the status word '90 00'.
                             b. From Step 2 of TA-08.03.03.03, the command returns with
                                 the witness followed by status word '90 00'.
                             c. From Step 3 of TA-08.03.03.03, the Derived PIV
                                 Application verifies the decrypted witness and then responds
                                 with encryption of the challenge sent by Test Toolkit
                                 Application followed by status word '90 00'. Decrypt the
                                 encrypted challenge and compare it to the one sent to the
                                 token.
                      4. From Step 10, all commands return status word '90 00', and input
                         and output data match.
 Postcondition(s)     N/A



                                            83
