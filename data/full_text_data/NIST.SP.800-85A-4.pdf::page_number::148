NIST SP 800-85A-4                                       PIV CARD APPLICATION & MIDDLEWARE
                                                                 INTERFACE TEST GUIDELINES

                      13. The command returns '90 00' – secure messaging session keys
                          are established. Use the information returned by the PIV Card
                          Application to derive the session keys and verify the key
                          confirmation AuthCryptogram ICC (but use the public key that
                          was returned in step 7 to compute the ECC_CDH primitive).
                      14. The command returns '6A 80' (incorrect parameter command
                          data field).
                      15. The command returns '6A 86' (incorrect parameter P2).
 Postcondition(s)     The on card private keys have changed to the new computed value.

C.3.2.2        Contactless Interface
 Purpose              Validates that the GENERATE ASYMMETRIC KEY PAIR command
                      cannot be issued through the contactless interface.
 Reference(s)         1. SP 800-73-4 Part 2, Table 2
                      2. AS05.03
 Precondition(s)      1. The existing contents of the public key data object have been
                          recorded.
                      2. The IUT is placed within the reading range of the contactless
                          reader.
                      3. There exists a valid PC/SC connection between the test system
                          and the contactless reader.
                      4. No other contactless card is within the proximity of the reader.
 Test Scenario        1. Send SELECT card command with
                         • AID == 'A0 00 00 03 08 00 00 10 00 01 00'
                      2. Perform steps 1-5 of test C.3.2.1
 Expected Result(s)   1. The command returns the application property template with the
                         status word '90 00' at the end.
                      2. Referenced steps 1-5 from C.3.2.1 return an error status word for
                         all key references.
 Postcondition(s)     N/A


C.3.2.3       Secure Messaging Interface
 Purpose             Validates that the GENERATE ASYMMETRIC KEY PAIR command
                     cannot be issued through the secure messaging interface.
 Reference(s)        1. SP 800-73-4 Part 2, Table 2
                     2. AS05.03
 Precondition(s)     1. The existing contents of the public key data object have been
                        recorded.
                     2. The IUT is placed within the reading range of the contactless
                        reader.
                     3. There exists a valid PC/SC connection between the test system
                        and the contactless reader.


                                     C-47
