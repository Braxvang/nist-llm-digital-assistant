Special Publication 800-73-4                         Interfaces for Personal Identity Verification â€“ Part 2:
                                                     PIV Card Application Card Command Interface




                                Figure 5. PIV Data Integrity of Response


  4.2.6   Response with PIV Secure Messaging

For secure messaging, the secure messaging data field that is sent by the PIV Card Application shall be
constructed as the concatenation of the following: the BER-TLV encoded encrypted message (when
present); the 4-byte BER-TLV encoded status word, as described in Section 4.2.5; and the 10-byte BER-
TLV encoded R-MAC of the response, as described in Section 4.2.5.

Figure 6 illustrates a response under secure messaging for the case in which response chaining is not
required. The APDU consists of the secure messaging data field and the 2-byte SW processing status ('90
00'), which indicates that the PIV Card Application successfully verified the C-MAC on the command
and decrypted the data field in the command (if present). If the PIV Card Application was unable to verify
the C-MAC on the command or decrypt the data field in the command, then it shall return a 2-byte error
response, as described in Section 4.2.7.




                                                   36
