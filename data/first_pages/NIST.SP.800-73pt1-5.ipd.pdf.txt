                        NIST Special Publication
                        NIST SP 800-73pt1-5 ipd

                      Interfaces for
      Personal Identity Verification
Part 1 – PIV Card Application Namespace, Data Model,
                                  and Representation

                                                Initial Public Draft

                                               Hildegard Ferraiolo
                                                      Ketan Mehta
                                           Salvatore Francomacaro
                                         Ramaswamy Chandramouli
                                                     Sarbari Gupta

                        This publication is available free of charge from:
                        https://doi.org/10.6028/NIST.SP.800-73pt1-5.ipd
                                           NIST Special Publication
                                           NIST SP 800-73pt1-5 ipd

                      Interfaces for
      Personal Identity Verification
Part 1 – PIV Card Application Namespace, Data Model,
                                  and Representation

                                                                         Initial Public Draft

                                                                      Hildegard Ferraiolo
                                                                             Ketan Mehta
                                                                  Salvatore Francomacaro
                                                                Ramaswamy Chandramouli
                                                                  Computer Security Division
                                                           Information Technology Laboratory

                                                                                     Sarbari Gupta
                                                                          Electrosoft Services, Inc.

                                          This publication is available free of charge from:
                                          https://doi.org/10.6028/NIST.SP.800-73pt1-5.ipd

                                                                                     September 2023




                                                                            U.S. Department of Commerce
                                                                             Gina M. Raimondo, Secretary

                                                            National Institute of Standards and Technology
         Laurie E. Locascio, NIST Director and Under Secretary of Commerce for Standards and Technology
     NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
     September 2023                                 PIV Card Application Namespace, Data Model, and Representation




 1   Certain commercial equipment, instruments, software, or materials, commercial or non-commercial, are identified in
 2   this paper in order to specify the experimental procedure adequately. Such identification does not imply
 3   recommendation or endorsement of any product or service by NIST, nor does it imply that the materials or
 4   equipment identified are necessarily the best available for the purpose.

 5   There may be references in this publication to other publications currently under development by NIST in
 6   accordance with its assigned statutory responsibilities. The information in this publication, including concepts and
 7   methodologies, may be used by federal agencies even before the completion of such companion publications. Thus,
 8   until each publication is completed, current requirements, guidelines, and procedures, where they exist, remain
 9   operative. For planning and transition purposes, federal agencies may wish to closely follow the development of
10   these new publications by NIST.

11   Organizations are encouraged to review all draft publications during public comment periods and provide feedback
12   to NIST. Many NIST cybersecurity publications, other than the ones noted above, are available at
13   https://csrc.nist.gov/publications.


14   Authority
15   This publication has been developed by NIST in accordance with its statutory responsibilities under the Federal
16   Information Security Modernization Act (FISMA) of 2014, 44 U.S.C. § 3551 et seq., Public Law (P.L.) 113-283.
17   NIST is responsible for developing information security standards and guidelines, including minimum requirements
18   for federal information systems, but such standards and guidelines shall not apply to national security systems
19   without the express approval of appropriate federal officials exercising policy authority over such systems. This
20   guideline is consistent with the requirements of the Office of Management and Budget (OMB) Circular A-130.
21
22   Nothing in this publication should be taken to contradict the standards and guidelines made mandatory and binding
23   on federal agencies by the Secretary of Commerce under statutory authority. Nor should these guidelines be
24   interpreted as altering or superseding the existing authorities of the Secretary of Commerce, Director of the OMB, or
25   any other federal official. This publication may be used by nongovernmental organizations on a voluntary basis and
26   is not subject to copyright in the United States. Attribution would, however, be appreciated by NIST.


27   NIST Technical Series Policies
28   Copyright, Use, and Licensing Statements
29   NIST Technical Series Publication Identifier Syntax


30   Publication History
31   Approved by the NIST Editorial Review Board on YYYY-MM-DD [Will be added on final publishing]
32   Supersedes NIST Series XXX (Month Year) DOI [Will be added on final publishing]


33   How to Cite this NIST Technical Series Publication:
34   Ferraiolo H, Mehta K, Francomacaro S, Chandramouli R, Gupta S (2023) Interfaces for Personal Identity
35   Verification: Part 1 – PIV Card Application Namespace, Data Model, and Representation. (National Institute of
36   Standards and Technology, Gaithersburg, MD), NIST Special Publication (SP) NIST SP 800-73pt1-5 ipd.
37   https://doi.org/10.6028/NIST.SP.800-73pt1-5.ipd


38   Author ORCID iDs
39   Hildegard Ferraiolo: 0000-0002-7719-5999
40   Ketan Mehta: 0009-0001-1191-8656
41   Salvatore Francomacaro: 0009-0009-0487-2520
     NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
     September 2023                                 PIV Card Application Namespace, Data Model, and Representation

42   Ramaswamy Chandramouli: 0000-0002-7387-5858
43   Sarbari Gupta: 0000-0003-1101-0856


44   Public Comment Period
45   September 27, 2023 – November 15, 2023


46   Submit Comments
47   piv_comments@nist.gov
48
49   National Institute of Standards and Technology
50   Attn: Computer Security Division, Information Technology Laboratory
51   100 Bureau Drive (Mail Stop 8930) Gaithersburg, MD 20899-8930


52   All comments are subject to release under the Freedom of Information Act (FOIA).


53
     NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
     September 2023                                 PIV Card Application Namespace, Data Model, and Representation


54   Abstract
55   FIPS 201 defines the requirements and characteristics of government-wide interoperable identity
56   credentials. It specifies that these identity credentials must be stored on a smart card and that
57   additional common identity credentials, known as derived PIV credentials, may be issued by a
58   federal department or agency and used when a PIV Card is not practical. This document contains
59   the technical specifications to interface with the smart card to retrieve and use PIV identity
60   credentials. The specifications reflect the design goals of interoperability and PIV Card
61   functions. The goals are addressed by specifying a PIV data model, card edge interface, and
62   application programming interface. Moreover, this document enumerates requirements for the
63   options and branches in international integrated circuit card standards. The specifications go
64   further by constraining interpretations of the normative standards to ease implementation,
65   facilitate interoperability, and ensure performance in a manner tailored for PIV applications.

66   Keywords
67   authentication; FIPS 201; identity credential; logical access control; on-card biometric
68   comparison; Personal Identity Verification (PIV); physical access control; smart cards; secure
69   messaging.

70   Reports on Computer Systems Technology
71   The Information Technology Laboratory (ITL) at the National Institute of Standards and
72   Technology (NIST) promotes the U.S. economy and public welfare by providing technical
73   leadership for the Nation’s measurement and standards infrastructure. ITL develops tests, test
74   methods, reference data, proof of concept implementations, and technical analyses to advance
75   the development and productive use of information technology. ITL’s responsibilities include the
76   development of management, administrative, technical, and physical standards and guidelines for
77   the cost-effective security and privacy of other than national security-related information in
78   Federal information systems. The Special Publication 800-series reports on ITL’s research,
79   guidelines, and outreach efforts in information system security, and its collaborative activities
80   with industry, government, and academic organizations.

81   Trademark Information
82   All registered trademarks or trademarks belong to their respective organizations.




                                                           i
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

 83   Call for Patent Claims
 84   This public review includes a call for information on essential patent claims (claims whose use
 85   would be required for compliance with the guidance or requirements in this Information
 86   Technology Laboratory (ITL) draft publication). Such guidance and/or requirements may be
 87   directly stated in this ITL Publication or by reference to another publication. This call also
 88   includes disclosure, where known, of the existence of pending U.S. or foreign patent applications
 89   relating to this ITL draft publication and of any relevant unexpired U.S. or foreign patents.
 90   ITL may require from the patent holder, or a party authorized to make assurances on its behalf,
 91   in written or electronic form, either:
 92       a) assurance in the form of a general disclaimer to the effect that such party does not hold
 93          and does not currently intend holding any essential patent claim(s); or
 94       b) assurance that a license to such essential patent claim(s) will be made available to
 95          applicants desiring to utilize the license for the purpose of complying with the guidance
 96          or requirements in this ITL draft publication either:
 97              i.    under reasonable terms and conditions that are demonstrably free of any unfair
 98                    discrimination; or
 99             ii.    without compensation and under reasonable terms and conditions that are
100                    demonstrably free of any unfair discrimination.
101   Such assurance shall indicate that the patent holder (or third party authorized to make assurances
102   on its behalf) will include in any documents transferring ownership of patents subject to the
103   assurance, provisions sufficient to ensure that the commitments in the assurance are binding on
104   the transferee, and that the transferee will similarly include appropriate provisions in the event of
105   future transfers with the goal of binding each successor-in-interest.
106   The assurance shall also indicate that it is intended to be binding on successors-in-interest
107   regardless of whether such provisions are included in the relevant transfer documents.
108   Such statements should be addressed to: piv_comments@nist.gov




                                                            ii
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

109   Configuration Management
110   When a federal agency adds one or several of the optional features listed in Appendix G to its
111   PIV Cards, client applications must upgrade the PIV Middleware accordingly. This will enable
112   the PIV Middleware to recognize and process the new data objects and/or features.
113   Where maximum interoperability is required, it is necessary to upgrade to SP 800-73-5-based
114   PIV Middleware as they become available. Only SP 800-73-5-based PIV Middleware fully
115   support all capabilities outlined in Appendix G. Previous versions of the PIV Middleware (based
116   on SP 800-73-4 or older versions) are unaware of new SP 800-73-5 features and may have some
117   limitations.

118   NPIVP Conformance Testing
119   As outlined in FIPS 201-3, Appendix A.3, NIST has established the NIST Personal Identity
120   Verification Program (NPIVP) to:
121       •   Validate the compliance and conformance of PIV Middleware and PIV Card
122           Applications with the specifications in SP 800-73
123       •   Provide assurance that the PIV Middleware and PIV Card Applications validated by
124           NPIVP are interoperable
125   For further information on NPIVP, see https://csrc.nist.gov/projects/nist-personal-identity-
126   verification-program.
127   With the final release of SP 800-73-5, NPIVP plans to revise and publish SP 800-85A-5, PIV
128   Card Application and Middleware Interface Test Guidelines. This document will outline the
129   Derived Test Requirements (DTRs) of SP 800-73-5 based PIV Card Applications and PIV
130   Middleware. In parallel, NPIVP plans to update the test tools (Test Runner) for NPIVP
131   laboratories to test PIV Card Applications in accordance with the DTRs in SP 800-85A-5. The
132   Test Runner will not be updated for PIV Middleware testing because smart card support is
133   natively supported by most endpoint devices. Hence, with this revision, SP 800-73-5 Part 3 is
134   optional, and NPIVP conformance testing for PIV Middleware in accordance with SP 800-73
135   Part 3 is discontinued.
136   Once SP 800-85A-5 is published and the test tools are available to NPIVP test laboratories, SP
137   800-73-4 based testing will be discontinued, and SP 800-73-5-based testing will begin. NPIVP
138   will announce the start of SP 800-73-5-based testing at https://csrc.nist.gov/projects/nist-
139   personal-identity-verification-program/announcements.

140   Terminology
141   Throughout this publication the following terminology will be used:
142       •   SP 800-73-5 refers collectively to the three-part report, Interfaces for Personal Identity
143           Verification.
144       •   SP 800-73-5 Part [#] refers to a specific part of SP 800-73-5.


                                                            iii
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

145       •   The official citation that should be used when referencing a report can be found in the
146           “How to Cite this NIST Technical Series Publication” in the front matter.




                                                            iv
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

147   Table of Contents
148          Introduction ......................................................................................................................... 1
149                 Purpose ......................................................................................................................... 1
150                 Scope ............................................................................................................................ 1
151                 Effective Date ................................................................................................................ 2
152                 Audience and Assumptions ........................................................................................... 2
153                 Document Overview and Structure ............................................................................... 2
154          PIV Card Application Namespaces .................................................................................... 3
155                 Namespaces of the PIV Card Application ..................................................................... 3
156                 PIV Card Application AID .............................................................................................. 3
157          PIV Data Model Elements ................................................................................................... 4
158                 Mandatory Data Elements ............................................................................................. 4
159                 Conditional Data Elements ............................................................................................ 8
160                 Optional Data Elements ................................................................................................ 9
161                 Inclusion of Universally Unique Identifiers (UUIDs)..................................................... 14
162                 Data Object Containers and Associated Access Rules and Interface Modes ............. 15
163          PIV Data Objects Representation .................................................................................... 17
164                 Data Objects Definition................................................................................................ 17
165                 OIDs and Tags of PIV Card Application Data Objects ................................................ 17
166                 Object Identifiers ......................................................................................................... 17
167          Data Types and Their Representation ............................................................................. 20
168                 Key References ........................................................................................................... 20
169                 PIV Algorithm Identifier................................................................................................ 23
170                 Cryptographic Mechanism Identifiers .......................................................................... 23
171                 Secure Messaging and Authentication Using a Secure Messaging Key (SM-AUTH) . 24
172                 Virtual Contact Interface .............................................................................................. 24
173                 Status Words ............................................................................................................... 25
174   References ................................................................................................................................. 26
175   Appendix A.              PIV Data Model............................................................................................... 29
176   Appendix B.              PIV Authentication Mechanisms .................................................................. 40
177   Appendix C.              PIV Algorithm Identifier Discovery .............................................................. 51
178   Appendix D.              List of Symbols, Abbreviations, and Acronyms ......................................... 53
179   Appendix E.              Glossary ......................................................................................................... 57
180   Appendix F.              Notation .......................................................................................................... 59
181   Appendix G.              Revision History ............................................................................................ 60


                                                                          v
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

182

183   List of Tables
184   Table 1. First byte of PIN Usage Policy discovery ...................................................................... 11
185   Table 2. Data Model Containers ................................................................................................. 15
186   Table 3. Object identifiers of the PIV data objects for interoperable use .................................... 18
187   Table 4. PIV Card Application authentication data references ................................................... 20
188   Table 5. PIV Card Application key references ............................................................................ 21
189   Table 6. Cryptographic mechanism identifiers ........................................................................... 23
190   Table 7. Status words ................................................................................................................. 25
191   Table 8. PIV data containers ...................................................................................................... 29
192   Table 9. Card Capability Container ............................................................................................ 31
193   Table 10. Card Holder Unique Identifier ..................................................................................... 32
194   Table 11. X.509 Certificate for PIV Authentication ..................................................................... 32
195   Table 12. Cardholder fingerprints ............................................................................................... 32
196   Table 13. Security Object ........................................................................................................... 32
197   Table 14. Cardholder facial image .............................................................................................. 33
198   Table 15. Printed information ..................................................................................................... 33
199   Table 16. X.509 Certificate for Digital Signature ........................................................................ 33
200   Table 17. X.509 Certificate for Key Management ....................................................................... 33
201   Table 18. X.509 Certificate for Card Authentication ................................................................... 34
202   Table 19. Discovery Object ........................................................................................................ 34
203   Table 20. Key History Object ...................................................................................................... 34
204   Table 21. Retired X.509 Certificate for Key Management 1 ....................................................... 34
205   Table 22. Retired X.509 Certificate for Key Management 2 ....................................................... 35
206   Table 23. Retired X.509 Certificate for Key Management 3 ....................................................... 35
207   Table 24. Retired X.509 Certificate for Key Management 4 ....................................................... 35
208   Table 25. Retired X.509 Certificate for Key Management 5 ....................................................... 35
209   Table 26. Retired X.509 Certificate for Key Management 6 ....................................................... 35
210   Table 27. Retired X.509 Certificate for Key Management 7 ....................................................... 35
211   Table 28. Retired X.509 Certificate for Key Management 8 ....................................................... 36
212   Table 29. Retired X.509 Certificate for Key Management 9 ....................................................... 36
213   Table 30. Retired X.509 Certificate for Key Management 10 ..................................................... 36
214   Table 31. Retired X.509 Certificate for Key Management 11 ..................................................... 36
215   Table 32. Retired X.509 Certificate for Key Management 12 ..................................................... 36
216   Table 33. Retired X.509 Certificate for Key Management 13 ..................................................... 37
217   Table 34. Retired X.509 Certificate for Key Management 14 ..................................................... 37
218   Table 35. Retired X.509 Certificate for Key Management 15 ..................................................... 37
219   Table 36. Retired X.509 Certificate for Key Management 16 ..................................................... 37
220   Table 37. Retired X.509 Certificate for Key Management 17 ..................................................... 37
221   Table 38. Retired X.509 Certificate for Key Management 18 ..................................................... 37
222   Table 39. Retired X.509 Certificate for Key Management 19 ..................................................... 38
223   Table 40. Retired X.509 Certificate for Key Management 20 ..................................................... 38
224   Table 41. Cardholder iris images ................................................................................................ 38
225   Table 42. Biometric Information Templates Group template ...................................................... 39
226   Table 43. Secure Messaging Certificate Signer ......................................................................... 39
227   Table 44. Pairing Code Reference Data Container .................................................................... 39
228   Table 45. Summary of PIV authentication mechanisms ............................................................. 50


                                                                       vi
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

229   List of Figures
230   Fig. 1. Authentication using PIV Biometrics (BIO) ...................................................................... 42
231   Fig. 2. Authentication using PIV Biometrics Attended (BIO-A) ................................................... 43
232   Fig. 3. Authentication using PIV Authentication Key .................................................................. 44
233   Fig. 4. Authentication using an asymmetric Card Authentication Key ........................................ 45
234   Fig. 5. Authentication using a symmetric Card Authentication Key (DEPRECATED) ................ 46
235   Fig. 6. Authentication using OCC ............................................................................................... 47
236   Fig. 7. Authentication using PIV Visual Credentials (DEPRECATED) ....................................... 48
237   Fig. 8. Authentication using the secure messaging key ............................................................. 49

238




                                                                   vii
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

239   Acknowledgments
240   The authors — Hildegard Ferraiolo, Ketan Mehta, Salvatore Francomacaro, and Ramaswamy
241   Chandramouli of NIST and Sarbari Gupta of Electrosoft Services, Inc. — gratefully
242   acknowledge the contributions of David Cooper, James Dray, William MacGregor, Scott
243   Guthery, Teresa Schwarzhoff, and Jason Mohler, who co-authored prior versions of this three-
244   part publication. The authors also gratefully acknowledge and appreciate the many contributions
245   from the public and private sectors whose thoughtful and constructive comments improved the
246   quality and usefulness of this publication.
247




                                                           viii
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation


248       Introduction
249   Homeland Security Presidential Directive-12 (HSPD-12) called for the adoption of a common
250   identification standard to govern the interoperable use of identity credentials to allow physical
251   and logical access to federally controlled facilities and information systems. In response, Federal
252   Information Processing Standard (FIPS) 201 [FIPS201], Personal Identity Verification (PIV) of
253   Federal Employees and Contractors, was developed to define reliable, government-wide identity
254   credentials for use in applications such as access to federally controlled facilities and information
255   systems. FIPS 201 supports multiple types of authenticators, including authenticators on smart
256   cards (also known as PIV Cards) and derived PIV credential authenticators in various other form
257   factors. This publication contains technical specifications to interface with PIV Cards to retrieve
258   and use identity credentials. Other specifications, such as NIST Special Publication (SP) 800-
259   157r1 (Revision 1), contain procedures and life cycle activities to issue, maintain, and use
260   derived PIV credentials.

261           Purpose
262   FIPS 201 defines processes for binding identities to authenticators, such as the PIV Card and
263   derived PIV credentials used in the federal PIV system. SP 800-73-5 contains the technical
264   specifications to interface with the PIV Card to retrieve and use the identity credentials. The
265   specifications reflect the design goals of interoperability and PIV Card functions. The goals are
266   addressed by specifying a PIV data model, card edge interface, and application programming
267   interface. Moreover, this document enumerates requirements for the options and branches in
268   international integrated circuit card (ICC) standards [ISO7816]. The specifications go further by
269   constraining interpretations of the normative standards to ease implementation, facilitate
270   interoperability, and ensure performance in a manner tailored for PIV applications.

271           Scope
272   SP 800-73-5 specifies the PIV data model, application programming interface (API), and card
273   interface requirements necessary to comply with the use cases, as defined in Section 6 of FIPS
274   201 and further described in this document. Interoperability is defined as the use of PIV identity
275   credentials such that client-application programs, compliant card applications, and compliant
276   ICCs CAN be used interchangeably by all information processing systems across federal
277   agencies. SP 800-73-5 defines the PIV data elements’ identifiers, structure, and format, as well
278   as the client API and card command interface for use with the PIV Card.
279   This document — SP 800-73-5, Interfaces for Personal Identity Verification: Part 1 – PIV Card
280   Application Namespace, Data Model, and Representation — is a companion document to FIPS
281   201 and specifies the PIV Card Application Namespace, the PIV Data Model, and its logical
282   representation on the PIV Card.




                                                            1
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

283           Effective Date
284   These recommendations become effective upon final publication. New optional PIV Card
285   features and deprecated PIV card features shall be phased in as part of new card stock
286   acquisitions by federal department and agencies.
287   FIPS 201 compliance of PIV components and subsystems is provided in accordance with OMB
288   [M-19-17] through products and services from the U.S. General Services Administration’s
289   (GSA) Interoperability Test Program and Approved Products and Services List.

290           Audience and Assumptions
291   This document is intended for federal agencies and implementers of PIV systems. Readers are
292   assumed to have a working knowledge of smart card standards and applications.

293           Document Overview and Structure
294   All sections in this document are normative (i.e., mandatory for compliance) unless specified as
295   informative (i.e., non-mandatory) and are structured as follows:
296       •   Section 1, Introduction, provides the purpose, scope, effective date, audience, and
297           assumptions of the document and outlines its structure.
298       •   Section 2, PIV Card Application Namespaces, defines the three NIST-managed
299           namespaces used by the PIV Card Application.
300       •   Section 3, PIV Data Model Elements, describes the PIV Data Model elements in detail.
301       •   Section 4, PIV Data Objects Representation, describes the format and coding of the PIV
302           data structures used by the PIV client-application programming interface and the PIV
303           Card Application.
304       •   Section 5, Data Types and Their Representation, describes the data types found on the
305           PIV client-application programming interface and the PIV Card Application card
306           command interface.
307       •   Appendix A provides container information for PIV Cards.
308       •   Appendix B describes the PIV authentication mechanisms and is informative.
309       •   Appendix C describes recommended procedures for key size and algorithm discovery and
310           is informative.
311       •   Appendix D provides the list of symbols, abbreviations and acronyms used in this
312           document and is informative.
313       •   Appendix E provides a glossary of terms and is informative.
314       •   Appendix F describes the notation used in this document and is informative.
315       •   Appendix G provides the revision history of the document and is informative.
316

                                                            2
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

317       PIV Card Application Namespaces

318           Namespaces of the PIV Card Application
319   Names used on the PIV interfaces are drawn from three namespaces managed by NIST:
320       1. Proprietary Identifier eXtension (PIX) of the NIST Registered Application Provider
321          IDentifier (RID)
322       2. ASN.1 object identifiers (OIDs) in the personal identity verification subset of the OIDs
323          managed by NIST
324       3. Basic Encoding Rules — Tag Length Value (BER-TLV) tags of the NIST PIV coexistent
325          tag allocation scheme
326   All unspecified names in these managed namespaces are reserved for future use.
327   All interindustry tags defined in ISO/IEC 7816, Information Technology – Identification Cards –
328   Integrated Circuit(s) Card with Contacts [ISO7816], and used in the NIST coexistent tag
329   allocation scheme without redefinition have the same meaning as they have in [ISO7816].
330   All unspecified values in the following identifier and value namespaces are reserved for future
331   use:
332       •   Algorithm identifiers
333       •   Key reference values
334       •   Cryptographic mechanism identifiers

335           PIV Card Application AID
336   The Application IDentifier (AID) of the Personal Identity Verification Card Application (PIV
337   Card Application) SHALL be:
338           'A0 00 00 03 08        00 00 10 00       01 00'
339   The AID of the PIV Card Application consists of the NIST RID ('A0 00 00 03 08') followed by
340   the application portion of the NIST PIX indicating the PIV Card Application ('00 00 10 00') and
341   then the version portion of the NIST PIX ('01 00') for the first version of the PIV Card
342   Application. All other PIX sequences on the NIST RID are reserved for future use.
343   The PIV Card Application CAN be selected as the current application by providing the full AID
344   as listed above or by providing the right-truncated version (i.e., without the two-byte version), as
345   follows:
346           'A0 00 00 03 08        00 00 10 00'
347




                                                            3
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

348       PIV Data Model Elements
349   This section describes the data elements for the personal identity verification data model.
350   A PIV Card Application SHALL contain seven mandatory interoperable data objects, two
351   conditionally mandatory data objects, and MAY contain 27 optional data objects. The seven
352   mandatory data objects for interoperable use are:
353       1. Card Capability Container
354       2. Card Holder Unique Identifier
355       3. X.509 Certificate for PIV Authentication
356       4. X.509 Certificate for Card Authentication
357       5. Cardholder Fingerprints
358       6. Cardholder Facial Image
359       7. Security Object
360   The two data objects that are mandatory if the cardholder has a government-issued email account
361   at the time of credential issuance are:
362       1. X.509 Certificate for Digital Signature
363       2. X.509 Certificate for Key Management
364   The 27 optional data objects are:
365       •   Printed Information
366       •   Discovery Object
367       •   Key History Object
368       •   20 retired X.509 Certificates for Key Management
369       •   Cardholder Iris Images
370       •   Biometric Information Templates Group Template
371       •   Secure Messaging Certificate Signer
372       •   Pairing Code Reference Data Container

373           Mandatory Data Elements
374   This section describes the seven mandatory data objects for interagency interoperable use.

375   3.1.1. Card Capability Container
376   The Card Capability Container (CCC) is a mandatory data object whose purpose is to facilitate
377   the compatibility of Government Smart Card Interoperability Specification (GSC-IS)
378   applications with PIV Cards.


                                                            4
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

379   The CCC supports minimum capability for retrieval of the data model and, optionally, the
380   application information specified in [GSC-IS]. The data model of the PIV Card Application
381   SHALL be identified by data model number 0x10. Deployed applications use 0x00 through
382   0x04. This enables the GSC-IS application domain to correctly identify a new data model
383   namespace and structure as defined in this document.
384   For PIV Card Applications, the PIV data objects exist in a namespace tightly managed by NIST,
385   and a CCC discovery mechanism is not needed by client applications that are not based on GSC-
386   IS. Therefore, all mandatory data elements of the CCC except for the data model number MAY
387   optionally have a length value set to zero bytes (i.e., no value field will be supplied). Unused
388   optional data elements SHALL be absent. Other than the data model number, the contents of the
389   CCC data elements are out of scope for this specification.
390   The Security Object enforces integrity of the CCC according to the issuer.

391   3.1.2. Card Holder Unique Identifier
392   The Card Holder Unique Identifier (CHUID) data object is defined in accordance with the
393   Technical Implementation Guidance: Smart Card Enabled Physical Access Control Systems
394   (TIG SCEPACS) [TIG SCEPACS]. For this specification, the CHUID is common between the
395   contact and contactless interfaces. For dual chip implementations, the CHUID is copied in its
396   entirety between the two chips.
397   In addition to the requirements specified in TIG SCEPACS, the CHUID on the PIV Card
398   SHALL meet the following requirements:
399          •    The previously deprecated Authentication Key Map data element SHALL NOT be
400               present in the CHUID. 1
401          •    The Federal Agency Smart Credential Number (FASC-N) SHALL be in accordance with
402               TIG SCEPACS [TIG SCEPACS] with the exception that credential series, individual
403               credential issue, person identifier, organizational category, organizational identifier, and
404               the person/organization association category MAY be populated with all zeros. The
405               FASC-N SHALL NOT be modified post-issuance.
406               A subset of the FASC-N, the FASC-N Identifier, SHALL be the unique identifier as
407               described in [TIG SCEPACS, Section 6.6]: “The combination of an Agency Code,
408               System Code, and Credential Number is a fully qualified number that is uniquely
409               assigned to a single individual.” The Agency Code is assigned to each department or
410               agency by SP 800-87, Codes for Identification of Federal and Federally-Assisted
411               Organizations [SP800-87]. The subordinate System Code and Credential Number value
412               assignment is subject to department or agency policy, provided that the FASC-N
413               identifier (i.e., the concatenated Agency Code, System Code, and Credential Number) is
414               unique for each card. The same FASC-N value SHALL be used in all of the PIV data
415               objects that include the FASC-N. To eliminate unnecessary use of personally identifiable
416               information, the FASC-N’s Person Identifier (PI) field SHOULD NOT encode Social
417               Security numbers (SSNs). TIG SCEPACS also specifies PACS interoperability

      1
          See Appendix G.


                                                            5
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

418           requirements in the tenth paragraph of [TIG SCEPACS, Section 2.1]: “For full
419           interoperability of a PACS, it must at a minimum be able to distinguish fourteen digits
420           (i.e., a combination of an Agency Code, System Code, and Credential Number) when
421           matching FASC-N based credentials to enrolled card holders.”
422       •   The Global Unique Identification number (GUID) field must be present and SHALL
423           include a Card Universally Unique Identifier (UUID) (see Section 3.4.1). The Card
424           UUID SHALL NOT be modified post-issuance.
425       •   The Expiration Date is mapped to the reserved for future use (RFU) tag 0x35, keeping
426           that within the existing scope of the TIG SCEPACS specification. This field SHALL be 8
427           bytes in length and SHALL be encoded in ASCII as YYYYMMDD. The expiration date
428           SHALL be the same as printed on the card. The expiration date SHALL NOT be
429           modified post-issuance.
430       •   The optional Cardholder UUID field is mapped to RFU tag 0x36. If present, it SHALL
431           include a Cardholder UUID as described in Section 3.4.2. The Cardholder UUID SHALL
432           NOT be modified post-issuance.
433       •   The CHUID SHALL be signed in accordance with Section 3.1.2.1. The card issuer’s
434           digital signature key SHALL be used to sign the CHUID, and the associated certificate
435           SHALL be placed in the signature field of the CHUID.

436   3.1.2.1.         Asymmetric Signature Field in CHUID
437   FIPS 201 requires inclusion of the asymmetric signature field in the CHUID data object. The
438   asymmetric signature data element of the CHUID SHALL be encoded as a Cryptographic
439   Message Syntax (CMS) external digital signature, as defined in RFC 5652 [RFC5652].
440   The issuer asymmetric signature field is implemented as a SignedData type, as specified in
441   [RFC5652], and SHALL include the following information:
442
443       •   The message SHALL include a version field specifying version v3.
444       •   The digestAlgorithms field SHALL be as specified in [SP800-78].
445       •   The encapContentInfo SHALL:
446                o Specify an eContentType of id-PIV-CHUIDSecurityObject
447                o Omit the eContent field
448       •   The certificates field SHALL include only a single X.509 certificate, which CAN be used
449           to verify the signature in the SignerInfo field.
450       •   The crls field SHALL be omitted.
451       •   signerInfos SHALL be present and include only a single SignerInfo.
452       •   The SignerInfo SHALL:
453                o Use the issuerAndSerialNumber choice for SignerIdentifier


                                                            6
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

454                o Specify a digestAlgorithm in accordance with [SP800-78]
455                o Include, at a minimum, the following signed attributes:
456                            A MessageDigest attribute containing the hash computed in accordance
457                             with [SP800-78]
458                            A pivSigner-DN attribute containing the subject name that appears in the
459                             PKI certificate for the entity that signed the CHUID
460                o Include the digital signature
461   The public key required to verify the digital signature SHALL be provided in the certificates
462   field of the CMS external digital signature in a content signing certificate, which SHALL be
463   issued under the id-fpki-common-pivcontentSigning policy of [COMMON]. The content signing
464   certificate SHALL also include an extended key usage (extKeyUsage) extension asserting id-
465   PIV-contentsigning. The content signing certificate SHALL NOT expire before the expiration of
466   the card authentication certificate.

467   3.1.3. X.509 Certificate for PIV Authentication
468   The X.509 Certificate for PIV Authentication and its associated private key, as defined in FIPS
469   201, is used to authenticate the card and the cardholder. The PIV Authentication private key and
470   its corresponding certificate are only available over the contact interface or virtual contact
471   interface (VCI). The read access control rule for the X.509 Certificate for PIV Authentication is
472   “Always,” meaning that the certificate CAN be read without access control restrictions. The
473   Public Key Infrastructure (PKI) cryptographic function (see Table 5) is protected with a
474   Personal Identification Number (PIN) or on-card biometric comparison (OCC) access rule. In
475   other words, private key operations using the PIV Authentication key require the PIN or OCC
476   data to be submitted and verified, but a successful submission enables multiple private key
477   operations without additional cardholder consent.

478   3.1.4. X.509 Certificate for Card Authentication
479   FIPS 201 specifies the mandatory asymmetric Card Authentication key (CAK) as a private key
480   that MAY be used to support physical access applications. The read access control rule of the
481   corresponding X.509 Certificate for Card Authentication is “Always,” meaning that the
482   certificate CAN be read without access control restrictions. The PKI cryptographic function (see
483   Table 5) is under an “Always” access rule so private key operations CAN performed without
484   access control restrictions. The asymmetric CAK is generated by the PIV Card Issuer in
485   accordance with FIPS 140-2 requirements for key generation. An asymmetric CAK MAY be
486   generated on-card or off-card. If an asymmetric CAK is generated off-card, the result of each key
487   generation SHALL be injected into at most one PIV Card.

488   3.1.5. Cardholder Fingerprints
489   The fingerprint data object specifies the primary and secondary fingerprints for off-card
490   matching in accordance with FIPS 201 and [SP800-76].

                                                            7
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

491   3.1.6. Cardholder Facial Image
492   The facial image data object is used for automated facial authentication in attended and
493   unattended modes (e.g., BIO or BIO-A), as well as automated facial authentication for PIV
494   reissuance and verification data reset. The facial image data object MAY also be used for visual
495   authentication by a guard (VIS). However, this authentication mechanism has been deprecated in
496   accordance with FIPS 201-3. The facial image data object SHALL be encoded as specified in
497   [SP800-76].

498   3.1.7. Security Object
499   The Security Object is in accordance with Appendix 3 to Section IV of Volume 2 of Part 3 of
500   Machine Readable Travel Documents (MRTD) [MRTD]. Tag 0xBA is used to map the
501   ContainerIDs in the PIV data model to the 16 Data Groups specified in the MRTD. The mapping
502   enables the Security Object to be fully compliant for future activities with identity documents.
503   The “DG-number-to-Container-ID” mapping object TLV in tag 0xBA encapsulates a series of
504   three-byte sequences — one for each PIV data object included in the Security Object. The first
505   byte is the Data Group (DG) number, and the second and third bytes are the most and least
506   significant bytes (respectively) of the Container ID value. The DG number assignment is
507   arbitrary. However, the same number assignment applies to the DataGroupNumber in the
508   DataGroupHash. This will ensure that the ContainerIDs in the mapping object refer to the correct
509   hash values in the Security Object (0xBB).
510   The 0xBB Security Object is formatted according to [MRTD, Appendix 3 to Section IV]. The
511   Logical Data Structure (LDS) Security Object itself must be in ASN.1 DER format, formatted as
512   specified in [MRTD, Appendix A.3.2]. This structure is then inserted into the encapContentInfo
513   field of the Cryptographic Message Syntax (CMS) object specified in [MRTD, Appendix A.3.1].
514   The card issuer’s content signing digital signature key used to sign the CHUID SHALL also be
515   used to sign the Security Object. The signature field of the Security Object, tag 0xBB, SHALL
516   omit the issuer’s content signing certificate since it is included in the CHUID. At a minimum,
517   unsigned data objects SHALL be included in the Security Object if present, such as the Printed
518   Information data object. For maximum protection against credential splicing attacks (credential
519   substitution), it is recommended, however, that all PIV data objects be included in the Security
520   Object except for the PIV X.509 certificates and the Secure Messaging Certificate Signer data
521   object.

522           Conditional Data Elements
523   The following two data elements are mandatory if the cardholder has a government-issued email
524   account at the time of credential issuance. These two data elements, when implemented, SHALL
525   conform to the specifications provided in this document.




                                                            8
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

526   3.2.1. X.509 Certificate for Digital Signature
527   The X.509 Certificate for Digital Signature and its associated private key, as defined in FIPS
528   201, support the use of digital signatures for the purpose of document signing. The digital
529   signature private key and its corresponding certificate are only available over the contact
530   interface or VCI. The read access control rule for the X.509 Certificate for Digital Signing is
531   “Always,” meaning that the certificate CAN be read without access control restrictions. The PKI
532   cryptographic function (see Table 5) is protected with a “PIN Always” or “OCC Always” access
533   rule. In other words, the PIN or OCC data must be submitted and verified every time
534   immediately before a digital signature key operation. This ensures cardholder participation every
535   time the private key is used for digital signature generation. 2

536   3.2.2. X.509 Certificate for Key Management
537   The X.509 Certificate for Key Management and its associated private key, as defined in FIPS
538   201, support the use of encryption for the purpose of confidentiality. The key management
539   private key and its corresponding certificate are only available over the contact interface or VCI.
540   This key pair MAY be escrowed by the issuer for key recovery purposes. The read access control
541   rule for the X.509 certificate is “Always,” meaning that the certificate CAN be read without
542   access control restrictions. The PKI cryptographic function (see Table 5) is protected with a
543   “PIN” or “OCC” access rule. In other words, once the PIN or OCC data is submitted and
544   verified, subsequent key management key operations CAN be performed without requiring the
545   PIN or OCC data again. This enables multiple private key operations without additional
546   cardholder consent.

547              Optional Data Elements
548   When implemented, the 27 optional data elements of FIPS 201 SHALL conform to the
549   specifications provided in this document.

550   3.3.1. Printed Information
551   All FIPS 201 mandatory information printed on the card is duplicated on the chip in that data
552   object. The printed information data object SHALL NOT be modified post-issuance. The
553   Security Object enforces integrity of this information according to the issuer. This provides
554   specific protection that the card information must match the printed information, mitigating
555   alteration risks on the printed media.

556   3.3.2. Discovery Object
557   If implemented, the Discovery Object is the 0x7E interindustry ISO/IEC 7816-6 template that
558   nests interindustry data objects. For the Discovery Object, the 0x7E template nests two


      2
        [NISTIR7863], Cardholder Authentication for the PIV Digital Signature Key, addresses the appropriate use of PIN caching related to digital
      signatures.


                                                                          9
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

559   mandatory BER-TLV structured interindustry data elements: 1) tag 0x4F contains the AID of the
560   PIV Card Application, and 2) tag 0x5F2F lists the PIN Usage Policy.
561          •    Tag 0x4F encodes the PIV Card Application AID as follows:
562                   {'4F 0B A0 00 00 03 08 00 00 10 00 01 00'}
563
564          •    Tag 0x5F2F encodes the PIN Usage Policy in two bytes:
565                   First byte:        Bit 7    is set to 1 to indicate that the mandatory PIV Card Application
566                                               PIN satisfies the PIV Access Control Rules (ACRs) for
567                                               command execution 3 and data object access.
568                                      Bit 6    indicates whether the optional Global PIN satisfies the PIV
569                                               ACRs for command execution and PIV data object access.
570                                      Bit 5    indicates whether the optional OCC satisfies the PIV ACRs for
571                                               command execution and PIV data object access.
572                                      Bit 4    indicates whether the optional VCI is implemented.
573                                      Bit 3    is set to zero if the pairing code is required to establish a VCI
574                                               and is set to one if a VCI is established without a pairing code.
575                                      Bits 8, 2, and 1 of the first byte SHALL be set to zero.
576                   Table 1 lists the acceptable values for the first byte of the PIN Usage Policy and
577                   summarizes the meaning of each value.
578                   The second byte of the PIN Usage Policy encodes the cardholder’s PIN preference for
579                   PIV Cards with both the PIV Card Application PIN and the Global PIN enabled.
580                   Second byte: 0x10 indicates that the PIV Card Application PIN is the primary PIN
581                                     used to satisfy the PIV ACRs for command execution and
582                                     object access.
583                                      0x20     indicates that the Global PIN is the primary PIN used to satisfy
584                                               the PIV ACRs for command execution and object access.
585                   Note: If Bit 6 of the first byte of the PIN Usage Policy is set to zero, then the second
586                   byte is RFU and SHALL be set to 0x00.
587                   PIV Card Applications that implement the VCI or for which the Global PIN or OCC
588                   satisfy the PIV ACRs for PIV data object access and command execution SHALL
589                   implement the Discovery Object.
590




      3
          Command execution pertains to the VERIFY APDU and, optionally, to the CHANGE REFERENCE DATA APDU.


                                                                 10
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

591                                          Table 1. First byte of PIN Usage Policy discovery

                                      PIV Card                  Global                                       Pairing Code
                           Value                                               OCC           VCI
                                      Application PIN           PIN                                          Required
                           0x40       
                           0x48                                                                            
                           0x4C                                                             
                           0x50                                               
                           0x58                                                                           
                           0x5C                                                            
                           0x60                                
                           0x68                                                                           
                           0x6C                                                            
                           0x70                                              
                           0x78                                                                          
                           0x7C                                                           

592   The encoding of the 0x7E Discovery Object is as follows:
593                {'7E 12' {'4F 0B A0 00 00 03 08 00 00 10 00 01 00'} {'5F 2F 02 xx yy'}}, where xx and
594                yy encode the first and second byte of the PIN Usage Policy, as described in this section.
595   The Security Object enforces integrity of the Discovery Object according to the issuer.

596   3.3.3. Key History Object
597   Up to 20 retired key management private keys MAY be stored in the PIV Card Application. The
598   Key History object provides information about the retired key management private keys that are
599   present within the PIV Card Application. 4 Retired key management private keys are private keys
600   that correspond to X.509 Certificates for Key Management that have expired, have been revoked,
601   or have otherwise been superseded. The Key History object SHALL be present in the PIV Card
602   Application if the PIV Card Application contains any retired key management private keys but
603   MAY be present even if no such keys are present in the PIV Card Application. For each retired
604   key management private key in the PIV Card Application, the corresponding certificate MAY
605   either be present within the PIV Card Application or MAY only be available from an online
606   repository.
607   The Key History object includes two mandatory fields, keysWithOnCardCerts and
608   keysWithOffCardCerts, and one optional field, offCardCertURL. The keysWithOnCardCerts
609   field indicates the number of retired private keys within the PIV Card Application for which the
610   corresponding certificates are also stored within the PIV Card Application. The
611   keysWithOffCardCerts field indicates the number of retired private keys within the PIV Card
612   Application for which the corresponding certificates are not stored within the PIV Card
613   Application. The numeric values in both keysWithOnCardCerts and keysWithOffCardCerts are
614   represented as unsigned binary integers. The offCardCertURL field contains a URL that points to
615   a file containing the certificates that corresponding to all of the retired private keys within the
616   PIV Card Application, including those for which the corresponding certificate is also stored
617   within the PIV Card Application. The offCardCertURL field SHALL be present if the

      4
          See NIST Interagency Report (IR) 7676 [IR7676] for suggestions on the implementation and use of the Key History mechanism.


                                                                         11
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

618   keysWithOffCardCerts value is greater than zero and SHALL be absent if the values of both
619   keysWithOnCardCerts and keysWithOffCardCerts are zero. The offCardCertURL field MAY be
620   present if the keysWithOffCardCerts value is zero but the keysWithOnCardCerts value is greater
621   than zero.
622   The file that is pointed to by the offCardCertURL field SHALL contain the DER encoding of the
623   following data structure:
624               OffCardKeyHistoryFile ::= SEQUENCE SIZE (1..20) OF SEQUENCE {
625                      keyReference          OCTET STRING (SIZE(1))
626                      cert                  Certificate
627               }
628   where keyReference is the key reference for the private key on the card and cert is the
629   corresponding X.509 certificate. 5 The offCardCertURL field SHALL have the following format:
630         "http://" <DNS name> "/" <ASCII-HEX encoded SHA-256 hash of OffCardKeyHistoryFile>
631   The private keys for which the corresponding certificates are stored within the PIV Card
632   Application SHALL be assigned to the lowest numbered key references reserved for retired key
633   management private keys. For example, if keysWithOnCardCerts is 5, then the corresponding
634   private keys SHALL be assigned to key references '82', '83', '84', '85', and '86'.
635   The private keys for which the corresponding certificates are not stored within the PIV Card
636   Application SHALL be assigned to the highest numbered key references reserved for retired key
637   management private keys. For example, if keysWithOffCardCerts is 3, then the corresponding
638   private keys SHALL be assigned to key references '93', '94', and '95'.
639   Private keys do not have to be stored within the PIV Card Application in the order of their age.
640   However, if the certificates that corresponding to only some of the retired key management
641   private keys are available within the PIV Card Application, then the certificates that are stored in
642   the PIV Card Application SHALL be the ones that were most recently issued.
643   The Key History object is only available over the contact interface and VCI. The read access
644   control rule for the Key History object is “Always,” meaning that it CAN be read without access
645   control restrictions.
646   The Security Object enforces integrity of the Key History object according to the issuer.

647   3.3.4. Retired X.509 Certificates for Key Management

648   These objects hold the X.509 Certificates for Key Management that corresponding to retired key
649   management private keys, as described in Section 3.3.3. Retired key management private keys
650   and their corresponding certificates are only available over the contact interface or VCI. The read
651   access control rule for these certificates is “Always,” meaning that the certificates CAN be read
652   without access control restrictions. The PKI cryptographic function (see Table 5) for all of the
653   retired key management private keys is protected with a “PIN” or “OCC” access rule. In other
654   words, once the PIN or OCC data is submitted and verified, subsequent key management key
655   operations CAN be performed with any of the retired key management private keys without

      5
          The ASN.1 for Certificate may be imported from the ASN.1 module PKIX1Explicit88 in Appendix A.1 of [RFC5280].


                                                                     12
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

656   requiring the PIN or OCC data again. This enables multiple private key operations without
657   additional cardholder consent.

658   3.3.5. Cardholder Iris Images
659   The iris images data object specifies compact images of the cardholder’s irises. The images are
660   suitable for use in iris recognition systems for automated identity verification. The iris images
661   data object SHALL be encoded as specified in [SP800-76].

662   3.3.6. Biometric Information Templates Group Template
663   The Biometric Information Templates (BIT) Group data object encodes the configuration
664   information of the OCC data. The encoding of the BIT Group Template SHALL be as specified
665   in Table 7 of [SP800-76]. When OCC satisfies the PIV ACRs for PIV data objects access and
666   command execution, both the Discovery Object and the BIT Group Template data object
667   SHALL be present, and bit 5 of the first byte of the PIN Usage Policy SHALL be set. The BIT
668   Group Template MAY be present when OCC does not satisfy the PIV ACRs for PIV data objects
669   access but, if present, SHALL contain no BITs. 6 The Security Object enforces integrity of the
670   BIT Group Template data object according to the issuer.

671   3.3.7. Secure Messaging Certificate Signer
672   The Secure Messaging Certificate Signer data object, which SHALL be present if the PIV Card
673   supports secure messaging for non-card management operations, contains the certificates needed
674   to verify the signature on the secure messaging card verifiable certificate (CVC), as specified in
675   SP 800-73-5 Part 2, Section 4.1.5.
676   The public key required to verify the digital signature of the secure messaging CVC is an ECC
677   key. It SHALL be provided in either an X.509 Certificate for Content Signing or an Intermediate
678   CVC. If the public key required to verify the digital signature of the secure messaging CVC is
679   provided in an Intermediate CVC, then the format of the Intermediate CVC SHALL be as
680   specified in SP 800-73-5 Part 2, Section 4.1.5, and the public key required to verify the digital
681   signature of the Intermediate CVC SHALL be provided in an X.509 Certificate for Content
682   Signing.
683   The X.509 Certificate for Content Signing SHALL be a digital signature certificate issued under
684   the id-fpki-common-piv-contentSigning policy of [COMMON]. The X.509 Certificate for
685   Content Signing SHALL also include an extended key usage (extKeyUsage) extension asserting
686   id-PIV-content-signing. Additional descriptions for the PIV object identifiers are provided in
687   Appendix B of FIPS 201-3. The X.509 Certificate for Content Signing needed to verify the
688   digital signature of a secure messaging CVC or Intermediate CVC of a valid PIV Card 7 SHALL
689   NOT be expired.



      6
          A BIT Group Template with no BITs is encoded as '7F 61 03 02 01 00'.
      7
          A valid PIV Card is defined as a PIV Card that is neither expired nor revoked.


                                                                             13
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

690   Note that the option to include an Intermediate CVC is included as a temporary measure to
691   accommodate the use of certification authorities that do not support the issuance of X.509
692   certificates that contain elliptic curve subject public keys. A future version of SP 800-73 is
693   expected to deprecate the Intermediate CVC data element.

694   3.3.8. Pairing Code Reference Data Container
695   The Pairing Code Reference Data Container, which SHALL be present if the PIV Card supports
696   the virtual contact interface, includes a copy of the PIV Card’s pairing code (see Section 5.1.3).
697   The Security Object enforces the integrity of the Pairing Code Reference Data Container
698   according to the issuer.

699           Inclusion of Universally Unique Identifiers (UUIDs)
700   This specification provides support for two UUIDs on a PIV Card. The Card UUID is unique for
701   each card, and it SHALL be present on all PIV Cards. The Cardholder UUID is a persistent
702   identifier for the cardholder, and it is optional to implement. The requirements for these UUIDs
703   are provided in the following subsections.

704   3.4.1. Card UUID
705   FIPS 201 requires PIV Cards to include a Card UUID. The Card UUID SHALL be included on
706   PIV Cards as follows:
707       1. The value of the GUID data element of the CHUID data object SHALL be a 16-byte
708          binary representation of a valid UUID [RFC4122]. The UUID SHALL be version 1, 4, or
709          5, as specified in [RFC4122, Section 4.1.3].
710       2. The same 16-byte binary representation of the UUID value SHALL be present as the
711          value of an entryUUID attribute, as defined in [RFC4530], in any CMS-signed data
712          object that is required to contain a pivFASC-N attribute on a PIV Card (i.e., in the
713          mandatory cardholder fingerprint template and facial image data objects as well as in the
714          optional cardholder iris images data object when present.
715       3. If the PIV Card supports secure messaging and/or authentication using the secure
716          messaging key, then the same 16-byte binary representation of the UUID value SHALL
717          be used as the Subject Identifier in the secure messaging CVC, as specified in SP 800-73-
718          5 Part 2, Section 4.1.5.
719       4. The string representation of the same UUID value SHALL be present in the X.509
720          Certificate for PIV Authentication and the X.509 Certificate for Card Authentication in
721          the subjectAltName extension encoded as a URI, as specified by [RFC4122, Section 3].




                                                            14
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

722   3.4.2. Cardholder UUID
723   As defined in Section 3.1.2, the CHUID MAY optionally include a Cardholder UUID. When
724   present, the Cardholder UUID SHALL be a 16-byte binary representation of a valid UUID, and
725   it SHALL be version 1, 4, or 5, as specified in [RFC4122, Section 4.1.3].

726              Data Object Containers and Associated Access Rules and Interface Modes
727   Table 2 defines a high-level view of the data model. Each on-card storage container is labeled as
728   mandatory (M), optional (O), or conditional (C). The conditional data objects are the digital
729   signature key and the key management key, which are mandatory if the cardholder has a
730   government-issued email account at the time of credential issuance. This data model is designed
731   to enable and support dual interface cards. For dual chip implementations for any container that
732   can be accessed over both the contact interface and the contactless interface (including the virtual
733   contact interface), the data object SHALL be copied into the corresponding containers on both
734   chips. 8
735                                                     Table 2. Data Model Containers

                                                                                                   Access Rule for Read
                           Container Name                             ContainerID                                                         M/O/C
                                                                                              Contact              Contactless 9
         Card Capability Container                                    0xDB00               Always             VCI                         M
         Card Holder Unique Identifier                                0x3000               Always             Always                      M
         X.509 Certificate for PIV Authentication                     0x0101               Always             VCI                         M
         Cardholder Fingerprints                                      0x6010               PIN                VCI and PIN                 M
         Security Object                                              0x9000               Always             VCI                         M
         Cardholder Facial Image                                      0x6030               PIN                VCI and PIN                 M
         X.509 Certificate for Card Authentication                    0x0500               Always             Always                      M
         X.509 Certificate for Digital Signature                      0x0100               Always             VCI                         C
         X.509 Certificate for Key Management                         0x0102               Always             VCI                         C
         Printed Information                                          0x3001               PIN or OCC         VCI and (PIN or             O
                                                                                                              OCC)
         Discovery Object                                             0x6050               Always             Always                      O
         Key History Object                                           0x6060               Always             VCI                         O
         Retired X.509 Certificate for Key                            0x1001               Always             VCI                         O
         Management 1
         Retired X.509 Certificate for Key                            0x1002               Always             VCI                         O
         Management 2
         Retired X.509 Certificate for Key                            0x1003               Always             VCI                         O
         Management 3
         Retired X.509 Certificate for Key                            0x1004               Always             VCI                         O
         Management 4
         Retired X.509 Certificate for Key                            0x1005               Always             VCI                         O
         Management 5

      8
        As a consequence of this requirement, any keys that have to be generated on card CANNOT be made available over the contactless interface
      (including the virtual contact interface) in a dual chip implementation. In addition, the asymmetric CAK needs to be generated off-card and
      loaded onto both chips for dual chip implementations.
      9
        The term “virtual contact interface (VCI)” is used in this document as shorthand for the following security condition: (command is submitted
      over secure messaging) AND (the Discovery Object is present) AND (Bit 4 of the first byte of the PIN Usage Policy is one) AND ((the security
      status indicator associated with the pairing code is TRUE) OR (Bit 3 of the first byte of the PIN Usage Policy is one)).


                                                                         15
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

                                                                                Access Rule for Read
                      Container Name                     ContainerID                                           M/O/C
                                                                            Contact         Contactless 9
        Retired X.509 Certificate for Key                0x1006          Always          VCI                   O
        Management 6
        Retired X.509 Certificate for Key                0x1007          Always          VCI                   O
        Management 7
        Retired X.509 Certificate for Key                0x1008          Always          VCI                   O
        Management 8
        Retired X.509 Certificate for Key                0x1009          Always          VCI                   O
        Management 9
        Retired X.509 Certificate for Key                0x100A          Always          VCI                   O
        Management 10
        Retired X.509 Certificate for Key                0x100B          Always          VCI                   O
        Management 11
        Retired X.509 Certificate for Key                0x100C          Always          VCI                   O
        Management 12
        Retired X.509 Certificate for Key                0x100D          Always          VCI                   O
        Management 13
        Retired X.509 Certificate for Key                0x100E          Always          VCI                   O
        Management 14
        Retired X.509 Certificate for Key                0x100F          Always          VCI                   O
        Management 15
        Retired X.509 Certificate for Key                0x1010          Always          VCI                   O
        Management 16
        Retired X.509 Certificate for Key                0x1011          Always          VCI                   O
        Management 17
        Retired X.509 Certificate for Key                0x1012          Always          VCI                   O
        Management 18
        Retired X.509 Certificate for Key                0x1013          Always          VCI                   O
        Management 19
        Retired X.509 Certificate for Key                0x1014          Always          VCI                   O
        Management 20
        Cardholder Iris Images                           0x1015          PIN             VCI and PIN           O
        Biometric Information Templates Group            0x1016          Always          Always                O
        Template
        Secure Messaging Certificate Signer              0x1017          Always          Always                O
        Pairing Code Reference Data Container            0x1018          PIN or OCC      VCI and (PIN or       O
                                                                                         OCC)

736   Appendix A provides a detailed spreadsheet for the data model. ContainerIDs and tags within the
737   containers for each data object are defined by this data model in accordance with SP 800-73-5
738   naming conventions.




                                                            16
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

739        PIV Data Objects Representation

740              Data Objects Definition
741   A data object is an item of information seen on the card command interface that has a specified
742   name, a description of logical content, a format, and a coding. Each data object has a globally
743   unique name called its object identifier (OID), as defined in ISO/IEC 8824-2:2002 [ISO8824].
744   A data object whose data content is encoded as a BER-TLV data structure, as in ISO/IEC 8825-
745   1:2002 [ISO8825], is called a BER-TLV data object.

746   4.1.1. Data Object Content
747   The content of a data object is the sequence of bytes that are said to be contained in or to be the
748   value of the data object. The number of bytes in this byte sequence is referred to as the length of
749   the data content as well as the size of the data object. The first byte in the sequence is regarded as
750   being at byte position or offset zero in the content of the data object.
751   The data content of a BER-TLV data object MAY consist of other BER-TLV data objects. In
752   this case, the tag of the data object indicates that the data object is a constructed data object. A
753   BER-TLV data object that is not a constructed data object is called a primitive data object.
754   The PIV data objects are BER-TLV objects encoded as per [ISO8825]. However, tag values of
755   the PIV data object’s inner tag assignments do not conform to BER-TLV requirements 10 due to
756   the need to accommodate legacy tags inherited from [GSC-IS].
757   Before the card is issued, data objects that are created but not used SHALL be set to zero-length
758   value.

759              OIDs and Tags of PIV Card Application Data Objects
760   Table 3 lists the ASN.1 object identifiers and BER-TLV tags of the thirty-six PIV Card
761   Application data objects. For the purpose of constructing PIV Card Application data object
762   names in the CardApplicationURL in the CCC of the PIV Card Application, the NIST RID ('A0
763   00 00 03 08') SHALL be used and the card application type SHALL be set to '00'.

764              Object Identifiers
765   Each of the data objects in the PIV Card Application has been provided with a BER-TLV tag and
766   an ASN.1 OID from the NIST personal identity verification arc. These object identifier
767   assignments are given in Table 3.
768   A data object SHALL be identified on the PIV client-application programming interface using its
769   OID. An object identifier on the PIV client-application programming interface SHALL be a dot-
770   delimited string of the integer components of the OID. For example, the representation of the

      10
         The exception does not apply to the BIT Group template, the Discovery Object, or the Application Property Template (APT) since these objects
      use interindustry tags from ISO/IEC 7816-6.


                                                                         17
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

771   OID of the CHUID on the PIV client-application programming interface is
772   “2.16.840.1.101.3.7.2.48.0.”
773   A data object SHALL be identified on the PIV Card Application card command interface using
774   its BER-TLV tag. For example, the CHUID is identified on the card command interface to the
775   PIV Card Application by the three-byte identifier '5FC102'.
776   Table 2 lists the ACRs of the thirty-six PIV Card Application data objects.
777                      Table 3. Object identifiers of the PIV data objects for interoperable use

                                                                                                BER-
                 Data Object for Interoperable Use                   ASN.1 OID                             M/O/C
                                                                                              TLV Tag
            Card Capability Container                       2.16.840.1.101.3.7.1.219.0       '5FC107'      M
            Card Holder Unique Identifier                   2.16.840.1.101.3.7.2.48.0        '5FC102'      M
            X.509 Certificate for PIV Authentication        2.16.840.1.101.3.7.2.1.1         '5FC105'      M
            Cardholder Fingerprints                         2.16.840.1.101.3.7.2.96.16       '5FC103'      M
            Security Object                                 2.16.840.1.101.3.7.2.144.0       '5FC106'      M
            Cardholder Facial Image                         2.16.840.1.101.3.7.2.96.48       '5FC108'      M
            X.509 Certificate for Card Authentication       2.16.840.1.101.3.7.2.5.0         '5FC101'      M
            X.509 Certificate for Digital Signature         2.16.840.1.101.3.7.2.1.0         '5FC10A'      C
            X.509 Certificate for Key Management            2.16.840.1.101.3.7.2.1.2         '5FC10B'      C
            Printed Information                             2.16.840.1.101.3.7.2.48.1        '5FC109'      O
            Discovery Object                                2.16.840.1.101.3.7.2.96.80       '7E'          O
            Key History Object                              2.16.840.1.101.3.7.2.96.96       '5FC10C'      O
            Retired X.509 Certificate for Key               2.16.840.1.101.3.7.2.16.1        '5FC10D'
                                                                                                           O
            Management 1
            Retired X.509 Certificate for Key               2.16.840.1.101.3.7.2.16.2        '5FC10E'
                                                                                                           O
            Management 2
            Retired X.509 Certificate for Key               2.16.840.1.101.3.7.2.16.3        '5FC10F'
                                                                                                           O
            Management 3
            Retired X.509 Certificate for Key               2.16.840.1.101.3.7.2.16.4        '5FC110'
                                                                                                           O
            Management 4
            Retired X.509 Certificate for Key               2.16.840.1.101.3.7.2.16.5        '5FC111'
                                                                                                           O
            Management 5
            Retired X.509 Certificate for Key               2.16.840.1.101.3.7.2.16.6        '5FC112'
                                                                                                           O
            Management 6
            Retired X.509 Certificate for Key               2.16.840.1.101.3.7.2.16.7        '5FC113'
                                                                                                           O
            Management 7
            Retired X.509 Certificate for Key               2.16.840.1.101.3.7.2.16.8        '5FC114'
                                                                                                           O
            Management 8
            Retired X.509 Certificate for Key               2.16.840.1.101.3.7.2.16.9        '5FC115'
                                                                                                           O
            Management 9
            Retired X.509 Certificate for Key               2.16.840.1.101.3.7.2.16.10       '5FC116'
                                                                                                           O
            Management 10
            Retired X.509 Certificate for Key               2.16.840.1.101.3.7.2.16.11       '5FC117'
                                                                                                           O
            Management 11
            Retired X.509 Certificate for Key               2.16.840.1.101.3.7.2.16.12       '5FC118'
                                                                                                           O
            Management 12
            Retired X.509 Certificate for Key               2.16.840.1.101.3.7.2.16.13       '5FC119'
                                                                                                           O
            Management 13
            Retired X.509 Certificate for Key               2.16.840.1.101.3.7.2.16.14       '5FC11A'
                                                                                                           O
            Management 14


                                                            18
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

                                                                                                BER-
                 Data Object for Interoperable Use                   ASN.1 OID                             M/O/C
                                                                                              TLV Tag
            Retired X.509 Certificate for Key               2.16.840.1.101.3.7.2.16.15       '5FC11B'
                                                                                                           O
            Management 15
            Retired X.509 Certificate for Key               2.16.840.1.101.3.7.2.16.16       '5FC11C'
                                                                                                           O
            Management 16
            Retired X.509 Certificate for Key               2.16.840.1.101.3.7.2.16.17       '5FC11D'
                                                                                                           O
            Management 17
            Retired X.509 Certificate for Key               2.16.840.1.101.3.7.2.16.18       '5FC11E'
                                                                                                           O
            Management 18
            Retired X.509 Certificate for Key               2.16.840.1.101.3.7.2.16.19       '5FC11F'
                                                                                                           O
            Management 19
            Retired X.509 Certificate for Key               2.16.840.1.101.3.7.2.16.20       '5FC120'
                                                                                                           O
            Management 20
            Cardholder Iris Images                          2.16.840.1.101.3.7.2.16.21       '5FC121'      O
            Biometric Information Templates Group           2.16.840.1.101.3.7.2.16.22       '7F61'
                                                                                                           O
            Template
            Secure Messaging Certificate Signer             2.16.840.1.101.3.7.2.16.23       '5FC122'      O
            Pairing Code Reference Data Container           2.16.840.1.101.3.7.2.16.24       '5FC123'      O
778




                                                            19
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

779           Data Types and Their Representation
780   This section describes the data types used in the PIV Client Application Programming Interface
781   (SP 800-73-5, Part 3) and PIV Card Command Interface (SP 800-73-5, Part 2). Unless otherwise
782   indicated, the representation SHALL be the same on both interfaces.
783   The data types are defined in Part 1 rather than in Parts 2 and 3 in order to achieve smart card
784   platform independence from Part 1. Thus, non-government smart card programs can readily
785   adopt the interface specifications in Parts 2 and 3 while customizing Part 1 to their own data
786   model, data types, and namespaces.

787                 Key References
788   A key reference is a 1-byte reference data identifier that specifies a cryptographic key or PIN
789   according to its PIV Key Type. Table 4, Table 5, and SP 800-78, Table 8, define the key
790   reference values that SHALL be used on the PIV interfaces. For example, the key reference
791   values are used in a cryptographic protocol, such as an authentication or a signing protocol. Key
792   references are only assigned to private and secret (symmetric) keys, PINs, PIN Unblocking Keys
793   (PUKs), OCC, and the pairing code. All other PIV Card Application key reference values are
794   reserved for future use.
795   In accordance with FIPS 201, no more than 10 consecutive activation retries for each of the
796   activation methods (i.e., PIN and OCC attempts) SHALL be permitted. Issuers MAY further
797   restrict the maximum retry limit to a lower value, as indicated in Table 4 below.
798                                     Table 4. PIV Card Application authentication data references

             Key                 PIV                                                                                     Retry     Number
                                                     Authenticable
           Reference           Reference                                      Security Condition for Use                Counter       of
                                                        Entity
            Value              Data Type                                                                                 Value     Unblocks
                                                                                Contact            Contactless
                                                                                                                        10 or      Platform
           '00'             Global PIN             Cardholder                Always              VCI
                                                                                                                        lower      Specific
                            PIV Card
                                                                                                                        10 or      Issuer
           '80'             Application            Cardholder                Always              VCI
                                                                                                                        lower      Specific
                            PIN
                            PIN                    PIV Card
                                                                                                                        Issuer     Issuer
           '81'             Unblocking             Application               Always              Never
                                                                                                                        Specific   Specific
                            Key                    Administrator
                            Primary Finger                                                                              10 or      Issuer
           '96'                                    Cardholder                Always              SM
                            OCC                                                                                         lower      Specific
                            Secondary                                                                                   10 or      Issuer
           '97'                                    Cardholder                Always              SM
                            Finger OCC                                                                                  lower      Specific
                                                                                                                        Issuer     Issuer
           '98'             Pairing Code           Cardholder                Always 11           SM
                                                                                                                        Specific   Specific




      11
           The sole use of the pairing code is the establishment of a VCI. Its use over the contact interface serves no purpose.


                                                                               20
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

799                                           Table 5. PIV Card Application key references

                       Key Reference
                                                 PIV Key Type           Administrator            Security Condition for Use
                     Value (i.e., Key ID)
                                                                                                  Contact            Contactless
                                                 PIV Secure            PIV Card
                    '04'                         Messaging             Application              Always             Always
                                                 Key                   Administrator
                                                 PIV                   PIV Card
                                                                                                                   VCI and (PIN
                    '9A'                         Authentication        Application              PIN or OCC
                                                                                                                   or OCC)
                                                 Key                   Administrator
                                                 PIV Card
                                                                       PIV Card
                                                 Application
                    '9B'                                               Application              Always             Never
                                                 Administration
                                                                       Administrator
                                                 Key
                                                                       PIV Card                 PIN Always         VCI and (PIN
                                                 Digital
                    '9C'                                               Application              or OCC             Always or
                                                 Signature Key
                                                                       Administrator            Always             OCC Always)
                                                 Key                   PIV Card
                                                                                                                   VCI and (PIN
                    '9D'                         Management            Application              PIN or OCC
                                                                                                                   or OCC)
                                                 Key                   Administrator
                                                 Card                  PIV Card
                    '9E'                         Authentication        Application              Always             Always
                                                 Key 12                Administrator
                    '82', '83', '84', '85',
                    '86', '87', '88', '89',      Retired Key           PIV Card
                                                                                                                   VCI and (PIN
                    '8A', '8B', '8C', '8D',      Management            Application              PIN or OCC
                                                                                                                   or OCC)
                    '8E', '8F', '90', '91',      Key                   Administrator
                    '92', '93', '94', '95'

800   Secure messaging (SM) is defined in Section 5.4, and VCI is defined in Section 5.5. Table 2 of
801   SP 800-73-5 Part 2 specifies the security conditions for each command.
802   When represented as a byte, the key reference occupies bits b8 and b5-b1, while b7 and b6
803   SHALL be set to 0. If b8 is 0, then the key reference names global reference data. If b8 is 1, then
804   the key reference names application-specific reference data.
805   The access control rules for PIV data object access SHALL reference the PIV Card Application
806   PIN and MAY optionally reference the cardholder Global PIN or OCC data. If the Global PIN is
807   used by the PIV Card Application, then the Global PIN format SHALL follow the PIV Card
808   Application PIN format defined in Section 2.4.3 of SP 800-73-5 Part 2.
809   PIV Card Applications with the Discovery Object and Bit 6 of the first byte of the PIN Usage
810   Policy value set to one, as per Section 3.3.2, SHALL reference the PIV Card Application PIN
811   and the cardholder Global PIN in the access control rules for PIV data object access.
812   Additionally, the PIV Card Application card commands CAN change the status of the Global
813   PIN and MAY change its reference data while the PIV Card Application is the currently selected
814   application.


      12
         A card may optionally have a symmetric CAK in addition to the mandatory asymmetric CAK, in which case both keys would share the same
      key reference and access control rules. However, the use of the symmetric card authentication key has been deprecated in FIPS 201-3 and may be
      removed in a future version of the standard.


                                                                        21
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

815   The rest of the document uses “PIN” to mean either the PIV Card Application PIN or the Global
816   PIN.

817   5.1.1. OCC Data
818   This document does not specify how the biometric reference data and comparison parameters are
819   stored internally on the card. Moreover, the export of the biometric reference data SHALL NOT
820   be allowed. Configuration data related to the biometric reference data MAY be read from the tag
821   0x7F61 BIT Group template data object (see Section 3.3.6). Configuration data is defined in
822   Table 7 of [SP800-76]. The fingerprints used for OCC MAY be taken from the full set of
823   fingerprints collected for PIV background investigations and SHOULD be imaged from fingers
824   not imaged for off-card one-to-one comparison.

825   5.1.2. PIV Secure Messaging Key
826   If the PIV Card supports secure messaging, the PIV Secure Messaging key SHALL be generated
827   on the PIV Card, and the PIV Card SHALL NOT permit exportation of the PIV Secure
828   Messaging key. The cryptographic operations that use the PIV Secure Messaging key SHALL be
829   available through the contact and contactless interfaces of the PIV Card. The PKI cryptographic
830   function (see Table 5) is under an “Always” access rule, and thus private key operations (i.e.,
831   use of the key to establish session keys for secure messaging) CAN be performed without access
832   control restrictions.
833   The PIV Card SHALL store a corresponding secure messaging CVC to support validation of the
834   public key by the relying party. The format for the secure messaging CVC SHALL be as
835   specified in SP 800-73-5 Part 2, Section 4.1.5. The public key required to verify the digital
836   signature of the secure messaging CVC SHALL be provided in a certificate in the Secure
837   Messaging Certificate Signer data object, as specified in Section 3.3.7.

838   5.1.3. Pairing Code
839   If the PIV Card supports the virtual contact interface, then it SHALL implement support for the
840   pairing code. If implemented, the pairing code SHALL consist of eight decimal digits, and it
841   SHALL be generated at random by the PIV Card Issuer. The results of each random pairing code
842   generation SHALL be loaded onto — at most — one PIV Card and CANNOT be changed by the
843   cardholder. The pairing code value for a PIV Card SHALL be stored in the Pairing Code
844   Reference Data Container (see Section 3.3.8) on the card and MAY be printed on the back of the
845   card in an agency-specific text area (i.e., Zones 9B or 10B). PIV Card Issuers MAY choose to
846   provide the pairing code value to the cardholder in another manner, such as printing it on a slip
847   of paper rather than printing it on the back of the card. 13
848   Unlike the PIV Card Application PIN or the Global PIN, there are no restrictions on the caching
849   of the pairing code by client applications. It is recommended that a client application that needs
      13
         While printing the value of the pairing code on the back of the card provides maximum convenience for use by the cardholder and avoids any
      risk that the cardholder will forget the pairing code, it may create a risk that an attacker could obtain the value of the pairing code by
      surreptitiously reading it from the back of the card. Departments and agencies will need to make a risk-based decision when determining the
      method by which they provide cardholders with the values of their pairing codes.


                                                                         22
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

850   to communicate with a PIV Card over its virtual contact interface obtain the card’s pairing code
851   during a registration step by asking the cardholder to enter the value or by reading it from the
852   card over the contact interface from the Pairing Code Reference Data Container and then cache
853   the pairing code until the card expires. 14 The client application MAY then connect to the card
854   and establish a virtual contact interface with it whenever the card is within read-range of the
855   client application’s contactless card reader without needing to prompt the cardholder.

856                 PIV Algorithm Identifier
857   A PIV algorithm identifier is a 1-byte identifier of a cryptographic algorithm. The identifier
858   specifies a cryptographic algorithm and key size. For symmetric cryptographic operations, the
859   algorithm identifier also specifies a mode of operation (i.e., ECB). SP 800-78, Table 9 lists the
860   PIV algorithm identifiers for the cryptographic algorithms that MAY be recognized on the PIV
861   interfaces.

862                 Cryptographic Mechanism Identifiers
863   Cryptographic mechanism identifiers are defined in Table 6. These identifiers serve as inputs to
864   the GENERATE ASYMMETRIC KEY PAIR card command and the SP 800-73-5 Part 3
865   pivGenerateKeyPair() client API function call, which initiates the generation and storage of the
866   asymmetric key pair.
867                                                Table 6. Cryptographic mechanism identifiers

                                           Cryptographic
                                             Mechanism                    Description                  Parameter
                                               Identifier
                                          ‘05’                      RSA 3072                     Optional public
                                                                                                 exponent encoded
                                                                                                 big-endian
                                          '07'                      RSA 2048                     Optional public
                                                                                                 exponent encoded
                                                                                                 big-endian
                                          '11'                      ECC: Curve P-256             None
                                          '14'                      ECC: Curve P-384             None

868   Higher strength keys are recommended per SP 800-56 Part 1 starting in 2031. See SP 800-78-5,
869   Tables 9 and 10, which reflect support for higher strength keys for PIV cards and supporting
870   systems, where applicable.

871   All other cryptographic mechanism identifier values are reserved for future use.




      14
           As noted in Section 5.5, the pairing code does not need to be submitted if the Bit 3 of the first byte of the PIN Usage Policy is set to one.


                                                                               23
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

872              Secure Messaging and Authentication Using a Secure Messaging Key (SM-
873              AUTH)
874   A PIV Card Application MAY optionally support SM. When secure messaging is established,
875   the PIV Card Application is authenticated to the relying system, and a set of symmetric session
876   keys are established. The symmetric session keys are used to provide confidentiality and
877   integrity protection for the card commands that are sent to the card using secure messaging as
878   well as for the responses from the PIV Card.
879   If implemented, SM for non-card management operations SHALL only be established using the
880   PIV Secure Messaging key specified in Table 5 and the SM protocol in accordance with the
881   specifications in Section 4 of SP 800-73-5 Part 2.
882   A PIV Card Application may optionally support authentication using the Secure Messaging key
883   (SM-AUTH). When SM-AUTH is supported, the PIV Card and therefore the cardholder is
884   authenticated to the relying system.

885              Virtual Contact Interface
886   The term “virtual contact interface (VCI)” is used in this document as shorthand for a security
887   condition. As described in access control rules in this document and in SP 800-73-5 Part 2, all
888   non-card management operations that are allowed over the contact interface MAY be carried out
889   over the contactless interface if the VCI security condition is satisfied. Support for the VCI is
890   optional.
891   The VCI security condition supports two different configurations for the establishment of the
892   VCI. In the default (and recommended) configuration, the VCI is only established after both
893   secure messaging has been established and the pairing code has been presented to the card using
894   secure messaging. In the non-default configuration, the VCI is established through secure
895   messaging without any further steps.
896   The VCI security condition is:
897           (command is submitted over secure messaging) AND (the Discovery Object is present)
898           AND (Bit 4 of the first byte of the PIN Usage Policy is one) AND ((the security status
899           indicator associated with the pairing code is TRUE) OR (Bit 3 of the first byte of the PIN
900           Usage Policy is one))
901   PIV Card Applications that support the VCI SHALL support the configuration in which Bit 3 of
902   the first byte of the PIN Usage Policy is set to zero (i.e., the configuration in which submission
903   of the pairing code to the PIV Card Application is required to establish the VCI) and MAY
904   additionally support the configuration in which Bit 3 of the first byte of the PIN Usage Policy is
905   set to one. Card management systems (CMS) SHALL be configured to set Bit 3 of the first byte
906   of the PIN Usage Policy to zero by default whenever the Discovery Object is present.
907   Requiring that the pairing code be submitted to the PIV Card Application in order to establish the
908   VCI protects the previously contact-restricted X.509 certificates from skimming 15 and also

      15
         Skimming is when data is surreptitiously obtained from a contactless card using a hidden reader that powers, commands, and reads from the
      card within the maximum read distance (reported as about 25 cm with ISO/IEC 14443 smart cards like the PIV Card).


                                                                         24
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

909   protects PIN-based card activation from being blocked. While it is recommended that the default
910   configuration of CMSs remain unchanged, the configuration of a CMS MAY be changed to set
911   Bit 3 of the first byte of the PIN Usage Policy to one (i.e., to configure PIV Cards to establish
912   VCIs without the submission of a pairing code) if the configuration change is approved by the
913   designated approving authority (DAA) and if compensating controls are implemented to ensure
914   that personally identifiable information (e.g., name, email address, and organization) CANNOT
915   be skimmed from the PIV Card when in close proximity when the card is outside of its protective
916   sleeve.
917   A DAA’s decision to approve the issuance of PIV Cards that implement the VCI without
918   requiring the pairing code SHALL be based on a risk assessment that weighs the perceived
919   benefit against the risk of unauthorized disclosure of cardholder data exposing previously
920   contact-restricted X.509 certificates to skimming. The previously contact-restricted X.509
921   certificates include information about the cardholder, such as name and email address.
922   Compensating controls SHALL be captured in the appropriate system security plan. 16 Systems
923   that accept externally issued PIV Cards SHALL be able to accept PIV Cards with either VCI
924   configuration.

925                Status Words
926   A status word (SW) is a 2-byte value returned by a card command at the card edge. The first byte
927   of a status word is referred to as SW1, and the second byte of a status word is referred to as
928   SW2.
929   Recognized values of all SW1-SW2 pairs used as return values on the card command interface
930   and their interpretation are given in Table 7. The descriptions of individual card commands
931   provide additional information for interpreting returned status words.
932                                                             Table 7. Status words

                          SW1          SW2                                       Meaning
                                                  Successful execution where SW2 encodes the number of response
                        '61'         'xx'
                                                  data bytes still available
                        '63'         '00'         Verification failed
                                                  Verification failed, X indicates the number of further allowed retries
                        '63'         'CX'
                                                  or resets
                        '68'         '82'         Secure messaging not supported
                        '69'         '82'         Security status not satisfied
                        '69'         '83'         Authentication method blocked
                        '69'         '87'         Expected secure messaging data objects are missing
                        '69'         '88'         Secure messaging data objects are incorrect
                        '6A'         '80'         Incorrect parameter in command data field
                        '6A'         '81'         Function not supported
                        '6A'         '82'         Data object or application not found
                        '6A'         '84'         Not enough memory
                        '6A'         '86'         Incorrect parameter in P1 or P2
                        '6A'         '88'         Referenced data or reference data not found
                        '90'         '00'         Successful execution

      16
           See SP 800-18r1, Guide for Developing Security Plans for Federal Information Systems.


                                                                          25
      NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
      September 2023                                 PIV Card Application Namespace, Data Model, and Representation

933   References
934   [COMMON]              X.509 Certificate Policy for the U.S. Federal PKI Common Policy
935                         Framework, Version 2.4, April 2023 [or as amended]. Available at
936                         https://www.idmanagement.gov/docs/fpki-x509-cert-policy-common.pdf
937   [FIPS180]             National Institute of Standards and Technology (2015) Secure Hash Standard
938                         (SHS). (U.S. Department of Commerce, Washington, DC), Federal
939                         Information Processing Standards Publication (FIPS) 180-4 [or as amended].
940                         https://doi.org/10.6028/NIST.FIPS.180-4
941   [FIPS201]             National Institute of Standards and Technology (2022) Personal Identity
942                         Verification (PIV) of Federal Employees and Contractors. (U.S. Department
943                         of Commerce, Washington, DC), Federal Information Processing Standards
944                         Publication (FIPS) 201-3. https://doi.org/10.6028/NIST.FIPS.201-3
945   [GSC-IS]              Schwarzhoff TT, Dray JF, Jr., Wack JP, Dalci E, Goldfine A, Iorga M (2003)
946                         Government Smart Card Interoperability Specification, Version 2.1. (National
947                         Institute of Standards and Technology, Gaithersburg, MD), NIST Interagency
948                         or Internal Report (IR) 6887, 2003 Edition [or as amended].
949                         https://doi.org/10.6028/NIST.IR.6887e2003
950   [IR7676]              Cooper DA (2010) Maintaining and Using Key History on Personal Identity
951                         Verification (PIV) Cards. (National Institute of Standards and Technology,
952                         Gaithersburg, MD), NIST Interagency or Internal Report (IR) 7676.
953                         https://doi.org/10.6028/NIST.IR.7676
954   [IR7863]              Polk WT, Ferraiolo H, Cooper DA (2015) Cardholder Authentication for the
955                         PIV Digital Signature Key. (National Institute of Standards and Technology,
956                         Gaithersburg, MD), NIST Interagency or Internal Report (IR) 7863. Available
957                         at https://doi.org/10.6028/NIST.IR.7863
958   [ISO7816]             International Organization for Standardization/International Electrotechnical
959                         Commission (2004-2020) ISO/IEC 7816 — Identification cards — Integrated
960                         circuit cards. (multiple parts):
961                          International Organization for Standardization/International
962                             Electrotechnical Commission (2020) ISO/IEC 7816-4:2020 —
963                             Identification cards — Integrated circuit cards — Part 4: Organization,
964                             security and commands for interchange. (International Organization for
965                             Standardization, Geneva, Switzerland) [or as amended]. Available at
966                             https://www.iso.org/standard/77180.html
967                          International Organization for Standardization/International
968                             Electrotechnical Commission (2004) ISO/IEC 7816-5:2004 —
969                             Identification cards — Integrated circuit cards — Part 5: Registration of
970                             application providers. (International Organization for Standardization,
971                             Geneva, Switzerland) [or as amended]. Available at
972                             https://www.iso.org/standard/34259.html
973                          International Organization for Standardization/International
974                             Electrotechnical Commission (2016) ISO/IEC 7816-6:2016 —
975                             Identification cards — Integrated circuit cards — Part 6: Interindustry data
976                             elements for interchange. (International Organization for Standardization,


                                                            26
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

 977                             Geneva, Switzerland) [or as amended]. Available at
 978                             https://www.iso.org/standard/64598.html
 979                          International Organization for Standardization/International
 980                             Electrotechnical Commission (2016) ISO/IEC 7816-8:2021 —
 981                             Identification cards — Integrated circuit cards — Part 8: Commands and
 982                             mechanisms for security operations. (International Organization for
 983                             Standardization, Geneva, Switzerland) [or as amended]. Available at
 984                             https://www.iso.org/standard/79893.html
 985                          International Organization for Standardization/International
 986                             Electrotechnical Commission (2017) ISO/IEC 7816-9:2017 —
 987                             Identification cards — Integrated circuit cards — Part 9: Commands for
 988                             card management. (International Organization for Standardization,
 989                             Geneva, Switzerland) [or as amended]. Available at
 990                             https://www.iso.org/standard/67802.html
 991   [ISO8824]             International Organization for Standardization/International Electrotechnical
 992                         Commission (2021) ISO/IEC 8824-2:2021 — Information technology —
 993                         Abstract Syntax Notation One (ASN.1) – Part 2: Information object
 994                         specification. (International Organization for Standardization, Geneva,
 995                         Switzerland) [or as amended]. Available at
 996                         https://www.iso.org/standard/81417.html
 997   [ISO8825]             International Organization for Standardization/International Electrotechnical
 998                         Commission (2015) ISO/IEC 8825-1:2015 — Information technology —
 999                         ASN.1 encoding rules: Specification of Basic Encoding Rules (BER),
1000                         Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)
1001                         Part 1. (International Organization for Standardization, Geneva, Switzerland)
1002                         [or as amended]. Available at https://www.iso.org/standard/81420.html
1003   [MRTD]                ICAO 9303 Machine Readable Travel Documents, Part 3: Machine Readable
1004                         Official Travel Documents, Volume 2: Specifications for Electronically
1005                         Enabled MRtds with Biometric Identification Capability, Eighth Edition,
1006                         2021. Published by authority of the Secretary General, International Civil
1007                         Aviation Organization.
1008   [RFC2616]             Fielding R, Gettys J, Mogul J, Frstk H, Masinter L, Leach P, Berners-Lee T
1009                         (1999) Hypertext Transfer Protocol -- HTTP/1.1. (Internet Engineering Task
1010                         Force (IETF)), IETF Request for Comments (RFC) 2616.
1011                         https://doi.org/10.17487/RFC2616
1012   [RFC2585]             Housley R, Hoffman P (1999) Internet X.509 Public Key Infrastructure
1013                         Operational Protocols: FTP and HTTP. (Internet Engineering Task Force
1014                         (IETF)), IETF Request for Comments (RFC) 2585.
1015                         https://doi.org/10.17487/RFC2585
1016   [RFC4122]             Leach P, Mealling M, Salz R (2005) A Universally Unique IDentifier (UUID)
1017                         URN Namespace. (Internet Engineering Task Force (IETF)), IETF Request
1018                         for Comments (RFC) 4122. https://doi.org/10.17487/RFC4122
1019   [RFC4530]             Zeilenga K, (2006) Lightweight Directory Access Protocol (LDAP)
1020                         entryUUID Operational Attribute. (Internet Engineering Task Force (IETF)),
1021                         IETF Request for Comments (RFC) 4530. https://doi.org/10.17487/RFC4530


                                                             27
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1022   [RFC5280]     Cooper D, Santesson S, Farrell S, Boeyen S, Housley R, Polk W (2008)
1023                 Internet X.509 Public Key Infrastructure Certification and Certificate
1024                 Revocation List (CRL) Profile. (Internet Engineering Task Force (IETF)),
1025                 IETF Request for Comments (RFC) 5280. https://doi.org/10.17487/RFC5280
1026   [RFC5652]     IETF RFC 5652, “Cryptographic Message Syntax (CMS),” September 2009.
1027                 https://doi.org/10.17487/RFC5652
1028   [SP800-76]    Grother PJ, Salamon WJ, Chandramouli R (2013) Biometric Specifications
1029                 for Personal Identity Verification. (National Institute of Standards and
1030                 Technology, Gaithersburg, MD), NIST Special Publication (SP) 800-76-2 [or
1031                 as amended]. https://doi.org/10.6028/NIST.SP.800-76-2
1032   [SP800-78]    Polk WT, Dodson DF, Burr WE, Ferraiolo H, Cooper DA (2015)
1033                 Cryptographic Algorithms and Key Sizes for Personal Identity Verification.
1034                 (National Institute of Standards and Technology, Gaithersburg, MD), NIST
1035                 Special Publication (SP) 800-78-4 [or as amended].
1036                 https://doi.org/10.6028/NIST.SP.800-78-4
1037   [SP800-85A-4] Cooper D, Ferraiolo H, Chandramouli R, Mohler J (2016) PIV Card
1038                 Application and Middleware Interface Test Guidelines (SP 800-73-4
1039                 Compliance). (National Institute of Standards and Technology, Gaithersburg,
1040                 MD), NIST Special Publication (SP) 800-85A-4 [or as amended].
1041                 https://doi.org/10.6028/NIST.SP.800-85A-4
1042   [SP800-87]    Ferraiolo H (2018) Codes for Identification of Federal and Federally-Assisted
1043                 Organizations. (National Institute of Standards and Technology, Gaithersburg,
1044                 MD), NIST Special Publication (SP) 800-87, Rev. 2 [or as amended].
1045                 https://doi.org/10.6028/NIST.SP.800-87r2
1046   [TIG SCEPACS] PACS v2.2, Technical Implementation Guidance: Smart Card Enabled
1047                 Physical Access Control Systems, Version 2.3, The Government Smart Card
1048                 Interagency Advisory Board’s Physical Access Interagency Interoperability
1049                 Working Group, December 2005. https://www.idmanagement.gov/docs/pacs-
1050                 tig-scepacs.pdf




                                                             28
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation



1051   Appendix A. PIV Data Model
1052   The PIV data model number is 0x10, and the data model version number is 0x01.
1053   The SP 800-73-5 specification does not provide mechanisms to read partial contents of a PIV
1054   data object. Individual access to the TLV elements within a container is not supported. For each
1055   container, compliant cards SHALL return all TLV elements of the container in the order listed in
1056   this appendix.
1057   Both single-chip/dual-interface and dual-chip implementations are feasible. In the single-
1058   chip/dual-interface configuration, the PIV Card Application SHALL be provided with
1059   information regarding which interface is in use. In the dual-chip configuration, a separate PIV
1060   Card Application SHALL be loaded on each chip.
1061                                                        Table 8. PIV data containers

                                                                                       Container          Access Rule for Read
                                                                     BER-TLV           Minimum
            Container Description               ContainerID                                                                                M/O/C
                                                                       Tag              Capacity         Contact        Contactless
                                                                                        (Bytes) 17
          Card Capability Container             0xDB00               '5FC107'          170               Always        VCI                 M
          Card Holder Unique                    0x3000               '5FC102'          2881              Always        Always              M
          Identifier
          X.509 Certificate for PIV             0x0101               '5FC105'          1857              Always        VCI                 M
          Authentication (Key
          Reference '9A')
          Cardholder Fingerprints               0x6010               '5FC103'          4006              PIN           VCI and             M
                                                                                                                       PIN
          Security Object                       0x9000               '5FC106'          1336              Always        VCI                 M
          Cardholder Facial Image               0x6030               '5FC108'          12710             PIN           VCI and             M
                                                                                                                       PIN
          X.509 Certificate for Card            0x0500               '5FC101'          1857              Always        Always              M
          Authentication (Key
          Reference '9E')
          X.509 Certificate for                 0x0100               '5FC10A'          1857              Always        VCI                 C
          Digital Signature (Key
          Reference '9C')
          X.509 Certificate for Key             0x0102               '5FC10B'          1857              Always        VCI                 C
          Management (Key
          Reference '9D')
          Printed Information                   0x3001               '5FC109'          245               PIN or        VCI and             O
                                                                                                         OCC           (PIN or
                                                                                                                       OCC)
          Discovery Object                      0x6050               '7E'              19                Always        Always              O
          Key History Object                    0x6060               '5FC10C'          128               Always        VCI                 O
          Retired X.509 Certificate             0x1001               '5FC10D'          1895              Always        VCI                 O
          for Key Management 1
          (Key reference '82')

       17
          The values in this column denote the guaranteed minimum capacities of the on-card storage containers in bytes. Cards with larger containers
       may be produced and determined conformant.


                                                                           29
NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
September 2023                                 PIV Card Application Namespace, Data Model, and Representation

                                                               Container      Access Rule for Read
                                                 BER-TLV       Minimum
    Container Description       ContainerID                                                             M/O/C
                                                   Tag          Capacity     Contact     Contactless
                                                                (Bytes) 17
  Retired X.509 Certificate     0x1002          '5FC10E'       1895          Always     VCI             O
  for Key Management 2
  (Key reference '83')
  Retired X.509 Certificate     0x1003          '5FC10F'       1895          Always     VCI             O
  for Key Management 3
  (Key reference '84')
  Retired X.509 Certificate     0x1004          '5FC110'       1895          Always     VCI             O
  for Key Management 4
  (Key reference '85')
  Retired X.509 Certificate     0x1005          '5FC111'       1895          Always     VCI             O
  for Key Management 5
  (Key reference '86')
  Retired X.509 Certificate     0x1006          '5FC112'       1895          Always     VCI             O
  for Key Management 6
  (Key reference '87')
  Retired X.509 Certificate     0x1007          '5FC113'       1895          Always     VCI             O
  for Key Management
  7(Key reference '88')
  Retired X.509 Certificate     0x1008          '5FC114'       1895          Always     VCI             O
  for Key Management
  8(Key reference '89')
  Retired X.509 Certificate     0x1009          '5FC115'       1895          Always     VCI             O
  for Key Management 9
  (Key reference '8A')
  Retired X.509 Certificate     0x100A          '5FC116'       1895          Always     VCI             O
  for Key Management 10
  (Key reference '8B')
  Retired X.509 Certificate     0x100B          '5FC117'       1895          Always     VCI             O
  for Key Management 11
  (Key reference '8C')
  Retired X.509 Certificate     0x100C          '5FC118'       1895          Always     VCI             O
  for Key Management 12
  (Key reference '8D')
  Retired X.509 Certificate     0x100D          '5FC119'       1895          Always     VCI             O
  for Key Management 13
  (Key reference '8E')
  Retired X.509 Certificate     0x100E          '5FC11A'       1895          Always     VCI             O
  for Key Management 14
  (Key reference '8F')
  Retired X.509 Certificate     0x100F          '5FC11B'       1895          Always     VCI             O
  for Key Management 15
  (Key reference '90')
  Retired X.509 Certificate     0x1010          '5FC11C'       1895          Always     VCI             O
  for Key Management 16
  (Key reference '91')
  Retired X.509 Certificate     0x1011          '5FC11D'       1895          Always     VCI             O
  for Key Management 17
  (Key reference '92')




                                                      30
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

                                                                      Container       Access Rule for Read
                                                        BER-TLV       Minimum
           Container Description       ContainerID                                                                M/O/C
                                                          Tag          Capacity       Contact    Contactless
                                                                       (Bytes) 17
         Retired X.509 Certificate     0x1012          '5FC11E'       1895            Always     VCI              O
         for Key Management 18
         (Key reference '93')
         Retired X.509 Certificate     0x1013          '5FC11F'       1895            Always     VCI              O
         for Key Management 19
         (Key reference '94')
         Retired X.509 Certificate     0x1014          '5FC120'       1895            Always     VCI              O
         for Key Management 20
         (Key reference '95')
         Cardholder Iris Images        0x1015          '5FC121'       7106            PIN        VCI and          O
                                                                                                 PIN
         Biometric Information         0x1016          '7F61'         65              Always     Always           O
         Templates Group Template
         Secure Messaging              0x1017          '5FC122'       2471            Always     Always           O
         Certificate Signer
         Pairing Code Reference        0x1018          '5FC123'       12              PIN or     VCI and          O
         Data Container                                                               OCC        (PIN or
                                                                                                 OCC)

1062   Note that all data elements of the following data objects are mandatory unless specified as
1063   optional or conditional. Also note that in all tables that follow, the values in the “Max. Bytes”
1064   columns denote the lengths of the value (V) fields of BER-TLV elements.
1065                                          Table 9. Card Capability Container

         Card Capability Container                                     0xDB00
                        Data Element (TLV)                    Tag              Type                       Max. Bytes
        Card Identifier                                      0xF0     Fixed                     0 or 21
        Capability Container version number                  0xF1     Fixed                     0 or 1
        Capability Grammar version number                    0xF2     Fixed                     0 or 1
        Applications CardURL                                 0xF3     Variable                  128
        PKCS#15                                              0xF4     Fixed                     0 or 1
        Registered Data Model number                         0xF5     Fixed                     1
        Access Control Rule Table                            0xF6     Fixed                     0 or 17
        Card APDUs                                           0xF7     Fixed                     0
        Redirection Tag                                      0xFA     Fixed                     0
        Capability Tuples (CTs)                              0xFB     Fixed                     0
        Status Tuples (STs)                                  0xFC     Fixed                     0
        Next CCC                                             0xFD     Fixed                     0
        Error Detection Code                                 0xFE     LRC                       0

1066   Note that he previously deprecated optional Extended Application CardURL and Security Object
1067   Buffer data elements have been eliminated in this version of SP 800-73.




                                                             31
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1068                                                 Table 10. Card Holder Unique Identifier

             Card Holder Unique Identifier                                        0x3000
                        Data Element (TLV)                            Tag                             Type                           Max. Bytes
            FASC-N                                                   0x30        Fixed                                             25
            GUID                                                     0x34        Fixed                                             16
            Expiration Date                                          0x35        Date (YYYYMMDD)                                   8
            Cardholder UUID (Optional)                               0x36        Fixed                                             16
            Issuer Asymmetric Signature                              0x3E        Variable                                          2816 18
            Error Detection Code                                     0xFE        LRC                                               0

1069   Note that the Buffer Length, Organizational Identifier, and DUNS data elements have been
1070   eliminated in this version of SP 800-73.
1071   The Error Detection Code is the same element as the Longitudinal Redundancy Code (LRC) in
1072   [TIG SCEPACS]. It is present in the CHUID because TIG SCEPACS makes the LRC
1073   mandatory. However, this document makes no use of the Error Detection Code, and therefore the
1074   length of the TLV value is set to 0 bytes (i.e., no value will be supplied).
1075                                          Table 11. X.509 Certificate for PIV Authentication

             X.509 Certificate for PIV Authentication                            0x0101
                        Data Element (TLV)                            Tag                            Type                           Max. Bytes
            Certificate                                              0x70        Variable                                         1856 19
            CertInfo                                                 0x71        Fixed                                            1
            Error Detection Code                                     0xFE        LRC                                              0

1076   Note that the MSCUID data element has been eliminated in this version.
1077                                                     Table 12. Cardholder fingerprints

             Cardholder Fingerprints                                             0x6010
                       Data Element (TLV)                            Tag                            Type                            Max. Bytes
            Fingerprint I & II                                      0xBC       Variable                                           4000 20
            Error Detection Code                                    0xFE       LRC                                                0

1078                                                          Table 13. Security Object

              Security Object                                                  0x9000
                       Data Element (TLV)                          Tag                             Type                           Max. Bytes
             Mapping of DG to ContainerID                         0xBA       Variable                                           30
             Security Object                                      0xBB       Variable                                           1298
             Error Detection Code                                 0xFE       LRC                                                0
1079

       18
          The values in the “Max. Bytes” columns denote the lengths of the value (V) fields of BER-TLV elements.
       19
          This is the recommended length. The certificate size can exceed the indicated length value.
       20
          This is the recommended length. The certificate that signed the Fingerprint I & II data element in the Cardholder Fingerprints data object can
       either be stored in the CHUID or in the Fingerprint I & II data element itself. For the latter, the “Max. Bytes” value quoted is a recommendation,
       and the signer certificate in CBEFF_SIGNATURE_BLOCK can exceed the “Max. Bytes.” Note that the use of separate content signing keys for
       biometric data and CHUID has been deprecated in FIPS 201-3. In future revisions, the CHUID and biometric elements will be signed with the
       same key. The content signing certificate will not be found in this data element but instead will be contained in the CHUID data element. Hence,
       the size will be as indicated in the table.


                                                                            32
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1080                                                    Table 14. Cardholder facial image

             Cardholder Facial Image                                           0x6030
                      Data Element (TLV)                           Tag                             Type                           Max. Bytes
            Facial Image                                          0xBC       Variable                                           12704 21
            Error Detection Code                                  0xFE       LRC                                                0

1081                                                        Table 15. Printed information

             Printed Information                                               0x3001
                      Data Element (TLV)                           Tag                             Type                           Max. Bytes
            Name                                                  0x01       Text (ASCII)                                       125
            Employee Affiliation                                  0x02       Text (ASCII)                                       20
            Expiration date                                       0x04       Date (YYYYMMMDD)                                   9
            Agency Card Serial Number                             0x05       Text (ASCII)                                       20
            Issuer Identification                                 0x06       Fixed Text (ASCII)                                 15
            Organization Affiliation (Line 1)
            (Optional)                                            0x07       Text (ASCII)                                       20
            Organization Affiliation (Line 2)
            (Optional)                                            0x08       Text (ASCII)                                       20
            Error Detection Code                                  0xFE       LRC                                                0

1082   Agencies SHOULD use tags 0x02, 0x07 and 0x08 to successfully match the printed information
1083   for verification on Zone 8F (Employee Affiliation) and Zone 10F (Agency, Department, or
1084   Organization) on the face of the card with the printed information stored electronically on the
1085   card.
1086                                           Table 16. X.509 Certificate for Digital Signature

             X.509 Certificate for Digital Signature                           0x0100
                          Data Element (TLV)                         Tag                           Type                            Max. Bytes
            Certificate                                             0x70                         Variable                             1856 22
            CertInfo                                                0x71                          Fixed                                 1
            Error Detection Code                                    0xFE                          LRC                                   0

1087   Note that the MSCUID data element has been eliminated in this version.
1088                                          Table 17. X.509 Certificate for Key Management

             X.509 Certificate for Key Management                              0x0102
                       Data Element (TLV)                          Tag                             Type                           Max. Bytes
            Certificate                                           0x70       Variable                                           185622
            CertInfo                                              0x71       Fixed                                              1
            Error Detection Code                                  0xFE       LRC                                                0


       21
          This is the recommended length. The certificate that signed the Facial Image data element (tag 0xBC) can be stored in the CHUID or in the
       Facial Image data element itself. For the latter, the “Max. Bytes” value quoted is a recommendation, and the signer certificate in
       CBEFF_SIGNATURE_BLOCK can exceed the “Max. Bytes.” Note that the use of separate content signing keys for biometric data and CHUID
       has been deprecated in FIPS 201-3. In future revisions, the CHUID and biometric elements will be signed with the same key. The content signing
       certificate will not be found in this data element but instead will be contained in the CHUID data element. Hence, the size will be as indicated in
       the table.
       22
          This is the recommended length. The certificate size can exceed the indicated length value.


                                                                            33
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1089   Note that the MSCUID data element has been eliminated in this version.
1090                                      Table 18. X.509 Certificate for Card Authentication

             X.509 Certificate for Card Authentication                   0x0500
                       Data Element (TLV)               Tag                                Type                         Max. Bytes
            Certificate                                0x70            Variable                                       1856 23
            CertInfo                                   0x71            Fixed                                          1
            Error Detection Code                       0xFE            LRC                                            0

1091   Note that the MSCUID data element has been eliminated in this version of SP 800-73.
1092                                                     Table 19. Discovery Object

             Discovery Object (Tag '7E')                                              0x6050
                      Data El Data Element (TLV)                           Tag                    Type                   Max. Bytes
            PIV Card Application AID                                    0x4F         Fixed                             12
            PIN Usage Policy                                            0x5F2F       Fixed                             2

1093                                                    Table 20. Key History Object

             Key History Object                                          0x6060
                      Data Element (TLV)                      Tag                          Type                          Max. Bytes
            keysWithOnCardCerts                              0xC1      Fixed                                          1
            keysWithOffCardCerts                             0xC2      Fixed                                          1 24
            offCardCertURL (Conditional) 25                  0xF3      Variable                                       118
            Error Detection Code                             0xFE      LRC                                            0

1094                                 Table 21. Retired X.509 Certificate for Key Management 1

             Retired X.509 Certificate for Key Management 1                   0x1001
                        Data Element (TLV)               Tag                                  Type                      Max. Bytes
            Certificate                               0x70                   Variable                                 185623
            CertInfo                                  0x71                   Fixed                                    1
            MSCUID (Optional)                         0x72                   Variable                                 38
            Error Detection Code                      0xFE                   LRC                                      0

1095   Note that the optional MSCUID data element was deprecated in a previous version and
1096   eliminated in this version of SP 800-73. However, historic retired key management certificates
1097   MAY still include the MSCUID element, so it is retained as an optional data element above. This
1098   applies to all of the retired key management key objects represented in Table 21 - Table 40.




       23
          This is the recommended length. The certificate size can exceed the indicated length value.
       24
          The numeric values indicated in keysWithOnCardCerts and keysWithOffCardCerts are represented as unsigned binary integers.
       25
          The offCardCertURL data element shall be present if keysWithOffCardCerts is greater than zero and shall be absent if both
       keysWithOnCardCerts and keysWithOffCardCerts are zero. The offCardCertURL may be present if keyWithOffCardCerts is zero but
       keysWithOnCardCerts is greater than zero.


                                                                      34
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1099                                      Table 22. Retired X.509 Certificate for Key Management 2

                Retired X.509 Certificate for Key Management 2                        0x1002
                           Data Element (TLV)               Tag                                           Type     Max. Bytes
               Certificate                               0x70                        Variable                    1856 26
               CertInfo                                  0x71                        Fixed                       1
               MSCUID (Optional)                         0x72                        Variable                    38
               Error Detection Code                      0xFE                        LRC                         0

1100                                      Table 23. Retired X.509 Certificate for Key Management 3

                Retired X.509 Certificate for Key Management 3                        0x1003
                           Data Element (TLV)               Tag                                           Type     Max. Bytes
               Certificate                               0x70                        Variable                    185626
               CertInfo                                  0x71                        Fixed                       1
               MSCUID (Optional)                         0x72                        Variable                    38
               Error Detection Code                      0xFE                        LRC                         0

1101                                      Table 24. Retired X.509 Certificate for Key Management 4

                Retired X.509 Certificate for Key Management 4                        0x1004
                           Data Element (TLV)               Tag                                           Type     Max. Bytes
               Certificate                               0x70                        Variable                    185626
               CertInfo                                  0x71                        Fixed                       1
               MSCUID (Optional)                         0x72                        Variable                    38
               Error Detection Code                      0xFE                        LRC                         0

1102                                      Table 25. Retired X.509 Certificate for Key Management 5

                Retired X.509 Certificate for Key Management 5                        0x1005
                           Data Element (TLV)               Tag                                           Type     Max. Bytes
               Certificate                               0x70                        Variable                    185626
               CertInfo                                  0x71                        Fixed                       1
               MSCUID (Optional)                         0x72                        Variable                    38
               Error Detection Code                      0xFE                        LRC                         0

1103                                      Table 26. Retired X.509 Certificate for Key Management 6

                Retired X.509 Certificate for Key Management 6                        0x1006
                           Data Element (TLV)               Tag                                           Type     Max. Bytes
               Certificate                               0x70                        Variable                    185626
               CertInfo                                  0x71                        Fixed                       1
               MSCUID (Optional)                         0x72                        Variable                    38
               Error Detection Code                      0xFE                        LRC                         0

1104                                      Table 27. Retired X.509 Certificate for Key Management 7

                Retired X.509 Certificate for Key Management 7                        0x1007
                           Data Element (TLV)               Tag                                           Type     Max. Bytes
               Certificate                               0x70                        Variable                    185626
               CertInfo                                  0x71                        Fixed                       1

       26
            This is the recommended length. The certificate size can exceed the indicated length value.


                                                                              35
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

                Retired X.509 Certificate for Key Management 7                        0x1007
                          Data Element (TLV)                Tag                                           Type     Max. Bytes
               MSCUID (Optional)                         0x72                        Variable                    38
               Error Detection Code                      0xFE                        LRC                         0

1105                                      Table 28. Retired X.509 Certificate for Key Management 8

                Retired X.509 Certificate for Key Management 8                        0x1008
                           Data Element (TLV)               Tag                                           Type     Max. Bytes
               Certificate                               0x70                        Variable                    1856 27
               CertInfo                                  0x71                        Fixed                       1
               MSCUID (Optional)                         0x72                        Variable                    38
               Error Detection Code                      0xFE                        LRC                         0

1106                                      Table 29. Retired X.509 Certificate for Key Management 9

                Retired X.509 Certificate for Key Management 9                        0x1009
                           Data Element (TLV)               Tag                                           Type     Max. Bytes
               Certificate                               0x70                        Variable                    185627
               CertInfo                                  0x71                        Fixed                       1
               MSCUID (Optional)                         0x72                        Variable                    38
               Error Detection Code                      0xFE                        LRC                         0

1107                                     Table 30. Retired X.509 Certificate for Key Management 10

                Retired X.509 Certificate for Key Management 10                        0x100A
                           Data Element (TLV)               Tag                                           Type     Max. Bytes
               Certificate                               0x70                         Variable                   185627
               CertInfo                                  0x71                         Fixed                      1
               MSCUID (Optional)                         0x72                         Variable                   38
               Error Detection Code                      0xFE                         LRC                        0

1108                                     Table 31. Retired X.509 Certificate for Key Management 11

                Retired X.509 Certificate for Key Management 11                       0x100B
                           Data Element (TLV)               Tag                                           Type     Max. Bytes
               Certificate                               0x70                        Variable                    185627
               CertInfo                                  0x71                        Fixed                       1
               MSCUID (Optional)                         0x72                        Variable                    38
               Error Detection Code                      0xFE                        LRC                         0

1109                                     Table 32. Retired X.509 Certificate for Key Management 12

                Retired X.509 Certificate for Key Management 12                       0x100C
                           Data Element (TLV)               Tag                                           Type     Max. Bytes
               Certificate                               0x70                        Variable                    185627
               CertInfo                                  0x71                        Fixed                       1
               MSCUID (Optional)                         0x72                        Variable                    38
               Error Detection Code                      0xFE                        LRC                         0



       27
            This is the recommended length. The certificate size can exceed the indicated length value.


                                                                              36
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1110                                     Table 33. Retired X.509 Certificate for Key Management 13

                Retired X.509 Certificate for Key Management 13                       0x100D
                           Data Element (TLV)               Tag                                           Type     Max. Bytes
               Certificate                               0x70                        Variable                    1856 28
               CertInfo                                  0x71                        Fixed                       1
               MSCUID (Optional)                         0x72                        Variable                    38
               Error Detection Code                      0xFE                        LRC                         0

1111                                     Table 34. Retired X.509 Certificate for Key Management 14

                Retired X.509 Certificate for Key Management 14                       0x100E
                           Data Element (TLV)               Tag                                           Type     Max. Bytes
               Certificate                               0x70                        Variable                    185628
               CertInfo                                  0x71                        Fixed                       1
               MSCUID (Optional)                         0x72                        Variable                    38
               Error Detection Code                      0xFE                        LRC                         0

1112                                     Table 35. Retired X.509 Certificate for Key Management 15

                Retired X.509 Certificate for Key Management 15                       0x100F
                           Data Element (TLV)               Tag                                           Type     Max. Bytes
               Certificate                               0x70                        Variable                    185628
               CertInfo                                  0x71                        Fixed                       1
               MSCUID (Optional)                         0x72                        Variable                    38
               Error Detection Code                      0xFE                        LRC                         0

1113                                     Table 36. Retired X.509 Certificate for Key Management 16

                Retired X.509 Certificate for Key Management 16                       0x1010
                           Data Element (TLV)               Tag                                           Type     Max. Bytes
               Certificate                               0x70                        Variable                    185628
               CertInfo                                  0x71                        Fixed                       1
               MSCUID (Optional)                         0x72                        Variable                    38
               Error Detection Code                      0xFE                        LRC                         0

1114                                     Table 37. Retired X.509 Certificate for Key Management 17

                Retired X.509 Certificate for Key Management 17                       0x1011
                           Data Element (TLV)               Tag                                           Type     Max. Bytes
               Certificate                               0x70                        Variable                    185628
               CertInfo                                  0x71                        Fixed                       1
               MSCUID (Optional)                         0x72                        Variable                    38
               Error Detection Code                      0xFE                        LRC                         0

1115                                     Table 38. Retired X.509 Certificate for Key Management 18

                Retired X.509 Certificate for Key Management 18                       0x1012
                           Data Element (TLV)               Tag                                           Type     Max. Bytes
               Certificate                               0x70                        Variable                    185628
               CertInfo                                  0x71                        Fixed                       1

       28
            This is the recommended length. The certificate size can exceed the indicated length value.


                                                                              37
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

             Retired X.509 Certificate for Key Management 18                        0x1012
                       Data Element (TLV)                Tag                                          Type                        Max. Bytes
            MSCUID (Optional)                         0x72                         Variable                                     38
            Error Detection Code                      0xFE                         LRC                                          0

1116                                   Table 39. Retired X.509 Certificate for Key Management 19

             Retired X.509 Certificate for Key Management 19                        0x1013
                       Data Element (TLV)                Tag                                          Type                        Max. Bytes
                                                                                                                                185628

            Certificate                                              0x70          Variable
            CertInfo                                                 0x71          Fixed                                        1
            MSCUID (Optional)                                        0x72          Variable                                     38
            Error Detection Code                                     0xFE          LRC                                          0

1117                                   Table 40. Retired X.509 Certificate for Key Management 20

             Retired X.509 Certificate for Key Management 20                        0x1014
                       Data Element (TLV)                Tag                                          Type                        Max. Bytes
                                                                                                                                185628

            Certificate                                              0x70          Variable
            CertInfo                                                 0x71          Fixed                                        1
            MSCUID (Optional)                                        0x72          Variable                                     38
            Error Detection Code                                     0xFE          LRC                                          0

1118   The CertInfo byte in the certificate data objects identified in this appendix SHALL be encoded as
1119   follows:
1120
         b8           b7          b6           b5           b4            b3                   b2                                b1
        RFU8         RFU7        RFU6         RFU5         RFU4         IsX509         CompressionTypeLsb                CompressionTypeMsb
1121
1122   CompressionTypeMsb SHALL be 0 if the certificate is encoded in uncompressed form and 1 if
1123   the certificate is encoded using GZIP compression. 29 CompressionTypeLsb and IsX509 SHALL
1124   be set to 0 for PIV Card Applications. Thus, for a certificate encoded in uncompressed form,
1125   CertInfo SHALL be 0x00. For a certificate encoded using GZIP compression, CertInfo SHALL
1126   be 0x01.
1127                                                     Table 41. Cardholder iris images

             Cardholder Iris Images                                            0x1015
                      Data Element (TLV)                           Tag                             Type                           Max. Bytes
            Images for Iris                                       0xBC       Variable                                           7100 30
            Error Detection Code                                  0xFE       LRC                                                0

       29
         GZIP formats are specified in RFC 1951 and RFC 1952.
       30
         This is the recommended length. The certificate that signed the Images for Iris data element (tag 0xBC) can be stored in the CHUID or in the
       Images for Iris data element itself. For the latter, the “Max. Bytes” value quoted is a recommendation, and the signer certificate in
       CBEFF_SIGNATURE_BLOCK can exceed the “Max. Bytes.” Note that the use of separate content signing keys for biometric data and CHUID
       has been deprecated in FIPS 201-3. In future revisions, the CHUID and biometric elements will be signed with the same key. The content signing
       certificate will not be found in this data element but instead will be contained in the CHUID data element. Hence, the size will be as indicated in
       the table


                                                                            38
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1128                                   Table 42. Biometric Information Templates Group template

             BIT Group template (Tag '7F61')                              0x1016
                       Data Element (TLV)                           Tag                            Type                             Max. Bytes
            Number of Fingers                                     0x02   Fixed                                                  1
            BIT for first Finger                                  0x7F60 Variable                                               28
            BIT for second Finger (Optional)                      0x7F60 Variable                                               28

1129                                           Table 43. Secure Messaging Certificate Signer

             Secure Messaging Certificate Signer                                0x1017
                      Data Element (TLV)                            Tag                            Type                           Max. Bytes
            X.509 Certificate for Content Signing                 0x70        Variable                                          1856
            CertInfo                                              0x71        Fixed                                             1
            Intermediate CVC (Conditional) 31                     0x7F21      Variable                                          601
            Error Detection Code                                  0xFE        LRC                                               0

1130   The CertInfo byte in the Secure Messaging Certificate Signer data object SHALL provide
1131   information about the X.509 Certificate for Content Signing. The Intermediate CVC, if present,
1132   shall be stored in uncompressed form.
1133                                         Table 44. Pairing Code Reference Data Container

             Pairing Code                                                       0x1018
                      Data Element (TLV)                            Tag                      Type                                   Max. Bytes
            Pairing Code                                          0x99        Fixed Text (ASCII)                                8
            Error Detection Code                                  0xFE        LRC                                               0
1134




       31
          The Intermediate CVC shall be absent if the X.509 Certificate for Content Signing contains the public key needed to verify the signature on the
       secure messaging CVC and shall be present otherwise.


                                                                           39
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1135   Appendix B. PIV Authentication Mechanisms
1136   PIV authentication mechanisms and application scenarios are described in this section to provide
1137   guidelines on the usage and behavior supported by the PIV Card. FIPS 201 describes PIV
1138   authentication as “the process of establishing confidence in the identity of the cardholder
1139   presenting a PIV Card” [FIPS201]. The fundamental goal of using the PIV Card is to
1140   authenticate the identity of the cardholder to a system or person that is controlling access to a
1141   protected resource or facility. This end goal MAY be reached by various combinations of one or
1142   more of the validation steps described below:
1143           •    Card Validation (CardV) — This is the process of verifying that a PIV Card is authentic
1144                (i.e., not a counterfeit card). Card validation mechanisms include:
1145                      o Visual inspection of the tamper-proofing and tamper-resistant features of the PIV
1146                        Card, per Section 4.1.2 of FIPS 201
1147                      o Use of cryptographic challenge-response schemes with symmetric keys
1148                      o Use of asymmetric authentication schemes to validate private keys embedded
1149                        within the PIV Card
1150           •    Credential Validation (CredV) — This is the process of verifying the various types of
1151                credentials (e.g., visual credentials, biometrics, and certificates) held by the PIV Card.
1152                Credential validation mechanisms include:
1153                      o Verification of certificates on the PIV Card
1154                      o Verification of signatures on the PIV biometrics and the CHUID
1155                      o Checking the expiration date
1156                      o Checking the revocation status of the credentials on the PIV Card
1157                      o Visual inspection of PIV Card visual elements 32 (e.g., the photo, the printed
1158                        name, rank).
1159           •    Cardholder Validation (HolderV) — This is the process of establishing that the PIV Card
1160                is in the possession of the individual to whom the card was issued. Classically, identity
1161                authentication is achieved using one or more of these factors: a) something you have, b)
1162                something you know, and c) something you are. The assurance of the authentication
1163                process increases with the number of factors used. In the case of the PIV Card, these
1164                three factors translate as follows: a) something you have — possession of a PIV Card, b)
1165                something you know — knowledge of the PIN, and c) something you are — the live
1166                fingerprint, facial image, or iris image samples provided by the cardholder. Thus,
1167                mechanisms for PIV cardholder validation include:
1168                      o Presentation of a PIV Card by the cardholder
1169                      o Matching the PIN provided with the PIN on the PIV Card



       32
            This has been deprecated per FIPS 201-3.


                                                             40
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1170                   o Matching the live fingerprint, facial image, or iris image samples provided by the
1171                     cardholder with the biometric information embedded within the PIV Card
1172                   o Matching the visual characteristics of the cardholder with the photo on the PIV
1173                     Card 33

1174   B.1.      Authentication Mechanism Diagrams
1175   This section describes the activities and interactions involved in interoperable usage and
1176   authentication of the PIV Card. The authentication mechanisms represent how a relying party
1177   will authenticate the cardholder (regardless of which agency issued the card) in order to provide
1178   access to its systems or facilities. These activities and interactions are represented in functional
1179   authentication mechanism diagrams. These diagrams are not intended to provide syntactical
1180   commands or API function names.
1181   Each of the PIV authentication mechanisms described in this section can be broken into a
1182   sequence of one or more validation steps where Card, Credential, and Cardholder validation is
1183   performed. In the illustrations, the validation steps are marked as CardV, CredV, and HolderV to
1184   signify Card, Credential, and Cardholder validation, respectively.
1185   Depending on the assurance provided by the actual sequence of validation steps in a given PIV
1186   authentication mechanism, relying parties can make appropriate decisions for granting access to
1187   protected resources based on a risk analysis.
1188




       33
         Use of the photo on the PIV Card for visual authentication has been deprecated in FIPS 201-3 and may be removed from a future edition of the
       standard.


                                                                          41
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1189   B.1.1. Authentication Using PIV Biometrics (BIO)
1190   Figure 1 shows the general authentication mechanism that uses PIV biometrics for off-card
1191   matching.




1192
1193                                 Fig. 1. Authentication using PIV Biometrics (BIO)

1194




                                                             42
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1195   The assurance of authentication using PIV biometrics CAN be further increased if the live
1196   biometric sample is collected in an attended environment with a human overseeing the process.
1197   The attended biometric authentication mechanism (BIO-A) is illustrated in Fig. 2.




1198
1199                           Fig. 2. Authentication using PIV Biometrics Attended (BIO-A)

1200




                                                             43
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1201   B.1.2. Authentication Using PIV Authentication Key
1202   Figure 3 shows the authentication mechanism using the PIV Authentication key.




1203
1204                                Fig. 3. Authentication using PIV Authentication Key

1205




                                                             44
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1206   B.1.3. Authentication Using Card Authentication Key
1207   Authentication mechanisms using the Card Authentication key are illustrated in Fig. 4 and Fig.
1208   5. Figure 4 illustrates the use of the mandatory asymmetric Card Authentication key, while Fig.
1209   5 uses the deprecated, optional symmetric Card Authentication key for the authentication
1210   mechanism. Note that the symmetric card authentication key has been deprecated in FIPS 201-3
1211   and MAY be removed in a future version of the standard.




1212
1213                       Fig. 4. Authentication using an asymmetric Card Authentication Key

1214




                                                             45
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation




1215
1216               Fig. 5. Authentication using a symmetric Card Authentication Key (DEPRECATED)

1217




                                                             46
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1218   B.1.4. Authentication Using OCC (OCC-AUTH)
1219   The OCC-AUTH authentication mechanism is implemented by performing OCC over secure
1220   messaging. The PIV Application authenticates the PIV Card as part of the process of establishing
1221   secure messaging. When the live-scan fingerprint biometric is supplied to the card for OCC over
1222   secure messaging, both the request and the response are protected using message authentication
1223   codes (MAC), allowing the PIV Application on the local system to verify that the response has
1224   not been altered and that it was created by the PIV Card that was authenticated during the
1225   establishment of secure messaging.
1226   The OCC-AUTH authentication mechanism is performed by establishing secure messaging as
1227   described in Section 4 of SP 800-73-5 Part 2 and then performing the VERIFY command, as
1228   illustrated in Fig. 6.




1229
1230                                          Fig. 6. Authentication using OCC

1231




                                                             47
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1232   B.1.5. Authentication Using PIV Visual Credentials (Deprecated)
1233   Figure 7 shows the deprecated authentication mechanism in which a human guard authenticates
1234   the cardholder using the visual credentials held by the PIV Card. The authentication mechanism
1235   has been deprecated in FIPS 201-3 and MAY be removed from a future edition of the standard.




1236
1237                       Fig. 7. Authentication using PIV Visual Credentials (DEPRECATED)


1238   B.1.6. Authentication Using PIV CHUID (Removed)
1239   The content of this section has been removed since the CHUID as an authentication mechanism
1240   is no longer allowed under FIPS-201. However, the CHUID data element itself remains on-card
1241   to support other authentication mechanisms. For example, the BIO and BIO-A authentication
1242   mechanisms use the CHUID data element as a source for the card’s expiration date. The CHUID
1243   data element also provides the content signing certificate for these authentication mechanisms as
1244   well as unique identifiers for PACS ACLs.




                                                             48
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1245   B.1.7. Authentication Using Secure Messaging Key (SM-AUTH)
1246   If the PIV Card supports the secure messaging protocol, then the secure messaging key,
1247   corresponding CVC, and key establishment protocol (see Section 4 of SP 800-73-5 Part 2) CAN
1248   be used for authentication of the PIV Card and the cardholder (SM-AUTH). The secure
1249   messaging protocol authenticates the PIV Card via the secure messaging key. Any established
1250   session keys SHALL be zeroized after authentication if bits b3 and b4 of subsequent command
1251   CLA bytes are set to zero.
1252   Figure 8 shows the authentication mechanism using the secure messaging key.




1253
1254                              Fig. 8. Authentication using the secure messaging key

1255




                                                             49
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1256   B.2.    Summary Table
1257   Table 45 summarizes the types of validation activities that are included in each of the PIV
1258   authentication mechanisms described earlier in this section.
1259                              Table 45. Summary of PIV authentication mechanisms

         PIV Authentication        Card Validation        Credential Validation        Cardholder Validation
             Mechanism              Steps (CardV)             Steps (CredV)               Steps (HolderV)
        PIV Biometric                                    Expiration check            Possession of Card
                                                         CHUID signature check       Match PIN provided by
                                                         PIV Bio signature check     Cardholder
                                                         Match CHUID FASC-N          Match Cardholder bio with
                                                         with PIV Bio FASC-N         PIV bio
        PIV Biometric                                    Expiration check            Possession of Card
        (Attended)                                       CHUID signature check       Match PIN provided by
                                                         PIV Bio signature check     Cardholder
                                                         Match CHUID FASC-N          Match of Cardholder bio to
                                                         with PIV Bio FASC-N         PIV bio in view of attendant
        PIV Authentication        Perform challenge      Certificate validation of   Possession of Card
        Key                       and response with a    a PIV certificate           Match PIN or OCC data
                                  PIV asymmetric                                     provided by Cardholder
                                  key, and validate
                                  signature on
                                  response
        Asymmetric Card           Perform challenge      Certificate validation of   Possession of Card
        Authentication Key        and response with a    a PIV certificate
                                  PIV asymmetric
                                  Card Authentication
                                  key, and validate
                                  signature on
                                  response
        Secure Messaging Key      Perform key            Certificate validation of   Possession of Card
                                  agreement to           a Secure Messaging
                                  establish session      Card Verifiable
                                  keys                   Certificate
        Symmetric Card            Perform challenge                                  Possession of Card
        Authentication Key        and response with a
        (Deprecated)              PIV symmetric key
        On-card Biometric         Establish Secure       Certificate validation of   Possession of Card
        Comparison                Messaging              a PIV certificate           Match OCC data provided
                                                                                     by Cardholder
        PIV Visual                Counterfeit, tamper,   Expiration check            Possession of Card
        Authentication            and forgery check                                  Match of card visual
        (Deprecated)                                                                 characteristics with
                                                                                     cardholder
1260
1261




                                                             50
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1262   Appendix C. PIV Algorithm Identifier Discovery
1263   Relying parties interact with many PIV Cards with the same native key type implemented by
1264   different key sizes and algorithms. 34 For example, a relying party performing the authentication
1265   mechanism described in Appendix B.1.2 CAN expect to perform a challenge and response
1266   cryptographic authentication with a 3072-bit or a 2048-bit RSA key or an ECDSA (Curve P-256
1267   or Curve P-384) key.
1268   This appendix describes recommended procedures for key size and algorithm discovery (PIV
1269   algorithm ID discovery) to facilitate cryptographic authentication initiated by the relying party to
1270   make appropriate decisions for granting access to logical networks and systems as well as
1271   physical access control systems. The discovery procedure is defined in terms of asymmetric and
1272   symmetric cryptographic authentication.

1273   C.1. PIV Algorithm Identifier Discovery for Asymmetric Cryptographic
1274      Authentication
1275   As illustrated in the authentication mechanisms in Appendix B, an asymmetric cryptographic
1276   authentication involves issuing a challenge (request to sign a nonce) to the PIV Card. The relying
1277   party issuing the command provides the nonce to be signed, the key reference, and the PIV
1278   algorithm identifier as parameters of the command. The nonce is random data generated by the
1279   relying party, and the key reference is known. In contrast, the PIV algorithm identifier is
1280   unknown to the relying party and needs to be identified in order to issue the challenge command.
1281   The PIV algorithm identifier CAN be derived from the previous steps of the authentication
1282   mechanism. Prior to issuing the challenge command, the relying party retrieved and parsed the
1283   X.509 certificate from the card to validate the certificate and extract the public key for the
1284   pending verification of the signed nonce once returned from the card. The PIV algorithm
1285   identifier CAN be identified during the parsing of the X.509 certificate in two steps: 35
1286              Step 1: Algorithm Type Discovery
1287              The X.509 certificate stores the public key in the subjectPublicKeyInfo field. The
1288              subjectPublicKeyInfo data structure has an algorithm field, which includes an OID that
1289              identifies the public key’s algorithm (RSA or ECC), as listed in Table 4 of SP 800-78.
1290              Step 2: Key Size Discovery
1291              If the algorithm type determined in Step 1 is ECC, then the key size is determined by the
1292              elliptic curve on which the key has been generated, which is P-256 or P-384 for all
1293              elliptic curve PIV Authentication keys and Card Authentication keys.
1294              If the algorithm type determined in Step 1 is RSA, then the key size is determined by the
1295              public key’s modulus. The public key appears in the subjectPublicKey field of
1296              subjectPublicKeyInfo and is encoded as a sequence that includes both the key’s modulus
1297              and public exponent.


       34
         Table 1 of SP 800-78 lists the various algorithms and key sizes that may be used for each PIV Key Type.
       35
         The PIV algorithm identifiers specify both the key size and the algorithm for the key references. Thus, both values have to be discovered in
       order to derive the PIV algorithm identifier.


                                                                           51
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1298   As a final step, the discovered X.509 algorithm OID and key size are mapped to the PIV
1299   algorithm identifiers, as defined in Table 9 of SP 800-78. The relying party then proceeds to
1300   issue the GENERAL AUTHENTICATE command to the card.

1301   C.2. PIV Algorithm Identifier Discovery for Symmetric Cryptographic
1302      Authentication
1303   In the absence of an X.509 certificate, as is the case with symmetric cryptography, the PIV
1304   algorithm identifier discovery mechanism has to rely on a lookup table that resides on the local
1305   system. The table maps a unique card identifier and key reference (inputs) to an associated PIV
1306   algorithm identifier (output). The unique identifier supplied by the card MAY be the Agency
1307   Code || System Code || Credential Number of the FASC-N or the Card UUID.
1308   The symmetric Card Authentication key is optional to implement, and a relying party has no
1309   prior knowledge of the key’s existence. The following routine discovers the Card Authentication
1310   key’s native implementation:
1311       •   Read the CHUID, and extract either the Card UUID or the Agency Code || System code ||
1312           Credential Number from the CHUID’s FASC-N.
1313       •   Retrieve the PIV algorithm identifier from the local lookup table. If no algorithm
1314           identifier is returned, authentication CANNOT be performed using the optional
1315           symmetric Card Authentication key, either because the PIV Card does not implement the
1316           key or the local system CANNOT authenticate the response from the card.

1317   C.3.    PIV Algorithm Identifier Discovery for Secure Messaging
1318   The Application Property Template included in the response to the SELECT command
1319   optionally includes a tag 0xAC, which indicates what cryptographic algorithms the PIV Card
1320   Application supports. The presence of algorithm identifier '27' or '2E' indicates that the
1321   corresponding cipher suite is supported by the PIV Card Application for secure messaging and
1322   that the PIV Card Application possesses a PIV Secure Messaging key of the appropriate size for
1323   the specified cipher suite.
1324




                                                             52
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1325   Appendix D. List of Symbols, Abbreviations, and Acronyms
1326   ACR
1327   Access Control Rule

1328   AID
1329   Application Identifier

1330   APDU
1331   Application Protocol Data Unit

1332   API
1333   Application Programming Interface

1334   ASCII
1335   American Standard Code for Information Interchange

1336   ASN.1
1337   Abstract Syntax Notation One

1338   BER
1339   Basic Encoding Rules

1340   BIT
1341   Biometric Information Template

1342   CAK
1343   Card Authentication Key

1344   CBEFF
1345   Common Biometric Exchange Formats Framework

1346   CCC
1347   Card Capability Container

1348   CHUID
1349   Card Holder Unique Identifier

1350   CMS
1351   Cryptographic Message Syntax

1352   CVC
1353   Card Verifiable Certificate

1354   DER
1355   Distinguished Encoding Rules

1356   DG
1357   Data Group

1358   DTR
1359   Derived Test Requirement

1360   ECB
1361   Electronic Code Book

1362   ECC
1363   Elliptic Curve Cryptography


                                                             53
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1364   ECDH
1365   Elliptic Curve Diffie-Hellman

1366   ECDSA
1367   Elliptic Curve Digital Signature Algorithm

1368   FASC-N
1369   Federal Agency Smart Credential Number

1370   FIPS
1371   Federal Information Processing Standard

1372   FISMA
1373   Federal Information Security Management Act

1374   GSC-IS
1375   Government Smart Card Interoperability Specification

1376   GUID
1377   Global Unique Identification number

1378   HSPD
1379   Homeland Security Presidential Directive

1380   ICC
1381   Integrated Circuit Card

1382   IEC
1383   International Electrotechnical Commission

1384   INCITS
1385   InterNational Committee for Information Technology Standards

1386   ISO
1387   International Organization for Standardization

1388   ITL
1389   Information Technology Laboratory

1390   LSB
1391   Least Significant Bit

1392   LRC
1393   Longitudinal Redundancy Code

1394   MAC
1395   Message Authentication Code

1396   MRTD
1397   Machine Readable Travel Document

1398   MSB
1399   Most Significant Bit

1400   NIST
1401   National Institute of Standards and Technology

1402   NPIVP
1403   NIST Personal Identity Verification Program

                                                              54
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1404   OCC
1405   On-Card Biometric Comparison

1406   OID
1407   Object Identifier

1408   OMB
1409   Office of Management and Budget

1410   PACS
1411   Physical Access Control System

1412   PIN
1413   Personal Identification Number

1414   PI
1415   Person Identifier, a field in the FASC-N

1416   PIV
1417   Personal Identity Verification

1418   PIX
1419   Proprietary Identifier Extension

1420   PKCS
1421   Public-Key Cryptography Standards

1422   PKI
1423   Public Key Infrastructure

1424   PUK
1425   PIN Unblocking Key

1426   RFU
1427   Reserved for Future Use

1428   RID
1429   Registered Application Provider Identifier

1430   RSA
1431   Rivest–Shamir–Adleman

1432   SCEPACS
1433   Smart Card Enabled Physical Access Control System

1434   SHA
1435   Secure Hash Algorithm

1436   SP
1437   Special Publication

1438   SM
1439   Secure Messaging

1440   SW1
1441   First byte of a two-byte status word

1442   SW2
1443   Second byte of a two-byte status word

                                                             55
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1444   TIG
1445   Technical Implementation Guidance

1446   TLV
1447   Tag-Length-Value

1448   URL
1449   Uniform Resource Locator

1450   UUID
1451   Universally Unique Identifier

1452   VCI
1453   Virtual Contact Interface
1454




                                                             56
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1455   Appendix E. Glossary
1456   algorithm identifier
1457   A 1-byte identifier that specifies a cryptographic algorithm and key size. For symmetric cryptographic operations,
1458   the algorithm identifier also specifies a mode of operation (i.e., ECB).

1459   application identifier
1460   A globally unique identifier of a card application. [ISO7816, Part 4, adapted]

1461   authenticable entity
1462   An entity that can successfully participate in an authentication protocol with a card application.

1463   BER-TLV data object
1464   A data object coded according to ISO/IEC 8824-2:2021

1465   card
1466   An integrated circuit card.

1467   card application
1468   A set of data objects and card commands that can be selected using an application identifier.

1469   client application
1470   A program running on a computer in communication with a card interface device.

1471   card management operation
1472   Any operation involving the PIV Card Application Administrator.

1473   Card Verifiable Certificate
1474   A certificate stored on the card that includes a public key, the signature of certification authority, and the
1475   information needed to verify the certificate.

1476   data object
1477   An item of information seen at the card command interface with a specified a name, a description of logical content,
1478   a format, and a coding.

1479   key reference
1480   A 1-byte identifier that specifies a cryptographic key according to its PIV Key Type. The identifier is part of the
1481   cryptographic material used in a cryptographic protocol, such as an authentication or a signing protocol.

1482   MSCUID
1483   A deprecated (previously optional legacy) identifier included for compatibility with Common Access Card and
1484   Government Smart Card Interoperability Specifications.

1485   object identifier
1486   A globally unique identifier of a data object. [ISO8824, adapted]

1487   pairing code
1488   An 8-digit code used to establish a relationship between the PIV Card and a device for the purpose of creating the
1489   virtual contact interface after secure messaging has been established.

1490   PIV Key Type
1491   The type of a key. The PIV Key Types are 1) PIV Authentication key, 2) Card Authentication key, 3) digital
1492   signature key, 4) key management key, 5) retired key management key, 6) PIV Secure Messaging key, and 7) PIV
1493   Card Application Administration key.

1494   relying party
1495   An entity that relies upon the subscriber’s credentials, typically to process a transaction or grant access to
1496   information or a system.

                                                                57
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1497   status word
1498   Two bytes returned by an integrated circuit card after processing any command that signify the success of or errors
1499   encountered during said processing.




                                                              58
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1500   Appendix F. Notation
1501   The 16 hexadecimal digits SHALL be denoted using the alphanumeric characters 0, 1, 2, …, 9,
1502   A, B, C, D, E, and F. A byte consists of two hexadecimal digits, such as '2D'. The two
1503   hexadecimal digits are represented in quotations '2D' or as 0x2D. A sequence of bytes MAY be
1504   enclosed in single quotation marks (e.g., 'A0 00 00 01 16') rather than given as a sequence of
1505   individual bytes (e.g., 'A0' '00' '00' '01' '16').
1506   A byte can also be represented by bits b8 to b1, where b8 is the most significant bit (MSB) and
1507   b1 is the least significant bit (LSB) of the byte. In textual or graphic representations, the leftmost
1508   bit is the MSB. Thus, for example, the most significant bit b8 of '80' is 1, and the least significant
1509   bit b1 is 0.
1510   All bytes specified as RFU SHALL be set to '00', and all bits specified as RFU SHALL be set to
1511   0.
1512   All lengths SHALL be measured in number of bytes unless otherwise noted.
1513   The expression 'X' & 'Y' is a bitwise AND operation between bytes 'X' and 'Y'.
1514   The symbol || means a concatenation of byte strings. For example, if X is '00 01 02' and Y is '03
1515   04 05', then X || Y is '00 01 02 03 04 05'.
1516   Data objects in templates are described as being mandatory (M), optional (O), or conditional (C).
1517   Mandatory means that the data object SHALL appear in the template. Optional means that the
1518   data object MAY appear in the template. For conditional data objects, the conditions under
1519   which they are required are provided.
1520   In other tables, the M/O/C column identifies the properties of the PIV Card Application that
1521   SHALL be present (M), MAY be present (O), or are conditionally required to be present (C).
1522   BER-TLV data object tags are represented as byte sequences, as described above. Thus, for
1523   example, 0x4F is the interindustry data object tag for an application identifier, and 0x7F61 is the
1524   interindustry data object tag for the Biometric Information Templates Group template.
1525   This document uses the following typographical conventions in text:
1526       •   Specific terms in CAPITALS represent normative requirements. When these same terms
1527           are not in CAPITALS, the term does not represent a normative requirement.
1528       •   The terms SHALL and SHALL NOT indicate requirements to be strictly followed in
1529           order to conform to the publication and from which no deviation is permitted.
1530       •   The terms SHOULD and SHOULD NOT indicate that among several possibilities, one
1531           is recommended as particularly suitable without mentioning or excluding others, that a
1532           certain course of action is preferred but not necessarily required, or that — in the negative
1533           form — a certain possibility or course of action is discouraged but not prohibited.
1534       •   The terms MAY and NEED NOT indicate a course of action that is permissible within
1535           the limits of the publication.
1536       •   The terms CAN and CANNOT indicate a material, physical, or causal possibility or
1537           capability or — in the negative — the absence of that possibility or capability.


                                                             59
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

1538   Appendix G. Revision History
             Version                Release Date                                       Updates
        SP 800-73              April 2005                Initial Release
        SP 800-73-1            April 2006                Incorporated Errata
        SP 800-73-2            September 2008            • Separated SP 800-73 into four Parts:
                                                              1. End-Point PIV Card Application Namespace, Data
                                                                 Model, and Representation
                                                               2. End-Point PIV Card Application Card Command
                                                                 Interface
                                                               3. End-Point PIV Client Application Programming
                                                                 Interface
                                                               4. The PIV Transitional Interface and Data Model
                                                                 Specification
                                                         • All PIV cryptographic key types, cryptographic algorithm
                                                              identifiers, and key sizes previously listed in SP 800-73-1
                                                              are now specified in SP 800-78, Cryptographic Algorithms
                                                              and Key Sizes for Personal Identity Verification
                                                         • Removed default algorithms. Each PIV Key Type CAN be
                                                              implemented from a small subset of algorithms and key
                                                              sizes, as specified in Table 1 of SP 800-78
                                                         • Added optional Discovery Object (Part 1, Section 3.2.6)
                                                         • Added optional capability to use the Global PIN (in
                                                              addition to the PIV Card Application PIN) with the PIV
                                                              Card Application (Part 1, Section 3.2.6)
                                                         • Added pivMiddlewareVersion API function (SP 800-73-5
                                                              Part 3, Section 3.1.1)
                                                         • Deprecated the CHUID data object’s Authentication Key
                                                              Map data element
                                                         • Deprecated the Printed Information data object’s
                                                              Employee Affiliation Line 2 data element (tag 0x03)
                                                         • Removed size limits on signed data object containers (Part
                                                              1, Appendix A)




                                                             60
NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
September 2023                                 PIV Card Application Namespace, Data Model, and Representation

      Version               Release Date                                       Updates
 SP 800-73-3            February 2010             •    Added preamble: I – Revision History, II – Configuration
                                                       Management, and III – NPIVP Conformance Testing (Part
                                                       1, Preamble)
                                                  •    Removed the CHUID data object’s Authentication Key
                                                       Map data element
                                                  •    Removed the Printed Information data object’s Employee
                                                       Affiliation Line 2 data element (tag 0x03)
                                                  •    Deprecated IPv6 as optional value for the CHUID’s GUID
                                                       data element (Part 1, Section 3.2.1)
                                                  •    Added Key History capability (Part 1, Section 3.2.7)
                                                  •    Added ECDH key agreement scheme (SP 800-73-5 Part 2,
                                                       Section 3.2.4)
                                                  •    Added UUID feature for non-Federal issuer cards (Part 1,
                                                       Section 3.3)
                                                  •    Expanded SP 800-73-5 Part 2, Appendix A (GENERAL
                                                       AUTHENTICATE examples) to illustrate ECDSA
                                                       signatures and key establishment schemes with the key
                                                       management key
                                                  •    Added an optional cardholder iris images data object,
                                                       which is specified in SP 800-76-2
                                                  •    Added Appendix C, PIV Algorithm Identifier Discovery
                                                  •    Updated PIV Middleware version number in SP 800-73-5
                                                       Part 3




                                                      61
NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
September 2023                                 PIV Card Application Namespace, Data Model, and Representation

      Version                Release Date                                      Updates
 SP 800-73-4            April 2015                •    Removed Part 4, The PIV Transitional Data Model and
                                                       Interfaces
                                                  •    Removed “End-Point” from the titles and content of Parts
                                                       1 through 3
                                                  •    Added Section 1.3 “Effective Date”
                                                  •    Made asymmetric Card Authentication key mandatory
                                                  •    Made digital signature key and key management key
                                                       conditionally mandatory
                                                  •    Made the facial image data object mandatory
                                                  •    Introduced specifications for optional secure messaging
                                                  •    Introduced specifications for optional virtual contact
                                                       interface (VCI) over which all non-card management
                                                       functionality of the PIV Card is accessible
                                                  •    Added support for pairing code that is used to establish
                                                       VCI
                                                  •    Made Card UUID mandatory and removed the option to
                                                       populate the GUID data element of CHUID with all zeros
                                                       or an IPv6 address
                                                  •    Added PIV card level PIN length enforcement
                                                       requirements for the PINs
                                                  •    Added an optional Cardholder UUID as a unique identifier
                                                       for a cardholder
                                                  •    Removed information about encoding of NFI cards
                                                  •    Added optional on-card biometric comparison mechanism
                                                       as a means of performing card activation and as a PIV
                                                       authentication mechanism
                                                  •    Added a requirement for signature verification and
                                                       certification path validation in the CHUID, BIO, and BIO-
                                                       A authentication mechanisms
                                                  •    Added the On Card Comparison (OCC) Biometric
                                                       Information (BIT) Group template data object
                                                  •    Added Secure Messaging Signer Certificate Data Object
                                                  •    Added Pairing Code Reference Data Container
                                                  •    Deprecated some data elements in the CHUID (Buffer
                                                       Length, DUNS and Organization Identifier) and legacy
                                                       data elements in all X.509 Certificates (MSCUID)
                                                  •    Deprecated the optional Extended Application CardURL
                                                       and Security Object Buffer data elements from the Card
                                                       Capability Container
                                                  •    Updated PIV Middleware version number in SP 800-73-5
                                                       Part 3
                                                  •    Expanded Part 1, Appendix C (PIV Algorithm Identifier
                                                       Discovery) to include an Algorithm Identifier discovery for
                                                       Secure Messaging
                                                  •    Expanded SP 800-73-5 Part 2, Appendix A (GENERAL
                                                       AUTHENTICATE examples) to illustrate use of VCI




                                                      62
NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
September 2023                                 PIV Card Application Namespace, Data Model, and Representation

      Version                Release Date                                        Updates
 SP 800-73-4            Feb 8, 2016 (Errata       •    Relaxed interface requirements to allow RESET RETRY
                        update)                        COUNTER, PUT DATA, and GENERATE
                                                       ASYMMETRIC KEY PAIR to be performed over the
                                                       contactless interface if they are used for card management
                                                       operations
                                                  •    Allowed use of VERIFY command with key references
                                                       other than '00', '80', '96', '97', and '98' if they are used for
                                                       card management operations
                                                  •    Removed the requirement for the PIV Card Application to
                                                       return a specific error status word ('6A 81' or '69 82') if the
                                                       interface requirements for submitting the VERIFY
                                                       command (e.g., contact, secure messaging, virtual contact)
                                                       are not satisfied
                                                  •    Allowed use of CHANGE REFERENCE DATA command
                                                       with key references other than '80' and '81' if they are used
                                                       for card management operations
                                                  •    Removed the requirement for the PIV Card Application to
                                                       return a specific error status word ('6A 81' or '69 82') if the
                                                       interface requirements for submitting the CHANGE
                                                       REFERENCE DATA command (e.g., contact, virtual
                                                       contact) are not satisfied
                                                  •    Allowed use of RESET RETRY DATA command with
                                                       key references other than '80' if they are used for card
                                                       management operations
                                                  •    Updated PIV Card Application Authentication Data
                                                       References table with number of allowed retries for
                                                       primary and secondary fingers for OCC and PIV Card
                                                       Application PIN




                                                      63
       NIST SP 800-73pt1-5 ipd (Initial Public Draft)                Interfaces for Personal Identity Verification: Part 1
       September 2023                                 PIV Card Application Namespace, Data Model, and Representation

             Version               Release Date                                         Updates
        SP 800-73-5            INSERT DATE               •    Removed the previously deprecated Extended Application
                                                              CardURL and Security Object Buffer elements from the
                                                              Card Capability Container data object
                                                         •    Removed the previously deprecated Buffer Length, DUNS,
                                                              and Organizational Identifier elements from the CHUID
                                                              data object
                                                         •    Removed the previously deprecated MSCUID element
                                                              from all X.509v3 Certificate data objects other than
                                                              certificates for retired key management keys
                                                         •    Deprecated SYM-CAK and VIS authentication
                                                              mechanisms
                                                         •    Removed previously deprecated CHUID authentication
                                                              mechanism
                                                         •    Added SM-AUTH as a single-factor additional
                                                              authentication mechanism
                                                         •    Deprecated use of separate content signing keys for
                                                              biometric data and CHUID
                                                         •    Restricted the number of consecutive activation retries for
                                                              each of the activation methods (i.e., PIN and OCC
                                                              attempts) to be 10 or less
                                                         •    Marked SP 800-73-5 Part 3 as optional
                                                         •    Added the use of the facial image biometric for automated
                                                              facial comparison (i.e., not just for issuance processes)
                                                              through BIO and BIO-A authentication mechanisms
                                                         •    Enabled OCC reset through CHANGE REFERENCE
                                                              DATA command in SP 800-73-5 Part 2
                                                         •    Updated allowed cryptographic algorithms to match SP
                                                              800-78-5
                                                         •    Specified that fingerprints used for OCC MAY be taken
                                                              from the full set of fingerprints collected for PIV
                                                              background investigations and SHOULD be imaged from
                                                              fingers not imaged for off-card one-to-one comparison
                                                         •    Updated the container minimum capacity for many of PIV
                                                              Data Containers
                                                         •    Deleted the details of incompatibilities between versions of
                                                              this document from the Configuration Management section
                                                         •    Clarified that the Card UUID, Expiration Date, and
                                                              Cardholder UUID fields cannot be modified post-issuance
                                                         •    Clarified that NPIVP conformance testing will no longer
                                                              be performed for PIV Middleware
                                                         •    Moved set of errata changes in SP 800-73-4 into the
                                                              Revision History
                                                         •    Leveraged the latest NIST publication template, including
                                                              introductory pages, content, and styles

1539




                                                             64
