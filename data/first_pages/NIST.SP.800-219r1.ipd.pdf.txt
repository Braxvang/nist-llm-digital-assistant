                             Withdrawn Draft
                                       Warning Notice

The attached draft document has been withdrawn and is provided solely for historical purposes.
It has been followed by the document identified below.

                            Withdrawal Date July 20, 2023

                        Original Release Date March 13, 2023




                        The attached draft document is followed by:

                  Status Final

         Series/Number NIST SP 800-219r1

                    Title Automated Secure Configuration Guidance from the macOS
                          Security Compliance Project (mSCP)

       Publication Date July 2023

                    DOI https://doi.org/10.6028/NIST.SP.800-219r1

            CSRC URL https://csrc.nist.gov/pubs/sp/800/219/r1/final

Additional Information
 1                 NIST Special Publication
 2                   NIST SP 800-219r1 ipd

 3   Automated Secure Configuration
 4         Guidance from the macOS
 5       Security Compliance Project
 6                          (mSCP)
 7
 8                                         Initial Public Draft

 9
10                                              Mark Trapnell
11                                               Eric Trapnell
12                                          Murugiah Souppaya
13                                                Bob Gendler
14                                             Karen Scarfone

15                 This publication is available free of charge from:
16                  https://doi.org/10.6028/NIST.SP.800-219r1.ipd
17
18
19                                                NIST Special Publication
20                                                  NIST SP 800-219r1 ipd

21   Automated Secure Configuration
22         Guidance from the macOS
23       Security Compliance Project
24                          (mSCP)
25
26                                                                              Initial Public Draft
27
                    Mark Trapnell                                                            Bob Gendler
                     Eric Trapnell                           Customer Access and Support Division
                Murugiah Souppaya                        Office of Information Systems Management
            Computer Security Division
     Information Technology Laboratory                                                   Karen Scarfone
                                                                                  Scarfone Cybersecurity



28                                                This publication is available free of charge from:
29                                                 https://doi.org/10.6028/NIST.SP.800-219r1.ipd

30                                                                                               March 2023




31
32                                                                                 U.S. Department of Commerce
33                                                                                  Gina M. Raimondo, Secretary

34                                                                 National Institute of Standards and Technology
35               Laurie E. Locascio, NIST Director and Undersecretary of Commerce for Standards and Technology
     NIST SP 800-219r1 ipd (Initial Public Draft)                                        Automated Secure Configuration
     March 2023                                                                               Guidance from the mSCP



36   Certain commercial equipment, instruments, software, or materials, commercial or non-commercial, are identified in
37   this paper in order to specify the experimental procedure adequately. Such identification does not imply
38   recommendation or endorsement of any product or service by NIST, nor does it imply that the materials or
39   equipment identified are necessarily the best available for the purpose.

40   There may be references in this publication to other publications currently under development by NIST in
41   accordance with its assigned statutory responsibilities. The information in this publication, including concepts and
42   methodologies, may be used by federal agencies even before the completion of such companion publications. Thus,
43   until each publication is completed, current requirements, guidelines, and procedures, where they exist, remain
44   operative. For planning and transition purposes, federal agencies may wish to closely follow the development of
45   these new publications by NIST.

46   Organizations are encouraged to review all draft publications during public comment periods and provide feedback
47   to NIST. Many NIST cybersecurity publications, other than the ones noted above, are available at
48   https://csrc.nist.gov/publications.


49   Authority
50   This publication has been developed by NIST in accordance with its statutory responsibilities under the Federal
51   Information Security Modernization Act (FISMA) of 2014, 44 U.S.C. § 3551 et seq., Public Law (P.L.) 113-283.
52   NIST is responsible for developing information security standards and guidelines, including minimum requirements
53   for federal information systems, but such standards and guidelines shall not apply to national security systems
54   without the express approval of appropriate federal officials exercising policy authority over such systems. This
55   guideline is consistent with the requirements of the Office of Management and Budget (OMB) Circular A-130.
56
57   Nothing in this publication should be taken to contradict the standards and guidelines made mandatory and binding
58   on federal agencies by the Secretary of Commerce under statutory authority. Nor should these guidelines be
59   interpreted as altering or superseding the existing authorities of the Secretary of Commerce, Director of the OMB, or
60   any other federal official. This publication may be used by nongovernmental organizations on a voluntary basis and
61   is not subject to copyright in the United States. Attribution would, however, be appreciated by NIST.


62   NIST Technical Series Policies
63   Copyright, Use, and Licensing Statements
64   NIST Technical Series Publication Identifier Syntax


65   Publication History
66   Approved by the NIST Editorial Review Board on YYYY-MM-DD [will be added upon final completion]
67   Supersedes NIST Series XXX (Month Year) DOI [will be added upon final completion]


68   How to Cite this NIST Technical Series Publication:
69   Trapnell M, Trapnell E, Souppaya MP, Gendler B, Scarfone K (2023) Automated Secure Configuration Guidance
70   from the macOS Security Compliance Project (mSCP). (National Institute of Standards and Technology,
71   Gaithersburg, MD), NIST Special Publication (SP) NIST SP 800-219r1 ipd. https://doi.org/10.6028/NIST.SP.800-
72   219r1.ipd


73   Author ORCID iDs
74   Mark Trapnell: 0000-0002-5266-3610
75   Eric Trapnell: 0000-0001-9315-3732
76   Murugiah Souppaya: 0000-0002-8055-8527
77   Bob Gendler: 0000-0002-8928-6492
     NIST SP 800-219r1 ipd (Initial Public Draft)                          Automated Secure Configuration
     March 2023                                                                 Guidance from the mSCP


78   Karen Scarfone: 0000-0001-6334-9486


79   Public Comment Period
80   March 13, 2023 – April 27, 2023


81   Contact Information
82   applesec@nist.gov
83
84   National Institute of Standards and Technology
85   Attn: Computer Security Division, Information Technology Laboratory
86   100 Bureau Drive (Mail Stop 8930) Gaithersburg, MD 20899-8930


87   All comments are subject to release under the Freedom of Information Act (FOIA).
      NIST SP 800-219r1 ipd (Initial Public Draft)                         Automated Secure Configuration
      March 2023                                                                Guidance from the mSCP




88    Abstract
89    The macOS Security Compliance Project (mSCP) provides resources that system administrators,
90    security professionals, security policy authors, information security officers, and auditors can
91    leverage to secure and assess macOS desktop and laptop system security in an automated way.
92    This publication introduces the mSCP and gives an overview of the resources available from the
93    project’s GitHub site, which is continuously curated and updated to support each new release of
94    macOS. The GitHub site provides practical, actionable recommendations in the form of secure
95    baselines and associated rules. This publication also describes use cases for leveraging the mSCP
96    content. Updates from the previous version of this publication mainly involve the new mSCP
97    capability to create a custom benchmark by tailoring a baseline.

98    Keywords
 99   Apple; baseline; configuration management; endpoint device security; macOS; macOS Security
100   Compliance Project (mSCP); operating system security; security compliance.

101   Reports on Computer Systems Technology
102   The Information Technology Laboratory (ITL) at the National Institute of Standards and
103   Technology (NIST) promotes the U.S. economy and public welfare by providing technical
104   leadership for the Nation’s measurement and standards infrastructure. ITL develops tests, test
105   methods, reference data, proof of concept implementations, and technical analyses to advance
106   the development and productive use of information technology. ITL’s responsibilities include the
107   development of management, administrative, technical, and physical standards and guidelines for
108   the cost-effective security and privacy of other than national security-related information in
109   federal information systems. The Special Publication 800-series reports on ITL’s research,
110   guidelines, and outreach efforts in information system security, and its collaborative activities
111   with industry, government, and academic organizations.
112




                                                     i
      NIST SP 800-219r1 ipd (Initial Public Draft)                          Automated Secure Configuration
      March 2023                                                                 Guidance from the mSCP


113   Supplemental Content
114   The mSCP’s GitHub site is at https://github.com/usnistgov/macos_security#readme, and the
115   project documentation wiki is at https://github.com/usnistgov/macos_security/wiki.

116   Trademark Information
117   All registered trademarks or trademarks belong to their respective organizations.




                                                     ii
      NIST SP 800-219r1 ipd (Initial Public Draft)                            Automated Secure Configuration
      March 2023                                                                   Guidance from the mSCP


118   Call for Patent Claims
119   This public review includes a call for information on essential patent claims (claims whose use
120   would be required for compliance with the guidance or requirements in this Information
121   Technology Laboratory (ITL) draft publication). Such guidance and/or requirements may be
122   directly stated in this ITL Publication or by reference to another publication. This call also
123   includes disclosure, where known, of the existence of pending U.S. or foreign patent applications
124   relating to this ITL draft publication and of any relevant unexpired U.S. or foreign patents.
125   ITL may require from the patent holder, or a party authorized to make assurances on its behalf,
126   in written or electronic form, either:
127       a) assurance in the form of a general disclaimer to the effect that such party does not hold
128          and does not currently intend holding any essential patent claim(s); or
129       b) assurance that a license to such essential patent claim(s) will be made available to
130          applicants desiring to utilize the license for the purpose of complying with the guidance
131          or requirements in this ITL draft publication either:
132              i.    under reasonable terms and conditions that are demonstrably free of any unfair
133                    discrimination; or
134             ii.    without compensation and under reasonable terms and conditions that are
135                    demonstrably free of any unfair discrimination.
136   Such assurance shall indicate that the patent holder (or third party authorized to make assurances
137   on its behalf) will include in any documents transferring ownership of patents subject to the
138   assurance, provisions sufficient to ensure that the commitments in the assurance are binding on
139   the transferee, and that the transferee will similarly include appropriate provisions in the event of
140   future transfers with the goal of binding each successor-in-interest.
141   The assurance shall also indicate that it is intended to be binding on successors-in-interest
142   regardless of whether such provisions are included in the relevant transfer documents.
143   Such statements should be addressed to: applesec@nist.gov




                                                     iii
      NIST SP 800-219r1 ipd (Initial Public Draft)                                                        Automated Secure Configuration
      March 2023                                                                                               Guidance from the mSCP


144   Table of Contents
145          Introduction ...................................................................................................................... 1
146                 Purpose and Scope .................................................................................................... 1
147                 Audience .................................................................................................................... 1
148                 Relevance to NIST SP 800-70 and the National Checklist Program ........................... 2
149                 Document Structure .................................................................................................... 2
150          Project Description .......................................................................................................... 3
151                 Project Goals .............................................................................................................. 3
152                 mSCP Content Use .................................................................................................... 4
153          mSCP Components .......................................................................................................... 6
154                 Baselines and Benchmarks ........................................................................................ 6
155                 Security Baseline Files ............................................................................................... 6
156      3.2.1.        Rule File Composition ............................................................................................. 7
157      3.2.2.        Rule File Categories ............................................................................................... 9
158                 Configuration Profiles and Scripts ..............................................................................10
159                 Content Generation Scripts........................................................................................10
160      3.4.1.        Generate Baseline Script .......................................................................................10
161      3.4.2.        Generate Guidance Script .....................................................................................10
162      3.4.3.        macOS Security Compliance Tool .........................................................................11
163      3.4.4.        SCAP Generation Script ........................................................................................11
164      3.4.5.        Generate Mapping Script .......................................................................................11
165                 Customization ............................................................................................................12
166                 Directories .................................................................................................................12
167   References ..............................................................................................................................14
168   Appendix A.              mSCP User Roles .........................................................................................15
169   Appendix B.              Example of mSCP Usage by a Security Professional ................................16
170   Appendix C.              Example of Creating a Benchmark Using ODVs ........................................21
171   Appendix D.              Example of mSCP Usage by an Assessment Tool Vendor .......................23
172   Appendix E.              List of Symbols, Abbreviations, and Acronyms ........................................25
173   Appendix F.              Change Log ..................................................................................................26


174   Table of Figures
175   Fig. 1. Security Baseline YAML File ........................................................................................... 7
176   Fig. 2. YAML Rule File ............................................................................................................... 9
177   Fig. 3. Compliance Script Sample Output..................................................................................11



                                                                        iv
      NIST SP 800-219r1 ipd (Initial Public Draft)                                                   Automated Secure Configuration
      March 2023                                                                                          Guidance from the mSCP


178   Fig. 4. Downloading the mSCP code.........................................................................................16
179   Fig. 5. Changing the directory to the mSCP git folder ................................................................16
180   Fig. 6. Changing code branches and generating a baseline ......................................................17
181   Fig. 7. Generating the compliance checker script and configuration profiles .............................17
182   Fig. 8. Running the compliance checker script ..........................................................................17
183   Fig. 9. Selecting run new compliance scan from the main menu ...............................................18
184   Fig. 10. Compliance scan output ...............................................................................................18
185   Fig. 11. Compliance report ........................................................................................................19
186   Fig. 12. Disclaimer for non-compliant settings remediation .......................................................19
187   Fig. 13. Interactive application of compliant settings .................................................................20
188   Fig. 14. Generate Baseline Command ......................................................................................21
189   Fig. 15. Prompt for Bencbmark Name .......................................................................................21
190   Fig. 16. Prompts for Rule File Inclusion .....................................................................................21
191   Fig. 17. Display Rule Description ..............................................................................................22
192   Fig. 18. Rule Prompting for an ODV ..........................................................................................22


193




                                                                     v
      NIST SP 800-219r1 ipd (Initial Public Draft)                         Automated Secure Configuration
      March 2023                                                                Guidance from the mSCP


194   Acknowledgments
195   The authors wish to thank Jason Blake, Blair Heiserman, and Stephanie Roberts from NIST;
196   Allen Golbig from Jamf; Dan Brodjieski, Gary Gapinski, Elyse Anderson, and Joshua Glemza
197   from NASA; and Jamie Richardson and Chris Stone from Apple for their contributions to the
198   mSCP. The authors appreciate Bob McSulla and Ryan Jaynes from Tenable for developing audit
199   files based on the mSCP, testing the baselines for different macOS versions, and contributing to
200   Appendix C. The authors also thank Isabel Van Wyk from NIST for editing the document.
201   Finally, portions of this document are based on content from the mSCP Wiki, so the work of all
202   Wiki contributors is appreciated.




                                                     vi
      NIST SP 800-219r1 ipd (Initial Public Draft)                           Automated Secure Configuration
      March 2023                                                                  Guidance from the mSCP




203       Introduction
204   The National Institute of Standards and Technology (NIST) has traditionally published secure
205   configuration guides for Apple desktop/laptop operating system versions as prose-based Special
206   Publications (SPs), such as NIST SP 800-179, Revision 1, Guide to Securing Apple macOS 10.12
207   Systems for IT Professionals: A NIST Security Configuration Checklist. In order to provide
208   security configuration guidance to organizations more quickly and in a machine-consumable
209   format, NIST established the open-source macOS Security Compliance Project (mSCP). NIST
210   no longer produces SP guidance documents for each macOS release; instead, the mSCP
211   continuously curates and updates machine-consumable macOS guidance. The latest macOS
212   security baseline content is maintained and updated on the mSCP GitHub page [1].
213   Security baselines are groups of settings used to configure a system to meet a target level or set
214   of requirements or to verify that a system complies with requirements. The mSCP seeks to
215   simplify the macOS security development cycle by reducing the amount of effort required to
216   implement security baselines. This collaboration between federal agencies minimizes duplicate
217   effort that would otherwise be needed for these agencies to administer individual security
218   baselines. Additionally, the secure baseline content provided is easily extensible by other parties
219   to implement their own security requirements.
220   Organizations using mSCP content, particularly security baseline examples, should take a risk-
221   based approach for selecting the appropriate settings and defining values that consider the
222   context under which the baseline will be utilized.

223           Purpose and Scope
224   The purpose of this document is to introduce the mSCP to broader audiences. This document
225   provides a high-level overview of the mSCP, its components, and some common use cases. It
226   refers readers to the online project documentation for in-depth technical information and use
227   instructions. This document is intended to be independent of macOS version releases; updates
228   will be released as needed when there are substantial changes to the mSCP. Updates from the
229   previous release of this document mainly involve the new mSCP capability to create a custom
230   benchmark by tailoring a baseline.
231   The information in this document regarding the details of the mSCP GitHub site is accurate as of
232   the time of publication. Readers seeking the latest detailed information on mSCP content or the
233   content itself should visit the mSCP GitHub page and wiki.
234   Organizations that need to reference a NIST SP to demonstrate how they are complying with
235   United States Government mandates for adopting secure configurations for their macOS devices
236   may reference this SP instead of its deprecated predecessors, such as SP 800-179 or SP 800-179,
237   Revision 1.

238           Audience
239   This document and the mSCP GitHub site are intended for system administrators, security
240   professionals, policy authors, privacy officers, and auditors who have responsibilities involving

                                                       1
      NIST SP 800-219r1 ipd (Initial Public Draft)                            Automated Secure Configuration
      March 2023                                                                   Guidance from the mSCP


241   macOS security. Additionally, vendors of device management, security, configuration
242   assessment, and compliance tools that support macOS may find this document and the GitHub
243   site to be helpful.

244           Relevance to NIST SP 800-70 and the National Checklist Program
245   The security baselines from the mSCP GitHub page are included in the National Checklist
246   Program. NIST SP 800-70, Revision 4 [2], explains that federal agencies are required to use
247   appropriate security configuration checklists from the National Checklist Program when
248   available. Part 39 of the Federal Acquisition Regulations, Section 39.101 paragraph (c) states,
249                 In acquiring information technology, agencies shall include the
250                 appropriate information technology security policies and requirements,
251                 including use of common security configurations available from the
252                 National Institute of Standards and Technology’s website at
253                 https://checklists.nist.gov. Agency contracting officers should consult
254                 with the requiring official to ensure the appropriate standards are
255                 incorporated.

256           Document Structure
257   The remaining sections and appendices of this document are as follows:
258       •   Section 2 provides an overview of the project, including what its goals are and how its
259           content can be used.
260       •   Section 3 explains the major components of the mSCP and provides pointers to additional
261           information on component usage.
262       •   The References section lists the references for the document.
263       •   Appendix A briefly discusses how mSCP can help meet the needs of people in several
264           roles.
265       •   Appendix B provides examples of how a security professional might use mSCP content.
266       •   Appendix C contains an example of how an assessment tool vendor could leverage mSCP
267           content.
268       •   Appendix D lists selected acronyms and abbreviations used in this document.
269




                                                        2
      NIST SP 800-219r1 ipd (Initial Public Draft)                                                              Automated Secure Configuration
      March 2023                                                                                                     Guidance from the mSCP


270           Project Description
271   The mSCP is an open-source project that provides a programmatic approach to generating and
272   using macOS security configuration baselines. The project’s content can be used to create
273   customized security baselines of technical security controls by leveraging a library of rules, with
274   each rule mapped to requirements in one or more existing security standards, regulations, or
275   frameworks. This approach provides versioning and consistency of the content. Unifying and
276   standardizing macOS baseline efforts via the mSCP means that updating security guidance is
277   simplified and radically accelerated, even as new versions of macOS are introduced annually.
278   The mSCP started in August 2019 as a collaboration among operational IT security staff from
279   NIST, the National Aeronautics and Space Administration (NASA), the Defense Information
280   Systems Agency (DISA), and the Department of Energy’s (DOE) Los Alamos National
281   Laboratory (LANL). 1 The mSCP sought to map macOS settings to NIST SP 800-53, Revision 4
282   [3] with an extensible, modern approach to security guidance that could be used by any
283   organization (e.g., government, enterprise, education) that needs to adhere to security compliance
284   frameworks and policy.
285   As of this writing, the configuration settings represent guidance and best practices from NIST SP
286   800-53, Revision 5 [4]; NIST SP 800-171, Revision 2 [5]; the macOS DISA Security Technical
287   Implementation Guide (STIG) [6]; the Committee on National Security Systems (CNSS)
288   Instruction (CNSSI) Number 1253 [7]; the Center for Internet Security (CIS) Critical Security
289   Controls Version 8 [8]; and internal organizational security guidance from NIST, NASA, and
290   LANL.

291                Project Goals
292   Apple releases a new macOS version every year, and generally, agencies and organizations must
293   wait for guidance or accept risk before deploying the new macOS version. Most agencies or
294   organizations must create their own internal security configuration, which delays the deployment
295   of the new macOS version or new hardware that only supports the new macOS version. The
296   mSCP assists organizations in upgrading sooner. Generally, the technical security settings in
297   macOS do not drastically change from release to release, with only a handful of new settings
298   being introduced. By pursuing a rules-based approach, mSCP rules that remain applicable can be
299   reused and incorporated into guidance for the latest macOS version. This enables quicker
300   adoption of new security features that are not offered in prior versions of macOS.
301   The goals of the mSCP are to:
302           •    Develop recommended security baselines using a risk-based approach
303           •    Normalize and accelerate annual adoption of the new operating system and hardware by
304                providing guidance to meet the security needs of new operating systems at the earliest
305                availability
306           •    Reduce worldwide efforts in creating annual guidance by unifying and consolidating
307                compliance efforts into a single project

      1
          See https://github.com/usnistgov/macos_security#authors for a current list of project contributors.



                                                                                 3
      NIST SP 800-219r1 ipd (Initial Public Draft)                          Automated Secure Configuration
      March 2023                                                                 Guidance from the mSCP


308       •   Develop a methodology to foster collaboration between baseline authors, reducing
309           overhead and redundancy
310       •   Establish a unified approach for the configuration and assessment of controls across
311           multiple sources and tools
312       •   Enable the customization of existing content and the creation of new content, including
313           creating custom baselines in order to meet organization-specific security requirements
314       •   Provide device management and security tool vendors, auditors, and Apple insight into
315           customer security configuration needs

316           mSCP Content Use
317   mSCP content can be used by any organization to assist in setting and assessing the security
318   configuration of macOS systems. Security baselines can map to existing guidance or controls,
319   such as those in NIST SP 800-53, Revision 5 [4], or they can be customized to meet an
320   organization’s specific needs. In mSCP terminology, a security baseline is represented as a
321   baseline file that designates the rules for meeting a specific set of requirements. The mSCP
322   provides a library of rules that are macOS settings. Each rule is mapped to a requirement within
323   a security standard or framework. Baseline files and rules comprise much of the mSCP’s content.
324   The mSCP offers several example baselines with descriptions adapted from Federal Information
325   Processing Standards (FIPS) 199 [9], such as:
326       •   The SP 800-53, Revision 5 low baseline is a defined map of controls to secure a system
327           defined as a low-impact information system. The loss of confidentiality, integrity, or
328           availability could be expected to have a limited adverse effect on organizational
329           operations, organizational assets, or individuals.
330       •   The SP 800-53, Revision 5 moderate baseline is a defined map of controls to secure a
331           system defined as a moderate-impact information system. The loss of confidentiality,
332           integrity, or availability could be expected to have a serious adverse effect on
333           organizational operations, organizational assets, or individuals.
334       •   The SP 800-53, Revision 5 high baseline is a defined map of controls to secure a system
335           defined as a high-impact information system. The loss of confidentiality, integrity, or
336           availability could be expected to have a severe or catastrophic adverse effect on
337           organizational operations, organizational assets, or individuals.
338   Organizations using any baseline example should take a risk-based approach for selecting the
339   appropriate settings and organizationally defined values depending on the context under which
340   the baseline will be applied. Organizations can tailor any of the baselines to include controls
341   specific to their needs and to produce evidence of control enforcement. Additional information
342   on baseline customization can be found in SP 800-70 [2], which discusses the importance of
343   customizing and testing baselines before applying them to a production system.
344   The mSCP provides scripts that can be used with baselines for several purposes, including the
345   following:
346       •   Creating scripts and profiles for configuring macOS


                                                      4
      NIST SP 800-219r1 ipd (Initial Public Draft)                                                          Automated Secure Configuration
      March 2023                                                                                                 Guidance from the mSCP


347           •    Generating a mapping between security standards, regulations, frameworks, etc.
348           •    Producing human-readable documentation in a variety of formats
349           •    Customizing existing baselines
350   mSCP content can also be used to generate Security Content Automation Protocol (SCAP)
351   content for automated security compliance scans. The SCAP generated follows the SCAP 1.3
352   specification [10]. The generation of SCAP content uses an Extensible Stylesheet Language
353   Transformations (XSLT) file to create an Extensible Configuration Checklist Description Format
354   (XCCDF) checklist document with an accompanying Open Vulnerability and Assessment
355   Language (OVAL) document.
356   The XCCDF and OVAL documents are bundled into an SCAP data stream collection document
357   with accompanying files that include Common Platform Enumeration (CPE) dictionary [11]
358   information and an Open Checklist Interactive Language (OCIL) document. This creates an
359   SCAP 1.3 document that validates using the NIST SCAP Content Validation Tool 2 and can be
360   used by SCAP tools on macOS. More information on SCAP content generation is available at the
361   project wiki.
362




      2
          See https://csrc.nist.gov/projects/security-content-automation-protocol/scap-releases/scap-1-3.



                                                                                 5
      NIST SP 800-219r1 ipd (Initial Public Draft)                            Automated Secure Configuration
      March 2023                                                                   Guidance from the mSCP


363       mSCP Components
364   This section provides an overview of several components of the mSCP: security baseline files,
365   configuration profiles and scripts, content generation scripts, customization capabilities, and
366   directories. More information about all of these is available at the GitHub wiki.

367           Baselines and Benchmarks
368   The mSCP includes both baselines and benchmarks. A baseline is a catalog of recommended
369   configuration settings, not a checklist or benchmark, and should be customized based on the
370   organization’s risk profile. Implementing every item is not likely to be possible or sensible in
371   many operational scenarios. Baselines can be used to assist in the creation of security
372   benchmarks. A benchmark differs from a baseline in that it defines values in addition to a set of
373   controls. Benchmarks are published by organizations that have made risk-based decisions, such
374   as DISA and CIS. Organizations can also define their own benchmark. These values are called
375   Organization-Defined Values (ODVs), and they exist throughout the baselines and can be set
376   during customization.

377           Security Baseline Files
378   In the mSCP, a security baseline is defined in a Yet Another Markup Language (YAML) file. A
379   YAML file is a human-readable file format commonly used by configuration files where data are
380   stored and/or transmitted. A baseline YAML file consists of the following required fields:
381       •   title – A human-readable name for the baseline

382       •   description – A short description of the baseline, including its use case and target
383           operating system (OS) version
384       •   authors – Developers of the baseline

385       •   profile – The security content portion of the baseline
386                o section – A keyword for organizing settings
387                o rules – The names of the rule files that are a part of this baseline
388   The following code provides a partial example of a YAML file that illustrates the use of these
389   fields (with field names bolded):




                                                        6
      NIST SP 800-219r1 ipd (Initial Public Draft)                                Automated Secure Configuration
      March 2023                                                                       Guidance from the mSCP


390   title: "Apple macOS 11 (Big Sur) Test Baseline"
391   description: |
392     This guide describes the prudent actions to take when securing a macOS 11
393   system against the Test Baseline.
394   authors: |
395     |===
396     |Joe Doe|NIST
397     |===
398   profile:
399     - section: "Authentication"
400       rules:
401          - auth_pam_login_smartcard_enforce
402          - auth_pam_su_smartcard_enforce
403          - auth_pam_sudo_smartcard_enforce
404          - auth_smartcard_allow
405     - section: "Auditing"
406       rules:
407          - audit_acls_files_configure
408          - audit_acls_files_mode_configure
409          - audit_acls_folder_wheel_configure

410                                        Fig. 1. Security Baseline YAML File.


411   3.2.1. Rule File Composition
412   A YAML rule file is broken down into the following subsections. This list and the following
413   example are from the Rules section of the mSCP wiki.
414       •   id – The id should match the file name without the yaml file extension.

415       •   title – The title is a human-readable title of the rule.

416       •   discussion – The discussion should provide a concise description of the intended use
417           of the rule.
418       •   check – Every rule will have a check. A shell-based check should be able to validate and
419           check most rules.
420       •   result – Expected results from the check.

421       •   fix – The fix will appear in a document when generated. If a fix includes
422           [source,bash], the fix will be used for generating the script to enforce the rule.

423       •   references – The references include a Common Configuration Enumeration (CCE)
424           identifier and a mapping of the security frameworks, guidance, and individual controls
425           that have been mapped to the rule. See the official repository of NIST CCEs [12] for
426           more information.
427       •   macOS – The validated macOS version for this rule.

428       •   odv – If a rule supports the ODV functionality, then the odv section should be present. At
429           a minimum, this field should contain a hint (provides a description when tailoring a
430           baseline) and a default value that replaces the $ODV variable.




                                                            7
      NIST SP 800-219r1 ipd (Initial Public Draft)                         Automated Secure Configuration
      March 2023                                                                Guidance from the mSCP


431       •   tags – Tags are keywords used to categorize and identify related rules, and they can be
432           added to or modified as needed. Tags can also be used to make index-based searching of
433           the rules faster and easier.
434       •   severity – The severity level specified in the DISA STIG, if applicable.

435       •   mobileconfig – The mobileconfig and mobileconfig_info subsections are related. If
436           mobileconfig is set to true, the information required for creating the mobileconfig
437           configuration profile is required in the mobileconfig_info area.
438   The following code provides a notional example of a YAML rule file (with field names bolded):
439   id: sysprefs_screensaver_timeout_enforce
440   title: "Enforce Screen Saver Timeout"
441   discussion: |
442     The screen saver timeout _MUST_ be set to $ODV seconds or a shorter length
443   of time.
444
445     This rule ensures that a full session lock is triggered within no more than
446   $ODV seconds of inactivity.
447   check: |
448     /usr/bin/osascript -l JavaScript << EOS
449     function run() {
450       let timeout =
451   ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')
452   \
453     .objectForKey('idleTime'))
454       if ( timeout <= $ODV ) {
455         return("true")
456       } else {
457         return("false")
458       }
459     }
460     EOS
461   result:
462     string: "true"
463   fix: |
464     This is implemented by a Configuration Profile.
465   references:
466     cce:
467       - CCE-91074-5
468     cci:
469       - CCI-000057
470     800-53r5:
471       - AC-11
472       - IA-11
473     800-53r4:
474       - AC-11
475     srg:
476       - SRG-OS-000029-GPOS-00010
477     disa_stig:
478       - APPL-12-000004
479     800-171r2:
480       - 3.1.10
481     cis:
482       benchmark:
483         - 2.3.1 (level 1)
484       controls v8:
485         - 4.3
486   macOS:
487     - "12.0"



                                                     8
      NIST SP 800-219r1 ipd (Initial Public Draft)                                  Automated Secure Configuration
      March 2023                                                                         Guidance from the mSCP


488   odv:
489     hint: "Number of seconds."
490     default: 1200
491     stig: 900
492     cis_lvl1: 1200
493     cis_lvl2: 1200
494   tags:
495     - 800-53r5_moderate
496     - 800-53r5_high
497     - 800-53r5_low
498     - 800-53r4_moderate
499     - 800-53r4_high
500     - 800-171
501     - cnssi-1253
502     - cis_lvl1
503     - cis_lvl2
504     - cisv8
505     - stig
506   severity: "medium"
507   mobileconfig: true
508   mobileconfig_info:
509     com.apple.screensaver:
510       idleTime: $ODV

511                                                        Fig. 2. YAML Rule File


512   3.2.2. Rule File Categories
513   The mSCP organizes YAML files in the rules directory into the following subdirectories, each
514   of which corresponds to a category of settings:
515          •    audit – OpenBSM 3

516          •    auth – Smartcard authentication

517          •    icloud – Apple’s iCloud/Apple ID service

518          •    os – Rules to configure the operating system that do not fit into the other categories

519          •    pwpolicy – Password policy

520          •    system_settings or sysprefs – Settings controlled within the System Settings or
521               System Preferences application
522   The rules directory also includes a supplemental subdirectory, which contains additional
523   information that supports the guidance provided by the baselines. Supplemental content contains
524   information for rules that are not part of an existing baseline but could be beneficial for certain
525   use cases. Supplemental content may not have mappings and may not contain the YAML rule
526   file check and fix sections mentioned in Section 3.2.1. Supplemental content can be added to
527   enhance baselines where organizational requirements are different than the system baseline
528   requirements.




      3
          See OpenBSM at https://github.com/openbsm/openbsm.



                                                                     9
      NIST SP 800-219r1 ipd (Initial Public Draft)                            Automated Secure Configuration
      March 2023                                                                   Guidance from the mSCP


529           Configuration Profiles and Scripts
530   When an mSCP YAML file is processed, it yields a configuration script and/or configuration
531   profile (mobileconfig file) as outputs. Both are used to apply configuration settings to a system.
532   A configuration profile is an Extensible Markup Language (XML) formatted file with a
533   mobileconfig extension that contains a configuration payload. macOS can automatically
534   configure itself based on a mobileconfig file’s contents upon execution. Configuration profiles
535   offer a convenient, Apple-supported mechanism for applying security settings to a macOS
536   environment. Additionally, they can be cryptographically signed to ensure integrity and
537   authenticity. These factors make configuration profiles the preferred vehicle for configuration
538   delivery. However, mobileconfig files cannot modify all macOS settings, so a configuration
539   script is needed for those settings that are not supported. See the developer documentation page
540   for an example configuration profile and brief descriptions of its properties.
541   A configuration script is a shell script that directly manipulates operating system files. The script
542   content is derived from all YAML rule files that have a mobileconfig value of false and
543   belong to the specified baseline. The YAML rule file must contain the fix section in order to
544   generate its corresponding configuration script entry.

545           Content Generation Scripts
546   The mSCP provides several types of scripts for generating baselines, human-readable guidance,
547   baseline compliance checkers, and other types of content. Each script is described below.

548   3.4.1. Generate Baseline Script
549   The generate_baseline.py Python script compiles a list of security rules into a single baseline
550   YAML file. It can be used to modify an existing security baseline or create a new one. See the
551   wiki for additional information.

552   3.4.2. Generate Guidance Script
553   The generate_guidance.py script can produce human-readable guidance and generate the
554   macOS Security Compliance Tool, which is a Z shell script.
555   The generate_guidance.py script takes a baseline file and produces a human-readable guide
556   with information from the YAML rules files. The script can create documentation in several
557   formats but always generates an AsciiDoc file. AsciiDoc (.adoc) is a plain text format that uses
558   markup conventions for traditional document formatting and organization. AsciiDoc files are
559   easily transformable into many other formats via the generate_guidance.py script, including
560   HTML, PDF, and Excel. The Excel format is particularly useful for quickly viewing all of the
561   rules of a baseline, and it contains all of the data in the YAML rules files.
562   The generate_guidance.py script can also create configuration profiles (mobileconfig files)
563   and the macOS Security Compliance Tool. Using the -s argument, the generate_guidance.py
564   script will generate an org.{baseline}.audit.plist file and another script, the macOS
565   Security Compliance Tool, that can check and remediate compliance settings. The audit.plist


                                                       10
      NIST SP 800-219r1 ipd (Initial Public Draft)                                 Automated Secure Configuration
      March 2023                                                                        Guidance from the mSCP


566   file can be used to set an exemption to organizational rules for approved users so that compliance
567   checks can succeed without findings. To create an exemption for a rule, the exempt field should
568   be set to true and an exempt_reason should be added.
569   See the wiki for more information on the generate_guidance.py script.

570   3.4.3. macOS Security Compliance Tool
571   The {baseline}_compliance.sh script runs interactively by default. It can evaluate a system’s
572   conformance to a baseline or remediate any incorrectly configured settings. Alternatively, the
573   script can autonomously assess a system with the –check argument or automatically remediate
574   baseline settings with –fix.
575   The lines below provide an example of the results of running the script:
576   Thu Jan 21 15:09:41 UTC 2021 auth_pam_login_smartcard_enforce passed (Result:
577   2, Expected: {integer: 2})
578   Thu Jan 21 15:09:41 UTC 2021 auth_smartcard_allow passed (Result: 1,
579   Expected: {integer: 1})
580   Thu Jan 21 15:09:41 UTC 2021 auth_pam_sudo_smartcard_enforce passed (Result:
581   2, Expected: {integer: 2})
582   Thu Jan 21 15:09:41 UTC 2021
583   auth_smartcard_certificate_trust_enforce_moderate passed (Result: 2,
584   Expected: {integer: 2})
585   Thu Jan 21 15:09:41 UTC 2021 auth_smartcard_enforce has an exemption (Reason:
586   Broken Reader)

587                                     Fig. 3. Compliance Script Sample Output.

588   For more information on the macOS Security Compliance Tool script, see the wiki.

589   3.4.4. SCAP Generation Script
590   The SCAP generation script, generate_scap.py can generate an SCAP 1.3 document, XCCDF
591   document, or OVAL file. The script builds content from available tags within the YAML files
592   and does not need to be pointed to a baseline file.
593   For more information, see the wiki.

594   3.4.5. Generate Mapping Script
595   The generate_mapping.py script allows for the quick creation of custom rules and baselines for
596   a compliance framework not published by the mSCP. The script requires a user-created comma-
597   separated values (CSV) file containing control identifiers that maps to a new framework (CSV
598   column 1) from another already defined by the project (CSV column 2). By default, the script is
599   designed to map a framework to the NIST SP 800-53, Revision 5 [4] set of controls. Adding the
600   -f argument allows for mapping to another supported framework. See the wiki for more
601   information on the generate_mapping.py script.




                                                          11
      NIST SP 800-219r1 ipd (Initial Public Draft)                          Automated Secure Configuration
      March 2023                                                                 Guidance from the mSCP


602           Customization
603   Organizations should make the risk-based decision on what controls and rules to use and how to
604   apply them, as stated by NIST SP 800-53, Revision 5 controls PL-10 and PL-11. Customization
605   allows organizations to generate their own customized content outside of that provided by the
606   project. Additionally, it allows them to add content for internal-only controls, which are not
607   suitable for inclusion in a global baseline. Customization primarily takes place within the custom
608   folder. Here are examples of customizations supported by mSCP:
609       •   Baselines: A baseline folder can be included within the custom folder to create
610           customized baselines that fit an organization’s needs. These baseline files may include
611           rule, section, and template customization (discussed below). An existing baseline can be
612           configured to create a custom benchmark. Additionally, it is possible to customize an
613           included benchmark, but in doing so, it may no longer be compliant with the original
614           requirements of that benchmark.
615       •   Rules: Existing rules can have their setting values overridden via the custom folder
616           instead of modifying the mSCP-supplied rule file. New rules can be created and added to
617           existing baselines or to user-defined baselines. Organizations can create their own
618           discussions, checks, results, fixes, and mappings of rules to security frameworks not
619           included in the project. In order to override an existing rule, the custom rule file name
620           must match an existing rule so that the generate_guidance.py script will pick up the
621           new values. New rules not included in mSCP must be listed in the baseline YAML file
622           specified when running generate_guidance.py. Additional information on custom
623           rules can be found in an article written by mSCP contributor Allen Golbig [13].
624       •   Sections: Custom sections can be used to organize existing or custom YAML rule files.
625           Sections defined in the custom folder must be included in a baseline YAML file in order
626           to be used by generate_guidance.py.
627       •   Templates: Custom templates can be used to define new template structures for the
628           project and affect the organization and appearance of generated documentation. The
629           template files must match the name of an existing template and will override that
630           template when running generate_guidance.py.
631       •   Logos: An organization can include a custom logo when running the
632           generate_guidance.py script by using the -l argument to point to an image file.

633       •   Tailoring: The generate_baseline.py script allows for a baseline to be tailored using
634           the -t argument. During the tailoring process, the script will prompt for each control
635           containing an ODV to have its values customized. If a value is not supplied to a control
636           with an ODV, it will use the default value in the rule file. Refer to Appendix C for an
637           example of tailoring with ODVs.

638           Directories
639   mSCP source code releases available on the mSCP GitHub include the following directories:
640       •   baselines – Contains the defined YAML baseline files



                                                      12
      NIST SP 800-219r1 ipd (Initial Public Draft)                           Automated Secure Configuration
      March 2023                                                                  Guidance from the mSCP


641       •   build – Holds scripts, documents, and configuration profiles generated by running
642           scripts
643       •   custom – Used for creating customized baselines, rules, sections, or templates to meet an
644           organization’s requirements
645       •   includes – Contains the YAML-based libraries required for running the scripts

646       •   rules – Contains YAML rule files with one rule per file

647       •   scripts – Contains the content generation scripts and their required files

648       •   sections – Defines the sections that correlate to the directories in the rules folder; each
649           section has its own YAML file that contains the section name and description as it will
650           appear in the generated guide, which is human-readable documentation
651       •   templates – Includes AsciiDoc templates for generating an AsciiDoc guide




                                                      13
      NIST SP 800-219r1 ipd (Initial Public Draft)                       Automated Secure Configuration
      March 2023                                                              Guidance from the mSCP


652   References
653   [1]  macOS Security Compliance Project (2023) macOS Security Compliance Project.
654        Available at https://github.com/usnistgov/macos_security
655   [2] Quinn SD, Souppaya MP, Cook MR, Scarfone KA (2018) National Checklist Program for
656        IT Products: Guidelines for Checklist Users and Developers. (National Institute of
657        Standards and Technology, Gaithersburg, MD), NIST Special Publication (SP) 800-70,
658        Rev. 4. https://doi.org/10.6028/NIST.SP.800-70r4
659   [3] Joint Task Force Transformation Initiative (2013) Security and Privacy Controls for
660        Federal Information Systems and Organizations. (National Institute of Standards and
661        Technology, Gaithersburg, MD), NIST Special Publication (SP) 800-53, Rev. 4, Includes
662        updates as of January 22, 2015. https://doi.org/10.6028/NIST.SP.800-53r4
663   [4] Joint Task Force (2020) Security and Privacy Controls for Information Systems and
664        Organizations. (National Institute of Standards and Technology, Gaithersburg, MD), NIST
665        Special Publication (SP) 800-53, Rev. 5. Includes updates as of December 10, 2020.
666        https://doi.org/10.6028/NIST.SP.800-53r5
667   [5] Ross R, Pillitteri V, Dempsey K, Riddle M, Guissanie G (2020) Protecting Controlled
668        Unclassified Information in Nonfederal Systems and Organizations. (National Institute of
669        Standards and Technology, Gaithersburg, MD), NIST Special Publication (SP) 800-171,
670        Rev. 2, Includes updates as of January 28, 2021. https://doi.org/10.6028/NIST.SP.800-
671        171r2
672   [6] Department of Defense (2023) DISA STIG for macOS. Available at
673        https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=mac-os
674   [7] Committee on National Security Systems (2014) Security Categorization and Control
675        Selection for National Security Systems. (National Security Agency, Ft. Meade, MD),
676        Committee on National Security Systems Instruction (CNSSI) No. 1253. Available at
677        https://www.cnss.gov/CNSS/issuances/Instructions.cfm
678   [8] Center for Internet Security (2023) CIS Critical Security Controls Version 8. Available at
679        https://www.cisecurity.org/controls/v8/
680   [9] National Institute of Standards and Technology (2004) Standards for Security
681        Categorization of Federal Information and Information Systems. (U.S. Department of
682        Commerce, Washington, DC), Federal Information Processing Standards Publication
683        (FIPS) 199. https://doi.org/10.6028/NIST.FIPS.199
684   [10] Waltermire DA, Quinn SD, Booth H, III, Scarfone KA, Prisaca D (2018) The Technical
685        Specification for the Security Content Automation Protocol (SCAP): SCAP Version 1.3.
686        (National Institute of Standards and Technology, Gaithersburg, MD), NIST Special
687        Publication (SP) 800-126, Rev. 3. https://doi.org/10.6028/NIST.SP.800-126r3
688   [11] National Institute of Standards and Technology (2023). Official Common Platform
689        Enumeration (CPE) dictionary. Available at https://nvd.nist.gov/products/cpe
690   [12] National Institute of Standards and Technology (2022) CCE Platform Listing. Available at
691        https://ncp.nist.gov/cce
692   [13] Golbig A (2021) Getting to Know: macOS Security Compliance Project – Part 2. Available
693        at https://golbiga.medium.com/getting-to-know-macos-security-compliance-project-part-2-
694        24131b60cdfb




                                                     14
      NIST SP 800-219r1 ipd (Initial Public Draft)                          Automated Secure Configuration
      March 2023                                                                 Guidance from the mSCP


695   Appendix A. mSCP User Roles
696   The mSCP was designed to meet the needs of different security roles. These perspectives are
697   briefly examined below.
698   Security policy authors define the policies for their organizations. The customization and ease
699   of extensibility offered by the mSCP facilitate new content creation. Policy authors will need to
700   familiarize themselves with the YAML rule file format described in Section 3.2.1. Of particular
701   interest is the ability to map rules directly to references. Additionally, the generate mapping
702   script (Section 3.4.5) enhances portability between compliance frameworks.
703   System administrators and security professionals are responsible for configuring the systems
704   under their purview. They implement the guidance issued by security policy authors. Security
705   professionals may wish to generate baselines (Section 3.4.1), guidance (Section 3.4.2), and
706   configuration using the macOS Security Compliance Tool (Section 3.4.3).
707   Auditors approach macOS security compliance from a validator perspective, seeking proof that
708   a system is configured in the required way. They are more interested in system setting
709   documentation and compliance evidence than technical tools, such as configuration scripts. Both
710   of these needs can be met by mSCP tools. The generate guidance script (Section 3.4.2) provides
711   the necessary documentation in a variety of formats, including HTML, PDF, and Excel. The
712   macOS Security Compliance Tool (Section 3.4.3) assesses a system and produces a log of the
713   results. Additionally, some auditors may be interested in examining YAML rule content directly
714   (Section 3.2.1).
715   Information security officers have a variety of goals but are ultimately responsible for ensuring
716   that systems are configured according to their organizational requirements. To accomplish this,
717   they need policy documentation (Section 3.4.2) and the results of compliance scans (Section
718   3.4.3). Information security officers may also be responsible for reviewing the security rules
719   proposed by the policy authors. If this is the case, they may be interested in YAML rule file
720   components (Section 3.2.1).
721   Vendors of device management, security, configuration assessment, and compliance tools
722   can produce a series of audit files based on mSCP content to support different macOS versions
723   and associated security baselines. These audit files are maintained, tested, published, and
724   supported by the tool vendors. Tool customers can download and import the content into the tool
725   to assess the state of their system against a particular baseline in an automated way.
726   Specific audit files of the mSCP by tool vendors are described on the project wiki page. This
727   content will be updated as contributing tool vendors develop new audit content.




                                                      15
      NIST SP 800-219r1 ipd (Initial Public Draft)                                  Automated Secure Configuration
      March 2023                                                                         Guidance from the mSCP


728   Appendix B. Example of mSCP Usage by a Security Professional
729   This appendix provides examples of how a security professional might use mSCP content.
730   People in other roles might perform some of the same actions. The examples illustrated below
731   were accurate at the time of publication, but see the mSCP wiki for up-to-date usage guidance.
732   Note that the mSCP scripts are not meant to replace enterprise-class configuration and
733   management tools. Configurations should be tested on development systems before being
734   deployed on end users’ systems.
735   Preparing to use mSCP
736   All project components are available from the mSCP GitHub page [1] by navigating to
737   Releases and downloading the latest source code revision for the desired macOS version.
738   Alternatively, the project source code can be downloaded via git, as the example below
739   illustrates.




740
741                                        Fig. 4. Downloading the mSCP code.

742
743   mSCP components rely on prerequisite software listed on the Getting Started page, and any
744   missing software must be installed.
745   Changing code branches and generating a baseline
746   After obtaining a copy of the source code, change the directory to the mSCP git folder,
747   macos_security.




748
749                               Fig. 5. Changing the directory to the mSCP git folder.

750
751   Next, select the appropriate code branch that corresponds to the target OS version. Then choose a
752   baseline and use the generate_baseline.py script to create a baseline YAML file. The




                                                           16
      NIST SP 800-219r1 ipd (Initial Public Draft)                                 Automated Secure Configuration
      March 2023                                                                        Guidance from the mSCP


753   example below illustrates these steps for the NIST SP 800-53, Revision 5 moderate baseline for
754   macOS Big Sur.




755
756                            Fig. 6. Changing code branches and generating a baseline.

757
758   Creating the macOS Security Compliance Tool and configuration profiles
759   Using the generate_guidance.py script, create the macOS Security Compliance Tool and
760   configuration profiles. The example below illustrates this, continuing from the previous example.




761
762                   Fig. 7. Generating the compliance checker script and configuration profiles.

763
764   Running a compliance scan
765   As the example below shows, the macOS Security Compliance Tool is typically run with
766   administrator privileges so that it can access all of the settings.



767
768                                   Fig. 8. Running the compliance checker script.



                                                           17
      NIST SP 800-219r1 ipd (Initial Public Draft)                              Automated Secure Configuration
      March 2023                                                                     Guidance from the mSCP


769
770   The example below shows the main menu presented by the macOS Security Compliance Tool.




771
772                       Fig. 9. Selecting “Run New Compliance Scan” from the main menu.

773
774   Selecting option 2, “Run New Compliance Scan,” from the main menu launches the scan. The
775   example below shows output from the scan, which in this case reflects numerous rule failures,
776   each indicating a deviation from the expected configuration.




777
778                                          Fig. 10. Compliance scan output.

779




                                                           18
      NIST SP 800-219r1 ipd (Initial Public Draft)                                 Automated Secure Configuration
      March 2023                                                                        Guidance from the mSCP


780   Selecting option 1, “View Last Compliance Report,” from the main menu displays a summary of
781   the compliance report results. The example below depicts results indicating that 30 tests passed
782   and 108 tests failed for an overall score of 21.74 % compliant.




783
784                                        Fig. 11. Viewing a compliance report.

785
786   Fixing non-compliant settings
787   Selecting option 3, “Run Commands to remediate non-compliant settings,” begins the process of
788   fixing non-compliant settings discovered during a previous compliance scan. The example below
789   illustrates the disclaimer to be reviewed and accepted before fixes are initiated. This disclaimer
790   indicates the potential risk in applying fixes.




791
792                            Fig. 12. Disclaimer for non-compliant settings remediation.

793


                                                            19
      NIST SP 800-219r1 ipd (Initial Public Draft)                                      Automated Secure Configuration
      March 2023                                                                             Guidance from the mSCP


794   After the disclaimer statement is accepted, the fixes are applied to the system, as the example
795   below illustrates.




796
797                                      Fig. 13. Interactively configuring settings.

798




                                                             20
      NIST SP 800-219r1 ipd (Initial Public Draft)                                    Automated Secure Configuration
      March 2023                                                                           Guidance from the mSCP


799   Appendix C. Example of Creating a Benchmark Using ODVs
800   This appendix provides an example of tailoring a baseline to create a custom benchmark using
801   the generate_baseline.py script. The screenshot below illustrates the first step to creating a
802   benchmark.




803
804                                       Fig. 14. Generate baseline command.

805
806   The -t option for generate_baseline.py is used to customize the specified baseline. The
807   script prompts for a name for the benchmark being created, as the example below shows.




808
809                                       Fig. 15. Prompt for benchmark name.

810
811   Next, for each rule that exists in the specified starting baseline, the script asks if it should be
812   included in the custom benchmark. An example is shown below.




813
814                                        Fig. 16. Prompt for rule file inclusion.

815




                                                             21
      NIST SP 800-219r1 ipd (Initial Public Draft)                                Automated Secure Configuration
      March 2023                                                                       Guidance from the mSCP


816   Entering a “?” in response to a rule being included will display a description of that rule, as
817   illustrated below.




818
819                                          Fig. 17. Display rule description.

820
821   If a rule accepts an ODV, the script asks the user to enter their own value or use the default value
822   displayed. The example below illustrates this.




823
824                                        Fig. 18. Rule prompting for an ODV.

825




                                                            22
      NIST SP 800-219r1 ipd (Initial Public Draft)                           Automated Secure Configuration
      March 2023                                                                  Guidance from the mSCP


826   Appendix D. Example of mSCP Usage by an Assessment Tool Vendor
827   This appendix provides an example of how an assessment tool vendor converted mSCP content
828   to their tool’s proprietary format so that their tool could perform compliance checks against
829   mSCP baselines and rules. Refer to the mSCP GitHub wiki page for the most current list of tool
830   vendors and associated content that will support the mSCP baselines.
831   This example is for Tenable, Inc. They automated the conversion of mSCP YAML rules into
832   their .audit format using Python and YAML libraries. Programmatically approaching this
833   conversion allows for faster future releases and greater consistency, and it also maintains the
834   integrity of the source content. Because the YAML content is all command-driven, it is
835   converted to Tenable’s CMD_EXEC check type for use with the Unix plugin. The YAML rules
836   have a “tags” section that was used to create unique audit profiles related to common
837   frameworks. An example of these profiles can be seen in the audit file naming convention:
838       •   NIST_macOS_Big_Sur_800-171_v1.4.0.audit
839       •   NIST_macOS_Catalina_800-53r5_high_v1.5.0.audit
840   See Tenable’s research highlight for more details.
841   The following example shows a YAML-to-audit-check conversion. The content has been
842   condensed and abbreviated for the purposes of comparison:
843   mSCP YAML
844   title: "Limit SSHD to FIPS 140 Validated Ciphers"
845
846   discussion: |
847     If SSHD is enabled, then it _MUST_ be configured to limit the ciphers to
848   algorithms that are FIPS 140-validated.
849   FIPS 140-2 is the current standard for validating that mechanisms used to
850   access cryptographic modules utilize authentication that meets federal
851   requirements.
852   Operating systems utilizing encryption _MUST_ use FIPS-validated mechanisms
853   for authenticating to cryptographic modules.
854     NOTE: /etc/ssh/sshd_config will be automatically modified to its original
855   state following any update or major upgrade to the operating system.
856
857   check: |
858     /usr/bin/grep -c "^Ciphers aes256-ctr,aes192-ctr,aes128-ctr"
859   /etc/ssh/sshd_config
860
861   result:
862     integer: 1

863   Tenable Audit Check
864   <custom_item>
865     system      : "Darwin"
866     type        : CMD_EXEC
867     description : "Big Sur - Limit SSHD to FIPS 140 Validated Ciphers"
868     info        : "If SSHD is enabled, then it _MUST_ be configured to limit
869   the ciphers to algorithms that are FIPS 140-validated.
870   FIPS 140-2 is the current standard for validating that mechanisms used to
871   access cryptographic modules utilize authentication that meets federal
872   requirements.
873



                                                      23
      NIST SP 800-219r1 ipd (Initial Public Draft)           Automated Secure Configuration
      March 2023                                                  Guidance from the mSCP


874   Operating systems utilizing encryption _MUST_ use FIPS-validated mechanisms
875   for authenticating to cryptographic modules.
876   NOTE: /etc/ssh/sshd_config will be automatically modified to its original
877   state following any update or major upgrade to the operating system."
878     cmd         : "/usr/bin/grep -c \"^Ciphers aes256-ctr,aes192-ctr,aes128-
879   ctr\" /etc/ssh/sshd_config"
880     expect      : "1"
881   </custom_item>




                                                     24
      NIST SP 800-219r1 ipd (Initial Public Draft)                        Automated Secure Configuration
      March 2023                                                               Guidance from the mSCP




882   Appendix E. List of Symbols, Abbreviations, and Acronyms
883   Selected acronyms and abbreviations used in this paper are defined below.
884   CCE
885   Common Configuration Enumeration

886   CIS
887   Center for Internet Security

888   CNSS
889   Committee on National Security Systems

890   CNSSI
891   Committee on National Security Systems Instruction

892   DISA
893   Defense Information Systems Agency

894   FIPS
895   Federal Information Processing Standards

896   LANL
897   Los Alamos National Laboratory

898   mSCP
899   macOS Security Compliance Project

900   NASA
901   National Aeronautics and Space Administration

902   NIST
903   National Institute of Standards and Technology

904   ODV
905   Organization-Defined Value

906   OVAL
907   Open Vulnerability and Assessment Language

908   SCAP
909   Security Content Automation Protocol

910   SP
911   Special Publication

912   STIG
913   Security Technical Implementation Guide

914   XCCDF
915   Extensible Configuration Checklist Description Format

916   YAML
917   Yet Another Markup Language




                                                              25
      NIST SP 800-219r1 ipd (Initial Public Draft)                           Automated Secure Configuration
      March 2023                                                                  Guidance from the mSCP


918   Appendix F. Change Log
919   In March 2023, the following changes were made to this report:
920       •   Made minor editorial changes throughout the report to improve clarity and usability
921       •   Reformatted all content and revised front matter to follow the latest NIST technical report
922           template
923       •   Merged the content of the Executive Summary into Section 1 and deleted the Executive
924           Summary section
925       •   Section 1.1 – Summarized updates from the previous release
926       •   Section 3.1 – Added a new subsection to define and discuss baselines and benchmarks
927       •   Section 3.2.1 – Updated descriptions to match the project wiki and changed the example
928           rule file to one with an ODV
929       •   Section 3.4.4 – Changed from OVAL generation script to SCAP generation script
930       •   Section 3.5 – Added discussion on tailoring baselines and benchmarks using the
931           generate_baseline.py script and ODVs
932       •   Appendix C – Created a new appendix showing an example of how to tailor a baseline to
933           create a custom benchmark




                                                      26
