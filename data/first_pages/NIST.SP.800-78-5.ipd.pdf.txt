 1                    NIST Special Publication
 2                       NIST SP 800-78-5 ipd

 3   Cryptographic Algorithms and Key
 4           Sizes for Personal Identity
 5                          Verification
 6


 7                                            Initial Public Draft

 8                                             Hildegard Ferraiolo
 9                                            Andrew Regenscheid

10                    This publication is available free of charge from:
11                      https://doi.org/10.6028/NIST.SP.800-78-5.ipd
12
13
14                                            NIST Special Publication
15                                               NIST SP 800-78-5 ipd

16   Cryptographic Algorithms and Key
17           Sizes for Personal Identity
18                          Verification
19


20                                                                          Initial Public Draft

21                                                                            Hildegard Ferraiolo
22                                                                           Andrew Regenscheid
23                                                                   Computer Security Division
24                                                            Information Technology Laboratory

25                                            This publication is available free of charge from:
26                                              https://doi.org/10.6028/NIST.SP.800-78-5.ipd

27                                                                                      September 2023




28
29                                                                             U.S. Department of Commerce
30                                                                              Gina M. Raimondo, Secretary

31                                                             National Institute of Standards and Technology
32          Laurie E. Locascio, NIST Director and Under Secretary of Commerce for Standards and Technology
     NIST SP 800-78-5 ipd (Initial Public Draft)                                               Cryptographic Algorithms
     September 2023                                                                               and Key Sizes for PIV

33   Certain commercial equipment, instruments, software, or materials, commercial or non-commercial, are identified in
34   this paper in order to specify the experimental procedure adequately. Such identification does not imply
35   recommendation or endorsement of any product or service by NIST, nor does it imply that the materials or
36   equipment identified are necessarily the best available for the purpose.

37   There may be references in this publication to other publications currently under development by NIST in
38   accordance with its assigned statutory responsibilities. The information in this publication, including concepts and
39   methodologies, may be used by federal agencies even before the completion of such companion publications. Thus,
40   until each publication is completed, current requirements, guidelines, and procedures, where they exist, remain
41   operative. For planning and transition purposes, federal agencies may wish to closely follow the development of
42   these new publications by NIST.

43   Organizations are encouraged to review all draft publications during public comment periods and provide feedback
44   to NIST. Many NIST cybersecurity publications, other than the ones noted above, are available at
45   https://csrc.nist.gov/publications.


46   Authority
47   This publication has been developed by NIST in accordance with its statutory responsibilities under the Federal
48   Information Security Modernization Act (FISMA) of 2014, 44 U.S.C. § 3551 et seq., Public Law (P.L.) 113-283.
49   NIST is responsible for developing information security standards and guidelines, including minimum requirements
50   for federal information systems, but such standards and guidelines shall not apply to national security systems
51   without the express approval of appropriate federal officials exercising policy authority over such systems. This
52   guideline is consistent with the requirements of the Office of Management and Budget (OMB) Circular A-130.
53
54   Nothing in this publication should be taken to contradict the standards and guidelines made mandatory and binding
55   on federal agencies by the Secretary of Commerce under statutory authority. Nor should these guidelines be
56   interpreted as altering or superseding the existing authorities of the Secretary of Commerce, Director of the OMB, or
57   any other federal official. This publication may be used by nongovernmental organizations on a voluntary basis and
58   is not subject to copyright in the United States. Attribution would, however, be appreciated by NIST.


59   NIST Technical Series Policies
60   Copyright, Use, and Licensing Statements
61   NIST Technical Series Publication Identifier Syntax


62   Publication History
63   Approved by the NIST Editorial Review Board on YYYY-MM-DD [Will be add in the final publication]
64   Supersedes NIST Series XXX (Month Year) DOI [Will be added in the final publication]


65   How to Cite this NIST Technical Series Publication:
66   Ferraiolo H, Regenscheid A (2023) Cryptographic Algorithms and Key Sizes for Personal Identity Verification.
67   (National Institute of Standards and Technology, Gaithersburg, MD), NIST Special Publication (SP) NIST SP 800-
68   78-5 ipd. https://doi.org/10.6028/NIST.SP.800-78-5.ipd


69   Author ORCID iDs
70   Hildegard Ferraiolo: 0000-0002-7719-5999
71   Andrew Regenscheid: 0000-0002-3930-527X
     NIST SP 800-78-5 ipd (Initial Public Draft)                               Cryptographic Algorithms
     September 2023                                                               and Key Sizes for PIV

72   Public Comment Period
73   September 27, 2023 – November 15, 2023


74   Submit Comments
75   piv_comments@nist.gov
76
77   National Institute of Standards and Technology
78   Attn: Computer Security Division, Information Technology Laboratory
79   100 Bureau Drive (Mail Stop 8930) Gaithersburg, MD 20899-8930


80   All comments are subject to release under the Freedom of Information Act (FOIA).
      NIST SP 800-78-5 ipd (Initial Public Draft)                                    Cryptographic Algorithms
      September 2023                                                                    and Key Sizes for PIV



 81   Abstract
 82   Federal Information Processing Standard 201-3 (FIPS 201-3) defines the requirements for
 83   Personal Identity Verification (PIV) life cycle activities, including identity proofing, registration,
 84   PIV Card issuance, and PIV Card usage. FIPS 201-3 also defines the structure of an identity
 85   credential that includes cryptographic keys. This document contains the technical specifications
 86   needed for the mandatory and optional cryptographic keys specified in FIPS 201-3, as well as the
 87   supporting infrastructure specified in FIPS 201-3 and the related NIST Special Publication (SP)
 88   800-73, Interfaces for Personal Identity Verification, and NIST SP 800-76, Biometric
 89   Specifications for Personal Identity Verification, which rely on cryptographic functions.

 90   Keywords
 91   cryptographic algorithm; FIPS 201; identity credential; Personal Identity Verification (PIV);
 92   smart cards.

 93   Reports on Computer Systems Technology
 94   The Information Technology Laboratory (ITL) at the National Institute of Standards and
 95   Technology (NIST) promotes the U.S. economy and public welfare by providing technical
 96   leadership for the Nation’s measurement and standards infrastructure. ITL develops tests, test
 97   methods, reference data, proof of concept implementations, and technical analyses to advance
 98   the development and productive use of information technology. ITL’s responsibilities include the
 99   development of management, administrative, technical, and physical standards and guidelines for
100   the cost-effective security and privacy of other than national security-related information in
101   federal information systems. The Special Publication 800-series reports on ITL’s research,
102   guidelines, and outreach efforts in information system security, and its collaborative activities
103   with industry, government, and academic organizations.
104

105   Trademark Information
106   All registered trademarks or trademarks belong to their respective organizations.
107




                                                        i
      NIST SP 800-78-5 ipd (Initial Public Draft)                                   Cryptographic Algorithms
      September 2023                                                                   and Key Sizes for PIV

108   Call for Patent Claims
109   This public review includes a call for information on essential patent claims (claims whose use
110   would be required for compliance with the guidance or requirements in this Information
111   Technology Laboratory (ITL) draft publication). Such guidance and/or requirements may be
112   directly stated in this ITL Publication or by reference to another publication. This call also
113   includes disclosure, where known, of the existence of pending U.S. or foreign patent applications
114   relating to this ITL draft publication and of any relevant unexpired U.S. or foreign patents.
115   ITL may require from the patent holder, or a party authorized to make assurances on its behalf,
116   in written or electronic form, either:
117       a) assurance in the form of a general disclaimer to the effect that such party does not hold
118          and does not currently intend holding any essential patent claim(s); or
119       b) assurance that a license to such essential patent claim(s) will be made available to
120          applicants desiring to utilize the license for the purpose of complying with the guidance
121          or requirements in this ITL draft publication either:
122              i.    under reasonable terms and conditions that are demonstrably free of any unfair
123                    discrimination; or
124             ii.    without compensation and under reasonable terms and conditions that are
125                    demonstrably free of any unfair discrimination.
126   Such assurance shall indicate that the patent holder (or third party authorized to make assurances
127   on its behalf) will include in any documents transferring ownership of patents subject to the
128   assurance, provisions sufficient to ensure that the commitments in the assurance are binding on
129   the transferee, and that the transferee will similarly include appropriate provisions in the event of
130   future transfers with the goal of binding each successor-in-interest.
131   The assurance shall also indicate that it is intended to be binding on successors-in-interest
132   regardless of whether such provisions are included in the relevant transfer documents.
133   Such statements should be addressed to: piv_comments@nist.gov




                                                        ii
      NIST SP 800-78-5 ipd (Initial Public Draft)                                                                     Cryptographic Algorithms
      September 2023                                                                                                     and Key Sizes for PIV

134   Table of Contents
135          Introduction ......................................................................................................................... 1
136                 Purpose ......................................................................................................................... 1
137                 Scope ............................................................................................................................ 1
138                 Audience and Assumptions ........................................................................................... 1
139                 Document Overview ...................................................................................................... 1
140          Application of Cryptography in FIPS 201-3 ...................................................................... 3
141          On-Card Cryptographic Requirements ............................................................................. 5
142                 PIV Cryptographic Keys ................................................................................................ 5
143                 Authentication Information Stored on the PIV Card ...................................................... 7
144      3.2.1.       Specification of Digital Signatures on Authentication Information ............................... 7
145      3.2.2.       Specification of Public Keys In X.509 Certificates ...................................................... 8
146      3.2.3.       Specification of Message Digests in the NIST SP 800-73-4 Security Object.............. 9
147          Certificate Status Information .......................................................................................... 10
148          PIV Card Application Administration Keys ..................................................................... 11
149          Identifiers for PIV Card Interfaces ................................................................................... 12
150                 Key Reference Values................................................................................................. 12
151                 PIV Card Algorithm Identifiers ..................................................................................... 12
152                 Algorithm Identifiers for PIV Key Types....................................................................... 13
153          Cryptographic Algorithm Validation Testing Requirements ......................................... 14
154   References................................................................................................................................. 21
155   Appendix A.            List of Symbols, Abbreviations, and Acronyms ........................................... 22
156   Appendix B.            Change Log ...................................................................................................... 24


157   List of Tables
158   Table 1. Algorithm and key size requirements for PIV key types ................................................. 6
159   Table 2. Signature algorithm and key size requirements for PIV information ............................... 7
160   Table 3. FIPS 201-3 signature algorithm object identifiers ........................................................... 8
161   Table 4. Public key object identifiers for PIV key types ................................................................ 8
162   Table 5. ECC parameter object identifiers for approved curves ................................................... 9
163   Table 6. Hash algorithm object identifiers .................................................................................... 9
164   Table 7. Algorithm and key size requirements for PIV Card application administration keys ..... 11
165   Table 8. Key references for PIV Key Types ............................................................................... 12
166   Table 9. Identifiers for supported cryptographic algorithms ........................................................ 13
167   Table 10. PIV Card keys: Key references and algorithms .......................................................... 14
168   Table 11. Cryptographic Algorithm Validation Program (CAVP) validation requirements .......... 15


169




                                                                             iii
      NIST SP 800-78-5 ipd (Initial Public Draft)                             Cryptographic Algorithms
      September 2023                                                             and Key Sizes for PIV

170   Acknowledgments
171   Hildegard Ferraiolo and Andrew Regenscheid wish to thank their co-authors, David Cooper, W.
172   Timothy Polk, Donna F. Dodson, and William E. Burr, who developed the earlier revisions of SP
173   800-78, as well as Sharon Keller from NIST, who contributed to the development of the
174   Cryptographic Algorithm Validation Program validation requirements.




                                                    iv
      NIST SP 800-78-5 ipd (Initial Public Draft)                                Cryptographic Algorithms
      September 2023                                                                and Key Sizes for PIV



175       Introduction
176   Homeland Security Presidential Directive-12 (HSPD-12) mandated the creation of new standards
177   for interoperable identity credentials for physical and logical access to Federal Government
178   locations and systems. Federal Information Processing Standard 201 (FIPS 201), Personal
179   Identity Verification (PIV) of Federal Employees and Contractors, was developed to establish
180   standards for identity credentials [FIPS201]. This document, NIST Special Publication (SP) 800-
181   78-5, specifies the cryptographic algorithms and key sizes for PIV systems and is a companion
182   document to FIPS 201-3.

183           Purpose
184   FIPS 201-3 defines the requirements for PIV life cycle activities, including identity proofing,
185   registration, PIV Card issuance, and PIV Card usage. FIPS 201-3 also defines the structure of an
186   identity credential that includes cryptographic keys. This document contains the technical
187   specifications needed for the mandatory and optional cryptographic keys specified in FIPS 201-
188   3, as well as the supporting infrastructure specified in FIPS 201-3 and the related NIST SP 800-
189   73, Interfaces for Personal Identity Verification [SP800-73], and SP 800-76, Biometric
190   Specifications for Personal Identity Verification [SP800-76], which rely on cryptographic
191   functions.

192           Scope
193   The scope of this Recommendation encompasses the PIV Card, infrastructure components that
194   support issuance and management of the PIV Card, and applications that rely on the credentials
195   supported by the PIV Card to provide security services. This Recommendation identifies
196   acceptable symmetric and asymmetric encryption algorithms, digital signature algorithms, key
197   establishment schemes, and message digest algorithms and specifies mechanisms to identify the
198   algorithms associated with PIV keys or digital signatures.
199   Algorithms and key sizes have been selected for consistency with applicable federal standards
200   and to ensure adequate cryptographic strength for PIV applications.

201           Audience and Assumptions
202   This document is intended for federal agencies and implementers of PIV systems. Readers are
203   assumed to have a working knowledge of cryptography and public key infrastructure (PKI)
204   technology.

205           Document Overview
206   The document is organized as follows:
207       •   Section 1, Introduction, provides the purpose, scope, audience, and assumptions of the
208           document and outlines its structure.




                                                      1
      NIST SP 800-78-5 ipd (Initial Public Draft)                                 Cryptographic Algorithms
      September 2023                                                                 and Key Sizes for PIV

209       •   Section 2, Applicationof Cryptography in FIPS 201-3, identifies the cryptographic
210           mechanisms and objects that employ cryptography as specified in FIPS 201-3 and its
211           supporting documents.
212       •   Section 3, On-Card Cryptographic Requirements   , describes the cryptographic
213           requirements for cryptographic keys and authentication information stored on the PIV
214           Card.
215       •   Section 4, Certificate Status Information
                                                      , describes the cryptographic requirements for
216           status information generated by PKI certification authorities (CA) and Online Certificate
217           Status Protocol (OCSP) responders.
218       •   Section 5, PIV Card Application Administration Keys, describes the cryptographic
219           requirements for managing information stored on the PIV Card.
220       •   Section 6, Identifiers for PIV Card Interfaces , specifies key reference values and
221           algorithm identifiers for the application programming interface and card commands
222           defined in [SP800-73].
223       •   Section 7, Cryptographic Algorithm Validation Testing Requirements   , specifies the
224           cryptographic algorithm validation testing that must be performed on the PIV Card based
225           on the keys and algorithms that it supports.
226       •   The Referencessection contains the list of documents used as references in this
227           document.
228       •   Appendix A, Acronyms, contains the list of acronyms used in this document.
229       •   Appendix B, Change Log
                                   , describes the changes made to NIST SP 800-78 since its initial
230           release.
231




                                                      2
      NIST SP 800-78-5 ipd (Initial Public Draft)                                 Cryptographic Algorithms
      September 2023                                                                 and Key Sizes for PIV

232       Application of Cryptography in FIPS 201-3
233   FIPS 201-3 employs cryptographic mechanisms to authenticate cardholders, secure information
234   stored on the PIV Card, and secure the supporting infrastructure. FIPS 201-3 and its supporting
235   documents specify a suite of keys to be stored on the PIV Card for personal identity verification,
236   digital signature generation, and key management. The PIV cryptographic keys specified in FIPS
237   201-3 and NIST SP 800-73 are:
238       •   The asymmetric PIV Authentication key,
239       •   An asymmetric Card Authentication key,
240       •   A symmetric Card Authentication key (deprecated),
241       •   An asymmetric digital signature key for signing documents and messages,
242       •   An asymmetric key management key that supports key establishment or key transport and
243           up to 20 retired key management keys,
244       •   A symmetric PIV Card Application Administration Key, and
245       •   An asymmetric PIV Secure Messaging key that supports the establishment of session
246           keys for use with secure messaging and supporting cardholder authentication using the
247           SM-AUTH authentication mechanism.
248   The cryptographic algorithms, key sizes, and parameters that may be used for these keys are
249   specified in Section 3.1. PIV Cards must implement private key computations for one or more of
250   the algorithms identified in this section.
251   Cryptographically protected objects specified in FIPS 201-3, NIST SP 800-73, and NIST SP
252   800-76 include:
253       •   The X.509 certificates for each asymmetric key on the PIV Card, except for the PIV
254           Secure Messaging key;
255       •   A secure messaging card verifiable certificate (CVC) for the PIV Secure Messaging key;
256       •   An Intermediate CVC for the public key needed to verify the signature on the secure
257           messaging CVC;
258       •   A digitally signed Card Holder Unique Identifier (CHUID);
259       •   Digitally signed biometrics using the Common Biometric Exchange Formats Framework
260           (CBEFF) signature block; and
261       •   The NISTSP 800-73 Security Object
                                             , which is a digitally signed hash table.
262   The cryptographic algorithms, key sizes, and parameters that may be used to protect these
263   objects are specified in Section 3.2. Certification authorities (CA) and card management systems
264   that protect these objects must support one or more of the cryptographic algorithms, key sizes,
265   and parameters specified in Section 3.2.




                                                      3
      NIST SP 800-78-5 ipd (Initial Public Draft)                                 Cryptographic Algorithms
      September 2023                                                                 and Key Sizes for PIV

266   Applications may be designed to use any or all of the cryptographic keys and objects stored on
267   the PIV Card. Where maximum interoperability is required, applications should support all of the
268   identified algorithms, key sizes, and parameters specified in Sections 3.1 and 3.2.
269   FIPS 201-3 requires CAs and Online Certificate Status Protocol (OCSP) responders to generate
270   and distribute digitally signed certificate revocation lists (CRL) and OCSP status messages,
271   respectively. These certificate status mechanisms support validation of the PIV Card, the PIV
272   cardholder, the cardholder’s digital signature key, and the cardholder’s key management key.
273   The signed certificate status mechanisms specified in FIPS 201-3 are:
274       •   X.509 CRLs that specify the status of a group of X.509 certificates and
275       •   OCSP status response messages that specify the status of a particular X.509 certificate.
276   The cryptographic algorithms, key sizes, and parameters that may be used to sign these
277   mechanisms are specified in Section 4, which also describes rules for encoding the signatures to
278   ensure interoperability.
279   FIPS 201-3 permits optional card management operations. These operations may only be
280   performed after the PIV Card authenticates the card management system. Card management
281   systems are authenticated through the use of PIV Card Application Administration Keys. The
282   cryptographic algorithms and key sizes that may be used for these keys are specified in Section
283   5.




                                                       4
      NIST SP 800-78-5 ipd (Initial Public Draft)                                                                    Cryptographic Algorithms
      September 2023                                                                                                    and Key Sizes for PIV

284        On-Card Cryptographic Requirements
285   FIPS 201-3 identifies a suite of objects that are stored on the PIV Card for use in authentication
286   mechanisms or other security protocols. These objects may be divided into three classes:
287   cryptographic keys, signed authentication information stored on the PIV Card, and message
288   digests of information stored on the PIV Card. Cryptographic requirements for PIV keys are
289   detailed in Section 3.1. Cryptographic requirements for other stored objects are detailed in
290   Section 3.2.

291              PIV Cryptographic Keys
292   FIPS 201-3 and NIST SP 800-73 specify six different classes of cryptographic keys to be used as
293   credentials by the PIV cardholder:
294        •     The mandatory PIV Authentication key,
295        •     The mandatory asymmetric Card Authentication key,
296        •     An optional symmetric Card Authentication key (deprecated),
297        •     A conditionally mandatory digital signature key,
298        •     A conditionally mandatory key management key, 1 and
299        •     An optional asymmetric key to establish session keys for secure messaging and to
300              authenticate the cardholder using the SM-AUTH authentication mechanism.
301   All cryptographic algorithms employed shall provide at least 112 bits of security strength.
302   Cryptographic keys that will remain in use after 2030 should provide 128 bits of security
303   strength 2. Federal departments and agencies should consider potential cryptographic key length
304   migrations as part of their moderate-to-long term cryptographic transition and modernization
305   plans, including the need to plan and invest for a future migration to post-quantum algorithms.
306   Capital investments for PIV issuance and relying party systems should be selected with an
307   emphasis on ensuring a timely migration to post-quantum algorithms once standards,
308   technologies, and services are available. If a migration to longer cryptographic keys would
309   require significant resources or infrastructure upgrades, federal departments and agencies may
310   elect to defer these improvements until the post-quantum migration. Post-quantum algorithms
311   will be specified in a future revision of this document once foundational standards supporting
312   their use have been adopted.
313    Table 1 establishes specific requirements for cryptographic algorithms and key sizes for each
314   key type.




      1
        The digital signature and key management keys are mandatory if the cardholder has a government-issued email account at the time of credential
      issuance.
      2
        For detailed guidance on the strength of cryptographic algorithms, see [SP800-57(1)], Recommendation on Key Management – Part 1: General.



                                                                             5
      NIST SP 800-78-5 ipd (Initial Public Draft)                                                                  Cryptographic Algorithms
      September 2023                                                                                                  and Key Sizes for PIV

315                               Table 1. Algorithm and key size requirements for PIV key types

           PIV Key Type                    Algorithms and Key Sizes                                Algorithm and Key Sizes for
                                                 Through 2030                                           2031 and Beyond
      PIV Authentication            RSA (2048 or 3072 bits)                             RSA 3072 bits
      key                           ECDSA (Curve P-256 or P-384)                        ECDSA (Curve P-256 or P-384)

      Asymmetric Card               RSA (2048 or 3072 bits)                             RSA 3072 bits
      Authentication key            ECDSA (Curve P-256 or P-384)                        ECDSA (Curve P-256 or P-384)
      Symmetric Card                3TDEA 3 (deprecated),                               AES-128, AES-192, or AES-256
      Authentication key            AES-128, AES-192, or AES-256
      (deprecated)
      Digital signature key         RSA (2048 or 3072 bits)                             RSA 3072 bits
                                    ECDSA (Curve P-256 or P-384)                        ECDSA (Curve P-256 or P-384)
      Key management key            RSA key transport (2048 or 3072 bits)               RSA key transport 3072
                                    ECDH (Curve P-256 or P-384)                         ECDH (Curve P-256 or P-384)
      PIV Secure                    ECDH (Curve P-256 or P-384)                         ECDH (Curve P-256 or P-384)
      Messaging key
316
317   In addition to the key sizes, keys must be generated using secure parameters. Rivest-Shamir-
318   Adleman (RSA) keys must be generated using a public exponent of 65537. Elliptic curve keys
319   must correspond to one of the following recommended curves from [FIPS186]:
320        •    Curve P-256 or
321        •    Curve P-384.
322   Note that elliptic curve keys are a faster option than RSA-based keys for the Card Authentication
323   key for physical access since elliptic curve private key computation time is significantly shorter
324   than RSA-based private key computation time. There is no phaseout date specified for either
325   curve.
326   If the PIV Card Application supports the virtual contact interface [SP800-73] and the digital
327   signature key, the key management key, or any of the retired key management keys are elliptic
328   curve keys that correspond to Curve P-384, then the PIV Secure Messaging key shall use P-384.
329   Otherwise, it may use P-256 or P-384.
330   While this specification requires that the RSA public exponent associated with PIV keys be
331   65537, applications should be able to process RSA public keys that have any public exponent
332   that is an odd positive integer greater than or equal to 65537 and less than 2256.
333   This specification requires the key management key to be an RSA key transport key or an
334   Elliptic Curve Diffie-Hellman (ECDH) key. The specifications for RSA key transport are
335   [PKCS1] and [SP800-56B], and the specification for ECDH key is [SP800-56A].




      3
       3TDEA is Triple DES using Keying Option 1 from [SP800-67], which requires that all three keys be unique (i.e., Key1 ≠ Key2, Key2 ≠ Key3, and
      Key3 ≠ Key1).



                                                                            6
      NIST SP 800-78-5 ipd (Initial Public Draft)                                      Cryptographic Algorithms
      September 2023                                                                      and Key Sizes for PIV

336            Authentication Information Stored on the PIV Card

337   3.2.1. Specification of Digital Signatures on Authentication Information
338   FIPS 201-3 requires the use of digital signatures to protect the integrity and authenticity of
339   information stored on the PIV Card. FIPS 201-3 and NIST SP 800-73 require digital signatures
340   on the following objects stored on the PIV Card:
341       •    X.509 public key certificates,
342       •    The optional secure messaging card verifiable certificate (CVC),
343       •    The optional intermediate CVC,
344       •    The CHUID,
345       •    Biometric information (e.g., fingerprints), and
346       •    The NIST SP 800-73-4 Security Object.
347   Approved digital signature algorithms are specified in [FIPS186]. Table 2 provides specific
348   requirements for public key algorithms and key sizes, hash algorithms, and padding schemes for
349   generating digital signatures for digitally signed information stored on the PIV Card. Agencies
350   are cautioned that generating digital signatures with elliptic curve algorithms may initially limit
351   interoperability.
352                   Table 2. Signature algorithm and key size requirements for PIV information

                                        Public Key Algorithms      Hash Algorithms        Padding Scheme
                                           and Key Sizes
                                      RSA (2048, 3072 or 4096)   SHA-256 or SHA-384    PKCS #1 v1.5
               Through 2030                                      SHA-256 or SHA-384    PSS
                                      ECDSA (Curve P-256)        SHA-256               N/A
                                      ECDSA (Curve P-384)        SHA-384               N/A
                                      RSA (3072 or 4096)         SHA-256 or SHA-384    PKCS #1 v1.5
              2031 and Beyond                                    SHA-256 or SHA-384    PSS
                                      ECDSA (Curve P-256)        SHA-256               N/A
                                      ECDSA (Curve P-384)        SHA-384               N/A
353
354   Note that RSA signatures may use either the PKCS #1 v1.5 padding scheme or the Probabilistic
355   Signature Scheme (PSS) padding as defined in [PKCS1]. The PSS padding scheme object
356   identifier (OID) is independent of the hash algorithm. The hash algorithm is specified as a
357   parameter (for details, see [PKCS1]).
358   The secure messaging CVC shall be signed using ECDSA (Curve P-256) with SHA-256 if it
359   contains an ECDH (Curve P-256) subject public key and shall be signed using ECDSA (Curve
360   P-384) with SHA-384 otherwise. The Intermediate CVC shall be signed using RSA with SHA-
361   256 and PKCS #1 v1.5 padding.
362   FIPS 201-3, NIST SP 800-73, and NIST SP 800-76 specify formats for the CHUID, the Security
363   Object, the biometric information, and X.509 public key certificates, which rely on OIDs to
364   specify which signature algorithm was used to generate the digital signature. The object



                                                            7
      NIST SP 800-78-5 ipd (Initial Public Draft)                                                                Cryptographic Algorithms
      September 2023                                                                                                and Key Sizes for PIV

365   identifiers specified in Table 3 must be used in FIPS 201-3 implementations to identify the
366   signature algorithm. 4, 5
367                                  Table 3. FIPS 201-3 signature algorithm object identifiers

            Signature Algorithm                                       Object Identifier (OID)
           RSA with SHA-1 and              sha1WithRSAEncryption ::= {iso(1) member-body(2) us(840) rsadsi(113549)
           PKCS #1 v1.5 padding            pkcs(1) pkcs-1(1) 5}
           RSA with SHA-256 and            sha256WithRSAEncryption ::= {iso(1) member-body(2) us(840) rsadsi(113549)
           PKCS #1 v1.5 padding            pkcs(1) pkcs-1(1) 11}
           RSA with SHA-256 and            id-RSASSA-PSS ::= {iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1)
           PSS padding                     pkcs-1(1) 10}
           RSA with SHA-384 and            Sha384WithRSAEncryption ::= {iso(1) member-body(2) us(840) rsadsi(113549)
           PKCS #1 v1.5 padding            pkcs(1) pkcs-1(1) 12}
           RSA with SHA-384 and            id-RSASSA-PSS ::= {iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1)
           PSS padding                     pkcs-1(1) 10}
           ECDSA with SHA-256              ecdsa-with-SHA256 ::= {iso(1) member-body(2) us(840) ansi-X9-62(10045)
                                           signatures(4) ecdsa-with-SHA2 (3) 2}
           ECDSA with SHA-384              ecdsa-with-SHA384 ::= {iso(1) member-body(2) us(840) ansi-X9-62(10045)
                                           signatures(4) ecdsa-with-SHA2 (3) 3}


368   3.2.2. Specification of Public Keys In X.509 Certificates
369   FIPS 201-3 requires the generation and storage of an X.509 certificate to correspond with each
370   asymmetric private key contained on the PIV Card, except for the PIV Secure Messaging key.
371   X.509 certificates include object identifiers to specify the cryptographic algorithm associated
372   with a public key. Table 4 specifies the object identifiers that may be used in certificates to
373   indicate the algorithm for a subject public key.
374                                     Table 4. Public key object identifiers for PIV key types

                                            Asymmetric
                 PIV Key Type                                                             Object Identifier (OID)
                                             Algorithm

                                                              {iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-1(1)
          PIV Authentication key,               RSA
                                                              1}
          Card Authentication key,
                                                              {iso(1) member-body(2) us(840) ansi-X9-62(10045)
            digital signature key             ECDSA
                                                              id-publicKeyType(2) 1}
                                                              {iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-1(1)
                                                RSA
                                                              1}
            Key management key
                                                              {iso(1) member-body(2) us(840) ansi-X9-62(10045)
                                               ECDH
                                                              id-publicKeyType(2) 1}
375
376   A single object identifier is specified in Table 4 for all elliptic curve keys. An additional object
377   identifier must be supplied in a parameters field to indicate the elliptic curve associated with the
378   key 6. Table 5 identifies the named curves and associated OIDs



      4
        The OID for RSA with SHA-1 and PKCS #1 v1.5 padding is included in Table 3 since applications may encounter X.509 certificates that were
      signed before January 1, 2011, using this algorithm.
      5
        For the CHUID, Security Object, and biometric information, the signatureAlgorithm field of SignerInfo shall contain rsaEncryption
      (1.2.840.113549.1.1.1) when the signature algorithm is RSA with PKCS #1 v1.5 padding.
      6
        RSA exponents are encoded with the modulus in the certificate’s subject public key, so the OID is not affected.



                                                                          8
      NIST SP 800-78-5 ipd (Initial Public Draft)                                              Cryptographic Algorithms
      September 2023                                                                              and Key Sizes for PIV

379                          Table 5. ECC parameter object identifiers for approved curves

             Asymmetric
                                                               Object Identifier (OID)
              Algorithm

             Curve P-256      ansip256r1 ::= { iso(1) member-body(2) us(840) ansi-X9-62(10045) curves(3) prime(1) 7 }
             Curve P-384      ansip384r1 ::= { iso(1) identified-organization(3) certicom(132) curve(0) 34 }
380

381   3.2.3. Specification of Message Digests in the NIST SP 800-73-4 Security Object
382   NIST SP 800-73 mandates the inclusion of a Security Object consistent with the
383   Authenticity/Integrity Code defined by the International Civil Aviation Organization (ICAO) in
384   [MRTD]. This object contains message digests of other digital information stored on the PIV
385   Card and is digitally signed. This specification requires that the message digests of digital
386   information be computed using the same hash algorithm used to generate the digital signature on
387   the Security Object. The set of acceptable algorithms is specified in Table 2. The Security
388   Object format identifies the hash algorithm used when computing the message digests by
389   including an object identifier. The appropriate object identifiers are identified in Table 6.
390                                      Table 6. Hash algorithm object identifiers

           Hash Algorithm                                     Object Identifier (OID)
          SHA-256              id-sha256 ::= {joint-iso-itu-t(2) country(16) us(840) organization(1) gov(101) csor(3)
                               nistalgorithm(4) hashalgs(2) 1}
          SHA-384              id-sha384 ::= {joint-iso-itu-t(2) country(16) us(840) organization(1) gov(101) csor(3)
                               nistalgorithm(4) hashalgs(2) 2}
391




                                                              9
      NIST SP 800-78-5 ipd (Initial Public Draft)                                  Cryptographic Algorithms
      September 2023                                                                  and Key Sizes for PIV

392       Certificate Status Information
393   The FIPS 201-3 functional component PIV Card Issuance and Management Subsystem generates
394   and distributes status information for PIV asymmetric keys other than PIV Secure Messaging
395   keys. FIPS 201-2 mandates two formats for certificate status information:
396       1. X.509 CRLs and
397       2. OCSP status response messages.
398   The CRLs and OCSP status responses shall be digitally signed to support authentication and
399   integrity using a key size and hash algorithm that satisfy the requirements for signing PIV
400   information, as specified in Table 2, and that are at least as large as the key size and hash
401   algorithm used to sign the certificate.
402   CRLs and OCSP messages rely on object identifiers to specify which signature algorithm was
403   used to generate the digital signature. The object identifiers specified in Table 3 must be used in
404   CRLs and OCSP messages to identify the signature algorithm.
405




                                                      10
      NIST SP 800-78-5 ipd (Initial Public Draft)                                      Cryptographic Algorithms
      September 2023                                                                      and Key Sizes for PIV

406       PIV Card Application Administration Keys
407   PIV Cards may support card activation by the card management system to support card
408   personalization and post-issuance card updates. PIV Cards that support card personalization and
409   post-issuance updates perform a challenge response protocol using a symmetric cryptographic
410   key (i.e., the PIV Card Application Administration Key) to authenticate the card management
411   system. After successful authentication, the card management system can modify information
412   stored in the PIV Card. Table 7 establishes specific requirements for cryptographic algorithms
413   and key sizes for PIV Card Application Administration Keys.
414           Table 7. Algorithm and key size requirements for PIV Card application administration keys

                                 Card Expiration Date              Algorithm
                                                           3TDEA (deprecated)
                             Through December 31, 2030
                                                           AES-128, AES-192, or AES-256
                               After December 31, 2030     AES-128, AES-192, or AES-256


415
416




                                                         11
      NIST SP 800-78-5 ipd (Initial Public Draft)                                                   Cryptographic Algorithms
      September 2023                                                                                   and Key Sizes for PIV

417       Identifiers for PIV Card Interfaces
418   NIST SP 800-73 defines an application programming interface, the PIV Client Application
419   Programming Interface (Part 3), and a set of mandatory card commands, the PIV Card
420   Application Card Command Interface (Part 2). The command syntaxes for these interfaces
421   identify PIV keys using one-byte key references, and their associated algorithms (or suites of
422   algorithms) are specified using one-byte algorithm identifiers. The same identifiers are used in
423   both interfaces.
424   Section 6.1 specifies the key reference values for each of the PIV key types. Section 6.2 defines
425   algorithm identifiers for each cryptographic algorithm supported by this specification. Section
426   6.3 identifies valid combinations of key reference values and algorithm identifiers.

427           Key Reference Values
428   A PIV Card key reference is a one-byte identifier that specifies a cryptographic key according to
429   its PIV Key Type. Table 8 defines the key reference values used on the PIV interfaces for PIV
430   Key Types.
431                                     Table 8. Key references for PIV Key Types

                                        PIV Key Type                Key Reference Value
                                  PIV Secure Messaging key                       '04'
                                                                    '82', '83', '84', '85', '86',
                                                                   '87', '88', '89', '8A', '8B',
                                 Retired key management key
                                                                   '8C', '8D', '8E', '8F', '90',
                                                                     '91', '92', '93', '94', '95'

                                    PIV Authentication key                     '9A'

                                    PIV Card Application
                                                                               '9B'
                                     Administration Key

                                     Digital signature key                     '9C'


                                     Key management key                        '9D'


                                   Card Authentication key                     '9E'



432           PIV Card Algorithm Identifiers
433   A PIV Card algorithm identifier is a one-byte identifier that specifies a cryptographic algorithm
434   and key size or a suite of algorithms and key sizes. For symmetric cryptographic operations, the
435   algorithm identifier also specifies a mode of operation (i.e., ECB). Table 9 lists the algorithm
436   identifiers for the cryptographic algorithms that may be recognized on the PIV interfaces. All
437   other algorithm identifier values are reserved for future use.




                                                              12
      NIST SP 800-78-5 ipd (Initial Public Draft)                                                                   Cryptographic Algorithms
      September 2023                                                                                                   and Key Sizes for PIV

438                                     Table 9. Identifiers for supported cryptographic algorithms

                                 Algorithm Identifier                                 Algorithm – Mode
                                            '00'                  3 Key Triple DES – ECB (deprecated)
                                            '03'                  3 Key Triple DES – ECB (deprecated)
                                            '05'                  RSA 3072 bit modulus, 65537 ≤ exponent ≤ 2256 - 1
                                            '06'                  RSA 1024 bit modulus, 65537 ≤ exponent ≤ 2256 - 1
                                            '07'                  RSA 2048 bit modulus, 65537 ≤ exponent ≤ 2256 - 1
                                            '08'                  AES-128 – ECB
                                           '0A'                   AES-192 – ECB
                                           '0C'                   AES-256 – ECB
                                            '11'                  ECC: Curve P-256
                                            '14'                  ECC: Curve P-384
                                            '27'                  Cipher Suite 2
                                           '2E'                   Cipher Suite 7
439
440   Note that 3 Key Triple DES – ECB with identifier '00' and '03' is deprecated and will be removed
441   in the next revision of this document.
442   Algorithm identifiers '27' and '2E' represent suites of algorithms and key sizes for use with secure
443   messaging and key establishment. Cipher Suite 2 (CS2) is used to establish session keys and for
444   secure messaging when the PIV Secure Messaging key is an ECDH (Curve P-256) key, and
445   Cipher Suite 7 (CS7) is used to establish session keys and for secure messaging when the PIV
446   Secure Messaging key is an ECDH (Curve P-384) key. Details of secure messaging, the key
447   establishment protocol, and the algorithms and key sizes for these two cipher suites are specified
448   in NIST SP 800-73-4, Part 2.

449                Algorithm Identifiers for PIV Key Types
450   Table 10 summarizes the set of algorithms supported for each key reference value.
451   All cryptographic algorithms employed shall provide at least 112 bits of security strength.
452   Cryptographic keys that will remain in use after 2030 should provide 128 bits of security
453   strength 7. Federal departments and agencies should consider potential cryptographic key length
454   migrations as part of their moderate-to-long term cryptographic transition and modernization
455   plans, including the need to plan and invest for a future migration to post-quantum algorithms.
456   Capital investments for PIV issuance and relying party systems should be selected with an
457   emphasis on ensuring a timely migration to post-quantum algorithms once standards,
458   technologies, and services are available. If a migration to longer cryptographic keys would
459   require significant resources or infrastructure upgrades, federal departments and agencies may
460   elect to defer these improvements until the post-quantum migration. Post-quantum algorithms
461   will be specified in a future revision of this document once foundational standards supporting
462   their use have been adopted.




      7
          For detailed guidance on the strength of cryptographic algorithms, see [SP800-57(1)], Recommendation on Key Management – Part 1: General.



                                                                            13
       NIST SP 800-78-5 ipd (Initial Public Draft)                                                                    Cryptographic Algorithms
       September 2023                                                                                                    and Key Sizes for PIV

463                                    Table 10. PIV Card keys: Key references and algorithms

                                                           Key Reference               Algorithm Identifiers              Algorithm Identifiers
                    PIV Key Type
                                                               Value                      Through 2030                         After 2030
      PIV Secure Messaging key                                     '04'                        '27', '2E'                         '27', '2E'
                                                         '82', '83', '84', '85',
                                                         '86', '87', '88', '89',
      Retired key management key                        '8A', '8B', '8C', '8D',        '05', '06', '07', '11', '14'       '05', '06', '07', '11', '14'
                                                         '8E', '8F', '90', '91',
                                                          '92', '93', '94', '95'
      PIV Authentication key                                      '9A'                    '05','07', '11', '14'                 '05', '11', '14'
      PIV Card Application Administration                                                                                      '08', '0A', '0C'
                                                                  '9B'                '00', '03', '08', '0A', '0C'
      Key
      Digital signature key                                       '9C'                   '05', '07', '11', '14'                '05', '11', '14'
      Key management key                                          '9D'                    '05','07', '11', '14'                 '05', '11', '14'
      Asymmetric Card Authentication key                          '9E'                    '05','07', '11', '14'                 '05', '11', '14'
      Symmetric Card Authentication key                                                                                        '08', '0A', '0C'
                                                                  '9E'                '00', '03', '08', '0A', '0C'
      (deprecated)


464         Cryptographic Algorithm Validation Testing Requirements
465    As noted in Section 4.2.2 of [FIPS201], the PIV Card shall be validated under [FIPS140] with an
466    overall validation of Level 2 and with Level 3 physical security. The scope of the Cryptographic
467    Module Validation Program (CMVP) validation shall include all cryptographic operations
468    performed over both the contact and contactless interfaces. Table 11 8 describes the
469    Cryptographic Algorithm Validation Program (CAVP) tests that are required for each supported
470    key and algorithm at the time of publication 9. If any changes are made to the CAVP validation
471    requirements, the changes and the deadlines for conformance with these requirements will be
472    posted on NIST’s Personal Identity Verification Program (NPIVP) web page at
473    http://csrc.nist.gov/groups/SNS/piv/npivp/index.html.
474




       8
         Terms used in this section are from the corresponding algorithm validation list available at
       http://csrc.nist.gov/groups/STM/cavp/validation.html.
       9
         TDEA has been removed from Table 11 since [SP 800-131A Revision 2] has deprecated its use through 2023 and disallowed its use after 2023.
       Consequently, on January 1, 2024, CMVP will move validated TDEA implementations to the FIPS 140-mode non-approved historical validation
       list.



                                                                           14
      NIST SP 800-78-5 ipd (Initial Public Draft)                                            Cryptographic Algorithms
      September 2023                                                                            and Key Sizes for PIV

475             Table 11. Cryptographic Algorithm Validation Program (CAVP) validation requirements
        Supported         Supported       Required                Minimum CAVP Validation Requirements
        Private Keys      Algorithm       Functionality
        PIV               2048-bit        Key Generation and      Key Generation:
        Authentication    RSA             Signature Generation    186-2 (for revalidation scenarios only):
        key                               for 2048-bit RSA with     Key(gen)(MOD: 2048 PubKey Values: 65537)
                                          public key exponent       Prerequisites: DRBG; SHS
                                          65537
                                                                  186-4:
                                                                    186-4KEY(gen):
                                                                      FIPS186-4_Fixed_e (65537) or FIPS186-4_Random_e
                                                                      PGM(Prime Generation Methods)
                                                                      Prerequisites: DRBG; SHS

                                                                  Signature Generation:
                                                                     RSASP1 component:
                                                                        (Mod2048)
                          3072-bit        Key Generation and      Key Generation:
                          RSA             Signature Generation     186-2 (for revalidation scenarios only):
                                          for 3072-bit RSA with      Key(gen)(MOD: 3072 PubKey Values: 65537)
                                          public key exponent        Prerequisites: DRBG; SHS
                                          65537
                                                                  186-4:
                                                                    186-4KEY(gen):
                                                                      FIPS186-4_Fixed_e (65537) or FIPS186-4_Random_e
                                                                      PGM(Prime Generation Methods)
                                                                      Prerequisites: DRBG; SHS

                                                                  Signature Generation:
                                                                     RSASP1 component:
                                                                     (Mod3072)
                          ECDSA           Key Generation and      Key Generation:
                          (Curve          Signature Generation     186-2 (for revalidation scenarios only):
                          P-256)          for Curve P-256            PKG (Public Key Generation): CURVE(P-256)
                                                                     Prerequisites: DRBG

                                                                  186-4:
                                                                    PKG (Public Key Generation): CURVE(P-256
                                                                    (ExtraRandomBits and/or TestingCandidates))
                                                                    Prerequisites: DRBG

                                                                  Signature Generation:
                                                                   ECDSA Signature Generation component:
                                                                     CURVE(P-256 tested with input length 256 bits)
                                                                  Prerequisites: DRBG
                          ECDSA           Key Generation and      Key Generation:
                          (Curve          Signature Generation     186-2 (for revalidation scenarios only):
                          P-384)          for Curve P-384            PKG (Public Key Generation): CURVE(P-384)
                                                                     Prerequisites: DRBG

                                                                  186-4:
                                                                    PKG (Public Key Generation): CURVE(P-384
                                                                    (ExtraRandomBits and/or TestingCandidates))
                                                                    Prerequisites: DRBG




                                                             15
NIST SP 800-78-5 ipd (Initial Public Draft)                                           Cryptographic Algorithms
September 2023                                                                           and Key Sizes for PIV

  Supported         Supported       Required               Minimum CAVP Validation Requirements
  Private Keys      Algorithm       Functionality
                                                           Signature Generation:
                                                            ECDSA Signature Generation component:
                                                              CURVE(P-384 tested with input length 384 bits)
                                                            Prerequisites: DRBG
  Asymmetric        2048-bit        Signature Generation   Key Generation (if key can be generated on card):
  Card              RSA             for 2048-bit RSA        186-2 (for revalidation scenarios only):
  Authentication                                              Key(gen)(MOD: 2048 PubKey Values: 65537)
  key                                                         Prerequisites: DRBG; SHS

                                                           186-4:
                                                             186-4KEY(gen):
                                                               FIPS186-4_Fixed_e (65537) or FIPS186-4_Random_e
                                                               PGM(Prime Generation Methods)
                                                               Prerequisites: DRBG; SHS

                                                           Signature Generation:
                                                              RSASP1 component:
                                                              (Mod2048)
                    3072-bit        Signature Generation   Key Generation (if key can be generated on card):
                    RSA             for 3072-bit RSA        186-2 (for revalidation scenarios only):
                                                              Key(gen)(MOD: 3072 PubKey Values: 65537)
                                                              Prerequisite: DRBG; SHS

                                                           186-4:
                                                             186-4KEY(gen):
                                                               FIPS186-4_Fixed_e (65537) or FIPS186-4_Random_e
                                                               PGM(Prime Generation Methods)
                                                               Prerequisites: DRBG; SHS

                                                           Signature Generation:
                                                              RSASP1 component:
                                                              (Mod3072)
                    ECDSA           Signature Generation   Key Generation (if key can be generated on card):
                    (Curve          for Curve P-256         186-2 (for revalidation scenarios only):
                    P-256)                                    PKG (Public Key Generation): CURVE(P-256)
                                                            Prerequisites: DRBG

                                                           186-4:
                                                             PKG (Public Key Generation): CURVE(P-256
                                                             (ExtraRandomBits and/or TestingCandidates))
                                                             Prerequisites: DRBG

                                                           Signature Generation:
                                                            ECDSA Signature Generation component:
                                                              CURVE(P-256 tested with input length 256 bits)
                                                              Prerequisites: DRBG

                    ECDSA           Signature Generation   Key Generation (if key can be generated on card):
                    (Curve          for Curve P-384        186-2 (for revalidation scenarios only):
                    P-384)                                   PKG (Public Key Generation): CURVE(P-384)
                                                           Prerequisites: DRBG

                                                           186-4:




                                                      16
NIST SP 800-78-5 ipd (Initial Public Draft)                                            Cryptographic Algorithms
September 2023                                                                            and Key Sizes for PIV

  Supported         Supported       Required                Minimum CAVP Validation Requirements
  Private Keys      Algorithm       Functionality
                                                              PKG (Public Key Generation): CURVE(P-384
                                                              (ExtraRandomBits and/or TestingCandidates))
                                                              Prerequisites: DRBG

                                                            Signature Generation:
                                                             ECDSA Signature Generation component:
                                                               CURVE(P-384 tested with input length 384 bits)
                                                            Prerequisites: DRBG
  Symmetric         AES-128         Encryption and          ECB ( e/d; 128 )
  Card                              Decryption for
  Authentication                    AES-128
  key
                    AES-192         Encryption and          ECB ( e/d; 192 )
                                    Decryption for
                                    AES-192
                    AES-256         Encryption and          ECB ( e/d; 256 )
                                    Decryption for
                                    AES-256
  Digital           2048-bit        Key Generation and      Key Generation:
  signature key     RSA             Signature Generation    186-2 (for revalidation scenarios only):
                                    for 2048-bit RSA with     Key(gen)(MOD: 2048 PubKey Values: 65537)
                                    public key exponent       Prerequisites: DRBG; SHS
                                    65537
                                                            186-4:
                                                              186-4KEY(gen):
                                                                FIPS186-4_Fixed_e (65537) or FIPS186-4_Random_e
                                                                PGM(Prime Generation Methods)
                                                                Prerequisites: DRBG; SHS

                                                            Signature Generation:
                                                               RSASP1 component:
                                                               (Mod2048)
                    3072-bit        Key Generation and      Key Generation:
                    RSA             Signature Generation     186-2 (for revalidation scenarios only):
                                    for 3072-bit RSA with      Key(gen)(MOD: 3072 PubKey Values: 65537)
                                    public key exponent        Prerequisites: DRBG; SHS
                                    65537
                                                            186-4:
                                                              186-4KEY(gen):
                                                                FIPS186-4_Fixed_e (65537) or FIPS186-4_Random_e
                                                                PGM(Prime Generation Methods)
                                                                Prerequisites: DRBG; SHS

                                                            Signature Generation:
                                                               RSASP1 component:
                                                               (Mod3072)
                    ECDSA           Key Generation and      Key Generation:
                    (Curve          Signature Generation     186-2 (for revalidation scenarios only):
                    P-256)          for Curve P-256            PKG (Public Key Generation): CURVE(P-256)
                                                               Prerequisites: DRBG

                                                            186-4:
                                                              PKG (Public Key Generation): CURVE(P-256
                                                              (ExtraRandomBits and/or TestingCandidates))



                                                       17
NIST SP 800-78-5 ipd (Initial Public Draft)                                             Cryptographic Algorithms
September 2023                                                                             and Key Sizes for PIV

  Supported         Supported       Required                 Minimum CAVP Validation Requirements
  Private Keys      Algorithm       Functionality
                                                               Prerequisites: DRBG

                                                             Signature Generation:
                                                              ECDSA Signature Generation component:
                                                                CURVE(P-256 tested with input length 256 bits)
                                                             Prerequisites: DRBG
                    ECDSA           Key Generation and       Key Generation:
                    (Curve          Signature Generation      186-2 (for revalidation scenarios only):
                    P-384)          for Curve P-384             PKG (Public Key Generation): CURVE(P-384)
                                                                Prerequisites: DRBG

                                                             186-4:
                                                               PKG (Public Key Generation): CURVE(P-384
                                                               (ExtraRandomBits and/or TestingCandidates))
                                                               Prerequisites: DRBG

                                                             Signature Generation:
                                                              ECDSA Signature Generation component:
                                                                CURVE(P-384 tested with input length 384 bits)
                                                             Prerequisites: DRBG
  Key               2048-bit        2048-bit RSA Key         Key Generation (if key can be generated on card):
  management        RSA             Transport                 186-2 (for revalidation scenarios only):
  key                                                           Key(gen)(MOD: 2048 PubKey Values: 65537)
                                                                Prerequisites: DRBG; SHS

                                                             186-4:
                                                               186-4KEY(gen):
                                                                 FIPS186-4_Fixed_e (65537) or FIPS186-4_Random_e
                                                                 PGM(Prime Generation Methods)
                                                                 Prerequisites: DRBG; SHS

                                                             Key Transport:
                                                             SP 800-56B RSADP component
                    3072-bit        3072-bit RSA Key         Key Generation (if key can be generated on card):
                    RSA             Transport                 186-2 (for revalidation scenarios only):
                                                                Key(gen)(MOD: 3072 PubKey Values: 65537)
                                                                Prerequisites: DRBG; SHS

                                                             186-4:
                                                               186-4KEY(gen):
                                                                 FIPS186-4_Fixed_e (65537) or FIPS186-4_Random_e
                                                                 PGM(Prime Generation Methods)
                                                                 Prerequisites: DRBG; SHS

                                                             Key Transport:
                                                             SP 800-56B RSADP component
                    ECDH            Key Agreement for        Key Generation (if key can be generated on card):
                    (Curve          Curve P-256               186-2 (for revalidation scenarios only):
                    P-256)                                      PKG (Public Key Generation): CURVE(P-256)
                                                                Prerequisites: DRBG

                                                             186-4:
                                                               PKG (Public Key Generation): CURVE(P-256
                                                               (ExtraRandomBits and/or TestingCandidates))
                                                               Prerequisites: DRBG



                                                        18
NIST SP 800-78-5 ipd (Initial Public Draft)                                             Cryptographic Algorithms
September 2023                                                                             and Key Sizes for PIV

  Supported         Supported       Required                  Minimum CAVP Validation Requirements
  Private Keys      Algorithm       Functionality

                                                              Key Agreement:
                                                              SP 800-56A-3 Section 5.7.1.2 ECC CDH primitive
                                                              component: CURVE(P-256)
                    ECDH            Key Agreement for         Key Generation (if key can be generated on card):
                    (Curve          Curve P-384                186-2 (for revalidation scenarios only):
                    P-384)                                       PKG (Public Key Generation): CURVE(P-384)
                                                                 Prerequisites: DRBG

                                                              186-4:
                                                                PKG (Public Key Generation): CURVE(P-384
                                                                (ExtraRandomBits and/or TestingCandidates))
                                                                Prerequisites: DRBG

                                                              Key Agreement:
                                                              SP 800-56A-3 Section 5.7.1.2 ECC CDH primitive
                                                              component: CURVE(P-384)
  PIV Card          AES-128         Encryption and            ECB ( e/d; 128 )
  Application                       Decryption for
  Administration                    AES-128
  Key
                    AES-192         Encryption and            ECB ( e/d; 192 )
                                    Decryption for
                                    AES-192
                    AES-256         Encryption and            ECB ( e/d; 256 )
                                    Decryption for
                                    AES-256
  PIV Secure        Cipher Suite    Key Generation for        Key Generation (of card’s static ECDH key):
  Messaging key     2               Curve P-256               186-2 (for revalidation scenarios only):
                                                                PKG (Public Key Generation): CURVE(P-256)
                                                                Prerequisites: DRBG
                                                              186-4:
                                                                PKG (Public Key Generation): CURVE(P-256
                                                                (ExtraRandomBits and/or TestingCandidates))
                                                                Prerequisites: DRBG
                                    C(1e, 1s, ECC CDH)        ECC: SCHEME[ OnePassDH ( KC <KARole:
                                    with Curve P-256               Responder > < KCRole: Provider > < KCType:
                                                                   Unilateral > < KDF: Concat > ) ( EC: P-256
                                                                   (SHA256 CMAC_AES128) ) ]
                                                                    Prerequisites: DRBG; SHS
                                    CMAC with AES-128         AES CMAC (Generation/Verification) (KS: 128; Msg
                                                                   Len(s) Min: 32 Max: 12 745 ; Tag Length(s): 16
                                                                   )
                                    Encryption and            AES CBC ( e/d; 128 )
                                    Decryption for AES
                                    CBC 128
                    Cipher Suite    Key Generation for        Key Generation (of card’s static ECDH key):
                    7               Curve P-384               186-2 (for revalidation scenarios only):
                                                                PKG (Public Key Generation): CURVE(P-384)
                                                                Prerequisites: DRBG
                                                              186-4:



                                                         19
      NIST SP 800-78-5 ipd (Initial Public Draft)                                             Cryptographic Algorithms
      September 2023                                                                             and Key Sizes for PIV

        Supported         Supported       Required                  Minimum CAVP Validation Requirements
        Private Keys      Algorithm       Functionality
                                                                      PKG (Public Key Generation): CURVE(P-384
                                                                      (ExtraRandomBits and/or TestingCandidates))
                                                                      Prerequisites: DRBG
                                          C(1e, 1s, ECC CDH)
                                                                    ECC: SCHEME[ OnePassDH ( KC <KARole:
                                          with Curve P-384
                                                                         Responder > < KCRole: Provider > < KCType:
                                                                         Unilateral > < KDF: Concat > ) ( ED: P-384
                                                                         (SHA384 CMAC_AES256) ) ]
                                                                         Prerequisites: DRBG; SHS
                                          CMAC with AES-256
                                                                    AES CMAC (Generation/Verification) (KS: 256; Msg
                                                                         Len(s) Min: 32 Max: 12 745 ; Tag Length(s): 16
                                                                         )
                                          Encryption and
                                                                    AES CBC ( e/d; 256 )
                                          Decryption for AES
                                          CBC 256
476




                                                               20
      NIST SP 800-78-5 ipd (Initial Public Draft)                                 Cryptographic Algorithms
      September 2023                                                                 and Key Sizes for PIV

477   References
478   [FIPS140]          Federal Information Processing Standard 140-3, Security Requirements for
479                      Cryptographic Modules, March 22, 2019.
480                      https://doi.org/10.6028/NIST.FIPS.140-3
481   [FIPS186]          Federal Information Processing Standard 186-4, Digital Signature Standard
482                      (DSS), July 2013. https://doi.org/10.6028/NIST.FIPS.186-4
483   [FIPS197]          Federal Information Processing Standard 197, Advanced Encryption Standard
484                      (AES), November 2001. https://csrc.nist.gov/publications/
485   [FIPS201]          Federal Information Processing Standard 201-3, Personal Identity Verification
486                      (PIV) of Federal Employees and Contractors, January 2022.
487                      https://doi.org/10.6028/NIST.FIPS.201-3
488   [MRTD]             ICAO Doc 9303, Machine Readable Travel Documents, Part 3: Machine
489                      Readable Official Travel Documents, Volume 2: Specifications for
490                      Electronically Enabled MRtds with Biometric Identification Capability, 3rd
491                      edition, International Civil Aviation Organization: Montreal, Quebec, Canada,
492                      2008. https://www.icao.int/publications/pages/publication.aspx?docnum=9303
493   [PKCS1]            Moriarty K (ed.), Kaliski B, Jonsson J, Rusch A, PKCS #1: RSA Cryptography
494                      Specifications Version 2.2, RFC 8017, November 2016.
495                      https://doi.org/10.17487/RFC8017
496   [SP800-56A]        NIST Special Publication 800-56A Revision 3, Recommendation for Pair-Wise
497                      Key Establishment Schemes Using Discrete Logarithm Cryptography,
498                      April 2018. https://doi.org/10.6028/NIST.SP.800-56Ar3
499   [SP800-56B]        NIST Special Publication 800-56B Revision 2, Recommendation for Pair-Wise
500                      Key-Establishment Schemes Using Integer Factorization Cryptography, March
501                      2019. https://doi.org/10.6028/NIST.SP.800-56Br2
502   [SP800-57(1)] NIST Special Publication 800-57, Recommendation for Key Management – Part
503                 1: General (Revision 5), May 2020. https://csrc.nist.gov/publications/
504   [SP800-67]         NIST Special Publication 800-67 Revision 2, Recommendation for the Triple
505                      Data Encryption Algorithm (TDEA) Block Cipher, November 2017.
506                      https://doi.org/10.6028/NIST.SP.800-67r2
507   [SP800-73]         NIST Special Publication 800-73-4, Interfaces for Personal Identity
508                      Verification, May 2015. https://doi.org/10.6028/NIST.SP.800-73-4
509   [SP800-76]         NIST Special Publication 800-76-2, Biometric Specifications for Personal
510                      Identity Verification, July 2013. https://doi.org/10.6028/NIST.SP.800-76-2
511   [SP800-131A] NIST Special Publication 800-131A Revision 2, Transitioning the Use of
512                Cryptographic Algorithms and Key Lengths, March 2019. https://
513                doi.org/10.6028/NIST.SP.800-131Ar2
514




                                                       21
      NIST SP 800-78-5 ipd (Initial Public Draft)                           Cryptographic Algorithms
      September 2023                                                           and Key Sizes for PIV

515   Appendix A. List of Symbols, Abbreviations, and Acronyms
516   The following abbreviations and acronyms are used in this standard.
517   3TDEA
518   Three key TDEA (TDEA with Keying Option 1 [SP800-67])

519   AES
520   Advanced Encryption Standard [FIPS197]

521   CAVP
522   Cryptographic Algorithm Validation Program

523   CBC
524   Cipher Block Chaining

525   CBEFF
526   Common Biometric Exchange Formats Framework

527   CDH
528   Cofactor Diffie-Hellman

529   CHUID
530   Card Holder Unique Identifier

531   CMAC
532   Cipher-Based Message Authentication Code

533   CMVP
534   Cryptographic Module Validation Program

535   CRL
536   Certificate Revocation List

537   CVC
538   Card Verifiable Certificate

539   DES
540   Data Encryption Standard

541   DRBG
542   Deterministic Random Bit Generator

543   ECB
544   Electronic Codebook

545   ECC
546   Elliptic Curve Cryptography

547   ECDH
548   Elliptic Curve Diffie-Hellman

549   ECDSA
550   Elliptic Curve Digital Signature Algorithm

551   FIPS
552   Federal Information Processing Standards

553   FISMA
554   Federal Information Security Management Act


                                                       22
      NIST SP 800-78-5 ipd (Initial Public Draft)           Cryptographic Algorithms
      September 2023                                           and Key Sizes for PIV

555   ICAO
556   International Civil Aviation Organization

557   ITL
558   Information Technology Laboratory

559   NIST
560   National Institute of Standards and Technology

561   OCSP
562   Online Certificate Status Protocol

563   OID
564   Object Identifier

565   OMB
566   Office of Management and Budget

567   PIV
568   Personal Identity Verification

569   PKCS
570   Public-Key Cryptography Standards

571   PKI
572   Public Key Infrastructure

573   PSS
574   Probabilistic Signature Scheme

575   RSA
576   Rivest-Shamir-Adleman Cryptographic Algorithm

577   SHA
578   Secure Hash Algorithm

579   SHS
580   Secure Hash Standard

581   SP
582   Special Publication

583   TDEA
584   Triple Data Encryption Algorithm; Triple DEA




                                                       23
      NIST SP 800-78-5 ipd (Initial Public Draft)                                       Cryptographic Algorithms
      September 2023                                                                       and Key Sizes for PIV

585   Appendix B. Change Log
586   This appendix is informative and provides an overview of the changes made to NIST SP 800-78
587   since its initial release.
588   In August 2007, Revision 1 enhanced alignment with the National Security Agency’s Suite B
589   Cryptography by:
590           •    Reducing the set of elliptic curves approved for use with PIV cards from six curves to
591                two,
592           •    Adding SHA-384 with Curve P-384, and
593           •    Eliminating the largest size of RSA keys (3072 bits) on PIV cards.
594   In February 2010, Revision 2 updates included:
595       •       Realigning with the NSA Suite B Cryptographic specification by removing discontinued
596               Elliptic Curve MQV as a key agreement scheme,
597       •       Aligning with FIPS 186-3 by removing RSA 4096 as an algorithm and key size for
598               generating signatures for PIV data objects, and
599       •       Eliminating the redundant cipher block chaining (CBC) mode of encryption for
600               symmetric authentication purposes (challenge and response)
601   In December 2010, Revision 3 updates included:
602       •       Aligning the set of acceptable RSA public key exponents with FIPS 186-3 and
603       •       Extending the permitted use of SHA-1 after December 31, 2010, when signing revocation
604               information under limited circumstances.
605   In 2014, Revision 4 updates included:
606       •       Adding algorithm and key size requirements for secure messaging,
607       •       Adding Cryptographic Algorithm Validation Program (CAVP) validation testing
608               requirements, and
609       •       Clarifying that RSA public keys may only have a public exponent of 65537.
610   In 2023, Revision 5 updates incorporate the following changes:
611       •       Table 1 reflects additional higher strength keys with at least 128-bit security and
612               suggested sunsets of lower sized keys by 2030 in anticipation of the recommended
613               migration to 128-bit security strength in 2031.
614       •       Accommodation of the Secure Messaging Authentication key
615       •       Deprecation of the symmetric card authentication key
616       •       Deprecation of 3TDEA algorithm with identifiers ‘00’ and ‘03’
617       •       Removal of the retired RNG from CAVP PIV component testing where applicable




                                                          24
