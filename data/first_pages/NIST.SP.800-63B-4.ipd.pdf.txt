1          NIST Special Publication
2           NIST SP 800-63B-4 ipd


3    Digital Identity Guidelines
4    Authentication and Lifecycle Management



5                               Initial Public Draft



6                                     David Temoshok
7                                      James L. Fenton
8                                     Yee-Yin Choong
9                                     Naomi Lefkovitz
10                                 Andrew Regenscheid
11                                      Justin P. Richer



12          This publication is available free of charge from:
13           https://doi.org/10.6028/NIST.SP.800-63b-4.ipd




14
15                                          NIST Special Publication
16                                           NIST SP 800-63B-4 ipd
17                            Digital Identity Guidelines
18                               Authentication and Lifecycle Management
19                                                                   Initial Public Draft

20                                                                           David Temoshok
21                                                                           Naomi Lefkovitz
22                                                              Applied Cybersecurity Division
23                                                          Information Technology Laboratory
24                                                                            Yee-Yin Choong
25                                                                 Information Access Division
26                                                          Information Technology Laboratory
27                                                                        Andrew Regenscheid
28                                                                 Computer Security Division
29                                                          Information Technology Laboratory
30                                                                                James L. Fenton
31                                                                              Altmode Networks
32                                                                                Justin P. Richer
33                                                                           Bespoke Engineering

34                                           This publication is available free of charge from:
35                                            https://doi.org/10.6028/NIST.SP.800-63b-4.ipd
36                                                                                 December 2022




37


38                                                                     U.S. Department of Commerce
39                                                                      Gina M. Raimondo, Secretary

40                                                      National Institute of Standards and Technology
41   Laurie E. Locascio, NIST Director and Under Secretary of Commerce for Standards and Technology
42   Certain commercial entities, equipment, or materials may be identified in this document
43   in order to describe an experimental procedure or concept adequately. Such identification
44   is not intended to imply recommendation or endorsement by the National Institute of
45   Standards and Technology, nor is it intended to imply that the entities, materials, or
46   equipment are necessarily the best available for the purpose.
47   There may be references in this publication to other publications currently under
48   development by NIST in accordance with its assigned statutory responsibilities. The
49   information in this publication, including concepts and methodologies, may be used by
50   federal agencies even before the completion of such companion publications. Thus, until
51   each publication is completed, current requirements, guidelines, and procedures, where
52   they exist, remain operative. For planning and transition purposes, federal agencies may
53   wish to closely follow the development of these new publications by NIST.
54   Organizations are encouraged to review all draft publications during public comment
55   periods and provide feedback to NIST. Many NIST cybersecurity publications, other than
56   the ones noted above, are available at https://csrc.nist.gov/publications.

57   Authority

58   This publication has been developed by NIST in accordance with its statutory
59   responsibilities under the Federal Information Security Modernization Act (FISMA)
60   of 2014, 44 U.S.C. § 3551 et seq., Public Law (P.L.) 113-283. NIST is responsible
61   for developing information security standards and guidelines, including minimum
62   requirements for federal information systems, but such standards and guidelines shall
63   not apply to national security systems without the express approval of appropriate federal
64   officials exercising policy authority over such systems. This guideline is consistent with
65   the requirements of the Office of Management and Budget (OMB) Circular A-130.
66   Nothing in this publication should be taken to contradict the standards and guidelines
67   made mandatory and binding on federal agencies by the Secretary of Commerce under
68   statutory authority. Nor should these guidelines be interpreted as altering or superseding
69   the existing authorities of the Secretary of Commerce, Director of the OMB, or any other
70   federal official. This publication may be used by nongovernmental organizations on a
71   voluntary basis and is not subject to copyright in the United States. Attribution would,
72   however, be appreciated by NIST.

73   NIST Technical Series Policies

74   Copyright, Fair Use, and Licensing Statements
75   NIST Technical Series Publication Identifier Syntax
76   Publication History

77   Approved by the NIST Editorial Review Board on YYYY-MM-DD [will be added upon
78   final publication]

79   How to Cite this NIST Technical Series Publication

80   Temoshok D, Fenton JL, Choong YY, Lefkovitz N, Regenscheid A, Richer JP (2022)
81   Digital Identity Guidelines: Authentication and Lifecycle Management. (National
82   Institute of Standards and Technology, Gaithersburg, MD), NIST Special Publication
83   (SP) NIST SP 800-63B-4 ipd. https://doi.org/10.6028/NIST.SP.800-63b-4.ipd

84   Author ORCID iDs

85   David Temoshok: 0000-0001-6195-0331
86   James L. Fenton: 0000-0002-2344-4291
87   Yee-Yin Choong: 0000-0002-3889-6047
88   Naomi Lefkovitz: 0000-0003-3777-3106
89   Andrew Regenscheid: 0000-0002-3930-527X
90   Justin P. Richer: 0000-0003-2130-5180

91   Public Comment Period

92   December 16, 2022 - March 24 April 14, 2023

93   Submit Comments

94   mailto:dig-comments@nist.gov
95   All comments are subject to release under the Freedom of Information Act
96   (FOIA).
      NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
      December 2022                                       Authentication and Lifecycle Management


97    Reports on Computer Systems Technology

98    The Information Technology Laboratory (ITL) at the National Institute of Standards and
99    Technology (NIST) promotes the U.S. economy and public welfare by providing technical
100   leadership for the Nation’s measurement and standards infrastructure. ITL develops
101   tests, test methods, reference data, proof of concept implementations, and technical
102   analyses to advance the development and productive use of information technology. ITL’s
103   responsibilities include the development of management, administrative, technical, and
104   physical standards and guidelines for the cost-effective security and privacy of other
105   than national security-related information in federal information systems. The Special
106   Publication 800-series reports on ITL’s research, guidelines, and outreach efforts in
107   information system security, and its collaborative activities with industry, government,
108   and academic organizations.

109   Abstract

110   These guidelines provide technical requirements for federal agencies implementing
111   digital identity services and are not intended to constrain the development or use of
112   standards outside of this purpose. These guidelines focus on the authentication of
113   subjects interacting with government information systems over networks, establishing
114   that a given claimant is a subscriber who has been previously authenticated. The
115   result of the authentication process may be used locally by the system performing
116   the authentication or may be asserted elsewhere in a federated identity system. This
117   document defines technical requirements for each of the three authenticator assurance
118   levels. This publication will supersede NIST Special Publication (SP) 800-63B.

119   Keywords

120   authentication; authentication assurance; credential service provider; digital
121   authentication; digital credentials; electronic authentication; electronic credentials;
122   passwords.

123   Note to Reviewers

124   The rapid proliferation of online services over the past few years has heightened the need
125   for reliable, equitable, secure, and privacy-protective digital identity solutions.
126   Revision 4 of NIST Special Publication 800-63 Digital Identity Guidelines intends to
127   respond to the changing digital landscape that has emerged since the last major revision
128   of this suite was published in 2017 — including the real-world implications of online
129   risks. The guidelines present the process and technical requirements for meeting digital
130   identity management assurance levels for identity proofing, authentication, and federation,


                                                    i
      NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
      December 2022                                       Authentication and Lifecycle Management


131   including requirements for security and privacy as well as considerations for fostering
132   equity and the usability of digital identity solutions and technology.
133   Taking into account feedback provided in response to our June 2020 Pre-Draft Call
134   for Comments, as well as research conducted into real-world implementations of the
135   guidelines, market innovation, and the current threat environment, this draft seeks to:
136      1. Advance Equity: This draft seeks to expand upon the risk management content
137         of previous revisions and specifically mandates that agencies account for impacts
138         to individuals and communities in addition to impacts to the organization. It also
139         elevates risks to mission delivery – including challenges to providing services to
140         all people who are eligible for and entitled to them – within the risk management
141         process and when implementing digital identity systems. Additionally, the guidance
142         now mandates continuous evaluation of potential impacts across demographics,
143         provides biometric performance requirements, and additional parameters for the
144         responsible use of biometric-based technologies, such as those that utilize face
145         recognition.
146      2. Emphasize Optionality and Choice for Consumers: In the interest of promoting
147         and investigating additional scalable, equitable, and convenient identify verification
148         options, including those that do and do not leverage face recognition technologies,
149         this draft expands the list of acceptable identity proofing alternatives to provide
150         new mechanisms to securely deliver services to individuals with differing means,
151         motivations, and backgrounds. The revision also emphasizes the need for digital
152         identity services to support multiple authenticator options to address diverse
153         consumer needs and secure account recovery.
154      3. Deter Fraud and Advanced Threats: This draft enhances fraud prevention
155         measures from the third revision by updating risk and threat models to account
156         for new attacks, providing new options for phishing resistant authentication, and
157         introducing requirements to prevent automated attacks against enrollment processes.
158         It also opens the door to new technology such as mobile driver’s licenses and
159         verifiable credentials.
160      4. Address Implementation Lessons Learned: This draft addresses areas where
161         implementation experience has indicated that additional clarity or detail was
162         required to effectively operationalize the guidelines. This includes re-working
163         the federation assurance levels, providing greater detail on trusted referees,
164         clarifying guidelines on identity attribute validation sources, and improving address
165         confirmation requirements.
166   NIST is specifically interested in comments on and recommendations for the following
167   topics:
168   Authentication and Lifecycle Management


                                                   ii
      NIST SP 800-63B-4 ipd                                             Digital Identity Guidelines
      December 2022                                      Authentication and Lifecycle Management


169      • Are emerging authentication models and techniques – such as FIDO passkey,
170        verifiable credentials, and mobile driver’s licenses – sufficiently addressed and
171        accommodated, as appropriate, by the guidelines? What are the potential associated
172        security, privacy, and usability benefits and risks?
173      • Are the controls for phishing resistance as defined in the guidelines for AAL2 and
174        AAL3 authentication clear and sufficient?
175      • How are session management thresholds and reauthentication requirements
176        implemented by agencies and organizations? Should NIST provide thresholds or
177        leave session lengths to agencies based on applications, users, and mission needs?
178      • What impacts would the proposed biometric performance requirements for this
179        volume have on real-world implementations of biometric technologies?
180   General
181      • Is there an element of this guidance that you think is missing or could be expanded?
182      • Is any language in the guidance confusing or hard to understand? Should we add
183        definitions or additional context to any language?
184      • Does the guidance sufficiently address privacy?
185      • Does the guidance sufficiently address equity?
186             – What equity assessment methods, impact evaluation models, or metrics
187               could we reference to better support organizations in preventing or detecting
188               disparate impacts that could arise as a result of identity verification
189               technologies or processes?
190      • What specific implementation guidance, reference architectures, metrics, or other
191        supporting resources may enable more rapid adoption and implementation of this
192        and future iterations of the Digital Identity Guidelines?
193      • What applied research and measurement efforts would provide the greatest impact
194        on the identity market and advancement of these guidelines?
195   Reviewers are encouraged to comment and suggest changes to the text of all four draft
196   volumes of of the NIST SP 800-63-4 suite. NIST requests that all comments be submitted
197   by 11:59pm Eastern Time on March 24, 2023. Please submit your comments to dig-
198   comments@nist.gov. NIST will review all comments and make them available at the
199   NIST Identity and Access Management website. Commenters are encouraged to use the
200   comment template provided on the NIST Computer Security Resource Center website.




                                                  iii
      NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
      December 2022                                       Authentication and Lifecycle Management


201   Call for Patent Claims

202   This public review includes a call for information on essential patent claims (claims
203   whose use would be required for compliance with the guidance or requirements in this
204   Information Technology Laboratory (ITL) draft publication). Such guidance and/or
205   requirements may be directly stated in this ITL Publication or by reference to another
206   publication. This call also includes disclosure, where known, of the existence of pending
207   U.S. or foreign patent applications relating to this ITL draft publication and of any
208   relevant unexpired U.S. or foreign patents.
209   ITL may require from the patent holder, or a party authorized to make assurances on its
210   behalf, in written or electronic form, either:
211      a) assurance in the form of a general disclaimer to the effect that such party does not
212         hold and does not currently intend holding any essential patent claim(s); or
213     b) assurance that a license to such essential patent claim(s) will be made available
214        to applicants desiring to utilize the license for the purpose of complying with the
215        guidance or requirements in this ITL draft publication either:
216            i. under reasonable terms and conditions that are demonstrably free of any unfair
217               discrimination; or
218           ii. without compensation and under reasonable terms and conditions that are
219               demonstrably free of any unfair discrimination.
220   Such assurance shall indicate that the patent holder (or third party authorized to make
221   assurances on its behalf) will include in any documents transferring ownership of patents
222   subject to the assurance, provisions sufficient to ensure that the commitments in the
223   assurance are binding on the transferee, and that the transferee will similarly include
224   appropriate provisions in the event of future transfers with the goal of binding each
225   successor-in-interest.
226   The assurance shall also indicate that it is intended to be binding on successors-in-interest
227   regardless of whether such provisions are included in the relevant transfer documents.
228   Such statements should be addressed to: mailto:dig-comments@nist.gov.




                                                   iv
      NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
      December 2022                                       Authentication and Lifecycle Management


229   Table of Contents
230   1. Purpose . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .    2
231   2. Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .     3
232   3. Deﬁnitions and Abbreviations . . . . . . . . . . . . . . . . . . . . . . . . . .         5
233   4. Authentication Assurance Levels . . . . . . . . . . . . . . . . . . . . . . . .          6
234      4.1. Authentication Assurance Level 1 . . . . . . . . . . . . . . . . . . . . . .        6
235            4.1.1. Permitted Authenticator Types . . . . . . . . . . . . . . . . . . . .       6
236            4.1.2. Authenticator and Veriﬁer Requirements . . . . . . . . . . . . . .          7
237            4.1.3. Reauthentication . . . . . . . . . . . . . . . . . . . . . . . . . . .      7
238            4.1.4. Security Controls . . . . . . . . . . . . . . . . . . . . . . . . . . .     7
239            4.1.5. Records Retention Policy . . . . . . . . . . . . . . . . . . . . . . .      7
240      4.2. Authentication Assurance Level 2 . . . . . . . . . . . . . . . . . . . . . .        8
241            4.2.1. Permitted Authenticator Types . . . . . . . . . . . . . . . . . . . .       8
242            4.2.2. Authenticator and Veriﬁer Requirements . . . . . . . . . . . . . .          9
243            4.2.3. Reauthentication . . . . . . . . . . . . . . . . . . . . . . . . . . .      9
244            4.2.4. Security Controls . . . . . . . . . . . . . . . . . . . . . . . . . . .     9
245            4.2.5. Records Retention Policy . . . . . . . . . . . . . . . . . . . . . . . 10
246      4.3. Authentication Assurance Level 3 . . . . . . . . . . . . . . . . . . . . . . 10
247            4.3.1. Permitted Authenticator Types . . . . . . . . . . . . . . . . . . . . 10
248            4.3.2. Authenticator and Veriﬁer Requirements . . . . . . . . . . . . . . 10
249            4.3.3. Reauthentication . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
250            4.3.4. Security Controls . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
251            4.3.5. Records Retention Policy . . . . . . . . . . . . . . . . . . . . . . . 11
252      4.4. Privacy Requirements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
253      4.5. Summary of Requirements . . . . . . . . . . . . . . . . . . . . . . . . . . 12
254   5. Authenticator and Veriﬁer Requirements . . . . . . . . . . . . . . . . . . . 14
255      5.1. Requirements by Authenticator Type . . . . . . . . . . . . . . . . . . . . . 14
256            5.1.1. Memorized Secrets . . . . . . . . . . . . . . . . . . . . . . . . . . 14
257            5.1.2. Look-Up Secrets . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
258            5.1.3. Out-of-Band Devices . . . . . . . . . . . . . . . . . . . . . . . . . 18

                                                   v
      NIST SP 800-63B-4 ipd                                             Digital Identity Guidelines
      December 2022                                      Authentication and Lifecycle Management


259           5.1.4. Single-Factor OTP Device . . . . . . . . . . . . . . . . . . . . . . 23
260           5.1.5. Multi-Factor OTP Devices . . . . . . . . . . . . . . . . . . . . . . 25
261           5.1.6. Single-Factor Cryptographic Software . . . . . . . . . . . . . . . . 27
262           5.1.7. Single-Factor Cryptographic Devices . . . . . . . . . . . . . . . . . 27
263           5.1.8. Multi-Factor Cryptographic Software . . . . . . . . . . . . . . . . 29
264           5.1.9. Multi-Factor Cryptographic Devices . . . . . . . . . . . . . . . . . 30
265      5.2. General Authenticator Requirements . . . . . . . . . . . . . . . . . . . . . 31
266           5.2.1. Physical Authenticators . . . . . . . . . . . . . . . . . . . . . . . . 31
267           5.2.2. Rate Limiting (Throttling) . . . . . . . . . . . . . . . . . . . . . . 31
268           5.2.3. Use of Biometrics . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
269           5.2.4. Attestation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
270           5.2.5. Phishing (Veriﬁer Impersonation) Resistance . . . . . . . . . . . . 34
271           5.2.6. Veriﬁer-CSP Communications . . . . . . . . . . . . . . . . . . . . 36
272           5.2.7. Veriﬁer Compromise Resistance . . . . . . . . . . . . . . . . . . . 36
273           5.2.8. Replay Resistance . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
274           5.2.9. Authentication Intent . . . . . . . . . . . . . . . . . . . . . . . . . 37
275           5.2.10. Restricted Authenticators . . . . . . . . . . . . . . . . . . . . . . . 37
276           5.2.11. Activation Secrets . . . . . . . . . . . . . . . . . . . . . . . . . . 38
277           5.2.12. Connected Authenticators . . . . . . . . . . . . . . . . . . . . . . 39
278   6. Authenticator Lifecycle Management . . . . . . . . . . . . . . . . . . . . . 41
279      6.1. Authenticator Binding . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
280           6.1.1. Binding at Enrollment . . . . . . . . . . . . . . . . . . . . . . . . 42
281           6.1.2. Post-Enrollment Binding . . . . . . . . . . . . . . . . . . . . . . . 43
282           6.1.3. Binding to a Subscriber-provided Authenticator . . . . . . . . . . . 46
283           6.1.4. Renewal . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46
284      6.2. Loss, Theft, Damage, and Unauthorized Duplication . . . . . . . . . . . . 46
285      6.3. Expiration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
286      6.4. Invalidation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
287   7. Session Management . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
288      7.1. Session Bindings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48


                                                  vi
      NIST SP 800-63B-4 ipd                                             Digital Identity Guidelines
      December 2022                                      Authentication and Lifecycle Management


289            7.1.1. Browser Cookies . . . . . . . . . . . . . . . . . . . . . . . . . . . 49
290            7.1.2. Access Tokens . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50
291            7.1.3. Device Identiﬁcation . . . . . . . . . . . . . . . . . . . . . . . . . 50
292      7.2. Reauthentication . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50
293            7.2.1. Reauthentication from a Federation or Assertion . . . . . . . . . . 51
294   8. Threats and Security Considerations . . . . . . . . . . . . . . . . . . . . . 52
295      8.1. Authenticator Threats . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
296      8.2. Threat Mitigation Strategies . . . . . . . . . . . . . . . . . . . . . . . . . 55
297      8.3. Authenticator Recovery . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
298      8.4. Session Attacks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
299   9. Privacy Considerations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59
300      9.1. Privacy Risk Assessment . . . . . . . . . . . . . . . . . . . . . . . . . . . 59
301      9.2. Privacy Controls . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59
302      9.3. Use Limitation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59
303      9.4. Agency-Speciﬁc Privacy Compliance . . . . . . . . . . . . . . . . . . . . . 60
304   10.Usability Considerations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61
305      10.1. Usability Considerations Common to Authenticators . . . . . . . . . . . . 62
306      10.2. Usability Considerations by Authenticator Type . . . . . . . . . . . . . . . 64
307            10.2.1. Memorized Secrets . . . . . . . . . . . . . . . . . . . . . . . . . . 64
308            10.2.2. Look-Up Secrets . . . . . . . . . . . . . . . . . . . . . . . . . . . 65
309            10.2.3. Out-of-Band . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66
310            10.2.4. Single-Factor OTP Device . . . . . . . . . . . . . . . . . . . . . . 66
311            10.2.5. Multi-Factor OTP Device . . . . . . . . . . . . . . . . . . . . . . 67
312            10.2.6. Single-Factor Cryptographic Software . . . . . . . . . . . . . . . . 68
313            10.2.7. Single-Factor Cryptographic Device . . . . . . . . . . . . . . . . . 68
314            10.2.8. Multi-Factor Cryptographic Software . . . . . . . . . . . . . . . . 68
315            10.2.9. Multi-Factor Cryptographic Device . . . . . . . . . . . . . . . . . . 69
316      10.3. Summary of Usability Considerations . . . . . . . . . . . . . . . . . . . . . 69
317      10.4. Biometrics Usability Considerations . . . . . . . . . . . . . . . . . . . . . 72
318   11.Equity Considerations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74


                                                  vii
      NIST SP 800-63B-4 ipd                                               Digital Identity Guidelines
      December 2022                                        Authentication and Lifecycle Management


319   References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76
320        General References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76
321        Standards . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78
322        NIST Special Publications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78
323        Federal Information Processing Standards . . . . . . . . . . . . . . . . . . . . . 79
324   Appendix A. Strength of Memorized Secrets . . . . . . . . . . . . . . . . . . 80
325        A.1. Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80
326        A.2. Length . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80
327        A.3. Complexity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81
328        A.4. Central vs. Local Veriﬁcation . . . . . . . . . . . . . . . . . . . . . . . . . 82
329        A.5. Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83
330   Appendix B. Change Log . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84


331   List of Tables
332   1.        AAL Summary of Requirements . . . . . . . . . . . . . . . . . . . . . . .         13
333   2.        AAL Reauthentication Requirements . . . . . . . . . . . . . . . . . . . . .       50
334   3.        Authenticator Threats . . . . . . . . . . . . . . . . . . . . . . . . . . . .     52
335   4.        Mitigating Authenticator Threats . . . . . . . . . . . . . . . . . . . . . .      55


336   List of Figures
337   1.        Transfer of Secret to Primary Device . . . . . . . . . . . . . . . . . . . . . 19
338   2.        Transfer of Secret to Out-of-band Device . . . . . . . . . . . . . . . . . . 20
339   3.        Usability Considerations Summary by Authenticator Type . . . . . . . . . 71




                                                   viii
      NIST SP 800-63B-4 ipd                                           Digital Identity Guidelines
      December 2022                                    Authentication and Lifecycle Management


340   Acknowledgments

341   The authors would like to thank their fellow collaborators on the current revision of
342   this special publication, Christine Abruzzi, Ryan Galluzzo, Sarbari Gupta, Connie
343   LaSalle, and Diana Proud-Madruga, as well as Kerrianne Buchanan and Greg Fiumara
344   for their contributions and review. The authors would like to also acknowledge the past
345   contributions of Donna F. Dodson, W. Timothy Polk, Emad A. Nabbus, Paul A. Grassi,
346   Elaine M. Newton, Ray Perlner, William E. Burr, Kristen K. Greene, Mary F. Theofanos,
347   Kaitlin Boeckl, Kat Megas, Ellen Nadeau, Ben Piccarreta, and Danna Gabel O’Rourke.




                                                1
      NIST SP 800-63B-4 ipd                                           Digital Identity Guidelines
      December 2022                                    Authentication and Lifecycle Management


348   1.   Purpose
349   This section is informative.
350   This publication and its companion volumes, [SP800-63], [SP800-63A], and
351   [SP800-63C], provide technical guidelines to organizations for the implementation of
352   digital identity services.
353   This document, SP 800-63B, provides requirements to credential service providers (CSPs)
354   for remote user authentication at each of three authentication assurance levels (AALs).




                                                 2
      NIST SP 800-63B-4 ipd                                               Digital Identity Guidelines
      December 2022                                        Authentication and Lifecycle Management


355   2.   Introduction
356   This section is informative.
357   Digital authentication is the process of determining the validity of one or more
358   authenticators used to claim a digital identity. Authentication establishes that a subject
359   attempting to access a digital service is in control of the technologies used to authenticate.
360   For services in which return visits are applicable, successfully authenticating provides
361   reasonable risk-based assurances that the subject accessing the service today is the same
362   as the one who accessed the service previously.
363   The ongoing authentication of subscribers is central to the process of associating a
364   subscriber with their online activity (i.e., with their subscriber account). Subscriber
365   authentication is performed by verifying that the claimant controls one or more
366   authenticators (called tokens in some earlier versions of SP 800-63) associated with
367   a given subscriber account. A successful authentication results in the assertion of a
368   pseudonymous or non-pseudonymous identifier and optionally other identity information
369   to the relying party (RP).
370   This document provides recommendations on types of authentication processes, including
371   choices of authenticators, that may be used at various authentication assurance levels
372   (AALs). It also provides recommendations on the lifecycle of authenticators, including
373   revocation in the event of loss or theft.
374   This technical guideline applies to digital authentication of subjects to systems over a
375   network. It does not address the authentication of a person for physical access (e.g., to a
376   building), though some credentials used for digital access may also be used for physical
377   access authentication. This technical guideline also requires that federal systems and
378   service providers participating in authentication protocols be authenticated to subscribers.
379   The AAL characterizes the strength of an authentication transaction as an ordinal
380   category. Stronger authentication (a higher AAL) requires malicious actors to have
381   better capabilities and to expend greater resources in order to successfully subvert
382   the authentication process. Authentication at higher AALs can effectively reduce the
383   risk of attacks. A high-level summary of the technical requirements for each of the
384   AALs is provided below; see Sec. 4 and Sec. 5 of this document for specific normative
385   requirements.
386   Authentication Assurance Level 1: AAL1 provides some assurance that the claimant
387   controls an authenticator bound to the subscriber account. AAL1 requires either single-
388   factor or multi-factor authentication using a wide range of available authentication
389   technologies. Successful authentication requires that the claimant prove possession and
390   control of the authenticator through a secure authentication protocol.
391   Authentication Assurance Level 2: AAL2 provides high confidence that the claimant
392   controls one or more authenticators bound to the subscriber account. Proof of

                                                    3
      NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
      December 2022                                       Authentication and Lifecycle Management


393   possession and control of two different authentication factors is required through secure
394   authentication protocols. Approved cryptographic techniques are required at AAL2 and
395   above.
396   Authentication Assurance Level 3: AAL3 provides very high confidence that
397   the claimant controls one or more authenticators bound to the subscriber account.
398   Authentication at AAL3 is based on proof of possession of a key through a cryptographic
399   protocol. AAL3 authentication requires a hardware-based authenticator and a
400   phishing-resistant authenticator (see Sec. 5.2.5); the same device may fulfill both
401   these requirements. In order to authenticate at AAL3, claimants are required to prove
402   possession and control of two distinct authentication factors through secure authentication
403   protocols. Approved cryptographic techniques are required.
404   The following list states which sections of the document are normative and which are
405   informative:
406       • 1 Purpose Informative
407       • 2 Introduction Informative
408       • 3 Definitions and Abbreviations Informative
409       • 4 Authentication Assurance Levels Normative
410       • 5 Authenticator and Verifier Requirements Normative
411       • 6 Authenticator Lifecycle Management Normative
412       • 7 Session Management Normative
413       • 8 Threat and Security Considerations Informative
414       • 9 Privacy Considerations Informative
415       • 10 Usability Considerations Informative
416       • 11 Equity Considerations Informative
417       • References Informative
418       • Appendix A Strength of Memorized Secrets Informative
419       • Appendix B Change Log Informative




                                                   4
      NIST SP 800-63B-4 ipd                                            Digital Identity Guidelines
      December 2022                                     Authentication and Lifecycle Management


420   3.   Deﬁnitions and Abbreviations
421   See [SP800-63], Appendix A for a complete set of definitions and abbreviations.




                                                 5
      NIST SP 800-63B-4 ipd                                               Digital Identity Guidelines
      December 2022                                        Authentication and Lifecycle Management


422   4.   Authentication Assurance Levels
423   This section is normative.
424   To satisfy the requirements of a given AAL and be recognized as a subscriber, a claimant
425    SHALL be authenticated with a process whose strength is equal to or greater than the
426   requirements at that level. The result of an authentication process is an identifier that
427    SHALL be used each time that subscriber authenticates to that RP. The identifier MAY
428   be pseudonymous. Subscriber identifiers SHOULD NOT be reused for a different subject
429   but SHOULD be reused when a previously enrolled subject is re-enrolled by the CSP.
430   Other attributes that identify the subscriber as a unique subject MAY also be provided.
431   Detailed normative requirements for authenticators and verifiers at each AAL are
432   provided in Sec. 5.
433   See [SP800-63] Sec. 5 for details on how to choose the most appropriate AAL.
434   [FIPS140] requirements are satisfied by FIPS 140-3 or newer revisions.
435   Personal information collected during and subsequent to identity proofing MAY be made
436   available to the subscriber by the digital identity service. The release or online availability
437   of any PII or other personal information, whether self-asserted or validated, by federal
438   government agencies requires multi-factor authentication in accordance with [EO13681].
439   Therefore, federal government agencies SHALL select a minimum of AAL2 when PII or
440   other personal information is made available online.

441   4.1. Authentication Assurance Level 1
442   AAL1 provides some assurance that the claimant controls an authenticator bound to the
443   subscriber account. AAL1 requires either single-factor or multi-factor authentication
444   using a wide range of available authentication technologies. Successful authentication
445   requires that the claimant prove possession and control of the authenticator through a
446   secure authentication protocol.

447   4.1.1. Permitted Authenticator Types
448   AAL1 authentication SHALL occur by the use of any of the following authenticator
449   types, which are defined in Sec. 5:
450        • Memorized secret (Sec. 5.1.1)
451        • Look-Up secret (Sec. 5.1.2)
452        • Out-of-band device (Sec. 5.1.3)
453        • Single-factor one-time password (OTP) device (Sec. 5.1.4)
454        • Multi-factor OTP device (Sec. 5.1.5)
455        • Single-factor cryptographic software (Sec. 5.1.6)

                                                    6
      NIST SP 800-63B-4 ipd                                             Digital Identity Guidelines
      December 2022                                      Authentication and Lifecycle Management


456       • Single-factor cryptographic device (Sec. 5.1.7)
457       • Multi-factor cryptographic software (Sec. 5.1.8)
458       • Multi-factor cryptographic device (Sec. 5.1.9)

459   4.1.2. Authenticator and Veriﬁer Requirements
460   Cryptographic authenticators used at AAL1 SHALL use approved cryptography.
461   Software-based authenticators that operate within the context of an operating system
462    MAY , where applicable, attempt to detect compromise (e.g., by malware) of the user
463   endpoint in which they are running and SHOULD NOT complete the operation when such
464   a compromise is detected.
465   Communication between the claimant and verifier SHALL be via an authenticated
466   protected channel to provide confidentiality of the authenticator output and resistance
467   to adversary-in-the-middle (AitM) attacks.
468   Verifiers operated by or on behalf of federal government agencies at AAL1 SHALL be
469   validated to meet the requirements of [FIPS140] Level 1.

470   4.1.3. Reauthentication
471   Periodic reauthentication of subscriber sessions SHALL be performed as described in
472   Sec. 7.2. At AAL1, reauthentication of the subscriber SHOULD be repeated at least once
473   per 30 days during an extended usage session, regardless of user activity. The session
474   SHOULD be terminated (i.e., logged out) when this time limit is reached.


475   4.1.4. Security Controls
476   The CSP SHALL employ appropriately tailored security controls from the baseline
477   security controls defined in [SP800-53] or equivalent federal (e.g., [FEDRAMP]) or
478   industry standard that the organization has determined for the information systems,
479   applications, and online services that these guidelines are used to protect. The CSP
480    SHALL ensure that the minimum assurance-related controls for the appropriate systems,
481   or equivalent, are satisfied.

482   4.1.5. Records Retention Policy
483   The CSP SHALL comply with its respective records retention policies in accordance
484   with applicable laws, regulations, and policies, including any National Archives and
485   Records Administration (NARA) records retention schedules that may apply. If the CSP
486   opts to retain records in the absence of any mandatory requirements, the CSP SHALL
487   conduct a risk management process, including assessments of privacy and security risks,
488   to determine how long records should be retained and SHALL inform the subscriber of
489   that retention policy.


                                                  7
      NIST SP 800-63B-4 ipd                                             Digital Identity Guidelines
      December 2022                                      Authentication and Lifecycle Management


490   4.2. Authentication Assurance Level 2
491   AAL2 provides high confidence that the claimant controls authenticators bound to the
492   subscriber account. Proof of possession and control of two distinct authentication factors
493   is required through secure authentication protocols. Approved cryptographic techniques
494   are required at AAL2 and above.

495   4.2.1. Permitted Authenticator Types
496   At AAL2, authentication SHALL occur by the use of either a multi-factor authenticator
497   or a combination of two single-factor authenticators. A multi-factor authenticator
498   requires two factors to execute a single authentication event, such as a cryptographically
499   secure device with an integrated biometric sensor that is required to activate the device.
500   Authenticator requirements are specified in Sec. 5.
501   When a multi-factor authenticator is used, any of the following MAY be used:
502       • Multi-Factor Out-of-Band Authenticator (Sec. 5.1.3.4)
503       • Multi-Factor OTP Device (Sec. 5.1.5)
504       • Multi-Factor Cryptographic Software (Sec. 5.1.8)
505       • Multi-Factor Cryptographic Device (Sec. 5.1.9)
506   When a combination of two single-factor authenticators is used, the combination SHALL
507   include a Memorized Secret authenticator (Sec. 5.1.1) and one physical authenticator (i.e.,
508   “something you have”) from the following list:
509       • Look-Up Secret (Sec. 5.1.2)
510       • Out-of-Band Device (Sec. 5.1.3)
511       • Single-Factor OTP Device (Sec. 5.1.4)
512       • Single-Factor Cryptographic Software (Sec. 5.1.6)
513       • Single-Factor Cryptographic Device (Sec. 5.1.7)
514         Note: When biometric authentication meets the requirements in Sec. 5.2.3,
515         the device has to be authenticated in addition to the biometric match. A
516         biometric characteristic is recognized as a factor, but not recognized as an
517         authenticator by itself. Therefore, when conducting authentication with a
518         biometric characteristic, it is unnecessary to use two authenticators because
519         the associated device serves as “something you have,” while the biometric
520         match serves as “something you are.”




                                                   8
      NIST SP 800-63B-4 ipd                                             Digital Identity Guidelines
      December 2022                                      Authentication and Lifecycle Management


521   4.2.2. Authenticator and Veriﬁer Requirements
522   Cryptographic authenticators used at AAL2 SHALL use approved cryptography.
523   Authenticators procured by federal government agencies SHALL be validated to meet
524   the requirements of [FIPS140] Level 1. Software-based authenticators that operate within
525   the context of an operating system MAY , where applicable, attempt to detect compromise
526   (e.g., by malware) of the platform in which they are running. They SHOULD NOT
527   complete the operation when such a compromise is detected. At least one authenticator
528   used at AAL2 SHALL be replay resistant as described in Sec. 5.2.8. Authentication at
529   AAL2 SHOULD demonstrate authentication intent from at least one authenticator as
530   discussed in Sec. 5.2.9.
531   Communication between the claimant and verifier SHALL be via an authenticated
532   protected channel to provide confidentiality of the authenticator output and resistance
533   to AitM attacks.
534   Verifiers operated by or on behalf of federal government agencies at AAL2 SHALL be
535   validated to meet the requirements of [FIPS140] Level 1.
536   When a biometric factor is used in authentication at AAL2, the performance requirements
537   stated in Sec. 5.2.3 SHALL be met, and the verifier SHOULD make a determination that
538   the biometric sensor and subsequent processing meet these requirements.
539   OMB Memorandum [M-22-09] requires federal government agencies to offer at least
540   one phishing-resistant authenticator option to public users at AAL2. While phishing
541   resistance as described in Sec. 5.2.5 is not generally required for authentication at AAL2,
542   verifiers SHOULD encourage the use of phishing-resistant authenticators at AAL2
543   whenever practical since phishing is a significant threat vector.

544   4.2.3. Reauthentication
545   Periodic reauthentication of subscriber sessions SHALL be performed as described in
546   Sec. 7.2. At AAL2, authentication of the subscriber SHALL be repeated at least once per
547   12 hours during an extended usage session, regardless of user activity. Reauthentication of
548   the subscriber SHALL be repeated following any period of inactivity lasting 30 minutes
549   or longer. The session SHALL be terminated (i.e., logged out) when either of these time
550   limits is reached.
551   Reauthentication of a session that has not yet reached its time limit MAY require only
552   a memorized secret or a biometric in conjunction with the still-valid session secret. The
553   verifier MAY prompt the user to cause activity just before the inactivity timeout.

554   4.2.4. Security Controls
555   The CSP SHALL employ appropriately tailored security controls from the baseline
556   security controls defined in [SP800-53] or equivalent federal (e.g., [FEDRAMP]) or
557   industry standard that the organization has determined for the information systems,

                                                   9
      NIST SP 800-63B-4 ipd                                             Digital Identity Guidelines
      December 2022                                      Authentication and Lifecycle Management


558   applications, and online services that these guidelines are used to protect. The CSP
559    SHALL ensure that the minimum assurance-related controls for the appropriate systems,
560   or equivalent, are satisfied.

561   4.2.5. Records Retention Policy
562   The CSP SHALL comply with its respective records retention policies in accordance
563   with applicable laws, regulations, and policies, including any NARA records retention
564   schedules that may apply. If the CSP opts to retain records in the absence of any
565   mandatory requirements, the CSP SHALL conduct a risk management process, including
566   assessments of privacy and security risks to determine how long records should be
567   retained and SHALL inform the subscriber of that retention policy.

568   4.3. Authentication Assurance Level 3
569   AAL3 provides very high confidence that the claimant controls authenticators bound
570   to the subscriber account. Authentication at AAL3 is based on proof of possession of
571   a key through a cryptographic protocol. AAL3 authentication SHALL use a hardware-
572   based authenticator and an authenticator that provides phishing resistance — the same
573   device MAY fulfill both these requirements. In order to authenticate at AAL3, claimants
574    SHALL prove possession and control of two distinct authentication factors through
575   secure authentication protocols. Approved cryptographic techniques are required.

576   4.3.1. Permitted Authenticator Types
577   AAL3 authentication SHALL occur by the use of one of a combination of authenticators
578   satisfying the requirements in Sec. 4.3. Possible combinations are:
579       • Multi-Factor Cryptographic Device (Sec. 5.1.9)
580       • Single-Factor Cryptographic Device (Sec. 5.1.7) used in conjunction with a
581         Memorized Secret (Sec. 5.1.1)
582       • Multi-Factor OTP device (software or hardware) (Sec. 5.1.5) used in conjunction
583         with a Single-Factor Cryptographic Device (Sec. 5.1.7)
584       • Multi-Factor OTP device (hardware only) (Sec. 5.1.5) used in conjunction with a
585         Single-Factor Cryptographic Software (Sec. 5.1.6)
586       • Single-Factor OTP device (hardware only) (Sec. 5.1.4) used in conjunction with a
587         Multi-Factor Cryptographic Software Authenticator (Sec. 5.1.8)

588   4.3.2. Authenticator and Veriﬁer Requirements
589   Communication between the claimant and verifier SHALL be via an authenticated
590   protected channel to provide confidentiality of the authenticator output and resistance
591   to AitM attacks. At least one cryptographic authenticator used at AAL3 SHALL
592   be phishing resistant as described in Sec. 5.2.5 and SHALL be replay resistant as

                                                 10
      NIST SP 800-63B-4 ipd                                             Digital Identity Guidelines
      December 2022                                      Authentication and Lifecycle Management


593   described in Sec. 5.2.8. All authentication and reauthentication processes at AAL3
594    SHALL demonstrate authentication intent from at least one authenticator as described
595   in Sec. 5.2.9.
596   Multi-factor authenticators used at AAL3 SHALL be hardware cryptographic modules
597   validated at [FIPS140] Level 2 or higher overall with at least [FIPS140] Level 3 physical
598   security. Single-factor cryptographic devices used at AAL3 SHALL be validated at
599   [FIPS140] Level 1 or higher overall with at least [FIPS140] Level 3 physical security.
600   Verifiers at AAL3 SHALL be validated at [FIPS140] Level 1 or higher.
601   Verifiers at AAL3 SHALL be verifier compromise resistant as described in Sec. 5.2.7
602   with respect to at least one authentication factor.
603   Hardware-based authenticators and verifiers at AAL3 SHOULD resist relevant side-
604   channel (e.g., timing and power-consumption analysis) attacks.
605   When a biometric factor is used in authentication at AAL3, the verifier SHALL make a
606   determination that the biometric sensor and subsequent processing meet the performance
607   requirements stated in Sec. 5.2.3.

608   4.3.3. Reauthentication
609   Periodic reauthentication of subscriber sessions SHALL be performed as described in
610   Sec. 7.2. At AAL3, authentication of the subscriber SHALL be repeated at least once
611   per 12 hours during an extended usage session, regardless of user activity, as described in
612   Sec. 7.2. Reauthentication of the subscriber SHALL be repeated following any period of
613   inactivity lasting 15 minutes or longer. Reauthentication SHALL use both authentication
614   factors. The session SHALL be terminated (i.e., logged out) when either of these time
615   limits is reached. The verifier MAY prompt the user to cause activity just before the
616   inactivity timeout.

617   4.3.4. Security Controls
618   The CSP SHALL employ appropriately tailored security controls from the baseline
619   security controls defined in [SP800-53] or equivalent federal (e.g., [FEDRAMP]) or
620   industry standard that the organization has determined for the information systems,
621   applications, and online services that these guidelines are used to protect. The CSP
622    SHALL ensure that the minimum assurance-related controls for the appropriate systems,
623   or equivalent, are satisfied.

624   4.3.5. Records Retention Policy
625   The CSP SHALL comply with its respective records retention policies in accordance
626   with applicable laws, regulations, and policies, including any NARA records retention
627   schedules that may apply. If the CSP opts to retain records in the absence of any


                                                  11
      NIST SP 800-63B-4 ipd                                               Digital Identity Guidelines
      December 2022                                        Authentication and Lifecycle Management


628   mandatory requirements, the CSP SHALL conduct a risk management process, including
629   assessments of privacy and security risks, to determine how long records should be
630   retained and SHALL inform the subscriber of that retention policy.

631   4.4. Privacy Requirements
632   The CSP SHALL employ appropriately tailored privacy controls defined in [SP800-53]
633   or equivalent industry standard.
634   If CSPs process attributes for purposes other than identity proofing, authentication, or
635   attribute assertions (collectively “identity service”), related fraud mitigation, or to comply
636   with law or legal process, CSPs SHALL implement measures to maintain predictability
637   and manageability commensurate with the privacy risk arising from the additional
638   processing. Measures MAY include providing clear notice, obtaining subscriber consent,
639   or enabling selective use or disclosure of attributes. When CSPs use consent measures,
640   CSPs SHALL NOT make consent for the additional processing a condition of the identity
641   service.
642   Regardless of whether the CSP is an agency or private sector provider, the following
643   requirements apply to a federal agency offering or using the authentication service:
644      1. The agency SHALL consult with their Senior Agency Official for Privacy (SAOP)
645         and conduct an analysis to determine whether the collection of PII to issue or
646         maintain authenticators triggers the requirements of the Privacy Act of 1974
647         [PrivacyAct] (see Sec. 9.4).
648      2. The agency SHALL publish a System of Records Notice (SORN) to cover such
649         collections, as applicable.
650      3. The agency SHALL consult with their SAOP and conduct an analysis to determine
651         whether the collection of PII to issue or maintain authenticators triggers the
652         requirements of the E-Government Act of 2002 [E-Gov].
653      4. The agency SHALL publish a Privacy Impact Assessment (PIA) to cover such
654         collection, as applicable.

655   4.5. Summary of Requirements
656   Table 1 provides a non-normative summary of the requirements for each of the AALs.




                                                   12
NIST SP 800-63B-4 ipd                                         Digital Identity Guidelines
December 2022                                  Authentication and Lifecycle Management


                        Table 1. AAL Summary of Requirements

 Requirement        AAL1                 AAL2                AAL3
 Permitted          Memorized Secret;    MF Out-of-          MF Crypto Device;
 authenticator      Look-up Secret;      Band; MF OTP        SF Crypto Device
 types              Out-of-Band; SF      Device; MF Crypto plus Memorized
                    OTP Device; MF       Software; MF        Secret; SF OTP
                    OTP Device; SF       Crypto Device;      Device plus MF
                    Crypto Software;     or Memorized        Crypto Device or
                    SF Crypto Device;    Secret plus: Look- Software; SF OTP
                    MF Crypto            up Secret, Out-     Device plus SF
                    Software; MF         of-Band, SF OTP     Crypto Software plus
                    Crypto Device        Device, SF Crypto Memorized Secret
                                         Software, SF
                                         Crypto Device
 FIPS 140           Level 1              Level 1             Level 2 overall (MF
 validation         (Government          (Government         authenticators) Level
                    agency verifiers)    agency              1 overall (verifiers
                                         authenticators and  and SF Crypto
                                         verifiers)          Devices) Level 3
                                                             physical security (all
                                                             authenticators)
 Reauthentication 30 days                12 hours or 30      12 hours or 15
                                         minutes inactivity; minutes inactivity;
                                         one authentication both authentication
                                         factor              factors
 Security           [SP800-53] Low       [SP800-53]          [SP800-53] High
 controls           Baseline (or         Moderate Baseline Baseline (or
                    equivalent)          (or equivalent)     equivalent)
 AitM resistance    Required             Required            Required
 Phishing           Not required         Recommended         Required
 resistance
 Verifier-          Not required         Not required          Required
 compromise
 resistance
 Replay             Not required         Required              Required
 resistance
 Authentication     Not required         Recommended           Required
 intent




                                        13
      NIST SP 800-63B-4 ipd                                             Digital Identity Guidelines
      December 2022                                      Authentication and Lifecycle Management


657   5.   Authenticator and Veriﬁer Requirements
658   This section is normative.
659   This section provides the detailed requirements specific to each type of authenticator.
660   With the exception of reauthentication requirements specified in Sec. 4 and the
661   requirement for phishing resistance at AAL3 described in Sec. 5.2.5, the technical
662   requirements for each of the authenticator types are the same regardless of the AAL at
663   which the authenticator is used.

664   5.1. Requirements by Authenticator Type
665   5.1.1. Memorized Secrets
666   A Memorized Secret authenticator — commonly referred to as a password or, if numeric,
667   a PIN — is a secret value intended to be chosen and memorized by the user. Memorized
668   secrets need to be of sufficient complexity and secrecy that it would be impractical for
669   an attacker to guess or otherwise discover the correct secret value. A memorized secret is
670   something you know.
671   The requirements in this section apply to centrally verified memorized secrets that
672   are used as an independent authentication factor, sent over an authenticated protected
673   channel to the verifier of a CSP. Memorized secrets that are used locally by a multi-factor
674   authenticator are referred to as activation secrets and discussed in Sec. 5.2.11.

675   5.1.1.1. Memorized Secret Authenticators
676   Memorized secrets SHALL be at least 8 characters in length. Memorized secrets SHALL
677   be either chosen by the subscriber or assigned randomly by the CSP.
678   If the CSP disallows a chosen memorized secret because it is on a blocklist of commonly
679   used, expected, or compromised values (see Sec. 5.1.1.2), the subscriber SHALL be
680   required to choose a different memorized secret. No other complexity requirements for
681   memorized secrets SHALL be imposed. A rationale for this is presented in Appendix A
682   Strength of Memorized Secrets.

683   5.1.1.2. Memorized Secret Veriﬁers
684   Verifiers SHALL require memorized secrets to be at least 8 characters in length. Verifiers
685    SHOULD permit memorized secrets to be at least 64 characters in length. All printing
686   ASCII [RFC20] characters as well as the space character SHOULD be acceptable in
687   memorized secrets. Unicode [ISO/ISC 10646] characters SHOULD be accepted as well.
688   Verifiers MAY make allowances for likely mistyping, such as removing leading and
689   trailing whitespace characters prior to verification or allowing verification of memorized
690   secrets with differing case for the leading character, provided memorized secrets remain
691   at least 8 characters in length after such processing.


                                                  14
      NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
      December 2022                                       Authentication and Lifecycle Management


692   Verifiers SHALL verify the entire submitted memorized secret (i.e., not truncate the
693   secret). For purposes of the above length requirements, each Unicode code point SHALL
694   be counted as a single character.
695   If Unicode characters are accepted in memorized secrets, the verifier SHOULD apply
696   the normalization process for stabilized strings using either the NFKC or NFKD
697   normalization defined in Sec. 12.1 of Unicode Normalization Forms [UAX15]. This
698   process is applied before hashing the byte string representing the memorized secret.
699   Subscribers choosing memorized secrets containing Unicode characters SHOULD be
700   advised that some characters may be represented differently by some endpoints, which
701   can affect their ability to authenticate successfully.
702   Memorized secret verifiers SHALL NOT permit the subscriber to store a hint that is
703   accessible to an unauthenticated claimant. Verifiers SHALL NOT prompt subscribers
704   to use specific types of information (e.g., “What was the name of your first pet?”, a
705   technique known as knowledge-based authentication (KBA) or security questions) when
706   choosing memorized secrets.
707   When processing requests to establish and change memorized secrets, verifiers SHALL
708   compare the prospective secrets against a blocklist that contains values known to be
709   commonly used, expected, or compromised. For example, the list MAY include, but
710   is not limited to:
711       • Passwords obtained from previous breach corpuses.
712       • Dictionary words.
713       • Repetitive or sequential characters (e.g. ‘aaaaaa’, ‘1234abcd’).
714       • Context-specific words, such as the name of the service, the username, and
715         derivatives thereof.
716   If the chosen secret is found in the blocklist, the CSP or verifier SHALL advise the
717   subscriber that they need to select a different secret, SHALL provide the reason for
718   rejection, and SHALL require the subscriber to choose a different value. Since the
719   blocklist is used to defend against brute-force attacks and unsuccessful attempts are
720   rate limited as described below, the blocklist SHOULD be of a size sufficient to prevent
721   subscribers from choosing memorized secrets that attackers are likely to guess before
722   reaching the attempt limit. Excessively large blocklists SHOULD NOT be used because
723   they frustrate subscribers’ attempts to establish an acceptable memorized secret and do
724   not provide significantly improved security.
725   Verifiers SHALL offer guidance to the subscriber to assist the user in choosing a strong
726   memorized secret. This is particularly important following the rejection of a memorized
727   secret on the above list as it discourages trivial modification of listed (and likely very
728   weak) memorized secrets [Blocklists].


                                                  15
      NIST SP 800-63B-4 ipd                                            Digital Identity Guidelines
      December 2022                                     Authentication and Lifecycle Management


729   Verifiers SHALL implement a rate-limiting mechanism that effectively limits the number
730   of failed authentication attempts that can be made on the subscriber account as described
731   in Sec. 5.2.2.
732   Verifiers SHALL NOT impose other composition rules (e.g., requiring mixtures of
733   different character types or prohibiting consecutively repeated characters) for memorized
734   secrets. Verifiers SHALL NOT require users to periodically change memorized secrets.
735   However, verifiers SHALL force a change if there is evidence of compromise of the
736   authenticator.
737   Verifiers SHALL allow the use of password managers. To facilitate their use, verifiers
738    SHOULD permit claimants to use “paste” functionality when entering a memorized
739   secret. Password manangers may increase the likelihood that users will choose stronger
740   memorized secrets.
741 In order to assist the claimant in successfully entering a memorized secret, the verifier
742  SHOULD offer an option to display the secret — rather than a series of dots or asterisks
743 — while it is entered and until it is submitted to the verifier. This allows the claimant to

744 confirm their entry if they are in a location where their screen is unlikely to be observed.
745 The verifier MAY also permit the claimant’s device to display individual entered
746 characters for a short time after each character is typed to verify correct entry. This is
747 common on mobile devices.
748   The verifier SHALL use approved encryption and an authenticated protected channel
749   when requesting memorized secrets in order to provide resistance to eavesdropping and
750   adversary-in-the-middle attacks.
751   Verifiers SHALL store memorized secrets in a form that is resistant to offline attacks.
752   Memorized secrets SHALL be salted and hashed using a suitable password hashing
753   scheme. Password hashing schemes take a password, a salt, and a cost factor as inputs and
754   generate a password hash. Their purpose is to make each password guess more expensive
755   for an attacker who has obtained a hashed password file and thereby make the cost of a
756   guessing attack high or prohibitive. A function that is both memory-hard and compute-
757   hard SHOULD be used because it increases the cost of an attack. While NIST has not
758   published guidelines on specific password hashing schemes, examples of such functions
759   include Argon2 [Argon2] and scrypt [Scrypt]. Examples of approved one-way functions
760   include Keyed Hash Message Authentication Code (HMAC) [FIPS198-1], any approved
761   hash function in [SP800-107], Secure Hash Algorithm 3 (SHA-3) [FIPS202], CMAC
762   [SP800-38B], Keccak Message Authentication Code (KMAC), Customizable SHAKE
763   (cSHAKE), and ParallelHash [SP800-185]. The chosen output length of the password
764   hashing scheme SHOULD be the same as the length of the underlying one-way function
765   output.
766   The salt SHALL be at least 32 bits in length and be chosen arbitrarily so as to minimize
767   salt value collisions among stored hashes. Both the salt value and the resulting hash
768    SHALL be stored for each memorized secret authenticator.


                                                 16
      NIST SP 800-63B-4 ipd                                               Digital Identity Guidelines
      December 2022                                        Authentication and Lifecycle Management


769   For the Password-based Key Derivation Function 2 (PBKDF2) [SP800-132], the cost
770   factor is an iteration count: the more times the PBKDF2 function is iterated, the longer it
771   takes to compute the password hash. Therefore, the iteration count SHOULD be as large
772   as verification server performance will allow, typically at least 10,000 iterations.
773   In addition, verifiers SHOULD perform an additional iteration of a keyed hashing or
774   encryption operation using a secret key known only to the verifier. This key value, if used,
775    SHALL be generated by an approved random bit generator [SP800-90Ar1] and provide at
776   least the minimum security strength specified in the latest revision of NIST SP 800-131A,
777   Transitioning the Use of Cryptographic Algorithms and Key Lengths [SP800-131A] (112
778   bits as of the date of this publication). The secret key value SHALL be stored separately
779   from the hashed memorized secrets (e.g., in a specialized device like a hardware security
780   module). With this additional iteration, brute-force attacks on the hashed memorized
781   secrets are impractical as long as the secret key value remains secret.

782   5.1.2. Look-Up Secrets
783   A look-up secret authenticator is a physical or electronic record that stores a set of secrets
784   shared between the claimant and the CSP. The claimant uses the authenticator to look
785   up the appropriate secrets needed to respond to a prompt from the verifier. For example,
786   the verifier could ask a claimant to provide a specific subset of the numeric or character
787   strings printed on a card in table format. A common application of look-up secrets is
788   the use of one-time “recovery keys” stored by the subscriber for use in the event another
789   authenticator is lost or malfunctions. A look-up secret is something you have.

790   5.1.2.1. Look-Up Secret Authenticators
791   CSPs creating look-up secret authenticators SHALL use an approved random bit
792   generator [SP800-90Ar1] to generate the list of secrets and SHALL deliver the
793   authenticator securely to the subscriber. Look-up secrets SHALL have at least 20 bits
794   of entropy.
795   Look-up secrets MAY be distributed by the CSP in person, by postal mail to the
796   subscriber’s address of record, or by online distribution. If distributed online, look-
797   up secrets SHALL be distributed over a secure channel in accordance with the post-
798   enrollment binding requirements in Sec. 6.1.2.
799   If the authenticator uses look-up secrets sequentially from a list, the subscriber MAY
800   dispose of used secrets, but only after a successful authentication.

801   5.1.2.2. Look-Up Secret Veriﬁers
802   Verifiers of look-up secrets SHALL prompt the claimant for the next secret from
803   their authenticator or for a specific (e.g., numbered) secret. A given secret from an
804   authenticator SHALL be used successfully only once. If the look-up secret is derived
805   from a grid card, each cell of the grid SHALL be used only once.

                                                   17
      NIST SP 800-63B-4 ipd                                             Digital Identity Guidelines
      December 2022                                      Authentication and Lifecycle Management


806   Verifiers SHALL store look-up secrets in a form that is resistant to offline attacks. Look-
807   up secrets having at least 112 bits of entropy SHALL be hashed with an approved one-
808   way function as described in Sec. 5.1.1.2. Look-up secrets with fewer than 112 bits
809   of entropy SHALL be salted and hashed using a suitable password hashing scheme,
810   also described in Sec. 5.1.1.2. The salt value SHALL be at least 32 bits in length and
811   arbitrarily chosen so as to minimize salt value collisions among stored hashes. Both the
812   salt value and the resulting hash SHALL be stored for each look-up secret.
813   For look-up secrets that have less than 64 bits of entropy, the verifier SHALL implement
814   a rate-limiting mechanism that effectively limits the number of failed authentication
815   attempts that can be made on the subscriber account as described in Sec. 5.2.2.
816   The verifier SHALL use approved encryption and an authenticated protected channel
817   when requesting look-up secrets in order to provide resistance to eavesdropping and AitM
818   attacks.

819   5.1.3. Out-of-Band Devices
820   An out-of-band authenticator is a physical device that is uniquely addressable and can
821   communicate securely with the verifier over a distinct communications channel, referred
822   to as the secondary channel. The device is possessed and controlled by the claimant and
823   supports private communication over this secondary channel, separate from the primary
824   channel for authentication. An out-of-band authenticator is something you have.
825   Out-of-band authentiction uses a short-term secret generated by the verifier. The secret’s
826   purpose is to securely bind the authentication operation on the primary and secondary
827   channel and establishes the claimant’s control of the out-of-band device.
828   The out-of-band authenticator can operate in one of the following ways:
829       • The claimant transfers a secret received by the out-of-band device via the secondary
830         channel to the verifier using the primary channel. For example, the claimant may
831         receive the secret (typically a 6-digit code) on their mobile device and type it into
832         their authentication session. This method is shown in Figure 1.
833       • The claimant transfers a secret received via the primary channel to the out-of-band
834         device for transmission to the verifier via the secondary channel. For example, the
835         claimant may view the secret on their authentication session and either type it into
836         an app on their mobile device or use a technology such as a barcode or QR code to
837         effect the transfer. This method is shown in Figure 2.
838         Note: A third method of out-of-band authentication involving the comparison
839         of secrets received from the primary and secondary channels and approving
840         on the secondary channel is no longer considered acceptable because it was
841         rarely implemented as described. It raised the likelihood that the claimant
842         would just approve without actually comparing the secrets. For example,

                                                  18
NIST SP 800-63B-4 ipd                                               Digital Identity Guidelines
December 2022                                        Authentication and Lifecycle Management




                        Figure 1. Transfer of Secret to Primary Device




                                             19
NIST SP 800-63B-4 ipd                                            Digital Identity Guidelines
December 2022                                     Authentication and Lifecycle Management




                   Figure 2. Transfer of Secret to Out-of-band Device




                                          20
      NIST SP 800-63B-4 ipd                                             Digital Identity Guidelines
      December 2022                                      Authentication and Lifecycle Management


843         an authenticator that receives a push notification from the verifier and
844         simply asks the claimant to approve the transaction (even if providing
845         some additional information about the authentication) does not meet the
846         requirements of this section.

847   5.1.3.1. Out-of-Band Authenticators
848   The out-of-band authenticator SHALL establish a separate channel with the verifier
849   in order to retrieve the out-of-band secret or authentication request. This channel is
850   considered to be out-of-band with respect to the primary communication channel (even if
851   it terminates on the same device) provided the device does not leak information from one
852   channel to the other without the authorization of the claimant.
853   The out-of-band device SHOULD be uniquely addressable by the verifier.
854   Communication over the secondary channel SHALL be encrypted unless sent via the
855   public switched telephone network (PSTN). For additional authenticator requirements
856   specific to use of the PSTN for out-of-band authentication, see Sec. 5.1.3.3. Channels or
857   addresses that do not prove possession of a specific device, such as voice-over-IP (VOIP)
858   telephone numbers, SHALL NOT be used for out-of-band authentication.
859   Email SHALL NOT be used for out-of-band authentication because it also does not prove
860   possession of a specific device and is typically accessed using only a memorized secret.
861   The out-of-band authenticator SHALL uniquely authenticate itself in one of the following
862   ways when communicating with the verifier:
863       • Establish an authenticated protected channel to the verifier using approved
864         cryptography. The key used SHALL be stored in suitably secure storage available
865         to the authenticator application (e.g., keychain storage, TPM, TEE, secure element).
866       • Authenticate to a public mobile telephone network using a SIM card or equivalent
867         that uniquely identifies the device. This method SHALL only be used if a secret is
868         being sent from the verifier to the out-of-band device via the PSTN (SMS or voice).
869   If a secret is sent by the verifier to the out-of-band device, the device SHOULD NOT
870   display the authentication secret while it is locked by the owner (i.e., SHOULD require
871   the presentation and verification of a PIN, passcode, or biometric characteristic to view).
872   However, authenticators SHOULD indicate the receipt of an authentication secret on a
873   locked device.
874   If the out-of-band authenticator requests approval over the secondary communication
875   channel — rather than by the presenting a secret that the claimant transfers to the primary
876   communication channel — it SHALL accept transfer of the secret from the primary
877   channel and send it to the verifier over the secondary channel to associate the approval
878   with the authentication transaction. The claimant MAY perform the transfer manually or
879   use a technology such as a barcode or QR code to effect the transfer.

                                                  21
      NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
      December 2022                                       Authentication and Lifecycle Management


880   5.1.3.2. Out-of-Band Veriﬁers
881   For additional verification requirements specific to the PSTN, see Sec. 5.1.3.3.
882   When the out-of-band authenticator is a secure application, such as on a smart phone,
883   the verifier MAY send a push notification to that device. The verifier waits for the
884   establishment of an authenticated protected channel with the out-of-band authenticator
885   and verifies its identifying key. The verifier SHALL NOT store the identifying key
886   itself, but SHALL use a verification method (e.g., an approved hash function or proof
887   of possession of the identifying key) to uniquely identify the authenticator. Once
888   authenticated, the verifier transmits the authentication secret to the authenticator.
889   Depending on the type of out-of-band authenticator, one of the following SHALL take
890   place:
891       • Transfer of secret from the secondary to the primary channel: The verifier MAY
892         signal the device containing the subscriber’s authenticator to indicate readiness
893         to authenticate. It SHALL then transmit a random secret to the out-of-band
894         authenticator. The verifier SHALL then wait for the secret to be returned on the
895         primary communication channel.
896       • Transfer of secret from the primary to the secondary channel: The verifier SHALL
897         display a random authentication secret to the claimant via the primary channel. It
898          SHALL then wait for the secret to be returned on the secondary channel from the
899         claimant’s out-of-band authenticator.
900   In all cases, the authentication SHALL be considered invalid if not completed within 10
901   minutes. In order to provide replay resistance as described in Sec. 5.2.8, verifiers SHALL
902   accept a given authentication secret only once during the validity period.
903   The verifier SHALL generate random authentication secrets with at least 20 bits of
904   entropy using an approved random bit generator [SP800-90Ar1]. If the authentication
905   secret has less than 64 bits of entropy, the verifier SHALL implement a rate-limiting
906   mechanism that effectively limits the number of failed authentication attempts that can be
907   made on the subscriber account as described in Sec. 5.2.2.
908   Out-of-band verifiers SHALL consider all authentication operations to be single-factor
909   unless the CSP has confirmed that the out-of-band authentication meets the requirements
910   of Sec. 5.1.3.4. This requirement MAY be satisfied by issuance of the authenticator by
911   the CSP or a trusted third party or by use of an authentication application known by the
912   CSP to meet these requirements.
913   Out-of-band verifiers that send a push notification to a subscriber device SHOULD
914   implement a reasonable limit on the rate or total number of push notifications that will be
915   sent since the last successful authentication.



                                                  22
      NIST SP 800-63B-4 ipd                                               Digital Identity Guidelines
      December 2022                                        Authentication and Lifecycle Management


916   5.1.3.3. Authentication using the Public Switched Telephone Network
917   Use of the PSTN for out-of-band verification is restricted as described in this section
918   and in Sec. 5.2.10. If out-of-band verification is to be made using the PSTN, the verifier
919    SHALL verify that the pre-registered telephone number being used is associated with a
920   specific physical device. Changing the pre-registered telephone number is considered to
921   be the binding of a new authenticator and SHALL only occur as described in Sec. 6.1.2.
922   Use of the PSTN to deliver out-of-band authentication secrets is potentially not available
923   to some subscribers in areas with limited telephone coverage (particularly in areas
924   without mobile phone service). Accordingly, verifiers SHALL ensure that alternative
925   authenticator types are available to all subscribers and SHOULD remind subscribers of
926   this limitation of PSTN out-of-band authenticators prior to binding.
927   Verifiers SHOULD consider risk indicators such as device swap, SIM change, number
928   porting, or other abnormal behavior before using the PSTN to deliver an out-of-band
929   authentication secret.
930         NOTE: Consistent with the restriction of authenticators in Sec. 5.2.10, NIST
931         may adjust the restricted status of the PSTN over time based on the evolution
932         of the threat landscape and the technical operation of the PSTN.

933   5.1.3.4. Multi-Factor Out-of-Band Authenticators
934   Multi-factor out-of-band authenticators operate in a similar manner to single-factor out-
935   of-band authenticators (see Sec. 5.1.3.1) except that they require the presentation and
936   verification of an additional factor, either a memorized secret or a biometric characteristic,
937   prior to allowing the claimant to complete the authentication transaction (i.e., prior to
938   accessing the authentication secret, entering the authentication secret, or confirming
939   the transaction as appropriate for the authentication flow being used). Each use of the
940   authenticator SHALL require the presentation of the activation factor.
941   The use of an activation secret by the authenticator SHALL meet the requirements of
942   Sec. 5.2.11. A biometric activation factor SHALL meet the requirements of Sec. 5.2.3,
943   including limits on the number of consecutive authentication failures. Submission of the
944   activation factor SHALL be a separate operation from unlocking of the host device (e.g.,
945   smartphone), although the same activation factor used to unlock the host device MAY
946   be used in the authentication operation. The memorized secret or biometric sample used
947   for activation — and any biometric data derived from the biometric sample such as a
948   probe produced through signal processing — SHALL be zeroized immediately after the
949   authentication operation.

950   5.1.4. Single-Factor OTP Device
951   A single-factor OTP device generates one-time passwords (OTPs). This category includes
952   hardware devices and software-based OTP generators installed on devices such as mobile

                                                   23
      NIST SP 800-63B-4 ipd                                             Digital Identity Guidelines
      December 2022                                      Authentication and Lifecycle Management


953   phones. These devices have an embedded secret that is used as the seed for generation of
954   OTPs and does not require activation through a second factor. The OTP is displayed on
955   the device and manually input for transmission to the verifier, thereby proving possession
956   and control of the device. An OTP device may, for example, display 6 characters at a time.
957   A single-factor OTP device is something you have.
958   Single-factor OTP devices are similar to look-up secret authenticators with the exception
959   that the secrets are cryptographically and independently generated by the authenticator
960   and verifier and compared by the verifier. The secret is computed based on a nonce that
961   may be time-based or from a counter on the authenticator and verifier.

962   5.1.4.1. Single-Factor OTP Authenticators
963   Single-factor OTP authenticators contain two persistent values. The first is a symmetric
964   key that persists for the device’s lifetime. The second is a nonce that is either changed
965   each time the authenticator is used or is based on a real-time clock.
966   The secret key and its algorithm SHALL provide at least the minimum security
967   strength specified in the latest revision of [SP800-131A] (112 bits as of the date of this
968   publication). The nonce SHALL be of sufficient length to ensure that it is unique for each
969   operation of the device over its lifetime. If a subscriber needs to change the device used
970   for a software-based OTP authenticator, they SHOULD bind the authenticator application
971   on the new device to their subscriber account as described in Sec. 6.1.2.1 and invalidate
972   the authenticator application that will no longer be used.
973   The authenticator output is obtained by using an approved block cipher or hash function
974   to combine the key and nonce in a secure manner. The authenticator output MAY be
975   truncated to as few as 6 decimal digits (approximately 20 bits of entropy).
976   If the nonce used to generate the authenticator output is based on a real-time clock, the
977   nonce SHALL be changed at least once every 2 minutes.

978   5.1.4.2. Single-Factor OTP Veriﬁers
979   Single-factor OTP verifiers effectively duplicate the process of generating the OTP used
980   by the authenticator. As such, the symmetric keys used by authenticators are also present
981   in the verifier, and SHALL be strongly protected against unauthorized disclosure by the
982   use of access controls that limit access to the keys to only those software components on
983   the device requiring access.
984   When a single-factor OTP authenticator is being associated with a subscriber account,
985   the verifier or associated CSP SHALL use approved cryptography to either generate and
986   exchange or to obtain the secrets required to duplicate the authenticator output.
987   The verifier SHALL use approved encryption and an authenticated protected channel
988   when collecting the OTP in order to provide resistance to eavesdropping and AitM attacks.

                                                  24
       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management


989    In order to provide replay resistance as described in Sec. 5.2.8, verifiers SHALL accept a
990    given OTP only once while it is valid. In the event a claimant’s authentication is denied
991    due to duplicate use of an OTP, verifiers MAY warn the claimant in case an attacker has
992    been able to authenticate in advance. Verifiers MAY also warn a subscriber in an existing
993    session of the attempted duplicate use of an OTP.
994    Time-based OTPs [TOTP] SHALL have a defined lifetime that is determined by the
995    expected clock drift — in either direction — of the authenticator over its lifetime, plus
996    allowance for network delay and user entry of the OTP.
997    If the authenticator output has less than 64 bits of entropy, the verifier SHALL implement
998    a rate-limiting mechanism that effectively limits the number of failed authentication
999    attempts that can be made on the subscriber account as described in Sec. 5.2.2.

1000   5.1.5. Multi-Factor OTP Devices
1001   A multi-factor OTP device generates OTPs for use in authentication after activation
1002   through input of an activation factor. This includes hardware devices and software-
1003   based OTP generators installed on devices such as mobile phones. The second factor
1004   of authentication may be achieved through some kind of integral entry pad, an integral
1005   biometric (e.g., fingerprint) reader, or a direct computer interface (e.g., USB port). The
1006   OTP is displayed on the device and manually input for transmission to the verifier. For
1007   example, an OTP device may display 6 characters at a time, thereby proving possession
1008   and control of the device. The multi-factor OTP device is something you have, and it
1009    SHALL be activated by either something you know or something you are.


1010   5.1.5.1. Multi-Factor OTP Authenticators
1011   Multi-factor OTP authenticators operate in a similar manner to single-factor OTP
1012   authenticators (see Sec. 5.1.4.1), except that they require the presentation and verification
1013   of either a memorized secret or a biometric characteristic to obtain the OTP from the
1014   authenticator. Each use of the authenticator SHALL require the input of the activation
1015   factor.
1016   In addition to activation information, multi-factor OTP authenticators contain two
1017   persistent values. The first is a symmetric key that persists for the device’s lifetime. The
1018   second is a nonce that is either changed each time the authenticator is used or is based on
1019   a real-time clock.
1020   The secret key and its algorithm SHALL provide at least the minimum security
1021   strength specified in the latest revision of [SP800-131A] (112 bits as of the date of this
1022   publication). The nonce SHALL be of sufficient length to ensure that it is unique for each
1023   operation of the device over its lifetime. If a subscriber needs to change the device used
1024   for a software-based OTP authenticator, they SHOULD bind the authenticator application



                                                    25
       NIST SP 800-63B-4 ipd                                             Digital Identity Guidelines
       December 2022                                      Authentication and Lifecycle Management


1025   on the new device to their subscriber account as described in Sec. 6.1.2.1 and invalidate
1026   the authenticator application that will no longer be used.
1027   The authenticator output is obtained by using an approved block cipher or hash function
1028   to combine the key and nonce in a secure manner. The authenticator output MAY be
1029   truncated to as few as 6 decimal digits (approximately 20 bits of entropy).
1030   If the nonce used to generate the authenticator output is based on a real-time clock, the
1031   nonce SHALL be changed at least once every 2 minutes.
1032   The use of an activation secret by the authenticator SHALL meet the requirements of
1033   Sec. 5.2.11. A biometric activation factor SHALL meet the requirements of Sec. 5.2.3,
1034   including limits on the number of consecutive authentication failures. Submission of the
1035   activation factor SHALL be a separate operation from unlocking of the host device (e.g.,
1036   smartphone), although the same activation factor used to unlock the host device MAY
1037   be used in the authentication operation. The unencrypted key and activation secret or
1038   biometric sample — and any biometric data derived from the biometric sample such as a
1039   probe produced through signal processing — SHALL be zeroized immediately after an
1040   OTP has been generated.

1041   5.1.5.2. Multi-Factor OTP Veriﬁers
1042   Multi-factor OTP verifiers effectively duplicate the process of generating the OTP used
1043   by the authenticator, but without the requirement that a second factor be provided. As
1044   such, the symmetric keys used by authenticators SHALL be strongly protected against
1045   unauthorized disclosure by the use of access controls that limit access to the keys to only
1046   those software components on the device requiring access.
1047   When a multi-factor OTP authenticator is being associated with a subscriber account,
1048   the verifier or associated CSP SHALL use approved cryptography to either generate
1049   and exchange or to obtain the secrets required to duplicate the authenticator output.
1050   The verifier or CSP SHALL also establish, by issuance of the authentictor, that
1051   the authenticator is a multi-factor device. Otherwise, the verifier SHALL treat the
1052   authenticator as single-factor, in accordance with Sec. 5.1.4.
1053   The verifier SHALL use approved encryption and an authenticated protected channel
1054   when collecting the OTP in order to provide resistance to eavesdropping and AitM attacks.
1055   In order to provide replay resistance as described in Sec. 5.2.8, verifiers SHALL accept a
1056   given OTP only once while it is valid. In the event a claimant’s authentication is denied
1057   due to duplicate use of an OTP, verifiers MAY warn the claimant in case an attacker has
1058   been able to authenticate in advance. Verifiers MAY also warn a subscriber in an existing
1059   session of the attempted duplicate use of an OTP.
1060   Time-based OTPs [TOTP] SHALL have a defined lifetime that is determined by the
1061   expected clock drift — in either direction — of the authenticator over its lifetime, plus
1062   allowance for network delay and user entry of the OTP.

                                                   26
       NIST SP 800-63B-4 ipd                                               Digital Identity Guidelines
       December 2022                                        Authentication and Lifecycle Management


1063   If the authenticator output or activation secret has less than 64 bits of entropy, the verifier
1064    SHALL implement a rate-limiting mechanism that effectively limits the number of
1065   failed authentication attempts that can be made on the subscriber account as described
1066   in Sec. 5.2.2.

1067   5.1.6. Single-Factor Cryptographic Software
1068   A single-factor cryptographic software authenticator is a cryptographic key stored on
1069   disk or some other “soft” media. Authentication is accomplished by proving possession
1070   and control of the key. The authenticator output is highly dependent on the specific
1071   cryptographic protocol, but it is generally some type of signed message. The single-factor
1072   cryptographic software authenticator is something you have.

1073   5.1.6.1. Single-Factor Cryptographic Software Authenticators
1074   Single-factor cryptographic software authenticators encapsulate one or more secret keys
1075   unique to the authenticator. The key SHALL be stored in suitably secure storage available
1076   to the authenticator application (e.g., keychain storage, TPM, or TEE if available). The
1077   key SHALL be strongly protected against unauthorized disclosure by the use of access
1078   controls that limit access to the key to only those software components on the device
1079   requiring access.
1080   External cryptographic authenticators that do not meet the requirements of cryptographic
1081   hardware authenticators (e.g., that have a mechanism to allow private keys to be exported)
1082   are also considered to be cryptographic software authenticators. They SHALL meet the
1083   requirements for connected authenticators in Sec. 5.2.12.

1084   5.1.6.2. Single-Factor Cryptographic Software Veriﬁers
1085   The requirements for a single-factor cryptographic software verifier are identical to those
1086   for a single-factor cryptographic device verifier, described in Sec. 5.1.7.2.

1087   5.1.7. Single-Factor Cryptographic Devices
1088   A single-factor cryptographic device is a hardware device that performs cryptographic
1089   operations using protected cryptographic keys and provides the authenticator output
1090   via direct connection to the user endpoint. The device uses embedded symmetric or
1091   asymmetric cryptographic keys, and does not require activation through a second factor
1092   of authentication. Authentication is accomplished by proving possession of the device
1093   via the authentication protocol. The authenticator output is provided by direct connection
1094   to the user endpoint and is highly dependent on the specific cryptographic device and
1095   protocol, but it is typically some type of signed message. A single-factor cryptographic
1096   device is something you have.




                                                     27
       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management


1097   5.1.7.1. Single-Factor Cryptographic Device Authenticators
1098   Single-factor cryptographic device authenticators use tamper-resistant hardware to
1099   encapsulate one or more secret keys unique to the authenticator that SHALL NOT be
1100   exportable (i.e., cannot be removed from the device). The authenticator operates using
1101   a secret key to sign a challenge nonce presented through a direct interface between the
1102   authenticator and endpoint (e.g., a USB port or secured wireless connection) as specified
1103   in Sec. 5.2.12. Alternatively, the authenticator could be a suitably secure processor
1104   integrated with the user endpoint itself.
1105   The secret key and its algorithm SHALL provide at least the minimum security
1106   length specified in the latest revision of [SP800-131A] (112 bits as of the date of this
1107   publication). The challenge nonce SHALL be at least 64 bits in length. Approved
1108   cryptography SHALL be used.
1109   Cryptographic device authenticators differ from cryptographic software authenticators
1110   because of the greater protection afforded to the embedded authentication secrets by
1111   cryptographic devices. In order to be considered a cryptographic device, an authenticator
1112    SHALL either be a separate piece of hardware or an embedded processor or execution
1113   environment, e.g., secure element, trusted execution environment (TEE), trusted platform
1114   module (TPM). These hardware authenticators or embedded processors are separate
1115   from a host processor such as the CPU on a laptop or mobile device. A cryptographic
1116   device authenticator SHALL be designed so as to prohibit the export of the authentication
1117   secret to the host processor and SHALL NOT be capable of being reprogrammed by the
1118   host processor so as to allow the secret to be extracted. The authenticator is subject to
1119   applicable [FIPS140] requirements of the AAL at which the authenticator is being used.
1120   Single-factor cryptographic device authenticators SHOULD require a physical input (e.g.,
1121   the pressing of a button) in order to operate. This provides defense against unintended
1122   operation of the device, which might occur if the endpoint to which it is connected is
1123   compromised.

1124   5.1.7.2. Single-Factor Cryptographic Device Veriﬁers
1125   Single-factor cryptographic device verifiers generate a challenge nonce, send it to the
1126   corresponding authenticator, and use the authenticator output to verify possession of the
1127   device. The authenticator output is highly dependent on the specific cryptographic device
1128   and protocol, but it is generally some type of signed message.
1129   The verifier has either symmetric or asymmetric cryptographic keys corresponding to
1130   each authenticator. While both types of keys SHALL be protected against modification,
1131   symmetric keys SHALL additionally be protected against unauthorized disclosure by the
1132   use of access controls that limit access to the key to only those software components on
1133   the device requiring access.
1134   The challenge nonce SHALL be at least 64 bits in length, and SHALL either be unique
1135   over the authenticator’s lifetime or statistically unique (i.e., generated using an approved

                                                    28
       NIST SP 800-63B-4 ipd                                             Digital Identity Guidelines
       December 2022                                      Authentication and Lifecycle Management


1136   random bit generator [SP800-90Ar1]). The verification operation SHALL use approved
1137   cryptography.

1138   5.1.8. Multi-Factor Cryptographic Software
1139   A multi-factor cryptographic software authenticator is a cryptographic key stored on
1140   disk or some other “soft” media that requires activation through a second factor of
1141   authentication. Authentication is accomplished by proving possession and control of the
1142   key. The authenticator output is highly dependent on the specific cryptographic protocol,
1143   but it is generally some type of signed message. The multi-factor cryptographic software
1144   authenticator is something you have, and it SHALL be activated by either something you
1145   know or something you are.

1146   5.1.8.1. Multi-Factor Cryptographic Software Authenticators
1147   Multi-factor cryptographic software authenticators encapsulate one or more secret keys
1148   unique to the authenticator and accessible only through the presentation and verification
1149   of an activation factor, either a memorized secret or a biometric characteristic. The key
1150    SHOULD be stored in suitably secure storage available to the authenticator application
1151   (e.g., keychain storage, TPM, TEE). The key SHALL be strongly protected against
1152   unauthorized disclosure by the use of access controls that limit access to the key to only
1153   those software components on the device requiring access.
1154   External cryptographic authenticators that do not meet the requirements of cryptographic
1155   hardware authenticators (e.g., that have a mechanism to allow private keys to be exported)
1156   are also considered to be cryptographic software authenticators. They SHALL meet the
1157   requirementss for connected authenticators in Sec. 5.2.12.
1158   Each authentication operation using the authenticator SHALL require the input of the
1159   activation factor.
1160   The use of an activation secret by the authenticator SHALL meet the requirements of
1161   Sec. 5.2.11. A biometric activation factor SHALL meet the requirements of Sec. 5.2.3,
1162   including limits on the number of consecutive authentication failures. Submission of the
1163   activation factor SHALL be a separate operation from unlocking of the host device (e.g.,
1164   smartphone), although the same activation factor used to unlock the host device MAY
1165   be used in the authentication operation. The activation secret or biometric sample — and
1166   any biometric data derived from the biometric sample such as a probe produced through
1167   signal processing — SHALL be zeroized immediately after an authentication transaction
1168   has taken place.

1169   5.1.8.2. Multi-Factor Cryptographic Software Veriﬁers
1170   The requirements for a multi-factor cryptographic software verifier are identical to those
1171   for a single-factor cryptographic device verifier, described in Sec. 5.1.7.2. Verification


                                                   29
       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management


1172   of the output from a multi-factor cryptographic software authenticator proves use of the
1173   activation factor.

1174   5.1.9. Multi-Factor Cryptographic Devices
1175   A multi-factor cryptographic device is a hardware device that performs cryptographic
1176   operations using one or more protected cryptographic keys and requires activation
1177   through a second authentication factor. Authentication is accomplished by proving
1178   possession of the device and control of the key. The authenticator output is provided
1179   by direct connection to the user endpoint and is highly dependent on the specific
1180   cryptographic device and protocol, but it is typically some type of signed message. The
1181   multi-factor cryptographic device is something you have, and it SHALL be activated by
1182   either something you know or something you are.

1183   5.1.9.1. Multi-Factor Cryptographic Device Authenticators
1184   Multi-factor cryptographic device authenticators use tamper-resistant hardware to
1185   encapsulate one or more secret keys unique to the authenticator that SHALL NOT
1186   be exportable (i.e., cannot be removed from the device). The secret key SHALL be
1187   accessible only through the presentation and verification of an activation factor, either
1188   a biometric characteristic or an activation secret as described in Sec. 5.2.11. The
1189   authenticator operates by using a secret key that was unlocked by the activation factor
1190   to sign a challenge nonce presented through a direct interface between the authenticator
1191   and endpoint (e.g., a USB port or secured wireless connection) as specified in Sec. 5.2.12.
1192   Alternatively, the authenticator could be a suitably secure processor integrated with the
1193   user endpoint itself (e.g., a hardware TPM).
1194   The secret key and its algorithm SHALL provide at least the minimum security
1195   length specified in the latest revision of [SP800-131A] (112 bits as of the date of this
1196   publication). The challenge nonce SHALL be at least 64 bits in length. Approved
1197   cryptography SHALL be used.
1198   Cryptographic device authenticators differ from cryptographic software authenticators
1199   because of the greater protection afforded to the embedded authentication secrets by
1200   cryptographic devices. In order to be considered a cryptographic device, an authenticator
1201    SHALL either be a separate piece of hardware or an embedded processor or execution
1202   environment, e.g., secure element, trusted execution environment (TEE), trusted platform
1203   module (TPM). A cryptographic device authenticator SHALL be designed so as to
1204   prohibit the export of the authentication secret to the host processor and SHALL NOT
1205   be capable of being reprogrammed by the host processor so as to allow the secret to be
1206   extracted. The authenticator is subject to applicable [FIPS140] requirements of the AAL
1207   at which the authenticator is being used.




                                                   30
       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management


1208   Each authentication operation using the authenticator SHOULD require the input of the
1209   activation factor. Input of the activation factor MAY be accomplished via either direct
1210   input on the device or via a hardware connection (e.g., USB, smartcard).
1211   The use of an activation secret by the authenticator SHALL meet the requirements of
1212   Sec. 5.2.11. A biometric activation factor SHALL meet the requirements of Sec. 5.2.3,
1213   including limits on the number of consecutive authentication failures. Submission of the
1214   activation factor SHALL be a separate operation from unlocking of the host device (e.g.,
1215   smartphone), although the same activation factor used to unlock the host device MAY
1216   be used in the authentication operation. The activation secret or biometric sample — and
1217   any biometric data derived from the biometric sample such as a probe produced through
1218   signal processing — SHALL be zeroized immediately after an authentication transaction
1219   has taken place.

1220   5.1.9.2. Multi-Factor Cryptographic Device Veriﬁers
1221   The requirements for a multi-factor cryptographic device verifier are identical to those for
1222   a single-factor cryptographic device verifier, described in Sec. 5.1.7.2. Verification of the
1223   authenticator output from a multi-factor cryptographic device proves use of the activation
1224   factor.

1225   5.2. General Authenticator Requirements
1226   5.2.1. Physical Authenticators
1227   CSPs SHALL provide subscriber instructions on how to appropriately protect the
1228   authenticator against theft or loss. The CSP SHALL provide a mechanism to invalidate
1229   the authenticator immediately upon notification from subscriber that loss or theft of the
1230   authenticator is suspected.

1231   5.2.2. Rate Limiting (Throttling)
1232   When required by the authenticator type descriptions in Sec. 5.1, the verifier SHALL
1233   implement controls to protect against online guessing attacks. Unless otherwise specified
1234   in the description of a given authenticator, the verifier SHALL limit consecutive failed
1235   authentication attempts on a single subscriber account to no more than 100.
1236   Additional techniques MAY be used to reduce the likelihood that an attacker will lock the
1237   legitimate claimant out as a result of rate limiting. These include:
1238       • Requiring the claimant to complete a bot-detection and mitigation challenge before
1239         attempting authentication.
1240       • Requiring the claimant to wait following a failed attempt for a period of time
1241         that increases as the subscriber account approaches its maximum allowance for
1242         consecutive failed attempts (e.g., 30 seconds up to an hour).


                                                    31
       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management


1243       • Accepting only authentication requests that come from an allowlist of IP addresses
1244         from which the subscriber has been successfully authenticated before.
1245       • Leveraging other risk-based or adaptive authentication techniques to identify user
1246         behavior that falls within, or out of, typical norms. These might, for example,
1247         include use of IP address, geolocation, timing of request patterns, or browser
1248         metadata.
1249   When the subscriber successfully authenticates, the verifier SHOULD disregard any
1250   previous failed attempts for that user from the same IP address.

1251   5.2.3. Use of Biometrics
1252   The use of biometrics (something you are) in authentication includes both measurement
1253   of physical characteristics (e.g., fingerprint, iris, facial characteristics) and behavioral
1254   characteristics (e.g., typing cadence). Both classes are considered biometric modalities,
1255   although different modalities may differ in the extent to which they establish
1256   authentication intent as described in Sec. 5.2.9.
1257   For a variety of reasons, this document supports only limited use of biometrics for
1258   authentication. These reasons include:
1259       • The biometric False Match Rate (FMR) does not provide confidence in the
1260         authentication of the subscriber by itself. In addition, FMR does not account for
1261         spoofing attacks.
1262       • Biometric comparison is probabilistic, whereas the other authentication factors are
1263         deterministic.
1264       • Biometric template protection schemes provide a method for revoking biometric
1265         credentials that is comparable to other authentication factors (e.g., PKI certificates
1266         and passwords). However, the availability of such solutions is limited, and
1267         standards for testing these methods are under development.
1268       • Biometric characteristics do not constitute secrets. They can often be obtained
1269         online or, in the case of a facial image, by taking a picture of someone with or
1270         without their knowledge. Latent fingerprints can be lifted from objects someone
1271         touches, and iris patterns can be captured with high resolution images. While
1272         presentation attack detection (PAD) technologies can mitigate the risk of these
1273         types of attacks, additional trust in the sensor or biometric processing is required
1274         to ensure that PAD is operating in accordance with the needs of the CSP and the
1275         subscriber.
1276   Therefore, the limited use of biometrics for authentication is supported with the following
1277   requirements and guidelines:
1278   Biometrics SHALL be used only as part of multi-factor authentication with a physical
1279   authenticator (something you have).

                                                    32
       NIST SP 800-63B-4 ipd                                                Digital Identity Guidelines
       December 2022                                         Authentication and Lifecycle Management


1280   The biometric system SHALL operate with a false-match rate (FMR) [ISO/IEC2382-37]
1281   of 1 in 10000 or better. This FMR SHALL be achieved under conditions of a conformant
1282   attack (i.e., zero-effort impostor attempt) as defined in [ISO/IEC30107-1].
1283   The biometric system SHOULD implement presentation attack detection (PAD). Testing
1284   of the biometric system to be deployed SHOULD demonstrate at least 90% resistance
1285   to presentation attacks for each relevant attack type (i.e., species), where resistance is
1286   defined as the number of thwarted presentation attacks divided by the number of trial
1287   presentation attacks. Testing of presentation attack resistance SHALL be in accordance
1288   with Clause 12 of [ISO/IEC30107-3]. The PAD decision MAY be made either locally on
1289   the claimant’s device or by a central verifier.
1290   The biometric system SHALL allow no more than 5 consecutive failed authentication
1291   attempts or 10 consecutive failed attempts if PAD, meeting the above requirements, is
1292   implemented. Once that limit has been reached, the biometric authenticator SHALL
1293   impose a delay of at least 30 seconds before each subsequent attempt, with an overall
1294   limit of no more than 50 consecutive failed authentication attempts (100 if PAD is
1295   implemented). Once the overall limit is reached, the biometric system SHALL disable
1296   biometric user authentication and offer another factor (e.g., a different biometric modality
1297   or an activation secret if it is not already a required factor) if such an alternative method is
1298   already available.
1299   The verifier SHALL make a determination of sensor and endpoint performance, integrity,
1300   and authenticity. Acceptable methods for making this determination include, but are not
1301   limited to:
1302       • Authentication of the sensor or endpoint
1303       • Certification by an approved accreditation authority
1304       • Runtime interrogation of signed metadata (e.g., attestation) as described in
1305         Sec. 5.2.4.
1306   Biometric comparison can be performed locally on the claimant’s device or at a central
1307   verifier. Since the potential for attacks on a larger scale is greater at central verifiers,
1308   comparison SHOULD be performed locally.
1309   If comparison is performed centrally:
1310       • Use of the biometric as an authentication factor SHALL be limited to one or
1311         more specific devices that are identified using approved cryptography. Since the
1312         biometric has not yet unlocked the main authentication key, a separate key SHALL
1313         be used for identifying the device.
1314       • Biometric revocation, referred to as biometric template protection in
1315         [ISO/IEC24745], SHALL be implemented.


                                                     33
       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management


1316       • An authenticated protected channel between sensor (or an endpoint containing a
1317         sensor that resists sensor replacement) and verifier SHALL be established and the
1318         sensor or endpoint SHALL be authenticated prior to capturing the biometric sample
1319         from the claimant.
1320       • All transmission of biometrics SHALL be over an authenticated protected channel.
1321   Biometric samples collected in the authentication process MAY be used to train
1322   comparison algorithms or — with user consent — for other research purposes. Biometric
1323   samples and any biometric data derived from the biometric sample such as a probe
1324   produced through signal processing SHALL be zeroized immediately after any training or
1325   research data has been derived.
1326   Biometric authentication technologies SHALL provide similar performance for
1327   subscribers of different demographic types (racial background, gender, ethnicity, etc.).

1328   5.2.4. Attestation
1329   An attestation is information conveyed to the verifier regarding a connected authenticator
1330   or the endpoint involved in an authentication operation. Information conveyed by
1331   attestation MAY include, but is not limited to:
1332       • The provenance (e.g., manufacturer or supplier certification), health, and integrity
1333         of the authenticator and endpoint
1334       • Security features of the authenticator
1335       • Security and performance characteristics of biometric sensors
1336       • Sensor modality
1337   If this attestation is signed, it SHALL be signed using a digital signature that provides at
1338   least the minimum security strength specified in the latest revision of [SP800-131A] (112
1339   bits as of the date of this publication).
1340   Attestation information MAY be used as part of a verifier’s risk-based authentication
1341   decision.

1342   5.2.5. Phishing (Veriﬁer Impersonation) Resistance
1343   Phishing attacks, previously referred to in SP 800-63B as “verifier impersonation,” are
1344   attempts by fraudulent verifiers and RPs to fool an unwary claimant into presenting an
1345   authenticator to an impostor. In some prior versions of SP 800-63, protocols resistant to
1346   phishing attacks were also referred to as “strongly MitM resistant.”
1347   The term phishing is widely used to describe a variety of similar attacks. For the purposes
1348   of this document, phishing resistance is the ability of the authentication protocol to detect
1349   and prevent disclosure of authentication secrets and valid authenticator outputs to an


                                                      34
       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management


1350   impostor relying party without reliance on the vigilance of the subscriber. The means
1351   by which the subscriber was directed to the impostor relying party are not relevant.
1352   For example, regardless of whether the subscriber was directed there via search engine
1353   optimization or prompted by email, it is considered to be a phishing attack.
1354   Approved cryptographic algorithms SHALL be used to establish phishing resistance
1355   where it is required. Keys used for this purpose SHALL provide at least the minimum
1356   security strength specified in the latest revision of [SP800-131A] (112 bits as of the date
1357   of this publication).
1358   Authenticators that involve the manual entry of an authenticator output, such as out-of-
1359   band and OTP authenticators, SHALL NOT be considered phishing resistant because
1360   the manual entry does not bind the authenticator output to the specific session being
1361   authenticated. In an AitM attack, an impostor verifier could replay the OTP authenticator
1362   output to the verifier and successfully authenticate.
1363   While an individual authenticator may be phishing resistant, phishing resistance for a
1364   given subscriber account is only achieved when all methods of authentication are phishing
1365   resistant.
1366   Two methods of phishing resistance are recognized: channel binding and verifier name
1367   binding. Channel binding is considered more secure than verifier name binding because
1368   it is not vulnerable to mis-issuance or misappropriation of relying party certificates, but
1369   either method satisfies the requirements for phishing resistance.

1370   5.2.5.1. Channel Binding
1371   An authentication protocol with channel binding SHALL establish an authenticated
1372   protected channel with the verifier. It SHALL then strongly and irreversibly bind a
1373   channel identifier that was negotiated in establishing the authenticated protected channel
1374   to the authenticator output (e.g., by signing the two values together using a private
1375   key controlled by the claimant for which the public key is known to the verifier). The
1376   verifier SHALL validate the signature or other information used to prove phishing
1377   resistance. This prevents an impostor verifier, even one that has obtained a certificate
1378   representing the actual verifier, from successfully relaying that authentication on a
1379   different authenticated protected channel.
1380   An example of a phishing resistant authentication protocol that uses channel binding is
1381   client-authenticated TLS, because the client signs the authenticator output along with
1382   earlier messages from the protocol that are unique to the particular TLS connection being
1383   negotiated.

1384   5.2.5.2. Veriﬁer Name Binding
1385   An authentication protocol with authenticator name binding SHALL establish
1386   an authenticated protected channel with the verifier. It SHALL then generate an

                                                   35
       NIST SP 800-63B-4 ipd                                               Digital Identity Guidelines
       December 2022                                        Authentication and Lifecycle Management


1387   authenticator output that is cryptographically bound to a verifier identifier that is
1388   authenticated as part of the protocol. In the case of domain name system (DNS)
1389   identifiers, the verifier identifier SHALL be either the authenticated hostname of the
1390   verifier or a parent domain that is at least one level below the public suffix [PSL]
1391   associated with that hostname. The binding MAY be established by choosing an
1392   associated authenticator secret, by deriving an authenticator secret using the verifier
1393   identifier, by cryptographically signing the authenticator output with the verifier identifier,
1394   or similar cryptographically secure means.

1395   5.2.6. Veriﬁer-CSP Communications
1396   In situations where the verifier and CSP are separate entities (as shown by the dotted line
1397   in [SP800-63] Figure 1), communications between the verifier and CSP SHALL occur
1398   through a mutually authenticated secure channel (such as a client-authenticated TLS
1399   connection) using approved cryptography.

1400   5.2.7. Veriﬁer Compromise Resistance
1401   Use of some types of authenticators requires that the verifier store a copy of the
1402   authenticator secret. For example, an OTP authenticator (described in Sec. 5.1.4) requires
1403   that the verifier independently generate the authenticator output for comparison against
1404   the value sent by the claimant. Because of the potential for the verifier to be compromised
1405   and stored secrets stolen, authentication protocols that do not require the verifier to
1406   persistently store secrets that could be used for authentication are considered stronger,
1407   and are described herein as being verifier compromise resistant. Note that such verifiers
1408   are not resistant to all attacks. A verifier could be compromised in a different way, such as
1409   being manipulated into always accepting a particular authenticator output.
1410   Verifier compromise resistance can be achieved in different ways, for example:
1411       • Use a cryptographic authenticator that requires the verifier store a public key
1412         corresponding to a private key held by the authenticator.
1413       • Store the expected authenticator output in hashed form. This method can be used
1414         with some look-up secret authenticators (described in Sec. 5.1.2), for example.
1415   To be considered verifier compromise resistant, public keys stored by the verifier SHALL
1416   be associated with the use of approved cryptographic algorithms and SHALL provide at
1417   least the minimum security strength specified in the latest revision of [SP800-131A] (112
1418   bits as of the date of this publication).
1419   Other verifier compromise resistant secrets SHALL use approved hash algorithms and
1420   the underlying secrets SHALL have at least the minimum security strength specified in
1421   the latest revision of [SP800-131A] (112 bits as of the date of this publication). Secrets
1422   (e.g., memorized secrets) having lower complexity SHALL NOT be considered verifier
1423   compromise resistant when hashed because of the potential to defeat the hashing process
1424   through dictionary lookup or exhaustive search.

                                                     36
       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management


1425   5.2.8. Replay Resistance
1426   An authentication process resists replay attacks if it is impractical to achieve a successful
1427   authentication by recording and replaying a previous authentication message. Replay
1428   resistance is in addition to the replay-resistant nature of authenticated protected channel
1429   protocols, since the output could be stolen prior to entry into the protected channel.
1430   Protocols that use nonces or challenges to prove the “freshness” of the transaction are
1431   resistant to replay attacks since the verifier will easily detect when old protocol messages
1432   are replayed since they will not contain the appropriate nonces or timeliness data.
1433   Examples of replay-resistant authenticators are OTP devices, cryptographic authenticators,
1434   and look-up secrets.
1435   In contrast, memorized secrets are not considered replay resistant because the
1436   authenticator output — the secret itself — is provided for each authentication.

1437   5.2.9. Authentication Intent
1438   An authentication process demonstrates intent if it requires the subject to explicitly
1439   respond to each authentication or reauthentication request. The goal of authentication
1440   intent is to make it more difficult for authenticators (e.g., multi-factor cryptographic
1441   devices) to be used without the subject’s knowledge, such as by malware on the endpoint.
1442   Authentication intent SHALL be established by the authenticator itself, although multi-
1443   factor cryptographic devices MAY establish intent by reentry of the activation factor for
1444   the authenticator.
1445   Authentication intent MAY be established in a number of ways. Authentication processes
1446   that require the subject’s intervention establish intent (e.g., a claimant entering an
1447   authenticator output from an OTP device). Cryptographic devices that require user action
1448   for each authentication or reauthentication operation also establish intent (e.g., pushing a
1449   button or reinsertion).
1450   Depending on the modality, presentation of a biometric characteristic may or may
1451   not establish authentication intent. Behavioral biometrics similarly may or may not
1452   establish authentication intent because they do not always require a specific action on
1453   the claimant’s part.

1454   5.2.10. Restricted Authenticators
1455   As threats evolve, authenticators’ capability to resist attacks typically degrades.
1456   Conversely, some authenticators’ performance may improve, for example, when changes
1457   to their underlying standards increases their ability to resist particular attacks.
1458   To account for these changes in authenticator performance, NIST places additional
1459   restrictions on authenticator types or specific classes or instantiations of an authenticator
1460   type.


                                                    37
       NIST SP 800-63B-4 ipd                                                Digital Identity Guidelines
       December 2022                                         Authentication and Lifecycle Management


1461   The use of a restricted authenticator requires that the implementing organization assess,
1462   understand, and accept the risks associated with that authenticator and acknowledge
1463   that risk will likely increase over time. It is the responsibility of the organization to
1464   determine the level of acceptable risk for their systems and associated data and to define
1465   any methods for mitigating excessive risks. If at any time the organization determines that
1466   the risk to any party is unacceptable, then that authenticator SHALL NOT be used.
1467   Further, the risk of an authentication error is typically borne by multiple parties, including
1468   the implementing organization, organizations that rely on the authentication decision,
1469   and the subscriber. Because the subscriber may be exposed to additional risk when an
1470   organization accepts a restricted authenticator and that the subscriber may have a limited
1471   understanding of and ability to control that risk, the CSP SHALL :
1472      1. Offer subscribers at least one alternate authenticator that is not restricted and can be
1473         used to authenticate at the required AAL.
1474      2. Provide meaningful notice to subscribers regarding the security risks of the
1475         restricted authenticator and availability of alternatives that are not restricted.
1476      3. Address any additional risk to subscribers in its risk assessment.
1477      4. Develop a migration plan for the possibility that the restricted authenticator is no
1478         longer acceptable at some point in the future and include this migration plan in its
1479         digital identity acceptance statement.

1480   5.2.11. Activation Secrets
1481   Memorized secrets that are used as an activation factor for a multi-factor authenticator
1482   are referred to as activation secrets. An activation secret is used to decrypt a stored secret
1483   key used for authentication or is compared against a locally held stored verifier to provide
1484   access to the authentication key. In either of these cases, the activation secret SHALL
1485   remain within the authenticator and its associated user endpoint.
1486   Authenticators making use of activation secrets SHALL require the secrets to be at
1487   least 6 characters in length. Activation secrets MAY be entirely numeric (i.e., a PIN).
1488   If alphanumeric (rather than only numeric) values are permitted, all printing ASCII
1489   [RFC20] characters as well as the space character SHOULD be accepted. Unicode
1490   [ISO/ISC 10646] characters SHOULD be accepted as well in alphanumeric secrets. The
1491   authenticator SHALL contain a blocklist (either specified by specific values or by an
1492   algorithm) of at least 10 commonly used activation values and SHALL prevent their use
1493   as activation secrets.
1494   The authenticator or verifier SHALL implement a retry-limiting mechanism that
1495   effectively limits the number of consecutive failed activation attempts using the
1496   authenticator to ten (10). If the entry of an incorrect activation secret causes the
1497   authenticator to generate an invalid output that is sent to the central verifier, rate


                                                     38
       NIST SP 800-63B-4 ipd                                                Digital Identity Guidelines
       December 2022                                         Authentication and Lifecycle Management


1498   limiting MAY be implemented by the verifier. In all other cases, rate limiting SHALL
1499   be implemented in the authenticator. Once the limit of 10 attempts is reached, the
1500   authenticator SHALL be disabled and a different authenticator SHALL be required for
1501   authentication.
1502   If the authenticator verifies the activation secret locally (rather than using it for decryption
1503   of a key), verification SHALL be performed within a hardware-based authenticator or
1504   in a secure element (e.g., TEE, TPM) that releases the authentication secret only upon
1505   presentation of the correct activation secret. In other circumstances (i.e., software-based
1506   multi-factor authenticators), the authenticator SHALL use the memorized secret as a key
1507   to decrypt its stored authentication secret. Approved cryptography SHALL be used.

1508   5.2.12. Connected Authenticators
1509   Cryptographic authenticators require a direct connection between the authenticator and
1510   the endpoint being authenticated. This connection MAY be wired (e.g., USB or direct
1511   connection with a smartcard) or wireless (e.g., NFC, Bluetooth). While in most cases
1512   wired connections can be presumed to be secure from eavesdropping and adversary-
1513   in-the-middle attacks, additional precautions are required for authenticators that are
1514   connected via wireless technologies.
1515   Wired authenticator connections include both authenticators that are embedded in
1516   endpoints (e.g., in a TPM) and those that are connected via an external interface, such as
1517   USB. Claimants SHOULD be advised to use trusted hardware (cables, etc.) for external
1518   connections for additional assurance that they have not been compromised.
1519   Wireless authenticator connections are potentially vulnerable to threats including
1520   eavesdropping, injection, and relay attacks. The potential for such attacks depends on
1521   the effective range of the wireless technology being used.
1522   Wireless technologies having an effective range of 1 meter or more (e.g., Bluetooth
1523   LE) SHALL use an authenticated encrypted connection between the authenticator
1524   and endpoint. A pairing process SHALL be used to establish a key for encrypted
1525   communication between the authenticator and endpoint. A temporary wired connection
1526   between the devices MAY also be used to establish the key in lieu of the pairing process.
1527   The pairing process SHALL be authenticated through the use of a pairing code. The
1528   pairing code SHALL be associated with either the authenticator or endpoint and SHALL
1529   have at least 20 bits or 6 decimal digits of entropy. The pairing code MAY be printed on
1530   the associated device and SHALL be conveyed between the devices by manual entry or
1531   by using a QR code or similar representation that is optically communicated. An example
1532   of this is the pairing code used with the virtual contact interface specified in [SP800-73].
1533   The entire authentication transaction SHALL be encrypted using a key established by the
1534   pairing process.
1535   When a wireless technology with an effective range of less than 1 meter is in use (e.g.,
1536   NFC), the activation secret, if any, transmitted from the endpoint to authenticator SHALL

                                                     39
       NIST SP 800-63B-4 ipd                                            Digital Identity Guidelines
       December 2022                                     Authentication and Lifecycle Management


1537   be encrypted using a key established through a pairing process between the devices or
1538   through a temporary wired connection. An authenticated connection using a pairing code
1539   meeting the above requirements SHOULD be used. If the authenticator is configured to
1540   require authenticated pairing, pairing code SHALL be used.
1541         Note: Encryption of only the activation secret, and not the entire
1542         authentication transaction, may expose sensitive information such as
1543         the identity of the relying party, although this would require the attacker
1544         to be very close to the subscriber. Special care should be taken with
1545         authenticators containing personally identifiable information that do not
1546         require authenticated pairing to protect that information against “skimming”
1547         and eavesdropping attacks.
1548   The key established as a result of the pairing process MAY be either temporary (valid
1549   for a limited number of transactions or time) or persistent. A mechanism for endpoints to
1550   remove persistent keys SHALL be provided.
1551   Where cryptographic operations are required, approved cryptography SHALL be used.
1552   All communication of authentication data between authenticators and endpoints SHALL
1553   occur directly between those devices or through an authenticated protected channel
1554   between the authenticator and endpoint.




                                                  40
       NIST SP 800-63B-4 ipd                                               Digital Identity Guidelines
       December 2022                                        Authentication and Lifecycle Management


1555   6.   Authenticator Lifecycle Management
1556   This section is normative.
1557   A number of events can occur over the lifecycle of a subscriber’s authenticator that
1558   affect that authenticator’s use. These events include binding, loss, theft, unauthorized
1559   duplication, expiration, and revocation. This section describes the actions to be taken in
1560   response to those events.

1561   6.1. Authenticator Binding
1562   Authenticator binding refers to the establishment of an association between a specific
1563   authenticator and a subscriber account, enabling the authenticator to be used — possibly
1564   in conjunction with other authenticators — to authenticate for that subscriber account.
1565   Authenticators SHALL be bound to subscriber accounts either
1566        • by issuance by the CSP as part of enrollment or
1567        • by registration of a subscriber-provided authenticator that is acceptable to the CSP.
1568   These guidelines refer to the binding rather than the issuance of an authenticator to
1569   accommodate both options.
1570   Throughout the digital identity lifecycle, CSPs SHALL maintain a record of all
1571   authenticators that are or have been associated with each subscriber account. The CSP or
1572   verifier SHALL maintain the information required for throttling authentication attempts
1573   when required, as described in Sec. 5.2.2. The CSP SHALL also verify the type of
1574   user-provided authenticator (e.g., single-factor cryptographic device vs. multi-factor
1575   cryptographic device) so verifiers can determine compliance with requirements at each
1576   AAL.
1577   The record created by the CSP SHALL contain the date and time the authenticator was
1578   bound to the subscriber account. The record SHOULD include information about the
1579   source of the binding (e.g., IP address, device identifier) of any device associated with the
1580   enrollment. If available, the record SHOULD also contain information about the source of
1581   unsuccessful authentications attempted with the authenticator.
1582   When any new authenticator is bound to a subscriber account, the CSP SHALL ensure
1583   that the binding protocol and the protocol for provisioning the associated keys are done
1584   at a level of security commensurate with the AAL at which the authenticator will be used.
1585   For example, protocols for key provisioning SHALL use authenticated protected channels
1586   or be performed in person to protect against adversary-in-the-middle attacks. Binding of
1587   multi-factor authenticators SHALL require multi-factor authentication or equivalent (e.g.,
1588   association with the session in which identity proofing has been just completed) be used
1589   in order to bind the authenticator. The same conditions apply when a key pair is generated
1590   by the authenticator and the public key is sent to the CSP.

                                                     41
       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management


1591   As part of the binding process, the CSP MAY require additional information about
1592   the new authenticator or the endpoint it is associated with to determine that they are
1593   suitable for the AAL being requested and to attempt to determine that the endpoint and
1594   authenticator are free from malware.

1595   6.1.1. Binding at Enrollment
1596   The following requirements apply when an authenticator is bound to a subscriber account
1597   as part of the enrollment process.
1598   The CSP SHALL bind at least one — and SHOULD bind at least two — physical
1599   (something you have) authenticators to the subscriber account, in addition to a
1600   memorized secret or one or more biometric characteristics. Binding of multiple
1601   authenticators provides a means to recover from the loss or theft of the subscriber’s
1602   primary authenticator. Preservation of online material or an online reputation makes it
1603   undesirable to lose control of a subscriber account due to the loss of an authenticator. The
1604   second authenticator makes it possible to securely recover from an authenticator loss.
1605   If enrollment and binding cannot be completed in a single physical encounter or
1606   electronic transaction (i.e., within a single protected session), the following methods
1607    SHALL be used to ensure that the same party acts as the applicant throughout the
1608   processes:
1609   For remote transactions:
1610      1. The applicant SHALL identify themselves in each new binding transaction
1611         by presenting a temporary secret which was either established during a prior
1612         transaction, or sent to the applicant’s phone number, email address, or postal
1613         address of record.
1614      2. Long-term authenticator secrets SHALL only be issued to the applicant within a
1615         protected session.
1616   For in-person transactions:
1617      1. The applicant SHALL identify themselves in person by either using a secret as
1618         described in remote transaction (1) above, or through use of a biometric that was
1619         recorded during a prior encounter.
1620      2. Temporary secrets SHALL NOT be reused.
1621      3. If the CSP issues long-term authenticator secrets during a physical transaction, then
1622         they SHALL be loaded locally onto a physical device that is issued in person to the
1623         applicant or delivered in a manner that confirms the address of record.




                                                   42
       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management


1624   6.1.2. Post-Enrollment Binding
1625   6.1.2.1. Binding of an Additional Authenticator at Existing AAL
1626   With the exception of memorized secrets, CSPs and verifiers SHOULD encourage
1627   subscribers to maintain at least two valid authenticators of each factor that they will
1628   be using. For example, a subscriber who usually uses an OTP device as a physical
1629   authenticator MAY also be issued a number of look-up secret authenticators, or register
1630   a device for out-of-band authentication, in case the physical authenticator is lost, stolen,
1631   or damaged. See Sec. 6.1.2.3 for more information on replacement of memorized secret
1632   authenticators.
1633   Accordingly, CSPs SHOULD permit the binding of additional authenticators to a
1634   subscriber account. Before adding the new authenticator, the CSP SHALL first
1635   require the subscriber to authenticate at the AAL (or a higher AAL) at which the new
1636   authenticator will be used. A separate authentication using existing authenticators
1637    SHALL be performed following the request to bind a new authenticator, and SHALL
1638   be valid for 20 minutes. When an authenticator is added, the CSP SHOULD send a
1639   notification to the subscriber via a mechanism that is independent of the transaction
1640   binding the new authenticator (e.g., email to an address previously associated with the
1641   subscriber). The CSP MAY limit the number of authenticators that are bound in this
1642   manner.

1643   6.1.2.2. Adding an Additional Factor to a Single-Factor Subscriber Account
1644   If the subscriber account has only one authentication factor bound to it and an additional
1645   authenticator of a different authentication factor is to be added, the subscriber MAY
1646   request that the subscriber account be upgraded to AAL2.
1647   Before binding the new authenticator, the CSP SHALL require the subscriber to
1648   authenticate at AAL1. The CSP SHOULD send a notification of the event to the
1649   subscriber via a mechanism independent of the transaction binding the new authenticator
1650   (e.g., email to an address previously associated with the subscriber).

1651   6.1.2.3. Account Recovery
1652   The situation where a subscriber loses control of authenticators necessary to successfully
1653   authenticate is commonly referred to as account recovery.
1654   If a subscriber that has been identity proofed loses all authenticators necessary to
1655   complete authentication, that subscriber SHALL repeat the identity proofing process
1656   described in [SP800-63A]. If the CSP has retained information from the evidence used in
1657   the original identity proofing process (pursuant to a privacy risk assessment as described
1658   in [SP800-63A] Sec. 5.2.2) that is sufficient to perform verification of the subscriber and
1659   if that evidence is still valid, it MAY repeat only the verification portion of the identity
1660   proofing process as described in [SP800-63A].


                                                    43
       NIST SP 800-63B-4 ipd                                               Digital Identity Guidelines
       December 2022                                        Authentication and Lifecycle Management


1661   The CSP SHALL require the claimant to authenticate using an authenticator of
1662   the remaining factor, if any, to confirm binding to the existing subscriber account.
1663   Reestablishment of authentication factors at IAL3 SHALL be done in person or through a
1664   supervised remote process as described in [SP800-63A] Sec. 5.6.8, and SHALL perform
1665   a successful biometric comparison against the biometric characteristic collected during
1666   the original identity proofing process.
1667   The CSP SHOULD send a notification of the event to the subscriber. This MAY be the
1668   same notice that is required as part of the identity proofing process.
1669   Subscriber accounts that have not been identity proofed (i.e., without IAL) cannot be
1670   recovered because there is no reliable means for reassociating the subscriber with that
1671   account. Such accounts SHALL be treated as abandoned and a new subscriber account
1672    SHALL be established.

1673   Replacement of a lost (i.e., forgotten) memorized secret is problematic because it is very
1674   common. Additional “backup” memorized secrets do not mitigate this because they are
1675   just as likely to also have been forgotten. If a biometric is bound to the subscriber account,
1676   the biometric characteristic and associated physical authenticator SHOULD be used to
1677   establish a new memorized secret.
1678   As an alternative to the above re-proofing process when there is no biometric bound to
1679   the subscriber account, the CSP MAY bind a new memorized secret with authentication
1680   using two physical authenticators, along with a confirmation code that has been sent to
1681   one of the subscriber’s addresses of record. The confirmation code SHALL consist of at
1682   least 6 random alphanumeric characters generated by an approved random bit generator
1683   [SP800-90Ar1]. Confirmation codes SHALL be valid for at most:
1684       • 21 days, when sent to a postal address of record within the contiguous United
1685         States;
1686       • 30 days, when sent to a postal address of record outside the contiguous United
1687         States;
1688       • 10 minutes, when sent to a telephone of record (SMS or voice); or
1689       • 24 hours, when sent to an email address of record.

1690   6.1.2.4. External Authenticator Binding
1691   External authenticator binding refers to the process of binding an authenticator to
1692   a subscriber account when it is not connected to (or embedded in) the authenticated
1693   endpoint. This process is typically used when adding authenticators that are embedded in
1694   a new endpoint, or when connectivity limitations prevent the newly bound authenticator
1695   from being connected to an authenticated endpoint.
1696   The binding process MAY begin with a request from an endpoint that has authenticated to
1697   the CSP obtaining a binding code from the CSP that is input into the endpoint associated

                                                    44
       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management


1698   with the new authenticator and sent to that CSP. Alternatively, the endpoint associated
1699   with the new authenticator MAY obtain a binding code from the CSP, which is input to an
1700   authenticated endpoint and sent to the CSP.
1701   In addition to the requirements given in Sec. 6.1.2.1, Sec. 6.1.2.2, and Sec. 6.1.2.3 above
1702   as applicable, the following requirements SHALL apply when binding an external
1703   authenticator:
1704       • An authenticated protected session SHALL be established by the endpoint
1705         associated with the new authenticator and the CSP.
1706       • The subscriber MAY be prompted to enter an identifier by which they are known
1707         by the CSP on the endpoint associated with the new authenticator.
1708       • The CSP SHALL generate a binding code using an approved random number
1709         generator and send it to either the new authenticator endpoint or the authenticated
1710         endpoint approving the binding. The binding code SHALL have at least 40 bits
1711         of entropy if used in conjunction with an identifier entered on the previous step;
1712         otherwise a binding code with at least 112 bits of entropy SHALL be required.
1713       • The subscriber SHALL transfer the binding code to the other endpoint. This
1714         transfer SHALL be either manual or via a local out-of-band method such as a QR
1715         code. The binding code SHALL NOT be communicated over any insecure channel
1716         such as email or PSTN (SMS or voice).
1717       • The binding code SHALL be usable only once and SHALL be valid for a
1718         maximum of 10 minutes.
1719       • Following the binding of the new authenticator (or issuance of a certificate, in the
1720         case of PKI-based authenticators), the CSP SHOULD encourage the subscriber to
1721         authenticate with the new authenticator to confirm that the process has completed
1722         successfully.
1723       • The CSP SHALL provide clear instruction on what the subscriber should do in the
1724         event of an authenticator binding mishap, such as a button or contact address to
1725         allow a mis-bound authenticator to be quickly invalidated as appropriate. This
1726          MAY be provided in the authenticated session or in the binding notification
1727         described in Sec. 6.1.2.1, Sec. 6.1.2.2, and Sec. 6.1.2.3 above.
1728   Binding an external authenticator is a potentially risky operation because of the potential
1729   for the subscriber to be tricked into using a binding code by an attacker or supplying a
1730   binding code to an attacker. In some cases, QR codes obtained from a trusted source (such
1731   as from an authenticated session, especially when that authentication is phishing resistant)
1732   are considered to be more robust against such attacks, because they typically contain the
1733   URL of the CSP as well as the binding code. There is less potential for the subscriber to
1734   be fooled into entering a binding code at a phishing site as a result.


                                                   45
       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management


1735   6.1.3. Binding to a Subscriber-provided Authenticator
1736   A subscriber may already possess authenticators suitable for authentication at a particular
1737   AAL. For example, they may have a two-factor authenticator from a social network
1738   provider, considered AAL2 and IAL1, and would like to use those credentials at an RP
1739   that requires IAL2.
1740   CSPs SHOULD , where practical, accommodate the use of subscriber-provided
1741   authenticators in order to relieve the burden to the subscriber of managing a large
1742   number of authenticators. Binding of these authenticators SHALL be done as described
1743   in Sec. 6.1.2. In situations where the authenticator strength is not self-evident (e.g.,
1744   between single-factor and multi-factor authenticators of a given type), the CSP SHALL
1745   assume the use of the weaker authenticator unless it is able to establish that the stronger
1746   authenticator is in fact being used (e.g., by verification with the issuer or manufacturer of
1747   the authenticator).

1748   6.1.4. Renewal
1749   The subscriber SHOULD bind a new or updated authenticator an appropriate amount of
1750   time before an existing authenticator’s expiration. The process for this SHOULD conform
1751   closely to the binding process for an additional authenticator described in Sec. 6.1.2.1.
1752   The CSP MAY periodically take other actions, such as reconfirming address of record,
1753   either as a part of the renewal process or separately. Following successful use of the
1754   replacement authenticator, the CSP MAY invalidate the authenticator that is expiring.

1755   6.2. Loss, Theft, Damage, and Unauthorized Duplication
1756   Compromised authenticators include those that have been lost, stolen, or subject
1757   to unauthorized duplication. Generally, one must assume that a lost authenticator
1758   has been stolen or compromised by someone that is not the legitimate subscriber of
1759   the authenticator. Damaged or malfunctioning authenticators are also considered
1760   compromised to guard against any possibility of extraction of the authenticator secret.
1761   One notable exception is a memorized secret that has been forgotten without other
1762   indications of having been compromised, such as having been obtained by an attacker.
1763   Suspension, revocation, or destruction of compromised authenticators SHOULD occur as
1764   promptly as practical following detection. Organizations SHOULD establish time limits
1765   for this process.
1766   To facilitate secure reporting of the loss, theft, or damage to an authenticator, the
1767   CSP SHOULD provide the subscriber with a method of authenticating to the CSP
1768   using a backup or alternate authenticator. This backup authenticator SHALL be either
1769   a memorized secret or a physical authenticator. Either could be used, but only one
1770   authentication factor is required to make this report. Alternatively, the subscriber MAY
1771   establish an authenticated protected channel to the CSP and verify information collected
1772   during the proofing process. The CSP MAY choose to verify an address of record (i.e.,

                                                    46
       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management


1773   email, telephone, postal) and suspend authenticators reported to have been compromised.
1774   The suspension SHALL be reversible if the subscriber successfully authenticates to the
1775   CSP using a valid (i.e., not suspended) authenticator and requests reactivation of an
1776   authenticator suspended in this manner. The CSP MAY set a time limit after which a
1777   suspended authenticator can no longer be reactivated.

1778   6.3. Expiration
1779   CSPs MAY issue authenticators that expire. If and when an authenticator expires, it
1780    SHALL NOT be usable for authentication. When an authentication is attempted using
1781   an expired authenticator, the CSP SHOULD give an indication to the subscriber that the
1782   authentication failure is due to expiration rather than some other cause.
1783   The CSP SHALL require subscribers to surrender or prove destruction of any physical
1784   authenticator containing attribute certificates signed by the CSP as soon as practical after
1785   expiration or receipt of a renewed authenticator.

1786   6.4. Invalidation
1787   Invalidation of an authenticator (sometimes referred to as revocation or termination) refers
1788   to removal of the binding between an authenticator and a subscriber account.
1789   CSPs SHALL invalidate authenticators promptly when a subscriber account ceases to
1790   exist (e.g., subscriber’s death, discovery of a fraudulent subscriber), when requested
1791   by the subscriber, or when the CSP determines that the subscriber no longer meets its
1792   eligibility requirements.
1793   The CSP SHALL require subscribers to surrender or certify destruction of any physical
1794   authenticator containing subscriber attributes, such as certificates signed by the CSP, as
1795   soon as practical after invalidation takes place. This is necessary to protect the privacy
1796   of the subscriber and to block the use of any certificates in offline situations between
1797   invalidation and expiration of the certificates.
1798   Further requirements on the invalidation of PIV authenticators are found in [FIPS201].




                                                   47
       NIST SP 800-63B-4 ipd                                                Digital Identity Guidelines
       December 2022                                         Authentication and Lifecycle Management


1799   7.   Session Management
1800   This section is normative.
1801   Once an authentication event has taken place, it is often desirable to allow the subscriber
1802   to continue using the application across multiple subsequent interactions without
1803   requiring them to repeat the authentication event. This requirement is particularly true
1804   for federation scenarios — described in [SP800-63C] — where the authentication event
1805   necessarily involves several components and parties coordinating across a network.
1806   To facilitate this behavior, a session MAY be started in response to an authentication
1807   event, and continue the session until such time that it is terminated. The session MAY be
1808   terminated for any number of reasons, including but not limited to an inactivity timeout,
1809   an explicit logout event, or other means. The session MAY be continued through a
1810   reauthentication event — described in Sec. 7.2 — wherein the subscriber repeats some or
1811   all of the initial authentication event, thereby re-establishing the session.
1812   Session management is preferable over continual presentation of credentials as the poor
1813   usability of continual presentation often creates incentives for workarounds such as
1814   caching of activation factors, negating authentication intent and obscuring the freshness of
1815   the authentication event.

1816   7.1. Session Bindings
1817   A session occurs between the software that a subscriber is running — such as a browser,
1818   application, or operating system (i.e., the session subject) — and the RP or CSP that
1819   the subscriber is accessing (i.e., the session host). A session secret SHALL be shared
1820   between the subscriber’s software and the service being accessed. This secret binds the
1821   two ends of the session, allowing the subscriber to continue using the service over time.
1822   The secret SHALL be presented directly by the subscriber’s software or possession of the
1823   secret SHALL be proven using a cryptographic mechanism.
1824   Continuity of authenticated sessions SHALL be based upon the possession of a session
1825   secret issued by the verifier at the time of authentication and optionally refreshed during
1826   the session. The nature of a session depends on the application, such as:
1827        • a web browser session with a “session” cookie, or
1828        • an instance of a mobile application that retains a session secret.
1829   Session secrets SHALL NOT be persistent (retained across a restart of the associated
1830   application or a reboot of the host device).
1831   The secret used for session binding SHALL be generated by the session host in direct
1832   response to an authentication event. A session SHOULD inherit the AAL properties of
1833   the authentication event which triggered its creation. A session MAY be considered at a


                                                     48
       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management


1834   lower AAL than the authentication event but SHALL NOT be considered at a higher AAL
1835   than the authentication event.
1836   Secrets used for session binding SHALL meet all of the following requirements:
1837      1. Secrets are generated by the session host during an interaction, typically
1838         immediately following authentication.
1839      2. Secrets are generated by an approved random bit generator [SP800-90Ar1] and
1840         contain at least 64 bits of entropy.
1841      3. Secrets are erased or invalidated by the session subject when the subscriber logs
1842         out.
1843      4. Secrets are sent to and received from the device using an authenticated protected
1844         channel.
1845      5. Secrets will time out and are not accepted after the times specified in Sections 4.1.3,
1846         4.2.3, and 4.3.3, as appropriate for the AAL.
1847      6. Secrets are not made available to insecure communications between the host and
1848         subscriber’s endpoint.
1849   In addition, secrets used for session binding SHOULD be erased on the subscriber
1850   endpoint when they log out or when the secret is deemed to have expired. They
1851    SHOULD NOT be placed in insecure locations such as HTML5 Local Storage due to
1852   the potential exposure of local storage to cross-site scripting (XSS) attacks.
1853   Authenticated sessions SHALL NOT fall back to an insecure transport, such as from https
1854   to http, following authentication.
1855   URLs or POST content SHALL contain a session identifier that SHALL be verified by
1856   the RP to protect against cross-site request forgery.
1857   There are several mechanisms for managing a session over time. The following sections
1858   give different examples along with additional requirements and considerations particular
1859   to each example technology. Additional informative guidance is available in the OWASP
1860   Session Management Cheat Sheet [OWASP-session].

1861   7.1.1. Browser Cookies
1862   Browser cookies are the predominant mechanism by which a session will be created and
1863   tracked for a subscriber accessing a service. Cookies are not authenticators, but they are
1864   suitable as short-term secrets (for the duration of a session).
1865   Cookies used for session maintenance SHALL meet all of the following requirements:
1866      1. Cookies are tagged to be accessible only on secure (HTTPS) sessions.
1867      2. Cookies are accessible to the minimum practical set of hostnames and paths.

                                                    49
       NIST SP 800-63B-4 ipd                                               Digital Identity Guidelines
       December 2022                                        Authentication and Lifecycle Management


1868   In addition, session maintenance cookies SHOULD be tagged to be inaccessible via
1869   JavaScript (HttpOnly). They SHOULD contain only an opaque string (such as a session
1870   identifier), and SHOULD NOT contain cleartext PII. They SHOULD be tagged to expire
1871   at, or soon after, the session’s validity period. This latter requirement is intended to limit
1872   the accumulation of cookies, but SHALL NOT be depended upon to enforce session
1873   timeouts.

1874   7.1.2. Access Tokens
1875   An access token — such as found in OAuth — is used to allow an application to access a
1876   set of services on a subscriber’s behalf following an authentication event. The presence
1877   of an OAuth access token SHALL NOT be interpreted by the RP as presence of the
1878   subscriber, in the absence of other signals. The OAuth access token, and any associated
1879   refresh tokens, MAY be valid long after the authentication session has ended and the
1880   subscriber has left the application.

1881   7.1.3. Device Identiﬁcation
1882   Other methods of secure device identification — including but not limited to mutual
1883   TLS, token binding, or other mechanisms — MAY be used to enact a session between a
1884   subscriber and a service.

1885   7.2. Reauthentication
1886   Periodic reauthentication of sessions SHALL be performed to confirm the continued
1887   presence of the subscriber at an authenticated session (i.e., that the subscriber has not
1888   walked away without logging out).
1889   A session SHALL NOT be extended past the guidelines in Sections 4.1.3, 4.2.3, and
1890   4.3.3 (depending on AAL) based on presentation of the session secret alone. Prior to
1891   session expiration, the reauthentication time limit SHALL be extended by prompting the
1892   subscriber for the authentication factors specified in Table 2.
1893   When a session has been terminated, due to a time-out or other action, the subscriber
1894   SHALL be required to establish a new session by authenticating again.

                               Table 2. AAL Reauthentication Requirements

                        AAL      Requirement
                        1        Presentation of any one factor
                        2        Presentation of a memorized secret or biometric
                        3        Presentation of all factors

1895         Note: At AAL2, a memorized secret or biometric, and not a physical
1896         authenticator, is required because the session secret is something you have,
1897         and an additional authentication factor is required to continue the session.

                                                    50
       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management


1898   7.2.1. Reauthentication from a Federation or Assertion
1899   When using a federation protocol and Identity Provider (IdP) to authenticate at the RP
1900   as described in [SP800-63C], special considerations apply to session management and
1901   reauthentication. The federation protocol communicates an authentication event at the IdP
1902   to the RP using an assertion, and the RP then begins an authenticated session based on the
1903   successful validation of this assertion. Since the IdP and RP manage sessions separately
1904   from each other and the federation protocol does not connect the session management
1905   between the IdP and RP, the termination of the subscriber’s sessions at an IdP and at an
1906   RP are independent of each other. Likewise, the subscriber’s sessions at multiple different
1907   RPs are established and terminated independently of each other.
1908   Consequently, when an RP session expires and the RP requires reauthentication, it is
1909   entirely possible that the session at the IdP has not expired and that a new assertion could
1910   be generated from this session at the IdP without explicitly reauthenticating the subscriber.
1911   The IdP can communicate the time and details of the authentication event to the RP, but
1912   it is up to the RP to determine if reauthentication requirements have been met. Section
1913   5.3 of [SP800-63C] provides additional details and requirements for session management
1914   within a federation context.




                                                    51
       NIST SP 800-63B-4 ipd                                                Digital Identity Guidelines
       December 2022                                         Authentication and Lifecycle Management


1915   8.   Threats and Security Considerations
1916   This section is informative.

1917   8.1. Authenticator Threats
1918   An attacker who can gain control of an authenticator will often be able to masquerade as
1919   the authenticator’s owner. Threats to authenticators can be categorized based on attacks
1920   on the types of authentication factors that comprise the authenticator:
1921        • Something you know may be disclosed to an attacker. The attacker might guess
1922          a memorized secret. Where the authenticator is a shared secret, the attacker
1923          could gain access to the CSP or verifier and obtain the secret value or perform a
1924          dictionary attack on a hash of that value. An attacker may observe the entry of
1925          a PIN or passcode, find a written record or journal entry of a PIN or passcode,
1926          or may install malicious software (e.g., a keyboard logger) to capture the secret.
1927          Additionally, an attacker may determine the secret through offline attacks on a
1928          password database maintained by the verifier.
1929        • Something you have may be lost, damaged, stolen from the owner, or cloned by an
1930          attacker. For example, an attacker who gains access to the owner’s computer might
1931          copy a software authenticator. A hardware authenticator might be stolen, tampered
1932          with, or duplicated. Out-of-band secrets may be intercepted by an attacker and used
1933          to authenticate their own session.
1934        • Something you are may be replicated. For example, an attacker may obtain a copy
1935          of the subscriber’s fingerprint and construct a replica.
1936   This document assumes that the subscriber is not colluding with an attacker who is
1937   attempting to falsely authenticate to the verifier. With this assumption in mind, the threats
1938   to the authenticators used for digital authentication are listed in Table 3, along with some
1939   examples.
1940                                  Table 3. Authenticator Threats

         Authenticator         Description                        Examples
         Threat/Attack
         Assertion             The attacker generates a false     Compromised CSP asserts
         Manufacture           assertion                          identity of a claimant who has
         or Modification                                          not properly authenticated
                               The attacker modifies an           Compromised proxy
                               existing assertion                 that changes AAL of an
                                                                  authentication assertion
         Theft                 A physical authenticator is        A hardware cryptographic
                               stolen by an Attacker.             device is stolen.
                                                                  An OTP device is stolen.

                                                    52
NIST SP 800-63B-4 ipd                                             Digital Identity Guidelines
December 2022                                      Authentication and Lifecycle Management



                                                         A look-up secret authenticator
                                                         is stolen.
                                                         A cell phone is stolen.
 Duplication            The subscriber’s authenticator   Passwords written on paper are
                        has been copied with or          disclosed.
                        without their knowledge.
                                                          Passwords stored in an
                                                          electronic file are copied.
                                                          Software PKI authenticator
                                                          (private key) copied.
                                                          Look-up secret authenticator
                                                          copied.
                                                          Counterfeit biometric
                                                          authenticator manufactured.
 Eavesdropping          The authenticator secret or       Memorized secrets are
                        authenticator output is revealed obtained by watching keyboard
                        to the attacker as the subscriber entry.
                        is authenticating.
                                                          Memorized secrets or
                                                          authenticator outputs are
                                                          intercepted by keystroke
                                                          logging software.
                                                          A PIN is captured from a PIN
                                                          pad device.
                                                          A hashed password is obtained
                                                          and used by an attacker for
                                                          another authentication (pass-
                                                          the-hash attack).
                        An out-of-band secret is          An out-of-band secret is
                        intercepted by the attacker       transmitted via unencrypted
                        by compromising the               Wi-Fi and received by the
                        communication channel.            attacker.
 Offline                The authenticator is exposed      A software PKI authenticator
 Cracking               using analytical methods          is subjected to dictionary
                        outside the authentication        attack to identify the correct
                        mechanism.                        password to use to decrypt the
                                                          private key.
 Side Channel           The authenticator secret          A key is extracted by
 Attack                 is exposed using physical         differential power analysis
                        characteristics of the            on a hardware cryptographic
                        authenticator.                    authenticator.


                                            53
NIST SP 800-63B-4 ipd                                                  Digital Identity Guidelines
December 2022                                           Authentication and Lifecycle Management



                                                             A cryptographic authenticator
                                                             secret is extracted by analysis
                                                             of the response time of the
                                                             authenticator over a number of
                                                             attempts.
 Phishing or            The authenticator output             A password is revealed
 Pharming               is captured by fooling the           by subscriber to a website
                        subscriber into thinking the         impersonating the verifier.
                        attacker is a verifier or RP.
                                                             A memorized secret is revealed
                                                             by a bank subscriber in
                                                             response to an email inquiry
                                                             from a phisher pretending to
                                                             represent the bank.
                                                             A memorized secret is revealed
                                                             by the subscriber at a bogus
                                                             verifier website reached
                                                             through DNS spoofing.
 Social                 The attacker establishes a           A memorized secret is
 Engineering            level of trust with a subscriber     revealed by the subscriber
                        in order to convince the             to an officemate asking for
                        subscriber to reveal their           the password on behalf of the
                        authenticator secret or              subscriber’s boss.
                        authenticator output.
                                                             A memorized secret is revealed
                                                             by a subscriber in a telephone
                                                             inquiry from an attacker
                                                             masquerading as a system
                                                             administrator.
                                                             An out of band secret sent
                                                             via SMS is received by an
                                                             attacker who has convinced
                                                             the mobile operator to redirect
                                                             the victim’s mobile phone to
                                                             the attacker.
 Online Guessing        The attacker connects to the         Online dictionary attacks are
                        verifier online and attempts         used to guess memorized
                        to guess a valid authenticator       secrets.
                        output in the context of that
                        verifier.



                                              54
       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management



                                                                 Online guessing is used to
                                                                 guess authenticator outputs for
                                                                 an OTP device registered to a
                                                                 legitimate claimant.
        Endpoint               Malicious code on the endpoint    A cryptographic authenticator
        Compromise             proxies remote access to          connected to the endpoint is
                               a connected authenticator         used to authenticate remote
                               without the subscriber’s          attackers.
                               consent.
                               Malicious code on the endpoint    Authentication is performed
                               causes authentication to other    on behalf of an attacker rather
                               than the intended verifier.       than the subscriber.
                                                                 A malicious app on the
                                                                 endpoint reads an out-of-band
                                                                 secret sent via SMS and the
                                                                 attacker uses the secret to
                                                                 authenticate.
                               Malicious code on the endpoint    Malicious code proxies
                               compromises a multi-factor        authentication or exports
                               software cryptographic            authenticator keys from the
                               authenticator.                    endpoint.
        Unauthorized           An attacker is able to cause      An attacker intercepts an
        Binding                an authenticator under their      authenticator or provisioning
                               control to be bound to a          key en route to the subscriber.
                               subscriber account.


1941   8.2. Threat Mitigation Strategies
1942   Related mechanisms that assist in mitigating the threats identified above are summarized
1943   in Table 4.
1944                            Table 4. Mitigating Authenticator Threats

        Authenticator          Threat Mitigation                 Normative References
        Threat/Attack          Mechanisms
        Theft                  Use multi-factor authenticators   4.2.1, 4.3.1
                               that need to be activated
                               through a memorized secret
                               or biometric.
                               Use a combination of              4.2.1, 4.3.1
                               authenticators that includes a
                               memorized secret or biometric.

                                                    55
NIST SP 800-63B-4 ipd                                               Digital Identity Guidelines
December 2022                                        Authentication and Lifecycle Management



 Duplication            Use authenticators from            4.2.2, 4.3.2, 5.1.7.1
                        which it is difficult to extract
                        and duplicate long-term
                        authentication secrets.
 Eavesdropping          Ensure the security of the         4.2.2
                        endpoint, especially with
                        respect to freedom from
                        malware such as key loggers,
                        prior to use.
                        Avoid use of unauthenticated       5.1.3.1
                        and unencrypted
                        communication channels to
                        send out-of-band authenticator
                        secrets.
                        Authenticate over                  4.1.2, 4.2.2, 4.3.2
                        authenticated protected
                        channels (e.g., observe lock
                        icon in browser window).
                        Use authentication protocols       5.2.8
                        that are resistant to replay
                        attacks such as pass-the-hash.
                        Use authentication endpoints       5.1.6.1, 5.1.8.1
                        that employ trusted input and
                        trusted display capabilities.
 Offline                Use an authenticator with a        5.1.2.1, 5.1.4.1, 5.1.5.1, 5.1.7.1,
 Cracking               high entropy authenticator         5.1.9.1
                        secret.
                        Store centrally verified           5.1.1.1.2, 5.2.7
                        memorized secrets in a salted,
                        hashed form, including a keyed
                        hash.
 Side Channel           Use authenticator algorithms       4.3.2
 Attack                 that are designed to maintain
                        constant power consumption
                        and timing regardless of secret
                        values.
 Phishing or            Use authenticators that provide    5.2.5
 Pharming               phishing resistance.




                                             56
       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management



        Social                 Avoid use of authenticators       6.1.2.1, 6.1.2.3
        Engineering            that present a risk of social
                               engineering of third parties
                               such as customer service
                               agents.
        Online Guessing        Use authenticators that           5.1.2.1, 5.1.7.1, 5.1.9.1
                               generate high entropy output.
                               Use an authenticator that locks   5.2.2
                               up after a number of repeated
                               failed activation attempts.
        Endpoint               Use hardware authenticators       5.2.9
        Compromise             that require physical action by
                               the subscriber.
                               Maintain software-based keys      5.1.3.1, 5.1.6.1, 5.1.8.1
                               in restricted-access storage.
        Unauthorized           Use AitM-resistant                6.1
        Binding                protocols for provisioning of
                               authenticators and associated
                               keys.

1945   Several other strategies may be applied to mitigate the threats described in Table 3:
1946       • Multiple factors make successful attacks more difficult to accomplish. If an attacker
1947         needs to both steal a cryptographic authenticator and guess a memorized secret,
1948         then the work to discover both factors may be too high.
1949       • Physical security mechanisms may be employed to protect a stolen authenticator
1950         from duplication. Physical security mechanisms can provide tamper evidence,
1951         detection, and response.
1952       • Requiring the use of long memorized secrets that don’t appear in common
1953         dictionaries may force attackers to try every possible value.
1954       • System and network security controls may be employed to prevent an attacker from
1955         gaining access to a system or installing malicious software.
1956       • Periodic training may be performed to ensure subscribers understand when
1957         and how to report compromise — or suspicion of compromise — or otherwise
1958         recognize patterns of behavior that may signify an attacker attempting to
1959         compromise the authentication process.
1960       • Out of band techniques may be employed to verify proof of possession of registered
1961         devices (e.g., cell phones).



                                                    57
       NIST SP 800-63B-4 ipd                                                Digital Identity Guidelines
       December 2022                                         Authentication and Lifecycle Management


1962   8.3. Authenticator Recovery
1963   The weak point in many authentication mechanisms is the process followed when a
1964   subscriber loses control of one or more authenticators and needs to replace them. In many
1965   cases, the options remaining available to authenticate the subscriber are limited, and
1966   economic concerns (e.g., cost of maintaining call centers) motivate the use of inexpensive,
1967   and often less secure, backup authentication methods. To the extent that authenticator
1968   recovery is human-assisted, there is also the risk of social engineering attacks.
1969   To maintain the integrity of the authentication factors, it is essential that it not be possible
1970   to leverage an authentication involving one factor to obtain an authenticator of a different
1971   factor. For example, a memorized secret must not be usable to obtain a new list of look-up
1972   secrets.

1973   8.4. Session Attacks
1974   The above discussion focuses on threats to the authentication event itself, but hijacking
1975   attacks on the session following an authentication event can have similar security impacts.
1976   The session management guidelines in Sec. 7 are essential to maintain session integrity
1977   against attacks, such as XSS. In addition, it is important to sanitize all information to be
1978   displayed [OWASP-XSS-prevention] to ensure that it does not contain executable content.
1979   These guidelines also recommend that session secrets be made inaccessible to mobile
1980   code in order to provide extra protection against exfiltration of session secrets.
1981   Another post-authentication threat, cross-site request forgery (CSRF), takes advantage of
1982   users’ tendency to have multiple sessions active at the same time. It is important to embed
1983   and verify a session identifier into web requests to prevent the ability for a valid URL or
1984   request to be unintentionally or maliciously activated.




                                                     58
       NIST SP 800-63B-4 ipd                                               Digital Identity Guidelines
       December 2022                                        Authentication and Lifecycle Management


1985   9.    Privacy Considerations
1986   These privacy considerations supplement the guidance in Sec. 4. This section is
1987   informative.

1988   9.1. Privacy Risk Assessment
1989   Sections 4.1.5, 4.2.5, and 4.3.5 require the CSP to conduct a privacy risk assessment for
1990   records retention. Such a privacy risk assessment would include:
1991        1. The likelihood that the records retention could create a problem for the subscriber,
1992           such as invasiveness or unauthorized access to the information.
1993        2. The impact if such a problem did occur.
1994   CSPs should be able to reasonably justify any response they take to identified privacy
1995   risks, including accepting the risk, mitigating the risk, and sharing the risk. The use of
1996   subscriber consent is a form of sharing the risk, and therefore appropriate for use only
1997   when a subscriber could reasonably be expected to have the capacity to assess and accept
1998   the shared risk.

1999   9.2. Privacy Controls
2000   Section 4.4 requires CSPs to employ appropriately tailored privacy controls. [SP800-53]
2001   provides a set of privacy controls for CSPs to consider when deploying authentication
2002   mechanisms. These controls cover notices, redress, and other important considerations for
2003   successful and trustworthy deployments.

2004   9.3. Use Limitation
2005   Section 4.4 requires CSPs to use measures to maintain the objectives of predictability
2006   (enabling reliable assumptions by individuals, owners, and operators about PII and its
2007   processing by an information system) and manageability (providing the capability for
2008   granular administration of PII, including alteration, deletion, and selective disclosure)
2009   commensurate with privacy risks that can arise from the processing of attributes for
2010   purposes other than identity proofing, authentication, authorization, or attribute assertion,
2011   related fraud mitigation, or to comply with law or legal process [NISTIR8062].
2012   CSPs may have various business purposes for processing attributes, including providing
2013   non-identity services to subscribers. However, processing attributes for other purposes
2014   than those specified at collection can create privacy risks when individuals are not
2015   expecting or comfortable with the additional processing. CSPs can determine appropriate
2016   measures commensurate with the privacy risk arising from the additional processing.
2017   For example, absent applicable law, regulation or policy, it may not be necessary to
2018   get consent when processing attributes to provide non-identity services requested by
2019   subscribers, although notices may help subscribers maintain reliable assumptions about


                                                     59
       NIST SP 800-63B-4 ipd                                             Digital Identity Guidelines
       December 2022                                      Authentication and Lifecycle Management


2020   the processing (predictability). Other processing of attributes may carry different privacy
2021   risks that call for obtaining consent or allowing subscribers more control over the use
2022   or disclosure of specific attributes (manageability). Subscriber consent needs to be
2023   meaningful; therefore, as stated in Sec. 4.4, when CSPs use consent measures, acceptance
2024   by the subscriber of additional uses shall not be a condition of providing authentication
2025   services.
2026   Consult the agency SAOP if there are questions about whether the proposed processing
2027   falls outside the scope of the permitted processing or the appropriate privacy risk
2028   mitigation measures.

2029   9.4. Agency-Speciﬁc Privacy Compliance
2030   Section 4.4 covers specific compliance obligations for federal CSPs. It is critical
2031   to involve the agency SAOP in the earliest stages of digital authentication system
2032   development in order to assess and mitigate privacy risks and advise the agency on
2033   compliance requirements, such as whether or not the collection of PII to issue or maintain
2034   authenticators triggers the Privacy Act of 1974 [PrivacyAct] or the E-Government Act
2035   of 2002 [E-Gov] requirement to conduct a PIA. For example, with respect to centralized
2036   maintenance of biometrics, it is likely that the Privacy Act requirements will be triggered
2037   and require coverage by either a new or existing Privacy Act system of records due to the
2038   collection and maintenance of PII and any other attributes necessary for authentication.
2039   The SAOP can similarly assist the agency in determining whether a PIA is required.
2040   These considerations should not be read as a requirement to develop a Privacy Act SORN
2041   or PIA for authentication alone. In many cases it will make the most sense to draft a
2042   PIA and SORN that encompasses the entire digital identity process or include the digital
2043   authentication process as part of a larger programmatic PIA that discusses the online
2044   service or benefit that the agency is establishing.
2045   Due to the many components of digital authentication, it is important for the SAOP to
2046   have an awareness and understanding of each individual component. For example, other
2047   privacy artifacts may be applicable to an agency offering or using federated CSP or RP
2048   services (e.g., Data Use Agreements, Computer Matching Agreements). The SAOP
2049   can assist the agency in determining what additional requirements apply. Moreover, a
2050   thorough understanding of the individual components of digital authentication will enable
2051   the SAOP to thoroughly assess and mitigate privacy risks either through compliance
2052   processes or by other means.




                                                   60
       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management


2053   10.   Usability Considerations
2054   This section is informative.
2055         Note: In this section, the term users means claimants or subscribers.
2056   [ISO/IEC9241-11] defines usability as the “extent to which a system, product, or service
2057   can be used by specified users to achieve specified goals with effectiveness, efficiency
2058   and satisfaction in a specified context of use.” This definition focuses on users, their
2059   goals, and the context of use as key elements necessary for achieving effectiveness,
2060   efficiency, and satisfaction. A holistic approach that accounts for these key elements
2061   is necessary to achieve usability.
2062   A user’s goal for accessing an information system is to perform an intended task.
2063   Authentication is the function that enables this goal. However, from the user’s perspective,
2064   authentication stands between them and their intended task. Effective design and
2065   implementation of authentication makes it easy to do the right thing, hard to do the wrong
2066   thing, and easy to recover when the wrong thing happens.
2067   Organizations need to be cognizant of the overall implications of their stakeholders’ entire
2068   digital authentication ecosystem. Users often employ multiple authenticators, each for
2069   a different RP. They then struggle to remember passwords, to recall which authenticator
2070   goes with which RP, and to carry multiple physical authentication devices. Evaluating the
2071   usability of authentication is critical, as poor usability often results in coping mechanisms
2072   and unintended workarounds that can ultimately degrade the effectiveness of security
2073   controls.
2074   Integrating usability into the development process can lead to authentication solutions that
2075   are secure and usable while still addressing users’ authentication needs and organizations’
2076   business goals.
2077   The impact of usability across digital systems needs to be considered as part of the
2078   risk assessment when deciding on the appropriate AAL. Authenticators with a higher
2079   AAL sometimes offer better usability and should be allowed for use with lower AAL
2080   applications.
2081   Leveraging federation for authentication can alleviate many of the usability issues, though
2082   such an approach has its own tradeoffs, as discussed in [SP800-63C].
2083   This section provides general usability considerations and possible implementations, but
2084   does not recommend specific solutions. The implementations mentioned are examples
2085   to encourage innovative technological approaches to address specific usability needs.
2086   Further, usability considerations and their implementations are sensitive to many factors
2087   that prevent a one-size-fits-all solution. For example, a font size that works in the
2088   desktop computing environment may force text to scroll off of a small OTP device screen.
2089   Performing a usability evaluation on the selected authenticator is a critical component of

                                                    61
       NIST SP 800-63B-4 ipd                                               Digital Identity Guidelines
       December 2022                                        Authentication and Lifecycle Management


2090   implementation. It is important to conduct evaluations with representative users, realistic
2091   goals and tasks, and appropriate contexts of use.
2092   Guidelines and considerations are described from the users’ perspective.
2093   Accessibility differs from usability and is out of scope for this document. Section 508
2094   [Section508] was enacted to eliminate barriers in information technology and require
2095   federal government agencies to make their online public content accessible to people with
2096   disabilities. Refer to Section 508 law and standards for accessibility guidance.

2097   10.1. Usability Considerations Common to Authenticators
2098   When selecting and implementing an authentication system, consider usability across the
2099   entire lifecycle of the selected authenticators (e.g., typical use and intermittent events),
2100   while being mindful of the combination of users, their goals, and context of use.
2101   A single authenticator type usually does not suffice for the entire user population.
2102   Therefore, whenever possible — based on AAL requirements — CSPs should support
2103   alternative authenticator types and allow users to choose based on their needs. Task
2104   immediacy, perceived cost benefit tradeoffs, and unfamiliarity with certain authenticators
2105   often impact choice. Users tend to choose options that incur the least burden or cost at
2106   that moment. For example, if a task requires immediate access to an information system,
2107   a user may prefer to create a new subscriber account and password rather than select an
2108   authenticator requiring more steps. Alternatively, users may choose a federated identity
2109   option — approved at the appropriate AAL — if they already have a subscriber account
2110   with an identity provider. Users may understand some authenticators better than others,
2111   and have different levels of trust based on their understanding and experience.
2112   Positive user authentication experiences are integral to the success of an organization
2113   achieving desired business outcomes. Therefore, they should strive to consider
2114   authenticators from the users’ perspective. The overarching authentication usability goal
2115   is to minimize user burden and authentication friction (e.g., the number of times a user
2116   has to authenticate, the steps involved, and the amount of information they have to track).
2117   Single sign-on exemplifies one such minimization strategy.
2118   Usability considerations applicable to most authenticators are described below.
2119   Subsequent sections describe usability considerations specific to a particular
2120   authenticator.
2121   Usability considerations for typical usage of all authenticators include:
2122       • Provide information on the use and maintenance of the authenticator, e.g., what to
2123         do if the authenticator is lost or stolen, and instructions for use — especially if there
2124         are different requirements for first-time use or initialization.



                                                     62
       NIST SP 800-63B-4 ipd                                             Digital Identity Guidelines
       December 2022                                      Authentication and Lifecycle Management


2125      • Authenticator availability should also be considered as users will need to remember
2126        to have their authenticator readily available. Consider the need for alternate
2127        authentication options to protect against loss, damage, or other negative impacts
2128        to the original authenticator.
2129      • Whenever possible, based on AAL requirements, users should be provided with
2130        alternate authentication options. This allows users to choose an authenticator based
2131        on their context, goals, and tasks (e.g., the frequency and immediacy of the task).
2132        Alternate authentication options also help address availability issues that may occur
2133        with a particular authenticator.
2134      • Characteristics of user-facing text:
2135           – Write user-facing text (e.g., instructions, prompts, notifications, error
2136             messages) in plain language for the intended audience. Avoid technical jargon
2137             and write for the audience’s expected literacy level.
2138           – Consider the legibility of user-facing and user-entered text, including font
2139             style, size, color, and contrast with surrounding background. Illegible text
2140             contributes to user entry errors. To enhance legibility, consider the use of:
2141               * High contrast. The highest contrast is black on white.
2142               * Sans serif fonts for electronic displays. Serif fonts for printed materials.
2143               * Fonts that clearly distinguish between easily confusable characters (e.g.,
2144                 the capital letter “O” and the number “0”).
2145               * A minimum font size of 12 points as long as the text fits for display on
2146                 the device.
2147      • User experience during authenticator entry:
2148           – Offer the option to display text during entry, as masked text entry is error-
2149             prone. Once a given character is displayed long enough for the user to see, it
2150             can be hidden. Consider the device when determining masking delay time, as
2151             it takes longer to enter memorized secrets on mobile devices (e.g., tablets and
2152             smartphones) than on traditional desktop computers. Ensure masking delay
2153             durations are consistent with user needs.
2154           – Ensure the time allowed for text entry is adequate (i.e., the entry screen does
2155             not time out prematurely). Ensure allowed text entry times are consistent with
2156             user needs.
2157           – Provide clear, meaningful and actionable feedback on entry errors to reduce
2158             user confusion and frustration. Significant usability implications arise when
2159             users do not know they have entered text incorrectly.



                                                   63
       NIST SP 800-63B-4 ipd                                                Digital Identity Guidelines
       December 2022                                         Authentication and Lifecycle Management


2160            – Allow at least 10 entry attempts for authenticators requiring the entry of the
2161              authenticator output by the user. The longer and more complex the entry text,
2162              the greater the likelihood of user entry errors.
2163            – Provide clear, meaningful feedback on the number of remaining allowed
2164              attempts. For rate limiting (i.e., throttling), inform users how long they have to
2165              wait until the next attempt to reduce confusion and frustration.
2166       • Minimize the impact of form-factor constraints, such as limited touch and display
2167         areas on mobile devices:
2168            – Larger touch areas improve usability for text entry since typing on small
2169              devices is significantly more error prone and time consuming than typing
2170              on a full-size keyboard. The smaller the onscreen keyboard, the more difficult
2171              it is to type, due to the size of the input mechanism (e.g., a finger) relative to
2172              the size of the on-screen target.
2173            – Follow good user interface and information design for small displays.
2174   Intermittent events include events such as reauthentication, subscriber account lock-out,
2175   expiration, revocation, damage, loss, theft, and non-functional software.
2176   Usability considerations for intermittent events across authenticator types include:
2177       • To prevent users from needing to reauthenticate due to user inactivity, prompt users
2178         in order to trigger activity just before (e.g., 2 minutes) an inactivity timeout would
2179         otherwise occur.
2180       • Prompt users with adequate time (e.g., 1 hour) to save their work before the fixed
2181         periodic reauthentication event required regardless of user activity.
2182       • Clearly communicate how and where to acquire technical assistance. For example,
2183         provide users with information such as a link to an online self-service feature, chat
2184         sessions or a phone number for help desk support. Ideally, sufficient information
2185         can be provided to enable users to recover from intermittent events on their own
2186         without outside intervention.

2187   10.2. Usability Considerations by Authenticator Type
2188   In addition to the previously described general usability considerations applicable to most
2189   authenticators (Sec. 10.1), the following sections describe other usability considerations
2190   specific to particular authenticator types.

2191   10.2.1. Memorized Secrets
2192   Typical Usage
2193   Users manually input the memorized secret (commonly referred to as a password or PIN).
2194   Usability considerations for typical usage include:

                                                    64
       NIST SP 800-63B-4 ipd                                                Digital Identity Guidelines
       December 2022                                         Authentication and Lifecycle Management


2195       • Memorability of the memorized secret
2196            – The likelihood of recall failure increases as there are more items for users to
2197              remember. With fewer memorized secrets, users can more easily recall the
2198              specific memorized secret needed for a particular RP.
2199            – The memory burden is greater for a less frequently used password.
2200       • User experience during entry of the memorized secret
2201            – Support copy and paste functionality in fields for entering memorized secrets,
2202              including passphrases.
2203   Intermittent Events
2204   Usability considerations for intermittent events include:
2205       • When users create and change memorized secrets:
2206            – Clearly communicate information on how to create and change memorized
2207              secrets.
2208            – Clearly communicate memorized secret requirements, as specified in
2209              Sec. 5.1.1.
2210            – Allow at least 64 characters in length to support the use of passphrases.
2211              Encourage users to make memorized secrets as lengthy as they want, using
2212              any characters they like (including spaces), thus aiding memorization.
2213            – Do not impose other composition rules (e.g. mixtures of different character
2214              types) on memorized secrets.
2215            – Do not require that memorized secrets be changed arbitrarily (e.g.,
2216              periodically) unless there is a user request or evidence of authenticator
2217              compromise. (See Sec. 5.1.1 for additional information).
2218       • Provide clear, meaningful and actionable feedback when chosen passwords are
2219         rejected (e.g., when it appears on a “blocklist” of unacceptable passwords or has
2220         been used previously).

2221   10.2.2. Look-Up Secrets
2222   Typical Usage
2223   Users use the authenticator — printed or electronic — to look up the appropriate secret(s)
2224   needed to respond to a verifier’s prompt. For example, a user may be asked to provide a
2225   specific subset of the numeric or character strings printed on a card in table format.
2226   Usability considerations for typical usage include:
2227       • User experience during entry of look-up secrets.

                                                    65
       NIST SP 800-63B-4 ipd                                                Digital Identity Guidelines
       December 2022                                         Authentication and Lifecycle Management


2228            – Consider the prompts’ complexity and size. The larger the subset of secrets
2229              a user is prompted to look up, the greater the usability implications. Both
2230              the cognitive workload and physical difficulty for entry should be taken into
2231              account when selecting the quantity and complexity of look-up secrets for
2232              authentication.

2233   10.2.3. Out-of-Band
2234   Typical Usage
2235   Out-of-band authentication requires users have access to a primary and secondary
2236   communication channel.
2237   Usability considerations for typical usage:
2238       • Notify users of the receipt of a secret on a locked device. However, if the out-of-
2239         band device is locked, authentication to the device should be required to access the
2240         secret.
2241       • Depending on the implementation, consider form-factor constraints as they are
2242         particularly problematic when users must enter text on mobile devices. Providing
2243         larger touch areas will improve usability for entering secrets on mobile devices.
2244       • A better usability option is to offer features that do not require text entry on mobile
2245         devices (e.g., a single tap on the screen, or a copy feature so users can copy and
2246         paste out-of-band secrets). Providing users such features is particularly helpful
2247         when the primary and secondary channels are on the same device. For example, it
2248         is difficult for users to transfer the authentication secret on a smartphone because
2249         they must switch back and forth — potentially multiple times — between the out-
2250         of-band application and the primary channel.

2251   10.2.4. Single-Factor OTP Device
2252   Typical Usage
2253   Users access the OTP generated by the single-factor OTP device. The authenticator
2254   output is typically displayed on the device and the user enters it for the verifier.
2255   Usability considerations for typical usage include:
2256       • Authenticator output allows at least one minute between changes, but ideally allows
2257         users the full two minutes as specified in Sec. 5.1.4.1. Users need adequate time
2258         to enter the authenticator output (including looking back and forth between the
2259         single-factor OTP device and the entry screen).
2260       • Depending on the implementation, the following are additional usability
2261         considerations for implementers:


                                                     66
       NIST SP 800-63B-4 ipd                                                Digital Identity Guidelines
       December 2022                                         Authentication and Lifecycle Management


2262            – If the single-factor OTP device supplies its output via an electronic interface
2263              (e.g, USB) this is preferable since users do not have to manually enter the
2264              authenticator output. However, if a physical input (e.g., pressing a button)
2265              is required to operate, the location of the USB ports could pose usability
2266              difficulties. For example, the USB ports of some computers are located on
2267              the back of the computer and will be difficult for users to reach.
2268            – Limited availability of a direct computer interface such as a USB port could
2269              pose usability difficulties. For example, the number of USB ports on laptop
2270              computers is often very limited. This may force users to unplug other USB
2271              peripherals in order to use the single-factor OTP device.

2272   10.2.5. Multi-Factor OTP Device
2273   Typical Usage
2274   Users access the OTP generated by the multi-factor OTP device through a second
2275   authentication factor. The OTP is typically displayed on the device and the user manually
2276   enters it for the verifier. The second authentication factor may be achieved through
2277   some kind of integral entry pad to enter a memorized secret, an integral biometric
2278   (e.g., fingerprint) reader, or a direct computer interface (e.g., USB port). Usability
2279   considerations for the additional factor apply as well — see Sec. 10.2.1 for memorized
2280   secrets and Sec. 10.4 for biometrics used in multi-factor authenticators.
2281   Usability considerations for typical usage include:
2282       • User experience during manual entry of the authenticator output.
2283            – For time-based OTP, provide a grace period in addition to the time during
2284              which the OTP is displayed. Users need adequate time to enter the
2285              authenticator output, including looking back and forth between the multi-
2286              factor OTP device and the entry screen.
2287            – Consider form-factor constraints if users must unlock the multi-factor OTP
2288              device via an integral entry pad or enter the authenticator output on mobile
2289              devices. Typing on small devices is significantly more error prone and time-
2290              consuming than typing on a traditional keyboard. The smaller the integral
2291              entry pad and onscreen keyboard, the more difficult it is to type. Providing
2292              larger touch areas improves usability for unlocking the multi-factor OTP
2293              device or entering the authenticator output on mobile devices.
2294            – Limited availability of a direct computer interface like a USB port could pose
2295              usability difficulties. For example, laptop computers often have a limited
2296              number of USB ports, which may force users to unplug other USB peripherals
2297              to use the multi-factor OTP device.



                                                   67
       NIST SP 800-63B-4 ipd                                                Digital Identity Guidelines
       December 2022                                         Authentication and Lifecycle Management


2298   10.2.6. Single-Factor Cryptographic Software
2299   Typical Usage
2300   Users authenticate by proving possession and control of the cryptographic software key.
2301   Usability considerations for typical usage include:
2302       • Give cryptographic keys appropriately descriptive names that are meaningful to
2303         users since users have to recognize and recall which cryptographic key to use for
2304         which authentication task. This prevents users from having to deal with multiple
2305         similarly and ambiguously named cryptographic keys. Selecting from multiple
2306         cryptographic keys on smaller mobile devices may be particularly problematic if
2307         the names of the cryptographic keys are shortened due to reduced screen size.

2308   10.2.7. Single-Factor Cryptographic Device
2309   Typical Usage
2310   Users authenticate by proving possession of the single-factor cryptographic device.
2311   Usability considerations for typical usage include:
2312       • Requiring a physical input (e.g., pressing a button) to operate the single-factor
2313         cryptographic device could pose usability difficulties. For example, some USB
2314         ports are located on the back of computers, making it difficult for users to reach.
2315       • Limited availability of a direct computer interface like a USB port could pose
2316         usability difficulties. For example, laptop computers often have a limited number
2317         of USB ports, which may force users to unplug other USB peripherals to use the
2318         single-factor cryptographic device.

2319   10.2.8. Multi-Factor Cryptographic Software
2320   Typical Usage
2321 In order to authenticate, users prove possession and control of the cryptographic key
2322 stored on disk or some other “soft” media that requires activation. The activation is
2323 through the input of a second authentication factor, either a memorized secret or a
2324 biometric characteristic. Usability considerations for the additional factor apply as well
2325 — see Sec. 10.2.1 for memorized secrets and Sec. 10.4 for biometrics used in multi-factor

2326 authenticators.
2327   Usability considerations for typical usage include:
2328       • Give cryptographic keys appropriately descriptive names that are meaningful to
2329         users since users have to recognize and recall which cryptographic key to use for
2330         which authentication task. This prevents users from having to deal with multiple
2331         similarly and ambiguously named cryptographic keys. Selecting from multiple

                                                    68
       NIST SP 800-63B-4 ipd                                                Digital Identity Guidelines
       December 2022                                         Authentication and Lifecycle Management


2332         cryptographic keys on smaller mobile devices may be particularly problematic if
2333         the names of the cryptographic keys areas shortened due to reduced screen size.

2334   10.2.9. Multi-Factor Cryptographic Device
2335   Typical Usage
2336   Users authenticate by proving possession of the multi-factor cryptographic device
2337   and control of the protected cryptographic key. The device is activated by a second
2338   authentication factor, either a memorized secret or a biometric. Usability considerations
2339   for the additional factor apply as well — see Sec. 10.2.1 for memorized secrets and
2340   Sec. 10.4 for biometrics used in multi-factor authenticators.
2341   Usability considerations for typical usage include:
2342       • Do not require users to keep multi-factor cryptographic devices connected
2343         following authentication. Users may forget to disconnect the multi-factor
2344         cryptographic device when they are done with it (e.g., forgetting a smartcard in
2345         the smartcard reader and walking away from the computer).
2346            – Users need to be informed regarding whether the multi-factor cryptographic
2347              device is required to stay connected or not.
2348       • Give cryptographic keys appropriately descriptive names that are meaningful to
2349         users since users have to recognize and recall which cryptographic key to use
2350         for which authentication task. This prevents users being faced with multiple
2351         similarly and ambiguously named cryptographic keys. Selecting from multiple
2352         cryptographic keys on smaller mobile devices (such as smartphones) may be
2353         particularly problematic if the names of the cryptographic keys are shortened due to
2354         reduced screen size.
2355       • Limited availability of a direct computer interface like a USB port could pose
2356         usability difficulties. For example, laptop computers often have a limited number
2357         of USB ports, which may force users to unplug other USB peripherals to use the
2358         multi-factor cryptographic device.

2359   10.3. Summary of Usability Considerations
2360   Figure 3 summarizes the usability considerations for typical usage and intermittent
2361   events for each authenticator type. Many of the usability considerations for typical
2362   usage apply to most of the authenticator types, as demonstrated in the rows. The table
2363   highlights common and divergent usability characteristics across the authenticator types.
2364   Each column allows readers to easily identify the usability attributes to address for each
2365   authenticator. Depending on users’ goals and context of use, certain attributes may be
2366   valued over others. Whenever possible, provide alternative authenticator types and allow
2367   users to choose between them.


                                                   69
       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management


2368   Multi-factor authenticators (e.g., multi-factor OTP devices, multi-factor cryptographic
2369   software, and multi-factor cryptographic devices) also inherit their secondary factor’s
2370   usability considerations. As biometrics are only allowed as an activation factor in multi-
2371   factor authentication solutions, usability considerations for biometrics are not included in
2372   Figure 3 and are discussed in Sec. 10.4.




                                                   70
NIST SP 800-63B-4 ipd                                            Digital Identity Guidelines
December 2022                                     Authentication and Lifecycle Management




            Figure 3. Usability Considerations Summary by Authenticator Type



                                          71
       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management


2373   10.4. Biometrics Usability Considerations
2374   This section provides a high-level overview of general usability considerations for
2375   biometrics. A more detailed discussion of biometric usability can be found in Usability &
2376   Biometrics, Ensuring Successful Biometric Systems [UsabilityBiometrics].
2377   Although there are other biometric modalities, the following three biometric modalities
2378   are more commonly used for authentication: fingerprint, face and iris.
2379   Typical Usage
2380       • For all modalities, user familiarity and practice with the device improves
2381         performance.
2382       • Device affordances (i.e., properties of a device that allow a user to perform an
2383         action), feedback, and clear instructions are critical to a user’s success with the
2384         biometric device. For example, provide clear instructions on the required actions for
2385         liveness detection.
2386       • Ideally, users can select the modality they are most comfortable with for their
2387         second authentication factor. The user population may be more comfortable and
2388         familiar with — and accepting of — some biometric modalities than others.
2389       • User experience with biometrics as an activation factor.
2390            – Provide clear, meaningful feedback on the number of remaining allowed
2391              attempts. For example, for rate limiting (i.e., throttling), inform users of the
2392              time period they have to wait until next attempt to reduce user confusion and
2393              frustration.
2394       • Fingerprint Usability Considerations:
2395            – Users have to remember which finger(s) they used for initial enrollment.
2396            – The amount of moisture on the finger(s) affects the sensor’s ability for
2397              successful capture.
2398            – Additional factors influencing fingerprint capture quality include age, gender,
2399              and occupation (e.g., users handling chemicals or working extensively with
2400              their hands may have degraded friction ridges).
2401       • Face Usability Considerations:
2402            – Users have to remember whether they wore any artifacts (e.g., glasses) during
2403              enrollment because it affects facial recognition accuracy.
2404            – Differences in environmental lighting conditions can affect facial recognition
2405              accuracy.
2406            – Facial expressions affect facial recognition accuracy (e.g., smiling versus
2407              neutral expression).

                                                     72
       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management


2408            – Facial poses affect facial recognition accuracy (e.g., looking down or away
2409              from the camera).
2410       • Iris Usability Considerations:
2411            – Wearing colored contacts may affect the iris recognition accuracy.
2412            – Users who have had eye surgery may need to re-enroll post-surgery.
2413            – Differences in environmental lighting conditions can affect iris recognition
2414              accuracy, especially for certain iris colors.
2415   Intermittent Events
2416   As biometrics are only permitted as a second factor for multi-factor authentication,
2417   usability considerations for intermittent events with the primary factor still apply.
2418   Intermittent events with biometrics use include, but are not limited to, the following,
2419   which may affect recognition accuracy:
2420       • If users injure their enrolled finger(s), fingerprint recognition may not work.
2421         Fingerprint authentication will be difficult for users with degraded fingerprints.
2422       • The time elapsed between the time of facial recognition for authentication and
2423         the time of the initial enrollment can affect recognition accuracy as a user’s face
2424         changes naturally over time. A user’s weight change may also be a factor.
2425       • Iris recognition may not work for people who had eye surgery, unless they re-enroll.
2426   Across all biometric modalities, usability considerations for intermittent events include:
2427       • An alternative authentication method must be available and functioning. In
2428         cases where biometrics do not work, allow users to use a memorized secret as an
2429         alternative second factor.
2430       • Provisions for technical assistance:
2431            – Clearly communicate information on how and where to acquire technical
2432              assistance. For example, provide users information such as a link to an
2433              online self-service feature and a phone number for help desk support. Ideally,
2434              provide sufficient information to enable users to recover from intermittent
2435              events on their own without outside intervention.
2436            – Inform users of factors that may affect the sensitivity of the biometric sensor
2437              (e.g., cleanliness of the sensor).




                                                    73
       NIST SP 800-63B-4 ipd                                                Digital Identity Guidelines
       December 2022                                         Authentication and Lifecycle Management


2438   11.     Equity Considerations
2439   This section is informative.
2440   Accurate and equitable authentication service is an essential element of a digital
2441   identity system. While the accuracy aspects of authentication are largely the subject
2442   of the security requirements found elsewhere in this document, the ability for all
2443   subscribers to authenticate reliably is required to provide equitable access to government
2444   services as specified in Executive Order 13985, “Advancing Racial Equity and Support
2445   for Underserved Communities Through the Federal Government” [EO13985]. In
2446   assessing equity risks, a CSP should consider the overall user population served by its
2447   authentication service. Additionally, the CSP further identifies groups of users within
2448   the population whose shared characteristic(s) can cause them to be subject to inequitable
2449   access, treatment, or outcomes when using that service. The usability considerations
2450   provided in Sec. 10 should also be considered to help ensure the overall usability and
2451   equity for all persons using authentication services.
2452   A primary aspect of equity is that the CSP needs to anticipate the needs of its subscriber
2453   population and offer authenticator options that are suitable for that population. Some
2454   examples of authenticator suitability problems are as follows:
2455         • SMS-based out-of-band authentication may not be usable for subscribers in rural
2456           areas where mobile phone service is not available.
2457         • OTP devices may be difficult for subscribers with vision difficulties to read.
2458         • Out-of-band authentication secrets sent via a voice telephone call may be difficult
2459           for subscribers with hearing difficulties to understand.
2460         • Facial matching algorithms may less effectively match facial characteristics of
2461           subscribers of some ethnicities.
2462         • The cost of hardware-based authenticators may be beyond the means of some
2463           subscribers.
2464         • Accurate manual entry of memorized secrets may be difficult for subscribers with
2465           some mobility and dexterity-related physical disabilities.
2466         • The use of certain authenticator types may be challenging for subscribers with
2467           some disabilities such as intellectual, developmental, learning, and neurocognitive
2468           difficulties.
2469   Normative requirements have been established requiring CSPs to mitigate the problems
2470   in this area that are expected to be most common. However, it is not feasible to anticipate
2471   all potential equity problems. Potential equity problems also will vary for different
2472   applications. Accordingly, CSPs need to provide mechanisms for subscribers to report
2473   inequitable authentication requirements and to advise them on potential alternative
2474   authentication strategies.

                                                     74
       NIST SP 800-63B-4 ipd                                             Digital Identity Guidelines
       December 2022                                      Authentication and Lifecycle Management


2475   This guideline recommends the binding of additional authenticators to minimize the
2476   need for account recovery (see Sec. 6.1.2.3). However, a subscriber might find it difficult
2477   to purchase a second hardware-based authenticator as a backup. This inequity can be
2478   addressed by making inexpensive authenticators such as look-up secrets (see Sec. 5.1.2)
2479   available for use in the event of a primary authenticator failure or loss.
2480   CSPs need to be responsive to subscribers that experience authentication challenges
2481   that cannot be solved using authenticators they currently support. This might involve
2482   supporting a new authenticator type or allowing federated authentication through a trusted
2483   service that meets the needs of the subscriber.




                                                   75
       NIST SP 800-63B-4 ipd                                            Digital Identity Guidelines
       December 2022                                     Authentication and Lifecycle Management


2484   References
2485   This section is informative.

2486   General References
2487   [Argon2] Biryukov, A., Dinu, D., Khovratovich, D., and S. Josefsson, “Argon2 Memory-
2488   Hard Function for Password Hashing and Proof-of-Work Applications“, RFC 9106, DOI
2489   10.17487/RFC9106, September 2021, https://www.rfc-editor.org/info/rfc9106.
2490   [Blocklists] Habib, Hana, Jessica Colnago, William Melicher, Blase Ur, Sean Segreti,
2491   Lujo Bauer, Nicolas Christin, and Lorrie Cranor. “Password Creation in the Presence of
2492   Blacklists,” 2017. Available at: https://www.ndss-symposium.org/wp-content/uploads/
2493   2017/09/usec2017 01 3 Habib paper.pdf
2494   [Composition] Komanduri, Saranga, Richard Shay, Patrick Gage Kelley, Michelle L
2495   Mazurek, Lujo Bauer, Nicolas Christin, Lorrie Faith Cranor, and Serge Egelman. “Of
2496   Passwords and People: Measuring the Effect of Password-Composition Policies.” In
2497   Proceedings of the SIGCHI Conference on Human Factors in Computing Systems,
2498   2595–2604. ACM, 2011. Available at: https://www.ece.cmu.edu/∼lbauer/papers/2011/
2499   chi2011-passwords.pdf.
2500   [E-Gov] E-Government Act (includes FISMA) (P.L. 107-347), December 2002,
2501   available at: https://www.gpo.gov/fdsys/pkg/PLAW-107publ347/pdf/PLAW-107publ347.
2502   pdf.
2503   [EO13681] Executive Order 13681, Improving the Security of Consumer Financial
2504   Transactions, October 17, 2014, available at: https://www.federalregister.gov/d/2014-
2505   25439.
2506   [EO13985] Executive Order 13985, Advancing Racial Equity and Support for
2507   Underserved Communities Through the Federal Government, January 25, 2021, available
2508   at: https://www.federalregister.gov/d/2021-01753.
2509   [FEDRAMP] General Services Administration, Federal Risk and Authorization
2510   Management Program, available at: https://www.fedramp.gov/.
2511   [M-22-09] OMB Memorandum M-22-09, Moving the U.S. Government Toward Zero
2512   Trust Cybersecurity Principles, January 26, 2022, available at: https://www.whitehouse.
2513   gov/wp-content/uploads/2022/01/M-22-09.pdf.
2514   [NISTIR8062] NIST Internal Report 8062, An Introduction to Privacy Engineering and
2515   Risk Management in Federal Systems, January 2017, available at: https://nvlpubs.nist.gov/
2516   nistpubs/ir/2017/NIST.IR.8062.pdf.
2517   [UsabilityBiometrics] National Institute and Standards and Technology, Usability
2518   & Biometrics, Ensuring Successful Biometric Systems, June 11, 2008, available at:

                                                  76
       NIST SP 800-63B-4 ipd                                                Digital Identity Guidelines
       December 2022                                         Authentication and Lifecycle Management


2519   https://www.nist.gov/customcf/get pdf.cfm?pub id=152184.
2520   [OWASP-session] Open Web Application Security Project, Session Management Cheat
2521   Sheet, available at: https://www.owasp.org/index.php/Session Management Cheat Sheet.
2522   [OWASP-XSS-prevention] Open Web Application Security Project, XSS (Cross Site
2523   Scripting) Prevention Cheat Sheet, available at: https://www.owasp.org/index.php/
2524   XSS (Cross Site Scripting) Prevention Cheat Sheet.
2525   [Persistence] herley, cormac, and Paul van Oorschot. “A Research Agenda
2526   Acknowledging the Persistence of Passwords,” IEEE Security&Privacy Magazine, 2012.
2527   Available at: https://research.microsoft.com/apps/pubs/default.aspx?id=154077.
2528   [Policies] Weir, Matt, Sudhir Aggarwal, Michael Collins, and Henry Stern. “Testing
2529   Metrics for Password Creation Policies by Attacking Large Sets of Revealed Passwords.”
2530   In Proceedings of the 17th ACM Conference on Computer and Communications Security,
2531   162–175. CCS ‘10. New York, NY, USA: ACM, 2010. doi:10.1145/1866307.1866327.
2532   [PrivacyAct] Privacy Act of 1974 (P.L. 93-579), December 1974, available at: https:
2533   //www.justice.gov/opcl/privacy-act-1974.
2534   [PSL] Public Suffix List https://publicsuffix.org/list/
2535   [Scrypt] Percival, C. and S. Josefsson, The scrypt Password-Based Key Derivation
2536   Function, RFC 7914, DOI 10.17487/RFC7914, August 2016, https://www.rfc-editor.
2537   org/info/rfc7914.
2538   [Section508] Section 508 Law and Related Laws and Policies (January 30, 2017),
2539   available at: https://www.section508.gov/manage/laws-and-policies/.
2540   [Shannon] Shannon, Claude E. “A Mathematical Theory of Communication,” Bell
2541   System Technical Journal, v. 27, pp. 379-423, 623-656, July, October, 1948.
2542   [Strength] Kelley, Patrick Gage, Saranga Komanduri, Michelle L Mazurek, Richard
2543   Shay, Timothy Vidas, Lujo Bauer, Nicolas Christin, Lorrie Faith Cranor, and Julio Lopez.
2544   “Guess Again (and Again and Again): Measuring Password Strength by Simulating
2545   Password-Cracking Algorithms.” In Security and Privacy (SP), 2012 IEEE Symposium
2546   On, 523–537. IEEE, 2012. Available at: https://ieeexplore.ieee.org/iel5/6233637/
2547   6234400/06234434.pdf.
2548   [TOTP] M’Raihi, D., Machani, S., Pei, M., and J. Rydell, TOTP: Time-Based One-Time
2549   Password Algorithm, RFC 6238, DOI 10.17487/RFC6238, May 2011, https://www.rfc-
2550   editor.org/info/rfc6238.




                                                     77
       NIST SP 800-63B-4 ipd                                             Digital Identity Guidelines
       December 2022                                      Authentication and Lifecycle Management


2551   Standards
2552   [ISO/IEC9241-11] International Standards Organization, ISO/IEC 9241-11 Ergonomic
2553   requirements for office work with visual display terminals (VDTs) — Part 11: Guidance
2554   on usability, March 1998, available at: https://www.iso.org/standard/16883.html.
2555   [ISO/IEC2382-37] International Standards Organization, Information technology —
2556   Vocabulary — Part 37: Biometrics, 2017, available at: https://standards.iso.org/ittf/
2557   PubliclyAvailableStandards/c066693 ISO IEC 2382-37 2017.zip.
2558   [ISO/IEC10646] International Standards Organization, Information technology —
2559   Universal coded character set (UCS), 2020, available at: https://www.iso.org/standard/
2560   76835.html.
2561   [ISO/IEC24745] International Standards Organization, Information technology —
2562   Security techniques — Biometric information protection, 2011, available at: https:
2563   //www.iso.org/iso/iso catalogue/catalogue tc/catalogue detail.htm?csnumber=52946.
2564   [ISO/IEC30107-1] International Standards Organization, Information technology —
2565   Biometric presentation attack detection — Part 1: Framework, 2016, available at: https:
2566   //standards.iso.org/ittf/PubliclyAvailableStandards/c053227 ISO IEC 30107-1 2016.zip.
2567   [ISO/IEC30107-3] International Standards Organization, Information technology —
2568   Biometric presentation attack detection — Part 3: Testing and reporting, 2017.
2569   [RFC20] Cerf, V., “ASCII format for network interchange“, STD 80, RFC 20, DOI
2570   10.17487/RFC0020, October 1969, https://www.rfc-editor.org/info/rfc20.
2571   [UAX15] Unicode Consortium, Unicode Normalization Forms, Unicode Standard Annex
2572   15, Version 9.0.0, February 2016, available at: https://www.unicode.org/reports/tr15/.

2573   NIST Special Publications
2574   NIST 800 Series Special Publications are available at https://csrc.nist.gov/publications/
2575   sp800. The following publications may be of particular interest to those implementing
2576   systems of applications requiring digital authentication.

2577   [SP800-38B] NIST Special Publication 800-38B, Recommendation for Block Cipher
2578   Modes of Operation: the CMAC Mode for Authentication, October, 2016, https://dx.doi.
2579   org/10.6028/NIST.SP.800-38B.

2580   [SP800-53] NIST Special Publication 800-53 Revision 5, Security and Privacy Controls
2581   for Information Systems and Organizations, September 2020 (updated December 10,
2582   2020), https://dx.doi.org/10.6028/NIST.SP.800-53r5.

2583   [SP800-63] NIST Special Publication 800-63-4, Digital Identity Guidelines, December
2584   2022, https://doi.org/10.6028/NIST.SP.800-63-4.ipd.

2585   [SP800-63A] NIST Special Publication 800-63B-4, Digital Identity Guidelines:

                                                   78
       NIST SP 800-63B-4 ipd                                           Digital Identity Guidelines
       December 2022                                    Authentication and Lifecycle Management


2586   Enrollment and Identity Proofing, December 2022, https://doi.org/10.6028/
2587   NIST.SP.800-63a-4.ipd.
2588   [SP800-63C] NIST Special Publication 800-63C-4, Digital Identity Guidelines:
2589   Assertions and Federation, November 2022, https://doi.org/10.6028/
2590   NIST.SP.800-63c-4.ipd.
2591   [SP800-73] NIST Special Publication 800-73-4, Interfaces for Personal Identity
2592   Verification, February 2016, https://doi.org/10.6028/NIST.SP.800-73-4.
2593   [SP800-90A] NIST Special Publication 800-90A Revision 1, Recommendation for
2594   Random Number Generation Using Deterministic Random Bit Generators, June 2015,
2595   https://dx.doi.org/10.6028/NIST.SP.800-90Ar1.
2596   [SP800-107] NIST Special Publication 800-107 Revision 1, Recommendation for
2597   Applications Using Approved Hash Algorithms, August 2012, https://dx.doi.org/10.6028/
2598   NIST.SP.800-107r1.
2599   [SP800-131A] NIST Special Publication 800-131A Revision 2, Transitioning the Use of
2600   Cryptographic Algorithms and Key Lengths, March 2019, https://dx.doi.org/10.6028/
2601   NIST.SP.800-131Ar2

2602   [SP800-132] NIST Special Publication 800-132, Recommendation for Password-Based
2603   Key Derivation, December 2010, https://dx.doi.org/10.6028/NIST.SP.800-132.

2604   [SP800-185] NIST Special Publication 800-185, SHA-3 Derived Functions: cSHAKE,
2605   KMAC, TupleHash, and ParallelHash, December 2016, https://doi.org/10.6028/
2606   NIST.SP. 800-185.

2607   Federal Information Processing Standards
2608   [FIPS140] Federal Information Processing Standard Publication 140-3, Security
2609   Requirements for Cryptographic Modules, March 22, 2019, https://doi.org/10.6028/
2610   NIST. FIPS.140-3.

2611   [FIPS198] Federal Information Processing Standard Publication 198-1, The Keyed-Hash
2612   Message Authentication Code (HMAC), July 2008, https://doi.org/10.6028/NIST.FIPS.
2613   198-1.

2614   [FIPS201] Federal Information Processing Standard Publication 201-3, Personal Identity
2615   Verification (PIV) of Federal Employees and Contractors, January 2022, https: //
2616   dx.doi.org/10.6028/NIST.FIPS.201-3.

2617   [FIPS202] Federal Information Processing Standard Publication 202, SHA-3 Standard:
2618   Permutation-Based Hash and Extendable-Output Functions, August 2015, https://dx.doi.
2619   org/10.6028/NIST.FIPS.202.



                                                 79
       NIST SP 800-63B-4 ipd                                            Digital Identity Guidelines
       December 2022                                     Authentication and Lifecycle Management


2620   Appendix A.      Strength of Memorized Secrets
2621   This appendix is informative.
2622   Throughout this appendix, the word “password” is used for ease of discussion. Where
2623   used, it should be interpreted to include passphrases and PINs as well as passwords.

2624   A.1. Introduction
2625   Despite widespread frustration with the use of passwords from both a usability and
2626   security standpoint, they remain a very widely used form of authentication [Persistence].
2627   Humans, however, have only a limited ability to memorize complex, arbitrary secrets, so
2628   they often choose passwords that can be easily guessed. To address the resultant security
2629   concerns, online services have introduced rules in an effort to increase the complexity
2630   of these memorized secrets. The most notable form of these is composition rules, which
2631   require the user to choose passwords constructed using a mix of character types, such as
2632   at least one digit, uppercase letter, and symbol. However, analyses of breached password
2633   databases reveal that the benefit of such rules is not nearly as significant as initially
2634   thought [Policies], although the impact on usability and memorability is severe.
2635   Complexity of user-chosen passwords has often been characterized using the information
2636   theory concept of entropy [Shannon]. While entropy can be readily calculated for data
2637   having deterministic distribution functions, estimating the entropy for user-chosen
2638   passwords is difficult and past efforts to do so have not been particularly accurate. For
2639   this reason, a different and somewhat simpler approach, based primarily on password
2640   length, is presented herein.
2641   Many attacks associated with the use of passwords are not affected by password
2642   complexity and length. Keystroke logging, phishing, and social engineering attacks are
2643   equally effective on lengthy, complex passwords as simple ones. These attacks are outside
2644   the scope of this Appendix.

2645   A.2. Length
2646   Password length has been found to be a primary factor in characterizing password
2647   strength [Strength] [Composition]. Passwords that are too short yield to brute force
2648   attacks as well as to dictionary attacks using words and commonly chosen passwords.
2649   The minimum password length that should be required depends to a large extent on the
2650   threat model being addressed. Online attacks where the attacker attempts to log in by
2651   guessing the password can be mitigated by limiting the rate of login attempts permitted.
2652   In order to prevent an attacker (or a persistent claimant with poor typing skills) from
2653   easily inflicting a denial-of-service attack on the subscriber by making many incorrect
2654   guesses, passwords need to be complex enough that rate limiting does not occur after a
2655   modest number of erroneous attempts, but does occur before there is a significant chance
2656   of a successful guess.

                                                  80
       NIST SP 800-63B-4 ipd                                              Digital Identity Guidelines
       December 2022                                       Authentication and Lifecycle Management


2657   Offline attacks are sometimes possible when one or more hashed passwords is obtained
2658   by the attacker through a database breach. The ability of the attacker to determine one or
2659   more users’ passwords depends on the way in which the password is stored. Commonly,
2660   passwords are salted with a random value and hashed, preferably using a computationally
2661   expensive algorithm. Even with such measures, the current ability of attackers to compute
2662   many billions of hashes per second with no rate limiting requires passwords intended to
2663   resist such attacks to be orders of magnitude more complex than those that are expected to
2664   resist only online attacks.
2665   Users should be encouraged to make their passwords as lengthy as they want, within
2666   reason. Since the size of a hashed password is independent of its length, there is no reason
2667   not to permit the use of lengthy passwords (or pass phrases) if the user wishes. Extremely
2668   long passwords (perhaps megabytes in length) could conceivably require excessive
2669   processing time to hash, so it is reasonable to have some limit.

2670   A.3. Complexity
2671   As noted above, composition rules are commonly used in an attempt to increase the
2672   difficulty of guessing user-chosen passwords. Research has shown, however, that users
2673   respond in very predictable ways to the requirements imposed by composition rules
2674   [Policies]. For example, a user that might have chosen “password” as their password
2675   would be relatively likely to choose “Password1” if required to include an uppercase letter
2676   and a number, or “Password1!” if a symbol is also required.
2677   Users also express frustration when attempts to create complex passwords are rejected
2678   by online services. Many services reject passwords with spaces and various special
2679   characters. In some cases, the special characters that are not accepted might be an effort
2680   to avoid attacks like SQL injection that depend on those characters. But a properly hashed
2681   password would not be sent intact to a database in any case, so such precautions are
2682   unnecessary. Users should also be able to include space characters to allow the use of
2683   phrases. Spaces themselves, however, add little to the complexity of passwords and may
2684   introduce usability issues (e.g., the undetected use of two spaces rather than one), so it
2685   may be beneficial to remove repeated spaces in typed passwords prior to verification.
2686   Users’ password choices are very predictable, so attackers are likely to guess passwords
2687   that have been successful in the past. These include dictionary words and passwords
2688   from previous breaches, such as the “Password1!” example above. For this reason,
2689   it is recommended that passwords chosen by users be compared against a blocklist
2690   of unacceptable passwords. This list should include passwords from previous breach
2691   corpuses, dictionary words, and specific words (such as the name of the service itself)
2692   that users are likely to choose. Since user choice of passwords will also be governed
2693   by a minimum length requirement, this dictionary need only include entries meeting
2694   that requirement. As noted in Sec. 5.1.1.2, it is not beneficial for the blocklist to be
2695   excessively large or comprehensive, since its primary purpose is to prevent the use of very

                                                   81
       NIST SP 800-63B-4 ipd                                               Digital Identity Guidelines
       December 2022                                        Authentication and Lifecycle Management


2696   common passwords that might be guessed in an online attack before throttling restrictions
2697   take effect. An excessively large blocklist is likely to frustrate users that attempt to choose
2698   a memorable password.
2699   Highly complex memorized secrets introduce a new potential vulnerability: they are less
2700   likely to be memorable, and it is more likely that they will be written down or stored
2701   electronically in an unsafe manner. While these practices are not necessarily vulnerable,
2702   statistically some methods of recording such secrets will be. This is an additional
2703   motivation not to require excessively long or complex memorized secrets.

2704   A.4. Central vs. Local Veriﬁcation
2705   While passwords that are used as a separate authentication factor are generally verified
2706   centrally by the CSP’s verifier, those that are used as an activation factor for a multi-
2707   factor authenticator are either verified locally or are used to derive the authenticator
2708   output, which will be incorrect if the wrong activation factor is used. Both of these
2709   situations are referred to as “local verification”.
2710   The attack surface and vulnerabilities for central and local verification are very different
2711   from each other. Accordingly, the requirements for memorized secrets verified centrally
2712   is different from those verified locally. Centrally verified secrets require the verifier,
2713   which is an online resource, to store salted and iteratively hashed verification secrets
2714   for all subscribers’ passwords. Although the salting and hashing process increases the
2715   computational effort to determine the passwords from the hashes, the verifier is an
2716   attractive target for attackers, particularly those who are interested in compromising an
2717   arbitrary subscriber rather than a specific one.
2718   Local verifiers do not have the same concerns with attacks at scale on a central online
2719   verifier, but depend to a greater extent on the physical security of the authenticator and
2720   the integrity of its associated endpoint. To the extent that the authenticator stores the
2721   activation factor, that factor must be protected against physical and side-channel (e.g.,
2722   power and timing analysis) attacks on the authenticator. When the activation factor is
2723   entered through the associated endpoint, the endpoint needs to be free of malware, such
2724   as key-logging software, if the password is to be protected. Since these threats are less
2725   dependant on the length and complexity of the password, those requirements are relaxed
2726   for local verification.
2727   Online password-guessing attacks are a similar threat for centrally and locally verified
2728   passwords. Throttling, which is the primary defense against online attacks, can be
2729   particularly challenging for local verifiers because of the limited ability of some
2730   authenticators to securely store information about unsuccessful attempts. Throttling
2731   can be performed by either keeping a count of invalid attempts in the authenticator, or
2732   by generating an authenticator output that is rejected by the CSP verifier, which does
2733   the throttling. In this case it is important that the invalid outputs not be obvious to the
2734   attacker, who could otherwise make offline attempts until a valid-looking output appears.

                                                     82
       NIST SP 800-63B-4 ipd                                             Digital Identity Guidelines
       December 2022                                      Authentication and Lifecycle Management


2735   A.5. Summary
2736   Length and complexity requirements beyond those recommended here significantly
2737   increase the difficulty of memorized secrets and increase user frustration. As a
2738   result, users often work around these restrictions in a way that is counterproductive.
2739   Furthermore, other mitigations such as blocklists, secure hashed storage, and rate limiting
2740   are more effective at preventing modern brute-force attacks. Therefore, no additional
2741   complexity requirements are imposed.




                                                   83
       NIST SP 800-63B-4 ipd                                            Digital Identity Guidelines
       December 2022                                     Authentication and Lifecycle Management


2742   Appendix B.     Change Log
2743   This appendix is informative. It provides an overview of the changes to SP 800-63B since
2744   its initial release.
2745       • Section 5.2.3 — Updated biometric performance requirements and metrics and
2746         included discussion of equity impacts.
2747       • Section 5.2.5 — Added definition and updated requirements for phishing resistant
2748         authenticators.
2749       • Section 5.2.11 — Established separate requirements for locally verified memorized
2750         secrets known as activation secrets.
2751       • Section 5.2.12 — Added requirements for authenticators that are connected via
2752         wireless technologies such as NFC and Bluetooth.




                                                 84
